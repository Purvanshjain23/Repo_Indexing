     H/TITLE EDT Order Detail Lines EF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - Program functions in two modes : *ADD and *CHANGE
     H* - Multiple new records may be added by changing to add mode
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 05/05/25  Time  : 05:25:34
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDN9EFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Order Detail Lines EF Edit file
      *
     FOPBGWKL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Detail              Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPOC6RELBIF  E           K        DISK
      * RSQ : Customer Price Header     ShipTo/PriceCd,Sel Activ
      *
     FOMHLREL7IF  E           K        DISK
      * RSQ : Accrual Program           Discount Programs
      *
     FPMD2REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm          Retrieval index
      *
     FPNFJREL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Cust     Retrieval index
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FPOC7REL2IF  E           K        DISK
      * RSQ : Customer Price Detail     ShpTo/Item/PrcCde Sts=A
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDM1REL3IF  E           K        DISK
      * RSQ : Ham Group Item            Item/Ham Group RS=A
      *
     FPDM0REL2IF  E           K        DISK
      * RTV : Ham Group Master          Ham Group RS=A
      *
     FPDM1REL4IF  E           K        DISK
      * RTV : Ham Group Item            HamGrp/Item RS=A
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDIPREL2IF  E           K        DISK
      * RSQ : Market Date Method        System/Co/Date Method
      *
     FOMF0CPL3IF  E           K        DISK
      * RTV : Commodity Mrkt Price      Active Only
      *
     FOPCIREL7IF  E           K        DISK
      * RSQ : OPP Item Contract         RSQ Cont#/Co/Cust/Item
      *
     FOPCIREL2IF  E           K        DISK
      * RSQ : OPP Item Contract         RSQ Co/contract-promo NV
      *
     FPDIHREL3IF  E           K        DISK
      * RSQ : Price Method Header       System/Co/Price Method
      *
     FOPCIREL8IF  E           K        DISK
      * RTV : OPP Item Contract         Active only
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FPDILREL3IF  E           K        DISK
      * RTV : Item Level Codes          Active Only
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDK0REL1IF  E           K        DISK
      * RTV : Order Group               Retrieval index
      *
     FOMFYREL0IF  E           K        DISK
      * RTV : Commodity Markets         Retrieval index
      *
     FPDIPREL0IF  E           K        DISK
      * RTV : Market Date Method        Retrieval index
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FCAAIREL1IF  E           K        DISK
      * RTV : Quality Level             Retrieval index       NV
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country Master            Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FPDM0REL1IF  E           K        DISK
      * RTV : Ham Group Master          Retrieval index
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAEOREL2IF  E           K        DISK
      * RTV : Company Customer          Active Records         N
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FOPBGWKL0UF  E           K        DISK                      A
      * UPD : Order Detail              Update index
      *
     E                    #L7         7  1
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 049  5 0A
     E                    W0END   7 049  5 0A
     E                    W0NAM   7 049 10
      * Long constants
     E                    @CN#    1  25  6   @CN    25
     I@HLRELX
      * Accrual Program           Discount Programs
      * Renamed input format fields
     I              HLOJCD                          WAOJCD
     I              HLLENA                          WALENA
     I              HLTOST                          WATOST
     I              HLTQST                          WATQST
     I              HLTRST                          WATRST
     I              HLTSST                          WATSST
     I              HLOKCD                          WAOKCD
     I              HLTYST                          WATYST
     I              HLOQCD                          WAOQCD
     I              HLHHCD                          WAHHCD
     I              HLI2TX                          WAI2TX
     I              HLJFTX                          WAJFTX
     I              HLI3TX                          WAI3TX
     I              HLJGTX                          WAJGTX
     I              HLLEDG                          WALEDG
     I              HLTTST                          WATTST
     I              HLBKPR                          WABKPR
     I              HLSHSX                          WASHSX
     I              HLQFSX                          WAQFSX
     I              HLFDTX                          WAFDTX
     I              HLFETX                          WAFETX
     I              HLFFTX                          WAFFTX
     I              HLFGTX                          WAFGTX
     I              HLHQVL                          WAHQVL
     I              HLFHTX                          WAFHTX
     I              HLUVST                          WAUVST
     I              HLUWST                          WAUWST
     I              HLUXST                          WAUXST
     I              HLVSST                          WAVSST
     I              HLAATM                          WAAATM
     I              HLAYNA                          WAAYNA
     I              HLA0NA                          WAA0NA
     I              HLAXDT                          WAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@M1REJ2
      * Ham Group Item            HamGrp/Item RS=A
      * Renamed input format fields
     I              M1A1AA                          WCA1AA
     I              M1DPC7                          WCDPC7
     I              M1JJNX                          WCJJNX
     I              M1UVST                          WCUVST
     I              M1UWST                          WCUWST
     I              M1UXST                          WCUXST
     I              M1VSST                          WCVSST
     I              M1AATM                          WCAATM
     I              M1AYNA                          WCAYNA
     I              M1A0NA                          WCA0NA
     I              M1AXDT                          WCAXDT
      *
     I@F0CPVR
      * Commodity Mrkt Price      Active Only
      * Renamed input format fields
     I              F0LQCD                          WDLQCD
     I              F0LRCD                          WDLRCD
     I              F0EQDT                          WDEQDT
     I              F0A5PR                          WDA5PR
     I              F0B8PR                          WDB8PR
     I              F0UVST                          WDUVST
     I              F0UWST                          WDUWST
     I              F0UXST                          WDUXST
     I              F0VSST                          WDVSST
     I              F0AATM                          WDAATM
     I              F0AYNA                          WDAYNA
     I              F0A0NA                          WDA0NA
     I              F0AXDT                          WDAXDT
      *
     I@CIRERR
      * OPP Item Contract         RSQ Co/contract-promo NV
      * Renamed input format fields
     I              CIAIC3                          WEAIC3
     I              CIBKC7                          WEBKC7
     I              CIHGCD                          WEHGCD
     I              CIAUDT                          WEAUDT
     I              CICWDT                          WECWDT
     I              CIAUST                          WEAUST
     I              CIANDT                          WEANDT
     I              CIAUNA                          WEAUNA
     I              CIDQQT                          WEDQQT
     I              CIHFQT                          WEHFQT
     I              CIL6NB                          WEL6NB
     I              CIFSQT                          WEFSQT
     I              CIB0PR                          WEB0PR
     I              CIGBDT                          WEGBDT
     I              CIGCDT                          WEGCDT
     I              CIGDDT                          WEGDDT
     I              CIRDCD                          WERDCD
     I              CIQ7CD                          WEQ7CD
     I              CIRQCD                          WERQCD
     I              CIR4CD                          WER4CD
     I              CIUVST                          WEUVST
     I              CIUWST                          WEUWST
     I              CIUXST                          WEUXST
     I              CIVSST                          WEVSST
     I              CIAATM                          WEAATM
     I              CIAYNA                          WEAYNA
     I              CIA0NA                          WEA0NA
     I              CIAXDT                          WEAXDT
      *
     I@IHREFI
      * Price Method Header       System/Co/Price Method
      * Renamed input format fields
     I              IHAIC3                          WFAIC3
     I              IHQ7CD                          WFQ7CD
     I              IHMLNA                          WFMLNA
     I              IHU0ST                          WFU0ST
     I              IHV8ST                          WFV8ST
     I              IHBYST                          WFBYST
     I              IHRMNY                          WFRMNY
     I              IHH3ST                          WFH3ST
     I              IHH5ST                          WFH5ST
     I              IHH6ST                          WFH6ST
     I              IHH7ST                          WFH7ST
     I              IHUVST                          WFUVST
     I              IHUWST                          WFUWST
     I              IHUXST                          WFUXST
     I              IHAATM                          WFAATM
     I              IHAYNA                          WFAYNA
     I              IHA0NA                          WFA0NA
     I              IHAXDT                          WFAXDT
      *
     I@CIREWP
      * OPP Item Contract         Active only
      * Renamed input format fields
     I              CIAIC3                          WGAIC3
     I              CIBKC7                          WGBKC7
     I              CIHGCD                          WGHGCD
     I              CIAUDT                          WGAUDT
     I              CICWDT                          WGCWDT
     I              CIAUST                          WGAUST
     I              CIANDT                          WGANDT
     I              CIAUNA                          WGAUNA
     I              CIDQQT                          WGDQQT
     I              CIHFQT                          WGHFQT
     I              CIL6NB                          WGL6NB
     I              CIFSQT                          WGFSQT
     I              CIB0PR                          WGB0PR
     I              CIGBDT                          WGGBDT
     I              CIGCDT                          WGGCDT
     I              CIGDDT                          WGGDDT
     I              CIRDCD                          WGRDCD
     I              CIQ7CD                          WGQ7CD
     I              CIRQCD                          WGRQCD
     I              CIR4CD                          WGR4CD
     I              CIUVST                          WGUVST
     I              CIUWST                          WGUWST
     I              CIUXST                          WGUXST
     I              CIVSST                          WGVSST
     I              CIAATM                          WGAATM
     I              CIAYNA                          WGAYNA
     I              CIA0NA                          WGA0NA
     I              CIAXDT                          WGAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
     I              ADQDSC                          WHQDSC
      *
     I@IPRERT
      * Market Date Method        Retrieval index
      * Renamed input format fields
     I              IPAIC3                          WIAIC3
     I              IPRDCD                          WIRDCD
     I              IPMNNA                          WIMNNA
     I              IPRECD                          WIRECD
     I              IPCPRD                          WICPRD
     I              IPQMNB                          WIQMNB
     I              IPU7ST                          WIU7ST
     I              IPCNOT                          WICNOT
     I              IPU8ST                          WIU8ST
     I              IPCDOW                          WICDOW
     I              IPBXST                          WIBXST
     I              IPUVST                          WIUVST
     I              IPUWST                          WIUWST
     I              IPUXST                          WIUXST
     I              IPAATM                          WIAATM
     I              IPAYNA                          WIAYNA
     I              IPA0NA                          WIA0NA
     I              IPAXDT                          WIAXDT
      *
     I@M0REZH
      * Ham Group Master          Retrieval index
      * Renamed input format fields
     I              M0A1AA                          WJA1AA
     I              M0PCNA                          WJPCNA
     I              M0H5WG                          WJH5WG
     I              M0UVST                          WJUVST
     I              M0UWST                          WJUWST
     I              M0UXST                          WJUXST
     I              M0VSST                          WJVSST
     I              M0AATM                          WJAATM
     I              M0AYNA                          WJAYNA
     I              M0A0NA                          WJA0NA
     I              M0AXDT                          WJAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WKAIC3
     I              MSC4NB                          WKC4NB
     I              MSDGSX                          WKDGSX
     I              MSKXCD                          WKKXCD
     I              MSDPNB                          WKDPNB
     I              MSUENB                          WKUENB
     I              MSDIC7                          WKDIC7
     I              MSO3NA                          WKO3NA
     I              MSO4NA                          WKO4NA
     I              MSRMTX                          WKRMTX
     I              MSPTTX                          WKPTTX
     I              MSHJWG                          WKHJWG
     I              MSHKWG                          WKHKWG
     I              MSRNTX                          WKRNTX
     I              MSAONX                          WKAONX
     I              MSROTX                          WKROTX
     I              MSORNA                          WKORNA
     I              MSAMNX                          WKAMNX
     I              MSANNX                          WKANNX
     I              MSAPNX                          WKAPNX
     I              MSDKPR                          WKDKPR
     I              MSA9VL                          WKA9VL
     I              MSC8SX                          WKC8SX
     I              MSRATX                          WKRATX
     I              MSRBTX                          WKRBTX
     I              MSAJNX                          WKAJNX
     I              MSZWTX                          WKZWTX
     I              MSZXTX                          WKZXTX
     I              MSZYTX                          WKZYTX
     I              MSZZTX                          WKZZTX
     I              MSK0U1                          WKK0U1
     I              MSK1U1                          WKK1U1
     I              MSIJSC                          WKIJSC
     I              MSIKSC                          WKIKSC
     I              MSK2U1                          WKK2U1
     I              MSW0DT                          WKW0DT
     I              MSUVST                          WKUVST
     I              MSUWST                          WKUWST
     I              MSUXST                          WKUXST
     I              MSVSST                          WKVSST
     I              MSAATM                          WKAATM
     I              MSAYNA                          WKAYNA
     I              MSA0NA                          WKA0NA
     I              MSAXDT                          WKAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     I@EOREUB
      * Company Customer          Active Records         N
      * Renamed input format fields
     I              EOAIC3                          WMAIC3
     I              EOBKC7                          WMBKC7
     I              EOAQCD                          WMAQCD
     I              EOR4CD                          WMR4CD
     I              EOBYNA                          WMBYNA
     I              EOB6NA                          WMB6NA
     I              EOBZNA                          WMBZNA
     I              EOLLST                          WMLLST
     I              EOPPST                          WMPPST
     I              EOR5NB                          WMR5NB
     I              EOR6NB                          WMR6NB
     I              EOQGST                          WMQGST
     I              EOBOCD                          WMBOCD
     I              EOTBNB                          WMTBNB
     I              EOMTCU                          WMMTCU
     I              EOW2NB                          WMW2NB
     I              EORPCD                          WMRPCD
     I              EOAJCD                          WMAJCD
     I              EOX9ST                          WMX9ST
     I              EOT9CD                          WMT9CD
     I              EOUBCD                          WMUBCD
     I              EOISTX                          WMISTX
     I              EOLQCD                          WMLQCD
     I              EONJNA                          WMNJNA
     I              EOI0TX                          WMI0TX
     I              EONKNA                          WMNKNA
     I              EOI1TX                          WMI1TX
     I              EOVLST                          WMVLST
     I              EORLST                          WMRLST
     I              EOMMTX                          WMMMTX
     I              EOOHNA                          WMOHNA
     I              EOQ6ST                          WMQ6ST
     I              EOQ8ST                          WMQ8ST
     I              EORBST                          WMRBST
     I              EOREST                          WMREST
     I              EOUVST                          WMUVST
     I              EOUWST                          WMUWST
     I              EOUXST                          WMUXST
     I              EOVSST                          WMVSST
     I              EOAATM                          WMAATM
     I              EOAYNA                          WMAYNA
     I              EOA0NA                          WMA0NA
     I              EOAXDT                          WMAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Current/previous master file format fields for change control
      *
      * Outward parameters
     IPARC        DS                             12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     I                                    P   1   40PABKC7
      * I :  Price Code
     I                                    P   5   80PABVTM
      * I :  Item Code
     I                                    P   9  120PAHGCD
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : Order Detail Accrual      Retrieval index
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Sequence Number
     I                                    P   7   80PBDPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100PBUENB
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type_Sales
     I                                        7   8 PCJNCD
      * I :  AR Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Order Requires Review
     I                                      663 664 PCFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PCNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PCNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PCNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PCBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
      * Outward parameters
     IPDRC        DS                            525
      * RCD : Order Detail              Retrieval index
      * I :  Company Number
     I                                    P   1   20PDAIC3
      * I :  Order Number
     I                                    P   3   60PDC4NB
      * B :  Order Sequence Number
     I                                    P   7   80PDDPNB
      * I :  Warehouse Code
     I                                       15  17 PDAJCD
      * I :  Ship To Customer
     I                                    P  18  210PDBKC7
      * I :  Country Code
     I                                      293 298 PDKXCD
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPERC        DS                              7
      * KEY : IP Item Market Details    Retrieval index
      * I :  Item Code
     I                                    P   1   40PEHGCD
      * I :  Commodity Market Code
     I                                        5   7 PELQCD
      *
      * Outward parameters
     IPFRC        DS                             14
      * KEY : Order Detail Schedule     Retrieval index
      * I : RST Company Number
     I                                    P   1   20PFAIC3
      * I : RST Order Number
     I                                    P   3   60PFC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PFDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PFUENB
      *
      * Outward parameters
     IPGRC        DS                              2
      * KEY : Ham Group Master          Retrieval index
      * B :  Ham Group Number
     I                                    P   1   20PGA1AA
      *
      * Outward parameters
     IPHRC        DS                             10
      * KEY : Order Detail              Retrieval index
      * I : RST Company Number
     I                                    P   1   20PHAIC3
      * I : RST Order Number
     I                                    P   3   60PHC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PHDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PHUENB
      *
      * Outward parameters
     IPIRC        DS                             10
      * KEY : Order Detail              Retrieval index
      * I : RST Company Number
     I                                    P   1   20PIAIC3
      * I : RST Order Number
     I                                    P   3   60PIC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PIDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PIUENB
      *
      * Outward parameters
     IPJRC        DS                             12
      * KEY : Order Detail Accrual      Retrieval index
      * I : RST Company Number
     I                                    P   1   20PJAIC3
      * I : RST Order Number
     I                                    P   3   60PJC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PJDPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PJUENB
      *
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WKAIC3
     I              MSC4NB                          WKC4NB
     I              MSDGSX                          WKDGSX
     I              MSKXCD                          WKKXCD
     I              MSDPNB                          WKDPNB
     I              MSUENB                          WKUENB
     I              MSDIC7                          WKDIC7
     I              MSO3NA                          WKO3NA
     I              MSO4NA                          WKO4NA
     I              MSRMTX                          WKRMTX
     I              MSPTTX                          WKPTTX
     I              MSHJWG                          WKHJWG
     I              MSHKWG                          WKHKWG
     I              MSRNTX                          WKRNTX
     I              MSAONX                          WKAONX
     I              MSROTX                          WKROTX
     I              MSORNA                          WKORNA
     I              MSAMNX                          WKAMNX
     I              MSANNX                          WKANNX
     I              MSAPNX                          WKAPNX
     I              MSDKPR                          WKDKPR
     I              MSA9VL                          WKA9VL
     I              MSC8SX                          WKC8SX
     I              MSRATX                          WKRATX
     I              MSRBTX                          WKRBTX
     I              MSAJNX                          WKAJNX
     I              MSZWTX                          WKZWTX
     I              MSZXTX                          WKZXTX
     I              MSZYTX                          WKZYTX
     I              MSZZTX                          WKZZTX
     I              MSK0U1                          WKK0U1
     I              MSK1U1                          WKK1U1
     I              MSIJSC                          WKIJSC
     I              MSIKSC                          WKIKSC
     I              MSK2U1                          WKK2U1
     I              MSW0DT                          WKW0DT
     I              MSUVST                          WKUVST
     I              MSUWST                          WKUWST
     I              MSUXST                          WKUXST
     I              MSVSST                          WKVSST
     I              MSAATM                          WKAATM
     I              MSAYNA                          WKAYNA
     I              MSA0NA                          WKA0NA
     I              MSAXDT                          WKAXDT
      *
     IYBRDCS      DS                            525
     IYCRDCS      DS                            525
     IYDRDCS      DS                            525
     IYERDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * N :  Order Type_Sales
     I                                        7   8 P1JNCD
      * N :  AR Customer Number
     I                                    P   9  120P1ANC7
      * I : MAP Ship To Customer
     I                                    P  13  160P1BKC7
      * N :  Bill to Customer
     I                                    P  17  200P1B0C7
      * N :  Customer Purchase Order #
     I                                       21  35 P1BCNA
      * N :  Order Date
     I                                    P  36  390P1A0DT
      * N :  Requested Ship Date
     I                                    P  40  430P1A5DT
      * N :  Comment Print Acknowledge
     I                                       44  44 P1GTST
      * N :  Comment Print Inv_Cr_Memo
     I                                       45  45 P1GVST
      * N :  Comment Print Pick Slip
     I                                       46  46 P1GUST
      * N :  Comment Print Ship Doc
     I                                       47  47 P1QFST
      * N :  Scheduled Ship Date
     I                                    P  48  510P1AODT
      * N :  Order Value Total
     I                                    P  52  572P1JZVA
      * N :  Order Weight Total
     I                                    P  58  632P1A1WG
      * N :  Requested Delivery Date
     I                                    P  64  670P1EIDT
      * N :  Requested Delivery Time
     I                                    P  68  700P1AFTM
      * N :  Load ID
     I                                    P  71  740P1RMNB
      * N :  Shipping Method
     I                                       75  76 P1Q2CD
      * N :  Palletize
     I                                       77  77 P1VEST
      * N :  Shrink Wrap
     I                                       78  78 P1VFST
      * N :  Slip Sheet
     I                                       79  79 P1VGST
      * N :  Reefer Temperature
     I                                    P  80  822P1RNNB
      * N :  Load Type
     I                                       83  83 P1VDST
      * N :  Sales Route Code
     I                                       84  86 P1R4CD
      * N :  Event Code
     I                                       87  88 P1JPCD
      * N :  Trans Contol AS400_Plant
     I                                       89  89 P1XUST
      * N :  Billing Activity Type
     I                                       90  90 P1OBST
      * N :  Block Order Flag
     I                                       91  91 P1BCST
      * N :  Broker Order Status
     I                                       92  92 P1FSSX
      * N :  OH Load Plan Ready
     I                                       93  94 P1FVSX
      * N :  HPB Ship to Warehouse
     I                                       95  97 P1FXSX
     IP2PARM      DS
      * I :  Process Control
     I                                        1   1 P2PRCT
     IP3PARM      DS
      * B :  Next Program Name
     I                                        1  10 P3BYVN
     IP4PARM      DS
      * I :  USR Change existing order
     I                                        1   1 P4G6ST
     IP5PARM      DS
      * FLD: Order Detail
      * I :  Warehouse Code
     I                                        1   3 P5AJCD
      * N :  Market Pricing Date
     I                                    P   4   70P5EXDT
      * N :  Commodity Market Code
     I                                        8  10 P5LQCD
      * N :  Date Method Code
     I                                       11  13 P5RDCD
      * N :  Price Method Code
     I                                       14  16 P5Q7CD
      * N :  Age Code
     I                                       17  17 P5RPCD
      * N :  Quantity Ordered
     I                                    P  18  232P5AVQT
      * N :  Affect Inventory Status
     I                                       24  24 P5AMST
      * N :  Affect Sales Doll Status
     I                                       25  25 P5ANST
      * N :  Affect Sales Pnds Status
     I                                       26  26 P5VAST
      * I :  Country Code
     I                                       27  32 P5KXCD
      * N :  OD Pallet Type
     I                                       33  34 P5F5SX
      * N :  OD Price Type Ref Num
     I                                    P  35  380P5NWDT
      * N :  Item Age Days
     I                                    P  39  410P5RINY
      * N :  Production Ovr AgeDte Fr
     I                                    P  42  450P5TIDT
      * N :  Production Ovr AgeDte To
     I                                    P  46  490P5TJDT
     IP6PARM      DS
      * FLD: *Arrays
      * I :  Application Code
     I                                        1   6 P6DNCD
      * N :  Enterprise Code 1
     I                                        7  10 P6DQCD
      * N :  Enterprise Code 2
     I                                       11  22 P6DRCD
      * N :  Salesperson Code
     I                                       23  25 P6BCCD
      * N :  System Date Format
     I                                       26  28 P6B8NA
      * N :  User Profile Name
     I                                       29  38 P6AJVN
      * N :  Allow Multi_Company
     I                                       39  39 P6I6ST
      * N :  Default Printer
     I                                       40  49 P6MPNA
      * N :  Live with TPM
     I                                       50  50 P6O1ST
     IP7PARM      DS
      * FLD: *Arrays
      * N :  Transportation Temp
     I                                    P   1   20P7TFNB
      * N :  USR Update Flag
     I                                        3   3 P7R4ST
      * N :  USR First Time
     I                                        4   4 P7TMST
      * N :  Inventory Status
     I                                        5   5 P7BRST
      * N :  USR Display field
     I                                        6   6 P7GGST
      * N :  Effective Date
     I                                    P   7  100P7AUDT
      * N :  End Date Effective
     I                                    P  11  140P7CWDT
      * N :  Maximum Quantity
     I                                    P  15  202P7DQQT
      * N :  Contract Mkt Price Date
     I                                    P  21  240P7GBDT
      * N :  Quantity Sold
     I                                    P  25  302P7HFQT
      * N :  Price Method Type
     I                                       31  31 P7V8ST
      * N :  Affect Inventory Default
     I                                       32  32 P7OEST
      * N :  Affect Sales Doll Default
     I                                       33  33 P7OFST
      * N :  Affect Sales Pnds Default
     I                                       34  34 P7VBST
      * N :  Affect Accruals Default
     I                                       35  35 P7X8ST
      * N :  Display Flag
     I                                       36  36 P7QKST
      * N :  OD Price Type Req STS USR
     I                                       37  37 P7
      * N :  OD Price Type
     I                                       38  40 P7F7SX
     IP8PARM      DS
      * FLD: *Arrays
      * N :  Cntrt Enter no QT Price
     I                                        1   1 P8WDST
      * N :  Cntrt.# does not Exit
     I                                        2   2 P8WEST
      * N :  Qty ordered > Contract
     I                                        3   3 P8WFST
      * N :  Contract Expired
     I                                        4   4 P8WGST
      * N :  Price Override Required
     I                                        5   5 P8WHST
      * N :  Price Method QT & Cntrt 0
     I                                        6   6 P8WIST
      * N :  Prc Code FRM or MKT
     I                                        7   7 P8WJST
      * N :  Mkt Pricing Date not 0
     I                                        8   8 P8WKST
      * N :  Mkt Meth. and Date both
     I                                        9   9 P8WLST
      * N :  Price Override Req. EXT
     I                                       10  10 P8WMST
      * N :  Contract Exists for Item
     I                                       11  11 P8XSST
      * N :  Price Override not Allowd
     I                                       12  12 P8YXST
     IP9PARM      DS
      * FLD: Company Defaults Internal
      * N :  Allow Mult Whse to Order
     I                                        1   1 P9HSST
      * N :  Allow Multi Export On Ord
     I                                        2   2 P9AMEO
      * N :  Company Organization
     I                                        3   3 P9YJSX
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(ORDER-    1 256 #S0001
     I              '_ACK)               '
     I            DS
     I I            'SBMJOB     JOB(GETRE-    1 256 #S0002
     I              'ADY) JOBD(*USRPRF)  '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0001
      * Weight Allocated USR
     I                                    P   5   92ZA0002
      * Maximum Contract Units
     I                                    P  10  152ZA0003
      * Item Code
     I                                       16  22 ZA0004
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0005
      * Weight Allocated USR
     I                                    P   5   92ZA0006
      * Maximum Contract Units
     I                                    P  10  152ZA0007
      * Item Code
     I                                       16  22 ZA0008
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Value must be Y/N'
      * OD Production Plan St USR
     I                                        1   1 ZA0009
      * Message data for 'Value must be Y/N'
      * OD Production Plan St USR
     I                                        1   1 ZA0010
      * Message data for 'Cannot snd to mpr w/price'
      * Price Overage Override
     I                                    P   1   64ZA0011
      * Message data for 'PAL-Prompt Not Allowed'
      * Pallet Type NOREF
     I                                        1   2 ZA0012
      * Message data for 'PAL-Pallet Type not found'
      * PM Pallet Type
     I                                        1   2 ZA0013
      * Message data for 'Value Required.'
      * Numeric Field Needed  USR
     I                                    P   1   40ZA0014
      * Message data for 'Access Denied: Item'
      * Item Code
     I                                        1   7 ZA0015
      * User Profile Name
     I                                        8  17 ZA0016
      * Message data for 'Company Item           NF'
      * Company Number CDE
     I                                    P   1   20ZA0017
      * Item Code Number 7.0  USR
     I                                    P   3   60ZA0018
      * Message data for 'Item Balance           NF'
      * Company Number
     I                                        1   3 ZA0019
      * Item Code
     I                                        4  10 ZA0020
      * Warehouse Code
     I                                       11  13 ZA0021
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0022
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0023
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0024
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0025
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0026
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0027
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0028
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0029
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0030
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0031
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0032
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0033
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0034
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0035
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0036
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0037
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0038
      * Production AgeDte To
     I                                    P   5   80ZA0039
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     I                                        1  25 ZA0040
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     I                                        1  25 ZA0041
      * Message data for 'Item must be Finished Gd'
      * Item Code
     I                                        1   7 ZA0042
      * Message data for 'Item must be sold fr/fz'
      * Item Code
     I                                        1   7 ZA0043
      * Warehouse Type USR
     I                                        8   9 ZA0044
      * Warehouse Type
     I                                       10  11 ZA0045
      * Message data for 'To Item Balance not found'
      * Item Code
     I                                        1   7 ZA0046
      * Warehouse Code
     I                                        8  10 ZA0047
      * Message data for 'Unit Cost cannot be 0'
      * Item Code
     I                                        1   7 ZA0048
      * Warehouse Code
     I                                        8  10 ZA0049
      * Message data for 'Bulk items can not be on'
      * Item Code
     I                                        1   7 ZA0050
      * Message data for 'Only bulk items can be on'
      * Item Code
     I                                        1   7 ZA0051
      * Message data for 'Ham Group REQ'
      * Item Code
     I                                        1   7 ZA0052
      * Message data for 'Ham group not found.'
      * Ham Group Number
     I                                    P   1   20ZA0053
      * Message data for 'Ham Group/Item not found'
      * Item Code
     I                                        1   7 ZA0054
      * Ham Group Number
     I                                    P   8   90ZA0055
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     I                                        1  25 ZA0056
      * Message data for 'Price Code Inv for Mthd'
      * Price Code
     I                                    P   1   40ZA0057
      * Price Method Code
     I                                        5   7 ZA0058
      * Message data for 'Price Code not val f/cust'
      * Price Code
     I                                    P   1   40ZA0059
      * Message data for 'Price Code not val dt rng'
      * Price Code
     I                                    P   1   40ZA0060
      * Message data for 'Price Code not val f/item'
      * Price Code
     I                                    P   1   40ZA0061
      * Item Code
     I                                        5  11 ZA0062
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0063
      * Weight Allocated USR
     I                                    P   5   92ZA0064
      * Maximum Contract Units
     I                                    P  10  152ZA0065
      * Item Code
     I                                       16  22 ZA0066
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0067
      * Weight Allocated USR
     I                                    P   5   92ZA0068
      * Maximum Contract Units
     I                                    P  10  152ZA0069
      * Item Code
     I                                       16  22 ZA0070
      * Message data for 'Price code req for mthd'
      * Price Method Code
     I                                        1   3 ZA0071
      * Price Code
     I                                    P   4   70ZA0072
      * Message data for 'Market Date/Range ERR'
      * Market Pricing Date
     I                                    P   1   40ZA0073
      * OD Market Begin Date
     I                                    P   5   80ZA0074
      * OD Market Ending Date
     I                                    P   9  120ZA0075
      * Message data for 'Date Range Invalid'
      * OD Market Begin Date
     I                                    P   1   40ZA0076
      * OD Market Ending Date
     I                                    P   5   80ZA0077
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0078
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0079
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0080
      * Message data for 'Prc Date Range Inv'
      * OD Market Begin Date
     I                                    P   1   40ZA0081
      * OD Market Ending Date
     I                                    P   5   80ZA0082
      * Price Method Code
     I                                        9  11 ZA0083
      * Message data for 'Price Override Required'
      * Contract Price Override
     I                                    P   1   64ZA0084
      * Message data for 'Market Code not allowed'
      * Dft Commodity Market
     I                                        1   3 ZA0085
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0086
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0087
      * Message data for 'Prc Dts = 0 f/Prc Mth'
      * Market Pricing Date
     I                                    P   1   40ZA0088
      * OD Market Begin Date
     I                                    P   5   80ZA0089
      * OD Market Ending Date
     I                                    P   9  120ZA0090
      * Price Method Code
     I                                       13  15 ZA0091
      * Message data for 'Manual price within Prcnt'
      * Price Overage Override
     I                                    P   1   64ZA0092
      * Message data for 'No Mkt Prc Found for test'
      * Price Overage Override
     I                                    P   1   64ZA0093
      * Commodity Market Code
     I                                        7   9 ZA0094
      * Commodity Price Group
     I                                       10  16 ZA0095
      * Message data for 'Market Code not allowed'
      * Dft Commodity Market
     I                                        1   3 ZA0096
      * Message data for 'Date Meth Code not allow'
      * Date Method Code
     I                                        1   3 ZA0097
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     I                                    P   1   64ZA0098
      * Message data for 'Ceiling Price Required'
      * OD Ceiling Price
     I                                    P   1   64ZA0099
      * Message data for 'Prc Dts = 0 f/Prc Mth'
      * Market Pricing Date
     I                                    P   1   40ZA0100
      * OD Market Begin Date
     I                                    P   5   80ZA0101
      * OD Market Ending Date
     I                                    P   9  120ZA0102
      * Price Method Code
     I                                       13  15 ZA0103
      * Message data for 'Price Override not allow'
      * Contract Price Override
     I                                    P   1   64ZA0104
      * Message data for 'Market Code must be enter'
      * Commodity Market Code
     I                                        1   3 ZA0105
      * Message data for 'Market Date Method Inval.'
      * Date Method Code
     I                                        1   3 ZA0106
      * Message data for 'Date Meth & Prc Dat N/A'
      * Market Pricing Date
     I                                    P   1   40ZA0107
      * Date Method Code
     I                                        5   7 ZA0108
      * Message data for 'Market Date Method Inval.'
      * Date Method Code
     I                                        1   3 ZA0109
      * Message data for 'Market Date/Range ERR'
      * Market Pricing Date
     I                                    P   1   40ZA0110
      * OD Market Begin Date
     I                                    P   5   80ZA0111
      * OD Market Ending Date
     I                                    P   9  120ZA0112
      * Message data for 'Date Range Invalid'
      * OD Market Begin Date
     I                                    P   1   40ZA0113
      * OD Market Ending Date
     I                                    P   5   80ZA0114
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0115
      * Commodity Price Group
     I                                        4  10 ZA0116
      * Message data for 'No Price Mkt/Group Deflt'
      * Commodity Market Code
     I                                        1   3 ZA0117
      * Commodity Price Group
     I                                        4  10 ZA0118
      * Default Commod Mark basis
     I                                       11  13 ZA0119
      * Message data for 'No Price for Mkt/Group'
      * Commodity Market Code
     I                                        1   3 ZA0120
      * Commodity Price Group
     I                                        4  10 ZA0121
      * Message data for 'Price code req for mthd'
      * Price Method Code
     I                                        1   3 ZA0122
      * Price Code
     I                                    P   4   70ZA0123
      * Message data for 'OPP Contract Error'
      * Contract Number
     I                                    P   1   40ZA0124
      * Message data for 'This item has a Contract'
      * Item Code
     I                                        1   7 ZA0125
      * Contract Number
     I                                    P   8  110ZA0126
      * Message data for 'OPP Contract Error'
      * Contract Number
     I                                    P   1   40ZA0127
      * Message data for 'Quantity Ordered > Contra'
      * Quantity Ordered
     I                                    P   1   62ZA0128
      * Contract Number
     I                                    P   7  100ZA0129
      * Message data for 'Contract Effective date'
      * Contract Number
     I                                    P   1   40ZA0130
      * Message data for 'Market Code must be enter'
      * Commodity Market Code
     I                                        1   3 ZA0131
      * Message data for 'Date Meth & Prc Dat N/A'
      * Market Pricing Date
     I                                    P   1   40ZA0132
      * Date Method Code
     I                                        5   7 ZA0133
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0134
      * Message data for 'Warehouse Ctl not allowed'
      * Warehouse Code
     I                                        1   3 ZA0135
      * Trans Contol AS400_Plant
     I                                        4   4 ZA0136
      * USR Trans Control A/P
     I                                        5   5 ZA0137
      * Message data for 'TF Exempt-Item & Cust'
      * Item Code
     I                                        1   7 ZA0138
      * Message data for 'Tf Exempt - mix error'
      * Message data for 'TF Exempt-Item & Cust'
      * Item Code
     I                                        1   7 ZA0139
      * Message data for 'PD Item Level not found'
      * Item Code
     I                                        1   7 ZA0140
      * Message data for 'OD Price Type Req'
      * OD Price Type
     I                                        1   3 ZA0141
      * Message data for 'Pallet Type Req'
      * OD Pallet Type
     I                                        1   2 ZA0142
      * Message data for 'Inv Not Avail 4 Susp Item'
      * Item Code
     I                                        1   7 ZA0143
      * Message data for 'Item is suspended-invonly'
      * Item Code
     I                                        1   7 ZA0144
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P2PRCT    PARM           WP0004  1        Process Control
     C           P3BYVN    PARM P3BYVN    WP0005 10        Next Program Na
     C           P4G6ST    PARM           WP0006  1        USR Change exis
     C           P5AJCD    PARM           WP0007  3        Warehouse Code
     C           P5KXCD    PARM           WP0008  6        Country Code
     C           P6DNCD    PARM           WP0009  6        Application Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * First Time Logic  order hdr, customer
      * CASE: PAR.USR First Time is Yes
     C           P7TMST    IFEQ 'Y'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
      * RMC - 08/24/05  Get OH exempt code & Cust Ext Exempt code
      * Get Bill To Customer number for EDI test              E004140
      * 04/30/2018 DN R12926-At Order level, get Absorbed Freight Rate fr
      * RTV All Fields         RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Rtv Customer TFEx     RT - Customer EXT  * 
     C                     EXSR SCRVGN
      * Rtv Age Information   XF - Company Customer EXT  * 
     C                     CALL 'PNQCXFR'              90  Rtv Age Informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM #PBKC7    WQ0002  70       Ship To Custome
     C           #CRJNY    PARM *ZERO     WQ0003  40       Item Age Days F
     C           #CRKNY    PARM *ZERO     WQ0004  40       Item Age Days F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * fp1309 bring in the deadline dep date for the first record only
      * Rtv All Fields/1 line XF - Order Detail  * 
     C                     CALL 'PNQYXFR'              90  Rtv All Fields/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0005  30       Company Number
     C                     PARM #2C4NB    WQ0006  70       Order Number
     C                     PARM *BLANK    WQ0007  1        Credit Hold
     C                     PARM *BLANK    WQ0008  1        Production Hold
     C                     PARM *BLANK    WQ0009  1        Header Status
     C                     PARM *BLANK    WQ0010  2        Order Type_Sale
     C                     PARM *ZERO     WQ0011  70       Load ID
     C                     PARM *BLANK    WQ0012  1        Export Status
     C                     PARM *BLANK    WQ0013 20        Ship To City
     C                     PARM *BLANK    WQ0014  2        Ship To State C
     C                     PARM *BLANK    WQ0015  1        Order in Use
     C                     PARM *ZERO     WQ0016  30       Order Sequence
     C                     PARM *ZERO     WQ0017  30       Order Secondary
     C                     PARM *ZERO     WQ0018  70       Item Code
     C                     PARM *BLANK    WQ0019  3        Warehouse Code
     C                     PARM *ZERO     WQ0020  70       Ship To Custome
     C                     PARM *ZERO     WQ0021  70       Order Group Cod
     C                     PARM *BLANK    WQ0022  1        Detail Line Sta
     C                     PARM *BLANK    WQ0023  1        Detail Line Sta
     C                     PARM *ZERO     WQ0024 112       Billing Detail
     C                     PARM *ZERO     WQ0025 112       Billing Detail
     C                     PARM *ZERO     WQ0026 112       Billing Detail
     C                     PARM *ZERO     WQ0027 112       Quantity to Sub
     C                     PARM *BLANK    WQ0028  1        Comment Print A
     C                     PARM *BLANK    WQ0029  1        Comment Print I
     C                     PARM *BLANK    WQ0030  1        Comment Print P
     C                     PARM *BLANK    WQ0031  1        Comment Print S
     C                     PARM *ZERO     WQ0032 112       Extended Amount
     C                     PARM *ZERO     WQ0033  70       Market Pricing
     C                     PARM *BLANK    WQ0034  3        Commodity Marke
     C                     PARM *BLANK    WQ0035  3        Date Method Cod
     C                     PARM *BLANK    WQ0036  3        Price Method Co
     C                     PARM *ZERO     WQ0037 114       Price Overage O
     C                     PARM *ZERO     WQ0038  70       Contract Number
     C                     PARM *BLANK    WQ0039  1        Price Status
     C                     PARM *ZERO     WQ0040  70       Pricing Date Us
     C                     PARM *BLANK    WQ0041  2        U_M_Base Price
     C                     PARM *BLANK    WQ0042  2        U_M_Ordered
     C                     PARM *BLANK    WQ0043  1        Work Confirm St
     C                     PARM *BLANK    WQ0044  1        Work Over_Short
     C                     PARM *BLANK    WQ0045  1        OD Production P
     C                     PARM *BLANK    WQ0046 30        Order Desc_Line
     C                     PARM *BLANK    WQ0047 30        Order Desc_Line
     C                     PARM *BLANK    WQ0048  1        Age Code
     C                     PARM *BLANK    WQ0049  1        Palletize
     C                     PARM *BLANK    WQ0050  1        Slip Sheet
     C                     PARM *BLANK    WQ0051  1        Catch Weight St
     C                     PARM *BLANK    WQ0052  1        Price Audit
     C                     PARM *BLANK    WQ0053  3        Price Audit Rea
     C                     PARM *BLANK    WQ0054  1        Production Date
     C                     PARM *ZERO     WQ0055 112       Rated Freight
     C                     PARM *ZERO     WQ0056 112       Quantity Ordere
     C                     PARM *ZERO     WQ0057 112       Weight Ordered
     C                     PARM *ZERO     WQ0058 112       Quantity Schedu
     C                     PARM *ZERO     WQ0059 112       Weight Schedule
     C                     PARM *ZERO     WQ0060 112       Quantity Shippe
     C                     PARM *ZERO     WQ0061 112       Weight Shipped
     C                     PARM *ZERO     WQ0062 114       Unit Cost Prici
     C                     PARM *ZERO     WQ0063 114       Unit Cost Per P
     C                     PARM *ZERO     WQ0064 114       Unit Price
     C                     PARM *ZERO     WQ0065 114       Unit Price_Cred
     C                     PARM *ZERO     WQ0066 114       Unit Price Orde
     C                     PARM *ZERO     WQ0067 112       Unit Weight Ord
     C                     PARM *ZERO     WQ0068 112       Tare Weight Tot
     C                     PARM *ZERO     WQ0069  70       Requested Ship
     C                     PARM *ZERO     WQ0070  70       Scheduled Ship
     C                     PARM *ZERO     WQ0071  70       Actual Shipped
     C                     PARM *BLANK    WQ0072  1        Affect Inventor
     C                     PARM *BLANK    WQ0073  1        Affect Sales Do
     C                     PARM *BLANK    WQ0074  1        Affect Sales Pn
     C                     PARM *ZERO     WQ0075  30       Item Structure
     C                     PARM *ZERO     WQ0076  30       Item Structure
     C                     PARM *ZERO     WQ0077  30       Item Structure
     C                     PARM *BLANK    WQ0078  2        Item Level
     C                     PARM *BLANK    WQ0079  2        Quality Level
     C                     PARM *BLANK    WQ0080  2        Pricing Product
     C                     PARM *BLANK    WQ0081  2        Season Product
     C                     PARM *ZERO     WQ0082  70       Date of Origina
     C                     PARM *BLANK    WQ0083 10        User Profile Na
     C                     PARM *BLANK    WQ0084  6        Country Code
     C                     PARM *BLANK    WQ0085  2        Event Code
     C                     PARM *BLANK    WQ0086  3        Reason Code
     C                     PARM *BLANK    WQ0087  3        Sales Route Cod
     C                     PARM *BLANK    WQ0088  1        Modified Flag
     C                     PARM *BLANK    WQ0089  1        Substituted Fla
     C                     PARM *BLANK    WQ0090  1        OD Schedule Ove
     C                     PARM *ZERO     WQ0091 114       Invoice Unit Pr
     C                     PARM *ZERO     WQ0092 112       Invoice Extende
     C                     PARM *ZERO     WQ0093  30       Ham Group Numbe
     C                     PARM *BLANK    WQ0094  1        OD Adj Type Ove
     C                     PARM *BLANK    WQ0095  1        Affect Trade Fu
     C                     PARM *BLANK    WQ0096  1        Affect Commissi
     C                     PARM *BLANK    WQ0097  1        Affect Pricing
     C                     PARM *BLANK    WQ0098  1        Released by Use
     C                     PARM *BLANK    WQ0099  2        Ord TF Exempt C
     C                     PARM *BLANK    WQ0100  2        OD Pallet Type
     C                     PARM *BLANK    WQ0101  3        Production Ware
     C                     PARM *BLANK    WQ0102  3        OD Price Type
     C                     PARM *ZERO     WQ0103  70       Warehouse Palle
     C                     PARM *ZERO     WQ0104  70       Consumed Item C
     C           #CNVDT    PARM *ZERO     WQ0105  70       Deadline Depart
     C                     PARM *ZERO     WQ0106  70       OD Price Type R
     C                     PARM *ZERO     WQ0107  70       OD Firm Date
     C           #CBUTM    PARM *ZERO     WQ0108  60       Deadline Depart
     C                     PARM *ZERO     WQ0109  60       Price Code
     C                     PARM *ZERO     WQ0110  60       Maximum Net Wei
     C                     PARM *ZERO     WQ0111  60       Substitution Li
     C                     PARM *ZERO     WQ0112  60       Max Qty to sche
     C                     PARM *ZERO     WQ0113 112       Warehouse Palle
     C                     PARM *ZERO     WQ0114 112       Warehouse Avg P
     C                     PARM *ZERO     WQ0115 112       OD Item Target
     C                     PARM *ZERO     WQ0116 112       OD Estimated Gr
     C                     PARM *ZERO     WQ0117 112       OD Maximum Unit
     C                     PARM *ZERO     WQ0118 114       Order Gate_Fina
     C                     PARM *ZERO     WQ0119 114       OD Ceiling Pric
     C                     PARM *ZERO     WQ0120 114       OD Gate_Final P
     C                     PARM *ZERO     WQ0121 114       OD Weighted Avg
     C                     PARM *ZERO     WQ0122 114       OD Original Ord
     C                     PARM *ZERO     WQ0123 114       OD Cancel Date
     C                     PARM *ZERO     WQ0124 114       OD Unused Prc 7
     C                     PARM *ZERO     WQ0125 114       OD Unused Prc 8
     C                     PARM *BLANK    WQ0126  1        OD MPR Sent to
     C                     PARM *BLANK    WQ0127  1        OD MPR Prc Read
     C                     PARM *BLANK    WQ0128  1        OD UnUsed Price
     C                     PARM *ZERO     WQ0129 112       Weight Amount E
     C                     PARM *ZERO     WQ0130  40       Item Age Days
     C                     PARM *ZERO     WQ0131  70       Production Ovr
     C                     PARM *ZERO     WQ0132  70       Production Ovr
     C                     PARM *BLANK    WQ0133  1        OD Spot Buy
     C                     PARM *BLANK    WQ0134  2        OD Clm Full Ret
     C                     PARM *BLANK    WQ0135  3        Order Line Erro
     C                     PARM *ZERO     WQ0136  70       OD Market Begin
     C                     PARM *ZERO     WQ0137  70       OD Market Endin
     C                     PARM *ZERO     WQ0138  70       OD Atch to Ord
     C           #2EIDT    PARM *ZERO     WQ0139  70       Requested Deliv
     C           #2AFTM    PARM *ZERO     WQ0140  40       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CTL = PAR By name
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
     C                     MOVELP1JNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDP1EIDT    #2EIDT           Requested Deliv
     C                     Z-ADDP1AFTM    #2AFTM           Requested Deliv
     C                     Z-ADDP1RMNB    #2RMNB           Load ID
     C                     Z-ADDP1BKC7    #PBKC7           Ship To Custome
     C                     Z-ADDP5AVQT    #CAVQT           Quantity Ordere
     C                     Z-ADDP1A5DT    #CA5DT           Requested Ship
     C                     Z-ADDP1AODT    #CAODT           Scheduled Ship
     C                     MOVEL'N'       P7TMST           USR First Time
     C                     END                             *FI
      * If change mode retrieve weight ordered and shipped
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * RTV Weight Ord & Sched RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     Z-ADD#CAVQT    WL0005           Quantity Ordere
     C                     Z-ADD#CD0WG    WL0006           Weight Ordered
     C                     Z-ADD#CAUWG    WL0007           Weight Schedule
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #CAVQT           Quantity Ordere
     C                     Z-ADDWL0006    #CD0WG           Weight Ordered
     C                     Z-ADDWL0007    #CAUWG           Weight Schedule
     C                     END                             *FI
      * ** FP1309 Inventory Age Code by Dates               7/26/2010
      * ** PK0519 Accrual Exists  12/02/03**
      * ** DLY029 Accrual Exists if one exists with Affect Inv Price=Y
      * ** FP1314 Inter-Co Sales Agreement 07/14/2009
      * WI464 DN 04/21/22-Output Parm to 'Cust Accrual Found USR' Flag.
      * Val Mkt Accrual Exist RT - Customer Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#PBKC7    WL0008           Ship To Custome
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0002    P      Record Found US
      * Get Customer Type
      * Rtv Co/Customer Type - Company Customer  * 
     C                     EXSR SGRVGN
     C                     MOVEL'N'       YL0005           USR Display 1
      * Set Customer Type Desc Usr
      * CASE: WRK.Type Code is Inter Company
     C           WUBOCD    IFEQ 'IC'                       *IF
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,001   #CRHNA           Customer Type D
     C                     ELSE
      * CASE: WRK.Type Code is Inter-Comp Sales Agreemnt
     C           WUBOCD    IFEQ 'IS'                       *IF
      * 07/14/2009 FP1314
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,002   #CRHNA           Customer Type D
     C                     MOVEL'Y'       YL0005           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,003   #CRHNA           Customer Type D
     C                     END                             *FI
     C                     END                             *FI
      * Make the price override output if the customer is IC
     C                     MOVEL'N'       WUYFSX           Prc Ovr Output
      * Prc Ovr Output Only Y or N
      * CASE: WRK.Type Code is Inter Company
     C           WUBOCD    IFEQ 'IC'                       *IF
     C                     MOVEL'Y'       WUYFSX           Prc Ovr Output
     C                     END                             *FI
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SHRVGN
      * Rtv Contract Exists   RT - Customer Price Header  * 
     C                     EXSR SIRVGN
      * Rtv Discounts Exists  XF
      * Rtv Discounts Exist   RT - Accrual Program  * 
     C                     EXSR SJRVGN
     C                     END
      *................................................................
      * If CHANGE mode, then position file:
     C           W0PMD     IFNE 'ADD'
     C           KPOS      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     MOVEL*ZERO     OMDPNB           Order Sequence
     C                     MOVEL*ZERO     OMUENB           Order Secondary
      * 82=EOF
     C           KPOS      SETLL@BGWKL1              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C  N82      KRST      READE@BGWKL1                9182*
     C                     ELSE
     C                     SETOF                     82    *
     C                     END
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page (write empty page if add mode)
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27      W0PMD     IFNE 'ADD'
     C  N82                READP@BGWKL1                  90*
     C  N82                READ @BGWKL1                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0 19
     C                     MOVE *ALL'1'   WKIND1 19
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * If CHANGE mode, load subfile fields
     C           W0PMD     IFNE 'ADD'
     C                     EXSR MBFL#1
      * Calculate function fields
     C                     EXSR DG#2FN
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
      * E4122 JJH 06/11/15 - Use Requested Ship Date for Allocation/Deall
      * * --- Initialize values from Order Header --- *
     C                     Z-ADDP1AODT    #1AODT           Scheduled Ship
     C                     Z-ADDP1A5DT    #1A5DT           Requested Ship
      * * ------------------------------------------- *
     C                     MOVEL*BLANK    P7R4ST           USR Update Flag
     C                     Z-ADDOMHGCD    #RDKCD           USR Item Code
      * Quantity ordered
      * CASE: DB1.Order Secondary Line Seq is GT 1
     C           OMUENB    IFGT 1                          *IF
     C                     Z-ADDOML9VA    #RHHQT           Qty Ordered USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDOMAVQT    #RHHQT           Qty Ordered USR
     C                     END                             *FI
      * If quantity is equal to zero, flag detail line as error.
      * CASE: RCD.Qty Ordered USR is Equal to Zero
     C           #RHHQT    IFEQ *ZERO                      *IF
      * Allow for TR Block order only
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Order Type - Sales is Transfer Order
      *   |- c2    : PAR.Block Order Flag is Block Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1JNCD    IFEQ 'TR'                       *IF
     C           P1BCST    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * E2393 allow for TR block order only
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       *IN84            *Re-read Subfil
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#RHHQT    #RINQT           Quantity 11.2 U
     C                     MOVELOMAJCD    #RCPCD           USR Warehouse C
     C                     MOVELOMRPCD    #RFWST           USR Age Code
     C                     MOVELP7GGST    #RGGST           USR Display fie
     C                     Z-ADDOMCCQT    #RBAQT           USR Quantity
     C                     Z-ADDOMAUWG    #RASWG           USR Weight
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMRINY    #RRWNY           Item age days u
     C                     Z-ADDOMTIDT    #RTRDT           Prod OvrAge Frm
     C                     Z-ADDOMTJDT    #RTSDT           Prod OvrAge To
      * If errors during upload, flag detail line as error.  P001251
      * CASE: RCD.Order Line Error Type is Upload Error Pending
     C           #1H1ST    IFEQ 'DD'                       *IF
     C           #1H1ST    OREQ 'HD'
     C           #1H1ST    OREQ 'IT'
     C           #1H1ST    OREQ 'AC'
     C           #1H1ST    OREQ 'WT'
     C           #1H1ST    OREQ 'PA'
     C           #1H1ST    OREQ 'SL'
     C           #1H1ST    OREQ 'DT'
     C           #1H1ST    OREQ 'ME'
     C                     MOVEL'1'       *IN84            *Re-read Subfil
     C                     MOVELWUHPT1    #CHPT1           Description Usr
     C                     MOVEL'Y'       P7QKST           Display Flag
     C                     END                             *FI
      * fp1309
      * report how age is populated  by days or overridden by dates
      * CASE: DB1.Production Ovr AgeDte Fr is Entered
     C           OMTIDT    IFNE *ZERO                      *IF
     C                     MOVEL'O'       #RI0ST           Override Age Da
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RI0ST           Override Age Da
     C                     END                             *FI
     C                     MOVELOMKXCD    YL0010           USR Country Cod
      * FOR "OR" type only ---  get it in case it has been changed
      * CASE: DB1.OD Production Plan Sts is Yes
     C           OMR1ST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       #ROWSC           OD Production P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELOMR1ST    #ROWSC           OD Production P
     C                     END                             *FI
      * Retrieve prod plan sts                                FP1054
      * CASE: CTL.Order Type - Sales is Regular Order
     C           #2JNCD    IFEQ 'OR'                       *IF
      * Bypass company item ext for PORKSCHE5.
      * CASE: LCL.User Code Model is Production Sched 5
     C           YL0011    IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Plan Prod Sts All XF - Company Item Ext  * 
     C                     CALL 'PVBLXFR'              90  Rtv Plan Prod S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0141  30       Company Number
     C                     PARM #1HGCD    WQ0142  70       Item Code
     C                     PARM *BLANK    WQ0143  1        Produce on Sund
     C                     PARM *BLANK    WQ0144  1        Produce on Mond
     C                     PARM *BLANK    WQ0145  1        Produce on Tues
     C                     PARM *BLANK    WQ0146  1        Produce on Wedn
     C                     PARM *BLANK    WQ0147  1        Produce on Thur
     C                     PARM *BLANK    WQ0148  1        Produce on Frid
     C                     PARM *BLANK    WQ0149  1        Produce on Satu
     C           YL0012    PARM *BLANK    WQ0150  1        Plan Production
     C                     PARM *BLANK    WQ0151  1        Allocation Meth
     C                     PARM *BLANK    WQ0152  1        Adjust Credit P
     C                     PARM *BLANK    WQ0153  2        CIE Use Age Day
     C                     PARM *BLANK    WQ0154  2        CIE MPR Report
     C                     PARM *ZERO     WQ0155 112       CIE Unused Numb
     C                     PARM *ZERO     WQ0156 110       CIE Unused Numb
     C                     PARM *ZERO     WQ0157  70       CIE Unused Date
     C                     PARM *BLANK    WQ0158 25        CIE TPM Equipme
     C                     PARM *BLANK    WQ0159  6        CIE Capacity Co
     C                     PARM *BLANK    WQ0160  1        Record Status
     C           YL0013    PARM *BLANK    WQ0161  1        USR Return Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * CASE: LCL.USR Return Code is Exists
     C           YL0013    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       #ROWSC           OD Production P
      * CASE: LCL.OD Production Plan Sts is No
     C           YL0012    IFEQ 'N'                        *IF
     C                     MOVELYL0012    #ROWSC           OD Production P
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.OD Production Plan Sts is Yes
     C           OMR1ST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       #ROXSC           Plan Production
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #ROXSC           Plan Production
     C                     END                             *FI
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                     CALL 'PNS7XFR'              90  RTV PrcMthTyp/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0162  30       Company Number
     C                     PARM #1Q7CD    WQ0163  3        Price Method Co
     C           #RV8ST    PARM *BLANK    WQ0164  1        Price Method Ty
     C           YL0014    PARM *BLANK    WQ0165  1        PMH Price Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9835  *
     C                     END
      * Set display/hide attributes.
     C                     EXSR UASUBR                     Set display/hid
      * Price Code: See if max weight exceeded.   PK0519 10/23/03 RMC
      * CASE: RCD.Price Code is Entered
     C           #1BVTM    IFGT *ZERO                      *IF
      * Do this here in case its coming from the Copy Template, or the ma
      *
     C                     Z-ADD*ZERO     WN0001 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0002 112       Total Quantity
     C                     Z-ADD*ZERO     WN0003 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0004 114       Customer Price_
     C                     MOVEL*BLANK    WN0005  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       WUECST           Error Status
     C           *ZERO     MULT #1AVWG    YL0015           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1BKC7    PABKC7           Ship To Custome
     C                     Z-ADD#1BVTM    PABVTM           Price Code
     C                     Z-ADD#1HGCD    PAHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C           WN0001    PARM WN0001    WQ0166 112       Total Weight Or
     C                     PARM *ZERO     WQ0167  70       Order Number
     C           WN0002    PARM WN0002    WQ0168 112       Total Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983733*
     C                     END
     C                     ADD  YL0015    WN0001           Total Weight Or
     C                     ADD  *ZERO     WN0002           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0169  70       Ship To Custome
     C                     PARM #1BVTM    WQ0170  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0171  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0172  70       Price End Date
     C                     PARM #1HGCD    WQ0173  70       Item Code
     C           WN0003    PARM *ZERO     WQ0174 112       Maximum Contrac
     C           WN0004    PARM *ZERO     WQ0175 114       Customer Price_
     C           #1LQCD    PARM *BLANK    WQ0176  3        Commodity Marke
     C           YL0016    PARM *BLANK    WQ0177  3        Price Method Co
     C           #1RDCD    PARM *BLANK    WQ0178  3        Date Method Cod
     C           WN0005    PARM *BLANK    WQ0179  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983733*
     C                     SETON                     3936  *
     C                     END
     C                     MOVELYL0016    #1Q7CD           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0010           Company Number
     C                     MOVELYL0016    WL0011    P      Price Method Co
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    P7V8ST    P      Price Method Ty
     C                     MOVELWL0013    YL0014    P      PMH Price Type
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0005    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0001    IFGT WN0003                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0001    SUB  WN0003    YL0017           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0001           Price Code
     C                     Z-ADDYL0017    ZA0002           Weight Allocate
     C                     Z-ADDWN0003    ZA0003           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983733*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0002    IFGT WN0003                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0002    SUB  WN0003    YL0017           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0005           Price Code
     C                     Z-ADDYL0017    ZA0006           Weight Allocate
     C                     Z-ADDWN0003    ZA0007           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0008           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983733*
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     Z-ADDWN0004    #1BZPR           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0014    IFEQ 'I'                        *IF
     C                     Z-ADDWN0004    #1BZPR           Price Overage O
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0014    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     Z-ADDWN0004    #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chk Item Cntrct Exist RT - Customer Price Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0014           Ship To Custome
     C                     Z-ADD#1HGCD    WL0015           Item Code
     C                     Z-ADD#1AODT    WL0017           Scheduled Ship
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    #RCNSZ    P      Cust Item Cntrc
     C                     MOVEL#1F5SX    #RQRU1           Pallet Type NOR
      * INIT: Pallet Type                                 9/16/21 WI464
      * CASE: Pallet Type is blank AND Palletize flag = Y
      *  - c1 AND c2
      *   |- c1    : RCD.Pallet Type NOREF is Not entered
      *   |- c2    : RCD.Palletize is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RQRU1    IFEQ *BLANK                     *IF
     C           #1VEST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Pallet Type/Desc  XF - Customer EXT2  * 
     C                     CALL 'PUTPXFR'              90  Rtv Pallet Type
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0180  70       Ship To Custome
     C           #RQRU1    PARM *BLANK    WQ0181  2        PM Pallet Type
     C                     PARM *BLANK    WQ0182 15        PM Description
     C                     PARM *BLANK    WQ0183  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9843  *
     C                     END
      * If Pallet Type is still blank, default to #1 Pallet
      * CASE: RCD.Pallet Type NOREF is Not entered
     C           #RQRU1    IFEQ *BLANK                     *IF
     C                     MOVEL'01'      #RQRU1           Pallet Type NOR
     C                     END                             *FI
     C                     END                             *FI
      * WI firm order defaults
      * Exc Price type        XF - Customer EXT2  * 
     C                     CALL 'PUV8XFR'              90  Exc Price type
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #PBKC7    WQ0184  70       Ship To Custome
     C           YL0020    PARM *BLANK    WQ0185  3        Cust Dft Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUV8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Cust default price type
      * CASE: LCL.Cust Dft Price Type is *NONE
     C           YL0020    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.OD Price Type is *NONE
     C           #1F7SX    IFEQ *BLANK                     *IF
     C                     MOVELYL0020    #1F7SX           OD Price Type
     C                     END                             *FI
     C                     END                             *FI
      * INIT: Price Type Prior Record
      * CASE: PAR.OD Price Type is *NONE
     C           P7F7SX    IFEQ *BLANK                     *IF
     C                     MOVEL#1F7SX    P7F7SX           OD Price Type
     C                     END                             *FI
     C                     Z-ADDOMCCQT    #RH1QT           Scheduled Quant
     C                     Z-ADDOMAKPR    #RDTPR           Unit Price (DSP
      * 9/10/08 SAZ
      * INIT: Price type ref nbr Prior Record
      * CASE: PAR.OD Price Type Ref Num is Zero
     C           P5NWDT    IFEQ 0                          *IF
     C                     Z-ADD#1NWDT    P5NWDT           OD Price Type R
     C                     END                             *FI
      * INIT: Palletize Prior Record
      * CASE: PAR.Palletize is Not Yes
     C           P1VEST    IFEQ *BLANK                     *IF
     C           P1VEST    OREQ 'N'
      * CASE: RCD.Palletize is yes
     C           #1VEST    IFEQ 'Y'                        *IF
     C                     MOVEL#1VEST    P1VEST           Palletize
     C                     END                             *FI
     C                     END                             *FI
      * changed to db1.od pallet type from rcd.
     C                     MOVELOMF5SX    #RQRU1           Pallet Type NOR
      * INIT: Palletize Type                                WI464 10/04/2
      * CASE: PAR.OD Pallet Type is None
     C           P5F5SX    IFEQ *BLANK                     *IF
      * CASE: RCD.Pallet Type NOREF is Entered
     C           #RQRU1    IFNE *BLANK                     *IF
     C                     MOVEL#RQRU1    P5F5SX           OD Pallet Type
     C                     END                             *FI
     C                     END                             *FI
      * INIT: Item Age Days
      * CASE: PAR.Item Age Days is Not Entered
     C           P5RINY    IFEQ *ZERO                      *IF
     C                     Z-ADD#1RINY    P5RINY           Item Age Days
     C                     END                             *FI
      * 12/17/08 PKD
      * INIT: Pricing Method Prior Record
      * CASE: PAR.Price Method Code is Blank
     C           P5Q7CD    IFEQ *BLANK                     *IF
     C                     MOVEL#1Q7CD    P5Q7CD           Price Method Co
     C                     END                             *FI
      * INIT: Date Method Code Prior Record
      * CASE: PAR.Date Method Code is Not Entered
     C           P5RDCD    IFEQ *BLANK                     *IF
     C                     MOVEL#1RDCD    P5RDCD           Date Method Cod
     C                     END                             *FI
      * Rtv Deduct/Add Exist  XF - Order Detail Accrual  * 
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
     C                     Z-ADD#1DPNB    PBDPNB           Order Sequence
     C                     Z-ADD#1UENB    PBUENB           Order Secondary
      *
     C                     CALL 'PNMHXFR'              90  Rtv Deduct/Add
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Order Deta
     C           #RGLST    PARM *BLANK    WQ0186  1        Deduct/Add Sts
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Test for Company Org, MPR sent to USDA or line cancelled
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : PAR.Company Organization is Not Seaboard
      *   |- c2    : RCD.OD MPR Sent to USDA Sts is yes
      *   |- c3    : RCD.Detail Line Status is Cancelled
      *   '-
     C           P9YJSX    IFEQ 'D'                        *IF
     C           P9YJSX    OREQ 'H'
     C           #1HOST    OREQ 'Y'                        *OR
     C           #1GMST    OREQ 'X'                        *OR
     C                     MOVEL'Y'       #RD2TX           Status Flag 21
     C                     END                             *FI
      * If EDI & DSysco or Sysco, see if item exists on EDI PO   E004140
      * CASE: PAR.Customer Purchase Order # is NE Blank
     C           P1BCNA    IFNE *BLANK                     *IF
      * CASE: RCD.Item Code is Entered
     C           #1HGCD    IFNE *ZERO                      *IF
      * CASE: RCD.Detail Line Status is Not cancelled
     C           #1GMST    IFEQ 'L'                        *IF
     C           #1GMST    OREQ 'A'
     C           #1GMST    OREQ 'C'
     C           #1GMST    OREQ 'R'
     C           #1GMST    OREQ 'E'
     C           #1GMST    OREQ 'H'
     C           #1GMST    OREQ 'I'
     C                     MOVEL'N'       P7QKST           Display Flag
      * Rtv Trade Prtnr Info  XF - EDI Purchase Order Header  * 
     C                     CALL 'PBRYXFR'              90  Rtv Trade Prtnr
     C                     PARM *BLANK    W0RTN   7
     C           YL0021    PARM *ZERO     WQ0187  90       ST02-TRANS SET
     C                     PARM P1BCNA    WQ0188 22        G5003-PURCHASE
     C           YL0022    PARM *BLANK    WQ0189  6        EDI Trading Par
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDI Trading Partner No. is SYSCO Dailys
      *   |- c2    : LCL.EDI Trading Partner No. is SYSCO Foods
      *   '-
     C           YL0022    IFEQ @CN,006                    *IF
     C           YL0022    OREQ 'SYSCO'                    *OR
      * Convert Seaboards 7.0 item to EDI 14 char product id
      * Then remove leading zeros
     C                     MOVEL*BLANK    YL0023           Item Code Txt
     C                     MOVEL#1HGCD    YL0023           Item Code Txt
     C                     MOVEL*BLANK    WUCUNA           USR Hold Descri
     C                     MOVELYL0023    WUCUNA           USR Hold Descri
      * CLC Remove LeadZeros 30US - /UT User Source  * 
     C                     MOVEAWUCUNA    AR1              LOAD ARRAY
     C                     Z-ADD1         X       20       SET COUNTER
     C                     Z-ADD1         Y       20       SET COUNTER
     C                     MOVE 'N'       STOP    1        FLAG
     C           X         DOWLT31
     C           AR1,X     IFEQ '0'
     C           STOP      ANDEQ'N'
     C                     ADD  1         X
     C                     ELSE
     C                     MOVE AR1,X     AR2,Y
     C                     ADD  1         Y
     C                     ADD  1         X
     C                     MOVE 'Y'       STOP
     C                     END
     C                     END
     C                     MOVEAAR2       WUJNNA           LOAD OUTPUT
     C                     MOVELWUJNNA    YL0024           G6806/P109 PROD
      * See if item exists on EDI PO Detail (we don't care about GTIN her
      * RTV GTIN for SBD Prod XF - EDI Purchase Order Detail  * 
     C                     CALL 'PBRZXFR'              90  RTV GTIN for SB
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0021    WQ0190  90       ST02-TRANS SET
     C           YL0025    PARM *BLANK    WQ0191 15        G6804/P107 UPC/
     C                     PARM YL0024    WQ0192 10        G6806/P109 PROD
     C           YL0026    PARM YL0026    WQ0193  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Return Code Usr is *Record does not exist
     C           YL0026    IFEQ @CN,007                    *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,008   CAT  @CN,009:ZQ#CHPT1    P      Description Usr
     C                     MOVEL'Y'       P7QKST           Display Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CHPT1           Description Usr
     C                     MOVEL'N'       P7QKST           Display Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RMC 4/5/23 added this to set cursor on 1st rcd (it was setting on
      * CASE: PAR.USR Display field is yes
     C           P7GGST    IFEQ 'Y'                        *IF
      * CASE: LCL.First time flag 3 is Yes
     C           YL0027    IFEQ 'Y'                        *IF
      * *Set Cursor: RCD.*SFLSEL  (*Override=*YES)
     C                     Z-ADD##RR      W0RR0
     C           ZZSFM     IFEQ '1'
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ELSE
     C           ##SFPG    DIV  002       ##RRN   50
     C           ##RR      DIV  ##RRN     ##RRC   50
     C                     MVR            ##RRC
     C           ##RRC     IFEQ 0
     C                     Z-ADD##RRN     ##RRC
     C                     ENDIF
     C           ##RRC     DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ENDIF
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C           ZZSFM     IFEQ '0'
     C                     MULT 002       W0ROW0
     C                     ENDIF
     C                     ADD  016       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
     C                     MOVEL'N'       YL0027           First time flag
     C                     END                             *FI
     C                     END                             *FI
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
     C                     ELSE
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile record (new record)
      * RCD = PAR By name
     C                     MOVELP5AJCD    #1AJCD           Warehouse Code
     C                     MOVELP5Q7CD    #1Q7CD           Price Method Co
     C                     MOVELP7V8ST    #RV8ST           Price Method Ty
     C                     MOVELP5RDCD    #1RDCD           Date Method Cod
     C                     Z-ADDP5EXDT    #1EXDT           Market Pricing
     C                     MOVELP5LQCD    #1LQCD           Commodity Marke
     C                     Z-ADDP5RINY    #1RINY           Item Age Days
     C                     MOVELP5RPCD    #1RPCD           Age Code
     C                     MOVELP1VEST    #1VEST           Palletize
     C                     MOVELP5F5SX    #1F5SX           OD Pallet Type
     C                     MOVELP1VGST    #1VGST           Slip Sheet
     C                     MOVELP5AMST    #1AMST           Affect Inventor
     C                     MOVELP5ANST    #1ANST           Affect Sales Do
     C                     MOVELP5VAST    #1VAST           Affect Sales Pn
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
     C                     MOVELP7GGST    #RGGST           USR Display fie
     C                     MOVELP1R4CD    #1R4CD           Sales Route Cod
     C                     MOVELP1GTST    #1GTST           Comment Print A
     C                     MOVELP1GVST    #1GVST           Comment Print I
     C                     MOVELP1GUST    #1GUST           Comment Print P
     C                     MOVELP1QFST    #1QFST           Comment Print S
     C                     MOVELP5KXCD    #1KXCD           Country Code
     C                     MOVELP6AJVN    #1AJVN           User Profile Na
     C                     Z-ADDP1A5DT    #1A5DT           Requested Ship
     C                     MOVELP1JPCD    #1JPCD           Event Code
     C                     Z-ADDP1AODT    #1AODT           Scheduled Ship
     C                     MOVELP7F7SX    #1F7SX           OD Price Type
     C                     Z-ADDP5NWDT    #1NWDT           OD Price Type R
     C                     Z-ADDP5TIDT    #1TIDT           Production Ovr
     C                     Z-ADDP5TJDT    #1TJDT           Production Ovr
     C                     Z-ADDP5AVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * RTV Affect Fields      RT - OP Order Types  * 
     C                     EXSR SQRVGN
      * Establish Screen Fields or clear them
     C                     EXSR UBSUBR                     Establish Scree
      * CASE: WRK.Type Code is Inter Company
     C           WUBOCD    IFEQ 'IC'                       *IF
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     MOVEL'N'       #RASTS           USR Display 3
     C                     END                             *FI
      * CASE: PAR.Company Organization is Not Seaboard
     C           P9YJSX    IFEQ 'D'                        *IF
     C           P9YJSX    OREQ 'H'
     C                     MOVEL'Y'       #RD2TX           Status Flag 21
     C                     END                             *FI
     C                     END
     C                     END
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
     C           W0PMD     IFNE 'ADD'
      * 82=EOF
     C           KRST      READE@BGWKL1                  82*
     C                     END
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * CASE: CTL.*CMD key is *Option Toggle
     C           *IN08     IFEQ '1'                        *IF
      * CASE: PAR.USR Display field is yes
     C           P7GGST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P7GGST           USR Display fie
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P7GGST           USR Display fie
      * W125163 RMC 04/05/23-Override Cursor and set flag to set cursor o
      * *Set Cursor: RCD.*SFLSEL  (*Override=*YES)
     C                     Z-ADD##RR      W0RR0
     C           ZZSFM     IFEQ '1'
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ELSE
     C           ##SFPG    DIV  002       ##RRN   50
     C           ##RR      DIV  ##RRN     ##RRC   50
     C                     MVR            ##RRC
     C           ##RRC     IFEQ 0
     C                     Z-ADD##RRN     ##RRC
     C                     ENDIF
     C           ##RRC     DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ENDIF
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C           ZZSFM     IFEQ '0'
     C                     MULT 002       W0ROW0
     C                     ENDIF
     C                     ADD  016       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
      * RMC set this so the cursor gets set on SFL RRN 1
     C                     MOVEL'Y'       YL0027           First time flag
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'1'       *IN84            *Re-read Subfil
     C                     END                             *FI
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      * Switch between *ADD/*CHANGE modes
     C   09                EXSR FACHMD
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
     C                     MOVEL'N'       P7QKST           Display Flag
      * RTV Weight Ord & Sched RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     Z-ADD#CAVQT    WL0005           Quantity Ordere
     C                     Z-ADD#CD0WG    WL0006           Weight Ordered
     C                     Z-ADDP1A1WG    WL0007           Weight Schedule
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #CAVQT           Quantity Ordere
     C                     Z-ADDWL0006    #CD0WG           Weight Ordered
     C                     Z-ADDWL0007    P1A1WG           Weight Schedule
      * CHG Order Value,Wgt,Ex CH - Order Header TRG  * 
     C                     EXSR SRCHRC
      * Abs.Frt/Wgt
      * CASE: PAR.Load ID is NE Blank
     C           P1RMNB    IFNE *ZERO                      *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - Order Header TRG  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0203  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0204  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0205 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Transfer to Order Header
      * CASE: CTL.*CMD key is *Order Header
     C           *IN15     IFEQ '1'                        *IF
     C                     MOVEL@CN,010   P3BYVN           Next Program Na
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Transfer to More Details
      * CASE: CTL.*CMD key is *Order Details
     C           *IN18     IFEQ '1'                        *IF
     C                     MOVEL@CN,011   P3BYVN           Next Program Na
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F16=Product Availability     Disable if Live w/TPM    E004019
      * CASE: CTL.*CMD key is *Product Availability
     C           *IN16     IFEQ '1'                        *IF
      * WW Product Availablty DF - Company Item Avail Group  * 
     C                     CALL 'PDFPDFR'              90  WW Product Avai
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0206  30       Company Number
     C                     PARM P5AJCD    WQ0207  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFPDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Add Ham Group.
     C                     EXSR UCSUBR                     Add Ham Group.
      * F17 = dsp fresh <-> frozen
      * CASE: CTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * Dsp FR/FZ Item Codes  DF - Item Fresh Frozen Master  * 
     C                     CALL 'PBQBDFR'              90  Dsp FR/FZ Item
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBQBDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * F20 = Post
      * CASE: CTL.*CMD key is *Post/Update Open Order
     C           *IN20     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'Y'       WUAJTX           Status Flag 5
      * ** 12/05/08 LJB add Fax to Customer
     C                     MOVEL'N'       WUAKTX           Status Flag 7
      * ** 03/12/13 slm add email on Acknowledgement by the Warehouse Dis
     C                     MOVEL'N'       WUAFTX           Status Flag 8
     C                     MOVEL'N'       WUDITX           Status Flag 12
     C                     MOVEL*BLANK    WURJAA           Email to Wareho
     C                     MOVEL*BLANK    YL0030           OH Load Plan Re
      * * Default lcl.lpr to Ord Hdr value                    E004119
      * 08/21/2017 DN T11489-Added Salesperson Code/Name to Parm.
      * 08/06/24 SP S312312-Start (Get field "Email to Broker Usr")
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0209  1        Status - Y or N
     C                     PARM #2AIC3    WQ0210  30       Company Number
     C                     PARM #2C4NB    WQ0211  70       Order Number
     C                     PARM #PBKC7    WQ0212  70       Ship To Custome
     C                     PARM P1BCST    WQ0213  1        Block Order Fla
     C           YL0030    PARM YL0030    WQ0214  2        OH Load Plan Re
     C           WUDTSX    PARM WUDTSX    WQ0215  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0216  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0217  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0218  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0219  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0220  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0221  1        Status Flag 7
     C           WUAFTX    PARM WUAFTX    WQ0222  1        Status Flag 8
     C           WUDITX    PARM WUDITX    WQ0223  1        Status Flag 12
     C           WURJAA    PARM WURJAA    WQ0224  3        Email to Wareho
     C           WUVQSX    PARM WUVQSX    WQ0225  1        Email Selection
     C           P6BCCD    PARM P6BCCD    WQ0226  3        Salesperson Cod
     C           YL0031    PARM YL0031    WQ0227 30        Salesperson Nam
     C           YL0032    PARM YL0032    WQ0228  1        Email to Broker
     C           YL0033    PARM YL0033    WQ0229  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 08/06/24 SP S312312-End
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P3BYVN           Next Program Na
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0230  30       Company Number
     C                     PARM #2C4NB    WQ0231  70       Order Number
     C                     PARM #PBKC7    WQ0232  70       Ship To Custome
     C           WUNFNN    PARM WUNFNN    WQ0233 112       Order Value Tot
     C           WUNFNN    PARM *ZERO     WQ0234 112       Order Weight To
     C                     PARM YL0010    WQ0235  6        USR Country Cod
     C                     PARM P5AJCD    WQ0236  3        USR Warehouse C
     C                     PARM 'OE'      WQ0237  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Acknowledgement if flag is yes from the confirm prompt
      * CASE: Print report then email
      *  - c1 OR c2 OR c3
      *   |- c1    : WRK.Print (Yes/No) USR is Yes
      *   |- c2    : WRK.Status Flag 8  Y/N is Yes
      *   |- c3    : LCL.Email to Salesperson Usr is Yes
      *   '-
     C           WUDTSX    IFEQ 'Y'                        *IF
     C           WUAFTX    OREQ 'Y'                        *OR
     C           YL0033    OREQ 'Y'                        *OR
      * or if email is requested
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,012   WQ0238 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0239 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0240  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0241  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0242  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0243  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0244 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0245  6        Application Cod
     C                     PARM WUA7ST    WQ0246  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,013                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Print (Yes/No) USR is No
     C           WUDTSX    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    WUWRST           PRT Printer Dev
     C                     END                             *FI
      * SBMJOB: PRT Acknowledgements UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PDJWPCLP'#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#2AIC3    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Thru Date Pass
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Order Type_Sale
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUOTTX    #SSTR     P      Shipping Method
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'1'       #SSTR     P      Billing Activit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'A'       #SSTR     P      Export Sales
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR Warehouse C
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 1
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 2
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 3
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 4
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 5
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 6
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 7
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 8
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 9
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'S'       #SSTR     P      USR Select/Omit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 3
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUQ5ST    #SSTR     P      Email To Whs
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWURJAA    #SSTR     P      Email to Wareho
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0033    #SSTR     P      Email to Salesp
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PDJWPCLP'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Print Get Ready Report if flag is yes from the confirm prompt
      * CASE: WRK.Status Flag 5  Y/N is Yes
     C           WUAJTX    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,014   WQ0247 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0248 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0249  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0250  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0251  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0252  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0253 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0254  6        Application Cod
     C                     PARM WUA7ST    WQ0255  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,013                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * SBMJOB: PRT Get Ready Report   UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0002    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PMH5UPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#2AIC3    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Department Code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 6         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PMH5UPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMH5UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * 08/06/24 SP S312312-Start (Add new condition c5)
      * Fax Acknwlgmnt to buyer/fld/brkr/cust if flag=yes f/confirm pmt
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : WRK.Status Flag 4  Y/N is yes
      *   |- c2    : WRK.Status Flag 2  Y/N is Yes
      *   |- c3    : WRK.Status Flag 3  Y/N is Yes
      *   |- c4    : WRK.Status Flag 7  Y/N is Yes
      *   |- c5    : LCL.Email to Broker Usr is Yes
      *   '-
     C           WUFMST    IFEQ 'Y'                        *IF
     C           WUQ2ST    OREQ 'Y'                        *OR
     C           WUQ3ST    OREQ 'Y'                        *OR
     C           WUAKTX    OREQ 'Y'                        *OR
     C           YL0032    OREQ 'Y'                        *OR
      * RMC  06/23/04      LJB 12/03/2008
      * ** Status Flag 2=Buyer Fax/email, Status Flag 3=Regional Sales Ma
      * ** Status Flag 4=Broker Fax-which is not used at this level
      * ** Status Flag 7=Customer Fax
      * 08/21/2017 DN T11489-Added Salesperson Code to Parm.
      * EXC Fax Acknwgmnt     XF - Order Header TRG  * 
     C                     CALL 'PPFDXFR'              90  EXC Fax Acknwgm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0256  30       Company Number
     C                     PARM #2C4NB    WQ0257  70       Order Number
     C                     PARM #PBKC7    WQ0258  70       Ship To Custome
     C                     PARM P1FXSX    WQ0259  3        HPB Ship to War
     C                     PARM P6BCCD    WQ0260  3        Salesperson Cod
     C                     PARM WUQ2ST    WQ0261  1        USR Update Flag
     C                     PARM WUQ3ST    WQ0262  1        USR Check Y/N S
     C                     PARM WUFMST    WQ0263  1        Status - Y or N
     C                     PARM WUAKTX    WQ0264  1        Status Flag 7
     C                     PARM YL0032    WQ0265  1        Email to Broker
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPFDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * 08/06/24 SP S312312-End
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
      * F22 = Post/Price -- return to this pgm
      * CASE: CTL.*CMD key is CF22
     C           *IN22     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
     C                     MOVEL'Y'       WUAJTX           Status Flag 5
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0266  30       Company Number
     C                     PARM #2C4NB    WQ0267  70       Order Number
     C                     PARM #PBKC7    WQ0268  70       Ship To Custome
     C           WUNFNN    PARM WUNFNN    WQ0269 112       Order Value Tot
     C           WUNFNN    PARM *ZERO     WQ0270 112       Order Weight To
     C                     PARM YL0010    WQ0271  6        USR Country Cod
     C                     PARM P5AJCD    WQ0272  3        USR Warehouse C
     C                     PARM 'OE'      WQ0273  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    P3BYVN           Next Program Na
     C                     MOVEL'PDN9EFR' P3BYVN           Next Program Na
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * No SFLNXTCHG
     C                     SETOF                     84
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           W0PMD     IFEQ 'ADD'
      * Check for null record
     C                     EXSR DDNLRC
     C           W0NLR     IFEQ 'Y'
     C           ##RR      ANDNEYPMRRN
      * Clear all record fields
     C                     EXSR MAIZ#1
     C                     GOTO DCEXIT
     C                     END
      * If not null record, continue
     C                     END
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DDNLRC    BEGSR
      *================================================================
      * Check for null record
      *================================================================
     C                     MOVEL'N'       W0NLR   1
     C           #RHHQT    CABNE*ZERO     DDEXIT           Qty Ordered USR
     C           V1HGCD    CABNE*BLANK    DDEXIT           Item Code
     C           #1BZPR    CABNE*ZERO     DDEXIT           Price Overage O
     C           #1Q7CD    CABNE*BLANK    DDEXIT           Price Method Co
     C           #1RDCD    CABNE*BLANK    DDEXIT           Date Method Cod
     C           #1BVTM    CABNE*ZERO     DDEXIT           Price Code
     C           V1EXDT    CABNE*ZERO     DDEXIT           Market Pricing
     C           #1LQCD    CABNE*BLANK    DDEXIT           Commodity Marke
     C           #1A1AA    CABNE*ZERO     DDEXIT           Ham Group Numbe
     C           #1RINY    CABNE*ZERO     DDEXIT           Item Age Days
     C           #1VEST    CABNE*BLANK    DDEXIT           Palletize
     C           #RQRU1    CABNE*BLANK    DDEXIT           Pallet Type NOR
     C           #1VGST    CABNE*BLANK    DDEXIT           Slip Sheet
     C           #1F7SX    CABNE*BLANK    DDEXIT           OD Price Type
     C           #1HPST    CABNE*BLANK    DDEXIT           OD MPR Prc Read
     C           #ROWSC    CABNE*BLANK    DDEXIT           OD Production P
     C           V1CXDT    CABNE*ZERO     DDEXIT           Date of Origina
     C           #1H2ST    CABNE*BLANK    DDEXIT           OD Spot Buy
     C                     MOVEL'Y'       W0NLR
      *================================================================
     CSR         DDEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,015                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     Z-ADD*ZERO     #1HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Market Pricing Date
      * External date
     C                     Z-ADDV1EXDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9838  *
     C                     END
     C                     Z-ADDXDINDT    #1EXDT
      * Validate Palletize
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VEST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * Palletize
     C                     MOVEL#1VEST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVEST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHVEST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHVEST
     C                     ENDSL
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD16        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD104       YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
     C                     EXFMTZGVEST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVEST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHVEST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VEST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Slip Sheet
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VGST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * Slip Sheet
     C                     MOVEL#1VGST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVGST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHVGST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHVGST
     C                     ENDSL
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD16        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD113       YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG02RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG02CL
     C                     EXFMTZGVGST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVGST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHVGST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VGST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate OD Price Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1F7SX'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * OD Price Type
     C                     MOVEL#1F7SX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHF7SX
     C                     SELEC
     C           W0INVL    WHEQ 'FRM'                      FRM
     C                     Z-ADD1         ZHF7SX
     C           W0INVL    WHEQ 'CON'                      CON
     C                     Z-ADD2         ZHF7SX
     C           W0INVL    WHEQ 'NEG'                      NEG
     C                     Z-ADD3         ZHF7SX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHF7SX
     C           W0INVL    WHEQ 'HDG'                      HDG
     C                     Z-ADD5         ZHF7SX
     C           W0INVL    WHEQ 'DST'                      DST
     C                     Z-ADD6         ZHF7SX
     C           W0INVL    WHEQ 'NHT'                      NHT
     C                     Z-ADD7         ZHF7SX
     C           W0INVL    WHEQ 'TNK'                      TNK
     C                     Z-ADD8         ZHF7SX
     C           W0INVL    WHEQ 'FLR'                      FLR
     C                     Z-ADD9         ZHF7SX
     C                     ENDSL
      * Window width
     C                     Z-ADD19        YWWDWD
      * Window depth
     C                     Z-ADD9         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD16        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD117       YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG03RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG03CL
     C                     EXFMTZGF7SX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHF7SX    WHEQ 1
     C                     MOVEL'FRM'     W0INVL           FRM
     C           ZHF7SX    WHEQ 2
     C                     MOVEL'CON'     W0INVL           CON
     C           ZHF7SX    WHEQ 3
     C                     MOVEL'NEG'     W0INVL           NEG
     C           ZHF7SX    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHF7SX    WHEQ 5
     C                     MOVEL'HDG'     W0INVL           HDG
     C           ZHF7SX    WHEQ 6
     C                     MOVEL'DST'     W0INVL           DST
     C           ZHF7SX    WHEQ 7
     C                     MOVEL'NHT'     W0INVL           NHT
     C           ZHF7SX    WHEQ 8
     C                     MOVEL'TNK'     W0INVL           TNK
     C           ZHF7SX    WHEQ 9
     C                     MOVEL'FLR'     W0INVL           FLR
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1F7SX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate OD MPR Prc Ready to Send
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1HPST    W0NSRQ  1        OD MPR Prc Read
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1HPST'  OREQ YPMTFD
     C           ##RR      ANDEQYPMRRN
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2064688   Y2LSNO  70
     C           #1HPST    PARM #1HPST    W0EXVL 25        OD MPR Prc Read
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate OD Production Plan St USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#ROWSC'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * OD Production Plan St USR
     C                     MOVEL#ROWSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHOWSC
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHOWSC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHOWSC
     C                     ENDSL
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD16        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD129       YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG04RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG04CL
     C                     EXFMTZGOWSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHOWSC    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHOWSC    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #ROWSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Date of Original Entry
      * External date
     C                     Z-ADDV1CXDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9848  *
     C                     END
     C                     Z-ADDXDINDT    #1CXDT
      * Validate OD Spot Buy
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1H2ST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * OD Spot Buy
     C                     MOVEL#1H2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHH2ST
     C                     SELEC
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD1         ZHH2ST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD2         ZHH2ST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD3         ZHH2ST
     C                     ENDSL
      * Window width
     C                     Z-ADD10        YWWDWD
      * Window depth
     C                     Z-ADD3         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD17        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD119       YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG05RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG05CL
     C                     EXFMTZGH2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHH2ST    WHEQ 1
     C                     MOVEL'S'       W0INVL           S
     C           ZHH2ST    WHEQ 2
     C                     MOVEL'T'       W0INVL           T
     C           ZHH2ST    WHEQ 3
     C                     MOVEL'P'       W0INVL           P
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1H2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
     C                     MOVEL'N'       WUDTTX           Status Flag 19
      * WI firm order defaults
      * Exc Price type        XF - Customer EXT2  * 
     C                     CALL 'PUV8XFR'              90  Exc Price type
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #PBKC7    WQ0274  70       Ship To Custome
     C           YL0020    PARM *BLANK    WQ0275  3        Cust Dft Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUV8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Cust default price type
      * CASE: LCL.Cust Dft Price Type is *NONE
     C           YL0020    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.OD Price Type is *NONE
     C           #1F7SX    IFEQ *BLANK                     *IF
     C                     MOVELYL0020    #1F7SX           OD Price Type
     C                     END                             *FI
     C                     END                             *FI
      * INIT: Price Type Prior Record
      * CASE: PAR.OD Price Type is *NONE
     C           P7F7SX    IFEQ *BLANK                     *IF
     C                     MOVEL#1F7SX    P7F7SX           OD Price Type
     C                     END                             *FI
      * 9/10/08 SAZ
      * INIT: Price type ref nbr Prior Record
      * CASE: PAR.OD Price Type Ref Num is Zero
     C           P5NWDT    IFEQ 0                          *IF
     C                     Z-ADD#1NWDT    P5NWDT           OD Price Type R
     C                     END                             *FI
      * INIT: Palletize Prior Record
      * CASE: PAR.Palletize is Not Yes
     C           P1VEST    IFEQ *BLANK                     *IF
     C           P1VEST    OREQ 'N'
      * CASE: RCD.Palletize is yes
     C           #1VEST    IFEQ 'Y'                        *IF
     C                     MOVEL#1VEST    P1VEST           Palletize
     C                     END                             *FI
     C                     END                             *FI
      * INIT: Palletize Type  Prior record                9/16/21 WI464
      * CASE: PAR.OD Pallet Type is None
     C           P5F5SX    IFEQ *BLANK                     *IF
      * If Pallet Type is not blank, default PAR.OD Pallet Type
      * CASE: RCD.Pallet Type NOREF is Entered
     C           #RQRU1    IFNE *BLANK                     *IF
     C                     MOVEL#RQRU1    P5F5SX           OD Pallet Type
     C                     END                             *FI
     C                     END                             *FI
      * INIT: Item Age Days
      * CASE: PAR.Item Age Days is Not Entered
     C           P5RINY    IFEQ *ZERO                      *IF
     C                     Z-ADD#1RINY    P5RINY           Item Age Days
     C                     END                             *FI
      * INIT: Price Method Code Prior Record
      * CASE: PAR.Price Method Code is Blank
     C           P5Q7CD    IFEQ *BLANK                     *IF
     C                     MOVEL#1Q7CD    P5Q7CD           Price Method Co
     C                     END                             *FI
      * INIT: Date Method Code Prior Record
      * CASE: PAR.Date Method Code is Not Entered
     C           P5RDCD    IFEQ *BLANK                     *IF
     C                     MOVEL#1RDCD    P5RDCD           Date Method Cod
     C                     END                             *FI
      * Chk Item Cntrct Exist RT - Customer Price Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0014           Ship To Custome
     C                     Z-ADD#1HGCD    WL0015           Item Code
     C                     Z-ADD#1AODT    WL0017           Scheduled Ship
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    #RCNSZ    P      Cust Item Cntrc
      * Select on item
      * CASE: Select item
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> RCD.Item Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'V1HGCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: RCD.USR Display 1 is No
     C           #RTIST    IFEQ 'N'                        *IF
      * RMC added 9/24/19
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Actv FG by WHS    SR - Company Item  * 
     C                     CALL 'PNMQSRR'              90  SEL Actv FG by
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0276  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0277  70       Item Code
     C                     PARM P5AJCD    WQ0278  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Select Price Code  PK0519 10/20/03
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> RCD.Price Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#1BVTM'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0034           Price Code
      * Sel Customer Prc Hdr  SL - Customer Price Header  * 
     C                     CALL 'POPOSRR'              90  Sel Customer Pr
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0279  70       Ship To Custome
     C           YL0034    PARM YL0034    WQ0280  60       Price Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Price Code is Entered
     C           YL0034    IFGT *ZERO                      *IF
     C                     Z-ADDYL0034    #1BVTM           Price Code
     C                     END                             *FI
     C                     END                             *FI
      * Edt OD Pricing Dflts  XF - Order Detail  * 
     C                     CALL 'PNS2XFR'              90  Edt OD Pricing
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HGCD    WQ0281  70       Item Code
     C           #1EXDT    PARM #1EXDT    WQ0282  70       Market Pricing
     C           #1LQCD    PARM #1LQCD    WQ0283  3        Commodity Marke
     C           #1RDCD    PARM #1RDCD    WQ0284  3        Date Method Cod
     C           #1Q7CD    PARM #1Q7CD    WQ0285  3        Price Method Co
     C           #1BZPR    PARM #1BZPR    WQ0286 114       Price Overage O
     C           #1BVTM    PARM #1BVTM    WQ0287  60       Price Code
     C           #1DWPR    PARM #1DWPR    WQ0288 114       OD Ceiling Pric
     C           #1TKDT    PARM #1TKDT    WQ0289  70       OD Market Begin
     C           #1TLDT    PARM #1TLDT    WQ0290  70       OD Market Endin
     C                     PARM #1AIC3    WQ0291  30       Company Number
     C                     PARM #1BKC7    WQ0292  70       Ship To Custome
     C                     PARM WUBOCD    WQ0293  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983338*
     C                     SETON                     393635*
     C                     SETON                     3437  *
     C                     END
      * DEFAULT: Price Method Code w/Prior Record
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : RCD.Price Method Code is Blank
      *   |- c2    : RCD.Item Code is Entered
      *   |- c3    : PAR.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Q7CD    IFEQ *BLANK                     *IF
     C           #1HGCD    IFNE *ZERO                      *IF
     C           P9YJSX    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELP5Q7CD    #1Q7CD           Price Method Co
     C                     END                             *FI
      * DEFAULT: Date Method Code w/Prior Record
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6
      *   |- c1    : RCD.Date Method Code is Not Entered
      *   |- c2    : RCD.Item Code is Entered
      *   |- c3    : PAR.Company Organization is Seaboard
      *   |- c4    : RCD.Market Pricing Date is EQ Zero
      *   |- c5    : RCD.OD Market Begin Date is not entered
      *   |- c6    : RCD.OD Market Ending Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFEQ *BLANK                     *IF
     C           #1HGCD    IFNE *ZERO                      *IF
     C           P9YJSX    IFEQ 'S'                        *IF
     C           #1EXDT    IFEQ *ZERO                      *IF
     C           #1TKDT    IFEQ *ZERO                      *IF
     C           #1TLDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELP5RDCD    #1RDCD           Date Method Cod
     C                     END                             *FI
      * 10/30/23 JM JM00035 - Validate Prod Plan in Change mode
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * CASE: RCD.OD Production Plan St USR is Valid values
     C           #ROWSC    IFEQ 'N'                        *IF
     C           #ROWSC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#ROWSC    ZA0009           OD Production P
      * Send message 'Value must be Y/N'
     C                     MOVEL'USR5334' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9847  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * Defaults for Add Mode
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Add Mode Defaults.
     C                     EXSR UDSUBR                     Add Mode Defaul
     C                     ELSE
      * CASE: *OTHERWISE
      * If "MAN" price method then save Price Status.
      * CASE: RCD.Price Method Code is Manual
     C           #1Q7CD    IFEQ 'MAN'                      *IF
     C                     MOVEL#1U1ST    WUYBST           Price Status US
     C                     END                             *FI
     C                     END                             *FI
      * Set Default Market Code.
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : RCD.Price Method Code is Manual
      *   |- c2    : RCD.Price Method Code is Deviated Flat Duty Item
      *   |- c3    : RCD.Price Method Code is Deviated Gate Price
      *   '-
     C           #1Q7CD    IFEQ 'MAN'                      *IF
     C           #1Q7CD    OREQ 'DVF'                      *OR
     C           #1Q7CD    OREQ 'DVG'                      *OR
     C                     MOVEL*BLANK    #1RDCD           Date Method Cod
     C                     Z-ADD*ZERO     #1EXDT           Market Pricing
     C                     MOVEL*BLANK    #1LQCD           Commodity Marke
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Commodity Market Code EQ WRK.BLANK
     C           #1LQCD    IFEQ WUGSTX                     *IF
     C                     MOVELP5LQCD    #1LQCD           Commodity Marke
     C                     END                             *FI
     C                     END                             *FI
      * DEFAULT: Item Age Days
      * CASE:
      *  - c1 AND c2 AND (c3 AND c4)
      *   |- c1    : RCD.Item Age Days is Not Entered
      *   |- c2    : RCD.Item Code is Entered
      *   |- c3    : RCD.Production Ovr AgeDte Fr is not entered
      *   |- c4    : RCD.Production Ovr AgeDte To is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RINY    IFEQ *ZERO                      *IF
     C           #1HGCD    IFNE *ZERO                      *IF
     C           #1TIDT    IFEQ *ZERO                      *IF
     C           #1TJDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP5RINY    #1RINY           Item Age Days
     C                     END                             *FI
      * DEFAULT: Pallet Type                              9/16/21 WI464
      * CASE: RCD.Palletize is yes
     C           #1VEST    IFEQ 'Y'                        *IF
      * If Pallet Type is blank
      * CASE: RCD.Pallet Type NOREF is Not entered
     C           #RQRU1    IFEQ *BLANK                     *IF
      * If PAR.OD Pallet Type - blank
      * CASE: PAR.OD Pallet Type is None
     C           P5F5SX    IFEQ *BLANK                     *IF
     C                     MOVEL'02'      #RQRU1           Pallet Type NOR
     C                     MOVEL'02'      #1F5SX           OD Pallet Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP5F5SX    #RQRU1           Pallet Type NOR
     C                     MOVELP5F5SX    #1F5SX           OD Pallet Type
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RQRU1           Pallet Type NOR
     C                     MOVEL*BLANK    #1F5SX           OD Pallet Type
     C                     END                             *FI
      * DEFAULT: LAST PRICE TYPE
      * CASE: PAR.OD Price Type is Valid Values
     C           P7F7SX    IFEQ 'CON'                      *IF
     C           P7F7SX    OREQ 'FRM'
     C           P7F7SX    OREQ 'NEG'
     C           P7F7SX    OREQ 'HDG'
     C           P7F7SX    OREQ 'DST'
     C           P7F7SX    OREQ 'NHT'
     C           P7F7SX    OREQ 'TNK'
     C           P7F7SX    OREQ 'FLR'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.OD Price Type is *NONE
      *   |- c2    : RCD.Item Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1F7SX    IFEQ *BLANK                     *IF
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELP7F7SX    #1F7SX           OD Price Type
     C                     END                             *FI
      * CASE: RCD.OD Price Type is Contract
     C           #1F7SX    IFEQ 'CON'                      *IF
      * CASE: Default Price type ref number
      *  - c2ANDc3
      *   |- c2    : RCD.OD Price Type Ref Num is Zero
      *   |- c3    : PAR.OD Price Type Ref Num is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1NWDT    IFEQ 0                          *IF
     C           P5NWDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP5NWDT    #1NWDT           OD Price Type R
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1NWDT           OD Price Type R
     C                     END                             *FI
     C                     END                             *FI
      * Default : spot buy for SE
      * CASE: PAR.Company Organization is Not Seaboard
     C           P9YJSX    IFEQ 'D'                        *IF
     C           P9YJSX    OREQ 'H'
      * CASE: RCD.OD Spot Buy is No-blank
     C           #1H2ST    IFEQ *BLANK                     *IF
      * W77844 DN 06/12/21-Default Spot Buy to 'Turn' for SE.
     C                     MOVEL'T'       #1H2ST           OD Spot Buy
     C                     END                             *FI
     C                     END                             *FI
      * Seq #
      * CASE: RCD.Order Sequence Number is Equal to zero
     C           #1DPNB    IFEQ *ZERO                      *IF
     C           WUDPNB    ADD  1         #1DPNB           Order Sequence
     C                     Z-ADD#1DPNB    WUDPNB           Order Sequence
     C                     END                             *FI
      * Validate: OD MPR Prc Ready to send                  e2540 4/08/13
      * CASE: RCD.OD MPR Prc Ready to Send is MPR Ready Sts
     C           #1HPST    IFEQ *BLANK                     *IF
     C           #1HPST    OREQ 'X'
     C           #1HPST    OREQ 'N'
     C           #1HPST    OREQ 'Y'
      * CASE: RCD.OD MPR Prc Ready to Send is yes
     C           #1HPST    IFEQ 'Y'                        *IF
      * CASE: RCD.Price Overage Override is GT .01
     C           #1BZPR    IFGT .01                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0011           Price Overage O
      * Send message 'Cannot snd to mpr w/price'
     C                     MOVEL'USR4591' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1HPST           OD MPR Prc Read
     C                     END                             *FI
      * Select Pallet Type.                            9/15/21 BB WI464
      * CASE: F4 AND PM Pallet Type AND Palletize = Y
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> RCD.Pallet Type NOREF
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RQRU1'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Palletize flag is Yes, select Pallet Type
      * CASE: RCD.Palletize is yes
     C           #1VEST    IFEQ 'Y'                        *IF
      * Sel Pallet Master     SR - Pallet Master  * 
     C                     CALL 'PUTOSRR'              90  Sel Pallet Mast
     C                     PARM *BLANK    W0RTN   7
     C           #RQRU1    PARM #RQRU1    WQ0315  2        PM Pallet Type
     C                     PARM 'N'       WQ0316  1        Rental_Y_N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9843  *
     C                     END
     C                     MOVEL#RQRU1    #1F5SX           OD Pallet Type
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#RQRU1    ZA0012           Pallet Type NOR
      * Send message 'PAL-Prompt Not Allowed'
     C                     MOVEL'USR5218' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate: Pallet Type of 'PLT' only.              9/16/21 WI464
      * CASE: RCD.Pallet Type NOREF is Entered
     C           #RQRU1    IFNE *BLANK                     *IF
      * Chk Pallet Typ Exists XF - Pallet Master  * 
     C                     CALL 'PUTQXFR'              90  Chk Pallet Typ
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RQRU1    WQ0317  2        PM Pallet Type
     C           YL0036    PARM *BLANK    WQ0318  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9843  *
     C                     END
      * I record not found, send error message
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0036    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#RQRU1    ZA0013           Pallet Type NOR
      * Send message 'PAL-Pallet Type not found'
     C                     MOVEL'USR5214' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Populate file quantity ordered/substitute field from screen
      * CASE: RCD.Order Secondary Line Seq is GT 1
     C           #1UENB    IFGT 1                          *IF
     C                     Z-ADD#RHHQT    #1L9VA           Quantity to Sub
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#RHHQT    #1AVQT           Quantity Ordere
     C                     END                             *FI
     C                     Z-ADD#RHHQT    #RINQT           Quantity 11.2 U
      * Quantity is required.
      * CASE: RCD.Qty Ordered USR is Equal to Zero
     C           #RHHQT    IFEQ *ZERO                      *IF
      * Allow for TR Block order only
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Order Type - Sales is Transfer Order
      *   |- c2    : PAR.Block Order Flag is Block Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1JNCD    IFEQ 'TR'                       *IF
     C           P1BCST    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * E2393 allow for TR block order only
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#RHHQT    ZA0014           Qty Ordered USR
      * Send message 'Value Required.'
     C                     MOVEL'USR2625' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * If not Delete request, continue w/ validations
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C                     ELSE
      * CASE: *OTHERWISE
      * Not a delete request continue validations.
     C                     EXSR UESUBR                     Not a delete re
     C                     END                             *FI
      * If all validations are fixed, clear the Upload Error flag   P0012
      * CASE: WRK.Error Status is Not Yes
     C           WUECST    IFEQ *BLANK                     *IF
     C           WUECST    OREQ 'N'
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
     C                     END                             *FI
      * FP1309 Allocation & DE-Allocation
      * Processing when no error encountered (Allocation/De Allocation)
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * *** Error encountered. ***
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * *** Delete Request. ***
     C                     EXSR UKSUBR                     *** Delete Requ
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Update Allocations. ***
     C                     EXSR ULSUBR                     *** Update Allo
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * OD Spot Buy required
     C           #1H2ST    IFEQ *BLANK                     IF
     C           *IN62     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9849  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Warehouse Codes
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Customer Master
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Order Group
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Commodity Markets
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9839  *
     C                     END
      * Check reference to Market Date Method
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9836  *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9835  *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Country Master
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Event Types
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Ham Group Master
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9840  *
     C                     END
      * Calculate function fields
     C                     EXSR DG#2FN
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * If EDI & DSysco or Sysco, see if item exists on EDI PO   E004140
      * CASE: PAR.Customer Purchase Order # is NE Blank
     C           P1BCNA    IFNE *BLANK                     *IF
      * CASE: RCD.Item Code is Entered
     C           #1HGCD    IFNE *ZERO                      *IF
      * CASE: RCD.Detail Line Status is Not cancelled
     C           #1GMST    IFEQ 'L'                        *IF
     C           #1GMST    OREQ 'A'
     C           #1GMST    OREQ 'C'
     C           #1GMST    OREQ 'R'
     C           #1GMST    OREQ 'E'
     C           #1GMST    OREQ 'H'
     C           #1GMST    OREQ 'I'
     C                     MOVEL'N'       P7QKST           Display Flag
      * Rtv Trade Prtnr Info  XF - EDI Purchase Order Header  * 
     C                     CALL 'PBRYXFR'              90  Rtv Trade Prtnr
     C                     PARM *BLANK    W0RTN   7
     C           YL0021    PARM *ZERO     WQ0531  90       ST02-TRANS SET
     C                     PARM P1BCNA    WQ0532 22        G5003-PURCHASE
     C           YL0022    PARM *BLANK    WQ0533  6        EDI Trading Par
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDI Trading Partner No. is SYSCO Dailys
      *   |- c2    : LCL.EDI Trading Partner No. is SYSCO Foods
      *   '-
     C           YL0022    IFEQ @CN,006                    *IF
     C           YL0022    OREQ 'SYSCO'                    *OR
      * Convert Seaboards 7.0 item to EDI 14 char product id
      * Then remove leading zeros
     C                     MOVEL*BLANK    YL0023           Item Code Txt
     C                     MOVEL#1HGCD    YL0023           Item Code Txt
     C                     MOVEL*BLANK    WUCUNA           USR Hold Descri
     C                     MOVELYL0023    WUCUNA           USR Hold Descri
      * CLC Remove LeadZeros 30US - /UT User Source  * 
     C                     MOVEAWUCUNA    AR1              LOAD ARRAY
     C                     Z-ADD1         X       20       SET COUNTER
     C                     Z-ADD1         Y       20       SET COUNTER
     C                     MOVE 'N'       STOP    1        FLAG
     C           X         DOWLT31
     C           AR1,X     IFEQ '0'
     C           STOP      ANDEQ'N'
     C                     ADD  1         X
     C                     ELSE
     C                     MOVE AR1,X     AR2,Y
     C                     ADD  1         Y
     C                     ADD  1         X
     C                     MOVE 'Y'       STOP
     C                     END
     C                     END
     C                     MOVEAAR2       WUJNNA           LOAD OUTPUT
     C                     MOVELWUJNNA    YL0024           G6806/P109 PROD
      * See if item exists on EDI PO Detail (we don't care about GTIN her
      * RTV GTIN for SBD Prod XF - EDI Purchase Order Detail  * 
     C                     CALL 'PBRZXFR'              90  RTV GTIN for SB
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0021    WQ0534  90       ST02-TRANS SET
     C           YL0025    PARM *BLANK    WQ0535 15        G6804/P107 UPC/
     C                     PARM YL0024    WQ0536 10        G6806/P109 PROD
     C           YL0026    PARM YL0026    WQ0537  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Return Code Usr is *Record does not exist
     C           YL0026    IFEQ @CN,007                    *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,008   CAT  @CN,009:ZQ#CHPT1    P      Description Usr
     C                     MOVEL'Y'       P7QKST           Display Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CHPT1           Description Usr
     C                     MOVEL'N'       P7QKST           Display Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 2=EDIT the Item Age information
      * CASE: RCD.*SFLSEL is *Change
     C           #1SEL     IFEQ '2'                        *IF
      * Edt Age Information   E1 - Order Detail  * 
     C                     CLEARPHRC
     C                     Z-ADD#1AIC3    PHAIC3           Company Number
     C                     Z-ADD#1C4NB    PHC4NB           Order Number
     C                     Z-ADD#1DPNB    PHDPNB           Order Sequence
     C                     Z-ADD#1UENB    PHUENB           Order Secondary
      *
     C                     CALL 'PNO3E1R'              90  Edt Age Informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PHRC             KEY: Order Deta
     C                     PARM 'N'       WQ0538  1        Dealloc/Alloc U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO3E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 8=Comments
      * CASE: RCD.*SFLSEL is *Comments
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * EDT Detail Comments    EF - OP Order Detail Comment  * 
     C                     CALL 'PDDWEFR'              90  EDT Detail Comm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0539  30       Company Number
     C                     PARM #1C4NB    WQ0540  70       Order Number
     C                     PARM #1DPNB    WQ0541  30       Order Sequence
     C                     PARM #1UENB    WQ0542  30       Order Secondary
     C                     PARM #1HGCD    WQ0543  70       Item Code
     C                     PARM #CBRTX    WQ0544 30        Ship To Name
     C                     PARM #1A5DT    WQ0545  70       Requested Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDWEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 7=Edit Pricing Details
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * Edt OrdDtl Pricing    ER - Order Detail  * 
     C                     CLEARPIRC
     C                     Z-ADD#1AIC3    PIAIC3           Company Number
     C                     Z-ADD#1C4NB    PIC4NB           Order Number
     C                     Z-ADD#1DPNB    PIDPNB           Order Sequence
     C                     Z-ADD#1UENB    PIUENB           Order Secondary
      *
     C                     CALL 'PNQBE1R'              90  Edt OrdDtl Pric
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PIRC             KEY: Order Deta
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 9=Edit Deduction/Addition
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Edt Ord Dtl Accr      EF - Order Detail Accrual  * 
     C                     CLEARPJRC
     C                     Z-ADD#1AIC3    PJAIC3           Company Number
     C                     Z-ADD#1C4NB    PJC4NB           Order Number
     C                     Z-ADD#1DPNB    PJDPNB           Order Sequence
     C                     Z-ADD#1UENB    PJUENB           Order Secondary
      *
     C                     CALL 'PNL9EFR'              90  Edt Ord Dtl Acc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PJRC             KEY: Order Deta
     C                     PARM #1HGCD    WQ0546  70       Item Code
     C                     PARM #1AJCD    WQ0547  3        Warehouse Code
     C                     PARM #1BKC7    WQ0548  70       Ship To Custome
     C                     PARM #2HNNA    WQ0549 20        Ship To City
     C                     PARM #2DBCD    WQ0550  2        Ship To State C
     C                     PARM YL0074    WQ0551  2        Shipping Method
     C                     PARM P1OBST    WQ0552  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNL9EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * CASE: RCD.OD Production Plan St USR is Yes
     C           #ROWSC    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    #1R1ST           OD Production P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1R1ST           OD Production P
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DG#2FN    BEGSR
      *================================================================
      * Calculate subfile record function fields
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile record function fields
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P1OBST    IFEQ '4'                        *IF
     C                     MOVEL'P'       #1U1ST           Price Status
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DGEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'Y'       W0RSF
     C                     ELSE
     C                     MOVEL'N'       W0RSF
     C                     END
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
     C           W0PMD     IFEQ 'ADD'
      * Process add request
     C                     EXSR DDNLRC
     C           W0NLR     IFNE 'Y'
     C                     EXSR ECADRQ
     C                     END
     C                     ELSE
      * Process change request
     C                     EXSR EECHRQ
     C                     END
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
     C                     MOVEL'Y'       P7R4ST           USR Update Flag
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * CNCL Order Detail     XF - Order Detail  * 
     C                     CALL 'PNMEXFR'              90  CNCL Order Deta
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0553  30       Company Number
     C                     PARM #1C4NB    WQ0554  70       Order Number
     C                     PARM #1DPNB    WQ0555  30       Order Sequence
     C                     PARM #1UENB    WQ0556  30       Order Secondary
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1C4NB    WL0026           Order Number
     C                     Z-ADD#1DPNB    WL0027           Order Sequence
     C                     Z-ADD#1UENB    WL0028           Order Secondary
     C                     EXSR TORVGN
      * Delete line or change line status
      * CASE: RCD.Detail Line Status is Entered
     C           #1GMST    IFEQ 'E'                        *IF
      * DLT PD Order Detail    DL - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0029           Company Number
     C                     Z-ADD#1C4NB    WL0030           Order Number
     C                     Z-ADD#1DPNB    WL0031           Order Sequence
     C                     Z-ADD#1UENB    WL0032           Order Secondary
     C                     EXSR TQDLRC
      * S14158 RMC 11/29/18 also delete these files:
      * Rtv Dlt OD Files/CanclXF - Order Detail  * 
     C                     CALL 'PUKGXFR'              90  Rtv Dlt OD File
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0557  30       Company Number
     C                     PARM #1C4NB    WQ0558  70       Order Number
     C                     PARM #1DPNB    WQ0559  30       Order Sequence
     C                     PARM #1UENB    WQ0560  30       Order Secondary
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUKGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1GMST    #1GNST           Detail Line Sta
     C                     MOVEL'X'       #1GMST           Detail Line Sta
      * CHG Sts,Alloc          CH - Order Detail  * 
     C                     EXSR TRCHRC
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1C4NB    WL0026           Order Number
     C                     Z-ADD#1DPNB    WL0027           Order Sequence
     C                     Z-ADD#1UENB    WL0028           Order Secondary
     C                     EXSR TORVGN
      * CASE: RCD.Substituted Flag is Substitutions Exist
     C           #1Z3ST    IFEQ 'Y'                        *IF
     C           #1UENB    ADD  1         WUUENB           Order Secondary
      * DEL Substitutions/Line RT - Order Detail  * 
     C                     EXSR TSRVGN
     C                     ELSE
      * CASE: RCD.Order Secondary Line Seq is GT 1
     C           #1UENB    IFGT 1                          *IF
      * this is a substitution; check if there are any others
      * RTV Substitutions      RT - Order Detail  * 
     C                     EXSR TXRVGN
      * Set substituted flag
      * CASE: WRK.Substitution Flag is yes
     C           WUPRST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #1Z3ST           Substituted Fla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1Z3ST           Substituted Fla
     C                     END                             *FI
      * CHG Substitution Flag  CH - Order Detail  * 
     C                     EXSR TYCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Sts,Alloc          CH - PD Order Detail  * 
     C                     EXSR TZCHRC
     C                     ADD  #1AVQT    #CAVQT           Quantity Ordere
     C                     ADD  #1D0WG    #CD0WG           Weight Ordered
     C                     ADD  #1AUWG    #CAUWG           Weight Schedule
     C                     MOVEL#1KXCD    YL0010           USR Country Cod
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Crt PD Order Detail    IF
      * CRT PD Order Detail    CR - Order Detail  * 
     C                     EXSR NACRRC
     C           W0RTN     IFNE *BLANK
      * Write error detected
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
     C                     ELSE
      * DBF write successful
      * disable entry
     C                     SETON                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG PD Order Detail    IF
      * CHG PD Order Detail    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0033           Company Number
     C                     Z-ADD#1C4NB    WL0034           Order Number
     C                     Z-ADD#1DPNB    WL0035           Order Sequence
     C                     Z-ADD#1UENB    WL0036           Order Secondary
     C                     Z-ADD#1HGCD    WL0037           Item Code
     C                     MOVEL#1AJCD    WL0038    P      Warehouse Code
     C                     Z-ADD#1BKC7    WL0039           Ship To Custome
     C                     Z-ADD#1CFC7    WL0040           Order Group Cod
     C                     MOVEL#1GMST    WL0041    P      Detail Line Sta
     C                     MOVEL#1GNST    WL0042    P      Detail Line Sta
     C                     Z-ADD#1MAVA    WL0043           Billing Detail
     C                     Z-ADD#1KDVA    WL0044           Billing Detail
     C                     Z-ADD#1L8VA    WL0045           Billing Detail
     C                     Z-ADD#1L9VA    WL0046           Quantity to Sub
     C                     MOVEL#1GTST    WL0047    P      Comment Print A
     C                     MOVEL#1GVST    WL0048    P      Comment Print I
     C                     MOVEL#1GUST    WL0049    P      Comment Print P
     C                     MOVEL#1QFST    WL0050    P      Comment Print S
     C                     Z-ADD#1AYVA    WL0051           Extended Amount
     C                     Z-ADD#1EXDT    WL0052           Market Pricing
     C                     MOVEL#1LQCD    WL0053    P      Commodity Marke
     C                     MOVEL#1RDCD    WL0054    P      Date Method Cod
     C                     MOVEL#1Q7CD    WL0055    P      Price Method Co
     C                     Z-ADD#1BZPR    WL0056           Price Overage O
     C                     Z-ADD#1L6NB    WL0057           Contract Number
     C                     MOVEL#1U1ST    WL0058    P      Price Status
     C                     Z-ADD#1GIDT    WL0059           Pricing Date Us
     C                     MOVEL#1CRCD    WL0060    P      U_M_Base Price
     C                     MOVEL#1AGCD    WL0061    P      U_M_Ordered
     C                     MOVEL#1RZST    WL0062    P      Work Confirm St
     C                     MOVEL#1R0ST    WL0063    P      Work Over_Short
     C                     MOVEL#1R1ST    WL0064    P      OD Production P
     C                     MOVEL#1G7NA    WL0065    P      Order Desc_Line
     C                     MOVEL#1G8NA    WL0066    P      Order Desc_Line
     C                     MOVEL#1RPCD    WL0067    P      Age Code
     C                     MOVEL#1VEST    WL0068    P      Palletize
     C                     MOVEL#1VGST    WL0069    P      Slip Sheet
     C                     MOVEL#1AVST    WL0070    P      Catch Weight St
     C                     MOVEL#1U0ST    WL0071    P      Price Audit
     C                     MOVEL#1RFCD    WL0072    P      Price Audit Rea
     C                     MOVEL#1FZST    WL0073    P      Production Date
     C                     Z-ADD#1R1NB    WL0074           Rated Freight
     C                     Z-ADD#1AVQT    WL0075           Quantity Ordere
     C                     Z-ADD#1D0WG    WL0076           Weight Ordered
     C                     Z-ADD#1CCQT    WL0077           Quantity Schedu
     C                     Z-ADD#1AUWG    WL0078           Weight Schedule
     C                     Z-ADD#1CBQT    WL0079           Quantity Shippe
     C                     Z-ADD#1ATWG    WL0080           Weight Shipped
     C                     Z-ADD#1AQCS    WL0081           Unit Cost Prici
     C                     Z-ADD#1AGCS    WL0082           Unit Cost Per P
     C                     Z-ADD#1AKPR    WL0083           Unit Price
     C                     Z-ADD#1ALPR    WL0084           Unit Price_Cred
     C                     Z-ADD#1AUPR    WL0085           Unit Price Orde
     C                     Z-ADD#1AVWG    WL0086           Unit Weight Ord
     C                     Z-ADD#1A4WG    WL0087           Tare Weight Tot
     C                     Z-ADD#1A5DT    WL0088           Requested Ship
     C                     Z-ADD#1AODT    WL0089           Scheduled Ship
     C                     Z-ADD#1GNDT    WL0090           Actual Shipped
     C                     MOVEL#1AMST    WL0091    P      Affect Inventor
     C                     MOVEL#1ANST    WL0092    P      Affect Sales Do
     C                     MOVEL#1VAST    WL0093    P      Affect Sales Pn
     C                     Z-ADD#1RGNB    WL0094           Item Structure
     C                     Z-ADD#1RHNB    WL0095           Item Structure
     C                     Z-ADD#1RINB    WL0096           Item Structure
     C                     MOVEL#1RBCD    WL0097    P      Item Level
     C                     MOVEL#1HICD    WL0098    P      Quality Level
     C                     MOVEL#1RNCD    WL0099    P      Pricing Product
     C                     MOVEL#1ROCD    WL0100    P      Season Product
     C                     Z-ADD#1CXDT    WL0101           Date of Origina
     C                     MOVEL#1AJVN    WL0102    P      User Profile Na
     C                     MOVEL#1KXCD    WL0103    P      Country Code
     C                     MOVEL#1JPCD    WL0104    P      Event Code
     C                     MOVEL#1CQCD    WL0105    P      Reason Code
     C                     MOVEL#1R4CD    WL0106    P      Sales Route Cod
     C                     MOVEL#1Z1ST    WL0107    P      Modified Flag
     C                     MOVEL#1Z3ST    WL0108    P      Substituted Fla
     C                     MOVEL#1Z4ST    WL0109    P      OD Schedule Ove
     C                     Z-ADD#1DUPR    WL0110           Invoice Unit Pr
     C                     Z-ADD#1B6VL    WL0111           Invoice Extende
     C                     Z-ADD#1A1AA    WL0112           Ham Group Numbe
     C                     MOVEL#1FZSX    WL0113    P      OD Adj Type Ove
     C                     MOVEL#1F0SX    WL0114    P      Affect Trade Fu
     C                     MOVEL#1F1SX    WL0115    P      Affect Commissi
     C                     MOVEL#1F2SX    WL0116    P      Affect Pricing
     C                     MOVEL#1F3SX    WL0117    P      Released by Use
     C                     MOVEL#1F4SX    WL0118    P      Ord TF Exempt C
     C                     MOVEL#RQRU1    WL0119    P      OD Pallet Type
     C                     MOVEL#1F6SX    WL0120    P      Production Ware
     C                     MOVEL#1F7SX    WL0121    P      OD Price Type
     C                     Z-ADD#1NTDT    WL0122           Warehouse Palle
     C                     Z-ADD#1NUDT    WL0123           Consumed Item C
     C                     Z-ADD#1NVDT    WL0124           Deadline Depart
     C                     Z-ADD#1NWDT    WL0125           OD Price Type R
     C                     Z-ADD#1NXDT    WL0126           OD Firm Date
     C                     Z-ADD#1BUTM    WL0127           Deadline Depart
     C                     Z-ADD#1BVTM    WL0128           Price Code
     C                     Z-ADD#1BWTM    WL0129           Maximum Net Wei
     C                     Z-ADD#1BXTM    WL0130           Substitution Li
     C                     Z-ADD#1BYTM    WL0131           Max Qty to sche
     C                     Z-ADD#1H5NX    WL0132           Warehouse Palle
     C                     Z-ADD#1H6NX    WL0133           Warehouse Avg P
     C                     Z-ADD#1H7NX    WL0134           OD Item Target
     C                     Z-ADD#1H8NX    WL0135           OD Estimated Gr
     C                     Z-ADD#1H9NX    WL0136           OD Maximum Unit
     C                     Z-ADD#1DVPR    WL0137           Order Gate_Fina
     C                     Z-ADD#1DWPR    WL0138           OD Ceiling Pric
     C                     Z-ADD#1DXPR    WL0139           OD Gate_Final P
     C                     Z-ADD#1DYPR    WL0140           OD Weighted Avg
     C                     Z-ADD#1DZPR    WL0141           OD Original Ord
     C                     Z-ADD#1GSPR    WL0142           OD Cancel Date
     C                     Z-ADD#1GTPR    WL0143           OD Unused Prc 7
     C                     Z-ADD#1GUPR    WL0144           OD Unused Prc 8
     C                     MOVEL#1HOST    WL0145    P      OD MPR Sent to
     C                     MOVEL#1HPST    WL0146    P      OD MPR Prc Read
     C                     MOVEL#1IOST    WL0147    P      OD UnUsed Price
     C                     Z-ADD#1PEWG    WL0148           Weight Amount E
     C                     Z-ADD#1RINY    WL0149           Item Age Days
     C                     Z-ADD#1TIDT    WL0150           Production Ovr
     C                     Z-ADD#1TJDT    WL0151           Production Ovr
     C                     MOVEL#1H2ST    WL0152    P      OD Spot Buy
     C                     MOVEL#1H0ST    WL0153    P      OD Clm Full Ret
     C                     MOVEL#1H1ST    WL0154    P      Order Line Erro
     C                     Z-ADD#1TKDT    WL0155           OD Market Begin
     C                     Z-ADD#1TLDT    WL0156           OD Market Endin
     C                     Z-ADD#1TMDT    WL0157           OD Atch to Ord
     C                     MOVEL#1UVST    WL0158    P      EDI Status 1
     C                     MOVEL#1UWST    WL0159    P      EDI Status 2
     C                     MOVEL#1UXST    WL0160    P      EDI Status 3
     C                     EXSR TUCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C                     MOVEL'ADD'     W0PMD
     C                     ELSE
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     EXSR FBRQRL
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL*IN87     *IN72
     C           #RGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           #1UENB    IFLE 1                          *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL*IN87     *IN70
     C           #1GMST    IFEQ 'X'                        *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL*IN87     *IN69
     C           #RTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL*IN87     *IN68
     C           #RASTS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL*IN87     *IN67
     C           #RTJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     MOVEL*IN87     *IN66
     C           #RBSTS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN66
     C                     END                             *FI
     C                     MOVEL*IN87     *IN65
     C           #RGFSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN65
     C                     END                             *FI
     C                     MOVEL*IN87     *IN64
     C           #RD2TX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN64
     C                     END                             *FI
     C                     MOVEL*IN87     *IN63
     C           YL0011    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN63
     C                     END                             *FI
     C                     MOVEL*IN87     *IN62
     C           YL0106    IFEQ 'H'                        *IF
     C                     MOVEL'1'       *IN62
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0005    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #CNVDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0006    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           YL0007    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           P9YJSX    IFEQ 'H'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           P7QKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     MOVEL*BLANK    #RGFSX           USR Display 5
     C                     MOVEL*BLANK    #RBSTS           USR Display 4
     C                     MOVEL*BLANK    #RASTS           USR Display 3
     C                     Z-ADD*ZERO     #RTSDT           Prod OvrAge To
     C                     Z-ADD*ZERO     #RTRDT           Prod OvrAge Frm
     C                     Z-ADD*ZERO     #RRWNY           Item age days u
     C                     Z-ADD*ZERO     #RFHWG           Weight 11.2 USR
     C                     Z-ADD*ZERO     #RINQT           Quantity 11.2 U
     C                     MOVEL*BLANK    #RTJST           USR Display 2
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
     C                     MOVEL*BLANK    #RP3ST           TF Co_Ownership
     C                     Z-ADD*ZERO     #RDKCD           USR Item Code
     C                     MOVEL*BLANK    #1AGCD           U_M_Ordered
     C                     MOVEL*BLANK    #RV8ST           Price Method Ty
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     MOVEL*BLANK    #1F5SX           OD Pallet Type
     C                     MOVEL*BLANK    #RTIST           USR Display 1
     C                     Z-ADD*ZERO     #1AKPR           Unit Price
     C                     Z-ADD*ZERO     #1ALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     #1AUPR           Unit Price Orde
     C                     MOVEL*BLANK    #1G7NA           Order Desc_Line
     C                     MOVEL*BLANK    #1G8NA           Order Desc_Line
     C                     Z-ADD*ZERO     #1AGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     #1AQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     #1AVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     #1AYVA           Extended Amount
     C                     MOVEL*BLANK    #1AMST           Affect Inventor
     C                     MOVEL*BLANK    #1ANST           Affect Sales Do
     C                     MOVEL*BLANK    #1VAST           Affect Sales Pn
     C                     Z-ADD*ZERO     #1CBQT           Quantity Shippe
     C                     Z-ADD*ZERO     #1ATWG           Weight Shipped
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     #1CFC7           Order Group Cod
     C                     MOVEL*BLANK    #1FZST           Production Date
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     MOVEL*BLANK    #RCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #RFWST           USR Age Code
     C                     MOVEL*BLANK    #RCJTX           USR Item Descri
     C                     MOVEL*BLANK    #RGGST           USR Display fie
     C                     MOVEL*BLANK    #1GNST           Detail Line Sta
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     MOVEL*BLANK    #1KXCD           Country Code
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1RZST           Work Confirm St
     C                     MOVEL*BLANK    #1R0ST           Work Over_Short
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1RFCD           Price Audit Rea
     C                     Z-ADD*ZERO     #1MAVA           Billing Detail
     C                     Z-ADD*ZERO     #1KDVA           Billing Detail
     C                     Z-ADD*ZERO     #1L8VA           Billing Detail
     C                     Z-ADD*ZERO     #1L9VA           Quantity to Sub
     C                     Z-ADD*ZERO     #1A4WG           Tare Weight Tot
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1HICD           Quality Level
     C                     MOVEL*BLANK    #1RNCD           Pricing Product
     C                     MOVEL*BLANK    #1ROCD           Season Product
     C                     MOVEL*BLANK    #1AJVN           User Profile Na
     C                     MOVEL*BLANK    #1RBCD           Item Level
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     Z-ADD*ZERO     #1GIDT           Pricing Date Us
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
     C                     MOVEL*BLANK    #1Z3ST           Substituted Fla
     C                     MOVEL*BLANK    #1Z4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     #1DUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     #1B6VL           Invoice Extende
     C                     MOVEL*BLANK    #1FZSX           OD Adj Type Ove
     C                     MOVEL*BLANK    #1F0SX           Affect Trade Fu
     C                     MOVEL*BLANK    #1F1SX           Affect Commissi
     C                     MOVEL*BLANK    #1F2SX           Affect Pricing
     C                     MOVEL*BLANK    #RD2TX           Status Flag 21
     C                     Z-ADD*ZERO     #1NWDT           OD Price Type R
     C                     Z-ADD*ZERO     #RCNBR           Contract Number
     C                     Z-ADD*ZERO     #1L6NB           Contract Number
     C                     MOVEL*BLANK    #1F3SX           Released by Use
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     MOVEL*BLANK    #ROXSC           Plan Production
     C                     MOVEL*BLANK    #1R1ST           OD Production P
     C                     MOVEL*BLANK    #REMST           Plan Production
     C                     MOVEL*BLANK    #1F4SX           Ord TF Exempt C
     C                     MOVEL*BLANK    #1F6SX           Production Ware
     C                     Z-ADD*ZERO     #1NTDT           Warehouse Palle
     C                     Z-ADD*ZERO     #1NUDT           Consumed Item C
     C                     Z-ADD*ZERO     #1NVDT           Deadline Depart
     C                     Z-ADD*ZERO     #1NXDT           OD Firm Date
     C                     Z-ADD*ZERO     #1BUTM           Deadline Depart
     C                     Z-ADD*ZERO     #1BWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     #1BXTM           Substitution Li
     C                     Z-ADD*ZERO     #1BYTM           Max Qty to sche
     C                     Z-ADD*ZERO     #1H5NX           Warehouse Palle
     C                     Z-ADD*ZERO     #1H6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     #1H7NX           OD Item Target
     C                     Z-ADD*ZERO     #1H8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     #1H9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     #1DVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     #1DXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     #1DYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     #1DZPR           OD Original Ord
     C                     Z-ADD*ZERO     #1GSPR           OD Cancel Date
     C                     Z-ADD*ZERO     #1GTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     #1GUPR           OD Unused Prc 8
     C                     MOVEL*BLANK    #1HOST           OD MPR Sent to
     C                     MOVEL*BLANK    #1IOST           OD UnUsed Price
     C                     Z-ADD*ZERO     #1PEWG           Weight Amount E
     C                     Z-ADD*ZERO     #1TIDT           Production Ovr
     C                     Z-ADD*ZERO     #1TJDT           Production Ovr
     C                     MOVEL*BLANK    #1H0ST           OD Clm Full Ret
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
     C                     Z-ADD*ZERO     #1TKDT           OD Market Begin
     C                     Z-ADD*ZERO     #1TLDT           OD Market Endin
     C                     Z-ADD*ZERO     #1TMDT           OD Atch to Ord
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1AVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #RASWG           USR Weight
     C                     Z-ADD*ZERO     #RBAQT           USR Quantity
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RHHQT           Qty Ordered USR
     C                     Z-ADD*ZERO     #RH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     MOVEL*BLANK    #RGLST           Deduct/Add Sts
     C                     MOVEL*BLANK    #1CRCD           U_M_Base Price
     C                     Z-ADD*ZERO     #RDTPR           Unit Price (DSP
     C                     MOVEL*BLANK    #1Q7CD           Price Method Co
     C                     MOVEL*BLANK    #1RDCD           Date Method Cod
     C                     MOVEL*BLANK    #RCNSZ           Cust Item Cntrc
     C                     Z-ADD*ZERO     #1BVTM           Price Code
     C                     Z-ADD*ZERO     #1EXDT           Market Pricing
      * Clear external version also
     C                     Z-ADD*ZERO     V1EXDT
     C                     MOVEL*BLANK    #1LQCD           Commodity Marke
     C                     Z-ADD*ZERO     #1A1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     #1RINY           Item Age Days
     C                     MOVEL*BLANK    #RI0ST           Override Age Da
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #RQRU1           Pallet Type NOR
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1F7SX           OD Price Type
     C                     MOVEL*BLANK    #1HPST           OD MPR Prc Read
     C                     MOVEL*BLANK    #1GMST           Detail Line Sta
     C                     MOVEL*BLANK    #ROWSC           OD Production P
     C                     Z-ADD*ZERO     #1D0WG           Weight Ordered
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
      * Clear external version also
     C                     Z-ADD*ZERO     V1CXDT
     C                     MOVEL*BLANK    #1H2ST           OD Spot Buy
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKL1 fields to subfile
      *================================================================
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     MOVELOMAGCD    #1AGCD           U_M_Ordered
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     Z-ADDOMALPR    #1ALPR           Unit Price_Cred
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     MOVELOMG7NA    #1G7NA           Order Desc_Line
     C                     MOVELOMG8NA    #1G8NA           Order Desc_Line
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over_Short
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
     C                     Z-ADDOMNXDT    #1NXDT           OD Firm Date
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate_Fina
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate_Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    #1DZPR           OD Original Ord
     C                     Z-ADDOMGSPR    #1GSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     MOVELOMCRCD    #1CRCD           U_M_Base Price
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
     C                     MOVELOMH2ST    #1H2ST           OD Spot Buy
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     Z-ADD*ZERO     #CAXTM           Deadline Depart
     C                     MOVEL*BLANK    #CFYSX           OH TF Exempt Co
     C                     MOVEL*BLANK    #CP3SX           Customer TF Exe
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CAGTX           USR Company Nam
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     Z-ADDP1BKC7    #PBKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    VPBKC7
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     Z-ADD*ZERO     #CAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #CA5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCA5DT
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     Z-ADD*ZERO     #CD0WG           Weight Ordered
     C                     Z-ADD*ZERO     #CAODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCAODT
     C                     Z-ADD*ZERO     #CAUWG           Weight Schedule
     C                     Z-ADD*ZERO     #CNVDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     VCNVDT
     C                     Z-ADD*ZERO     #CBUTM           Deadline Depart
     C                     Z-ADD*ZERO     #CRJNY           Item Age Days F
     C                     Z-ADD*ZERO     #CRKNY           Item Age Days F
     C                     MOVEL*BLANK    #CHPT1           Description Usr
      * Check restriction within
     C                     EXSR VQCKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EXDT
      * Convert Date of Original Entry to display format
      * Convert date
     C           1000000   ADD  #1CXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1CXDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #CA5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCA5DT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #CAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCAODT
      * Convert Deadline Depart Date LH to display format
      * Convert date
     C           1000000   ADD  #CNVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCNVDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACRRC    BEGSR
      *================================================================
      * CRT PD Order Detail    CR - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0530  60       Job Time
     C                     MOVEL*BLANK    WN0531 10        User Id
     C                     MOVEL*BLANK    WN0532 10        Job Name
     C                     Z-ADD*ZERO     WN0533  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BGWKL0
     C                     Z-ADD#2AIC3    OMAIC3           Company Number
     C                     Z-ADD#2C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
     C                     Z-ADD#1HGCD    OMHGCD           Item Code
     C                     MOVEL#1AJCD    OMAJCD           Warehouse Code
     C                     Z-ADDP1BKC7    OMBKC7           Ship To Custome
     C                     Z-ADD#1CFC7    OMCFC7           Order Group Cod
     C                     MOVEL#1GMST    OMGMST           Detail Line Sta
     C                     MOVELWUGSTX    OMGNST           Detail Line Sta
     C                     Z-ADD#1MAVA    OMMAVA           Billing Detail
     C                     Z-ADD#1KDVA    OMKDVA           Billing Detail
     C                     Z-ADD#1L8VA    OML8VA           Billing Detail
     C                     Z-ADD#1L9VA    OML9VA           Quantity to Sub
     C                     MOVELP1GTST    OMGTST           Comment Print A
     C                     MOVELP1GVST    OMGVST           Comment Print I
     C                     MOVELP1GUST    OMGUST           Comment Print P
     C                     MOVELP1QFST    OMQFST           Comment Print S
     C                     Z-ADD#1AYVA    OMAYVA           Extended Amount
     C                     Z-ADD#1EXDT    OMEXDT           Market Pricing
     C                     MOVEL#1LQCD    OMLQCD           Commodity Marke
     C                     MOVEL#1RDCD    OMRDCD           Date Method Cod
     C                     MOVEL#1Q7CD    OMQ7CD           Price Method Co
     C                     Z-ADD#1BZPR    OMBZPR           Price Overage O
     C                     Z-ADD#1L6NB    OML6NB           Contract Number
     C                     MOVEL#1U1ST    OMU1ST           Price Status
     C                     Z-ADD#1GIDT    OMGIDT           Pricing Date Us
     C                     MOVEL#1CRCD    OMCRCD           U_M_Base Price
     C                     MOVEL#1AGCD    OMAGCD           U_M_Ordered
     C                     MOVEL#1RZST    OMRZST           Work Confirm St
     C                     MOVEL#1R0ST    OMR0ST           Work Over_Short
     C                     MOVEL#1R1ST    OMR1ST           OD Production P
     C                     MOVEL#1G7NA    OMG7NA           Order Desc_Line
     C                     MOVEL#1G8NA    OMG8NA           Order Desc_Line
     C                     MOVEL#1RPCD    OMRPCD           Age Code
     C                     MOVEL#1VEST    OMVEST           Palletize
     C                     MOVEL#1VGST    OMVGST           Slip Sheet
     C                     MOVEL#1AVST    OMAVST           Catch Weight St
     C                     MOVEL*BLANK    OMU0ST           Price Audit
     C                     MOVEL*BLANK    OMRFCD           Price Audit Rea
     C                     MOVEL#1FZST    OMFZST           Production Date
     C                     Z-ADD#1R1NB    OMR1NB           Rated Freight
     C                     Z-ADD#1AVQT    OMAVQT           Quantity Ordere
     C                     Z-ADD#1D0WG    OMD0WG           Weight Ordered
     C                     Z-ADD#1CCQT    OMCCQT           Quantity Schedu
     C                     Z-ADD#1AUWG    OMAUWG           Weight Schedule
     C                     Z-ADD#1CBQT    OMCBQT           Quantity Shippe
     C                     Z-ADD#1ATWG    OMATWG           Weight Shipped
     C                     Z-ADD#1AQCS    OMAQCS           Unit Cost Prici
     C                     Z-ADD#1AGCS    OMAGCS           Unit Cost Per P
     C                     Z-ADD#1AKPR    OMAKPR           Unit Price
     C                     Z-ADD#1ALPR    OMALPR           Unit Price_Cred
     C                     Z-ADD#1AUPR    OMAUPR           Unit Price Orde
     C                     Z-ADD#1AVWG    OMAVWG           Unit Weight Ord
     C                     Z-ADD#1A4WG    OMA4WG           Tare Weight Tot
     C                     Z-ADD#1A5DT    OMA5DT           Requested Ship
     C                     Z-ADD#1AODT    OMAODT           Scheduled Ship
     C                     Z-ADD#1GNDT    OMGNDT           Actual Shipped
     C                     MOVEL#1AMST    OMAMST           Affect Inventor
     C                     MOVEL#1ANST    OMANST           Affect Sales Do
     C                     MOVEL#1VAST    OMVAST           Affect Sales Pn
     C                     Z-ADD#1RGNB    OMRGNB           Item Structure
     C                     Z-ADD#1RHNB    OMRHNB           Item Structure
     C                     Z-ADD#1RINB    OMRINB           Item Structure
     C                     MOVEL#1RBCD    OMRBCD           Item Level
     C                     MOVEL#1HICD    OMHICD           Quality Level
     C                     MOVEL#1RNCD    OMRNCD           Pricing Product
     C                     MOVEL#1ROCD    OMROCD           Season Product
     C                     Z-ADD#1CXDT    OMCXDT           Date of Origina
     C                     MOVEL##USR     OMAJVN           User Profile Na
     C                     MOVEL#1KXCD    OMKXCD           Country Code
     C                     MOVEL'01'      OMJPCD           Event Code
     C                     MOVEL#1CQCD    OMCQCD           Reason Code
     C                     MOVEL#1R4CD    OMR4CD           Sales Route Cod
     C                     MOVEL#1Z1ST    OMZ1ST           Modified Flag
     C                     MOVEL#1Z3ST    OMZ3ST           Substituted Fla
     C                     MOVEL#1Z4ST    OMZ4ST           OD Schedule Ove
     C                     Z-ADD#1DUPR    OMDUPR           Invoice Unit Pr
     C                     Z-ADD#1B6VL    OMB6VL           Invoice Extende
     C                     Z-ADD#1A1AA    OMA1AA           Ham Group Numbe
     C                     MOVEL#1FZSX    OMFZSX           OD Adj Type Ove
     C                     MOVEL#1F0SX    OMF0SX           Affect Trade Fu
     C                     MOVEL#1F1SX    OMF1SX           Affect Commissi
     C                     MOVEL#1F2SX    OMF2SX           Affect Pricing
     C                     MOVEL#1F3SX    OMF3SX           Released by Use
     C                     MOVEL#1F4SX    OMF4SX           Ord TF Exempt C
     C                     MOVEL#RQRU1    OMF5SX           OD Pallet Type
     C                     MOVEL#1F6SX    OMF6SX           Production Ware
     C                     MOVEL#1F7SX    OMF7SX           OD Price Type
     C                     Z-ADD#1NTDT    OMNTDT           Warehouse Palle
     C                     Z-ADD#1NUDT    OMNUDT           Consumed Item C
     C                     Z-ADD#1NVDT    OMNVDT           Deadline Depart
     C                     Z-ADD#1NWDT    OMNWDT           OD Price Type R
     C                     Z-ADD#1NXDT    OMNXDT           OD Firm Date
     C                     Z-ADD#1BUTM    OMBUTM           Deadline Depart
     C                     Z-ADD#1BVTM    OMBVTM           Price Code
     C                     Z-ADD#1BWTM    OMBWTM           Maximum Net Wei
     C                     Z-ADD#1BXTM    OMBXTM           Substitution Li
     C                     Z-ADD#1BYTM    OMBYTM           Max Qty to sche
     C                     Z-ADD#1H5NX    OMH5NX           Warehouse Palle
     C                     Z-ADD#1H6NX    OMH6NX           Warehouse Avg P
     C                     Z-ADD#1H7NX    OMH7NX           OD Item Target
     C                     Z-ADD#1H8NX    OMH8NX           OD Estimated Gr
     C                     Z-ADD#1H9NX    OMH9NX           OD Maximum Unit
     C                     Z-ADD#1DVPR    OMDVPR           Order Gate_Fina
     C                     Z-ADD#1DWPR    OMDWPR           OD Ceiling Pric
     C                     Z-ADD#1DXPR    OMDXPR           OD Gate_Final P
     C                     Z-ADD#1DYPR    OMDYPR           OD Weighted Avg
     C                     Z-ADD#1DZPR    OMDZPR           OD Original Ord
     C                     Z-ADD#1GSPR    OMGSPR           OD Cancel Date
     C                     Z-ADD#1GTPR    OMGTPR           OD Unused Prc 7
     C                     Z-ADD#1GUPR    OMGUPR           OD Unused Prc 8
     C                     MOVEL#1HOST    OMHOST           OD MPR Sent to
     C                     MOVEL#1HPST    OMHPST           OD MPR Prc Read
     C                     MOVEL#1IOST    OMIOST           OD UnUsed Price
     C                     Z-ADD#1PEWG    OMPEWG           Weight Amount E
     C                     Z-ADD#1RINY    OMRINY           Item Age Days
     C                     Z-ADD#1TIDT    OMTIDT           Production Ovr
     C                     Z-ADD#1TJDT    OMTJDT           Production Ovr
     C                     MOVEL#1H2ST    OMH2ST           OD Spot Buy
     C                     MOVEL#1H0ST    OMH0ST           OD Clm Full Ret
     C                     MOVEL#1H1ST    OMH1ST           Order Line Erro
     C                     Z-ADD#1TKDT    OMTKDT           OD Market Begin
     C                     Z-ADD#1TLDT    OMTLDT           OD Market Endin
     C                     Z-ADD#1TMDT    OMTMDT           OD Atch to Ord
     C                     MOVEL#1UVST    OMUVST           EDI Status 1
     C                     MOVEL#1UWST    OMUWST           EDI Status 2
     C                     MOVEL#1UXST    OMUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    OMRPCD           Age Code
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0636  30       Company Number
     C                     PARM OMHGCD    WQ0637  70       Item Code
     C           OMNUDT    PARM *ZERO     WQ0638  70       Component Item
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELOMAJCD    WL0161    P      Warehouse Code
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0162    OMF6SX    P      Production Ware
     C                     Z-ADDWL0163    YN0263           Accounting Comp
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                     EXSR UQSUBR                     Calc Gross Weig
     C           KLCRNA    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRNA    SETLL@BGWKL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1310' W0RTN   7
      * Send message 'Order Detail           EX'
     C                     MOVEL'USR1310' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C                     WRITE@BGWKL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * WI642   JM-02/19/25-Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Prc Ready to Send is yes
     C           OMHPST    IFEQ 'Y'                        *IF
      * Always create price type log ORDPRT
     C                     MOVELOMDPNB    YL0101           Text 3 Length U
     C                     Z-ADD1         ZQ      50
     C           YL0101    CAT  ' ':ZQ    YL0102    P      Change Log Prio
     C                     MOVEL*BLANK    YL0103           Change Log New
     C                     MOVEL#1F7SX    YL0103           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0649  70       Load ID
     C                     PARM 'ORDPRT'  WQ0650  6        Load Change Typ
     C                     PARM 'SLS'     WQ0651  3        Department Cont
     C                     PARM YL0102    WQ0652 12        Change Log Prio
     C                     PARM YL0103    WQ0653 12        Change Log New
     C                     PARM OMAIC3    WQ0654  30       Company Number
     C                     PARM OMC4NB    WQ0655  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * WI642   JM-02/19/25-If not the transfer order nbr 9999999->crt ch
      * CASE: DB1.Order Number is ne 9999999
     C           OMC4NB    IFNE 9999999                    *IF
     C                     MOVELOMDPNB    YL0101           Text 3 Length U
     C                     Z-ADD*ZERO     YL0104           Weight Beg Inv
     C                     MOVELYL0104    YL0105           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0101    CAT  YL0105:ZQ YL0102    P      Change Log Prio
     C                     Z-ADD#1D0WG    YL0104           Weight Beg Inv
     C                     MOVEL*BLANK    YL0103           Change Log New
     C                     MOVELYL0104    YL0103           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0656  70       Load ID
     C                     PARM 'ORDWGT'  WQ0657  6        Load Change Typ
     C                     PARM 'SLS'     WQ0658  3        Department Cont
     C                     PARM YL0102    WQ0659 12        Change Log Prio
     C                     PARM YL0103    WQ0660 12        Change Log New
     C                     PARM OMAIC3    WQ0661  30       Company Number
     C                     PARM OMC4NB    WQ0662  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD*ZERO     YL0104           Weight Beg Inv
     C                     MOVELYL0104    YL0105           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0101    CAT  YL0105:ZQ YL0102    P      Change Log Prio
     C                     Z-ADD#1AVQT    YL0104           Weight Beg Inv
     C                     MOVEL*BLANK    YL0103           Change Log New
     C                     MOVELYL0104    YL0103           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0663  70       Load ID
     C                     PARM 'ORDQTY'  WQ0664  6        Load Change Typ
     C                     PARM 'SLS'     WQ0665  3        Department Cont
     C                     PARM YL0102    WQ0666 12        Change Log Prio
     C                     PARM YL0103    WQ0667 12        Change Log New
     C                     PARM OMAIC3    WQ0668  30       Company Number
     C                     PARM OMC4NB    WQ0669  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNB01           Application Cod
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQNB01           Application Cod
     C                     MOVEL'OMS'     WQNB01           Application Cod
      * Establish starting position
     C           KRSNB     SETLL@DNRESF                    *
     C           KRSNB     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NCRVGN
     C                     END                             *FI
     C           KRSNB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNC01           Application Cod
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQNC01           Application Cod
      * Establish starting position
     C           KRSNC     SETLL@DNRESF                    *
     C           KRSNC     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * RTV Last Seq 1 Nbr     RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQND01           Company Number
     C           *LIKE     DEFN OMC4NB    WQND02           Order Number
      * Define keylist
     C           KPSND     KLIST
     C                     KFLD           WQND01           Company Number
     C                     KFLD           WQND02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           Company Number
     C                     KFLD           WQND02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQND01           Company Number
     C                     Z-ADDP1C4NB    WQND02           Order Number
     C                     Z-ADDWUDPNB    OMDPNB           Order Sequence
     C                     Z-ADDWUUENB    OMUENB           Order Secondary
      * Establish starting position
     C           KPSND     SETLL@BGWKL1                    *
     C           KRSND     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO NDEXIT                     *QUIT
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDOMDPNB    WUDPNB           Order Sequence
     C                     Z-ADDOMUENB    WUUENB           Order Secondary
     C           KRSND     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * RTV for Order Dtl Ent. RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    BEAIC3           Company Number
     C                     Z-ADDP1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSNE     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    P1JNCD           Order Type_Sale
     C                     Z-ADDBEA0DT    P1A0DT           Order Date
     C                     Z-ADDBEA5DT    P1A5DT           Requested Ship
     C                     MOVELBEGTST    P1GTST           Comment Print A
     C                     MOVELBEGVST    P1GVST           Comment Print I
     C                     MOVELBEGUST    P1GUST           Comment Print P
     C                     MOVELBEQFST    P1QFST           Comment Print S
     C                     Z-ADDBEAODT    P1AODT           Scheduled Ship
     C                     Z-ADDBEJZVA    P1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    P1A1WG           Order Weight To
     C                     Z-ADDBEEIDT    P1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    P1AFTM           Requested Deliv
     C                     Z-ADDBERMNB    P1RMNB           Load ID
     C                     MOVELBEQ2CD    P1Q2CD           Shipping Method
     C                     MOVELBEVEST    P1VEST           Palletize
     C                     MOVELBEVFST    P1VFST           Shrink Wrap
     C                     MOVELBEVGST    P1VGST           Slip Sheet
     C                     Z-ADDBERNNB    P1RNNB           Reefer Temperat
     C                     MOVELBEVDST    P1VDST           Load Type
     C                     MOVELBEJPCD    P1JPCD           Event Code
     C                     MOVELBEXUST    P1XUST           Trans Contol AS
     C                     MOVELBEOBST    P1OBST           Billing Activit
     C                     MOVELBEBCST    P1BCST           Block Order Fla
     C                     MOVELBEFSSX    P1FSSX           Broker Order St
     C                     MOVELBEFVSX    P1FVSX           OH Load Plan Re
     C                     MOVELBEFXSX    P1FXSX           HPB Ship to War
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * RTV Commod. Mkt, Whse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0046           Type Code
     C                     MOVEL*BLANK    WUIWCD           Warehouse Code
     C                     MOVEL*BLANK    P5LQCD           Commodity Marke
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1AIC3    WMAIC3           Company Number
     C                     Z-ADDP1BKC7    WMBKC7           Ship To Custome
      * Establish starting position
     C           KRSNF     CHAIN@EOREUB              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBOCD    YL0046           Type Code
     C                     MOVELWMAJCD    WUIWCD           Warehouse Code
     C                     MOVELWMLQCD    P5LQCD           Commodity Marke
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAGTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CAGTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3           Company Number
     C                     Z-ADD#2C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     Z-ADD*ZERO     P1B0C7           Bill to Custome
     C                     MOVEL*BLANK    P1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     YL0001           Absorbed Freigh
     C                     MOVEL*BLANK    #CFYSX           OH TF Exempt Co
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBRTX    #CBRTX           Ship To Name
     C                     Z-ADDBEB0C7    P1B0C7           Bill to Custome
     C                     MOVELBEBCNA    P1BCNA           Customer Purcha
     C                     Z-ADDBETBNB    YL0001           Absorbed Freigh
     C                     MOVELBEFYSX    #CFYSX           OH TF Exempt Co
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Customer TFEx     RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVELWUGSTX    #CP3SX           Customer TF Exe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#PBKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUGSTX    #CP3SX           Customer TF Exe
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELNEP3SX    #CP3SX           Customer TF Exe
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Weight Ord & Sched RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0006           Weight Ordered
     C                     Z-ADD*ZERO     WL0007           Weight Schedule
     C                     Z-ADD*ZERO     WL0005           Quantity Ordere
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSD01           Company Number
     C                     Z-ADDWL0002    WQSD02           Order Number
     C                     Z-ADDWL0003    OMDPNB           Order Sequence
     C                     Z-ADDWL0004    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSD     SETLL@BGWKL1                    *
     C           KRSSD     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Avail/Alloc/Enter/Hold
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C                     ADD  OMAVQT    WL0005           Quantity Ordere
     C                     ADD  OMD0WG    WL0006           Weight Ordered
     C                     ADD  OMAUWG    WL0007           Weight Schedule
     C                     END                             *FI
     C           KRSSD     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Val Mkt Accrual Exist RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0009           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN HOBKC7    WQSE01           Ship To Custome
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0008    WQSE01           Ship To Custome
      * Establish starting position
     C           KRSSE     SETLL@HORELA                    *
     C           KRSSE     READE@HORELA                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Accrual Info       RT - Accrual Code Master  * 
     C                     EXSR SFRVGN
      * New for DLY029   6/19/07 RMC
      * CASE: LCL.Affect Invoice Price is yes
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WL0009           Record Found US
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Accrual Info       RT - Accrual Code Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           HLOJCD           Accrual Code
      * Setup key
     C                     MOVELHOOJCD    HLOJCD           Accrual Code
      * Establish starting position
     C           KRSSF     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Accrual Type
     C                     MOVEL*BLANK    YL0004           Affect Invoice
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELHLOKCD    YL0003           Accrual Type
     C                     MOVELHLFFTX    YL0004           Affect Invoice
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Co/Customer Type - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#2AIC3    EOAIC3           Company Number
     C                     Z-ADD#PBKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL*BLANK    WUBOCD           Type Code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WUBOCD           Type Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADD#2AIC3    KMAIC3           Company Number
     C                     MOVEL@CN,004   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSH     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    P7               System Value Al
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Contract Exists   RT - Customer Price Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0006           Contract Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN C6BKC7    WQSI01           Ship To Custome
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSI01           Ship To Custome
      * Establish starting position
     C           KRSSI     SETLL@C6REMM                    *
     C           KRSSI     READE@C6REMM                  90*
      * Data record not found
     C   90                MOVEL'USR3290' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.Price End Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFGE C6PLDT                     *IF
     C           P1AODT    IFLE C6PMDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           Contract Status
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@C6REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Discounts Exist   RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0007           Discounts Exist
      * Establish starting position
     C           *LOVAL    SETLL@HLRELX                    *
     C                     READ @HLRELX                  90*
      * Data record not found
     C   90                MOVEL'USR1514' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Accrual Type is Discount/Allowance
     C           WAOKCD    IFEQ 'DA'                       *IF
      * Rtv Discount Exists   RT - Customer Accrual  * 
     C                     EXSR SKRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0007           Discounts Exist
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Accrual Type is Product Discount
     C           WAOKCD    IFEQ 'PD'                       *IF
      * Rtv Discounts Exist   RT - Accrual Prod Pgm  * 
     C                     EXSR SLRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0007           Discounts Exist
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @HLRELX                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Discount Exists   RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0008           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN HOBKC7    WQSK01           Ship To Custome
     C           *LIKE     DEFN HOOJCD    WQSK02           Accrual Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Ship To Custome
     C                     KFLD           WQSK02           Accrual Code
      * Setup key
     C                     Z-ADDP1BKC7    WQSK01           Ship To Custome
     C                     MOVELWAOJCD    WQSK02           Accrual Code
      * Establish starting position
     C           KRSSK     SETLL@HORELA                    *
     C           KRSSK     READE@HORELA                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.Period Beginning Date
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFGE HOBFDT                     *IF
     C           P1AODT    IFLE HOA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Record Found US
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Discounts Exist   RT - Accrual Prod Pgm  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0008           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN D2OJCD    WQSL01           Accrual Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Accrual Code
      * Setup key
     C                     MOVELWAOJCD    WQSL01           Accrual Code
      * Establish starting position
     C           KRSSL     SETLL@D2RET9                    *
     C           KRSSL     READE@D2RET9                  90*
      * Data record not found
     C   90                MOVEL'USR3972' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.AD Period Beginning D
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.AD Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFGE D2SCDT                     *IF
     C           P1AODT    IFLE D2SDDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHECK: All Customers
      * CASE: DB1.AD All Customers is yes
     C           D2EWST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0008           Record Found US
     C                     GOTO SLEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Discount Exists   RT - Accrual Prod Pgm Cust  * 
     C                     EXSR SMRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0008           Record Found US
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@D2RET9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Discount Exists   RT - Accrual Prod Pgm Cust  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           FJOJCD           Accrual Code
     C                     KFLD           FJMSNY           AD Program Numb
     C                     KFLD           FJBKC7           Ship To Custome
      * Setup key
     C                     MOVELD2OJCD    FJOJCD           Accrual Code
     C                     Z-ADDD2MSNY    FJMSNY           AD Program Numb
     C                     Z-ADDP1BKC7    FJBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@FJREBY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4157' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0009           Record Found US
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0009           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDWL0010    IHAIC3           Company Number
     C                     MOVELWL0011    IHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSN     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0012           Price Method Ty
     C                     MOVEL*BLANK    WL0013           PMH Price Type
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHV8ST    WL0012           Price Method Ty
     C                     MOVELIHH3ST    WL0013           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Chk Item Cntrct Exist RT - Customer Price Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0016           Cust Item Cntrc
      * Declare restrictor key work fields
     C           *LIKE     DEFN C7BKC7    WQSO01           Ship To Custome
     C           *LIKE     DEFN C7HGCD    WQSO02           Item Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Ship To Custome
     C                     KFLD           WQSO02           Item Code
      * Setup key
     C                     Z-ADDWL0014    WQSO01           Ship To Custome
     C                     Z-ADDWL0015    WQSO02           Item Code
      * Establish starting position
     C           KRSSO     SETLL@C7RETR                    *
     C           KRSSO     READE@C7RETR                  90*
      * Data record not found
     C   90                MOVEL'USR3292' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Cust Prc Str/End  RT - Customer Price Header  * 
     C                     EXSR SPRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date LE LCL.Price End Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0017    IFGE YL0018                     *IF
     C           WL0017    IFLE YL0019                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WL0016           Cust Item Cntrc
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@C7RETR                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Cust Prc Str/End  RT - Customer Price Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN C6BKC7    WQSP01           Ship To Custome
     C           *LIKE     DEFN C6BVTM    WQSP02           Price Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Ship To Custome
     C                     KFLD           WQSP02           Price Code
      * Setup key
     C                     Z-ADDC7BKC7    WQSP01           Ship To Custome
     C                     Z-ADDC7BVTM    WQSP02           Price Code
      * Establish starting position
     C           KRSSP     SETLL@C6REMM                    *
     C           KRSSP     READE@C6REMM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3290' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0018           Price Start Dat
     C                     Z-ADD*ZERO     YL0019           Price End Date
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC6PLDT    YL0018           Price Start Dat
     C                     Z-ADDC6PMDT    YL0019           Price End Date
     C           KRSSP     READE@C6REMM                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Affect Fields      RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           EXJNCD           Order Type_Sale
      * Setup key
     C                     MOVEL#2JNCD    EXJNCD           Order Type_Sale
      * Establish starting position
     C           KRSSQ     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXOEST    #1AMST           Affect Inventor
     C                     MOVELEXOFST    #1ANST           Affect Sales Do
     C                     MOVELEXVBST    #1VAST           Affect Sales Pn
     C                     MOVELEXPYST    WUPYST           Affect Brokerag
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * CHG Order Value,Wgt,Ex CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0006  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0007  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0008  70       Ship To Custome
     C                     MOVEL*BLANK    WN0009 30        Ship To Name
     C                     MOVEL*BLANK    WN0010 30        Ship To Address
     C                     MOVEL*BLANK    WN0011 30        Ship To Address
     C                     MOVEL*BLANK    WN0012 30        Ship To Address
     C                     MOVEL*BLANK    WN0013 20        Ship To City
     C                     MOVEL*BLANK    WN0014  2        Ship To State C
     C                     MOVEL*BLANK    WN0015 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0016  70       Bill to Custome
     C                     MOVEL*BLANK    WN0017 30        Bill to Name
     C                     MOVEL*BLANK    WN0018 30        Bill to Address
     C                     MOVEL*BLANK    WN0019 30        Bill to Address
     C                     MOVEL*BLANK    WN0020 30        Bill to Address
     C                     MOVEL*BLANK    WN0021 20        Bill to City
     C                     MOVEL*BLANK    WN0022  2        Bill to State C
     C                     MOVEL*BLANK    WN0023 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0024 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0025  70       Order Date
     C                     Z-ADD*ZERO     WN0026  70       Requested Ship
     C                     Z-ADD*ZERO     WN0027  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0028  70       Cancel Date
     C                     MOVEL*BLANK    WN0029  2        Terms Code
     C                     MOVEL*BLANK    WN0030 40        Special Instruc
     C                     MOVEL*BLANK    WN0031 40        Special Instruc
     C                     MOVEL*BLANK    WN0032  3        Carrier Code
     C                     MOVEL*BLANK    WN0033  1        Comment Print A
     C                     MOVEL*BLANK    WN0034  1        Comment Print I
     C                     MOVEL*BLANK    WN0035  1        Comment Print P
     C                     MOVEL*BLANK    WN0036  1        Comment Print S
     C                     MOVEL*BLANK    WN0037  3        Reason Code
     C                     MOVEL*BLANK    WN0038  1        Order in Use
     C                     MOVEL*BLANK    WN0039  1        Header Status
     C                     MOVEL*BLANK    WN0040  1        Header Status L
     C                     MOVEL*BLANK    WN0041  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0042  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0043 10        User Original E
     C                     Z-ADD*ZERO     WN0044  70       Date of Origina
     C                     MOVEL*BLANK    WN0045  1        Credit Hold
     C                     MOVEL*BLANK    WN0046  1        Production Hold
     C                     MOVEL*BLANK    WN0047  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0048  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0049  40       Requested Deliv
     C                     MOVEL*BLANK    WN0050  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0051 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0052  70       Load ID
     C                     Z-ADD*ZERO     WN0053  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0054 112       Rated Freight
     C                     MOVEL*BLANK    WN0055  1        LTL Flag
     C                     MOVEL*BLANK    WN0056  1        Price Audit
     C                     MOVEL*BLANK    WN0057  1        Price Status
     C                     MOVEL*BLANK    WN0058  2        Shipping Method
     C                     MOVEL*BLANK    WN0059  1        Export Status
     C                     MOVEL*BLANK    WN0060  1        Palletize
     C                     MOVEL*BLANK    WN0061  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0062  1        Slip Sheet
     C                     MOVEL*BLANK    WN0063  1        Age Code
     C                     Z-ADD*ZERO     WN0064  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0065  1        Load Type
     C                     Z-ADD*ZERO     WN0066  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0067  1        Load Plan Order
     C                     MOVEL*BLANK    WN0068  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0069  70       Resell Referenc
     C                     MOVEL*BLANK    WN0070 30        Special Comment
     C                     MOVEL*BLANK    WN0071 30        Special Comment
     C                     MOVEL*BLANK    WN0072  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0073  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0074  2        Manager Level C
     C                     MOVEL*BLANK    WN0075  3        VP Level Code
     C                     Z-ADD*ZERO     WN0076  70       Attach to Order
     C                     MOVEL*BLANK    WN0077  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0078  70       Invoice Number
     C                     MOVEL*BLANK    WN0079  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0080  70       Invoice Date
     C                     MOVEL*BLANK    WN0081  2        Event Code
     C                     MOVEL*BLANK    WN0082  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0083  1        Modified Flag
     C                     Z-ADD*ZERO     WN0084 112       A_R order Value
     C                     MOVEL*BLANK    WN0085  1        Billing Activit
     C                     MOVEL*BLANK    WN0086  1        Block Order Fla
     C                     MOVEL*BLANK    WN0087  1        Order Certifica
     C                     Z-ADD*ZERO     WN0088 112       Invoice Order V
     C                     MOVEL*BLANK    WN0089  1        Process Sts for
     C                     MOVEL*BLANK    WN0090  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0091  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0092  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0093  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0094  1        Email Cust On O
     C                     MOVEL*BLANK    WN0095  1        Order Emailed
     C                     MOVEL*BLANK    WN0096  1        Export Docs Go
     C                     MOVEL*BLANK    WN0097  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0098  1        Broker Order St
     C                     MOVEL*BLANK    WN0099  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0100  2        Order Requires
     C                     MOVEL*BLANK    WN0101  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0102  2        Export USDA App
     C                     MOVEL*BLANK    WN0103  3        HPB Ship to War
     C                     Z-ADD*ZERO     WN0104  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0105  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0106  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0107  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0108  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0109  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0110  60       Time of Origina
     C                     Z-ADD*ZERO     WN0111  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0112  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0113  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0114 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0115 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0116 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0117 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0118 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0119  70       Claim Number
     C                     MOVEL*BLANK    WN0120  1        EDI Status 1
     C                     MOVEL*BLANK    WN0121  1        EDI Status 2
     C                     MOVEL*BLANK    WN0122  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0123  60       Job Time
     C                     MOVEL*BLANK    WN0124 10        User Id
     C                     MOVEL*BLANK    WN0125 10        Job Name
     C                     Z-ADD*ZERO     WN0126  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#2AIC3    WBAIC3           Company Number
     C                     Z-ADD#2C4NB    WBC4NB           Order Number
      *
     C           KLCHSR    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSR    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDP1JZVA    WBJZVA           Order Value Tot
     C                     Z-ADDP1A1WG    WBA1WG           Order Weight To
     C                     MOVEL#CFYSX    WBFYSX    P      OH TF Exempt Co
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWBAIC3    PCAIC3           Company Number
     C                     Z-ADDWBC4NB    PCC4NB           Order Number
     C                     MOVELWBJNCD    PCJNCD    P      Order Type_Sale
     C                     Z-ADDWBANC7    PCANC7           AR Customer Num
     C                     Z-ADDWBBKC7    PCBKC7           Ship To Custome
     C                     MOVELWBBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWBHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWBHONA    PCHONA    P      Ship To Address
     C                     MOVELWBHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PCHNNA    P      Ship To City
     C                     MOVELWBDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWBCKTX    PCCKTX    P      Ship To Zip_Pos
     C                     Z-ADDWBB0C7    PCB0C7           Bill to Custome
     C                     MOVELWBAETX    PCAETX    P      Bill to Name
     C                     MOVELWBB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PCB2NA    P      Bill to City
     C                     MOVELWBBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWBC8TX    PCC8TX    P      Bill to Zip_Pos
     C                     MOVELWBBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PCA0DT           Order Date
     C                     Z-ADDWBA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PCACDT           Cancel Date
     C                     MOVELWBAQCD    PCAQCD    P      Terms Code
     C                     MOVELWBB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWBBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWBGTST    PCGTST    P      Comment Print A
     C                     MOVELWBGVST    PCGVST    P      Comment Print I
     C                     MOVELWBGUST    PCGUST    P      Comment Print P
     C                     MOVELWBQFST    PCQFST    P      Comment Print S
     C                     MOVELWBCQCD    PCCQCD    P      Reason Code
     C                     MOVELWBGJST    PCGJST    P      Order in Use
     C                     MOVELWBGWST    PCGWST    P      Header Status
     C                     MOVELWBGXST    PCGXST    P      Header Status L
     C                     MOVELWBGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PCAODT           Scheduled Ship
     C                     MOVELWBAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWBJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PCA1WG           Order Weight To
     C                     MOVELWBXIST    PCXIST    P      Credit Hold
     C                     MOVELWBXJST    PCXJST    P      Production Hold
     C                     MOVELWBXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PCAFTM           Requested Deliv
     C                     MOVELWBE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PCRMNB           Load ID
     C                     Z-ADDWBTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PCR1NB           Rated Freight
     C                     MOVELWBPJST    PCPJST    P      LTL Flag
     C                     MOVELWBU0ST    PCU0ST    P      Price Audit
     C                     MOVELWBU1ST    PCU1ST    P      Price Status
     C                     MOVELWBQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PCU2ST    P      Export Status
     C                     MOVELWBVEST    PCVEST    P      Palletize
     C                     MOVELWBVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PCVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWBRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWBVDST    PCVDST    P      Load Type
     C                     Z-ADDWBATIN    PCATIN           Attach to Invoi
     C                     MOVELWBU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PCRSRN           Resell Referenc
     C                     MOVELWBMHNA    PCMHNA    P      Special Comment
     C                     MOVELWBMINA    PCMINA    P      Special Comment
     C                     MOVELWBWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PCT3NB           Attach to Order
     C                     MOVELWBSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PCCONB           Invoice Number
     C                     MOVELWBCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PCAWDT           Invoice Date
     C                     MOVELWBJPCD    PCJPCD    P      Event Code
     C                     MOVELWBXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PCVRVA           A_R order Value
     C                     MOVELWBOBST    PCOBST    P      Billing Activit
     C                     MOVELWBBCST    PCBCST    P      Block Order Fla
     C                     MOVELWBBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PCB7VL           Invoice Order V
     C                     MOVELWBGASX    PCGASX    P      Process Sts for
     C                     MOVELWBGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PCFUSX    P      Order Requires
     C                     MOVELWBFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWBFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWBBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PCH1NX           Act Non_Ref Frt
     C                     Z-ADDWBH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PCH3NX           OH Total Non_Re
     C                     Z-ADDWBH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PCC0C7           Claim Number
     C                     MOVELWBUVST    PCUVST    P      EDI Status 1
     C                     MOVELWBUWST    PCUWST    P      EDI Status 2
     C                     MOVELWBUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PCAATM           Job Time
     C                     MOVELWBAYNA    PCAYNA    P      User Id
     C                     MOVELWBA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Dsc,U/M,PrcInf,Str RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#1HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    #1Q7CD           Price Method De
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     MOVELBZQ8CD    #1Q7CD           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Item Def/TFExp/CO RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD#1HGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSST     CHAIN@BYREA1              90    *
      * Data record not found
     C   90                MOVEL'USR1160' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYP3ST    #RP3ST           TF Co_Ownership
     C                     MOVELBYS9ST    #1F4SX           Item TF Exempt
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WUWPST           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADD#1AIC3    KMAIC3           Company Number
     C                     MOVEL@CN,016   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSV     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WN0127           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWUIWCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSW     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0044           Shipping Compan
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    YL0044           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * VAL Item              RT - Ham Group Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN M1DPC7    WQSX01           Ham Group Item
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Ham Group Item
      * Setup key
     C                     Z-ADD#1HGCD    WQSX01           Ham Group Item
      * Establish starting position
     C           KRSSX     SETLL@M1REJ1                    *
     C           KRSSX     READE@M1REJ1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2839' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0036           Record Found US
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0036           Record Found US
     C                     GOTO SXEXIT                     *QUIT
     C           KRSSX     READE@M1REJ1                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * VAL Ham Group          RT - Ham Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           M0A1AA           Ham Group Numbe
      * Setup key
     C                     Z-ADD#1A1AA    M0A1AA           Ham Group Numbe
      * Establish starting position
     C           KRSSY     CHAIN@M0REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR2837' W0RTN   7
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Credit Item Sts   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#1HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSZ     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0045           Credit Item Sta
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZVMST    YL0045           Credit Item Sta
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * VAL Ham Group/Item     RT - Ham Group Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WCA1AA           Ham Group Numbe
     C                     KFLD           WCDPC7           Ham Group Item
      * Setup key
     C                     Z-ADD#1A1AA    WCA1AA           Ham Group Numbe
     C                     Z-ADD#1HGCD    WCDPC7           Ham Group Item
      * Establish starting position
     C           KRSTA     CHAIN@M1REJ2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2839' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    EOAIC3           Company Number
     C                     Z-ADD#1BKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSTB     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0046           Type Code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    YL0046           Type Code
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Val Manual Price      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#1HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSTC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0047           Description Lin
     C                     MOVEL*BLANK    YL0048           Default Commod
     C                     Z-ADD*ZERO     YL0049           Market Overage
     C                     Z-ADD*ZERO     YL0050           Standard Overag
     C                     MOVEL*BLANK    YL0051           Commodity Price
     C                     Z-ADD*ZERO     YL0052           Std Weight_Head
     C                     MOVEL*BLANK    YL0039           Primal Group Co
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    YL0047           Description Lin
     C                     MOVELBZLNCD    YL0048           Default Commod
     C                     Z-ADDBZBLPR    YL0049           Market Overage
     C                     Z-ADDBZBMPR    YL0050           Standard Overag
     C                     MOVELBZLRCD    YL0051           Commodity Price
     C                     Z-ADDBZSWGH    YL0052           Std Weight_Head
     C                     MOVELBZXRCD    YL0039           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ASAIC3           Company Number
      * Establish starting position
     C           KRSTD     CHAIN@ASREVL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0133           Manual Price Ac
     C                     Z-ADD*ZERO     WN0134           CoPk_FdSrv ManP
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASAIPC    WN0133           Manual Price Ac
     C                     Z-ADDASASPC    WN0134           CoPk_FdSrv ManP
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F0LQCD    WQTE01           Commodity Marke
     C           *LIKE     DEFN F0LRCD    WQTE02           Commodity Price
      * Define keylist
     C           KPSTE     KLIST
     C                     KFLD           WQTE01           Commodity Marke
     C                     KFLD           WQTE02           Commodity Price
     C                     KFLD           F0EQDT           Market Price Da
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Commodity Marke
     C                     KFLD           WQTE02           Commodity Price
      * Setup key
     C                     MOVELWL0018    WQTE01           Commodity Marke
     C                     MOVELWL0019    WQTE02           Commodity Price
     C                     Z-ADDWL0020    F0EQDT           Market Price Da
      * Establish starting position
     C           KPSTE     SETLL@F0CPEP                    *
     C           KRSTE     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0021           Commodity Marke
     C                     Z-ADD*ZERO     WL0022           USR Date Priced
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDF0A5PR    WL0021           Commodity Marke
     C                     Z-ADDF0EQDT    WL0022           USR Date Priced
     C                     GOTO TEEXIT                     *QUIT
     C           KRSTE     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * VAL Date Method Exists RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IPBXST    WQTF01           System using Da
     C           *LIKE     DEFN IPAIC3    WQTF02           Company Number
     C           *LIKE     DEFN IPRDCD    WQTF03           Date Method Cod
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           System using Da
     C                     KFLD           WQTF02           Company Number
     C                     KFLD           WQTF03           Date Method Cod
      * Setup key
     C                     MOVEL'O'       WQTF01           System using Da
     C                     Z-ADD#1AIC3    WQTF02           Company Number
     C                     MOVEL#1RDCD    WQTF03           Date Method Cod
      * Establish starting position
     C           KRSTF     SETLL@IPREFJ                    *
     C           KRSTF     READE@IPREFJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C           KRSTF     READE@IPREFJ                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDLQCD    WQTG01           Commodity Marke
     C           *LIKE     DEFN WDLRCD    WQTG02           Commodity Price
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Commodity Marke
     C                     KFLD           WQTG02           Commodity Price
      * Setup key
     C                     MOVELWL0023    WQTG01           Commodity Marke
     C                     MOVELWL0024    WQTG02           Commodity Price
      * Establish starting position
     C           KRSTG     SETLL@F0CPVR                    *
     C           KRSTG     READE@F0CPVR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TGEXIT                     *QUIT
     C           KRSTG     READE@F0CPVR                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Contract Defaults  RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CIL6NB    WQTH01           Contract Number
     C           *LIKE     DEFN CIAIC3    WQTH02           Company Number
     C           *LIKE     DEFN CIBKC7    WQTH03           Ship To Custome
     C           *LIKE     DEFN CIHGCD    WQTH04           Item Code
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Contract Number
     C                     KFLD           WQTH02           Company Number
     C                     KFLD           WQTH03           Ship To Custome
     C                     KFLD           WQTH04           Item Code
      * Setup key
     C                     Z-ADD#1L6NB    WQTH01           Contract Number
     C                     Z-ADD#1AIC3    WQTH02           Company Number
     C                     Z-ADD#1BKC7    WQTH03           Ship To Custome
     C                     Z-ADD#1HGCD    WQTH04           Item Code
      * Establish starting position
     C           KRSTH     SETLL@CIREWO                    *
     C           KRSTH     READE@CIREWO                  90*
      * Data record not found
     C   90                MOVEL'USR0463' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCIAUNA    #RCJTX           Description
     C                     Z-ADDCIB0PR    #1BZPR           Contract Price
     C                     Z-ADDCIGBDT    #1EXDT           Contract Mkt Pr
     C                     MOVELCIRDCD    #1RDCD           Date Method Cod
     C                     MOVELCIQ7CD    #1Q7CD           Price Method Co
     C                     MOVELCIRQCD    #1LQCD           Dft Commodity M
     C           KRSTH     READE@CIREWO                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Entered Cont #     RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQTI01           Company Number
     C           *LIKE     DEFN WEL6NB    WQTI02           Contract Number
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Contract Number
      * Setup key
     C                     Z-ADD#2AIC3    WQTI01           Company Number
     C                     Z-ADD#1L6NB    WQTI02           Contract Number
      * Establish starting position
     C           KRSTI     SETLL@CIRERR                    *
     C           KRSTI     READE@CIRERR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Description
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWEAUNA    WUG0TX           Description
     C           KRSTI     READE@CIRERR                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Prc Mth Typ by Sys RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBYST    WQTJ01           System Using Pr
     C           *LIKE     DEFN WFAIC3    WQTJ02           Company Number
     C           *LIKE     DEFN WFQ7CD    WQTJ03           Price Method Co
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           System Using Pr
     C                     KFLD           WQTJ02           Company Number
     C                     KFLD           WQTJ03           Price Method Co
      * Setup key
     C                     MOVEL'O'       WQTJ01           System Using Pr
     C                     Z-ADD#1AIC3    WQTJ02           Company Number
     C                     MOVEL#1Q7CD    WQTJ03           Price Method Co
      * Establish starting position
     C           KRSTJ     SETLL@IHREFI                    *
     C           KRSTJ     READE@IHREFI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P7V8ST           Price Method Ty
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFV8ST    P7V8ST           Price Method Ty
     C           KRSTJ     READE@IHREFI                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Edt for Existing   RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQTK01           Company Number
     C           *LIKE     DEFN WGBKC7    WQTK02           Ship To Custome
     C           *LIKE     DEFN WGHGCD    WQTK03           Item Code
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Company Number
     C                     KFLD           WQTK02           Ship To Custome
     C                     KFLD           WQTK03           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WQTK01           Company Number
     C                     Z-ADD#1BKC7    WQTK02           Ship To Custome
     C                     Z-ADD#1HGCD    WQTK03           Item Code
      * Establish starting position
     C           KRSTK     SETLL@CIREWP                    *
     C           KRSTK     READE@CIREWP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Effective Date GE DB1.Effective Date
      *   |- c2    : PAR.Effective Date LE DB1.End Date Effective
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1A0DT    IFGE WGAUDT                     *IF
     C           P1A0DT    IFLE WGCWDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C                     Z-ADDWGL6NB    WUL6NB           Contract Number
     C           KRSTK     READE@CIREWP                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Val. Contract #    RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CIL6NB    WQTL01           Contract Number
     C           *LIKE     DEFN CIAIC3    WQTL02           Company Number
     C           *LIKE     DEFN CIBKC7    WQTL03           Ship To Custome
     C           *LIKE     DEFN CIHGCD    WQTL04           Item Code
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Contract Number
     C                     KFLD           WQTL02           Company Number
     C                     KFLD           WQTL03           Ship To Custome
     C                     KFLD           WQTL04           Item Code
      * Setup key
     C                     Z-ADDWUL6NB    WQTL01           Contract Number
     C                     Z-ADD#1AIC3    WQTL02           Company Number
     C                     Z-ADD#1BKC7    WQTL03           Ship To Custome
     C                     Z-ADD#1HGCD    WQTL04           Item Code
      * Establish starting position
     C           KRSTL     SETLL@CIREWO                    *
     C           KRSTL     READE@CIREWO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDCIAUDT    WN0137           Effective Date
     C                     Z-ADDCICWDT    WN0138           End Date Effect
     C                     Z-ADDCIDQQT    WN0139           Maximum Quantit
     C                     Z-ADDCIHFQT    WN0140           Quantity Sold
     C           KRSTL     READE@CIREWO                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSTM     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHF8NA    WUG0TX           Warehouse Descr
     C                     MOVELWHXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * VAL Item Level Exists  RT - Item Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           ILRBCD           Item Level
      * Setup key
     C                     MOVEL#1RBCD    ILRBCD           Item Level
      * Establish starting position
     C           KRSTN     CHAIN@ILREVH              90    *
      * Data record not found
     C   90                MOVEL'USR1673' W0RTN   7
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN MSAIC3    WQTO01           Company Number
     C           *LIKE     DEFN MSC4NB    WQTO02           Order Number
     C           *LIKE     DEFN MSDPNB    WQTO03           Order Sequence
     C           *LIKE     DEFN MSUENB    WQTO04           Order Secondary
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Order Number
     C                     KFLD           WQTO03           Order Sequence
     C                     KFLD           WQTO04           Order Secondary
      * Setup key
     C                     Z-ADDWL0025    WQTO01           Company Number
     C                     Z-ADDWL0026    WQTO02           Order Number
     C                     Z-ADDWL0027    WQTO03           Order Sequence
     C                     Z-ADDWL0028    WQTO04           Order Secondary
      * Establish starting position
     C           KRSTO     SETLL@MSREX2                    *
     C           KRSTO     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR TPDLRC
     C           KRSTO     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPDLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDMSAIC3    WKAIC3           Company Number
     C                     Z-ADDMSC4NB    WKC4NB           Order Number
     C                     MOVELMSDGSX    WKDGSX           ED Export Docum
     C                     MOVELMSKXCD    WKKXCD           Country Code
     C                     Z-ADDMSDPNB    WKDPNB           Order Sequence
     C                     Z-ADDMSUENB    WKUENB           Order Secondary
      *
     C           KLDLTP    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDGSX           ED Export Docum
     C                     KFLD           WKKXCD           Country Code
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLDLTP    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQDLRC    BEGSR
      *================================================================
      * DLT PD Order Detail    DL - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0029    OMAIC3           Company Number
     C                     Z-ADDWL0030    OMC4NB           Order Number
     C                     Z-ADDWL0031    OMDPNB           Order Sequence
     C                     Z-ADDWL0032    OMUENB           Order Secondary
      *
     C           KLDLTQ    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLDLTQ    CHAIN@BGWKL0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BGWKL0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * CHG Sts,Alloc          CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0141  70       Item Code
     C                     MOVEL*BLANK    WN0142  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0143  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0144  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0145 112       Billing Detail
     C                     Z-ADD*ZERO     WN0146 112       Billing Detail
     C                     Z-ADD*ZERO     WN0147 112       Billing Detail
     C                     Z-ADD*ZERO     WN0148 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0149  1        Comment Print A
     C                     MOVEL*BLANK    WN0150  1        Comment Print I
     C                     MOVEL*BLANK    WN0151  1        Comment Print P
     C                     MOVEL*BLANK    WN0152  1        Comment Print S
     C                     Z-ADD*ZERO     WN0153 112       Extended Amount
     C                     Z-ADD*ZERO     WN0154  70       Market Pricing
     C                     MOVEL*BLANK    WN0155  3        Commodity Marke
     C                     MOVEL*BLANK    WN0156  3        Date Method Cod
     C                     MOVEL*BLANK    WN0157  3        Price Method Co
     C                     Z-ADD*ZERO     WN0158 114       Price Overage O
     C                     Z-ADD*ZERO     WN0159  70       Contract Number
     C                     MOVEL*BLANK    WN0160  1        Price Status
     C                     Z-ADD*ZERO     WN0161  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0162  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0163  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0164  1        Work Confirm St
     C                     MOVEL*BLANK    WN0165  1        Work Over_Short
     C                     MOVEL*BLANK    WN0166  1        OD Production P
     C                     MOVEL*BLANK    WN0167 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0168 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0169  1        Age Code
     C                     MOVEL*BLANK    WN0170  1        Palletize
     C                     MOVEL*BLANK    WN0171  1        Slip Sheet
     C                     MOVEL*BLANK    WN0172  1        Catch Weight St
     C                     MOVEL*BLANK    WN0173  1        Price Audit
     C                     MOVEL*BLANK    WN0174  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0175  1        Production Date
     C                     Z-ADD*ZERO     WN0176 112       Rated Freight
     C                     Z-ADD*ZERO     WN0177 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0178 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0179 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0180 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0181 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0182 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0183 114       Unit Price
     C                     Z-ADD*ZERO     WN0184 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0185 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0186 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0187 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0188  70       Requested Ship
     C                     Z-ADD*ZERO     WN0189  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0190  70       Actual Shipped
     C                     MOVEL*BLANK    WN0191  1        Affect Inventor
     C                     MOVEL*BLANK    WN0192  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0193  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0194  30       Item Structure
     C                     Z-ADD*ZERO     WN0195  30       Item Structure
     C                     Z-ADD*ZERO     WN0196  30       Item Structure
     C                     MOVEL*BLANK    WN0197  2        Item Level
     C                     MOVEL*BLANK    WN0198  2        Quality Level
     C                     MOVEL*BLANK    WN0199  2        Pricing Product
     C                     MOVEL*BLANK    WN0200  2        Season Product
     C                     Z-ADD*ZERO     WN0201  70       Date of Origina
     C                     MOVEL*BLANK    WN0202 10        User Profile Na
     C                     MOVEL*BLANK    WN0203  6        Country Code
     C                     MOVEL*BLANK    WN0204  2        Event Code
     C                     MOVEL*BLANK    WN0205  3        Reason Code
     C                     MOVEL*BLANK    WN0206  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0207  1        Modified Flag
     C                     MOVEL*BLANK    WN0208  1        Substituted Fla
     C                     MOVEL*BLANK    WN0209  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0210 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0211 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0212  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0213  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0214  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0215  1        Affect Commissi
     C                     MOVEL*BLANK    WN0216  1        Affect Pricing
     C                     MOVEL*BLANK    WN0217  1        Released by Use
     C                     MOVEL*BLANK    WN0218  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0219  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0220  3        Production Ware
     C                     MOVEL*BLANK    WN0221  3        OD Price Type
     C                     Z-ADD*ZERO     WN0222  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0223  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0224  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0225  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0226  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0227  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0228  60       Price Code
     C                     Z-ADD*ZERO     WN0229  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0230  60       Substitution Li
     C                     Z-ADD*ZERO     WN0231  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0232 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0233 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0234 112       OD Item Target
     C                     Z-ADD*ZERO     WN0235 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0236 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0237 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0238 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0239 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0240 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0241 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0242 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0243 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0244 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0245  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0246  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0247  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0248 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0249  40       Item Age Days
     C                     Z-ADD*ZERO     WN0250  70       Production Ovr
     C                     Z-ADD*ZERO     WN0251  70       Production Ovr
     C                     MOVEL*BLANK    WN0252  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0253  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0254  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0255  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0256  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0257  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0258  1        EDI Status 1
     C                     MOVEL*BLANK    WN0259  1        EDI Status 2
     C                     MOVEL*BLANK    WN0260  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0261  60       Job Time
     C                     MOVEL*BLANK    WN0262 10        User Id
     C                     MOVEL*BLANK    WN0263 10        Job Name
     C                     Z-ADD*ZERO     WN0264  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHTR    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHTR    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#1GMST    OMGMST    P      Detail Line Sta
     C                     MOVEL#1GNST    OMGNST    P      Detail Line Sta
     C                     Z-ADD#1CCQT    OMCCQT           Quantity Schedu
     C                     Z-ADD#1AUWG    OMAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * E2640 Write chg log for cancel line item
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Detail Line Status is Cancelled
      *   |- c2    : PAR.Detail Line Status Last is Not cancelled
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GMST    IFEQ 'X'                        *IF
     C           #1GNST    IFEQ 'L'                        *IF
     C           #1GNST    OREQ 'A'
     C           #1GNST    OREQ 'C'
     C           #1GNST    OREQ 'R'
     C           #1GNST    OREQ 'E'
     C           #1GNST    OREQ 'H'
     C           #1GNST    OREQ 'I'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELOMDPNB    YL0075           Text 3 Length U
     C                     Z-ADDOMD0WG    YL0076           Weight Beg Inv
     C                     MOVELYL0076    YL0077           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0075    CAT  YL0077:ZQ YL0078    P      Change Log Prio
      * New value is -0- for cancel
     C                     Z-ADD0         YL0076           Weight Beg Inv
     C                     MOVEL*BLANK    YL0079           Change Log New
     C                     MOVELYL0076    YL0079           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0561  70       Load ID
     C                     PARM 'ORDWGT'  WQ0562  6        Load Change Typ
     C                     PARM 'SLS'     WQ0563  3        Department Cont
     C                     PARM YL0078    WQ0564 12        Change Log Prio
     C                     PARM YL0079    WQ0565 12        Change Log New
     C                     PARM OMAIC3    WQ0566  30       Company Number
     C                     PARM OMC4NB    WQ0567  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDOMAVQT    YL0076           Weight Beg Inv
     C                     MOVELYL0076    YL0077           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0075    CAT  YL0077:ZQ YL0078    P      Change Log Prio
      * New value is -0- for cancel
     C                     Z-ADD0         YL0076           Weight Beg Inv
     C                     MOVEL*BLANK    YL0079           Change Log New
     C                     MOVELYL0076    YL0079           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0568  70       Load ID
     C                     PARM 'ORDQTY'  WQ0569  6        Load Change Typ
     C                     PARM 'SLS'     WQ0570  3        Department Cont
     C                     PARM YL0078    WQ0571 12        Change Log Prio
     C                     PARM YL0079    WQ0572 12        Change Log New
     C                     PARM OMAIC3    WQ0573  30       Company Number
     C                     PARM OMC4NB    WQ0574  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * DEL Substitutions/Line RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQTS01           Company Number
     C           *LIKE     DEFN WLC4NB    WQTS02           Order Number
     C           *LIKE     DEFN WLDPNB    WQTS03           Order Sequence
      * Define keylist
     C           KPSTS     KLIST
     C                     KFLD           WQTS01           Company Number
     C                     KFLD           WQTS02           Order Number
     C                     KFLD           WQTS03           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Company Number
     C                     KFLD           WQTS02           Order Number
     C                     KFLD           WQTS03           Order Sequence
      * Setup key
     C                     Z-ADD#1AIC3    WQTS01           Company Number
     C                     Z-ADD#1C4NB    WQTS02           Order Number
     C                     Z-ADD#1DPNB    WQTS03           Order Sequence
     C                     Z-ADDWUUENB    WLUENB           Order Secondary
      * Establish starting position
     C           KPSTS     SETLL@BGWKAE                    *
     C           KRSTS     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Delete Detail Line RT - PD Order Detail  * 
     C                     EXSR TTRVGN
     C           KRSTS     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * CHG Delete Detail Line RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0265 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0266 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0267  30       Order Count Net
     C                     MOVEL*BLANK    WN0268  2        UOM Primary
     C                     Z-ADD*ZERO     WN0269  94       Conversion Fact
     C                     MOVEL*BLANK    WN0270  1        Operation Facto
     C                     MOVEL*BLANK    WN0271  2        UOM Second
     C                     Z-ADD*ZERO     WN0272  94       Conversion Fact
     C                     MOVEL*BLANK    WN0273  1        Operation Facto
     C                     MOVEL*BLANK    WN0274  2        UOM Third
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
     C                     Z-ADD*ZERO     WUBAQT           USR Quantity
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADDWLAIC3    OMAIC3           Company Number
     C                     Z-ADDWLC4NB    OMC4NB           Order Number
     C                     Z-ADDWLDPNB    OMDPNB           Order Sequence
     C                     Z-ADDWLUENB    OMUENB           Order Secondary
      * Establish starting position
     C           KRSTT     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Set control for inventory update
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
      * If negative quantity then no inventory update required
      * CASE: DB1.Quantity Ordered is Less than zero
     C           OMAVQT    IFLT 0                          *IF
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     END                             *FI
      * Bypass if affect inventory is no
      * CASE: DB1.Affect Inventory Status is no
     C           OMAMST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     END                             *FI
      * Bypass if entered status
      * CASE: DB1.Detail Line Status is Entered
     C           OMGMST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     END                             *FI
      * Determine quantity open on this line
     C                     EXSR UMSUBR                     Determine quant
      * Process Inventory update if required by control field
     C                     EXSR UNSUBR                     Process Invento
      * Update detail record to indicate delete status
     C                     EXSR UOSUBR                     Update detail r
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * CHG PD Order Detail    CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0275  60       Job Time
     C                     MOVEL*BLANK    WN0276 10        User Id
     C                     MOVEL*BLANK    WN0277 10        Job Name
     C                     Z-ADD*ZERO     WN0278  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0033    OMAIC3           Company Number
     C                     Z-ADDWL0034    OMC4NB           Order Number
     C                     Z-ADDWL0035    OMDPNB           Order Sequence
     C                     Z-ADDWL0036    OMUENB           Order Secondary
      *
     C           KLCHTU    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHTU    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * USER: Processing after Data read
      * E2247 RMC 10/03/12 Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Sent to USDA Sts is yes
     C           OMHOST    IFEQ 'Y'                        *IF
      * If price type changes, then create type: ORDPRT
      * CASE: DB1.OD Price Type NE PAR.OD Price Type
     C           OMF7SX    IFNE WL0121                     *IF
      * change log prior has seq in pos 1-3, price type 5-7: '001 NEG
     C                     MOVELOMDPNB    YL0080           Text 3 Length U
     C                     Z-ADD1         ZQ      50
     C           YL0080    CAT  OMF7SX:ZQ YL0081    P      Change Log Prio
     C                     MOVEL*BLANK    YL0082           Change Log New
     C                     MOVELWL0121    YL0082           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0591  70       Load ID
     C                     PARM 'ORDPRT'  WQ0592  6        Load Change Typ
     C                     PARM 'SLS'     WQ0593  3        Department Cont
     C                     PARM YL0081    WQ0594 12        Change Log Prio
     C                     PARM YL0082    WQ0595 12        Change Log New
     C                     PARM OMAIC3    WQ0596  30       Company Number
     C                     PARM OMC4NB    WQ0597  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If not the transfer order nbr 9999999 -> crt chg logs
      * CASE: DB1.Order Number is ne 9999999
     C           OMC4NB    IFNE 9999999                    *IF
      * If qty changes, then create type: ORDWGT & ORDQTY ->ALWAYS 6/14/1
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Ordered NE PAR.Quantity Ordered
      *   |- c2    : PAR.Detail Line Status is Cancelled
      *   '-
     C           OMAVQT    IFNE WL0075                     *IF
     C           WL0041    OREQ 'X'                        *OR
      * (do this off of qty, because wgt can change often since unit wgt
      * change log prior has seq in pos 1-3, weight in 5-11: '001 0000nnn
     C                     MOVELOMDPNB    YL0080           Text 3 Length U
     C                     Z-ADDOMD0WG    YL0083           Weight Beg Inv
     C                     MOVELYL0083    YL0084           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0080    CAT  YL0084:ZQ YL0081    P      Change Log Prio
     C                     Z-ADDWL0076    YL0083           Weight Beg Inv
      * WI642-For cancelled item line new weight is zero for log only.
      * CASE: PAR.Detail Line Status is Cancelled
     C           WL0041    IFEQ 'X'                        *IF
     C                     Z-ADD*ZERO     YL0083           Weight Beg Inv
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0082           Change Log New
     C                     MOVELYL0083    YL0082           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0598  70       Load ID
     C                     PARM 'ORDWGT'  WQ0599  6        Load Change Typ
     C                     PARM 'SLS'     WQ0600  3        Department Cont
     C                     PARM YL0081    WQ0601 12        Change Log Prio
     C                     PARM YL0082    WQ0602 12        Change Log New
     C                     PARM OMAIC3    WQ0603  30       Company Number
     C                     PARM OMC4NB    WQ0604  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDOMAVQT    YL0083           Weight Beg Inv
     C                     MOVELYL0083    YL0084           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0080    CAT  YL0084:ZQ YL0081    P      Change Log Prio
     C                     Z-ADDWL0075    YL0083           Weight Beg Inv
      * WI642-For cancelled item line new quantity is zero for log only.
      * CASE: PAR.Detail Line Status is Cancelled
     C           WL0041    IFEQ 'X'                        *IF
     C                     Z-ADD*ZERO     YL0083           Weight Beg Inv
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0082           Change Log New
     C                     MOVELYL0083    YL0082           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0605  70       Load ID
     C                     PARM 'ORDQTY'  WQ0606  6        Load Change Typ
     C                     PARM 'SLS'     WQ0607  3        Department Cont
     C                     PARM YL0081    WQ0608 12        Change Log Prio
     C                     PARM YL0082    WQ0609 12        Change Log New
     C                     PARM OMAIC3    WQ0610  30       Company Number
     C                     PARM OMC4NB    WQ0611  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0037    OMHGCD           Item Code
     C                     MOVELWL0038    OMAJCD    P      Warehouse Code
     C                     Z-ADDWL0039    OMBKC7           Ship To Custome
     C                     Z-ADDWL0040    OMCFC7           Order Group Cod
     C                     MOVELWL0041    OMGMST    P      Detail Line Sta
     C                     MOVELWL0042    OMGNST    P      Detail Line Sta
     C                     Z-ADDWL0043    OMMAVA           Billing Detail
     C                     Z-ADDWL0044    OMKDVA           Billing Detail
     C                     Z-ADDWL0045    OML8VA           Billing Detail
     C                     Z-ADDWL0046    OML9VA           Quantity to Sub
     C                     MOVELWL0047    OMGTST    P      Comment Print A
     C                     MOVELWL0048    OMGVST    P      Comment Print I
     C                     MOVELWL0049    OMGUST    P      Comment Print P
     C                     MOVELWL0050    OMQFST    P      Comment Print S
     C                     Z-ADDWL0051    OMAYVA           Extended Amount
     C                     Z-ADDWL0052    OMEXDT           Market Pricing
     C                     MOVELWL0053    OMLQCD    P      Commodity Marke
     C                     MOVELWL0054    OMRDCD    P      Date Method Cod
     C                     MOVELWL0055    OMQ7CD    P      Price Method Co
     C                     Z-ADDWL0056    OMBZPR           Price Overage O
     C                     Z-ADDWL0057    OML6NB           Contract Number
     C                     MOVELWL0058    OMU1ST    P      Price Status
     C                     Z-ADDWL0059    OMGIDT           Pricing Date Us
     C                     MOVELWL0060    OMCRCD    P      U_M_Base Price
     C                     MOVELWL0061    OMAGCD    P      U_M_Ordered
     C                     MOVELWL0062    OMRZST    P      Work Confirm St
     C                     MOVELWL0063    OMR0ST    P      Work Over_Short
     C                     MOVELWL0064    OMR1ST    P      OD Production P
     C                     MOVELWL0065    OMG7NA    P      Order Desc_Line
     C                     MOVELWL0066    OMG8NA    P      Order Desc_Line
     C                     MOVELWL0067    OMRPCD    P      Age Code
     C                     MOVELWL0068    OMVEST    P      Palletize
     C                     MOVELWL0069    OMVGST    P      Slip Sheet
     C                     MOVELWL0070    OMAVST    P      Catch Weight St
     C                     MOVELWL0071    OMU0ST    P      Price Audit
     C                     MOVELWL0072    OMRFCD    P      Price Audit Rea
     C                     MOVELWL0073    OMFZST    P      Production Date
     C                     Z-ADDWL0074    OMR1NB           Rated Freight
     C                     Z-ADDWL0075    OMAVQT           Quantity Ordere
     C                     Z-ADDWL0076    OMD0WG           Weight Ordered
     C                     Z-ADDWL0077    OMCCQT           Quantity Schedu
     C                     Z-ADDWL0078    OMAUWG           Weight Schedule
     C                     Z-ADDWL0079    OMCBQT           Quantity Shippe
     C                     Z-ADDWL0080    OMATWG           Weight Shipped
     C                     Z-ADDWL0081    OMAQCS           Unit Cost Prici
     C                     Z-ADDWL0082    OMAGCS           Unit Cost Per P
     C                     Z-ADDWL0083    OMAKPR           Unit Price
     C                     Z-ADDWL0084    OMALPR           Unit Price_Cred
     C                     Z-ADDWL0085    OMAUPR           Unit Price Orde
     C                     Z-ADDWL0086    OMAVWG           Unit Weight Ord
     C                     Z-ADDWL0087    OMA4WG           Tare Weight Tot
     C                     Z-ADDWL0088    OMA5DT           Requested Ship
     C                     Z-ADDWL0089    OMAODT           Scheduled Ship
     C                     Z-ADDWL0090    OMGNDT           Actual Shipped
     C                     MOVELWL0091    OMAMST    P      Affect Inventor
     C                     MOVELWL0092    OMANST    P      Affect Sales Do
     C                     MOVELWL0093    OMVAST    P      Affect Sales Pn
     C                     Z-ADDWL0094    OMRGNB           Item Structure
     C                     Z-ADDWL0095    OMRHNB           Item Structure
     C                     Z-ADDWL0096    OMRINB           Item Structure
     C                     MOVELWL0097    OMRBCD    P      Item Level
     C                     MOVELWL0098    OMHICD    P      Quality Level
     C                     MOVELWL0099    OMRNCD    P      Pricing Product
     C                     MOVELWL0100    OMROCD    P      Season Product
     C                     Z-ADDWL0101    OMCXDT           Date of Origina
     C                     MOVELWL0102    OMAJVN    P      User Profile Na
     C                     MOVELWL0103    OMKXCD    P      Country Code
     C                     MOVELWL0104    OMJPCD    P      Event Code
     C                     MOVELWL0105    OMCQCD    P      Reason Code
     C                     MOVELWL0106    OMR4CD    P      Sales Route Cod
     C                     MOVELWL0107    OMZ1ST    P      Modified Flag
     C                     MOVELWL0108    OMZ3ST    P      Substituted Fla
     C                     MOVELWL0109    OMZ4ST    P      OD Schedule Ove
     C                     Z-ADDWL0110    OMDUPR           Invoice Unit Pr
     C                     Z-ADDWL0111    OMB6VL           Invoice Extende
     C                     Z-ADDWL0112    OMA1AA           Ham Group Numbe
     C                     MOVELWL0113    OMFZSX    P      OD Adj Type Ove
     C                     MOVELWL0114    OMF0SX    P      Affect Trade Fu
     C                     MOVELWL0115    OMF1SX    P      Affect Commissi
     C                     MOVELWL0116    OMF2SX    P      Affect Pricing
     C                     MOVELWL0117    OMF3SX    P      Released by Use
     C                     MOVELWL0118    OMF4SX    P      Ord TF Exempt C
     C                     MOVELWL0119    OMF5SX    P      OD Pallet Type
     C                     MOVELWL0120    OMF6SX    P      Production Ware
     C                     MOVELWL0121    OMF7SX    P      OD Price Type
     C                     Z-ADDWL0122    OMNTDT           Warehouse Palle
     C                     Z-ADDWL0123    OMNUDT           Consumed Item C
     C                     Z-ADDWL0124    OMNVDT           Deadline Depart
     C                     Z-ADDWL0125    OMNWDT           OD Price Type R
     C                     Z-ADDWL0126    OMNXDT           OD Firm Date
     C                     Z-ADDWL0127    OMBUTM           Deadline Depart
     C                     Z-ADDWL0128    OMBVTM           Price Code
     C                     Z-ADDWL0129    OMBWTM           Maximum Net Wei
     C                     Z-ADDWL0130    OMBXTM           Substitution Li
     C                     Z-ADDWL0131    OMBYTM           Max Qty to sche
     C                     Z-ADDWL0132    OMH5NX           Warehouse Palle
     C                     Z-ADDWL0133    OMH6NX           Warehouse Avg P
     C                     Z-ADDWL0134    OMH7NX           OD Item Target
     C                     Z-ADDWL0135    OMH8NX           OD Estimated Gr
     C                     Z-ADDWL0136    OMH9NX           OD Maximum Unit
     C                     Z-ADDWL0137    OMDVPR           Order Gate_Fina
     C                     Z-ADDWL0138    OMDWPR           OD Ceiling Pric
     C                     Z-ADDWL0139    OMDXPR           OD Gate_Final P
     C                     Z-ADDWL0140    OMDYPR           OD Weighted Avg
     C                     Z-ADDWL0141    OMDZPR           OD Original Ord
     C                     Z-ADDWL0142    OMGSPR           OD Cancel Date
     C                     Z-ADDWL0143    OMGTPR           OD Unused Prc 7
     C                     Z-ADDWL0144    OMGUPR           OD Unused Prc 8
     C                     MOVELWL0145    OMHOST    P      OD MPR Sent to
     C                     MOVELWL0146    OMHPST    P      OD MPR Prc Read
     C                     MOVELWL0147    OMIOST    P      OD UnUsed Price
     C                     Z-ADDWL0148    OMPEWG           Weight Amount E
     C                     Z-ADDWL0149    OMRINY           Item Age Days
     C                     Z-ADDWL0150    OMTIDT           Production Ovr
     C                     Z-ADDWL0151    OMTJDT           Production Ovr
     C                     MOVELWL0152    OMH2ST    P      OD Spot Buy
     C                     MOVELWL0153    OMH0ST    P      OD Clm Full Ret
     C                     MOVELWL0154    OMH1ST    P      Order Line Erro
     C                     Z-ADDWL0155    OMTKDT           OD Market Begin
     C                     Z-ADDWL0156    OMTLDT           OD Market Endin
     C                     Z-ADDWL0157    OMTMDT           OD Atch to Ord
     C                     MOVELWL0158    OMUVST    P      EDI Status 1
     C                     MOVELWL0159    OMUWST    P      EDI Status 2
     C                     MOVELWL0160    OMUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL*BLANK    OMRPCD           Age Code
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR TVRVGN
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELOMAJCD    WL0161    P      Warehouse Code
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0162    OMF6SX    P      Production Ware
     C                     Z-ADDWL0163    YN0262           Accounting Comp
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                     EXSR UPSUBR                     Calc Gross Weig
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSTV     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZRINB    OMRINB           Item Structure
     C                     Z-ADDBZRHNB    OMRHNB           Item Structure
     C                     Z-ADDBZRGNB    OMRGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0161    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSTW     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0162           Production Ware
     C                     Z-ADD*ZERO     WL0163           Accounting Comp
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAOCD    WL0162           Production Ware
     C                     Z-ADDWHBTC3    WL0163           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * RTV Substitutions      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUPRST           Substitution Fl
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQTX01           Company Number
     C           *LIKE     DEFN WLC4NB    WQTX02           Order Number
     C           *LIKE     DEFN WLDPNB    WQTX03           Order Sequence
      * Define keylist
     C           KPSTX     KLIST
     C                     KFLD           WQTX01           Company Number
     C                     KFLD           WQTX02           Order Number
     C                     KFLD           WQTX03           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           Company Number
     C                     KFLD           WQTX02           Order Number
     C                     KFLD           WQTX03           Order Sequence
      * Setup key
     C                     Z-ADD#1AIC3    WQTX01           Company Number
     C                     Z-ADD#1C4NB    WQTX02           Order Number
     C                     Z-ADD#1DPNB    WQTX03           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
      * Establish starting position
     C           KPSTX     SETLL@BGWKAE                    *
     C           KRSTX     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order Secondary Line Seq is GT 1
     C           WLUENB    IFGT 1                          *IF
     C                     MOVEL'Y'       WUPRST           Substitution Fl
     C                     GOTO TXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTX     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * CHG Substitution Flag  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0279  70       Item Code
     C                     MOVEL*BLANK    WN0280  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0281  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0282  70       Order Group Cod
     C                     MOVEL*BLANK    WN0283  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0284  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0285 112       Billing Detail
     C                     Z-ADD*ZERO     WN0286 112       Billing Detail
     C                     Z-ADD*ZERO     WN0287 112       Billing Detail
     C                     Z-ADD*ZERO     WN0288 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0289  1        Comment Print A
     C                     MOVEL*BLANK    WN0290  1        Comment Print I
     C                     MOVEL*BLANK    WN0291  1        Comment Print P
     C                     MOVEL*BLANK    WN0292  1        Comment Print S
     C                     Z-ADD*ZERO     WN0293 112       Extended Amount
     C                     Z-ADD*ZERO     WN0294  70       Market Pricing
     C                     MOVEL*BLANK    WN0295  3        Commodity Marke
     C                     MOVEL*BLANK    WN0296  3        Date Method Cod
     C                     MOVEL*BLANK    WN0297  3        Price Method Co
     C                     Z-ADD*ZERO     WN0298 114       Price Overage O
     C                     Z-ADD*ZERO     WN0299  70       Contract Number
     C                     MOVEL*BLANK    WN0300  1        Price Status
     C                     Z-ADD*ZERO     WN0301  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0302  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0303  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0304  1        Work Confirm St
     C                     MOVEL*BLANK    WN0305  1        Work Over_Short
     C                     MOVEL*BLANK    WN0306  1        OD Production P
     C                     MOVEL*BLANK    WN0307 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0308 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0309  1        Age Code
     C                     MOVEL*BLANK    WN0310  1        Palletize
     C                     MOVEL*BLANK    WN0311  1        Slip Sheet
     C                     MOVEL*BLANK    WN0312  1        Catch Weight St
     C                     MOVEL*BLANK    WN0313  1        Price Audit
     C                     MOVEL*BLANK    WN0314  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0315  1        Production Date
     C                     Z-ADD*ZERO     WN0316 112       Rated Freight
     C                     Z-ADD*ZERO     WN0317 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0318 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0319 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0320 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0321 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0322 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0323 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0324 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0325 114       Unit Price
     C                     Z-ADD*ZERO     WN0326 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0327 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0328 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0329 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0330  70       Requested Ship
     C                     Z-ADD*ZERO     WN0331  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0332  70       Actual Shipped
     C                     MOVEL*BLANK    WN0333  1        Affect Inventor
     C                     MOVEL*BLANK    WN0334  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0335  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0336  30       Item Structure
     C                     Z-ADD*ZERO     WN0337  30       Item Structure
     C                     Z-ADD*ZERO     WN0338  30       Item Structure
     C                     MOVEL*BLANK    WN0339  2        Item Level
     C                     MOVEL*BLANK    WN0340  2        Quality Level
     C                     MOVEL*BLANK    WN0341  2        Pricing Product
     C                     MOVEL*BLANK    WN0342  2        Season Product
     C                     Z-ADD*ZERO     WN0343  70       Date of Origina
     C                     MOVEL*BLANK    WN0344 10        User Profile Na
     C                     MOVEL*BLANK    WN0345  6        Country Code
     C                     MOVEL*BLANK    WN0346  2        Event Code
     C                     MOVEL*BLANK    WN0347  3        Reason Code
     C                     MOVEL*BLANK    WN0348  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0349  1        Modified Flag
     C                     MOVEL*BLANK    WN0350  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0351 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0352 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0353  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0354  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0355  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0356  1        Affect Commissi
     C                     MOVEL*BLANK    WN0357  1        Affect Pricing
     C                     MOVEL*BLANK    WN0358  1        Released by Use
     C                     MOVEL*BLANK    WN0359  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0360  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0361  3        Production Ware
     C                     MOVEL*BLANK    WN0362  3        OD Price Type
     C                     Z-ADD*ZERO     WN0363  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0364  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0365  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0366  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0367  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0368  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0369  60       Price Code
     C                     Z-ADD*ZERO     WN0370  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0371  60       Substitution Li
     C                     Z-ADD*ZERO     WN0372  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0373 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0374 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0375 112       OD Item Target
     C                     Z-ADD*ZERO     WN0376 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0377 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0378 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0379 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0380 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0381 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0382 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0383 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0384 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0385 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0386  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0387  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0388  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0389 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0390  40       Item Age Days
     C                     Z-ADD*ZERO     WN0391  70       Production Ovr
     C                     Z-ADD*ZERO     WN0392  70       Production Ovr
     C                     MOVEL*BLANK    WN0393  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0394  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0395  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0396  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0397  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0398  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0399  1        EDI Status 1
     C                     MOVEL*BLANK    WN0400  1        EDI Status 2
     C                     MOVEL*BLANK    WN0401  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0402  60       Job Time
     C                     MOVEL*BLANK    WN0403 10        User Id
     C                     MOVEL*BLANK    WN0404 10        Job Name
     C                     Z-ADD*ZERO     WN0405  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      *
     C           KLCHTY    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHTY    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#1Z3ST    OMZ3ST    P      Substituted Fla
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * CHG Sts,Alloc          CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0406  70       Item Code
     C                     MOVEL*BLANK    WN0407  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0408  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0409  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0410 112       Billing Detail
     C                     Z-ADD*ZERO     WN0411 112       Billing Detail
     C                     Z-ADD*ZERO     WN0412 112       Billing Detail
     C                     Z-ADD*ZERO     WN0413 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0414  1        Comment Print A
     C                     MOVEL*BLANK    WN0415  1        Comment Print I
     C                     MOVEL*BLANK    WN0416  1        Comment Print P
     C                     MOVEL*BLANK    WN0417  1        Comment Print S
     C                     Z-ADD*ZERO     WN0418 112       Extended Amount
     C                     Z-ADD*ZERO     WN0419  70       Market Pricing
     C                     MOVEL*BLANK    WN0420  3        Commodity Marke
     C                     MOVEL*BLANK    WN0421  3        Date Method Cod
     C                     MOVEL*BLANK    WN0422  3        Price Method Co
     C                     Z-ADD*ZERO     WN0423 114       Price Overage O
     C                     Z-ADD*ZERO     WN0424  70       Contract Number
     C                     MOVEL*BLANK    WN0425  1        Price Status
     C                     Z-ADD*ZERO     WN0426  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0427  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0428  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0429  1        Work Confirm St
     C                     MOVEL*BLANK    WN0430  1        Work Over_Short
     C                     MOVEL*BLANK    WN0431  1        OD Production P
     C                     MOVEL*BLANK    WN0432 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0433 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0434  1        Age Code
     C                     MOVEL*BLANK    WN0435  1        Palletize
     C                     MOVEL*BLANK    WN0436  1        Slip Sheet
     C                     MOVEL*BLANK    WN0437  1        Catch Weight St
     C                     MOVEL*BLANK    WN0438  1        Price Audit
     C                     MOVEL*BLANK    WN0439  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0440  1        Production Date
     C                     Z-ADD*ZERO     WN0441 112       Rated Freight
     C                     Z-ADD*ZERO     WN0442 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0443 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0444 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0445 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0446 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0447 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0448 114       Unit Price
     C                     Z-ADD*ZERO     WN0449 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0450 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0451 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0452 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0453  70       Requested Ship
     C                     Z-ADD*ZERO     WN0454  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0455  70       Actual Shipped
     C                     MOVEL*BLANK    WN0456  1        Affect Inventor
     C                     MOVEL*BLANK    WN0457  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0458  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0459  30       Item Structure
     C                     Z-ADD*ZERO     WN0460  30       Item Structure
     C                     Z-ADD*ZERO     WN0461  30       Item Structure
     C                     MOVEL*BLANK    WN0462  2        Item Level
     C                     MOVEL*BLANK    WN0463  2        Quality Level
     C                     MOVEL*BLANK    WN0464  2        Pricing Product
     C                     MOVEL*BLANK    WN0465  2        Season Product
     C                     Z-ADD*ZERO     WN0466  70       Date of Origina
     C                     MOVEL*BLANK    WN0467 10        User Profile Na
     C                     MOVEL*BLANK    WN0468  6        Country Code
     C                     MOVEL*BLANK    WN0469  2        Event Code
     C                     MOVEL*BLANK    WN0470  3        Reason Code
     C                     MOVEL*BLANK    WN0471  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0472  1        Modified Flag
     C                     MOVEL*BLANK    WN0473  1        Substituted Fla
     C                     MOVEL*BLANK    WN0474  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0475 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0476 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0477  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0478  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0479  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0480  1        Affect Commissi
     C                     MOVEL*BLANK    WN0481  1        Affect Pricing
     C                     MOVEL*BLANK    WN0482  1        Released by Use
     C                     MOVEL*BLANK    WN0483  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0484  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0485  3        Production Ware
     C                     MOVEL*BLANK    WN0486  3        OD Price Type
     C                     Z-ADD*ZERO     WN0487  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0488  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0489  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0490  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0491  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0492  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0493  60       Price Code
     C                     Z-ADD*ZERO     WN0494  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0495  60       Substitution Li
     C                     Z-ADD*ZERO     WN0496  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0497 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0498 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0499 112       OD Item Target
     C                     Z-ADD*ZERO     WN0500 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0501 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0502 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0503 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0504 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0505 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0506 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0507 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0508 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0509 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0510  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0511  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0512  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0513 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0514  40       Item Age Days
     C                     Z-ADD*ZERO     WN0515  70       Production Ovr
     C                     Z-ADD*ZERO     WN0516  70       Production Ovr
     C                     MOVEL*BLANK    WN0517  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0518  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0519  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0520  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0521  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0522  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0523  1        EDI Status 1
     C                     MOVEL*BLANK    WN0524  1        EDI Status 2
     C                     MOVEL*BLANK    WN0525  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0526  60       Job Time
     C                     MOVEL*BLANK    WN0527 10        User Id
     C                     MOVEL*BLANK    WN0528 10        Job Name
     C                     Z-ADD*ZERO     WN0529  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHTZ    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHTZ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YERDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#1GMST    OMGMST    P      Detail Line Sta
     C                     MOVEL#1GNST    OMGNST    P      Detail Line Sta
     C                     Z-ADD#1CCQT    OMCCQT           Quantity Schedu
     C                     Z-ADD#1AUWG    OMAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * E2640 Write chg log for cancel line item
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Detail Line Status is Cancelled
      *   |- c2    : PAR.Detail Line Status Last is Not cancelled
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GMST    IFEQ 'X'                        *IF
     C           #1GNST    IFEQ 'L'                        *IF
     C           #1GNST    OREQ 'A'
     C           #1GNST    OREQ 'C'
     C           #1GNST    OREQ 'R'
     C           #1GNST    OREQ 'E'
     C           #1GNST    OREQ 'H'
     C           #1GNST    OREQ 'I'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELOMDPNB    YL0075           Text 3 Length U
     C                     Z-ADDOMD0WG    YL0076           Weight Beg Inv
     C                     MOVELYL0076    YL0077           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0075    CAT  YL0077:ZQ YL0078    P      Change Log Prio
      * New value is -0- for cancel
     C                     Z-ADD0         YL0076           Weight Beg Inv
     C                     MOVEL*BLANK    YL0079           Change Log New
     C                     MOVELYL0076    YL0079           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0622  70       Load ID
     C                     PARM 'ORDWGT'  WQ0623  6        Load Change Typ
     C                     PARM 'SLS'     WQ0624  3        Department Cont
     C                     PARM YL0078    WQ0625 12        Change Log Prio
     C                     PARM YL0079    WQ0626 12        Change Log New
     C                     PARM OMAIC3    WQ0627  30       Company Number
     C                     PARM OMC4NB    WQ0628  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDOMAVQT    YL0076           Weight Beg Inv
     C                     MOVELYL0076    YL0077           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0075    CAT  YL0077:ZQ YL0078    P      Change Log Prio
      * New value is -0- for cancel
     C                     Z-ADD0         YL0076           Weight Beg Inv
     C                     MOVEL*BLANK    YL0079           Change Log New
     C                     MOVELYL0076    YL0079           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0629  70       Load ID
     C                     PARM 'ORDQTY'  WQ0630  6        Load Change Typ
     C                     PARM 'SLS'     WQ0631  3        Department Cont
     C                     PARM YL0078    WQ0632 12        Change Log Prio
     C                     PARM YL0079    WQ0633 12        Change Log New
     C                     PARM OMAIC3    WQ0634  30       Company Number
     C                     PARM OMC4NB    WQ0635  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Set display/hide attributes.
      *================================================================
      * Do not display SFLSEL for deleted lines
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       #RGGST           USR Display fie
     C                     END                             *FI
     C                     MOVEL'Y'       #RTIST           USR Display 1
      * If cancelled, chg mode, or priced & manual price audited=don't ch
      * CASE:
      *  - c1 OR c2 OR (c3 AND c4)
      *   |- c1    : RCD.Detail Line Status is Cancelled
      *   |- c2    : PGM.*Program mode is *CHANGE
      *   |- c3    : DB1.Price Status is Priced
      *   |- c4    : DB1.Price Audit is Manually Price Audited
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GMST    IFEQ 'X'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           OMU1ST    IFEQ 'P'                        *IF
     C           OMU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       #RTIST           USR Display 1
     C                     END                             *FI
     C                     MOVEL'Y'       #RTJST           USR Display 2
      * Priced & Audit Manually pricing fields will be output only
      * CASE:
      *  - c3 AND c4
      *   |- c3    : DB1.Price Status is Priced
      *   |- c4    : DB1.Price Audit is Manually Price Audited
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMU1ST    IFEQ 'P'                        *IF
     C           OMU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       #RTJST           USR Display 2
     C                     ELSE
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       #RTJST           USR Display 2
     C                     END                             *FI
     C                     END                             *FI
      * PK0519  10/20/03 RMC
     C                     MOVEL'Y'       #RASTS           USR Display 3
      * Control:  Price Override
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : RCD.Price Method Code is Deviated
      *   |- c2    : RCD.USR Display 2 is No
      *   |- c3    : WRK.Prc Ovr Output Only Usr is yes
      *   '-
     C           #1Q7CD    IFEQ 'DEV'                      *IF
     C           #RTJST    OREQ 'N'                        *OR
     C           WUYFSX    OREQ 'Y'                        *OR
     C                     MOVEL'N'       #RASTS           USR Display 3
     C                     END                             *FI
      * S00932  09/08/09 RMC
     C                     MOVEL'Y'       #RBSTS           USR Display 4
      * Control:  Price Code
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.Price Method Type is Not Contract
      *   |- c2    : RCD.Detail Line Status is Cancelled
      *   '-
     C           #RV8ST    IFEQ 'X'                        *IF
     C           #RV8ST    OREQ 'F'
     C           #RV8ST    OREQ 'M'
     C           #RV8ST    OREQ 'K'
     C           #1GMST    OREQ 'X'                        *OR
      * dont allow entry of price code until the mthd is DEViated
      *  this will force them to press enter before doing the F4 to selec
     C                     MOVEL'N'       #RBSTS           USR Display 4
     C                     END                             *FI
      * FP1309  04/07/10 SLM
     C                     MOVEL'Y'       #RGFSX           USR Display 5
      * Control:  AGE days
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Detail Line Status is Cancelled
      *   |- c2    : RCD.Override Age Dates StsUsr is Age Dates are Enter
      *   '-
     C           #1GMST    IFEQ 'X'                        *IF
     C           #RI0ST    OREQ 'O'                        *OR
      * if line is cancelled do not have age days open
      * IF user has the PRODUCTION FROM dates entered then do not allow
      * age dates to be entered.
     C                     MOVEL'N'       #RGFSX           USR Display 5
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Establish Screen Fields or clear them
      *================================================================
     C                     MOVEL'U'       #1U1ST           Price Status
     C                     Z-ADD##JDT     #1CXDT           Date of Origina
     C                     MOVEL*BLANK    P7R4ST           USR Update Flag
     C                     MOVEL'N'       #RGGST           USR Display fie
     C                     MOVEL'N'       #RBSTS           USR Display 4
     C                     MOVELP1JPCD    #1JPCD           Event Code
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD1         #1UENB           Order Secondary
     C                     MOVEL'Y'       #1F0SX           Affect Trade Fu
     C                     MOVEL'Y'       #1F1SX           Affect Commissi
     C                     MOVEL'Y'       #1F2SX           Affect Pricing
     C                     MOVELWUGSTX    #1VEST           Palletize
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P9YJSX    IFEQ 'H'                        *IF
     C                     MOVEL'N'       #1VEST           Palletize
     C                     END                             *FI
     C                     MOVELWUGSTX    #1VGST           Slip Sheet
     C                     MOVELWUGSTX    #1RPCD           Age Code
      * fp1309 add 3 new fields
     C                     Z-ADD*ZERO     #1RINY           Item Age Days
     C                     Z-ADD*ZERO     #1TIDT           Production Ovr
     C                     Z-ADD*ZERO     #1TJDT           Production Ovr
     C                     MOVEL*BLANK    #1LQCD           Commodity Marke
     C                     MOVEL*BLANK    #1F7SX           OD Price Type
     C                     Z-ADD0         #1NWDT           OD Price Type R
     C                     MOVEL*BLANK    #1F5SX           OD Pallet Type
     C                     MOVEL*BLANK    #RQRU1           Pallet Type NOR
     C                     MOVEL*BLANK    #1Q7CD           Price Method Co
     C                     MOVEL*BLANK    #1RDCD           Date Method Cod
      * 01/13/21 DN R17029-Get/Default OD Spot Buy from OHE File.
      * CASE: *OTHERWISE
      * Rtv OHE Spot Buy      XF - Order Header Extension  * 
     C                     CALL 'PUSFXFR'              90  Rtv OHE Spot Bu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0194  30       Company Number
     C                     PARM #1C4NB    WQ0195  70       Order Number
     C           YL0028    PARM *BLANK    WQ0196  4        OHE Spot Buy
     C                     PARM P9YJSX    WQ0197  1        Company Organiz
     C           #1H2ST    PARM *BLANK    WQ0198  1        OD Spot Buy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUSFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9849  *
     C                     END
      * Get customer default pallet type  10/11/22 WI 464
      * Rtv Pallet Type/Desc  XF - Customer EXT2  * 
     C                     CALL 'PUTPXFR'              90  Rtv Pallet Type
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0199  70       Ship To Custome
     C           YL0029    PARM *BLANK    WQ0200  2        PM Pallet Type
     C                     PARM *BLANK    WQ0201 15        PM Description
     C                     PARM *BLANK    WQ0202  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * 3-23-23 chg output parm to lcl.pm pallet type from par.od pallet
      *  it was overlaying the order dtl pallet type from line 1
      * CASE: PAR.OD Pallet Type is Blank
     C           P5F5SX    IFEQ *BLANK                     *IF
      * CASE: LCL.PM Pallet Type is Not Blank
     C           YL0029    IFEQ 'HT'                       *IF
     C           YL0029    OREQ '01'
     C           YL0029    OREQ '02'
     C                     MOVELYL0029    P5F5SX           OD Pallet Type
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Add Ham Group.
      *================================================================
      * Add Ham Group.
      * CASE: CTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
      * PMT Enter Ham Group    PV - Ham Group  * 
     C                     CLEARPDRC
     C                     Z-ADD#2AIC3    PDAIC3           Company Number
     C                     Z-ADD#2C4NB    PDC4NB           Order Number
     C                     Z-ADDWUDPNB    PDDPNB           Order Sequence
     C                     MOVELP5AJCD    PDAJCD    P      Warehouse Code
     C                     Z-ADD#PBKC7    PDBKC7           Ship To Custome
     C                     MOVELP5KXCD    PDKXCD    P      Country Code
      *
     C                     CALL 'PDVXPVR'              90  PMT Enter Ham G
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Order Deta
     C           WUACSX    PARM *BLANK    WQ0208  1        Successful Comp
      *
     C                     Z-ADDPDDPNB    WUDPNB           Order Sequence
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVXPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Successful Completion USR is Yes
     C           WUACSX    IFEQ 'Y'                        *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       P7GGST           USR Display fie
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Add Mode Defaults.
      *================================================================
     C                     MOVEL'E'       #1GMST           Detail Line Sta
     C                     MOVEL'01'      #1JPCD           Event Code
      * Set Secondary Seq #
      * CASE: RCD.Order Secondary Line Seq is ZERO
     C           #1UENB    IFEQ *ZERO                      *IF
     C                     Z-ADD1         #1UENB           Order Secondary
     C                     END                             *FI
      * Fill Palletize
      * CASE: RCD.Palletize EQ WRK.BLANK
     C           #1VEST    IFEQ WUGSTX                     *IF
     C                     MOVELP1VEST    #1VEST           Palletize
     C                     END                             *FI
      * Fill Slip Sheet
      * CASE: RCD.Slip Sheet EQ WRK.BLANK
     C           #1VGST    IFEQ WUGSTX                     *IF
     C                     MOVELP1VGST    #1VGST           Slip Sheet
     C                     END                             *FI
      * Set Price Method Code based on Type code
      * CASE: WRK.Type Code is Inter Company
     C           WUBOCD    IFEQ 'IC'                       *IF
     C                     MOVEL'MAN'     #1Q7CD           Price Method Co
     C                     MOVEL'N'       YL0035           Status Flag 4
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Price Method Code is Blank
     C           #1Q7CD    IFEQ *BLANK                     *IF
      * RTV Dsc,U/M,PrcInf,Str RT - Company Item  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     END                             *FI
      * 02/04/2010 PKD Commented out.
      * Rtv prod plan sts. Default to No if Live w/TPM           E004019
      * Bypass Company Item Ext for PORKSCHE5
      * CASE: LCL.User Code Model is Production Sched 5
     C           YL0011    IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Plan Prod Sts All XF - Company Item Ext  * 
     C                     CALL 'PVBLXFR'              90  Rtv Plan Prod S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0294  30       Company Number
     C                     PARM #1HGCD    WQ0295  70       Item Code
     C                     PARM *BLANK    WQ0296  1        Produce on Sund
     C                     PARM *BLANK    WQ0297  1        Produce on Mond
     C                     PARM *BLANK    WQ0298  1        Produce on Tues
     C                     PARM *BLANK    WQ0299  1        Produce on Wedn
     C                     PARM *BLANK    WQ0300  1        Produce on Thur
     C                     PARM *BLANK    WQ0301  1        Produce on Frid
     C                     PARM *BLANK    WQ0302  1        Produce on Satu
     C           YL0012    PARM *BLANK    WQ0303  1        Plan Production
     C                     PARM *BLANK    WQ0304  1        Allocation Meth
     C                     PARM *BLANK    WQ0305  1        Adjust Credit P
     C                     PARM *BLANK    WQ0306  2        CIE Use Age Day
     C                     PARM *BLANK    WQ0307  2        CIE MPR Report
     C                     PARM *ZERO     WQ0308 112       CIE Unused Numb
     C                     PARM *ZERO     WQ0309 110       CIE Unused Numb
     C                     PARM *ZERO     WQ0310  70       CIE Unused Date
     C                     PARM *BLANK    WQ0311 25        CIE TPM Equipme
     C                     PARM *BLANK    WQ0312  6        CIE Capacity Co
     C                     PARM *BLANK    WQ0313  1        Record Status
     C           YL0013    PARM *BLANK    WQ0314  1        USR Return Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * Override from table
      * CASE: LCL.USR Return Code is Exists
     C           YL0013    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       #ROWSC           OD Production P
      * CASE: LCL.OD Production Plan Sts is No
     C           YL0012    IFEQ 'N'                        *IF
     C                     MOVELYL0012    #ROWSC           OD Production P
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Make default as Yes it not No
      * CASE: RCD.OD Production Plan St USR is No
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #ROWSC           OD Production P
     C                     MOVEL'Y'       #ROXSC           Plan Production
     C                     END                             *FI
      * Validate Prod plan
      * CASE: RCD.OD Production Plan St USR is Valid values
     C           #ROWSC    IFEQ 'N'                        *IF
     C           #ROWSC    OREQ 'Y'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#ROWSC    ZA0010           OD Production P
      * Send message 'Value must be Y/N'
     C                     MOVEL'USR5334' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9847  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      * Sales is Transfer Order
      * CASE: PAR.Order Type - Sales is Transfer Order
     C           P1JNCD    IFEQ 'TR'                       *IF
     C                     MOVEL'N'       #ROWSC           OD Production P
     C                     MOVEL'N'       #ROXSC           Plan Production
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Not a delete request continue validations.
      *================================================================
      * 11/04/09 PKD E00519 Warehouse and Item Access by User
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0319 10        User Profile Na
     C                     PARM 'O/P'     WQ0320  6        Application Cod
     C                     PARM P5AJCD    WQ0321  3        Warehouse Code
     C                     PARM #1HGCD    WQ0322  70       Item Code
     C           YL0037    PARM *BLANK    WQ0323  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * VAL: Warehouse/Item Access
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0037    IFEQ 'D'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0015           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0015           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL##USR     ZA0016           *USER
      * Send message 'Access Denied: Item'
     C                     MOVEL'USR4202' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     GOTO UEEXIT                     *QUIT
     C                     END                             *FI
      * Validate entered fields and load data to output record
      * Fields from Item Master Checking
      * RTV for Ord.Detail     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDC3XFR'              90  RTV for Ord.Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0324  30       Company Number
     C                     PARM #1HGCD    WQ0325  70       Item Code
     C           YL0038    PARM *BLANK    WQ0326 30        Description Lin
     C           #1G8NA    PARM *BLANK    WQ0327 30        Description Lin
     C           #1AGCD    PARM *BLANK    WQ0328  2        UOM Primary
     C           #1CRCD    PARM *BLANK    WQ0329  2        UOM Pricing
     C           #1AVWG    PARM *ZERO     WQ0330 112       Unit Weight
     C           #1RBCD    PARM *BLANK    WQ0331  2        Item Level
     C           #1FZST    PARM *BLANK    WQ0332  1        Production Date
     C           #1AVST    PARM *BLANK    WQ0333  1        Catch Weight St
     C           #1RINB    PARM *ZERO     WQ0334  30       Item Structure
     C           #1RHNB    PARM *ZERO     WQ0335  30       Item Structure
     C           #1RGNB    PARM *ZERO     WQ0336  30       Item Structure
     C           WULNCD    PARM *BLANK    WQ0337  3        Default Commod
     C           WUTFNB    PARM *ZERO     WQ0338  30       Transportation
     C           WUN0CD    PARM *BLANK    WQ0339  3        Item Type Code
     C           WULRCD    PARM *BLANK    WQ0340  7        Commodity Price
     C           WUAJCD    PARM *BLANK    WQ0341  3        Default Warehou
     C           WUQ7CD    PARM *BLANK    WQ0342  3        Price Method De
     C           WUCHTM    PARM *ZERO     WQ0343  52       Fresh Chilling
     C           WUXWST    PARM *BLANK    WQ0344  1        Variety_Rendere
     C           #1H7NX    PARM *ZERO     WQ0345 112       Item Target Pri
     C           WUECST    PARM *BLANK    WQ0346  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDC3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * Exc Priml Grp/Sold100 XF - Company Item  * 
     C                     CALL 'PBP9XFR'              90  Exc Priml Grp/S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0347  30       Company Number
     C                     PARM #1HGCD    WQ0348  70       Item Code
     C           YL0039    PARM *BLANK    WQ0349  6        Primal Group Co
     C           YL0040    PARM *BLANK    WQ0350  1        Sold 100 Percen
     C           YL0041    PARM *BLANK    WQ0351  1        Allocation Meth
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * CASE: LCL.Primal Group Code is NE Samples or Cut Loss
     C           YL0039    IFNE 'UNID'                     *IF
     C                     MOVELYL0038    #1G7NA           Order Desc_Line
     C                     END                             *FI
      * CASE: RCD.Ord TF Exempt Code is Pre Commencement
     C           #1F4SX    IFEQ 'PC'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Def/TFExp/CO RT - Item Default  * 
     C                     EXSR STRVGN
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0127 155       System Value Nu
      *
      * Rtv Whs Typ/FZNCHLTME IF
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SURVGN
      * CASE: PAR.Warehouse Type is Frozen
     C           WUWPST    IFEQ 'FZ'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SVRVGN
     C                     Z-ADDWN0127    WUCHTM           Fresh Chilling
     C                     END                             *FI
      * Item Not found
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           WUAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELWUAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0017           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0017           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0018           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0018           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
      * Default Warehouse
      * CASE: PAR.Allow Mult Whse to Order is yes
     C           P9HSST    IFEQ 'Y'                        *IF
      * Warehouse code from Item master
      * CASE: RCD.Warehouse Code is Warehouse Code Blank
     C           #1AJCD    IFEQ *BLANK                     *IF
     C                     MOVELWUAJCD    #1AJCD           Warehouse Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Warehouse Code EQ WRK.BLANK
     C           #1AJCD    IFEQ WUGSTX                     *IF
     C                     MOVELP5AJCD    #1AJCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
      * Default Fresh or Frozen Days from CTL ONLY in *add mode
      * CASE: RCD.Production Ovr AgeDte Fr is not entered
     C           #1TIDT    IFEQ *ZERO                      *IF
      * CASE: RCD.Item Age Days is Not Entered
     C           #1RINY    IFEQ *ZERO                      *IF
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * CASE: WRK.Warehouse Type is Fresh
     C           WUWPST    IFEQ 'FR'                       *IF
     C                     Z-ADD#CRJNY    #1RINY           Item Age Days
     C                     ELSE
      * CASE: WRK.Warehouse Type is Frozen
     C           WUWPST    IFEQ 'FZ'                       *IF
     C                     Z-ADD#CRKNY    #1RINY           Item Age Days
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val ItmBal.Unit Cst    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDMCXFR'              90  Val ItmBal.Unit
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0352  30       Company Number
     C                     PARM #1HGCD    WQ0353  70       Item Code
     C                     PARM #1AJCD    WQ0354  3        Warehouse Code
     C           WUAGCS    PARM *ZERO     WQ0355 114       Unit Cost Per P
     C           WUECST    PARM *BLANK    WQ0356  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * Error if no item balance or 0 unit cost
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0019           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0019           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0020           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0020           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0021           Warehouse Code
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    WUECST           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           P9YJSX    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           #2EIDT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           #1AODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0023
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HGCD    WQ0357  70       Item Code
     C                     PARM #1AJCD    WQ0358  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0359  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0360 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0361 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0362 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0363 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0364 30        Error Reason De
     C                     PARM #1AIC3    WQ0365  30       Company Number
     C                     PARM #1AODT    WQ0366  70       Scheduled Ship
     C                     PARM #2EIDT    WQ0367  70       Requested Deliv
     C                     PARM #1RINY    WQ0368  40       Item Age Days
     C                     PARM #1TIDT    WQ0369  70       Production Ovr
     C                     PARM #1TJDT    WQ0370  70       Production Ovr
     C           YL0042    PARM YL0042    WQ0371  70       Production AgeD
     C           YL0043    PARM YL0043    WQ0372  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983341*
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'V'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0042    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0024
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#1RINY    ZA0025           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  #1TIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0026
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  #1TJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0027
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#1RINY    ZA0028           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  #1TIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0029
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  #1TJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0030
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#1RINY    ZA0031           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  #1TIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0032
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  #1TJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0033
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#1RINY    ZA0034           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  #1TIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0035
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  #1TJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0036
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           #1TIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1RINY    ZA0037           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0042    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0038
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  YL0043    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0039
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Palletize is required.
      * CASE: RCD.Palletize is blank
     C           #1VEST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1VEST    ZA0040           Palletize
      * Send message 'Value Required (alpha)'
     C                     MOVEL'USR2808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      * Slip Sheet is required.
      * CASE: RCD.Slip Sheet is blank
     C           #1VGST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1VGST    ZA0041           Slip Sheet
      * Send message 'Value Required (alpha)'
     C                     MOVEL'USR2808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      * Item must be FG
      * CASE: WRK.Item Type Code is Not Finished Good
     C           WUN0CD    IFNE 'FG'                       *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0042           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0042           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item must be Finished Gd'
     C                     MOVEL'USR1941' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      * R7574 10.18.16 RMC Dont allow FZ items on FR Warehouses
      * CASE: PAR.Company Organization is Seaboard
     C           P9YJSX    IFEQ 'S'                        *IF
      * Item must be sold FR or FZ like the warehouse type    RMC 11/24/1
      * CASE: WRK.Warehouse Type is Frozen
     C           WUWPST    IFEQ 'FZ'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Sold 100% Frozen is yes
     C           YL0040    IFEQ 'Y'                        *IF
     C                     MOVEL'FZ'      WUR6ST           Warehouse Type
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0043           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0043           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWUR6ST    ZA0044           Warehouse Type
     C                     MOVELWUWPST    ZA0045           Warehouse Type
      * Send message 'Item must be sold fr/fz'
     C                     MOVEL'USR4776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate TO Whse's Item Balance (Transfers only)
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P1OBST    IFEQ '4'                        *IF
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SWRVGN
      * Val ItmBal.Unit Cst    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDMCXFR'              90  Val ItmBal.Unit
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0044    WQ0373  30       Company Number
     C                     PARM #1HGCD    WQ0374  70       Item Code
     C                     PARM WUIWCD    WQ0375  3        Warehouse Code
     C           WUAGCS    PARM *ZERO     WQ0376 114       Unit Cost Per P
     C           WUECST    PARM *BLANK    WQ0377  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * Error if no item balance
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0046           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0046           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0047           Warehouse Code
      * Send message 'To Item Balance not found'
     C                     MOVEL'USR2340' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: WRK.Unit Cost Per Pound EQ WRK.ZERO
     C           WUAGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0048           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0048           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWUIWCD    ZA0049           Warehouse Code
      * Send message 'Unit Cost cannot be 0'
     C                     MOVEL'USR2343' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Regular order type and Bulk item
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Load Type is Regular
      *   |- c2    : WRK.Variety/Rendered/Cut is Rendered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1VDST    IFEQ 'R'                        *IF
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0050           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0050           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Bulk items can not be on'
     C                     MOVEL'USR1881' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
      * Bulk Load type and non-bulk item
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Load Type is Bulk
      *   |- c2    : WRK.Variety/Rendered/Cut is Not Bulk Item
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1VDST    IFEQ 'B'                        *IF
     C           WUXWST    IFEQ 'C'                        *IF
     C           WUXWST    OREQ *BLANK
     C           WUXWST    OREQ 'V'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0051           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0051           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Only bulk items can be on'
     C                     MOVEL'USR1882' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
      * Validate Ham Group.
     C                     EXSR UFSUBR                     Validate Ham Gr
     C                     MOVELP5KXCD    #1KXCD           Country Code
      * 04/30/2018 DN R12926-At Order level, use Absorbed Freight Rate fr
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
     C                     EXSR TBRVGN
      * Val Manual Price      RT - Company Item  * 
     C                     EXSR TCRVGN
      * Edt OD Pricing Validt IF
     C                     Z-ADD*ZERO     #1ALPR           Unit Price_Cred
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                     CALL 'PNS7XFR'              90  RTV PrcMthTyp/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0378  30       Company Number
     C                     PARM #1Q7CD    WQ0379  3        Price Method Co
     C           YL0053    PARM *BLANK    WQ0380  1        Price Method Ty
     C           YL0054    PARM *BLANK    WQ0381  1        PMH Price Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9835  *
     C                     END
      * Rtv Market Dtls OrEnt XF - IP Item Market Details  * 
     C                     CLEARPERC
     C                     Z-ADD#1HGCD    PEHGCD           Item Code
     C                     MOVEL#1LQCD    PELQCD    P      Commodity Marke
      *
     C                     CALL 'PNS1XFR'              90  Rtv Market Dtls
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: IP Item Ma
     C           YL0055    PARM *BLANK    WQ0382  7        Commodity Price
     C           YL0056    PARM *ZERO     WQ0383  94       Market Prem/Ded
     C           YL0057    PARM *BLANK    WQ0384  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983339*
     C                     END
     C                     MOVEL'N'       #RBSTS           USR Display 4
      * LCL.Commodity Price Group & LCL.Market Overage
      * CASE: LCL.Record Found USR is Record Found
     C           YL0057    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0056    YL0058           Market Overage
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0051    YL0055           Commodity Price
     C                     Z-ADDYL0049    YL0058           Market Overage
     C                     END                             *FI
      * VAL: Price Method Code
      * CASE: PAR.Price Method Code is Blank
     C           #1Q7CD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1Q7CD    ZA0056           Price Method Co
      * Send message 'Value Required (alpha)'
     C                     MOVEL'USR2808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
      * VAL: Price Code
      * CASE: PAR.Price Code is Entered
     C           #1BVTM    IFGT 0                          *IF
      * VAL: Price Code
      * CASE: LCL.Price Method Type is Not Contract
     C           YL0053    IFEQ 'X'                        *IF
     C           YL0053    OREQ 'F'
     C           YL0053    OREQ 'M'
     C           YL0053    OREQ 'K'
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0057           Price Code
     C                     MOVEL#1Q7CD    ZA0058           Price Method Co
      * Send message 'Price Code Inv for Mthd'
     C                     MOVEL'USR4338' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983735*
      *
      * CASE: PAR.USR Display 4 is No
     C           #RBSTS    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       #RBSTS           USR Display 4
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Cust Prc Str/End  XF - Customer Price Header  * 
     C                     CALL 'PNTAXFR'              90  Rtv Cust Prc St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0385  70       Ship To Custome
     C                     PARM #1BVTM    WQ0386  60       Price Code
     C           YL0059    PARM *ZERO     WQ0387  70       Price Start Dat
     C           YL0060    PARM *ZERO     WQ0388  70       Price End Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9837  *
     C                     END
      * CASE: LCL.Price Start Date is Not Entered
     C           YL0059    IFEQ 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0059           Price Code
      * Send message 'Price Code not val f/cust'
     C                     MOVEL'USR3318' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL: Contract Start & End Date
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Scheduled Ship Date LT LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date GT LCL.Price End Date
      *   '-
     C           #1AODT    IFLT YL0059                     *IF
     C           #1AODT    ORGT YL0060                     *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0060           Price Code
      * Send message 'Price Code not val dt rng'
     C                     MOVEL'USR3317' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     END                             *FI
      * Rtv Max Wt and price  XF - Customer Price Detail  * 
     C                     CALL 'PNTBXFR'              90  Rtv Max Wt and
     C                     PARM *BLANK    W0RTN   7
     C           W0RTN     PARM *BLANK    WQ0389  7        *Return code
     C                     PARM #1BKC7    WQ0390  70       Ship To Custome
     C                     PARM #1BVTM    WQ0391  60       Price Code
     C                     PARM #1HGCD    WQ0392  70       Item Code
     C           YL0061    PARM *ZERO     WQ0393 112       Maximum Contrac
     C           YL0062    PARM *ZERO     WQ0394 114       Customer Price_
     C           YL0063    PARM *BLANK    WQ0395  3        Commodity Marke
     C           YL0064    PARM *BLANK    WQ0396  3        Price Method Co
     C           YL0065    PARM *BLANK    WQ0397  3        Date Method Cod
     C           YL0066    PARM *BLANK    WQ0398  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983733*
     C                     END
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0061           Price Code
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0062           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0062           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code not val f/item'
     C                     MOVEL'USR3319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983733*
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Sum weights shipped/ordered for ship to /price code
      *
     C                     Z-ADD*ZERO     WN0128 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0129 112       Total Quantity
     C                     Z-ADD*ZERO     WN0130 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0131 114       Customer Price_
     C                     MOVEL*BLANK    WN0132  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       WUECST           Error Status
     C           #1AVQT    MULT #1AVWG    YL0015           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1BKC7    PABKC7           Ship To Custome
     C                     Z-ADD#1BVTM    PABVTM           Price Code
     C                     Z-ADD#1HGCD    PAHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C           WN0128    PARM WN0128    WQ0399 112       Total Weight Or
     C                     PARM #1C4NB    WQ0400  70       Order Number
     C           WN0129    PARM WN0129    WQ0401 112       Total Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983733*
     C                     END
     C                     ADD  YL0015    WN0128           Total Weight Or
     C                     ADD  #1AVQT    WN0129           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0402  70       Ship To Custome
     C                     PARM #1BVTM    WQ0403  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0404  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0405  70       Price End Date
     C                     PARM #1HGCD    WQ0406  70       Item Code
     C           WN0130    PARM *ZERO     WQ0407 112       Maximum Contrac
     C           WN0131    PARM *ZERO     WQ0408 114       Customer Price_
     C           #1LQCD    PARM *BLANK    WQ0409  3        Commodity Marke
     C           YL0016    PARM *BLANK    WQ0410  3        Price Method Co
     C           #1RDCD    PARM *BLANK    WQ0411  3        Date Method Cod
     C           WN0132    PARM *BLANK    WQ0412  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983733*
     C                     SETON                     3936  *
     C                     END
     C                     MOVELYL0016    #1Q7CD           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0010           Company Number
     C                     MOVELYL0016    WL0011    P      Price Method Co
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    YL0053    P      Price Method Ty
     C                     MOVELWL0013    YL0054    P      PMH Price Type
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0132    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0128    IFGT WN0130                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0128    SUB  WN0130    YL0017           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0063           Price Code
     C                     Z-ADDYL0017    ZA0064           Weight Allocate
     C                     Z-ADDWN0130    ZA0065           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0066           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0066           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983733*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0129    IFGT WN0130                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0129    SUB  WN0130    YL0017           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0067           Price Code
     C                     Z-ADDYL0017    ZA0068           Weight Allocate
     C                     Z-ADDWN0130    ZA0069           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0070           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0070           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983733*
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     Z-ADDWN0131    #1BZPR           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0054    IFEQ 'I'                        *IF
     C                     Z-ADDWN0131    #1BZPR           Price Overage O
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0054    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     Z-ADDWN0131    #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL: Price Code Required
      * CASE: LCL.Price Method Type is Contract Pricing
     C           YL0053    IFEQ 'Q'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1Q7CD    ZA0071           Price Method Co
     C                     Z-ADD#1BVTM    ZA0072           Price Code
      * Send message 'Price code req for mthd'
     C                     MOVEL'USR3316' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983537*
      *
      * CASE: PAR.USR Display 4 is No
     C           #RBSTS    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       #RBSTS           USR Display 4
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Market Price Date/Range
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0073
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0074
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0075
      * Send message 'Market Date/Range ERR'
     C                     MOVEL'USR4331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     ELSE
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C           #1TKDT    IFGT #1TLDT                     *IF
      * CASE: PAR.OD Market Ending Date is not entered
     C           #1TLDT    IFEQ 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0076
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0077
      * Send message 'Date Range Invalid'
     C                     MOVEL'USR4332' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Published
      * CASE: LCL.Price Method Type is Published Pricing
     C           YL0053    IFEQ 'P'                        *IF
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #1BZPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0078           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     MOVEL'SBD'     #1LQCD           Commodity Marke
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #1RDCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0079           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0080           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c2 OR c3
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0081
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0082
     C                     MOVEL#1Q7CD    ZA0083           Price Method Co
      * Send message 'Prc Date Range Inv'
     C                     MOVEL'USR4344' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Manual/Extended
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c3    : LCL.Price Method Type is Extended Pricing
      *   '-
     C           YL0053    IFEQ 'M'                        *IF
     C           YL0053    OREQ 'X'                        *OR
      * VAL: Price Overage Override for Price Method Type=Extended
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override is Equal zero
      *   |- c2    : LCL.Price Method Type is Extended Pricing
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZPR    IFEQ 0                          *IF
     C           YL0053    IFEQ 'X'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0084           Price Overage O
      * Send message 'Price Override Required'
     C                     MOVEL'USR1805' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Entered
     C           #1LQCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0085           Commodity Marke
      * Send message 'Market Code not allowed'
     C                     MOVEL'USR1809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #1RDCD    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0086           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0087           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #1EXDT    IFNE 0                          *IF
     C           #1TKDT    ORNE 0                          *OR
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0088
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0089
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0090
     C                     MOVEL#1Q7CD    ZA0091           Price Method Co
      * Send message 'Prc Dts = 0 f/Prc Mth'
     C                     MOVEL'USR4339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983835*
      *
     C                     END                             *FI
      * VAL: Manual Pricing
      * CASE: LCL.Price Method Type is Manual Pricing
     C           YL0053    IFEQ 'M'                        *IF
      * VAL: Manual Price Range
      * CASE: PAR.Billing Activity Type is Not Warehouse Transfer
     C           P1OBST    IFEQ '2'                        *IF
     C           P1OBST    OREQ '3'
     C           P1OBST    OREQ '1'
      * CASE: PAR.Primal Group Code is NE Samples or Cut Loss
     C           YL0039    IFNE 'UNID'                     *IF
      * RMC S14013 remove chk for type n= Promo/Samples- we want them val
      *
     C                     Z-ADD*ZERO     WN0133  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0134  52       CoPk_FdSrv ManP
     C                     Z-ADD*ZERO     WN0135  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0136 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     YL0067           Projected Marke
     C                     Z-ADD*ZERO     YL0069           Minimum Price
     C                     Z-ADD*ZERO     YL0070           Maximum Price
     C                     MOVEL'Y'       YL0068           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
     C                     EXSR TDRVGN
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           YL0048    IFEQ 'FSV'                      *IF
     C           YL0048    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0134    WN0133           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LQCD    WL0018    P      Commodity Marke
     C                     MOVELYL0055    WL0019    P      Commodity Price
     C                     Z-ADD9999999   WL0020           Market Price Da
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0021    YL0067           Commodity Marke
     C                     Z-ADDWL0022    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0067    ADD  YL0058    W0WB01           *Synon (15,5) w
     C           YL0001    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0067           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0133    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0067    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0069           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0133    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0067    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0070           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZPR    IFGE YL0069                     *IF
     C           #1BZPR    IFLE YL0070                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0068           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0048    WL0018    P      Commodity Marke
     C                     MOVELYL0055    WL0019    P      Commodity Price
     C                     Z-ADD9999999   WL0020           Market Price Da
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0021    YL0067           Commodity Marke
     C                     Z-ADDWL0022    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0133    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0067    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0069           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0133    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0067    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0070           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZPR    IFGE YL0069                     *IF
     C           #1BZPR    IFLE YL0070                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0068           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0067           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0067    #1ALPR           Unit Price_Cred
     C                     END                             *FI
      * CASE: LCL.Error Status  3 is Yes
     C           YL0068    IFEQ 'Y'                        *IF
      * CASE: LCL.Projected Market Price is Not Zeros
     C           YL0067    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0092           Price Overage O
      * Send message 'Manual price within Prcnt'
     C                     MOVEL'USR2351' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0093           Price Overage O
     C                     MOVEL#1LQCD    ZA0094           Commodity Marke
     C                     MOVELYL0051    ZA0095           Commodity Price
      * Send message 'No Mkt Prc Found for test'
     C                     MOVEL'USR2353' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983439*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Contract
      * CASE: LCL.Price Method Type is Contract Pricing
     C           YL0053    IFEQ 'Q'                        *IF
      * VAL: Commodity Market Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Commodity Market Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1LQCD    IFNE *BLANK                     *IF
     C           YL0054    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0096           Commodity Marke
      * Send message 'Market Code not allowed'
     C                     MOVEL'USR1809' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFNE *BLANK                     *IF
     C           YL0054    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0097           Date Method Cod
      * Send message 'Date Meth Code not allow'
     C                     MOVEL'USR1808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * VAL: Ceiling Price
      * CASE: LCL.PMH Price Type is Invoice Price
     C           YL0054    IFEQ 'I'                        *IF
      * ERR: Ceiling Price not allowed
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C           #1DWPR    IFNE 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0098           OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                     MOVEL'USR4333' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ERR: Ceiling Price Required
      * CASE: PAR.OD Ceiling Price is Equal zero
     C           #1DWPR    IFEQ 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1DWPR    ZA0099           OD Ceiling Pric
      * Send message 'Ceiling Price Required'
     C                     MOVEL'USR4340' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     Z-ADD#1DWPR    #1ALPR           Unit Price_Cred
     C                     END                             *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C           #1EXDT    IFNE 0                          *IF
     C           #1TKDT    ORNE 0                          *OR
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0100
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0101
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0102
     C                     MOVEL#1Q7CD    ZA0103           Price Method Co
      * Send message 'Prc Dts = 0 f/Prc Mth'
     C                     MOVEL'USR4339' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983835*
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Method Type = Market/Formula
      * CASE: LCL.Price Method Type is Market or Formula
     C           YL0053    IFEQ 'F'                        *IF
     C           YL0053    OREQ 'K'
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #1BZPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BZPR    ZA0104           Price Overage O
      * Send message 'Price Override not allow'
     C                     MOVEL'USR1807' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Not Entered
     C           #1LQCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0105           Commodity Marke
      * Send message 'Market Code must be enter'
     C                     MOVEL'USR1750' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C           #1RDCD    IFNE *BLANK                     *IF
      * VAL Date Method Exists RT - Market Date Method  * 
     C                     EXSR TFRVGN
      * ERR: Date Method Code Invalid
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0106           Date Method Cod
      * Send message 'Market Date Method Inval.'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ERR: Date Method Entered & Market Price Date/Range Entered
      * CASE:
      *  - (c1 AND c2) OR (c1 AND c3 AND c4)
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   |- c3    : PAR.OD Market Begin Date is Entered
      *   |- c4    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFNE *BLANK                     *IF
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1RDCD    IFNE *BLANK                     *IF
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0107
     C                     MOVEL#1RDCD    ZA0108           Date Method Cod
      * Send message 'Date Meth & Prc Dat N/A'
     C                     MOVEL'USR2097' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983836*
      *
     C                     END                             *FI
      * ERR: Date Method = Blank and Market Price Date/Rage = Zero
      * CASE: (No Market Dates Entered)
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : PAR.Date Method Code is Not Entered
      *   |- c2    : PAR.Market Pricing Date is EQ Zero
      *   |- c3    : PAR.OD Market Begin Date is not entered
      *   |- c4    : PAR.OD Market Ending Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFEQ *BLANK                     *IF
     C           #1EXDT    IFEQ 0                          *IF
     C           #1TKDT    IFEQ 0                          *IF
     C           #1TLDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1RDCD    ZA0109           Date Method Cod
      * Send message 'Market Date Method Inval.'
     C                     MOVEL'USR2161' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * ERR: Market Price Date & Market Price Date Range Entered
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1TKDT    IFNE 0                          *IF
     C           #1TLDT    ORNE 0                          *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0110
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0111
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0112
      * Send message 'Market Date/Range ERR'
     C                     MOVEL'USR4331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
      * ERR: Market Price Begin Date > Market Price Ending Date
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C           #1TKDT    IFGT #1TLDT                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert OD Market Begin Date to display format
      * Convert date
     C           1000000   ADD  #1TKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0113
      * Convert OD Market Ending Date to display format
      * Convert date
     C           1000000   ADD  #1TLDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0114
      * Send message 'Date Range Invalid'
     C                     MOVEL'USR4332' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LQCD    WL0023    P      Commodity Marke
     C                     MOVELYL0055    WL0024    P      Commodity Price
     C                     EXSR TGRVGN
      * VAL: Commodity Market Price Exists
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C           #1LQCD    IFNE YL0048                     *IF
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0048    WL0023    P      Commodity Marke
     C                     MOVELYL0055    WL0024    P      Commodity Price
     C                     EXSR TGRVGN
      * Use Company Item
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0115           Commodity Marke
     C                     MOVELYL0055    ZA0116           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0117           Commodity Marke
     C                     MOVELYL0055    ZA0118           Commodity Price
     C                     MOVELYL0048    ZA0119           Default Commod
      * Send message 'No Price Mkt/Group Deflt'
     C                     MOVEL'USR2350' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0120           Commodity Marke
     C                     MOVELYL0055    ZA0121           Commodity Price
      * Send message 'No Price for Mkt/Group'
     C                     MOVEL'USR2349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve Contract Defaults
      * CASE: RCD.Contract Number is Entered
     C           #1L6NB    IFGT *ZERO                      *IF
      * RTV Contract Defaults  RT - OPP Item Contract  * 
     C                     EXSR THRVGN
     C                     Z-ADD#1L6NB    WUL6NB           Contract Number
     C                     END                             *FI
      * DEV or DVG and CON then Price Code is required        E002662
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : RCD.Price Method Code is Deviated
      *   |- c2    : RCD.Price Method Code is Deviated Gate Price
      *   |- c3    : RCD.OD Price Type is Contract
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Q7CD    IFEQ 'DEV'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1Q7CD    IFEQ 'DVG'                      *IF
     C           #1F7SX    IFEQ 'CON'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: RCD.Price Code is Not Entered
     C           #1BVTM    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1Q7CD    ZA0122           Price Method Co
     C                     Z-ADD#1BVTM    ZA0123           Price Code
      * Send message 'Price code req for mthd'
     C                     MOVEL'USR3316' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983537*
      *
     C                     MOVEL'Y'       #RBSTS           USR Display 4
     C                     END                             *FI
     C                     END                             *FI
      * Contract Number not found
      * CASE: RCD.Contract Number is Entered
     C           #1L6NB    IFGT *ZERO                      *IF
      * RTV Entered Cont #     RT - OPP Item Contract  * 
     C                     EXSR TIRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1L6NB    ZA0124           Contract Number
      * Send message 'OPP Contract Error'
     C                     MOVEL'USR1803' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1L6NB    WUL6NB           Contract Number
      *
     C                     Z-ADD*ZERO     WN0137  70       Effective Date
     C                     Z-ADD*ZERO     WN0138  70       End Date Effect
     C                     Z-ADD*ZERO     WN0139 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0140 112       Quantity Sold
      *
      * EDT Order Detail Edits IF
     C                     MOVEL*BLANK    P8XSST           Contract Exists
     C                     MOVEL*BLANK    P8WDST           Cntrt Enter no
     C                     MOVEL*BLANK    P8WEST           Cntrt.# does no
     C                     MOVEL*BLANK    P8WFST           Qty ordered > C
     C                     MOVEL*BLANK    P8WGST           Contract Expire
     C                     MOVEL*BLANK    P8WHST           Price Override
     C                     MOVEL*BLANK    P8WIST           Price Method QT
     C                     MOVEL*BLANK    P8WJST           Prc Code FRM or
     C                     MOVEL*BLANK    P8WKST           Mkt Pricing Dat
     C                     MOVEL*BLANK    P8WLST           Mkt Meth. and D
     C                     MOVEL*BLANK    P8WMST           Price Override
     C                     MOVEL*BLANK    P8YXST           Price Override
      * Get Price Method Type
      * RTV Prc Mth Typ by Sys RT - Price Method Header  * 
     C                     EXSR TJRVGN
      * Check if Contract exists for Item
      * A Contract Exists for this customer and item.
      * CASE: PAR.Contract Number is Zero
     C           WUL6NB    IFEQ 0                          *IF
      * RTV Edt for Existing   RT - OPP Item Contract  * 
     C                     EXSR TKRVGN
     C                     Z-ADDWUL6NB    WUL6NB           Contract Number
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,017                    *IF
     C                     MOVEL'Y'       P8XSST           Contract Exists
     C                     END                             *FI
     C                     END                             *FI
      * Edit Contract Number
      * CASE: PAR.Contract Number is Entered
     C           WUL6NB    IFGT 0                          *IF
      * RTV Val. Contract #    RT - OPP Item Contract  * 
     C                     EXSR TLRVGN
      * Set Contract Error Parms
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL'Y'       P8WEST           Cntrt.# does no
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0140    ADD  #RINQT    WUCAQT           Total Quantity
      * CASE: WRK.Total Quantity Ordered GT PAR.Maximum Quantity
     C           WUCAQT    IFGT WN0139                     *IF
     C                     MOVEL'Y'       P8WFST           Qty ordered > C
     C                     END                             *FI
      * CASE: PAR.End Date Effective LE PAR.Order Date
     C           WN0138    IFLE P1A0DT                     *IF
     C                     MOVEL'Y'       P8WGST           Contract Expire
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validity Checking
      * Price Override and Manual Price Method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Type is Manual Pricing
      *   |- c2    : PAR.Price Overage Override is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7V8ST    IFEQ 'M'                        *IF
     C           #1BZPR    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P8WHST           Price Override
     C                     END                             *FI
      * Price override and EXT price method
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Type is Extended Pricing
      *   |- c2    : PAR.Price Overage Override is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7V8ST    IFEQ 'X'                        *IF
     C           #1BZPR    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P8WMST           Price Override
     C                     END                             *FI
      * FRM / MKT Checks
      * CASE: PAR.Price Method Type is Market or Formula
     C           P7V8ST    IFEQ 'F'                        *IF
     C           P7V8ST    OREQ 'K'
      * Market Code Must be entered
      * CASE: PAR.Commodity Market Code is Not Entered
     C           #1LQCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       P8WJST           Prc Code FRM or
     C                     END                             *FI
      * Market Price Date field not zero
      * CASE: PAR.Market Pricing Date is NE Zero
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'Y'       P8WKST           Mkt Pricing Dat
     C                     END                             *FI
      * CASE: PAR.Price Overage Override is Not Zeros
     C           #1BZPR    IFNE 0                          *IF
     C                     MOVEL'Y'       P8YXST           Price Override
     C                     END                             *FI
     C                     END                             *FI
      * MKT date Method entered and Mkt Price Date both entered.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RDCD    IFNE *BLANK                     *IF
     C           #1EXDT    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P8WLST           Mkt Meth. and D
     C                     END                             *FI
      * Contract exists for this item
      * CASE: PAR.Contract Exists for Item is yes
     C           P8XSST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0125           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0125           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADDWUL6NB    ZA0126           Contract Number
      * Send message 'This item has a Contract'
     C                     MOVEL'USR1851' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Contract not found
      * CASE: PAR.Cntrt.# does not Exit is yes
     C           P8WEST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1L6NB    ZA0127           Contract Number
      * Send message 'OPP Contract Error'
     C                     MOVEL'USR1803' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * Quantity ordered exceeds contract quantity available
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Qty ordered > Contract is yes
      *   |- c2    : RCD.Contract Number NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8WFST    IFEQ 'Y'                        *IF
     C           #1L6NB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#RINQT    ZA0128           Quantity 11.2 U
     C                     Z-ADD#1L6NB    ZA0129           Contract Number
      * Send message 'Quantity Ordered > Contra'
     C                     MOVEL'USR1806' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Contract has passed expiration date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Contract Expired is yes
      *   |- c2    : RCD.Contract Number is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8WGST    IFEQ 'Y'                        *IF
     C           #1L6NB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1L6NB    ZA0130           Contract Number
      * Send message 'Contract Effective date'
     C                     MOVEL'USR1810' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * -------------------------------------------------
      * Market code/prc date must be entered with FRM or MKT price code
      * CASE: PAR.Prc Code FRM or MKT is yes
     C           P8WJST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1LQCD    ZA0131           Commodity Marke
      * Send message 'Market Code must be enter'
     C                     MOVEL'USR1750' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
      * Date method/Pricing Date
      * CASE: PAR.Mkt Meth. and Date both is yes
     C           P8WLST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0132
     C                     MOVEL#1RDCD    ZA0133           Date Method Cod
      * Send message 'Date Meth & Prc Dat N/A'
     C                     MOVEL'USR2097' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983836*
      *
     C                     END                             *FI
      * -------------------------------------------------
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
     C                     EXSR TMRVGN
      * Error condition warehouse not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0134           Warehouse Code
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: WRK.Trans Contol AS400/Plant NE PAR.Trans Contol AS400/Plan
     C           WUXUST    IFNE P1XUST                     *IF
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0135           Warehouse Code
     C                     MOVELWUXUST    ZA0136           Trans Contol AS
     C                     MOVELP1XUST    ZA0137           Trans Contol AS
      * Send message 'Warehouse Ctl not allowed'
     C                     MOVEL'USR1920' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C           #1AVQT    MULT #1AVWG    #1D0WG           Weight Ordered
      * weight ordered
      * CASE: RCD.Order Secondary Line Seq is GT 1
     C           #1UENB    IFGT 1                          *IF
     C           #RINQT    MULT #1AVWG    #RFHWG           Weight 11.2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1D0WG    #RFHWG           Weight 11.2 USR
     C                     END                             *FI
      * Set/Val OH TF Exempt  IF
      * Set / Validate TF Exempt code values              RMC 8/24/05
      * CASE: PAR.OH TF Exempt Code is Blank
     C           #CFYSX    IFEQ *BLANK                     *IF
      * VAL: Customer Exempt Code  w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C           #CP3SX    IFEQ 'NE'                       *IF
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Item Codes
     C           #1F4SX    IFEQ 'EP'                       *IF
     C           #1F4SX    OREQ 'NE'
     C                     MOVEL*BLANK    #CFYSX           OH TF Exempt Co
     C                     MOVEL#1F4SX    #CFYSX           OH TF Exempt Co
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
     C           #CP3SX    IFEQ 'EC'                       *IF
     C                     MOVEL*BLANK    #CFYSX           OH TF Exempt Co
     C                     MOVEL#CP3SX    #CFYSX           OH TF Exempt Co
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
     C           #1F4SX    IFEQ 'NE'                       *IF
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C           #RP3ST    IFEQ 'S'                        *IF
     C           #RP3ST    OREQ 'T'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0138           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0138           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'TF Exempt-Item & Cust'
     C                     MOVEL'USR4203' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EC'      #1F4SX           Ord TF Exempt C
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EP'      #1F4SX           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate after 1 line item has been entered
      * If not Pre-Commencement, set exempt code
      * CASE: PAR.OH TF Exempt Code is Not Pre-Commencement
     C           #CFYSX    IFEQ 'EC'                       *IF
     C           #CFYSX    OREQ 'EP'
     C           #CFYSX    OREQ 'NE'
      * VAL: Customer Exempt Code w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C           #CP3SX    IFEQ 'NE'                       *IF
      * Line item must eq whats in the header, else Error
      * CASE: PAR.OH TF Exempt Code NE PAR.Ord TF Exempt Code
     C           #CFYSX    IFNE #1F4SX                     *IF
      * Setup message data for message
      * Send message 'Tf Exempt - mix error'
     C                     MOVEL'USR3588' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
     C           #CP3SX    IFEQ 'EC'                       *IF
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
     C           #1F4SX    IFEQ 'NE'                       *IF
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C           #RP3ST    IFEQ 'S'                        *IF
     C           #RP3ST    OREQ 'T'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0139           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0139           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'TF Exempt-Item & Cust'
     C                     MOVEL'USR4203' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EC'      #1F4SX           Ord TF Exempt C
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EP'      #1F4SX           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'PC'      #1F4SX           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
      * Item structure
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Item Level
      * CASE: RCD.Item Level NE WRK.BLANK
     C           #1RBCD    IFNE WUGSTX                     *IF
      * VAL Item Level Exists  RT - Item Level  * 
     C                     EXSR TNRVGN
      * Error if not found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0140           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0140           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'PD Item Level not found'
     C                     MOVEL'USR2076' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Price Type
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : RCD.OD SD Price Method is *NONE
      *   |- c2    : PAR.SD Price Mthd Req STS USR is yes
      *   |- c3    : PAR.Order Type - Sales is Regular Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1F7SX    IFEQ *BLANK                     *IF
     C           P7        IFEQ 'Y'                        *IF
     C           P1JNCD    IFEQ 'OR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1F7SX    ZA0141           OD Price Type
      * Send message 'OD Price Type Req'
     C                     MOVEL'USR3952' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      * VAL: Pallet Type                                  9/16/21 WI464
      * CASE: RCD.Palletize is yes
     C           #1VEST    IFEQ 'Y'                        *IF
      * If Pallet Type is blank
      * CASE: RCD.Pallet Type NOREF is Not entered
     C           #RQRU1    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#RQRU1    ZA0142           Pallet Type NOR
      * Send message 'Pallet Type Req'
     C                     MOVEL'USR3954' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Validate Ham Group.
      *================================================================
      * 5/11/07 PKD If an Item belongs to a Ham Group, then a Group
      *             must be specified.
      * 09/21/07 PKD Only Validate Ham Group for Combos
      * CASE: RCD.U/M - Ordered is Combos
     C           #1AGCD    IFEQ 'CB'                       *IF
      * VAL Item              RT - Ham Group Item  * 
     C                     EXSR SXRVGN
      * VAL:  Ham Group
      * CASE: LCL.Record Found USR is Record Found
     C           YL0036    IFEQ 'Y'                        *IF
      * CASE: RCD.Ham Group Number is Not Entered
     C           #1A1AA    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0052           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0052           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ham Group REQ'
     C                     MOVEL'USR3717' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: RCD.Ham Group Number is Entered
     C           #1A1AA    IFNE *ZERO                      *IF
      * Validate Ham Group Existance.
     C                     EXSR UGSUBR                     Validate Ham Gr
      * 05/11/07 PKD Error Message instead of Informational Message
      * Check for Ham Group/Item.
     C                     EXSR UISUBR                     Check for Ham G
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Validate Ham Group Existance.
      *================================================================
      * VAL Ham Group          RT - Ham Group  * 
     C                     EXSR SYRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Ham Group Not Found.
     C                     EXSR UHSUBR                     Ham Group Not F
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Ham Group Not Found.
      *================================================================
      * Setup message data for message
     C                     Z-ADD#1A1AA    ZA0053           Ham Group Numbe
      * Send message 'Ham group not found.'
     C                     MOVEL'USR2875' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9840  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Check for Ham Group/Item.
      *================================================================
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
      * Rtv Credit Item Sts   RT - Company Item  * 
     C                     EXSR SZRVGN
      * CASE: LCL.Credit Item Status is yes
     C           YL0045    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: RCD.U/M - Ordered is Not Combos
     C           #1AGCD    IFNE 'CB'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Ham Group/Item     RT - Ham Group Item  * 
     C                     EXSR TARVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Ham Group/Item not found.
     C                     EXSR UJSUBR                     Ham Group/Item
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Ham Group/Item not found.
      *================================================================
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0054           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0054           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD#1A1AA    ZA0055           Ham Group Numbe
      * Send message 'Ham Group/Item not found'
     C                     MOVEL'USR2876' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983340*
      *
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * *** Delete Request. ***
      *================================================================
      * New code
      * CASE: RCD.Plan Production Sts USR is Yes
     C           #ROXSC    IFEQ 'Y'                        *IF
      * if it WAS yes, then deallocate
      * E4122 JJH 06/11/15 - Use Requested Ship Date for Allocation/Deall
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0413  30       Company Number
     C                     PARM #1C4NB    WQ0414  70       Order Number
     C                     PARM #1DPNB    WQ0415  30       Order Sequence
     C                     PARM #1UENB    WQ0416  30       Order Secondary
     C                     PARM #RDKCD    WQ0417  70       Item Code
     C                     PARM #RCPCD    WQ0418  3        Warehouse Code
     C                     PARM #1A5DT    WQ0419  70       Ship Date USR
     C                     PARM *ZERO     WQ0420 112       Quantity Ordere
     C                     PARM *ZERO     WQ0421 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0422 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0423 112       Weight Schedule
     C                     PARM 'OD'      WQ0424  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0425 10        PSAA Program Na
     C                     PARM #RRWNY    WQ0426  40       Item Age Days
     C                     PARM #RTRDT    WQ0427  70       Production Ovr
     C                     PARM #RTSDT    WQ0428  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     END                             *FI
      * *-------------------------------------------------*
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * *** Update Allocations. ***
      *================================================================
      *  FP1054 4/09/09 if OD Production Plan Sts = "N", dont do the allo
      *   and make the schedule qty = order qty
      * FP1309 Allocation & DE-Allocation
      * TRANSFER order : Allocate or deallocate changes - fp1054
      * CASE: CTL.Order Type - Sales is Transfer Order
     C           #2JNCD    IFEQ 'TR'                       *IF
      * Dealloc / Realloc if...
      * CASE:
      *  -  c1 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : RCD.Quantity 11.2 USR NE RCD.Quantity Scheduled
      *   |- c3    : RCD.Warehouse Code NE RCD.USR Warehouse Code
      *   |- c4    : RCD.Item Age Days NE RCD.Item age days usr
      *   |- c5    : RCD.Production Ovr AgeDte Fr NE RCD.Prod OvrAge Frm
      *   |- c6    : RCD.Production Ovr AgeDte To NE RCD.Prod OvrAge To U
      *   |- c7    : RCD.OD Production Plan St USR NE RCD.Plan Production
      *   '-
     C           #RINQT    IFNE #1CCQT                     *IF
     C           #1AJCD    ORNE #RCPCD                     *OR
     C           #1RINY    ORNE #RRWNY                     *OR
     C           #1TIDT    ORNE #RTRDT                     *OR
     C           #1TJDT    ORNE #RTSDT                     *OR
     C           #ROWSC    ORNE #ROXSC                     *OR
      * FP1309 remove age code and add item age days and from/to dates
      * Dealloc
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * If the orig sts was " " = yes, then dealloc
      * CASE: RCD.Plan Production Sts USR is Yes
     C           #ROXSC    IFEQ 'Y'                        *IF
      * E4122 JJH 06/11/15 - Use Requested Ship Date for Allocation/Deall
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0429  30       Company Number
     C                     PARM #1C4NB    WQ0430  70       Order Number
     C                     PARM #1DPNB    WQ0431  30       Order Sequence
     C                     PARM #1UENB    WQ0432  30       Order Secondary
     C                     PARM #1HGCD    WQ0433  70       Item Code
     C                     PARM #RCPCD    WQ0434  3        Warehouse Code
     C                     PARM #1A5DT    WQ0435  70       Ship Date USR
     C                     PARM *ZERO     WQ0436 112       Quantity Ordere
     C                     PARM *ZERO     WQ0437 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0438 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0439 112       Weight Schedule
     C                     PARM 'OD'      WQ0440  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0441 10        PSAA Program Na
     C                     PARM #RRWNY    WQ0442  40       Item Age Days
     C                     PARM #RTRDT    WQ0443  70       Production Ovr
     C                     PARM #RTSDT    WQ0444  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Alloc if ...
      * CASE: RCD.OD Production Plan St USR is Yes
     C           #ROWSC    IFEQ 'Y'                        *IF
      * E4122 JJH 06/11/15 - Use Requested Ship Date for Allocation/Deall
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0445  30       Company Number
     C                     PARM #1C4NB    WQ0446  70       Order Number
     C                     PARM #1DPNB    WQ0447  30       Order Sequence
     C                     PARM #1UENB    WQ0448  30       Order Secondary
     C                     PARM #1HGCD    WQ0449  70       Item Code
     C                     PARM #1AJCD    WQ0450  3        Warehouse Code
     C                     PARM #1A5DT    WQ0451  70       Ship Date USR
     C                     PARM #RINQT    WQ0452 112       Quantity Ordere
     C                     PARM #RFHWG    WQ0453 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0454 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0455 112       Weight Schedule
     C                     PARM 'OA'      WQ0456  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0457 10        PSAA Program Na
     C                     PARM #1RINY    WQ0458  40       Item Age Days
     C                     PARM #1TIDT    WQ0459  70       Production Ovr
     C                     PARM #1TJDT    WQ0460  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983341*
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Display Order Quantity & weight on screen.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.User Code Model is Production Sched 5
      *   |- c2    : RCD.OD Production Plan St USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ @CN,005                    *IF
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.OD Production Plan St USR is No
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     Z-ADD#RHHQT    #1CCQT           Quantity Schedu
     C                     Z-ADD#1D0WG    #1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Display Order Quantity & weight on screen.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.User Code Model is Production Sched 5
      *   |- c2    : RCD.OD Production Plan St USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ @CN,005                    *IF
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * EXC Qty/Wgt Sched TOT RT - Order Detail Schedule  * 
     C                     CLEARPFRC
     C                     Z-ADD#1AIC3    PFAIC3           Company Number
     C                     Z-ADD#1C4NB    PFC4NB           Order Number
     C                     Z-ADD#1DPNB    PFDPNB           Order Sequence
     C                     Z-ADD#1UENB    PFUENB           Order Secondary
      *
     C                     CALL 'PVBZXFR'              90  EXC Qty/Wgt Sch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Order Deta
     C           #1CCQT    PARM *ZERO     WQ0461 112       Quantity Schedu
     C           #1AUWG    PARM *ZERO     WQ0462 112       Weight Schedule
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.OD Production Plan St USR is No
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     Z-ADD#RHHQT    #1CCQT           Quantity Schedu
     C                     Z-ADD#1D0WG    #1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      *    no further action; quantity ordered = quantity allocated
     C                     END                             *FI
     C                     END                             *FI
      * REGULAR order : Allocate or deallocate changes - fp1054
      * CASE: CTL.Order Type - Sales is Regular Order
     C           #2JNCD    IFEQ 'OR'                       *IF
      * Dealloc if orig plan prod sts was Yes and new one is NO
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * If the orig sts was " " = yes and new sts is NO, then dealloc
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.Plan Production Sts USR is Yes
      *   |- c2    : RCD.OD Production Plan St USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #ROXSC    IFEQ 'Y'                        *IF
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * E4122 JJH 06/11/15 - Use Requested Ship Date for Allocation/Deall
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0463  30       Company Number
     C                     PARM #1C4NB    WQ0464  70       Order Number
     C                     PARM #1DPNB    WQ0465  30       Order Sequence
     C                     PARM #1UENB    WQ0466  30       Order Secondary
     C                     PARM #1HGCD    WQ0467  70       Item Code
     C                     PARM #RCPCD    WQ0468  3        Warehouse Code
     C                     PARM #1A5DT    WQ0469  70       Ship Date USR
     C                     PARM *ZERO     WQ0470 112       Quantity Ordere
     C                     PARM *ZERO     WQ0471 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0472 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0473 112       Weight Schedule
     C                     PARM 'OD'      WQ0474  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0475 10        PSAA Program Na
     C                     PARM #1RINY    WQ0476  40       Item Age Days
     C                     PARM #1TIDT    WQ0477  70       Production Ovr
     C                     PARM #1TJDT    WQ0478  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983341*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Display Order Quantity & weight on screen.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.User Code Model is Production Sched 5
      *   |- c2    : RCD.OD Production Plan St USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ @CN,005                    *IF
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * EXC Qty/Wgt Sched TOT RT - Order Detail Schedule  * 
     C                     CLEARPFRC
     C                     Z-ADD#1AIC3    PFAIC3           Company Number
     C                     Z-ADD#1C4NB    PFC4NB           Order Number
     C                     Z-ADD#1DPNB    PFDPNB           Order Sequence
     C                     Z-ADD#1UENB    PFUENB           Order Secondary
      *
     C                     CALL 'PVBZXFR'              90  EXC Qty/Wgt Sch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Order Deta
     C           #1CCQT    PARM *ZERO     WQ0479 112       Quantity Schedu
     C           #1AUWG    PARM *ZERO     WQ0480 112       Weight Schedule
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.OD Production Plan St USR is No
     C           #ROWSC    IFEQ 'N'                        *IF
     C                     Z-ADD#RHHQT    #1CCQT           Quantity Schedu
     C                     Z-ADD#1D0WG    #1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Allocate or deallocate changes - fp1054 for changes, deallc all o
      * CASE:
      *  - (c1 OR c2 OR c3 OR c4 OR c5 OR c6) AND c7
      *   |- c1    : RCD.Quantity 11.2 USR NE RCD.Quantity Scheduled
      *   |- c2    : RCD.Warehouse Code NE RCD.USR Warehouse Code
      *   |- c3    : RCD.OD Production Plan St USR NE RCD.Plan Production
      *   |- c4    : RCD.Item Age Days NE RCD.Item age days usr
      *   |- c5    : RCD.Production Ovr AgeDte Fr NE RCD.Prod OvrAge Frm
      *   |- c6    : RCD.Production Ovr AgeDte To NE RCD.Prod OvrAge To U
      *   |- c7    : RCD.OD Production Plan St USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #RINQT    IFNE #1CCQT                     *IF
     C           #1AJCD    ORNE #RCPCD                     *OR
     C           #ROWSC    ORNE #ROXSC                     *OR
     C           #1RINY    ORNE #RRWNY                     *OR
     C           #1TIDT    ORNE #RTRDT                     *OR
     C           #1TJDT    ORNE #RTSDT                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #ROWSC    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FP1309 remove age code and add item age days and from/to dates
      * Dealloc
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * If the orig sts was " " = yes, then dealloc
      * CASE: RCD.Plan Production Sts USR is Yes
     C           #ROXSC    IFEQ 'Y'                        *IF
      * E4122 JJH 06/11/15 - Use Requested Ship Date for Allocation/Deall
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0481  30       Company Number
     C                     PARM #1C4NB    WQ0482  70       Order Number
     C                     PARM #1DPNB    WQ0483  30       Order Sequence
     C                     PARM #1UENB    WQ0484  30       Order Secondary
     C                     PARM #1HGCD    WQ0485  70       Item Code
     C                     PARM #RCPCD    WQ0486  3        Warehouse Code
     C                     PARM #1A5DT    WQ0487  70       Ship Date USR
     C                     PARM *ZERO     WQ0488 112       Quantity Ordere
     C                     PARM *ZERO     WQ0489 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0490 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0491 112       Weight Schedule
     C                     PARM 'OD'      WQ0492  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0493 10        PSAA Program Na
     C                     PARM #1RINY    WQ0494  40       Item Age Days
     C                     PARM #1TIDT    WQ0495  70       Production Ovr
     C                     PARM #1TJDT    WQ0496  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983341*
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * E4122 JJH 06/11/15 - Use Requested Ship Date for Allocation/Deall
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0497  30       Company Number
     C                     PARM #1C4NB    WQ0498  70       Order Number
     C                     PARM #1DPNB    WQ0499  30       Order Sequence
     C                     PARM #1UENB    WQ0500  30       Order Secondary
     C                     PARM #1HGCD    WQ0501  70       Item Code
     C                     PARM #1AJCD    WQ0502  3        Warehouse Code
     C                     PARM #1A5DT    WQ0503  70       Ship Date USR
     C                     PARM #RINQT    WQ0504 112       Quantity Ordere
     C                     PARM #RFHWG    WQ0505 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0506 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0507 112       Weight Schedule
     C                     PARM 'OA'      WQ0508  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0509 10        PSAA Program Na
     C                     PARM #1RINY    WQ0510  40       Item Age Days
     C                     PARM #1TIDT    WQ0511  70       Production Ovr
     C                     PARM #1TJDT    WQ0512  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983341*
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      *    no further action; quantity ordered = quantity allocated
     C                     END                             *FI
     C                     END                             *FI
      * 02/21/2018 DN R11918-Throw Err Msg if QtySched < QtyOrd for Suspe
      * CASE:
      *  - NOTc1 AND c2
      *   |- c1    : RCD.*SFLSEL is *Delete#1
      *   |- c2    : RCD.OD Production Plan St USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1SEL     IFEQ '4'                        *IF
     C                     ELSE
     C           #ROWSC    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: LCL.Allocation Method is Suspended-Inventory Only
     C           YL0041    IFEQ 'I'                        *IF
      * CASE: RCD.Quantity Scheduled LT RCD.Quantity 11.2 USR
     C           #1CCQT    IFLT #RINQT                     *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0143           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0143           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Inv Not Avail 4 Susp Item'
     C                     MOVEL'USR5061' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     GOTO ULEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0144           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0144           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item is suspended-invonly'
     C                     MOVEL'USR5060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 moved to here so the a/r cr check has an order value total
     C           #1AVQT    MULT #1AUPR    #1AYVA    H      Extended Amount
     C                     MOVEL'N'       W0DCF            *Defer confirm
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Determine quantity open on this line
      *================================================================
      * CASE: DB1.Detail Line Status is Cancel Status Types
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
      * If entered status force control value to N
      * CASE: DB1.Detail Line Status is Entered
     C           OMGMST    IFEQ 'E'                        *IF
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     END                             *FI
     C           OMAVQT    SUB  OMCBQT    WUAVQT           Quantity Ordere
     C                     Z-ADDOMCCQT    WUCCQT           Quantity Schedu
     C           WUAVQT    MULT OMAVWG    WUAYWG    H      USR Order Weigh
     C                     SUB  WUAYWG    WUAYWG           USR Order Weigh
     C                     SUB  OMAYVA    WUJSVA           USR Order Value
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Process Inventory update if required by control field
      *================================================================
     C           OMAVQT    SUB  OMCCQT    WUAPQT           Quantity Backor
      * update availability  if Prod Plan sts is " " = yes - chgd fp1054
      * CASE: DB1.OD Production Plan Sts is Yes
     C           OMR1ST    IFEQ *BLANK                     *IF
     C                     Z-ADDOMCCQT    WN0265           Quantity Schedu
     C                     Z-ADDOMAUWG    WN0266           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0575  30       Company Number
     C                     PARM OMC4NB    WQ0576  70       Order Number
     C                     PARM OMDPNB    WQ0577  30       Order Sequence
     C                     PARM OMUENB    WQ0578  30       Order Secondary
     C                     PARM OMHGCD    WQ0579  70       Item Code
     C                     PARM OMAJCD    WQ0580  3        Warehouse Code
     C                     PARM OMA5DT    WQ0581  70       Ship Date USR
     C                     PARM *ZERO     WQ0582 112       Quantity Ordere
     C                     PARM *ZERO     WQ0583 112       Weight Ordered
     C           WN0265    PARM WN0265    WQ0584 112       Quantity Schedu
     C           WN0266    PARM WN0266    WQ0585 112       Weight Schedule
     C                     PARM 'OD'      WQ0586  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0587 10        PSAA Program Na
     C                     PARM OMRINY    WQ0588  40       Item Age Days
     C                     PARM OMTIDT    WQ0589  70       Production Ovr
     C                     PARM OMTJDT    WQ0590  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0265           Quantity Schedu
     C                     Z-ADD*ZERO     WN0266           Weight Schedule
     C                     END                             *FI
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Update detail record to indicate delete status
      *================================================================
      * CASE: PAR.Header Status is Entered
     C           'A'       IFEQ 'E'                        *IF
      * DLT PD Order Detail    DL - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0029           Company Number
     C                     Z-ADDOMC4NB    WL0030           Order Number
     C                     Z-ADDOMDPNB    WL0031           Order Sequence
     C                     Z-ADDOMUENB    WL0032           Order Secondary
     C                     EXSR TQDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Set status to cancelled
     C                     MOVELOMGMST    WUGNST           Detail Line Sta
     C                     MOVEL'X'       WUGMST           Detail Line Sta
      * CHG PD Order Detail    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0033           Company Number
     C                     Z-ADDOMC4NB    WL0034           Order Number
     C                     Z-ADDOMDPNB    WL0035           Order Sequence
     C                     Z-ADDOMUENB    WL0036           Order Secondary
     C                     Z-ADDOMHGCD    WL0037           Item Code
     C                     MOVELOMAJCD    WL0038    P      Warehouse Code
     C                     Z-ADDOMBKC7    WL0039           Ship To Custome
     C                     Z-ADDOMCFC7    WL0040           Order Group Cod
     C                     MOVELWUGMST    WL0041    P      Detail Line Sta
     C                     MOVELWUGNST    WL0042    P      Detail Line Sta
     C                     Z-ADDOMMAVA    WL0043           Billing Detail
     C                     Z-ADDOMKDVA    WL0044           Billing Detail
     C                     Z-ADDOML8VA    WL0045           Billing Detail
     C                     Z-ADDOML9VA    WL0046           Quantity to Sub
     C                     MOVELOMGTST    WL0047    P      Comment Print A
     C                     MOVELOMGVST    WL0048    P      Comment Print I
     C                     MOVELOMGUST    WL0049    P      Comment Print P
     C                     MOVELOMQFST    WL0050    P      Comment Print S
     C                     Z-ADDOMAYVA    WL0051           Extended Amount
     C                     Z-ADDOMEXDT    WL0052           Market Pricing
     C                     MOVELOMLQCD    WL0053    P      Commodity Marke
     C                     MOVELOMRDCD    WL0054    P      Date Method Cod
     C                     MOVELOMQ7CD    WL0055    P      Price Method Co
     C                     Z-ADDOMBZPR    WL0056           Price Overage O
     C                     Z-ADDOML6NB    WL0057           Contract Number
     C                     MOVELOMU1ST    WL0058    P      Price Status
     C                     Z-ADDOMGIDT    WL0059           Pricing Date Us
     C                     MOVELOMCRCD    WL0060    P      U_M_Base Price
     C                     MOVELOMAGCD    WL0061    P      U_M_Ordered
     C                     MOVELOMRZST    WL0062    P      Work Confirm St
     C                     MOVELOMR0ST    WL0063    P      Work Over_Short
     C                     MOVELOMR1ST    WL0064    P      OD Production P
     C                     MOVELOMG7NA    WL0065    P      Order Desc_Line
     C                     MOVELOMG8NA    WL0066    P      Order Desc_Line
     C                     MOVELOMRPCD    WL0067    P      Age Code
     C                     MOVELOMVEST    WL0068    P      Palletize
     C                     MOVELOMVGST    WL0069    P      Slip Sheet
     C                     MOVELOMAVST    WL0070    P      Catch Weight St
     C                     MOVELOMU0ST    WL0071    P      Price Audit
     C                     MOVELOMRFCD    WL0072    P      Price Audit Rea
     C                     MOVELOMFZST    WL0073    P      Production Date
     C                     Z-ADDOMR1NB    WL0074           Rated Freight
     C                     Z-ADDOMAVQT    WL0075           Quantity Ordere
     C                     Z-ADDOMD0WG    WL0076           Weight Ordered
     C                     Z-ADD*ZERO     WL0077           Quantity Schedu
     C                     Z-ADD*ZERO     WL0078           Weight Schedule
     C                     Z-ADDOMCBQT    WL0079           Quantity Shippe
     C                     Z-ADDOMATWG    WL0080           Weight Shipped
     C                     Z-ADDOMAQCS    WL0081           Unit Cost Prici
     C                     Z-ADDOMAGCS    WL0082           Unit Cost Per P
     C                     Z-ADDOMAKPR    WL0083           Unit Price
     C                     Z-ADDOMALPR    WL0084           Unit Price_Cred
     C                     Z-ADDOMAUPR    WL0085           Unit Price Orde
     C                     Z-ADDOMAVWG    WL0086           Unit Weight Ord
     C                     Z-ADDOMA4WG    WL0087           Tare Weight Tot
     C                     Z-ADDOMA5DT    WL0088           Requested Ship
     C                     Z-ADDOMAODT    WL0089           Scheduled Ship
     C                     Z-ADDOMGNDT    WL0090           Actual Shipped
     C                     MOVELOMAMST    WL0091    P      Affect Inventor
     C                     MOVELOMANST    WL0092    P      Affect Sales Do
     C                     MOVELOMVAST    WL0093    P      Affect Sales Pn
     C                     Z-ADDOMRGNB    WL0094           Item Structure
     C                     Z-ADDOMRHNB    WL0095           Item Structure
     C                     Z-ADDOMRINB    WL0096           Item Structure
     C                     MOVELOMRBCD    WL0097    P      Item Level
     C                     MOVELOMHICD    WL0098    P      Quality Level
     C                     MOVELOMRNCD    WL0099    P      Pricing Product
     C                     MOVELOMROCD    WL0100    P      Season Product
     C                     Z-ADDOMCXDT    WL0101           Date of Origina
     C                     MOVELOMAJVN    WL0102    P      User Profile Na
     C                     MOVELOMKXCD    WL0103    P      Country Code
     C                     MOVELOMJPCD    WL0104    P      Event Code
     C                     MOVELOMCQCD    WL0105    P      Reason Code
     C                     MOVELOMR4CD    WL0106    P      Sales Route Cod
     C                     MOVELOMZ1ST    WL0107    P      Modified Flag
     C                     MOVELOMZ3ST    WL0108    P      Substituted Fla
     C                     MOVELOMZ4ST    WL0109    P      OD Schedule Ove
     C                     Z-ADDOMDUPR    WL0110           Invoice Unit Pr
     C                     Z-ADDOMB6VL    WL0111           Invoice Extende
     C                     Z-ADDOMA1AA    WL0112           Ham Group Numbe
     C                     MOVELOMFZSX    WL0113    P      OD Adj Type Ove
     C                     MOVELOMF0SX    WL0114    P      Affect Trade Fu
     C                     MOVELOMF1SX    WL0115    P      Affect Commissi
     C                     MOVELOMF2SX    WL0116    P      Affect Pricing
     C                     MOVELOMF3SX    WL0117    P      Released by Use
     C                     MOVELOMF4SX    WL0118    P      Ord TF Exempt C
     C                     MOVELOMF5SX    WL0119    P      OD Pallet Type
     C                     MOVELOMF6SX    WL0120    P      Production Ware
     C                     MOVELOMF7SX    WL0121    P      OD Price Type
     C                     Z-ADDOMNTDT    WL0122           Warehouse Palle
     C                     Z-ADDOMNUDT    WL0123           Consumed Item C
     C                     Z-ADDOMNVDT    WL0124           Deadline Depart
     C                     Z-ADDOMNWDT    WL0125           OD Price Type R
     C                     Z-ADDOMNXDT    WL0126           OD Firm Date
     C                     Z-ADDOMBUTM    WL0127           Deadline Depart
     C                     Z-ADDOMBVTM    WL0128           Price Code
     C                     Z-ADDOMBWTM    WL0129           Maximum Net Wei
     C                     Z-ADDOMBXTM    WL0130           Substitution Li
     C                     Z-ADDOMBYTM    WL0131           Max Qty to sche
     C                     Z-ADDOMH5NX    WL0132           Warehouse Palle
     C                     Z-ADDOMH6NX    WL0133           Warehouse Avg P
     C                     Z-ADDOMH7NX    WL0134           OD Item Target
     C                     Z-ADDOMH8NX    WL0135           OD Estimated Gr
     C                     Z-ADDOMH9NX    WL0136           OD Maximum Unit
     C                     Z-ADDOMDVPR    WL0137           Order Gate_Fina
     C                     Z-ADDOMDWPR    WL0138           OD Ceiling Pric
     C                     Z-ADDOMDXPR    WL0139           OD Gate_Final P
     C                     Z-ADDOMDYPR    WL0140           OD Weighted Avg
     C                     Z-ADDOMDZPR    WL0141           OD Original Ord
     C                     Z-ADDOMGSPR    WL0142           OD Cancel Date
     C                     Z-ADDOMGTPR    WL0143           OD Unused Prc 7
     C                     Z-ADDOMGUPR    WL0144           OD Unused Prc 8
     C                     MOVELOMHOST    WL0145    P      OD MPR Sent to
     C                     MOVELOMHPST    WL0146    P      OD MPR Prc Read
     C                     MOVELOMIOST    WL0147    P      OD UnUsed Price
     C                     Z-ADDOMPEWG    WL0148           Weight Amount E
     C                     Z-ADDOMRINY    WL0149           Item Age Days
     C                     Z-ADDOMTIDT    WL0150           Production Ovr
     C                     Z-ADDOMTJDT    WL0151           Production Ovr
     C                     MOVELOMH2ST    WL0152    P      OD Spot Buy
     C                     MOVELOMH0ST    WL0153    P      OD Clm Full Ret
     C                     MOVELOMH1ST    WL0154    P      Order Line Erro
     C                     Z-ADDOMTKDT    WL0155           OD Market Begin
     C                     Z-ADDOMTLDT    WL0156           OD Market Endin
     C                     Z-ADDOMTMDT    WL0157           OD Atch to Ord
     C                     MOVELOMUVST    WL0158    P      EDI Status 1
     C                     MOVELOMUWST    WL0159    P      EDI Status 2
     C                     MOVELOMUXST    WL0160    P      EDI Status 3
     C                     EXSR TUCHRC
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                     CALL 'PBI3XFR'              90  Rtv Tare Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0612  30       Company Number
     C                     PARM OMHGCD    WQ0613  70       Item Code
     C           YL0085    PARM YL0085    WQ0614  52       Misc Tare Weigh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * wi464 change
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                     CALL 'PBI4XFR'              90  RTV Itm BxID &
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0615  30       Company Number
     C                     PARM OMHGCD    WQ0616  70       Item Code
     C           YL0086    PARM *ZERO     WQ0617  52       Box Weight
     C           YL0087    PARM *ZERO     WQ0618  50       Number Cases On
     C           YL0088    PARM *ZERO     WQ0619  52       Pallet Tare Wei
     C           YL0089    PARM *ZERO     WQ0620  70       Box iD
     C                     PARM OMF5SX    WQ0621  2        OD Pallet Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0086    ADD  YL0085    YL0090           Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C           YL0086    ADD  YL0085    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT OMAVQT    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0091           Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
     C           OMVEST    IFEQ 'Y'                        *IF
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0087    IFGT 0                          *IF
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C           OMAVQT    DIV  YL0087    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0088    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0092           Weight 1.2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0092           Weight 1.2
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0092           Weight 1.2
     C                     END                             *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C           OMD0WG    ADD  YL0091    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0092    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    OMH8NX           OD Estimated Gr
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                     CALL 'PBI3XFR'              90  Rtv Tare Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0639  30       Company Number
     C                     PARM OMHGCD    WQ0640  70       Item Code
     C           YL0093    PARM YL0093    WQ0641  52       Misc Tare Weigh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * wi464
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                     CALL 'PBI4XFR'              90  RTV Itm BxID &
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0642  30       Company Number
     C                     PARM OMHGCD    WQ0643  70       Item Code
     C           YL0094    PARM *ZERO     WQ0644  52       Box Weight
     C           YL0095    PARM *ZERO     WQ0645  50       Number Cases On
     C           YL0096    PARM *ZERO     WQ0646  52       Pallet Tare Wei
     C           YL0097    PARM *ZERO     WQ0647  70       Box iD
     C                     PARM OMF5SX    WQ0648  2        OD Pallet Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0094    ADD  YL0093    YL0098           Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C           YL0094    ADD  YL0093    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT OMAVQT    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0099           Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
     C           OMVEST    IFEQ 'Y'                        *IF
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0095    IFGT 0                          *IF
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C           OMAVQT    DIV  YL0095    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0096    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0100           Weight 1.2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0100           Weight 1.2
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0100           Weight 1.2
     C                     END                             *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C           OMD0WG    ADD  YL0099    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0100    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    OMH8NX           OD Estimated Gr
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0513  3        Warehouse Code
     C                     PARM *ZERO     WQ0514  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAAD    KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD
     C           KLVAAD    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1BKC7'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ANC7' defaulted for 'AR Customer Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0071' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ANC7    WQ0515  70       AR Customer Num
     C           YL0071    PARM *ZERO     WQ0516  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVBBB    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CFC7    IFEQ *ZERO                      Order Group Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCK0    KLIST
     C                     KFLD           K0AIC3           Company Number
     C                     KFLD           K0CFC7           Order Group Cod
      * Setup key
     C                     Z-ADD#1AIC3    K0AIC3
     C                     Z-ADD#1CFC7    K0CFC7
     C           KLVCK0    CHAIN@K0REJ6              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Group            NF'
     C                     MOVEL'USR2364' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2364' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Commodity Markets
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Commodity Marke
     C           YPMTFD    OREQ '#1LQCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1LQCD' defaulted for 'Commodity Market Code'.
     C                     CALL 'PDEDSRR'              90  SEL Commod. Mkt
     C                     PARM *BLANK    W0RTN   7
     C           #1LQCD    PARM #1LQCD    WQ0517  3        Commodity Marke
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9839  *
     C                     END
      *
     C           #1LQCD    IFNE *BLANK                     Commodity Marke
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LQCD    IFEQ *BLANK                     Commodity Marke
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDFY    KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVEL#1LQCD    FYLQCD
     C           KLVDFY    CHAIN@FYREDK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Commodity Markets      NF'
     C                     MOVEL'USR1218' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1218' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Market Date Method
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RDCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Date Method Cod
     C           YPMTFD    OREQ '#1RDCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #1RDCD' defaulted for 'Date Method Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0072' defaulted for 'Date Method Description'.
     C                     CALL 'PDZZSRR'              90  SEL OMS Mkt Dat
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0518  30       Company Number
     C           #1RDCD    PARM #1RDCD    WQ0519  3        Date Method Cod
     C           YL0072    PARM *BLANK    WQ0520 30        Date Method Des
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZZSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9836  *
     C                     END
      *
     C           #1RDCD    IFNE *BLANK                     Date Method Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RDCD    IFEQ *BLANK                     Date Method Cod
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIRDCD           Date Method Cod
      * Setup key
     C                     Z-ADD#1AIC3    WIAIC3
     C                     MOVEL#1RDCD    WIRDCD
     C           KLVEWI    CHAIN@IPRERT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Market Date Method     NF'
     C                     MOVEL'USR1681' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1681' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q7CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1Q7CD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #1Q7CD' defaulted for 'Price Method Code'.
     C                     CALL 'PDZDSRR'              90  SEL PD Price Me
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0521  30       Company Number
     C           #1Q7CD    PARM #1Q7CD    WQ0522  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9835  *
     C                     END
      *
     C           #1Q7CD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q7CD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFIH    KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3
     C                     MOVEL#1Q7CD    IHQ7CD
     C           KLVFIH    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1CRCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1CRCD' defaulted for 'U_M_Base Price'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1CRCD    PARM #1CRCD    WQ0523  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1CRCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CRCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGAM    KLIST
     C                     KFLD           AMHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1CRCD    AMHHCD
     C           KLVGAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1AGCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AGCD' defaulted for 'U_M_Ordered'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0524  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAM    KLIST
     C                     KFLD           AMHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1AGCD    AMHHCD
     C           KLVHAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVIAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1HICD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0073' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  Zzz Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0073    PARM YL0073    WQ0525  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1HICD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HICD    IFEQ *BLANK                     Quality Level
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1HICD    AIHICD
     C           KLVJAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1RNCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0073' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  Zzz Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0073    PARM YL0073    WQ0526  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RNCD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RNCD    IFEQ *BLANK                     Quality Level
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1RNCD    AIHICD
     C           KLVKAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ROCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1ROCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0073' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  Zzz Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0073    PARM YL0073    WQ0527  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1ROCD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ROCD    IFEQ *BLANK                     Quality Level
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1ROCD    AIHICD
     C           KLVLAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Country Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1KXCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'OMZASRR'              90  SEL Select Coun
     C                     PARM *BLANK    W0RTN   7
     C           #1KXCD    PARM #1KXCD    WQ0528  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMZASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1KXCD    IFEQ *BLANK                     Country Code
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVME5    KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVEL#1KXCD    E5KXCD
     C           KLVME5    CHAIN@E5REB8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Country Master         NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1158' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0529  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLVNEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0530  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVOJE    CHAIN@JEREWF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Ham Group Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1A1AA'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1A1AA' defaulted for 'Ham Group Number'.
     C                     CLEARPGRC
     C                     Z-ADD#1A1AA    PGA1AA           Ham Group Numbe
      *
     C                     CALL 'PDWCXFR'              90  SEL Ham Group
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             KEY: Ham Group
      *
     C                     Z-ADDPGA1AA    #1A1AA           Ham Group Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9840  *
     C                     END
      *
     C           #1A1AA    IFNE *ZERO                      Ham Group Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VPEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1A1AA    IFEQ *ZERO                      Ham Group Numbe
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPWJ    KLIST
     C                     KFLD           WJA1AA           Ham Group Numbe
      * Setup key
     C                     Z-ADD#1A1AA    WJA1AA
     C           KLVPWJ    CHAIN@M0REZH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Ham Group Master       NF'
     C                     MOVEL'USR2837' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2837' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0670  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0671  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQ999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVQBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C                     Z-ADD#2C4NB    BEC4NB
     C           KLVQBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELBEXIST    #2XIST           Credit Hold
     C                     MOVELBEXJST    #2XJST           Production Hold
     C                     MOVELBEGWST    #2GWST           Header Status
     C                     MOVELBEJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDBERMNB    #2RMNB           Load ID
     C                     MOVELBEU2ST    #2U2ST           Export Status
     C                     MOVELBEHNNA    #2HNNA           Ship To City
     C                     MOVELBEDBCD    #2DBCD           Ship To State C
     C                     Z-ADDBEEIDT    #2EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #2AFTM           Requested Deliv
     C                     MOVELBEGJST    #2GJST           Order in Use
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
     C           VQ999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 04096
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  16        W0CSRR  50
     C           ZZSFM     IFEQ '0'
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ELSE
     C                     Z-ADD0         ZINPOS
     C                     ENDIF
     C                     ADD  16        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD16        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C           ZZSFM     IFEQ '0'
     C                     Z-ADD2         ZHRLEN  40
     C                     ELSE
     C                     Z-ADD1         ZHRLEN
     C                     ENDIF
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDGE062
     C           ZHCSCL    ANDLE064
     C           *IN67     ANDEQ'0'
     C                     MOVEL'#1Q7CD'  YPMTFD           Price Method Co
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDGE066
     C           ZHCSCL    ANDLE068
     C           *IN67     ANDEQ'0'
     C                     MOVEL'#1RDCD'  YPMTFD           Date Method Cod
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDGE089
     C           ZHCSCL    ANDLE091
     C           *IN67     ANDEQ'0'
     C                     MOVEL'#1LQCD'  YPMTFD           Commodity Marke
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDGE093
     C           ZHCSCL    ANDLE095
     C           *IN67     ANDEQ'0'
     C                     MOVEL'#1A1AA'  YPMTFD           Ham Group Numbe
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDEQ104
     C           *IN70     ANDEQ'0'
     C                     MOVEL'#1VEST'  YPMTFD           Palletize
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDEQ113
     C           *IN70     ANDEQ'0'
     C                     MOVEL'#1VGST'  YPMTFD           Slip Sheet
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDGE117
     C           ZHCSCL    ANDLE119
     C           *IN70     ANDEQ'0'
     C                     MOVEL'#1F7SX'  YPMTFD           OD Price Type
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDEQ122
     C           *IN64     ANDEQ'0'
     C                     MOVEL'#1HPST'  YPMTFD           OD MPR Prc Read
     C                     END
      *
     C           ZHF4RW    IFEQ 016
     C           ZHCSCL    ANDEQ129
     C           *IN63     ANDEQ'0'
     C                     MOVEL'#ROWSC'  YPMTFD           OD Production P
     C                     END
      *
     C           ZHF4RW    IFEQ 017
     C           ZHCSCL    ANDEQ119
     C           *IN62     ANDEQ'0'
     C                     MOVEL'#1H2ST'  YPMTFD           OD Spot Buy
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
      * USER: Exit program processing
      * Disable *Exit key
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     P1ANC7           AR Customer Num
     C                     Z-ADD*ZERO     P1B0C7           Bill to Custome
     C                     MOVEL*BLANK    P1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P1A0DT           Order Date
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     MOVEL*BLANK    P1GTST           Comment Print A
     C                     MOVEL*BLANK    P1GVST           Comment Print I
     C                     MOVEL*BLANK    P1GUST           Comment Print P
     C                     MOVEL*BLANK    P1QFST           Comment Print S
     C                     Z-ADD*ZERO     P1AODT           Scheduled Ship
     C                     Z-ADD*ZERO     P1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P1A1WG           Order Weight To
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P1AFTM           Requested Deliv
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P1VEST           Palletize
     C                     MOVEL*BLANK    P1VFST           Shrink Wrap
     C                     MOVEL*BLANK    P1VGST           Slip Sheet
     C                     Z-ADD*ZERO     P1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     MOVEL*BLANK    P1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P1JPCD           Event Code
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1OBST           Billing Activit
     C                     MOVEL*BLANK    P1BCST           Block Order Fla
     C                     MOVEL*BLANK    P1FSSX           Broker Order St
     C                     MOVEL*BLANK    P1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    P1FXSX           HPB Ship to War
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5EXDT           Market Pricing
     C                     MOVEL*BLANK    P5LQCD           Commodity Marke
     C                     MOVEL*BLANK    P5RDCD           Date Method Cod
     C                     MOVEL*BLANK    P5Q7CD           Price Method Co
     C                     MOVEL*BLANK    P5RPCD           Age Code
     C                     Z-ADD*ZERO     P5AVQT           Quantity Ordere
     C                     MOVEL*BLANK    P5AMST           Affect Inventor
     C                     MOVEL*BLANK    P5ANST           Affect Sales Do
     C                     MOVEL*BLANK    P5VAST           Affect Sales Pn
     C                     MOVEL*BLANK    P5F5SX           OD Pallet Type
     C                     Z-ADD*ZERO     P5NWDT           OD Price Type R
     C                     Z-ADD*ZERO     P5RINY           Item Age Days
     C                     Z-ADD*ZERO     P5TIDT           Production Ovr
     C                     Z-ADD*ZERO     P5TJDT           Production Ovr
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6DQCD           Enterprise Code
     C                     MOVEL*BLANK    P6DRCD           Enterprise Code
     C                     MOVEL*BLANK    P6BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P6B8NA           System Date For
     C                     MOVEL*BLANK    P6AJVN           User Profile Na
     C                     MOVEL*BLANK    P6I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P6MPNA           Default Printer
     C                     MOVEL*BLANK    P6O1ST           Live with TPM
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7TFNB           Transportation
     C                     MOVEL*BLANK    P7R4ST           USR Update Flag
     C                     MOVEL*BLANK    P7TMST           USR First Time
     C                     MOVEL*BLANK    P7BRST           Inventory Statu
     C                     MOVEL*BLANK    P7GGST           USR Display fie
     C                     Z-ADD*ZERO     P7AUDT           Effective Date
     C                     Z-ADD*ZERO     P7CWDT           End Date Effect
     C                     Z-ADD*ZERO     P7DQQT           Maximum Quantit
     C                     Z-ADD*ZERO     P7GBDT           Contract Mkt Pr
     C                     Z-ADD*ZERO     P7HFQT           Quantity Sold
     C                     MOVEL*BLANK    P7V8ST           Price Method Ty
     C                     MOVEL*BLANK    P7OEST           Affect Inventor
     C                     MOVEL*BLANK    P7OFST           Affect Sales Do
     C                     MOVEL*BLANK    P7VBST           Affect Sales Pn
     C                     MOVEL*BLANK    P7X8ST           Affect Accruals
     C                     MOVEL*BLANK    P7QKST           Display Flag
     C                     MOVEL*BLANK    P7               OD Price Type R
     C                     MOVEL*BLANK    P7F7SX           OD Price Type
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8WDST           Cntrt Enter no
     C                     MOVEL*BLANK    P8WEST           Cntrt.# does no
     C                     MOVEL*BLANK    P8WFST           Qty ordered > C
     C                     MOVEL*BLANK    P8WGST           Contract Expire
     C                     MOVEL*BLANK    P8WHST           Price Override
     C                     MOVEL*BLANK    P8WIST           Price Method QT
     C                     MOVEL*BLANK    P8WJST           Prc Code FRM or
     C                     MOVEL*BLANK    P8WKST           Mkt Pricing Dat
     C                     MOVEL*BLANK    P8WLST           Mkt Meth. and D
     C                     MOVEL*BLANK    P8WMST           Price Override
     C                     MOVEL*BLANK    P8XSST           Contract Exists
     C                     MOVEL*BLANK    P8YXST           Price Override
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9HSST           Allow Mult Whse
     C                     MOVEL*BLANK    P9AMEO           Allow Multi Exp
     C                     MOVEL*BLANK    P9YJSX           Company Organiz
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Define work field Prc Ovr Output Only Usr
     C                     MOVEL*BLANK    WUYFSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKPR           Accrual Rate
     C                     Z-ADD*ZERO     WAHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Description Usr - 50
     C                     MOVEL*BLANK    WUHPT1 50
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Price Start Date
     C                     Z-ADD*ZERO     WUPLDT  70
      * Define work field Price End Date
     C                     Z-ADD*ZERO     WUPMDT  70
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR Hold Description
     C                     MOVEL*BLANK    WUCUNA 30
      * Define work field USR Description
     C                     MOVEL*BLANK    WUJNNA 30
      * Define work field Affect Brokerage Default
     C                     MOVEL*BLANK    WUPYST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A_R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Successful Completion USR
     C                     MOVEL*BLANK    WUACSX  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Define work field Status Flag 2  Y/N
     C                     MOVEL*BLANK    WUQ2ST  1
      * Define work field Status Flag 3  Y/N
     C                     MOVEL*BLANK    WUQ3ST  1
      * Define work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    WUFMST  1
      * Define work field Status Flag 5  Y/N
     C                     MOVEL*BLANK    WUAJTX  1
      * Define work field Status Flag 7  Y/N
     C                     MOVEL*BLANK    WUAKTX  1
      * Define work field Status Flag 8  Y/N
     C                     MOVEL*BLANK    WUAFTX  1
      * Define work field Status Flag 12 Y/N
     C                     MOVEL*BLANK    WUDITX  1
      * Define work field Email to Warehouse Code
     C                     MOVEL*BLANK    WURJAA  3
      * Define work field Status Flag 6  Y/N
     C                     MOVEL*BLANK    WUACTX  1
      * Define work field Email Selection usr
     C                     MOVEL*BLANK    WUVQSX  1
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Number of Copies
     C                     Z-ADD*ZERO     WUDYNB  20
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field Paper Type USR
     C                     MOVEL*BLANK    WUA7ST  1
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Email To Whs
     C                     MOVEL*BLANK    WUQ5ST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field Status Flag 19 Y/N
     C                     MOVEL*BLANK    WUDTTX  1
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Price Status USR
     C                     MOVEL*BLANK    WUYBST  1
      * Define work field Default Commod Mark basis
     C                     MOVEL*BLANK    WULNCD  3
      * Define work field Transportation Temp
     C                     Z-ADD*ZERO     WUTFNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Commodity Price Group
     C                     MOVEL*BLANK    WULRCD  7
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Price Method Code
     C                     MOVEL*BLANK    WUQ7CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Variety_Rendered_Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     WUAGCS 114
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field Warehouse Type USR
     C                     MOVEL*BLANK    WUR6ST  2
      * Define work field Warehouse Code Transfer
     C                     MOVEL*BLANK    WUIWCD  3
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCDPC7           Ham Group Item
     C                     Z-ADD*ZERO     WCJJNX           Ham Group Item
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDEQDT           Market Price Da
     C                     Z-ADD*ZERO     WDA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WDB8PR           Projected Marke
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Contract Number
     C                     Z-ADD*ZERO     WUL6NB  70
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAUDT           Effective Date
     C                     Z-ADD*ZERO     WECWDT           End Date Effect
     C                     Z-ADD*ZERO     WEANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WEDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WEHFQT           Quantity Sold
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEFSQT           Open Commitment
     C                     Z-ADD*ZERO     WEB0PR           Contract Price
     C                     Z-ADD*ZERO     WEGBDT           Contract Mkt Pr
     C                     Z-ADD*ZERO     WEGCDT           Entered Date
     C                     Z-ADD*ZERO     WEGDDT           Date Sold
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFRMNY           Decimal Places
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Total Quantity Ordered
     C                     Z-ADD*ZERO     WUCAQT 112
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WHBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WHBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WHBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WHBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WICPRD           CTL Prior Day
     C                     Z-ADD*ZERO     WIQMNB           CTL Prior Week
     C                     Z-ADD*ZERO     WICNOT           CTL Number of T
     C                     Z-ADD*ZERO     WICDOW           CTL Day of Week
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJH5WG           Default Start W
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKDIC7           ED Item Code
     C                     Z-ADD*ZERO     WKHJWG           ED Product Net
     C                     Z-ADD*ZERO     WKHKWG           ED Product Net
     C                     Z-ADD*ZERO     WKAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WKAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WKANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WKAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WKDKPR           ED Product Unit
     C                     Z-ADD*ZERO     WKA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WKAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WKW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     WUUENB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WLMAVA           Billing Detail
     C                     Z-ADD*ZERO     WLKDVA           Billing Detail
     C                     Z-ADD*ZERO     WLL8VA           Billing Detail
     C                     Z-ADD*ZERO     WLL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WLAYVA           Extended Amount
     C                     Z-ADD*ZERO     WLEXDT           Market Pricing
     C                     Z-ADD*ZERO     WLBZPR           Price Overage O
     C                     Z-ADD*ZERO     WLL6NB           Contract Number
     C                     Z-ADD*ZERO     WLGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
     C                     Z-ADD*ZERO     WLAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WLD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WLCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WLAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WLCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WLATWG           Weight Shipped
     C                     Z-ADD*ZERO     WLAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLAKPR           Unit Price
     C                     Z-ADD*ZERO     WLALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WLAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WLAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WLA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WLA5DT           Requested Ship
     C                     Z-ADD*ZERO     WLAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WLGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLCXDT           Date of Origina
     C                     Z-ADD*ZERO     WLDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WLB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WLA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WLNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WLNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WLNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WLNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WLNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WLBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WLBVTM           Price Code
     C                     Z-ADD*ZERO     WLBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WLBXTM           Substitution Li
     C                     Z-ADD*ZERO     WLBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WLH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WLH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WLH7NX           OD Item Target
     C                     Z-ADD*ZERO     WLH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WLH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WLDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WLDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WLDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WLDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WLDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WLGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WLGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WLGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WLPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WLRINY           Item Age Days
     C                     Z-ADD*ZERO     WLTIDT           Production Ovr
     C                     Z-ADD*ZERO     WLTJDT           Production Ovr
     C                     Z-ADD*ZERO     WLTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WLTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WLTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field USR Order Value
     C                     Z-ADD*ZERO     WUJSVA 112
      * Define work field USR Order Weight
     C                     Z-ADD*ZERO     WUAYWG 112
      * Define work field USR Quantity
     C                     Z-ADD*ZERO     WUBAQT 112
      * Define work field USR Status (Y/N)
     C                     MOVEL*BLANK    WUE6ST  1
      * Define work field Quantity Ordered
     C                     Z-ADD*ZERO     WUAVQT 112
      * Define work field Quantity Scheduled
     C                     Z-ADD*ZERO     WUCCQT 112
      * Define work field Quantity Backordered
     C                     Z-ADD*ZERO     WUAPQT 112
      * Define work field Detail Line Status Last
     C                     MOVEL*BLANK    WUGNST  1
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Define work field Substitution Flag
     C                     MOVEL*BLANK    WUPRST  1
      * Clear all neither parameters
      * CRT PD Order Detail    CR - Order Detail  * 
     C                     Z-ADD*ZERO     OMAATM           Job Time
     C                     Z-ADD*ZERO     OMAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMR5NB           Deliver after t
     C                     Z-ADD*ZERO     WMR6NB           Deliver before
     C                     Z-ADD*ZERO     WMTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WMMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WMW2NB           Co_Cust Overage
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field User Code Model
     C                     MOVEL*BLANK    WUBUVN 10
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  1
     C                     Z-ADD*ZERO     WL0017  70
      * Define local variables for subroutine TERVGN.
     C                     MOVEL*BLANK    WL0018  3
     C                     MOVEL*BLANK    WL0019  7
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021 114
     C                     Z-ADD*ZERO     WL0022  70
      * Define local variables for subroutine TGRVGN.
     C                     MOVEL*BLANK    WL0023  3
     C                     MOVEL*BLANK    WL0024  7
      * Define local variables for subroutine TORVGN.
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  30
      * Define local variables for subroutine TQDLRC.
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  30
      * Define local variables for subroutine TUCHRC.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  30
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038  3
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046 112
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     Z-ADD*ZERO     WL0051 112
     C                     Z-ADD*ZERO     WL0052  70
     C                     MOVEL*BLANK    WL0053  3
     C                     MOVEL*BLANK    WL0054  3
     C                     MOVEL*BLANK    WL0055  3
     C                     Z-ADD*ZERO     WL0056 114
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  1
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060  2
     C                     MOVEL*BLANK    WL0061  2
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065 30
     C                     MOVEL*BLANK    WL0066 30
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  1
     C                     MOVEL*BLANK    WL0069  1
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  1
     C                     MOVEL*BLANK    WL0072  3
     C                     MOVEL*BLANK    WL0073  1
     C                     Z-ADD*ZERO     WL0074 112
     C                     Z-ADD*ZERO     WL0075 112
     C                     Z-ADD*ZERO     WL0076 112
     C                     Z-ADD*ZERO     WL0077 112
     C                     Z-ADD*ZERO     WL0078 112
     C                     Z-ADD*ZERO     WL0079 112
     C                     Z-ADD*ZERO     WL0080 112
     C                     Z-ADD*ZERO     WL0081 114
     C                     Z-ADD*ZERO     WL0082 114
     C                     Z-ADD*ZERO     WL0083 114
     C                     Z-ADD*ZERO     WL0084 114
     C                     Z-ADD*ZERO     WL0085 114
     C                     Z-ADD*ZERO     WL0086 112
     C                     Z-ADD*ZERO     WL0087 112
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  70
     C                     MOVEL*BLANK    WL0091  1
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     Z-ADD*ZERO     WL0094  30
     C                     Z-ADD*ZERO     WL0095  30
     C                     Z-ADD*ZERO     WL0096  30
     C                     MOVEL*BLANK    WL0097  2
     C                     MOVEL*BLANK    WL0098  2
     C                     MOVEL*BLANK    WL0099  2
     C                     MOVEL*BLANK    WL0100  2
     C                     Z-ADD*ZERO     WL0101  70
     C                     MOVEL*BLANK    WL0102 10
     C                     MOVEL*BLANK    WL0103  6
     C                     MOVEL*BLANK    WL0104  2
     C                     MOVEL*BLANK    WL0105  3
     C                     MOVEL*BLANK    WL0106  3
     C                     MOVEL*BLANK    WL0107  1
     C                     MOVEL*BLANK    WL0108  1
     C                     MOVEL*BLANK    WL0109  1
     C                     Z-ADD*ZERO     WL0110 114
     C                     Z-ADD*ZERO     WL0111 112
     C                     Z-ADD*ZERO     WL0112  30
     C                     MOVEL*BLANK    WL0113  1
     C                     MOVEL*BLANK    WL0114  1
     C                     MOVEL*BLANK    WL0115  1
     C                     MOVEL*BLANK    WL0116  1
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  2
     C                     MOVEL*BLANK    WL0119  2
     C                     MOVEL*BLANK    WL0120  3
     C                     MOVEL*BLANK    WL0121  3
     C                     Z-ADD*ZERO     WL0122  70
     C                     Z-ADD*ZERO     WL0123  70
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  70
     C                     Z-ADD*ZERO     WL0126  70
     C                     Z-ADD*ZERO     WL0127  60
     C                     Z-ADD*ZERO     WL0128  60
     C                     Z-ADD*ZERO     WL0129  60
     C                     Z-ADD*ZERO     WL0130  60
     C                     Z-ADD*ZERO     WL0131  60
     C                     Z-ADD*ZERO     WL0132 112
     C                     Z-ADD*ZERO     WL0133 112
     C                     Z-ADD*ZERO     WL0134 112
     C                     Z-ADD*ZERO     WL0135 112
     C                     Z-ADD*ZERO     WL0136 112
     C                     Z-ADD*ZERO     WL0137 114
     C                     Z-ADD*ZERO     WL0138 114
     C                     Z-ADD*ZERO     WL0139 114
     C                     Z-ADD*ZERO     WL0140 114
     C                     Z-ADD*ZERO     WL0141 114
     C                     Z-ADD*ZERO     WL0142 114
     C                     Z-ADD*ZERO     WL0143 114
     C                     Z-ADD*ZERO     WL0144 114
     C                     MOVEL*BLANK    WL0145  1
     C                     MOVEL*BLANK    WL0146  1
     C                     MOVEL*BLANK    WL0147  1
     C                     Z-ADD*ZERO     WL0148 112
     C                     Z-ADD*ZERO     WL0149  40
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  70
     C                     MOVEL*BLANK    WL0152  1
     C                     MOVEL*BLANK    WL0153  2
     C                     MOVEL*BLANK    WL0154  3
     C                     Z-ADD*ZERO     WL0155  70
     C                     Z-ADD*ZERO     WL0156  70
     C                     Z-ADD*ZERO     WL0157  70
     C                     MOVEL*BLANK    WL0158  1
     C                     MOVEL*BLANK    WL0159  1
     C                     MOVEL*BLANK    WL0160  1
      * Define local variables for subroutine TWRVGN.
     C                     MOVEL*BLANK    WL0161  3
     C                     MOVEL*BLANK    WL0162  3
     C                     Z-ADD*ZERO     WL0163  30
      * Define null work field Order Type_Sales
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field AR Customer Number
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0007 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YN0009 11
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0011 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0012 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0013 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0014 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0015  2
      * Define null work field Bill to Zip_Postal Code
     C                     MOVEL*BLANK    YN0016 11
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0017  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0018  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0020  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0021  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0022 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0023 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0024  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Comment Print Inv_Cr_Memo
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0030  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0035 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0036  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0037 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0038 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0043  40
      * Define null work field Accounts Receiv_Ent 1
     C                     MOVEL*BLANK    YN0044  4
      * Define null work field Accounts Receiv_Ent 2
     C                     MOVEL*BLANK    YN0045 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0046  70
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0001  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0047 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0051  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0052  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0055  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0056  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0057  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0058  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0059  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0062  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0063 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0064 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0066  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0067  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0068  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0069  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0070  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0071  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0072  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0073  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0074  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0075  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field A_R order Value Total
     C                     Z-ADD*ZERO     YN0077 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0078  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0079  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0080  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0081 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0082  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0083  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0085  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Export Docs Go w_Driver
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field Shipping Temp Code C_F
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0093  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0094  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0095  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0096  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0097  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0098  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0099  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0100  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0101  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0102  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0103  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0104  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0105  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0106  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0107 112
      * Define null work field Act Non_Ref Frt Amount
     C                     Z-ADD*ZERO     YN0108 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0109 112
      * Define null work field OH Total Non_Ref Frt Amt
     C                     Z-ADD*ZERO     YN0110 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0111 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0112  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0113  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0114  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0115  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0116  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0117 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0118 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0119  70
      * Define null work field Order Sequence Number
     C                     Z-ADD*ZERO     YN0120  30
      * Define null work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YN0121  30
      * Define null work field Item Code
     C                     Z-ADD*ZERO     YN0122  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0123  3
      * Define null work field Order Group Code
     C                     Z-ADD*ZERO     YN0124  70
      * Define null work field Detail Line Status
     C                     MOVEL*BLANK    YN0125  1
      * Define null work field Detail Line Status Last
     C                     MOVEL*BLANK    YN0126  1
      * Define null work field Billing Detail Cost Dol
     C                     Z-ADD*ZERO     YN0127 112
      * Define null work field Billing Detail Gross Dol
     C                     Z-ADD*ZERO     YN0128 112
      * Define null work field Billing Detail Net Dol
     C                     Z-ADD*ZERO     YN0129 112
      * Define null work field Quantity to Substitute
     C                     Z-ADD*ZERO     YN0130 112
      * Define null work field Extended Amount
     C                     Z-ADD*ZERO     YN0131 112
      * Define null work field Market Pricing Date
     C                     Z-ADD*ZERO     YN0132  70
      * Define null work field Commodity Market Code
     C                     MOVEL*BLANK    YN0133  3
      * Define null work field Date Method Code
     C                     MOVEL*BLANK    YN0134  3
      * Define null work field Price Method Code
     C                     MOVEL*BLANK    YN0135  3
      * Define null work field Price Overage Override
     C                     Z-ADD*ZERO     YN0136 114
      * Define null work field Contract Number
     C                     Z-ADD*ZERO     YN0137  70
      * Define null work field Pricing Date Used
     C                     Z-ADD*ZERO     YN0138  70
      * Define null work field U_M_Base Price
     C                     MOVEL*BLANK    YN0139  2
      * Define null work field U_M_Ordered
     C                     MOVEL*BLANK    YN0140  2
      * Define null work field Work Confirm Status
     C                     MOVEL*BLANK    YN0141  1
      * Define null work field Work Over_Short Status
     C                     MOVEL*BLANK    YN0142  1
      * Define null work field OD Production Plan Sts
     C                     MOVEL*BLANK    YN0143  1
      * Define null work field Order Desc_Line One
     C                     MOVEL*BLANK    YN0144 30
      * Define null work field Order Desc_Line Two
     C                     MOVEL*BLANK    YN0145 30
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0146  1
      * Define null work field Price Audit Reason Code
     C                     MOVEL*BLANK    YN0147  3
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0148  1
      * Define null work field Quantity Ordered
     C                     Z-ADD*ZERO     YN0149 112
      * Define null work field Weight Ordered
     C                     Z-ADD*ZERO     YN0150 112
      * Define null work field Quantity Scheduled
     C                     Z-ADD*ZERO     YN0151 112
      * Define null work field Weight Scheduled
     C                     Z-ADD*ZERO     YN0152 112
      * Define null work field Quantity Shipped Total
     C                     Z-ADD*ZERO     YN0153 112
      * Define null work field Weight Shipped Total
     C                     Z-ADD*ZERO     YN0154 112
      * Define null work field Unit Cost Pricing U_M
     C                     Z-ADD*ZERO     YN0155 114
      * Define null work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     YN0156 114
      * Define null work field Unit Price
     C                     Z-ADD*ZERO     YN0157 114
      * Define null work field Unit Price_Credit
     C                     Z-ADD*ZERO     YN0158 114
      * Define null work field Unit Price Ordered U_M
     C                     Z-ADD*ZERO     YN0159 114
      * Define null work field Unit Weight Ordered U_M
     C                     Z-ADD*ZERO     YN0160 112
      * Define null work field Tare Weight Total
     C                     Z-ADD*ZERO     YN0161 112
      * Define null work field Affect Inventory Status
     C                     MOVEL*BLANK    YN0162  1
      * Define null work field Affect Sales Doll Status
     C                     MOVEL*BLANK    YN0163  1
      * Define null work field Affect Sales Pnds Status
     C                     MOVEL*BLANK    YN0164  1
      * Define null work field Item Structure Type Code
     C                     Z-ADD*ZERO     YN0165  30
      * Define null work field Item Structure Group Code
     C                     Z-ADD*ZERO     YN0166  30
      * Define null work field Item Structure Class Code
     C                     Z-ADD*ZERO     YN0167  30
      * Define null work field Item Level
     C                     MOVEL*BLANK    YN0168  2
      * Define null work field Quality Level
     C                     MOVEL*BLANK    YN0169  2
      * Define null work field Pricing Product Class Rep
     C                     MOVEL*BLANK    YN0170  2
      * Define null work field Season Product Class Repo
     C                     MOVEL*BLANK    YN0171  2
      * Define null work field User Profile Name
     C                     MOVEL*BLANK    YN0172 10
      * Define null work field Country Code
     C                     MOVEL*BLANK    YN0173  6
      * Define null work field Substituted Flag
     C                     MOVEL*BLANK    YN0174  1
      * Define null work field OD Schedule Override Sts
     C                     MOVEL*BLANK    YN0175  1
      * Define null work field Invoice Unit Price
     C                     Z-ADD*ZERO     YN0176 114
      * Define null work field Invoice Extended Amt
     C                     Z-ADD*ZERO     YN0177 112
      * Define null work field Ham Group Number
     C                     Z-ADD*ZERO     YN0178  30
      * Define null work field OD Adj Type Override
     C                     MOVEL*BLANK    YN0179  1
      * Define null work field Affect Trade Fund
     C                     MOVEL*BLANK    YN0180  1
      * Define null work field Affect Commission
     C                     MOVEL*BLANK    YN0181  1
      * Define null work field Affect Pricing
     C                     MOVEL*BLANK    YN0182  1
      * Define null work field Released by User Sts Y_N
     C                     MOVEL*BLANK    YN0183  1
      * Define null work field Ord TF Exempt Code
     C                     MOVEL*BLANK    YN0184  2
      * Define null work field OD Pallet Type
     C                     MOVEL*BLANK    YN0185  2
      * Define null work field Production Warehouse
     C                     MOVEL*BLANK    YN0186  3
      * Define null work field OD Price Type
     C                     MOVEL*BLANK    YN0187  3
      * Define null work field Warehouse Pallets Loaded
     C                     Z-ADD*ZERO     YN0188  70
      * Define null work field Consumed Item Code
     C                     Z-ADD*ZERO     YN0189  70
      * Define null work field OD Price Type Ref Num
     C                     Z-ADD*ZERO     YN0190  70
      * Define null work field OD Firm Date
     C                     Z-ADD*ZERO     YN0191  70
      * Define null work field Price Code
     C                     Z-ADD*ZERO     YN0192  60
      * Define null work field Maximum Net Weight
     C                     Z-ADD*ZERO     YN0193  60
      * Define null work field Substitution Line Number
     C                     Z-ADD*ZERO     YN0194  60
      * Define null work field Max Qty to sched per day
     C                     Z-ADD*ZERO     YN0195  60
      * Define null work field Warehouse Pallet Tare
     C                     Z-ADD*ZERO     YN0196 112
      * Define null work field Warehouse Avg Pallet Tare
     C                     Z-ADD*ZERO     YN0197 112
      * Define null work field OD Item Target Price
     C                     Z-ADD*ZERO     YN0198 112
      * Define null work field OD Estimated Gross Weight
     C                     Z-ADD*ZERO     YN0199 112
      * Define null work field OD Maximum Unit Weight
     C                     Z-ADD*ZERO     YN0200 112
      * Define null work field Order Gate_Final Price
     C                     Z-ADD*ZERO     YN0201 114
      * Define null work field OD Ceiling Price
     C                     Z-ADD*ZERO     YN0202 114
      * Define null work field OD Gate_Final Price Adj
     C                     Z-ADD*ZERO     YN0203 114
      * Define null work field OD Weighted Avg Price
     C                     Z-ADD*ZERO     YN0204 114
      * Define null work field OD Original Ordered Qty
     C                     Z-ADD*ZERO     YN0205 114
      * Define null work field OD Cancel Date
     C                     Z-ADD*ZERO     YN0206 114
      * Define null work field OD Unused Prc 7
     C                     Z-ADD*ZERO     YN0207 114
      * Define null work field OD Unused Prc 8
     C                     Z-ADD*ZERO     YN0208 114
      * Define null work field OD MPR Sent to USDA Sts
     C                     MOVEL*BLANK    YN0209  1
      * Define null work field OD MPR Prc Ready to Send
     C                     MOVEL*BLANK    YN0210  1
      * Define null work field OD UnUsed Price Sts 3
     C                     MOVEL*BLANK    YN0211  1
      * Define null work field Weight Amount Entered
     C                     Z-ADD*ZERO     YN0212 112
      * Define null work field Item Age Days
     C                     Z-ADD*ZERO     YN0213  40
      * Define null work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     YN0214  70
      * Define null work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     YN0215  70
      * Define null work field OD Spot Buy
     C                     MOVEL*BLANK    YN0216  1
      * Define null work field OD Clm Full Return to Plt
     C                     MOVEL*BLANK    YN0217  2
      * Define null work field Order Line Error Type
     C                     MOVEL*BLANK    YN0218  3
      * Define null work field OD Market Begin Date
     C                     Z-ADD*ZERO     YN0219  70
      * Define null work field OD Market Ending Date
     C                     Z-ADD*ZERO     YN0220  70
      * Define null work field OD Atch to Ord ActShpDte
     C                     Z-ADD*ZERO     YN0221  70
      * Define local work field Cust Accrual Found USR
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0222 30
      * Define null work field Automatic Accrual_Y_N
     C                     MOVEL*BLANK    YN0223  1
      * Define null work field Print On Invoice_Y_N
     C                     MOVEL*BLANK    YN0224  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0225  1
      * Define null work field Add-on_Allowance
     C                     MOVEL*BLANK    YN0226  1
      * Define local work field Accrual Type
     C                     MOVEL*BLANK    YL0003  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0227  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0228  3
      * Define null work field UOM Primary Dft
     C                     MOVEL*BLANK    YN0229  2
      * Define local work field Affect Invoice Price
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field USR Display 1
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Contract Status
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Discounts Exists USR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field USR Country Code
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field User Code Model
     C                     MOVEL*BLANK    YL0011 10
      * Define null work field Produce on Sunday Sts
     C                     MOVEL*BLANK    YN0230  1
      * Define null work field Produce on Monday Sts
     C                     MOVEL*BLANK    YN0231  1
      * Define null work field Produce on Tuesday Sts
     C                     MOVEL*BLANK    YN0232  1
      * Define null work field Produce on Wednesday Sts
     C                     MOVEL*BLANK    YN0233  1
      * Define null work field Produce on Thursday Sts
     C                     MOVEL*BLANK    YN0234  1
      * Define null work field Produce on Friday Sts
     C                     MOVEL*BLANK    YN0235  1
      * Define null work field Produce on Saturday Sts
     C                     MOVEL*BLANK    YN0236  1
      * Define local work field OD Production Plan Sts
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field Allocation Method
     C                     MOVEL*BLANK    YN0237  1
      * Define null work field Adjust Credit Pieces
     C                     MOVEL*BLANK    YN0238  1
      * Define null work field CIE Use Age Days over Max
     C                     MOVEL*BLANK    YN0239  2
      * Define null work field CIE MPR Report to USDA
     C                     MOVEL*BLANK    YN0240  2
      * Define null work field CIE Unused Number
     C                     Z-ADD*ZERO     YN0241 112
      * Define null work field CIE Unused Number 2
     C                     Z-ADD*ZERO     YN0242 110
      * Define null work field CIE Unused Date
     C                     Z-ADD*ZERO     YN0243  70
      * Define null work field CIE TPM Equipment Code
     C                     MOVEL*BLANK    YN0244 25
      * Define null work field CIE Capacity Code
     C                     MOVEL*BLANK    YN0245  6
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0246  1
      * Define local work field USR Return Code
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field Weight Allocated USR
     C                     Z-ADD*ZERO     YL0017  92
      * Define local work field Price Start Date
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Price End Date
     C                     Z-ADD*ZERO     YL0019  70
      * Define null work field PM Description
     C                     MOVEL*BLANK    YN0247 15
      * Define null work field Record Found USR
     C                     MOVEL*BLANK    YN0248  1
      * Define local work field Cust Dft Price Type
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field ST02-TRANS SET CONTROL NU
     C                     Z-ADD*ZERO     YL0021  90
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0022  6
      * Define local work field Item Code Txt
     C                     MOVEL*BLANK    YL0023  7
      * Define local work field G6806/P109 PRODUCT ID
     C                     MOVEL*BLANK    YL0024 10
      * Define local work field G6804/P107 UPC/GTIN CODE
     C                     MOVEL*BLANK    YL0025 15
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0026  7
      * Define local work field First time flag 3
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0028  4
      * Define local work field PM Pallet Type
     C                     MOVEL*BLANK    YL0029  2
      * Define local work field OH Load Plan Ready
     C                     MOVEL*BLANK    YL0030  2
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0031 30
      * Define local work field Email to Broker Usr
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field Email to Salesperson Usr
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Price Code
     C                     Z-ADD*ZERO     YL0034  60
      * Define local work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    YL0035  1
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0249 30
      * Define null work field UOM Primary
     C                     MOVEL*BLANK    YN0250  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0251  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0252  1
      * Define null work field UOM Second
     C                     MOVEL*BLANK    YN0253  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0254  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0255  1
      * Define null work field UOM Third
     C                     MOVEL*BLANK    YN0256  2
      * Define null work field UOM Pricing
     C                     MOVEL*BLANK    YN0257  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0258 112
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0259  3
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Order Desc_Line One
     C                     MOVEL*BLANK    YL0038 30
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0039  6
      * Define local work field Sold 100 Percent Frozen
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Production AgeDte Fr
     C                     Z-ADD*ZERO     YL0042  70
      * Define local work field Production AgeDte To
     C                     Z-ADD*ZERO     YL0043  70
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0044  30
      * Define local work field Credit Item Status
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0046  2
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0260  52
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0047 30
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0048  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0049 114
      * Define local work field Standard Overage_Underage
     C                     Z-ADD*ZERO     YL0050 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0051  7
      * Define local work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     YL0052 112
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0055  7
      * Define local work field Market Prem/Ded
     C                     Z-ADD*ZERO     YL0056  94
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0058 114
      * Define local work field Price Start Date
     C                     Z-ADD*ZERO     YL0059  70
      * Define local work field Price End Date
     C                     Z-ADD*ZERO     YL0060  70
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0061 112
      * Define local work field Customer Price_UM Prc
     C                     Z-ADD*ZERO     YL0062 114
      * Define local work field Commodity Market Code USR
     C                     MOVEL*BLANK    YL0063  3
      * Define local work field Price Method Code USR
     C                     MOVEL*BLANK    YL0064  3
      * Define local work field Date Method Code USR
     C                     MOVEL*BLANK    YL0065  3
      * Define local work field Contract Unit Type
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0067 114
      * Define local work field Error Status  3
     C                     MOVEL*BLANK    YL0068  1
      * Define local work field Minimum Price   USR
     C                     Z-ADD*ZERO     YL0069 114
      * Define local work field Maximum Price  USR
     C                     Z-ADD*ZERO     YL0070 114
      * Define null work field Date Method Description
     C                     MOVEL*BLANK    YN0261 30
      * Define local work field G/L Vendor Number USR
     C                     Z-ADD*ZERO     YL0071  80
      * Define local work field Date Method Description
     C                     MOVEL*BLANK    YL0072 30
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0073  1
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0074  2
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0075  3
      * Define local work field Weight Beg Inv usr
     C                     Z-ADD*ZERO     YL0076  70
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0077  7
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0078 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0079 12
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0080  3
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0081 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0082 12
      * Define local work field Weight Beg Inv usr
     C                     Z-ADD*ZERO     YL0083  70
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0084  7
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0262  30
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0085  52
      * Define local work field Box Weight
     C                     Z-ADD*ZERO     YL0086  52
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0087  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0088  52
      * Define local work field Box iD
     C                     Z-ADD*ZERO     YL0089  70
      * Define local work field Total Tare USR
     C                     Z-ADD*ZERO     YL0090  52
      * Define local work field Weight 1.1             .U
     C                     Z-ADD*ZERO     YL0091  92
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0092  92
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0263  30
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0093  52
      * Define local work field Box Weight
     C                     Z-ADD*ZERO     YL0094  52
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0095  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0096  52
      * Define local work field Box iD
     C                     Z-ADD*ZERO     YL0097  70
      * Define local work field Total Tare USR
     C                     Z-ADD*ZERO     YL0098  52
      * Define local work field Weight 1.1             .U
     C                     Z-ADD*ZERO     YL0099  92
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0100  92
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0101  3
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0102 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0103 12
      * Define local work field Weight Beg Inv usr
     C                     Z-ADD*ZERO     YL0104  70
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0105  7
      * Define local work field Hide Screen Field USR
     C                     MOVEL*BLANK    YL0106  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0264  1
      * Define null work field CDI Valuation Grouping
     C                     MOVEL*BLANK    YN0265  1
      * Define null work field CDI Unused Sts 3
     C                     MOVEL*BLANK    YN0266  1
      * Define null work field CDI Shipper
     C                     MOVEL*BLANK    YN0267  2
      * Define null work field CDI Produced by co
     C                     MOVEL*BLANK    YN0268  2
      * Define local work field User Profile Code
     C                     MOVEL*BLANK    YL0107 10
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD08        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * *************  Max 50 files are being used!  ****************
     C                     MOVEL'1'       ZZSFM            *Subfile mode
     C                     MOVEL@CN,018   P3BYVN           Next Program Na
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NBRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * RTV Last Seq 1 Nbr     RT - Order Detail  * 
     C                     EXSR NDRVGN
      * Set program mode
      * CASE: PAR.Process Control is Process Both
     C           P2PRCT    IFEQ *BLANK                     *IF
      * Put into Add mode if this is a new order
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Process Control is Process Change
     C           P2PRCT    IFEQ 'C'                        *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     ELSE
      * CASE: PAR.Process Control is Process Add
     C           P2PRCT    IFEQ 'A'                        *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       P7TMST           USR First Time
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0672  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0673  2        Shipping Method
     C           WUG0TX    PARM *BLANK    WQ0674  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0675  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0676  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0677  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0678  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0679  6        Export Code Dft
     C           P9HSST    PARM *BLANK    WQ0680  1        Allow Mult Whse
     C           P9AMEO    PARM *BLANK    WQ0681  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0682  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0683  1        Palletize Dft
     C                     PARM *BLANK    WQ0684  1        Plant Company S
     C           P9YJSX    PARM *BLANK    WQ0685  1        Company Organiz
     C                     PARM *BLANK    WQ0686  1        CDI Valuation G
     C                     PARM *BLANK    WQ0687  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0688  2        CDI Shipper
     C                     PARM *BLANK    WQ0689  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * fp1309 slm 4/6/2010 add dates fields from the order header
      * RTV for Order Dtl Ent. RT - Order Header TRG  * 
     C                     EXSR NERVGN
      * RTV Commod. Mkt, Whse  RT - Company Customer  * 
     C                     EXSR NFRVGN
     C                     MOVEL'N'       P7GGST           USR Display fie
     C                     MOVEL'N'       P7QKST           Display Flag
      * Set OD Production Plan Sts display: only scheduling and Transfer
      *   can maintain it. Otherwise, it comes from the company item ext
      * Rtv User Code Model   XF - User Profile Control  * 
     C                     CALL 'POYBXFR'              90  Rtv User Code M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0690 10        User Profile Na
     C           YL0011    PARM *BLANK    WQ0691 10        User Code Model
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POYBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0011    WUBUVN           User Code Model
      * 06/29/18 DN S13384-Added User Code Model 'PORKSCHE5'.
      * 10/18/23 JM JM00035-Edit Order Detail Line for regular Order
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.User Code Model is Production Sched 5
      *   |- c2    : PAR.Order Type_Sales is Regular Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ @CN,005                    *IF
     C           P1JNCD    IFEQ 'OR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * user code model, or user profile and user code model = is
      * CASE:
      *  - c1 OR c3 OR c2 OR c4 OR c5
      *   |- c1    : LCL.User Code Model is Production Scheduling
      *   |- c3    : LCL.User Profile Code is Production Sched 2
      *   |- c2    : LCL.User Code Model is IS
      *   |- c4    : LCL.User Code Model is STF Prod Scheduling
      *   |- c5    : LCL.User Code Model is Production Sched 5
      *   '-
     C           YL0011    IFEQ @CN,019                    *IF
     C           YL0107    OREQ @CN,020                    *OR
     C           YL0011    OREQ @CN,021                    *OR
     C           YL0011    OREQ @CN,022                    *OR
     C           YL0011    OREQ @CN,005                    *OR
      * CASE: JOB.*USER is PRKTEST1
     C           ##USR     IFEQ @CN,023                    *IF
      * set up prktest1 to be like Sales will be
     C                     MOVEL*BLANK    YL0011           User Code Model
     C                     END                             *FI
      * Only TRansfer orders can be modified
      * CASE: PAR.Order Type - Sales is Transfer Order
     C           P1JNCD    IFEQ 'TR'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0011           User Code Model
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0011           User Code Model
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,024   CAT  @CN,025:ZQWUHPT1    P      Description Usr
      * 01/12/21 DN R17029-Hide/Display 'Spot Buy' Screen Field.
      * CASE: PAR.Company Organization is Seaboard
     C           P9YJSX    IFEQ 'S'                        *IF
     C                     MOVEL'D'       YL0106           Hide Screen Fie
     C                     ELSE
      * CASE: *OTHERWISE
      * Seaboard Energy. (aka HPB)
     C                     MOVEL'H'       YL0106           Hide Screen Fie
     C                     END                             *FI
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01045010530110001109011360114701301
01309013560139201557016120164801868
01904019150214802162023060281804098
04102041100411804126041300414304145
04148041580416204167041710417804185
04189041930419804200042030420904213
04218042210422504381044120444404471
** W0END
01047010770110601110011430115101307
01333013680139901581016240165501880
01911019220215102165023550294704098
04108041160412404128041410414304146
04156041600416404167041760418304187
04191041960419804200042040420904215
04218042210422504393044240445104471
** W0NAM
V2AIC3    #CAGTX    V2C4NB    #2JNCD    V2EIDT    #2AFTM    VPBKC7
#CBRTX    #CAVQT    VCA5DT    #CRHNA    #CD0WG    VCAODT    #CAUWG
VCNVDT    #CBUTM    #CRJNY    #CRKNY    #CHPT1    #2ST1     #1SEL
#RHHQT    #RH1QT    V1HGCD    #1AJCD    #1BZPR    #RGLST    #1CRCD
#RDTPR    #1Q7CD    #1RDCD    #RCNSZ    #1BVTM    V1EXDT    #1LQCD
#1A1AA    #1RINY    #RI0ST    #1VEST    #RQRU1    #1VGST    #1F7SX
#1HPST    #1GMST    #ROWSC    #1D0WG    #1AUWG    V1CXDT    #1H2ST
** @CN
00001 * Internal Company *
00002 * Inter-Co Sales Agrmnt *
00003 * 3rd Party *
00004 ODPRCTYPRQ
00005 PORKSCHE5
00006 DSYSCO
00007 Y2U0005
00008 Order contains items that
00009 are not in EDI PO Detail
00010 PMGFE2R
00011 PDO4EFR
00012 Print Acknowledgement
00013 Y2U9999
00014 Print Get Ready Report
00015 USR0752
00016 FZNCHLTME
00017 Y2U0003
00018 PDN9EFR
00019 PORKSCHE
00020 PORKSCHE2
00021 ISBGUTI
00022 SPMODSCHE
00023 PRKTEST1
00024 Errors are pending from u
00025 pload process
