/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - CL PROGRAM FOR SENDING THE MPR HOLIDAY FILE TO MPR  */
/*             FOLDER                                               */
/*                                                                  */
/*                                                                  */
/*  SYSTEM    - HOG PROCUREMENT AND EVALUATION                      */
/*  DATE      - 06/23/08                                            */
/*  DEVELOPER - ROSE CENTONZE                                       */
/*                                                                  */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/* RMC R14015 05/15/19 CHANGED TO NEW SERVER - CODE HERE REPLACES FTPMPRPLT */
/*             6/11/19 CHG &IDIR TO 47 LONG */
/*‚JM   05/15/25 SDN1295 - MPR Upgrade-Add new folder for Test env */
/********************************************************************/
             PGM        PARM(&PLTCO &JOBD)
             DCL        VAR(&JOBD) TYPE(*CHAR) LEN(10)  /* JOBD FOR SETLIB  */
/* WORK FIELDS */
             DCL        VAR(&DOC) TYPE(*CHAR) LEN(10) VALUE(HOLIDAY) +
                          /* HOLIDAY          */
             DCL        VAR(&PCFILE) TYPE(*CHAR) LEN(32) +
                          VALUE(HOLIDAY.XLS) /* HOLIDAY          */
             DCL        VAR(&HOLIDAY) TYPE(*CHAR) LEN(1)
             DCL        VAR(&RPTDTE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&ADATE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PLTCO) TYPE(*CHAR) LEN(3)
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)

/*‚JM   05/15/25 SDN1295 */
/*           DCL        VAR(&DIR1) TYPE(*CHAR) LEN(36) */
             DCL        VAR(&DIR1) TYPE(*CHAR) LEN(41)
/*           DCL        VAR(&IDIR) TYPE(*CHAR) LEN(47) */
             DCL        VAR(&IDIR) TYPE(*CHAR) LEN(51)
             DCL        VAR(&SYSNAME) TYPE(*CHAR) LEN(10)
/*‚JM   05/15/25 SDN1295 */
             DCL        VAR(&DIR) TYPE(*CHAR) LEN(11)
    /*       DCL        VAR(&IDIR) TYPE(*CHAR) LEN(50)     */
             DCL        VAR(&IDIRNM) TYPE(*CHAR) LEN(90)

             CHGVAR     VAR(&COMP) VALUE(&PLTCO)
/*-----------------------------------------------------------------*/
/* INITILIZATION                                                   */
/*-----------------------------------------------------------------*/
   SETLIB:     SETLIBL    JOBD(&JOBD)
/*‚JM   05/15/25 SDN1295 */
             RTVNETA    SYSNAME(&SYSNAME)
             IF         COND(&SYSNAME *EQ 'SBFDEV') THEN(DO)

             SELECT
             WHEN       COND(&PLTCO *EQ '360') THEN(CHGVAR +
                          VAR(&JOBD) VALUE('MPRGUPJD'))
             WHEN       COND(&PLTCO *EQ '440') THEN(CHGVAR +
                          VAR(&JOBD) VALUE('MPRSTPJD'))
             WHEN       COND(&PLTCO *EQ '960') THEN(CHGVAR +
                          VAR(&JOBD) VALUE('MPRTFPJD'))
             OTHERWISE
             ENDSELECT

             CHKOBJ     OBJ(&JOBD) OBJTYPE(*JOBD)
             MONMSG     MSGID(CPF9801) EXEC(DO)
             CHGVAR     VAR(&JOBD) VALUE('MPRJOBD')
             CHKOBJ     OBJ(&JOBD) OBJTYPE(*JOBD)
             MONMSG     MSGID(CPF9801) EXEC(DO)
             CHGVAR     VAR(&JOBD) VALUE('PRKPRDGUY')
             ENDDO
             ENDDO
             SETLIBL    JOBD(&JOBD)
             RMVLIBLE   LIB(PRKFLIB)
             MONMSG     MSGID(CPF0000)

             ENDDO
/*‚JM   05/15/25 SDN1295 */
/*-----------------------------------------------------------------*/
/* MAINLINE                                                        */
/*-----------------------------------------------------------------*/
             /* IF DATE IS A HOLIDAY, OUTPUT FILE TO MPR DRIVE  */

             CALL       PGM(PKPSUPR) PARM(&RPTDTE)
             CALL       PGM(PMWBXFR) PARM(' ' &COMP +
                          &RPTDTE &HOLIDAY)

             IF COND(&HOLIDAY *EQ 'Y') THEN(DO)
             CHGVAR     VAR(&ADATE) VALUE(&RPTDTE)

  /*         EXECUTE    VIEW(HOLIDAY) PCFMT(*COMMA) +
                          TOFLR(GUY.IS) TODOC(&DOC) REPLACE(*YES) +
                          SETVAR((&DATE &ADATE))                     +
             CALL       PGM(FTPMPRHOL) PARM(&PLTCO &DOC &PCFILE)     */

NEW:         MKDIR      DIR('/QNTC/ENTKCPRDFIL1/')
             MONMSG     MSGID(CPFA0A0)

             CHGVAR     VAR(&DIR1) +
                          VALUE('/QNTC/ENTKCPRDFIL1/FTP_HPE_PORK/MPR/')
/*‚JM   05/15/25 SDN1295 */
             IF         COND(&SYSNAME *EQ 'SBFDEV') THEN(DO)
             CHGVAR     VAR(&DIR1) +
                          VALUE('/QNTC/ENTKCPRDFIL1/FTP_HPE_PORK/MPR_+
                          TEST/')
             ENDDO
/*‚JM   05/15/25 SDN1295 */

             CHGVAR     VAR(&IDIRNM) VALUE(&DIR1 *CAT &PCFILE)

             EXECUTE    VIEW(HOLIDAY) PCFMT(*COMMA) TOSTMF(&IDIRNM) +
                          REPLACE(*YES) SETVAR((&DATE &ADATE))
                          ENDDO
/*-----------------------------------------------------------------*/
/* END PROGRAM                                                     */
/*-----------------------------------------------------------------*/
 ENDPGM:

             ENDPGM
