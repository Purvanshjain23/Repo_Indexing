     H/TITLE Sel Kill/Tattoo       SR  Select record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
     H* - A record may be selected from those displayed in the
     H*   subfile. The master key data will be returned to the
     H*   calling program
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Select record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 02/19/21  Time  : 14:32:24
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB7SRR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Sel Kill/Tattoo       SR  Select record
      *
     FPKA1CPLAIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * Set wdw location allowed?
     E                    YSL         1  1
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * B : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * B : MAP TH Tattoo Number
     I                                    P   3   50P1CVNB
      * B : MAP TH Kill Date
     I                                    P   6   90P1B0DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM P1HMNB    WP0001  30       BOH Company Num
     C           P1CVNB    PARM P1CVNB    WP0002  50       TH Tattoo Numbe
     C           P1B0DT    PARM P1B0DT    WP0003  70       TH Kill Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL                     DO
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'                        DOW
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Reposition window
     C   26                CAS            ZRRPWD
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      *................................................................
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1B0DT           TH Kill Date
     C                     KFLD           A1CVNB           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#2HMNB    A1HMNB
     C                     Z-ADD#2B0DT    A1B0DT
     C                     Z-ADD#2CVNB    A1CVNB
     C           KPOS      SETLL@A1CPL0
     C                     READ @A1CPL0                8782*
      * Save previous selector values
     C           *LIKE     DEFN #2CVNB    WZCVNB
     C                     MOVEL#2CVNB    WZCVNB           TH Tattoo Numbe
     C           *LIKE     DEFN #2BNNB    WZBNNB
     C                     MOVEL#2BNNB    WZBNNB           BOH Buy Order N
     C           *LIKE     DEFN #2BONB    WZBONB
     C                     MOVEL#2BONB    WZBONB           BOL Load Number
     C           *LIKE     DEFN #2AWDT    WZAWDT
     C                     MOVEL#2AWDT    WZAWDT           TH Purchase Dat
     C           *LIKE     DEFN #2BICD    WZBICD
     C                     MOVEL#2BICD    WZBICD           TH Group Refere
     C           *LIKE     DEFN #2CPST    WZCPST
     C                     MOVEL#2CPST    WZCPST           TH Live Purchas
     C           *LIKE     DEFN #2ACPR    WZACPR
     C                     MOVEL#2ACPR    WZACPR           TH Live Purchas
     C           *LIKE     DEFN #2B9PR    WZB9PR
     C                     MOVEL#2B9PR    WZB9PR           TH Live Gross A
     C           *LIKE     DEFN #2CAPR    WZCAPR
     C                     MOVEL#2CAPR    WZCAPR           TH LIve Net Amt
     C           *LIKE     DEFN #2C4ST    WZC4ST
     C                     MOVEL#2C4ST    WZC4ST           TH Resale UOM
     C           *LIKE     DEFN #2AIPR    WZAIPR
     C                     MOVEL#2AIPR    WZAIPR           TH Recalc Live
     C           *LIKE     DEFN #2A6DT    WZA6DT
     C                     MOVEL#2A6DT    WZA6DT           TH Pricing Date
     C           *LIKE     DEFN #2C2ST    WZC2ST
     C                     MOVEL#2C2ST    WZC2ST           TH Resale Sprea
     C           *LIKE     DEFN #2CXNB    WZCXNB
     C                     MOVEL#2CXNB    WZCXNB           TH Dead On Arri
     C           *LIKE     DEFN #2CWNB    WZCWNB
     C                     MOVEL#2CWNB    WZCWNB           TH Head Receive
     C           *LIKE     DEFN #2FCNB    WZFCNB
     C                     MOVEL#2FCNB    WZFCNB           TH Yard Deads
     C           *LIKE     DEFN #2H9NB    WZH9NB
     C                     MOVEL#2H9NB    WZH9NB           TH Held Over
     C           *LIKE     DEFN #2FDNB    WZFDNB
     C                     MOVEL#2FDNB    WZFDNB           TH Head Condemn
     C           *LIKE     DEFN #2FENB    WZFENB
     C                     MOVEL#2FENB    WZFENB           TH Head Killed
     C           *LIKE     DEFN #2HENB    WZHENB
     C                     MOVEL#2HENB    WZHENB           TH Head Adds
     C           *LIKE     DEFN #2HFNB    WZHFNB
     C                     MOVEL#2HFNB    WZHFNB           TH Head Accepte
     C           *LIKE     DEFN #2CYNB    WZCYNB
     C                     MOVEL#2CYNB    WZCYNB           TH Live Wgt
     C           *LIKE     DEFN #2LRNB    WZLRNB
     C                     MOVEL#2LRNB    WZLRNB           TH Adj Live Wgt
     C           *LIKE     DEFN #2E0NB    WZE0NB
     C                     MOVEL#2E0NB    WZE0NB           TH Hot Wgt
     C           *LIKE     DEFN #2A5PC    WZA5PC
     C                     MOVEL#2A5PC    WZA5PC           TH Tot Loin Eye
     C           *LIKE     DEFN #2FBNB    WZFBNB
     C                     MOVEL#2FBNB    WZFBNB           TH Tot Backfat
     C           *LIKE     DEFN #2A4PC    WZA4PC
     C                     MOVEL#2A4PC    WZA4PC           TH Tot Light Re
     C           *LIKE     DEFN #2F7NB    WZF7NB
     C                     MOVEL#2F7NB    WZF7NB           TH Avg Live Wgt
     C           *LIKE     DEFN #2HDNB    WZHDNB
     C                     MOVEL#2HDNB    WZHDNB           TH Avg Hot Wgt
     C           *LIKE     DEFN #2F5NB    WZF5NB
     C                     MOVEL#2F5NB    WZF5NB           TH Avg Light Re
     C           *LIKE     DEFN #2F4NB    WZF4NB
     C                     MOVEL#2F4NB    WZF4NB           TH Avg Lean Per
     C           *LIKE     DEFN #2F3NB    WZF3NB
     C                     MOVEL#2F3NB    WZF3NB           TH Avg Loin Eye
     C           *LIKE     DEFN #2F2NB    WZF2NB
     C                     MOVEL#2F2NB    WZF2NB           TH Avg Backfat
     C           *LIKE     DEFN #2AVPC    WZAVPC
     C                     MOVEL#2AVPC    WZAVPC           TH Std Yield Pe
     C           *LIKE     DEFN #2AWPC    WZAWPC
     C                     MOVEL#2AWPC    WZAWPC           TH Actual Yield
     C           *LIKE     DEFN #2CWPC    WZCWPC
     C                     MOVEL#2CWPC    WZCWPC           TH Adj Actual Y
     C           *LIKE     DEFN #2A8PC    WZA8PC
     C                     MOVEL#2A8PC    WZA8PC           TH Yield Differ
     C           *LIKE     DEFN #2A7PC    WZA7PC
     C                     MOVEL#2A7PC    WZA7PC           TH Recalc Live
     C           *LIKE     DEFN #2B8PR    WZB8PR
     C                     MOVEL#2B8PR    WZB8PR           TH CM Market Pr
     C           *LIKE     DEFN #2AMPR    WZAMPR
     C                     MOVEL#2AMPR    WZAMPR           TH CM Base Mkt
     C           *LIKE     DEFN #2ANPR    WZANPR
     C                     MOVEL#2ANPR    WZANPR           TH CM Base Mkt
     C           *LIKE     DEFN #2AYVA    WZAYVA
     C                     MOVEL#2AYVA    WZAYVA           TH CM Sort Disc
     C           *LIKE     DEFN #2AWVA    WZAWVA
     C                     MOVEL#2AWVA    WZAWVA           TH CM Yield Gai
     C           *LIKE     DEFN #2AOPR    WZAOPR
     C                     MOVEL#2AOPR    WZAOPR           TH CM Base Carc
     C           *LIKE     DEFN #2AXVA    WZAXVA
     C                     MOVEL#2AXVA    WZAXVA           TH CM LN AddOn/
     C           *LIKE     DEFN #2APPR    WZAPPR
     C                     MOVEL#2APPR    WZAPPR           TH CM Carcass G
     C           *LIKE     DEFN #2ASPR    WZASPR
     C                     MOVEL#2ASPR    WZASPR           TH Deduction Am
     C           *LIKE     DEFN #2A4VA    WZA4VA
     C                     MOVEL#2A4VA    WZA4VA           TH Total Net WO
     C           *LIKE     DEFN #2ATPR    WZATPR
     C                     MOVEL#2ATPR    WZATPR           TH Carcass Net
     C           *LIKE     DEFN #2A5VA    WZA5VA
     C                     MOVEL#2A5VA    WZA5VA           TH Additions Am
     C           *LIKE     DEFN #2CBPR    WZCBPR
     C                     MOVEL#2CBPR    WZCBPR           TH Payment Gros
     C           *LIKE     DEFN #2CCPR    WZCCPR
     C                     MOVEL#2CCPR    WZCCPR           Th Payment Net
     C           *LIKE     DEFN #2LPNB    WZLPNB
     C                     MOVEL#2LPNB    WZLPNB           TH AP Voucher/D
     C           *LIKE     DEFN #2CDPR    WZCDPR
     C                     MOVEL#2CDPR    WZCDPR           TH Freight Amou
     C           *LIKE     DEFN #2A7VA    WZA7VA
     C                     MOVEL#2A7VA    WZA7VA           TH Accrual Amou
     C           *LIKE     DEFN #2A2PR    WZA2PR
     C                     MOVEL#2A2PR    WZA2PR           TH Fixed Cost A
     C           *LIKE     DEFN #2JWST    WZJWST
     C                     MOVEL#2JWST    WZJWST           TH Calc Net Sts
     C           *LIKE     DEFN #2CWST    WZCWST
     C                     MOVEL#2CWST    WZCWST           TH Payment Sts
     C           *LIKE     DEFN #2D7ST    WZD7ST
     C                     MOVEL#2D7ST    WZD7ST           TH Header Error
     C           *LIKE     DEFN #2D8ST    WZD8ST
     C                     MOVEL#2D8ST    WZD8ST           TH Detail Error
     C           *LIKE     DEFN #2DWST    WZDWST
     C                     MOVEL#2DWST    WZDWST           TH Kill Balanci
     C           *LIKE     DEFN #2D6ST    WZD6ST
     C                     MOVEL#2D6ST    WZD6ST           TH Bal to Kill
     C           *LIKE     DEFN #2GHNB    WZGHNB
     C                     MOVEL#2GHNB    WZGHNB           TH Commission A
     C           *LIKE     DEFN #2BYDT    WZBYDT
     C                     MOVEL#2BYDT    WZBYDT           TH Voucher Paym
     C           *LIKE     DEFN #2E0ST    WZE0ST
     C                     MOVEL#2E0ST    WZE0ST           TH User Error O
     C           *LIKE     DEFN #2E1ST    WZE1ST
     C                     MOVEL#2E1ST    WZE1ST           TH Held Over Re
     C           *LIKE     DEFN #2E2ST    WZE2ST
     C                     MOVEL#2E2ST    WZE2ST           TH Sex
     C           *LIKE     DEFN #2BSDT    WZBSDT
     C                     MOVEL#2BSDT    WZBSDT           TH Held/Ovr Com
     C           *LIKE     DEFN #2BTDT    WZBTDT
     C                     MOVEL#2BTDT    WZBTDT           TH Commission P
     C           *LIKE     DEFN #2BUDT    WZBUDT
     C                     MOVEL#2BUDT    WZBUDT           TH Actual Check
     C           *LIKE     DEFN #2HGNB    WZHGNB
     C                     MOVEL#2HGNB    WZHGNB           TH Shipped Weig
     C           *LIKE     DEFN #2HHNB    WZHHNB
     C                     MOVEL#2HHNB    WZHHNB           TH Avg Hot Wgt
     C           *LIKE     DEFN #2HINB    WZHINB
     C                     MOVEL#2HINB    WZHINB           TH FFLI
     C           *LIKE     DEFN #2A3PR    WZA3PR
     C                     MOVEL#2A3PR    WZA3PR           TH Kill Product
     C           *LIKE     DEFN #2A4PR    WZA4PR
     C                     MOVEL#2A4PR    WZA4PR           TH Cut Product
     C           *LIKE     DEFN #2A6PR    WZA6PR
     C                     MOVEL#2A6PR    WZA6PR           TH Render Produ
     C           *LIKE     DEFN #2J9NB    WZJ9NB
     C                     MOVEL#2J9NB    WZJ9NB           TH Head Exclude
     C           *LIKE     DEFN #2D6PR    WZD6PR
     C                     MOVEL#2D6PR    WZD6PR           TH CM Bse Mkt L
     C           *LIKE     DEFN #2D7PR    WZD7PR
     C                     MOVEL#2D7PR    WZD7PR           TH CM Bse Mkt C
     C           *LIKE     DEFN #2D8PR    WZD8PR
     C                     MOVEL#2D8PR    WZD8PR           TH CM Srt Dsc L
     C           *LIKE     DEFN #2D9PR    WZD9PR
     C                     MOVEL#2D9PR    WZD9PR           TH CM Srt Dsc C
     C           *LIKE     DEFN #2EAPR    WZEAPR
     C                     MOVEL#2EAPR    WZEAPR           TH CM Yld G/L L
     C           *LIKE     DEFN #2EBPR    WZEBPR
     C                     MOVEL#2EBPR    WZEBPR           TH CM Yld G/L C
     C           *LIKE     DEFN #2ECPR    WZECPR
     C                     MOVEL#2ECPR    WZECPR           TH CM Crc Val L
     C           *LIKE     DEFN #2EDPR    WZEDPR
     C                     MOVEL#2EDPR    WZEDPR           TH CM Crc Val C
     C           *LIKE     DEFN #2EEPR    WZEEPR
     C                     MOVEL#2EEPR    WZEEPR           TH CM Lean Prem
     C           *LIKE     DEFN #2EFPR    WZEFPR
     C                     MOVEL#2EFPR    WZEFPR           TH CM Lean Prem
     C           *LIKE     DEFN #2EGPR    WZEGPR
     C                     MOVEL#2EGPR    WZEGPR           TH CM Gross Liv
     C           *LIKE     DEFN #2EHPR    WZEHPR
     C                     MOVEL#2EHPR    WZEHPR           TH CM Gross Car
     C           *LIKE     DEFN #2KAST    WZKAST
     C                     MOVEL#2KAST    WZKAST           TH Source Type
     C           *LIKE     DEFN #2J7ST    WZJ7ST
     C                     MOVEL#2J7ST    WZJ7ST           TH Scale Ticket
     C           *LIKE     DEFN #2J9ST    WZJ9ST
     C                     MOVEL#2J9ST    WZJ9ST           TH Payment Type
     C           *LIKE     DEFN #2OXNB    WZOXNB
     C                     MOVEL#2OXNB    WZOXNB           TH HPS Movement
     C           *LIKE     DEFN #2LKST    WZLKST
     C                     MOVEL#2LKST    WZLKST           TH Source Code
     C           *LIKE     DEFN #2J8ST    WZJ8ST
     C                     MOVEL#2J8ST    WZJ8ST           TH Posted to HP
     C           *LIKE     DEFN #2LIST    WZLIST
     C                     MOVEL#2LIST    WZLIST           TH Schedule Kil
     C           *LIKE     DEFN #2LJST    WZLJST
     C                     MOVEL#2LJST    WZLJST           TH Shift Held O
     C           *LIKE     DEFN #2NZTX    WZNZTX
     C                     MOVEL#2NZTX    WZNZTX           TH State
     C           *LIKE     DEFN #2HJCD    WZHJCD
     C                     MOVEL#2HJCD    WZHJCD           TH Unused Code
     C           *LIKE     DEFN #2R4ST    WZR4ST
     C                     MOVEL#2R4ST    WZR4ST           TH Unused Sts 2
     C           *LIKE     DEFN #2R5ST    WZR5ST
     C                     MOVEL#2R5ST    WZR5ST           TH Commission S
     C           *LIKE     DEFN #2R6ST    WZR6ST
     C                     MOVEL#2R6ST    WZR6ST           TH Paid 2 Week
     C           *LIKE     DEFN #2R7ST    WZR7ST
     C                     MOVEL#2R7ST    WZR7ST           TH Unused Sts 1
     C           *LIKE     DEFN #2THWT    WZTHWT
     C                     MOVEL#2THWT    WZTHWT           TH DOA Weight
     C           *LIKE     DEFN #2T2WT    WZT2WT
     C                     MOVEL#2T2WT    WZT2WT           TH Avg Lean % E
     C           *LIKE     DEFN #2THHD    WZTHHD
     C                     MOVEL#2THHD    WZTHHD           TH HPS Farm Sit
     C           *LIKE     DEFN #2T2HD    WZT2HD
     C                     MOVEL#2T2HD    WZT2HD           TH Shift Held O
     C           *LIKE     DEFN #2OBPR    WZOBPR
     C                     MOVEL#2OBPR    WZOBPR           TH Sorting Amou
     C           *LIKE     DEFN #2KOER    WZKOER
     C                     MOVEL#2KOER    WZKOER           TH Head Identif
     C           *LIKE     DEFN #2OPIR    WZOPIR
     C                     MOVEL#2OPIR    WZOPIR           TH Percent Iden
     C           *LIKE     DEFN #2OPEM    WZOPEM
     C                     MOVEL#2OPEM    WZOPEM           TH Percent Acce
     C           *LIKE     DEFN #2IORP    WZIORP
     C                     MOVEL#2IORP    WZIORP           TH Head Adjuste
     C           *LIKE     DEFN #2OWEO    WZOWEO
     C                     MOVEL#2OWEO    WZOWEO           TH PHA Head Add
     C           *LIKE     DEFN #2OQET    WZOQET
     C                     MOVEL#2OQET    WZOQET           TH PHA Add Type
     C           *LIKE     DEFN #2URST    WZURST
     C                     MOVEL#2URST    WZURST           TH PHA Average
     C           *LIKE     DEFN #2USST    WZUSST
     C                     MOVEL#2USST    WZUSST           TH PHA Add Reas
     C           *LIKE     DEFN #2HHPC    WZHHPC
     C                     MOVEL#2HHPC    WZHHPC           TH PHA Yield Pe
     C           *LIKE     DEFN #2S9PR    WZS9PR
     C                     MOVEL#2S9PR    WZS9PR           TH PHA Lean Prm
     C           *LIKE     DEFN #2TAPR    WZTAPR
     C                     MOVEL#2TAPR    WZTAPR           TH VC Gross Val
     C           *LIKE     DEFN #2TBPR    WZTBPR
     C                     MOVEL#2TBPR    WZTBPR           TH Excluded Gro
     C           *LIKE     DEFN #2JFUR    WZJFUR
     C                     MOVEL#2JFUR    WZJFUR           TH Avg Lean %
     C           *LIKE     DEFN #2KRIF    WZKRIF
     C                     MOVEL#2KRIF    WZKRIF           TH Broken Back
     C           *LIKE     DEFN #2KORF    WZKORF
     C                     MOVEL#2KORF    WZKORF           TH Hot Scl Uplo
     C           *LIKE     DEFN #2KAPR    WZKAPR
     C                     MOVEL#2KAPR    WZKAPR           TH Unused Nbr 4
     C           *LIKE     DEFN #2KROT    WZKROT
     C                     MOVEL#2KROT    WZKROT           TH Excluded Car
     C           *LIKE     DEFN #2OTJG    WZOTJG
     C                     MOVEL#2OTJG    WZOTJG           TH Excluded Pre
     C           *LIKE     DEFN #2IRJG    WZIRJG
     C                     MOVEL#2IRJG    WZIRJG           TH Unused Nbr 7
     C           *LIKE     DEFN #2IMJF    WZIMJF
     C                     MOVEL#2IMJF    WZIMJF           TH Unused Nbr 8
     C           *LIKE     DEFN #2IRGF    WZIRGF
     C                     MOVEL#2IRGF    WZIRGF           TH Unused Nbr 9
     C           *LIKE     DEFN #2KRJF    WZKRJF
     C                     MOVEL#2KRJF    WZKRJF           TH Unused Nbr 1
     C           *LIKE     DEFN #2OJRF    WZOJRF
     C                     MOVEL#2OJRF    WZOJRF           TH Break Even P
     C           *LIKE     DEFN #2KFOR    WZKFOR
     C                     MOVEL#2KFOR    WZKFOR           TH Meat Value F
     C           *LIKE     DEFN #2ORJK    WZORJK
     C                     MOVEL#2ORJK    WZORJK           TH Yld Parm Adj
     C           *LIKE     DEFN #2OMVJ    WZOMVJ
     C                     MOVEL#2OMVJ    WZOMVJ           TH PHA Sort Dis
     C           *LIKE     DEFN #2MVNF    WZMVNF
     C                     MOVEL#2MVNF    WZMVNF           TH Avg Loin Eye
     C           *LIKE     DEFN #2MCNF    WZMCNF
     C                     MOVEL#2MCNF    WZMCNF           TH Avg Backfat
     C           *LIKE     DEFN #2NCNF    WZNCNF
     C                     MOVEL#2NCNF    WZNCNF           TH HITCH Old Pa
     C           *LIKE     DEFN #2NCHF    WZNCHF
     C                     MOVEL#2NCHF    WZNCHF           TH MPR Sort Los
     C           *LIKE     DEFN #2IGIR    WZIGIR
     C                     MOVEL#2IGIR    WZIGIR           TH Unused Nbr 1
     C           *LIKE     DEFN #2KFJR    WZKFJR
     C                     MOVEL#2KFJR    WZKFJR           TH Unused Nbr 2
     C           *LIKE     DEFN #2EADT    WZEADT
     C                     MOVEL#2EADT    WZEADT           TH Cold Scl Upl
     C           *LIKE     DEFN #2EBDT    WZEBDT
     C                     MOVEL#2EBDT    WZEBDT           TH Cold Scl Upl
     C           *LIKE     DEFN #2ECDT    WZECDT
     C                     MOVEL#2ECDT    WZECDT           TH Head LFT
     C           *LIKE     DEFN #2EDDT    WZEDDT
     C                     MOVEL#2EDDT    WZEDDT           TH Head EUT/KOA
     C           *LIKE     DEFN #2EEDT    WZEEDT
     C                     MOVEL#2EEDT    WZEEDT           TH Unused Date
     C           *LIKE     DEFN #2U4ST    WZU4ST
     C                     MOVEL#2U4ST    WZU4ST           TH Unused Sts 1
     C           *LIKE     DEFN #2U5ST    WZU5ST
     C                     MOVEL#2U5ST    WZU5ST           TH Unused Sts 2
     C           *LIKE     DEFN #2U6ST    WZU6ST
     C                     MOVEL#2U6ST    WZU6ST           TH Unused Sts 3
     C           *LIKE     DEFN #2U7ST    WZU7ST
     C                     MOVEL#2U7ST    WZU7ST           TH Unused Sts 4
     C           *LIKE     DEFN #2U8ST    WZU8ST
     C                     MOVEL#2U8ST    WZU8ST           TH Unused Sts 5
     C           *LIKE     DEFN #2U9ST    WZU9ST
     C                     MOVEL#2U9ST    WZU9ST           TH Unused Sts 6
     C           *LIKE     DEFN #2VAST    WZVAST
     C                     MOVEL#2VAST    WZVAST           TH Unused Sts 7
     C           *LIKE     DEFN #2VBST    WZVBST
     C                     MOVEL#2VBST    WZVBST           TH Unused Sts 8
     C           *LIKE     DEFN #2BDCD    WZBDCD
     C                     MOVEL#2BDCD    WZBDCD           DF Defect Code
     C           *LIKE     DEFN #2CSCD    WZCSCD
     C                     MOVEL#2CSCD    WZCSCD           THP Process Cod
     C           *LIKE     DEFN #2ACCD    WZACCD
     C                     MOVEL#2ACCD    WZACCD           HB Buyer Code
     C           *LIKE     DEFN #2AGCD    WZAGCD
     C                     MOVEL#2AGCD    WZAGCD           GN Genetic Code
     C           *LIKE     DEFN #2AAVN    WZAAVN
     C                     MOVEL#2AAVN    WZAAVN           RS User Changed
     C           *LIKE     DEFN #2AADT    WZAADT
     C                     MOVEL#2AADT    WZAADT           RS Date Changed
     C           *LIKE     DEFN #2AMTM    WZAMTM
     C                     MOVEL#2AMTM    WZAMTM           RS Time Changed
     C           *LIKE     DEFN #2AJST    WZAJST
     C                     MOVEL#2AJST    WZAJST           RS Record Statu
     C           *LIKE     DEFN #2AHVN    WZAHVN
     C                     MOVEL#2AHVN    WZAHVN           RS Job
     C           *LIKE     DEFN #2AGVN    WZAGVN
     C                     MOVEL#2AGVN    WZAGVN           RS Program
     C           *LIKE     DEFN #2ABVN    WZABVN
     C                     MOVEL#2ABVN    WZABVN           RS User Added
     C           *LIKE     DEFN #2ABDT    WZABDT
     C                     MOVEL#2ABDT    WZABDT           RS Date Added
     C           *LIKE     DEFN #2ABTM    WZABTM
     C                     MOVEL#2ABTM    WZABTM           RS Time Added
     C           *LIKE     DEFN #2HMNB    WZHMNB
     C                     MOVEL#2HMNB    WZHMNB           BOH Company Num
     C           *LIKE     DEFN #2B0DT    WZB0DT
     C                     MOVEL#2B0DT    WZB0DT           TH Kill Date
     C           *LIKE     DEFN #2LLST    WZLLST
     C                     MOVEL#2LLST    WZLLST           TH Hog Class Ty
     C           *LIKE     DEFN #2ABCD    WZABCD
     C                     MOVEL#2ABCD    WZABCD           PD Producer Cod
     C           *LIKE     DEFN #2AECD    WZAECD
     C                     MOVEL#2AECD    WZAECD           PL Location Cod
      * Load subfile page
     C                     Z-ADD*ZERO     ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@A1CPL0                  90*
     C  N82                READ @A1CPL0                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKINDS  1
     C                     MOVEAWKINDS    *IN,36
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full,
      * or scan limit reached,
      * or end of file reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2B0DT    OREQ *ZERO                      TH Kill Date
     C           #2CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           A1CVNB    CABNE#2CVNB    CD020            TH Tattoo Numbe
     C                     END
     C                     END
     C           #2BNNB    IFNE *ZERO                      BOH Buy Order N
     C           A1BNNB    CABNE#2BNNB    CD020            BOH Buy Order N
     C                     END
     C           #2BONB    IFNE *ZERO                      BOL Load Number
     C           A1BONB    CABNE#2BONB    CD020            BOL Load Number
     C                     END
     C           #2AWDT    IFNE *ZERO                      TH Purchase Dat
     C           A1AWDT    CABNE#2AWDT    CD020            TH Purchase Dat
     C                     END
     C           #2BICD    IFNE *BLANK                     TH Group Refere
     C           A1BICD    CABNE#2BICD    CD020            TH Group Refere
     C                     END
     C           #2CPST    IFNE *BLANK                     TH Live Purchas
     C           A1CPST    CABNE#2CPST    CD020            TH Live Purchas
     C                     END
     C           #2ACPR    IFNE *ZERO                      TH Live Purchas
     C           A1ACPR    CABNE#2ACPR    CD020            TH Live Purchas
     C                     END
     C           #2B9PR    IFNE *ZERO                      TH Live Gross A
     C           A1B9PR    CABNE#2B9PR    CD020            TH Live Gross A
     C                     END
     C           #2CAPR    IFNE *ZERO                      TH LIve Net Amt
     C           A1CAPR    CABNE#2CAPR    CD020            TH LIve Net Amt
     C                     END
     C           #2C4ST    IFNE *BLANK                     TH Resale UOM
     C           A1C4ST    CABNE#2C4ST    CD020            TH Resale UOM
     C                     END
     C           #2AIPR    IFNE *ZERO                      TH Recalc Live
     C           A1AIPR    CABNE#2AIPR    CD020            TH Recalc Live
     C                     END
     C           #2A6DT    IFNE *ZERO                      TH Pricing Date
     C           A1A6DT    CABNE#2A6DT    CD020            TH Pricing Date
     C                     END
     C           #2C2ST    IFNE *BLANK                     TH Resale Sprea
     C           A1C2ST    CABNE#2C2ST    CD020            TH Resale Sprea
     C                     END
     C           #2CXNB    IFNE *ZERO                      TH Dead On Arri
     C           A1CXNB    CABNE#2CXNB    CD020            TH Dead On Arri
     C                     END
     C           #2CWNB    IFNE *ZERO                      TH Head Receive
     C           A1CWNB    CABNE#2CWNB    CD020            TH Head Receive
     C                     END
     C           #2FCNB    IFNE *ZERO                      TH Yard Deads
     C           A1FCNB    CABNE#2FCNB    CD020            TH Yard Deads
     C                     END
     C           #2H9NB    IFNE *ZERO                      TH Held Over
     C           A1H9NB    CABNE#2H9NB    CD020            TH Held Over
     C                     END
     C           #2FDNB    IFNE *ZERO                      TH Head Condemn
     C           A1FDNB    CABNE#2FDNB    CD020            TH Head Condemn
     C                     END
     C           #2FENB    IFNE *ZERO                      TH Head Killed
     C           A1FENB    CABNE#2FENB    CD020            TH Head Killed
     C                     END
     C           #2HENB    IFNE *ZERO                      TH Head Adds
     C           A1HENB    CABNE#2HENB    CD020            TH Head Adds
     C                     END
     C           #2HFNB    IFNE *ZERO                      TH Head Accepte
     C           A1HFNB    CABNE#2HFNB    CD020            TH Head Accepte
     C                     END
     C           #2CYNB    IFNE *ZERO                      TH Live Wgt
     C           A1CYNB    CABNE#2CYNB    CD020            TH Live Wgt
     C                     END
     C           #2LRNB    IFNE *ZERO                      TH Adj Live Wgt
     C           A1LRNB    CABNE#2LRNB    CD020            TH Adj Live Wgt
     C                     END
     C           #2E0NB    IFNE *ZERO                      TH Hot Wgt
     C           A1E0NB    CABNE#2E0NB    CD020            TH Hot Wgt
     C                     END
     C           #2A5PC    IFNE *ZERO                      TH Tot Loin Eye
     C           A1A5PC    CABNE#2A5PC    CD020            TH Tot Loin Eye
     C                     END
     C           #2FBNB    IFNE *ZERO                      TH Tot Backfat
     C           A1FBNB    CABNE#2FBNB    CD020            TH Tot Backfat
     C                     END
     C           #2A4PC    IFNE *ZERO                      TH Tot Light Re
     C           A1A4PC    CABNE#2A4PC    CD020            TH Tot Light Re
     C                     END
     C           #2F7NB    IFNE *ZERO                      TH Avg Live Wgt
     C           A1F7NB    CABNE#2F7NB    CD020            TH Avg Live Wgt
     C                     END
     C           #2HDNB    IFNE *ZERO                      TH Avg Hot Wgt
     C           A1HDNB    CABNE#2HDNB    CD020            TH Avg Hot Wgt
     C                     END
     C           #2F5NB    IFNE *ZERO                      TH Avg Light Re
     C           A1F5NB    CABNE#2F5NB    CD020            TH Avg Light Re
     C                     END
     C           #2F4NB    IFNE *ZERO                      TH Avg Lean Per
     C           A1F4NB    CABNE#2F4NB    CD020            TH Avg Lean Per
     C                     END
     C           #2F3NB    IFNE *ZERO                      TH Avg Loin Eye
     C           A1F3NB    CABNE#2F3NB    CD020            TH Avg Loin Eye
     C                     END
     C           #2F2NB    IFNE *ZERO                      TH Avg Backfat
     C           A1F2NB    CABNE#2F2NB    CD020            TH Avg Backfat
     C                     END
     C           #2AVPC    IFNE *ZERO                      TH Std Yield Pe
     C           A1AVPC    CABNE#2AVPC    CD020            TH Std Yield Pe
     C                     END
     C           #2AWPC    IFNE *ZERO                      TH Actual Yield
     C           A1AWPC    CABNE#2AWPC    CD020            TH Actual Yield
     C                     END
     C           #2CWPC    IFNE *ZERO                      TH Adj Actual Y
     C           A1CWPC    CABNE#2CWPC    CD020            TH Adj Actual Y
     C                     END
     C           #2A8PC    IFNE *ZERO                      TH Yield Differ
     C           A1A8PC    CABNE#2A8PC    CD020            TH Yield Differ
     C                     END
     C           #2A7PC    IFNE *ZERO                      TH Recalc Live
     C           A1A7PC    CABNE#2A7PC    CD020            TH Recalc Live
     C                     END
     C           #2B8PR    IFNE *ZERO                      TH CM Market Pr
     C           A1B8PR    CABNE#2B8PR    CD020            TH CM Market Pr
     C                     END
     C           #2AMPR    IFNE *ZERO                      TH CM Base Mkt
     C           A1AMPR    CABNE#2AMPR    CD020            TH CM Base Mkt
     C                     END
     C           #2ANPR    IFNE *ZERO                      TH CM Base Mkt
     C           A1ANPR    CABNE#2ANPR    CD020            TH CM Base Mkt
     C                     END
     C           #2AYVA    IFNE *ZERO                      TH CM Sort Disc
     C           A1AYVA    CABNE#2AYVA    CD020            TH CM Sort Disc
     C                     END
     C           #2AWVA    IFNE *ZERO                      TH CM Yield Gai
     C           A1AWVA    CABNE#2AWVA    CD020            TH CM Yield Gai
     C                     END
     C           #2AOPR    IFNE *ZERO                      TH CM Base Carc
     C           A1AOPR    CABNE#2AOPR    CD020            TH CM Base Carc
     C                     END
     C           #2AXVA    IFNE *ZERO                      TH CM LN AddOn/
     C           A1AXVA    CABNE#2AXVA    CD020            TH CM LN AddOn/
     C                     END
     C           #2APPR    IFNE *ZERO                      TH CM Carcass G
     C           A1APPR    CABNE#2APPR    CD020            TH CM Carcass G
     C                     END
     C           #2ASPR    IFNE *ZERO                      TH Deduction Am
     C           A1ASPR    CABNE#2ASPR    CD020            TH Deduction Am
     C                     END
     C           #2A4VA    IFNE *ZERO                      TH Total Net WO
     C           A1A4VA    CABNE#2A4VA    CD020            TH Total Net WO
     C                     END
     C           #2ATPR    IFNE *ZERO                      TH Carcass Net
     C           A1ATPR    CABNE#2ATPR    CD020            TH Carcass Net
     C                     END
     C           #2A5VA    IFNE *ZERO                      TH Additions Am
     C           A1A5VA    CABNE#2A5VA    CD020            TH Additions Am
     C                     END
     C           #2CBPR    IFNE *ZERO                      TH Payment Gros
     C           A1CBPR    CABNE#2CBPR    CD020            TH Payment Gros
     C                     END
     C           #2CCPR    IFNE *ZERO                      Th Payment Net
     C           A1CCPR    CABNE#2CCPR    CD020            Th Payment Net
     C                     END
     C           #2LPNB    IFNE *ZERO                      TH AP Voucher/D
     C           A1LPNB    CABNE#2LPNB    CD020            TH AP Voucher/D
     C                     END
     C           #2CDPR    IFNE *ZERO                      TH Freight Amou
     C           A1CDPR    CABNE#2CDPR    CD020            TH Freight Amou
     C                     END
     C           #2A7VA    IFNE *ZERO                      TH Accrual Amou
     C           A1A7VA    CABNE#2A7VA    CD020            TH Accrual Amou
     C                     END
     C           #2A2PR    IFNE *ZERO                      TH Fixed Cost A
     C           A1A2PR    CABNE#2A2PR    CD020            TH Fixed Cost A
     C                     END
     C           #2JWST    IFNE *BLANK                     TH Calc Net Sts
     C           A1JWST    CABNE#2JWST    CD020            TH Calc Net Sts
     C                     END
     C           #2CWST    IFNE *BLANK                     TH Payment Sts
     C           A1CWST    CABNE#2CWST    CD020            TH Payment Sts
     C                     END
     C           #2D7ST    IFNE *BLANK                     TH Header Error
     C           A1D7ST    CABNE#2D7ST    CD020            TH Header Error
     C                     END
     C           #2D8ST    IFNE *BLANK                     TH Detail Error
     C           A1D8ST    CABNE#2D8ST    CD020            TH Detail Error
     C                     END
     C           #2DWST    IFNE *BLANK                     TH Kill Balanci
     C           A1DWST    CABNE#2DWST    CD020            TH Kill Balanci
     C                     END
     C           #2D6ST    IFNE *BLANK                     TH Bal to Kill
     C           A1D6ST    CABNE#2D6ST    CD020            TH Bal to Kill
     C                     END
     C           #2GHNB    IFNE *ZERO                      TH Commission A
     C           A1GHNB    CABNE#2GHNB    CD020            TH Commission A
     C                     END
     C           #2BYDT    IFNE *ZERO                      TH Voucher Paym
     C           A1BYDT    CABNE#2BYDT    CD020            TH Voucher Paym
     C                     END
     C           #2E0ST    IFNE *BLANK                     TH User Error O
     C           A1E0ST    CABNE#2E0ST    CD020            TH User Error O
     C                     END
     C           #2E1ST    IFNE *BLANK                     TH Held Over Re
     C           A1E1ST    CABNE#2E1ST    CD020            TH Held Over Re
     C                     END
     C           #2E2ST    IFNE *BLANK                     TH Sex
     C           A1E2ST    CABNE#2E2ST    CD020            TH Sex
     C                     END
     C           #2BSDT    IFNE *ZERO                      TH Held/Ovr Com
     C           A1BSDT    CABNE#2BSDT    CD020            TH Held/Ovr Com
     C                     END
     C           #2BTDT    IFNE *ZERO                      TH Commission P
     C           A1BTDT    CABNE#2BTDT    CD020            TH Commission P
     C                     END
     C           #2BUDT    IFNE *ZERO                      TH Actual Check
     C           A1BUDT    CABNE#2BUDT    CD020            TH Actual Check
     C                     END
     C           #2HGNB    IFNE *ZERO                      TH Shipped Weig
     C           A1HGNB    CABNE#2HGNB    CD020            TH Shipped Weig
     C                     END
     C           #2HHNB    IFNE *ZERO                      TH Avg Hot Wgt
     C           A1HHNB    CABNE#2HHNB    CD020            TH Avg Hot Wgt
     C                     END
     C           #2HINB    IFNE *ZERO                      TH FFLI
     C           A1HINB    CABNE#2HINB    CD020            TH FFLI
     C                     END
     C           #2A3PR    IFNE *ZERO                      TH Kill Product
     C           A1A3PR    CABNE#2A3PR    CD020            TH Kill Product
     C                     END
     C           #2A4PR    IFNE *ZERO                      TH Cut Product
     C           A1A4PR    CABNE#2A4PR    CD020            TH Cut Product
     C                     END
     C           #2A6PR    IFNE *ZERO                      TH Render Produ
     C           A1A6PR    CABNE#2A6PR    CD020            TH Render Produ
     C                     END
     C           #2J9NB    IFNE *ZERO                      TH Head Exclude
     C           A1J9NB    CABNE#2J9NB    CD020            TH Head Exclude
     C                     END
     C           #2D6PR    IFNE *ZERO                      TH CM Bse Mkt L
     C           A1D6PR    CABNE#2D6PR    CD020            TH CM Bse Mkt L
     C                     END
     C           #2D7PR    IFNE *ZERO                      TH CM Bse Mkt C
     C           A1D7PR    CABNE#2D7PR    CD020            TH CM Bse Mkt C
     C                     END
     C           #2D8PR    IFNE *ZERO                      TH CM Srt Dsc L
     C           A1D8PR    CABNE#2D8PR    CD020            TH CM Srt Dsc L
     C                     END
     C           #2D9PR    IFNE *ZERO                      TH CM Srt Dsc C
     C           A1D9PR    CABNE#2D9PR    CD020            TH CM Srt Dsc C
     C                     END
     C           #2EAPR    IFNE *ZERO                      TH CM Yld G/L L
     C           A1EAPR    CABNE#2EAPR    CD020            TH CM Yld G/L L
     C                     END
     C           #2EBPR    IFNE *ZERO                      TH CM Yld G/L C
     C           A1EBPR    CABNE#2EBPR    CD020            TH CM Yld G/L C
     C                     END
     C           #2ECPR    IFNE *ZERO                      TH CM Crc Val L
     C           A1ECPR    CABNE#2ECPR    CD020            TH CM Crc Val L
     C                     END
     C           #2EDPR    IFNE *ZERO                      TH CM Crc Val C
     C           A1EDPR    CABNE#2EDPR    CD020            TH CM Crc Val C
     C                     END
     C           #2EEPR    IFNE *ZERO                      TH CM Lean Prem
     C           A1EEPR    CABNE#2EEPR    CD020            TH CM Lean Prem
     C                     END
     C           #2EFPR    IFNE *ZERO                      TH CM Lean Prem
     C           A1EFPR    CABNE#2EFPR    CD020            TH CM Lean Prem
     C                     END
     C           #2EGPR    IFNE *ZERO                      TH CM Gross Liv
     C           A1EGPR    CABNE#2EGPR    CD020            TH CM Gross Liv
     C                     END
     C           #2EHPR    IFNE *ZERO                      TH CM Gross Car
     C           A1EHPR    CABNE#2EHPR    CD020            TH CM Gross Car
     C                     END
     C           #2KAST    IFNE *BLANK                     TH Source Type
     C           A1KAST    CABNE#2KAST    CD020            TH Source Type
     C                     END
     C           #2J7ST    IFNE *BLANK                     TH Scale Ticket
     C           A1J7ST    CABNE#2J7ST    CD020            TH Scale Ticket
     C                     END
     C           #2J9ST    IFNE *BLANK                     TH Payment Type
     C           A1J9ST    CABNE#2J9ST    CD020            TH Payment Type
     C                     END
     C           #2OXNB    IFNE *ZERO                      TH HPS Movement
     C           A1OXNB    CABNE#2OXNB    CD020            TH HPS Movement
     C                     END
     C           #2LKST    IFNE *BLANK                     TH Source Code
     C           A1LKST    CABNE#2LKST    CD020            TH Source Code
     C                     END
     C           #2J8ST    IFNE *BLANK                     TH Posted to HP
     C           A1J8ST    CABNE#2J8ST    CD020            TH Posted to HP
     C                     END
     C           #2LIST    IFNE *BLANK                     TH Schedule Kil
     C           A1LIST    CABNE#2LIST    CD020            TH Schedule Kil
     C                     END
     C           #2LJST    IFNE *BLANK                     TH Shift Held O
     C           A1LJST    CABNE#2LJST    CD020            TH Shift Held O
     C                     END
     C           #2NZTX    IFNE *BLANK                     TH State
     C           A1NZTX    CABNE#2NZTX    CD020            TH State
     C                     END
     C           #2HJCD    IFNE *BLANK                     TH Unused Code
     C           A1HJCD    CABNE#2HJCD    CD020            TH Unused Code
     C                     END
     C           #2R4ST    IFNE *BLANK                     TH Unused Sts 2
     C           A1R4ST    CABNE#2R4ST    CD020            TH Unused Sts 2
     C                     END
     C           #2R5ST    IFNE *BLANK                     TH Commission S
     C           A1R5ST    CABNE#2R5ST    CD020            TH Commission S
     C                     END
     C           #2R6ST    IFNE *BLANK                     TH Paid 2 Week
     C           A1R6ST    CABNE#2R6ST    CD020            TH Paid 2 Week
     C                     END
     C           #2R7ST    IFNE *BLANK                     TH Unused Sts 1
     C           A1R7ST    CABNE#2R7ST    CD020            TH Unused Sts 1
     C                     END
     C           #2THWT    IFNE *ZERO                      TH DOA Weight
     C           A1THWT    CABNE#2THWT    CD020            TH DOA Weight
     C                     END
     C           #2T2WT    IFNE *ZERO                      TH Avg Lean % E
     C           A1T2WT    CABNE#2T2WT    CD020            TH Avg Lean % E
     C                     END
     C           #2THHD    IFNE *ZERO                      TH HPS Farm Sit
     C           A1THHD    CABNE#2THHD    CD020            TH HPS Farm Sit
     C                     END
     C           #2T2HD    IFNE *ZERO                      TH Shift Held O
     C           A1T2HD    CABNE#2T2HD    CD020            TH Shift Held O
     C                     END
     C           #2OBPR    IFNE *ZERO                      TH Sorting Amou
     C           A1OBPR    CABNE#2OBPR    CD020            TH Sorting Amou
     C                     END
     C           #2KOER    IFNE *ZERO                      TH Head Identif
     C           A1KOER    CABNE#2KOER    CD020            TH Head Identif
     C                     END
     C           #2OPIR    IFNE *ZERO                      TH Percent Iden
     C           A1OPIR    CABNE#2OPIR    CD020            TH Percent Iden
     C                     END
     C           #2OPEM    IFNE *ZERO                      TH Percent Acce
     C           A1OPEM    CABNE#2OPEM    CD020            TH Percent Acce
     C                     END
     C           #2IORP    IFNE *ZERO                      TH Head Adjuste
     C           A1IORP    CABNE#2IORP    CD020            TH Head Adjuste
     C                     END
     C           #2OWEO    IFNE *ZERO                      TH PHA Head Add
     C           A1OWEO    CABNE#2OWEO    CD020            TH PHA Head Add
     C                     END
     C           #2OQET    IFNE *BLANK                     TH PHA Add Type
     C           A1OQET    CABNE#2OQET    CD020            TH PHA Add Type
     C                     END
     C           #2URST    IFNE *BLANK                     TH PHA Average
     C           A1URST    CABNE#2URST    CD020            TH PHA Average
     C                     END
     C           #2USST    IFNE *BLANK                     TH PHA Add Reas
     C           A1USST    CABNE#2USST    CD020            TH PHA Add Reas
     C                     END
     C           #2HHPC    IFNE *ZERO                      TH PHA Yield Pe
     C           A1HHPC    CABNE#2HHPC    CD020            TH PHA Yield Pe
     C                     END
     C           #2S9PR    IFNE *ZERO                      TH PHA Lean Prm
     C           A1S9PR    CABNE#2S9PR    CD020            TH PHA Lean Prm
     C                     END
     C           #2TAPR    IFNE *ZERO                      TH VC Gross Val
     C           A1TAPR    CABNE#2TAPR    CD020            TH VC Gross Val
     C                     END
     C           #2TBPR    IFNE *ZERO                      TH Excluded Gro
     C           A1TBPR    CABNE#2TBPR    CD020            TH Excluded Gro
     C                     END
     C           #2JFUR    IFNE *ZERO                      TH Avg Lean %
     C           A1JFUR    CABNE#2JFUR    CD020            TH Avg Lean %
     C                     END
     C           #2KRIF    IFNE *ZERO                      TH Broken Back
     C           A1KRIF    CABNE#2KRIF    CD020            TH Broken Back
     C                     END
     C           #2KORF    IFNE *ZERO                      TH Hot Scl Uplo
     C           A1KORF    CABNE#2KORF    CD020            TH Hot Scl Uplo
     C                     END
     C           #2KAPR    IFNE *ZERO                      TH Unused Nbr 4
     C           A1KAPR    CABNE#2KAPR    CD020            TH Unused Nbr 4
     C                     END
     C           #2KROT    IFNE *ZERO                      TH Excluded Car
     C           A1KROT    CABNE#2KROT    CD020            TH Excluded Car
     C                     END
     C           #2OTJG    IFNE *ZERO                      TH Excluded Pre
     C           A1OTJG    CABNE#2OTJG    CD020            TH Excluded Pre
     C                     END
     C           #2IRJG    IFNE *ZERO                      TH Unused Nbr 7
     C           A1IRJG    CABNE#2IRJG    CD020            TH Unused Nbr 7
     C                     END
     C           #2IMJF    IFNE *ZERO                      TH Unused Nbr 8
     C           A1IMJF    CABNE#2IMJF    CD020            TH Unused Nbr 8
     C                     END
     C           #2IRGF    IFNE *ZERO                      TH Unused Nbr 9
     C           A1IRGF    CABNE#2IRGF    CD020            TH Unused Nbr 9
     C                     END
     C           #2KRJF    IFNE *ZERO                      TH Unused Nbr 1
     C           A1KRJF    CABNE#2KRJF    CD020            TH Unused Nbr 1
     C                     END
     C           #2OJRF    IFNE *ZERO                      TH Break Even P
     C           A1OJRF    CABNE#2OJRF    CD020            TH Break Even P
     C                     END
     C           #2KFOR    IFNE *ZERO                      TH Meat Value F
     C           A1KFOR    CABNE#2KFOR    CD020            TH Meat Value F
     C                     END
     C           #2ORJK    IFNE *ZERO                      TH Yld Parm Adj
     C           A1ORJK    CABNE#2ORJK    CD020            TH Yld Parm Adj
     C                     END
     C           #2OMVJ    IFNE *ZERO                      TH PHA Sort Dis
     C           A1OMVJ    CABNE#2OMVJ    CD020            TH PHA Sort Dis
     C                     END
     C           #2MVNF    IFNE *ZERO                      TH Avg Loin Eye
     C           A1MVNF    CABNE#2MVNF    CD020            TH Avg Loin Eye
     C                     END
     C           #2MCNF    IFNE *ZERO                      TH Avg Backfat
     C           A1MCNF    CABNE#2MCNF    CD020            TH Avg Backfat
     C                     END
     C           #2NCNF    IFNE *ZERO                      TH HITCH Old Pa
     C           A1NCNF    CABNE#2NCNF    CD020            TH HITCH Old Pa
     C                     END
     C           #2NCHF    IFNE *ZERO                      TH MPR Sort Los
     C           A1NCHF    CABNE#2NCHF    CD020            TH MPR Sort Los
     C                     END
     C           #2IGIR    IFNE *ZERO                      TH Unused Nbr 1
     C           A1IGIR    CABNE#2IGIR    CD020            TH Unused Nbr 1
     C                     END
     C           #2KFJR    IFNE *ZERO                      TH Unused Nbr 2
     C           A1KFJR    CABNE#2KFJR    CD020            TH Unused Nbr 2
     C                     END
     C           #2EADT    IFNE *ZERO                      TH Cold Scl Upl
     C           A1EADT    CABNE#2EADT    CD020            TH Cold Scl Upl
     C                     END
     C           #2EBDT    IFNE *ZERO                      TH Cold Scl Upl
     C           A1EBDT    CABNE#2EBDT    CD020            TH Cold Scl Upl
     C                     END
     C           #2ECDT    IFNE *ZERO                      TH Head LFT
     C           A1ECDT    CABNE#2ECDT    CD020            TH Head LFT
     C                     END
     C           #2EDDT    IFNE *ZERO                      TH Head EUT/KOA
     C           A1EDDT    CABNE#2EDDT    CD020            TH Head EUT/KOA
     C                     END
     C           #2EEDT    IFNE *ZERO                      TH Unused Date
     C           A1EEDT    CABNE#2EEDT    CD020            TH Unused Date
     C                     END
     C           #2U4ST    IFNE *BLANK                     TH Unused Sts 1
     C           A1U4ST    CABNE#2U4ST    CD020            TH Unused Sts 1
     C                     END
     C           #2U5ST    IFNE *BLANK                     TH Unused Sts 2
     C           A1U5ST    CABNE#2U5ST    CD020            TH Unused Sts 2
     C                     END
     C           #2U6ST    IFNE *BLANK                     TH Unused Sts 3
     C           A1U6ST    CABNE#2U6ST    CD020            TH Unused Sts 3
     C                     END
     C           #2U7ST    IFNE *BLANK                     TH Unused Sts 4
     C           A1U7ST    CABNE#2U7ST    CD020            TH Unused Sts 4
     C                     END
     C           #2U8ST    IFNE *BLANK                     TH Unused Sts 5
     C           A1U8ST    CABNE#2U8ST    CD020            TH Unused Sts 5
     C                     END
     C           #2U9ST    IFNE *BLANK                     TH Unused Sts 6
     C           A1U9ST    CABNE#2U9ST    CD020            TH Unused Sts 6
     C                     END
     C           #2VAST    IFNE *BLANK                     TH Unused Sts 7
     C           A1VAST    CABNE#2VAST    CD020            TH Unused Sts 7
     C                     END
     C           #2VBST    IFNE *BLANK                     TH Unused Sts 8
     C           A1VBST    CABNE#2VBST    CD020            TH Unused Sts 8
     C                     END
     C           #2BDCD    IFNE *BLANK                     DF Defect Code
     C           A1BDCD    CABNE#2BDCD    CD020            DF Defect Code
     C                     END
     C           #2CSCD    IFNE *BLANK                     THP Process Cod
     C           A1CSCD    CABNE#2CSCD    CD020            THP Process Cod
     C                     END
     C           #2ACCD    IFNE *BLANK                     HB Buyer Code
     C           A1ACCD    CABNE#2ACCD    CD020            HB Buyer Code
     C                     END
     C           #2AGCD    IFNE *BLANK                     GN Genetic Code
     C           A1AGCD    CABNE#2AGCD    CD020            GN Genetic Code
     C                     END
     C           #2AAVN    IFNE *BLANK                     RS User Changed
     C           A1AAVN    CABNE#2AAVN    CD020            RS User Changed
     C                     END
     C           #2AADT    IFNE *ZERO                      RS Date Changed
     C           A1AADT    CABNE#2AADT    CD020            RS Date Changed
     C                     END
     C           #2AMTM    IFNE *ZERO                      RS Time Changed
     C           A1AMTM    CABNE#2AMTM    CD020            RS Time Changed
     C                     END
     C           #2AJST    IFNE *BLANK                     RS Record Statu
     C           A1AJST    CABNE#2AJST    CD020            RS Record Statu
     C                     END
     C           #2AHVN    IFNE *BLANK                     RS Job
     C           A1AHVN    CABNE#2AHVN    CD020            RS Job
     C                     END
     C           #2AGVN    IFNE *BLANK                     RS Program
     C           A1AGVN    CABNE#2AGVN    CD020            RS Program
     C                     END
     C           #2ABVN    IFNE *BLANK                     RS User Added
     C           A1ABVN    CABNE#2ABVN    CD020            RS User Added
     C                     END
     C           #2ABDT    IFNE *ZERO                      RS Date Added
     C           A1ABDT    CABNE#2ABDT    CD020            RS Date Added
     C                     END
     C           #2ABTM    IFNE *ZERO                      RS Time Added
     C           A1ABTM    CABNE#2ABTM    CD020            RS Time Added
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2B0DT    IFNE *ZERO                      TH Kill Date
     C           A1B0DT    CABNE#2B0DT    CD020            TH Kill Date
     C                     END
     C                     END
     C           #2LLST    IFNE *BLANK                     TH Hog Class Ty
     C           A1LLST    CABNE#2LLST    CD020            TH Hog Class Ty
     C                     END
     C           #2ABCD    IFNE *BLANK                     PD Producer Cod
     C           A1ABCD    CABNE#2ABCD    CD020            PD Producer Cod
     C                     END
     C           #2AECD    IFNE *BLANK                     PL Location Cod
     C           A1AECD    CABNE#2AECD    CD020            PL Location Cod
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
      * Output to subfile
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
      *
     C           CD020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
      * Read next record
     C                     READ @A1CPL0                8782*
     C                     END                             WOD
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD*ZERO     ##RROK  50
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN81     IFNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN81     CAIN81  1
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       9283*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Validate TH Kill Date
      * External date
     C                     Z-ADDV2B0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #2B0DT
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit subroutine:
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
     C                     END
      * Change of position specified
     C           WZCVNB    CASNE#2CVNB    FBRQRL           TH Tattoo Numbe
     C           WZBNNB    CASNE#2BNNB    FBRQRL           BOH Buy Order N
     C           WZBONB    CASNE#2BONB    FBRQRL           BOL Load Number
     C           WZAWDT    CASNE#2AWDT    FBRQRL           TH Purchase Dat
     C           WZBICD    CASNE#2BICD    FBRQRL           TH Group Refere
     C           WZCPST    CASNE#2CPST    FBRQRL           TH Live Purchas
     C           WZACPR    CASNE#2ACPR    FBRQRL           TH Live Purchas
     C           WZB9PR    CASNE#2B9PR    FBRQRL           TH Live Gross A
     C           WZCAPR    CASNE#2CAPR    FBRQRL           TH LIve Net Amt
     C           WZC4ST    CASNE#2C4ST    FBRQRL           TH Resale UOM
     C           WZAIPR    CASNE#2AIPR    FBRQRL           TH Recalc Live
     C           WZA6DT    CASNE#2A6DT    FBRQRL           TH Pricing Date
     C           WZC2ST    CASNE#2C2ST    FBRQRL           TH Resale Sprea
     C           WZCXNB    CASNE#2CXNB    FBRQRL           TH Dead On Arri
     C           WZCWNB    CASNE#2CWNB    FBRQRL           TH Head Receive
     C           WZFCNB    CASNE#2FCNB    FBRQRL           TH Yard Deads
     C           WZH9NB    CASNE#2H9NB    FBRQRL           TH Held Over
     C           WZFDNB    CASNE#2FDNB    FBRQRL           TH Head Condemn
     C           WZFENB    CASNE#2FENB    FBRQRL           TH Head Killed
     C           WZHENB    CASNE#2HENB    FBRQRL           TH Head Adds
     C           WZHFNB    CASNE#2HFNB    FBRQRL           TH Head Accepte
     C           WZCYNB    CASNE#2CYNB    FBRQRL           TH Live Wgt
     C           WZLRNB    CASNE#2LRNB    FBRQRL           TH Adj Live Wgt
     C           WZE0NB    CASNE#2E0NB    FBRQRL           TH Hot Wgt
     C           WZA5PC    CASNE#2A5PC    FBRQRL           TH Tot Loin Eye
     C           WZFBNB    CASNE#2FBNB    FBRQRL           TH Tot Backfat
     C           WZA4PC    CASNE#2A4PC    FBRQRL           TH Tot Light Re
     C           WZF7NB    CASNE#2F7NB    FBRQRL           TH Avg Live Wgt
     C           WZHDNB    CASNE#2HDNB    FBRQRL           TH Avg Hot Wgt
     C           WZF5NB    CASNE#2F5NB    FBRQRL           TH Avg Light Re
     C           WZF4NB    CASNE#2F4NB    FBRQRL           TH Avg Lean Per
     C           WZF3NB    CASNE#2F3NB    FBRQRL           TH Avg Loin Eye
     C           WZF2NB    CASNE#2F2NB    FBRQRL           TH Avg Backfat
     C           WZAVPC    CASNE#2AVPC    FBRQRL           TH Std Yield Pe
     C           WZAWPC    CASNE#2AWPC    FBRQRL           TH Actual Yield
     C           WZCWPC    CASNE#2CWPC    FBRQRL           TH Adj Actual Y
     C           WZA8PC    CASNE#2A8PC    FBRQRL           TH Yield Differ
     C           WZA7PC    CASNE#2A7PC    FBRQRL           TH Recalc Live
     C           WZB8PR    CASNE#2B8PR    FBRQRL           TH CM Market Pr
     C           WZAMPR    CASNE#2AMPR    FBRQRL           TH CM Base Mkt
     C           WZANPR    CASNE#2ANPR    FBRQRL           TH CM Base Mkt
     C           WZAYVA    CASNE#2AYVA    FBRQRL           TH CM Sort Disc
     C           WZAWVA    CASNE#2AWVA    FBRQRL           TH CM Yield Gai
     C           WZAOPR    CASNE#2AOPR    FBRQRL           TH CM Base Carc
     C           WZAXVA    CASNE#2AXVA    FBRQRL           TH CM LN AddOn/
     C           WZAPPR    CASNE#2APPR    FBRQRL           TH CM Carcass G
     C           WZASPR    CASNE#2ASPR    FBRQRL           TH Deduction Am
     C           WZA4VA    CASNE#2A4VA    FBRQRL           TH Total Net WO
     C           WZATPR    CASNE#2ATPR    FBRQRL           TH Carcass Net
     C           WZA5VA    CASNE#2A5VA    FBRQRL           TH Additions Am
     C           WZCBPR    CASNE#2CBPR    FBRQRL           TH Payment Gros
     C           WZCCPR    CASNE#2CCPR    FBRQRL           Th Payment Net
     C           WZLPNB    CASNE#2LPNB    FBRQRL           TH AP Voucher/D
     C           WZCDPR    CASNE#2CDPR    FBRQRL           TH Freight Amou
     C           WZA7VA    CASNE#2A7VA    FBRQRL           TH Accrual Amou
     C           WZA2PR    CASNE#2A2PR    FBRQRL           TH Fixed Cost A
     C           WZJWST    CASNE#2JWST    FBRQRL           TH Calc Net Sts
     C           WZCWST    CASNE#2CWST    FBRQRL           TH Payment Sts
     C           WZD7ST    CASNE#2D7ST    FBRQRL           TH Header Error
     C           WZD8ST    CASNE#2D8ST    FBRQRL           TH Detail Error
     C           WZDWST    CASNE#2DWST    FBRQRL           TH Kill Balanci
     C           WZD6ST    CASNE#2D6ST    FBRQRL           TH Bal to Kill
     C           WZGHNB    CASNE#2GHNB    FBRQRL           TH Commission A
     C           WZBYDT    CASNE#2BYDT    FBRQRL           TH Voucher Paym
     C           WZE0ST    CASNE#2E0ST    FBRQRL           TH User Error O
     C           WZE1ST    CASNE#2E1ST    FBRQRL           TH Held Over Re
     C           WZE2ST    CASNE#2E2ST    FBRQRL           TH Sex
     C           WZBSDT    CASNE#2BSDT    FBRQRL           TH Held/Ovr Com
     C           WZBTDT    CASNE#2BTDT    FBRQRL           TH Commission P
     C           WZBUDT    CASNE#2BUDT    FBRQRL           TH Actual Check
     C           WZHGNB    CASNE#2HGNB    FBRQRL           TH Shipped Weig
     C           WZHHNB    CASNE#2HHNB    FBRQRL           TH Avg Hot Wgt
     C           WZHINB    CASNE#2HINB    FBRQRL           TH FFLI
     C           WZA3PR    CASNE#2A3PR    FBRQRL           TH Kill Product
     C           WZA4PR    CASNE#2A4PR    FBRQRL           TH Cut Product
     C           WZA6PR    CASNE#2A6PR    FBRQRL           TH Render Produ
     C           WZJ9NB    CASNE#2J9NB    FBRQRL           TH Head Exclude
     C           WZD6PR    CASNE#2D6PR    FBRQRL           TH CM Bse Mkt L
     C           WZD7PR    CASNE#2D7PR    FBRQRL           TH CM Bse Mkt C
     C           WZD8PR    CASNE#2D8PR    FBRQRL           TH CM Srt Dsc L
     C           WZD9PR    CASNE#2D9PR    FBRQRL           TH CM Srt Dsc C
     C           WZEAPR    CASNE#2EAPR    FBRQRL           TH CM Yld G/L L
     C           WZEBPR    CASNE#2EBPR    FBRQRL           TH CM Yld G/L C
     C           WZECPR    CASNE#2ECPR    FBRQRL           TH CM Crc Val L
     C           WZEDPR    CASNE#2EDPR    FBRQRL           TH CM Crc Val C
     C           WZEEPR    CASNE#2EEPR    FBRQRL           TH CM Lean Prem
     C           WZEFPR    CASNE#2EFPR    FBRQRL           TH CM Lean Prem
     C           WZEGPR    CASNE#2EGPR    FBRQRL           TH CM Gross Liv
     C           WZEHPR    CASNE#2EHPR    FBRQRL           TH CM Gross Car
     C           WZKAST    CASNE#2KAST    FBRQRL           TH Source Type
     C           WZJ7ST    CASNE#2J7ST    FBRQRL           TH Scale Ticket
     C           WZJ9ST    CASNE#2J9ST    FBRQRL           TH Payment Type
     C           WZOXNB    CASNE#2OXNB    FBRQRL           TH HPS Movement
     C           WZLKST    CASNE#2LKST    FBRQRL           TH Source Code
     C           WZJ8ST    CASNE#2J8ST    FBRQRL           TH Posted to HP
     C           WZLIST    CASNE#2LIST    FBRQRL           TH Schedule Kil
     C           WZLJST    CASNE#2LJST    FBRQRL           TH Shift Held O
     C           WZNZTX    CASNE#2NZTX    FBRQRL           TH State
     C           WZHJCD    CASNE#2HJCD    FBRQRL           TH Unused Code
     C           WZR4ST    CASNE#2R4ST    FBRQRL           TH Unused Sts 2
     C           WZR5ST    CASNE#2R5ST    FBRQRL           TH Commission S
     C           WZR6ST    CASNE#2R6ST    FBRQRL           TH Paid 2 Week
     C           WZR7ST    CASNE#2R7ST    FBRQRL           TH Unused Sts 1
     C           WZTHWT    CASNE#2THWT    FBRQRL           TH DOA Weight
     C           WZT2WT    CASNE#2T2WT    FBRQRL           TH Avg Lean % E
     C           WZTHHD    CASNE#2THHD    FBRQRL           TH HPS Farm Sit
     C           WZT2HD    CASNE#2T2HD    FBRQRL           TH Shift Held O
     C           WZOBPR    CASNE#2OBPR    FBRQRL           TH Sorting Amou
     C           WZKOER    CASNE#2KOER    FBRQRL           TH Head Identif
     C           WZOPIR    CASNE#2OPIR    FBRQRL           TH Percent Iden
     C           WZOPEM    CASNE#2OPEM    FBRQRL           TH Percent Acce
     C           WZIORP    CASNE#2IORP    FBRQRL           TH Head Adjuste
     C           WZOWEO    CASNE#2OWEO    FBRQRL           TH PHA Head Add
     C           WZOQET    CASNE#2OQET    FBRQRL           TH PHA Add Type
     C           WZURST    CASNE#2URST    FBRQRL           TH PHA Average
     C           WZUSST    CASNE#2USST    FBRQRL           TH PHA Add Reas
     C           WZHHPC    CASNE#2HHPC    FBRQRL           TH PHA Yield Pe
     C           WZS9PR    CASNE#2S9PR    FBRQRL           TH PHA Lean Prm
     C           WZTAPR    CASNE#2TAPR    FBRQRL           TH VC Gross Val
     C           WZTBPR    CASNE#2TBPR    FBRQRL           TH Excluded Gro
     C           WZJFUR    CASNE#2JFUR    FBRQRL           TH Avg Lean %
     C           WZKRIF    CASNE#2KRIF    FBRQRL           TH Broken Back
     C           WZKORF    CASNE#2KORF    FBRQRL           TH Hot Scl Uplo
     C           WZKAPR    CASNE#2KAPR    FBRQRL           TH Unused Nbr 4
     C           WZKROT    CASNE#2KROT    FBRQRL           TH Excluded Car
     C           WZOTJG    CASNE#2OTJG    FBRQRL           TH Excluded Pre
     C           WZIRJG    CASNE#2IRJG    FBRQRL           TH Unused Nbr 7
     C           WZIMJF    CASNE#2IMJF    FBRQRL           TH Unused Nbr 8
     C           WZIRGF    CASNE#2IRGF    FBRQRL           TH Unused Nbr 9
     C           WZKRJF    CASNE#2KRJF    FBRQRL           TH Unused Nbr 1
     C           WZOJRF    CASNE#2OJRF    FBRQRL           TH Break Even P
     C           WZKFOR    CASNE#2KFOR    FBRQRL           TH Meat Value F
     C           WZORJK    CASNE#2ORJK    FBRQRL           TH Yld Parm Adj
     C           WZOMVJ    CASNE#2OMVJ    FBRQRL           TH PHA Sort Dis
     C           WZMVNF    CASNE#2MVNF    FBRQRL           TH Avg Loin Eye
     C           WZMCNF    CASNE#2MCNF    FBRQRL           TH Avg Backfat
     C           WZNCNF    CASNE#2NCNF    FBRQRL           TH HITCH Old Pa
     C           WZNCHF    CASNE#2NCHF    FBRQRL           TH MPR Sort Los
     C           WZIGIR    CASNE#2IGIR    FBRQRL           TH Unused Nbr 1
     C           WZKFJR    CASNE#2KFJR    FBRQRL           TH Unused Nbr 2
     C           WZEADT    CASNE#2EADT    FBRQRL           TH Cold Scl Upl
     C           WZEBDT    CASNE#2EBDT    FBRQRL           TH Cold Scl Upl
     C           WZECDT    CASNE#2ECDT    FBRQRL           TH Head LFT
     C           WZEDDT    CASNE#2EDDT    FBRQRL           TH Head EUT/KOA
     C           WZEEDT    CASNE#2EEDT    FBRQRL           TH Unused Date
     C           WZU4ST    CASNE#2U4ST    FBRQRL           TH Unused Sts 1
     C           WZU5ST    CASNE#2U5ST    FBRQRL           TH Unused Sts 2
     C           WZU6ST    CASNE#2U6ST    FBRQRL           TH Unused Sts 3
     C           WZU7ST    CASNE#2U7ST    FBRQRL           TH Unused Sts 4
     C           WZU8ST    CASNE#2U8ST    FBRQRL           TH Unused Sts 5
     C           WZU9ST    CASNE#2U9ST    FBRQRL           TH Unused Sts 6
     C           WZVAST    CASNE#2VAST    FBRQRL           TH Unused Sts 7
     C           WZVBST    CASNE#2VBST    FBRQRL           TH Unused Sts 8
     C           WZBDCD    CASNE#2BDCD    FBRQRL           DF Defect Code
     C           WZCSCD    CASNE#2CSCD    FBRQRL           THP Process Cod
     C           WZACCD    CASNE#2ACCD    FBRQRL           HB Buyer Code
     C           WZAGCD    CASNE#2AGCD    FBRQRL           GN Genetic Code
     C           WZAAVN    CASNE#2AAVN    FBRQRL           RS User Changed
     C           WZAADT    CASNE#2AADT    FBRQRL           RS Date Changed
     C           WZAMTM    CASNE#2AMTM    FBRQRL           RS Time Changed
     C           WZAJST    CASNE#2AJST    FBRQRL           RS Record Statu
     C           WZAHVN    CASNE#2AHVN    FBRQRL           RS Job
     C           WZAGVN    CASNE#2AGVN    FBRQRL           RS Program
     C           WZABVN    CASNE#2ABVN    FBRQRL           RS User Added
     C           WZABDT    CASNE#2ABDT    FBRQRL           RS Date Added
     C           WZABTM    CASNE#2ABTM    FBRQRL           RS Time Added
     C           WZHMNB    CASNE#2HMNB    FBRQRL           BOH Company Num
     C           WZB0DT    CASNE#2B0DT    FBRQRL           TH Kill Date
     C           WZLLST    CASNE#2LLST    FBRQRL           TH Hog Class Ty
     C           WZABCD    CASNE#2ABCD    FBRQRL           PD Producer Cod
     C           WZAECD    CASNE#2AECD    FBRQRL           PL Location Cod
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCSFRC
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
      * Read next record
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCSFRC    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKINDS    *IN,36
     C                     SETOF                     84    *
      * Check selection option
     C           #1SEL     CASEQ'1'       DESLRC
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DESLRC    BEGSR
      *================================================================
      * Select record & return to calling program
      *================================================================
      * Move record values to parameters
     C                     Z-ADD#1HMNB    P1HMNB           BOH Company Num
     C                     Z-ADD#1CVNB    P1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    P1B0DT           TH Kill Date
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A1CPL0 fields to #SFLRCD
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDA1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELA1BICD    #1BICD           TH Group Refere
     C                     MOVELA1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDA1ACPR    #1ACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    #1B9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    #1CAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    #1CXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDA1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDA1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDA1FENB    #1FENB           TH Head Killed
     C                     Z-ADDA1HENB    #1HENB           TH Head Adds
     C                     Z-ADDA1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    #1LRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    #1A5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    #1CWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    #1B8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDA1CBPR    #1CBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    #1CCPR           Th Payment Net
     C                     Z-ADDA1LPNB    #1LPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    #1CDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELA1JWST    #1JWST           TH Calc Net Sts
     C                     MOVELA1CWST    #1CWST           TH Payment Sts
     C                     MOVELA1D7ST    #1D7ST           TH Header Error
     C                     MOVELA1D8ST    #1D8ST           TH Detail Error
     C                     MOVELA1DWST    #1DWST           TH Kill Balanci
     C                     MOVELA1D6ST    #1D6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDA1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELA1E0ST    #1E0ST           TH User Error O
     C                     MOVELA1E1ST    #1E1ST           TH Held Over Re
     C                     MOVELA1E2ST    #1E2ST           TH Sex
     C                     Z-ADDA1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDA1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDA1HGNB    #1HGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    #1HINB           TH FFLI
     C                     Z-ADDA1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDA1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDA1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDA1J9NB    #1J9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    #1D6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    #1D7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    #1D8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    #1D9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    #1EAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    #1EBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    #1ECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    #1EDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    #1EEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    #1EFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    #1EGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    #1EHPR           TH CM Gross Car
     C                     MOVELA1KAST    #1KAST           TH Source Type
     C                     MOVELA1J7ST    #1J7ST           TH Scale Ticket
     C                     MOVELA1J9ST    #1J9ST           TH Payment Type
     C                     Z-ADDA1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELA1LKST    #1LKST           TH Source Code
     C                     MOVELA1J8ST    #1J8ST           TH Posted to HP
     C                     MOVELA1LIST    #1LIST           TH Schedule Kil
     C                     MOVELA1LJST    #1LJST           TH Shift Held O
     C                     MOVELA1NZTX    #1NZTX           TH State
     C                     MOVELA1HJCD    #1HJCD           TH Unused Code
     C                     MOVELA1R4ST    #1R4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    #1R5ST           TH Commission S
     C                     MOVELA1R6ST    #1R6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    #1R7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    #1THWT           TH DOA Weight
     C                     Z-ADDA1T2WT    #1T2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    #1THHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    #1T2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    #1OBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    #1KOER           TH Head Identif
     C                     Z-ADDA1OPIR    #1OPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    #1OPEM           TH Percent Acce
     C                     Z-ADDA1IORP    #1IORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    #1OWEO           TH PHA Head Add
     C                     MOVELA1OQET    #1OQET           TH PHA Add Type
     C                     MOVELA1URST    #1URST           TH PHA Average
     C                     MOVELA1USST    #1USST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    #1HHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    #1S9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    #1TAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    #1TBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    #1JFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    #1KRIF           TH Broken Back
     C                     Z-ADDA1KORF    #1KORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    #1KAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    #1KROT           TH Excluded Car
     C                     Z-ADDA1OTJG    #1OTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    #1IRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    #1IMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    #1IRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    #1KRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    #1OJRF           TH Break Even P
     C                     Z-ADDA1KFOR    #1KFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    #1ORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    #1OMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    #1MVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    #1MCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    #1NCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    #1NCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    #1IGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    #1KFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    #1EADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    #1EBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    #1ECDT           TH Head LFT
     C                     Z-ADDA1EDDT    #1EDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    #1EEDT           TH Unused Date
     C                     MOVELA1U4ST    #1U4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    #1U5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    #1U6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    #1U7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    #1U8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    #1U9ST           TH Unused Sts 6
     C                     MOVELA1VAST    #1VAST           TH Unused Sts 7
     C                     MOVELA1VBST    #1VBST           TH Unused Sts 8
     C                     MOVELA1BDCD    #1BDCD           DF Defect Code
     C                     MOVELA1CSCD    #1CSCD           THP Process Cod
     C                     MOVELA1ACCD    #1ACCD           HB Buyer Code
     C                     MOVELA1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELA1BECD    #1BECD           HC Class Code
     C                     MOVELA1AAVN    #1AAVN           RS User Changed
     C                     Z-ADDA1AADT    #1AADT           RS Date Changed
     C                     Z-ADDA1AMTM    #1AMTM           RS Time Changed
     C                     MOVELA1AJST    #1AJST           RS Record Statu
     C                     MOVELA1AHVN    #1AHVN           RS Job
     C                     MOVELA1AGVN    #1AGVN           RS Program
     C                     MOVELA1ABVN    #1ABVN           RS User Added
     C                     Z-ADDA1ABDT    #1ABDT           RS Date Added
     C                     Z-ADDA1ABTM    #1ABTM           RS Time Added
     C                     Z-ADDA1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDA1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADDA1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    #1BONB           BOL Load Number
     C                     MOVELA1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELA1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELA1AECD    #1AECD           PL Location Cod
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP1CVNB    #2CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #2BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #2BONB           BOL Load Number
     C                     Z-ADD*ZERO     #2AWDT           TH Purchase Dat
     C                     MOVEL*BLANK    #2BICD           TH Group Refere
     C                     MOVEL*BLANK    #2CPST           TH Live Purchas
     C                     Z-ADD*ZERO     #2ACPR           TH Live Purchas
     C                     Z-ADD*ZERO     #2B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     #2CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    #2C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #2AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #2A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #2C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     #2CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #2CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #2FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #2H9NB           TH Held Over
     C                     Z-ADD*ZERO     #2FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #2FENB           TH Head Killed
     C                     Z-ADD*ZERO     #2HENB           TH Head Adds
     C                     Z-ADD*ZERO     #2HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     #2CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #2LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     #2E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #2A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     #2FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #2A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #2F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     #2HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #2F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #2F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #2F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #2F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #2AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #2AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     #2CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     #2A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #2A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #2B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     #2AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #2ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #2AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #2AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #2AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #2AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #2APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #2ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #2A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #2ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #2A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #2CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     #2CCPR           Th Payment Net
     C                     Z-ADD*ZERO     #2LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     #2CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     #2A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     #2A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    #2JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    #2CWST           TH Payment Sts
     C                     MOVEL*BLANK    #2D7ST           TH Header Error
     C                     MOVEL*BLANK    #2D8ST           TH Detail Error
     C                     MOVEL*BLANK    #2DWST           TH Kill Balanci
     C                     MOVEL*BLANK    #2D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #2GHNB           TH Commission A
     C                     Z-ADD*ZERO     #2BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #2E0ST           TH User Error O
     C                     MOVEL*BLANK    #2E1ST           TH Held Over Re
     C                     MOVEL*BLANK    #2E2ST           TH Sex
     C                     Z-ADD*ZERO     #2BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #2BTDT           TH Commission P
     C                     Z-ADD*ZERO     #2BUDT           TH Actual Check
     C                     Z-ADD*ZERO     #2HGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     #2HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #2HINB           TH FFLI
     C                     Z-ADD*ZERO     #2A3PR           TH Kill Product
     C                     Z-ADD*ZERO     #2A4PR           TH Cut Product
     C                     Z-ADD*ZERO     #2A6PR           TH Render Produ
     C                     Z-ADD*ZERO     #2J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     #2D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     #2D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     #2D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     #2D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     #2EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     #2EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     #2ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     #2EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     #2EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #2EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #2EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     #2EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    #2KAST           TH Source Type
     C                     MOVEL*BLANK    #2J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #2J9ST           TH Payment Type
     C                     Z-ADD*ZERO     #2OXNB           TH HPS Movement
     C                     MOVEL*BLANK    #2LKST           TH Source Code
     C                     MOVEL*BLANK    #2J8ST           TH Posted to HP
     C                     MOVEL*BLANK    #2LIST           TH Schedule Kil
     C                     MOVEL*BLANK    #2LJST           TH Shift Held O
     C                     MOVEL*BLANK    #2NZTX           TH State
     C                     MOVEL*BLANK    #2HJCD           TH Unused Code
     C                     MOVEL*BLANK    #2R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #2R5ST           TH Commission S
     C                     MOVEL*BLANK    #2R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #2R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #2THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #2T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #2THHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     #2T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #2OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #2KOER           TH Head Identif
     C                     Z-ADD*ZERO     #2OPIR           TH Percent Iden
     C                     Z-ADD*ZERO     #2OPEM           TH Percent Acce
     C                     Z-ADD*ZERO     #2IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #2OWEO           TH PHA Head Add
     C                     MOVEL*BLANK    #2OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #2URST           TH PHA Average
     C                     MOVEL*BLANK    #2USST           TH PHA Add Reas
     C                     Z-ADD*ZERO     #2HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #2S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #2TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #2TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #2JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #2KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #2KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #2KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #2KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #2OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #2IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #2IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #2IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #2KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #2OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #2KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #2ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #2OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #2MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #2MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #2NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #2NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #2IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #2KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #2EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #2EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #2ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #2EDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     #2EEDT           TH Unused Date
     C                     MOVEL*BLANK    #2U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #2U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #2U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #2U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #2U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #2U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #2VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #2VBST           TH Unused Sts 8
     C                     MOVEL*BLANK    #2BDCD           DF Defect Code
     C                     MOVEL*BLANK    #2CSCD           THP Process Cod
     C                     MOVEL*BLANK    #2ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #2AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #2AAVN           RS User Changed
     C                     Z-ADD*ZERO     #2AADT           RS Date Changed
     C                     Z-ADD*ZERO     #2AMTM           RS Time Changed
     C                     MOVEL*BLANK    #2AJST           RS Record Statu
     C                     MOVEL*BLANK    #2AHVN           RS Job
     C                     MOVEL*BLANK    #2AGVN           RS Program
     C                     MOVEL*BLANK    #2ABVN           RS User Added
     C                     Z-ADD*ZERO     #2ABDT           RS Date Added
     C                     Z-ADD*ZERO     #2ABTM           RS Time Added
     C                     Z-ADDP1HMNB    #2HMNB           BOH Company Num
     C                     Z-ADDP1B0DT    #2B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2B0DT
     C                     MOVEL*BLANK    #2LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #2ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #2AECD           PL Location Cod
      * Drop ? from positioning key fields
      * Convert fields to external form to initialise search
     C                     EXSR MOCV#2
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #2B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2B0DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/07/20 Increased Buy Order Number field length from
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C           9         ADD  ##WSR     ZHSTRW  40
     C           13        ADD  ##WSR     ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     MOVEL'Y'       YSL,1            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C                     WRITEASSUME
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YSL,1     IFEQ 'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD068       YWWDWD           Window width
     C                     Z-ADD017       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * Send message '*No value selected'
     C                     MOVEL'Y2U0016' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0016' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * Program mode
     C                     MOVEL'SEL'     W0PMD   3
      *
     C                     Z-ADD05        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Clear subfile control fields
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
