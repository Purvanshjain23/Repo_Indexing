     H/TITLE Prt Pick List-NoLdGUY PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/24/11  Time  : 11:56:48
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPLQIF  E           K        DISK
      * RSQ : Order Header TRG          Co.,Order,Cust. - Sel Pi
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPCPCPL1IF  E           K        DISK
      * RTV : Order Detail Comment      Retrieval index       NV
      *
     FPDL8CPL5IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FPNV2PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Pick List-NoLdGUY PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UAD         6 34               Name/Address
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Load ID
     I                                    P   1   40P1RMNB
     IP2PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P2AIC3
      * I : RST Order Number
     I                                    P   3   60P2C4NB
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0001
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0002
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0003
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0004
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0005
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0006
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0007
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0008
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0009
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0010
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0011
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0012
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0013
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0014
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0015
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0016
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0017
      * Production AgeDte To
     I                                    P   5   80ZA0018
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P2AIC3    PARM           WP0002  30       Company Number
     C           P2C4NB    PARM           WP0003  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Pick List-NoLdGUY PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$TENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Pick List-NoLdGUY PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIC3    WQKA01           Company Number
     C           *LIKE     DEFN BEC4NB    WQKA02           Order Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQKA01           Company Number
     C                     Z-ADDP2C4NB    WQKA02           Order Number
      * Establish starting position
     C           KRSA      SETLL@BFCPY8                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
     C                     MOVEL'Y'       W0AL02  1        Ship To Custome
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $SCDWG           USR Weight Accu
     C                     Z-ADD*ZERO     $SA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     $SWUNB           USR Weight Bill
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $DAIC3           Company Number
     C                     Z-ADDBEC4NB    $DC4NB           Order Number
     C                     MOVELBEJNCD    $DJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $DANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $DBKC7           Ship To Custome
     C                     MOVELBEHMNA    $DHMNA           Ship To Address
     C                     MOVELBEHONA    $DHONA           Ship To Address
     C                     MOVELBEHPNA    $DHPNA           Ship To Address
     C                     MOVELBEHNNA    $DHNNA           Ship To City
     C                     MOVELBEDBCD    $DDBCD           Ship To State C
     C                     MOVELBECKTX    $DCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $DB0C7           Bill to Custome
     C                     MOVELBEAETX    $DAETX           Bill to Name
     C                     MOVELBEB1NA    $DB1NA           Bill to Address
     C                     MOVELBEB3NA    $DB3NA           Bill to Address
     C                     MOVELBEB4NA    $DB4NA           Bill to Address
     C                     MOVELBEB2NA    $DB2NA           Bill to City
     C                     MOVELBEBHCD    $DBHCD           Bill to State C
     C                     MOVELBEC8TX    $DC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $DBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $DA0DT           Order Date
     C                     Z-ADDBEA5DT    $DA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $DGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $DACDT           Cancel Date
     C                     MOVELBEAQCD    $DAQCD           Terms Code
     C                     MOVELBEB6NA    $DB6NA           Special Instruc
     C                     MOVELBEBYNA    $DBYNA           Special Instruc
     C                     MOVELBEBZNA    $DBZNA           Carrier Code
     C                     MOVELBEGTST    $DGTST           Comment Print A
     C                     MOVELBEGVST    $DGVST           Comment Print I
     C                     MOVELBEGUST    $DGUST           Comment Print P
     C                     MOVELBEQFST    $DQFST           Comment Print S
     C                     MOVELBECQCD    $DCQCD           Reason Code
     C                     MOVELBEGJST    $DGJST           Order in Use
     C                     MOVELBEGWST    $DGWST           Header Status
     C                     MOVELBEGXST    $DGXST           Header Status L
     C                     MOVELBEGYST    $DGYST           Order Type Prin
     C                     Z-ADDBEAODT    $DAODT           Scheduled Ship
     C                     MOVELBEAIVN    $DAIVN           User Original E
     C                     Z-ADDBECXDT    $DCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $DJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $DA1WG           Order Weight To
     C                     MOVELBEXIST    $DXIST           Credit Hold
     C                     MOVELBEXJST    $DXJST           Production Hold
     C                     MOVELBEXKST    $DXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $DEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $DAFTM           Requested Deliv
     C                     MOVELBEE8CD    $DE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $DE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $DRMNB           Load ID
     C                     Z-ADDBETBNB    $DTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $DR1NB           Rated Freight
     C                     MOVELBEPJST    $DPJST           LTL Flag
     C                     MOVELBEU0ST    $DU0ST           Price Audit
     C                     MOVELBEU1ST    $DU1ST           Price Status
     C                     MOVELBEQ2CD    $DQ2CD           Shipping Method
     C                     MOVEL*BLANK    $DAJCD           Warehouse Code
     C                     MOVELBEBRTX    $DBRTX           Ship To Name
     C                     MOVELBEU2ST    $DU2ST           Export Status
     C                     MOVELBEVEST    $DVEST           Palletize
     C                     MOVELBEVFST    $DVFST           Shrink Wrap
     C                     MOVELBEVGST    $DVGST           Slip Sheet
     C                     MOVELBERPCD    $DRPCD           Age Code
     C                     Z-ADDBERNNB    $DRNNB           Reefer Temperat
     C                     MOVELBEVDST    $DVDST           Load Type
     C                     Z-ADDBEATIN    $DATIN           Attach to Invoi
     C                     MOVELBEU4ST    $DU4ST           Load Plan Order
     C                     MOVELBEU5ST    $DU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $DRSRN           Resell Referenc
     C                     MOVELBEMHNA    $DMHNA           Special Comment
     C                     MOVELBEMINA    $DMINA           Special Comment
     C                     MOVELBEWBST    $DWBST           Affect Auto Acc
     C                     MOVELBER4CD    $DR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $DBFCD           Manager Level C
     C                     MOVELBEQ4CD    $DQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $DT3NB           Attach to Order
     C                     MOVELBESICD    $DSICD           Reason for Pric
     C                     Z-ADDBECONB    $DCONB           Invoice Number
     C                     MOVELBECEST    $DCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $DAWDT           Invoice Date
     C                     MOVELBEJPCD    $DJPCD           Event Code
     C                     MOVELBEXUST    $DXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $DZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $DVRVA           A/R order Value
     C                     MOVELBEOBST    $DOBST           Billing Activit
     C                     MOVELBEBCST    $DBCST           Block Order Fla
     C                     MOVELBEBDST    $DBDST           Order Certifica
     C                     Z-ADDBEB7VL    $DB7VL           Invoice Order V
     C                     MOVELBEGASX    $DGASX           Invoice Price T
     C                     MOVELBEGBSX    $DGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $DGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $DGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $DFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $DFOSX           Email Cust On O
     C                     MOVELBEFPSX    $DFPSX           Order Emailed
     C                     MOVELBEFQSX    $DFQSX           Export Docs Go
     C                     MOVELBEFRSX    $DFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $DFSSX           Broker Order St
     C                     MOVELBEFTSX    $DFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $DFUSX           Signal Demand S
     C                     MOVELBEFVSX    $DFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $DFWSX           Export USDA App
     C                     MOVELBEFXSX    $DFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $DFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $DNODT           OH Unused Date
     C                     Z-ADDBENPDT    $DNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $DNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $DNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $DNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $DBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $DBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $DBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $DBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $DBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $DH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $DH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $DH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $DH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $DH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $DC0C7           Claim Number
     C                     MOVELBEUVST    $DUVST           EDI Status 1
     C                     MOVELBEUWST    $DUWST           EDI Status 2
     C                     MOVELBEUXST    $DUXST           EDI Status 3
     C                     Z-ADDBEAATM    $DAATM           Job Time
     C                     MOVELBEAYNA    $DAYNA           User Id
     C                     MOVELBEA0NA    $DA0NA           Job Name
     C                     Z-ADDBEAXDT    $DAXDT           Job Date
      * Load related totals format
     C                     Z-ADDBEAIC3    $OAIC3           Company Number
     C                     Z-ADDBEC4NB    $OC4NB           Order Number
     C                     MOVELBEJNCD    $OJNCD           Order Type - Sa
     C                     Z-ADDBEBKC7    $OBKC7           Ship To Custome
     C                     MOVELBEBCNA    $OBCNA           Customer Purcha
     C                     MOVEL*BLANK    $OGNNA           USR Compressed
     C                     MOVELBER4CD    $OR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $OMZNA           Sales Route Des
     C                     MOVEL*BLANK    $OGONA           USR Compressed
     C                     MOVEL*BLANK    $OGPNA           USR Compressed
     C                     MOVEL*BLANK    $OGQNA           USR Compressed
     C                     MOVEL*BLANK    $OGRNA           USR Compressed
     C                     MOVEL*BLANK    $ONWNA           USR Compressed
     C                     MOVEL*BLANK    $OCDTX           USR Telephone C
     C                     MOVELBEBRTX    $OBRTX           Ship To Name
     C                     MOVELBEHMNA    $OHMNA           Ship To Address
     C                     MOVELBEHONA    $OHONA           Ship To Address
     C                     MOVELBEHPNA    $OHPNA           Ship To Address
     C                     MOVELBEHNNA    $OHNNA           Ship To City
     C                     MOVELBEDBCD    $ODBCD           Ship To State C
     C                     MOVELBECKTX    $OCKTX           Ship To Zip/Pos
     C                     Z-ADDBEANC7    $OANC7           A/R Customer Nu
     C                     Z-ADDBEB0C7    $OB0C7           Bill to Custome
     C                     MOVELBEAETX    $OAETX           Bill to Name
     C                     MOVELBEB1NA    $OB1NA           Bill to Address
     C                     MOVELBEB3NA    $OB3NA           Bill to Address
     C                     MOVELBEB4NA    $OB4NA           Bill to Address
     C                     MOVELBEB2NA    $OB2NA           Bill to City
     C                     MOVELBEBHCD    $OBHCD           Bill to State C
     C                     MOVELBEC8TX    $OC8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    $OA0DT           Order Date
     C                     Z-ADDBEA5DT    $OA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $OGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $OACDT           Cancel Date
     C                     MOVELBEAQCD    $OAQCD           Terms Code
     C                     MOVELBEB6NA    $OB6NA           Special Instruc
     C                     MOVELBEBYNA    $OBYNA           Special Instruc
     C                     MOVELBEBZNA    $OBZNA           Carrier Code
     C                     MOVELBEGTST    $OGTST           Comment Print A
     C                     MOVELBEGVST    $OGVST           Comment Print I
     C                     MOVELBEGUST    $OGUST           Comment Print P
     C                     MOVELBEQFST    $OQFST           Comment Print S
     C                     MOVELBECQCD    $OCQCD           Reason Code
     C                     MOVELBEGJST    $OGJST           Order in Use
     C                     MOVELBEGWST    $OGWST           Header Status
     C                     MOVELBEGXST    $OGXST           Header Status L
     C                     MOVELBEGYST    $OGYST           Order Type Prin
     C                     Z-ADDBEAODT    $OAODT           Scheduled Ship
     C                     MOVELBEAIVN    $OAIVN           User Original E
     C                     Z-ADDBECXDT    $OCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $OJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $OA1WG           Order Weight To
     C                     MOVELBEXIST    $OXIST           Credit Hold
     C                     MOVELBEXJST    $OXJST           Production Hold
     C                     MOVELBEXKST    $OXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $OEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $OAFTM           Requested Deliv
     C                     MOVELBEE8CD    $OE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $OE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $ORMNB           Load ID
     C                     Z-ADDBETBNB    $OTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $OR1NB           Rated Freight
     C                     MOVELBEPJST    $OPJST           LTL Flag
     C                     MOVELBEU0ST    $OU0ST           Price Audit
     C                     MOVELBEU1ST    $OU1ST           Price Status
     C                     MOVELBEQ2CD    $OQ2CD           Shipping Method
     C                     MOVELBEU2ST    $OU2ST           Export Status
     C                     MOVELBEVEST    $OVEST           Palletize
     C                     MOVELBEVFST    $OVFST           Shrink Wrap
     C                     MOVELBEVGST    $OVGST           Slip Sheet
     C                     MOVELBERPCD    $ORPCD           Age Code
     C                     Z-ADDBERNNB    $ORNNB           Reefer Temperat
     C                     MOVELBEVDST    $OVDST           Load Type
     C                     Z-ADDBEATIN    $OATIN           Attach to Invoi
     C                     MOVELBEU4ST    $OU4ST           Load Plan Order
     C                     MOVELBEU5ST    $OU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $ORSRN           Resell Referenc
     C                     MOVELBEMHNA    $OMHNA           Special Comment
     C                     MOVELBEMINA    $OMINA           Special Comment
     C                     MOVELBEWBST    $OWBST           Affect Auto Acc
     C                     MOVELBEBFCD    $OBFCD           Manager Level C
     C                     MOVELBEQ4CD    $OQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $OT3NB           Attach to Order
     C                     MOVELBESICD    $OSICD           Reason for Pric
     C                     Z-ADDBECONB    $OCONB           Invoice Number
     C                     MOVELBECEST    $OCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $OAWDT           Invoice Date
     C                     MOVELBEJPCD    $OJPCD           Event Code
     C                     MOVELBEXUST    $OXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $OZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $OVRVA           A/R order Value
     C                     MOVELBEOBST    $OOBST           Billing Activit
     C                     MOVELBEBCST    $OBCST           Block Order Fla
     C                     MOVELBEBDST    $OBDST           Order Certifica
     C                     Z-ADDBEB7VL    $OB7VL           Invoice Order V
     C                     MOVELBEGASX    $OGASX           Invoice Price T
     C                     MOVELBEGBSX    $OGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $OGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $OGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $OFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $OFOSX           Email Cust On O
     C                     MOVELBEFPSX    $OFPSX           Order Emailed
     C                     MOVELBEFQSX    $OFQSX           Export Docs Go
     C                     MOVELBEFRSX    $OFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $OFSSX           Broker Order St
     C                     MOVELBEFTSX    $OFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $OFUSX           Signal Demand S
     C                     MOVELBEFVSX    $OFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $OFWSX           Export USDA App
     C                     MOVELBEFXSX    $OFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $OFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $ONODT           OH Unused Date
     C                     Z-ADDBENPDT    $ONPDT           OH Unused Date
     C                     Z-ADDBENQDT    $ONQDT           OH Unused Date
     C                     Z-ADDBENRDT    $ONRDT           OH Unused Date
     C                     Z-ADDBENSDT    $ONSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $OBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $OBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $OBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $OBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $OBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $OH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $OH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $OH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $OH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $OH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $OC0C7           Claim Number
     C                     MOVELBEUVST    $OUVST           EDI Status 1
     C                     MOVELBEUWST    $OUWST           EDI Status 2
     C                     MOVELBEUXST    $OUXST           EDI Status 3
     C                     Z-ADDBEAATM    $OAATM           Job Time
     C                     MOVELBEAYNA    $OAYNA           User Id
     C                     MOVELBEA0NA    $OA0NA           Job Name
     C                     Z-ADDBEAXDT    $OAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $EAIC3           Company Number
     C                     Z-ADDBEC4NB    $EC4NB           Order Number
     C                     MOVELBEJNCD    $EJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $EANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $EBKC7           Ship To Custome
     C                     MOVELBEBRTX    $EBRTX           Ship To Name
     C                     MOVELBEHMNA    $EHMNA           Ship To Address
     C                     MOVELBEHONA    $EHONA           Ship To Address
     C                     MOVELBEHPNA    $EHPNA           Ship To Address
     C                     MOVELBEHNNA    $EHNNA           Ship To City
     C                     MOVELBEDBCD    $EDBCD           Ship To State C
     C                     MOVELBECKTX    $ECKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $EB0C7           Bill to Custome
     C                     MOVELBEAETX    $EAETX           Bill to Name
     C                     MOVELBEB1NA    $EB1NA           Bill to Address
     C                     MOVELBEB3NA    $EB3NA           Bill to Address
     C                     MOVELBEB4NA    $EB4NA           Bill to Address
     C                     MOVELBEB2NA    $EB2NA           Bill to City
     C                     MOVELBEBHCD    $EBHCD           Bill to State C
     C                     MOVELBEC8TX    $EC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $EBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $EA0DT           Order Date
     C                     Z-ADDBEA5DT    $EA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $EGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $EACDT           Cancel Date
     C                     MOVELBEAQCD    $EAQCD           Terms Code
     C                     MOVELBEB6NA    $EB6NA           Special Instruc
     C                     MOVELBEBYNA    $EBYNA           Special Instruc
     C                     MOVELBEBZNA    $EBZNA           Carrier Code
     C                     MOVELBEGTST    $EGTST           Comment Print A
     C                     MOVELBEGVST    $EGVST           Comment Print I
     C                     MOVELBEGUST    $EGUST           Comment Print P
     C                     MOVELBEQFST    $EQFST           Comment Print S
     C                     MOVELBECQCD    $ECQCD           Reason Code
     C                     MOVELBEGJST    $EGJST           Order in Use
     C                     MOVELBEGWST    $EGWST           Header Status
     C                     MOVELBEGXST    $EGXST           Header Status L
     C                     MOVELBEGYST    $EGYST           Order Type Prin
     C                     Z-ADDBEAODT    $EAODT           Scheduled Ship
     C                     MOVELBEAIVN    $EAIVN           User Original E
     C                     Z-ADDBECXDT    $ECXDT           Date of Origina
     C                     Z-ADDBEJZVA    $EJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $EA1WG           Order Weight To
     C                     MOVELBEXIST    $EXIST           Credit Hold
     C                     MOVELBEXJST    $EXJST           Production Hold
     C                     MOVELBEXKST    $EXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $EEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $EAFTM           Requested Deliv
     C                     MOVELBEE8CD    $EE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $EE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $ERMNB           Load ID
     C                     Z-ADDBETBNB    $ETBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $ER1NB           Rated Freight
     C                     MOVELBEPJST    $EPJST           LTL Flag
     C                     MOVELBEU0ST    $EU0ST           Price Audit
     C                     MOVELBEU1ST    $EU1ST           Price Status
     C                     MOVELBEQ2CD    $EQ2CD           Shipping Method
     C                     MOVELBEU2ST    $EU2ST           Export Status
     C                     MOVELBEVEST    $EVEST           Palletize
     C                     MOVELBEVFST    $EVFST           Shrink Wrap
     C                     MOVELBEVGST    $EVGST           Slip Sheet
     C                     MOVELBERPCD    $ERPCD           Age Code
     C                     Z-ADDBERNNB    $ERNNB           Reefer Temperat
     C                     MOVELBEVDST    $EVDST           Load Type
     C                     Z-ADDBEATIN    $EATIN           Attach to Invoi
     C                     MOVELBEU4ST    $EU4ST           Load Plan Order
     C                     MOVELBEU5ST    $EU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $ERSRN           Resell Referenc
     C                     MOVELBEMHNA    $EMHNA           Special Comment
     C                     MOVELBEMINA    $EMINA           Special Comment
     C                     MOVELBEWBST    $EWBST           Affect Auto Acc
     C                     MOVELBER4CD    $ER4CD           Sales Route Cod
     C                     MOVELBEBFCD    $EBFCD           Manager Level C
     C                     MOVELBEQ4CD    $EQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $ET3NB           Attach to Order
     C                     MOVELBESICD    $ESICD           Reason for Pric
     C                     Z-ADDBECONB    $ECONB           Invoice Number
     C                     MOVELBECEST    $ECEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $EAWDT           Invoice Date
     C                     MOVELBEJPCD    $EJPCD           Event Code
     C                     MOVELBEXUST    $EXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $EZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $EVRVA           A/R order Value
     C                     MOVELBEOBST    $EOBST           Billing Activit
     C                     MOVELBEBCST    $EBCST           Block Order Fla
     C                     MOVELBEBDST    $EBDST           Order Certifica
     C                     Z-ADDBEB7VL    $EB7VL           Invoice Order V
     C                     MOVELBEGASX    $EGASX           Invoice Price T
     C                     MOVELBEGBSX    $EGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $EGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $EGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $EFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $EFOSX           Email Cust On O
     C                     MOVELBEFPSX    $EFPSX           Order Emailed
     C                     MOVELBEFQSX    $EFQSX           Export Docs Go
     C                     MOVELBEFRSX    $EFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $EFSSX           Broker Order St
     C                     MOVELBEFTSX    $EFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $EFUSX           Signal Demand S
     C                     MOVELBEFVSX    $EFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $EFWSX           Export USDA App
     C                     MOVELBEFXSX    $EFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $EFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $ENODT           OH Unused Date
     C                     Z-ADDBENPDT    $ENPDT           OH Unused Date
     C                     Z-ADDBENQDT    $ENQDT           OH Unused Date
     C                     Z-ADDBENRDT    $ENRDT           OH Unused Date
     C                     Z-ADDBENSDT    $ENSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $EBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $EBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $EBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $EBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $EBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $EH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $EH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $EH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $EH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $EH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $EC0C7           Claim Number
     C                     MOVELBEUVST    $EUVST           EDI Status 1
     C                     MOVELBEUWST    $EUWST           EDI Status 2
     C                     MOVELBEUXST    $EUXST           EDI Status 3
     C                     Z-ADDBEAATM    $EAATM           Job Time
     C                     MOVELBEAYNA    $EAYNA           User Id
     C                     MOVELBEA0NA    $EA0NA           Job Name
     C                     Z-ADDBEAXDT    $EAXDT           Job Date
      * Load related totals format
     C                     Z-ADDBEAIC3    $NAIC3           Company Number
     C                     Z-ADDBEC4NB    $NC4NB           Order Number
     C                     MOVELBEJNCD    $NJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $NANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $NBKC7           Ship To Custome
     C                     MOVELBEBRTX    $NBRTX           Ship To Name
     C                     MOVELBEHMNA    $NHMNA           Ship To Address
     C                     MOVELBEHONA    $NHONA           Ship To Address
     C                     MOVELBEHPNA    $NHPNA           Ship To Address
     C                     MOVELBEHNNA    $NHNNA           Ship To City
     C                     MOVELBEDBCD    $NDBCD           Ship To State C
     C                     MOVELBECKTX    $NCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $NB0C7           Bill to Custome
     C                     MOVELBEAETX    $NAETX           Bill to Name
     C                     MOVELBEB1NA    $NB1NA           Bill to Address
     C                     MOVELBEB3NA    $NB3NA           Bill to Address
     C                     MOVELBEB4NA    $NB4NA           Bill to Address
     C                     MOVELBEB2NA    $NB2NA           Bill to City
     C                     MOVELBEBHCD    $NBHCD           Bill to State C
     C                     MOVELBEC8TX    $NC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $NBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $NA0DT           Order Date
     C                     Z-ADDBEA5DT    $NA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $NGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $NACDT           Cancel Date
     C                     MOVELBEAQCD    $NAQCD           Terms Code
     C                     MOVELBEB6NA    $NB6NA           Special Instruc
     C                     MOVELBEBYNA    $NBYNA           Special Instruc
     C                     MOVELBEBZNA    $NBZNA           Carrier Code
     C                     MOVELBEGTST    $NGTST           Comment Print A
     C                     MOVELBEGVST    $NGVST           Comment Print I
     C                     MOVELBEGUST    $NGUST           Comment Print P
     C                     MOVELBEQFST    $NQFST           Comment Print S
     C                     MOVELBECQCD    $NCQCD           Reason Code
     C                     MOVELBEGJST    $NGJST           Order in Use
     C                     MOVELBEGWST    $NGWST           Header Status
     C                     MOVELBEGXST    $NGXST           Header Status L
     C                     MOVELBEGYST    $NGYST           Order Type Prin
     C                     Z-ADDBEAODT    $NAODT           Scheduled Ship
     C                     MOVELBEAIVN    $NAIVN           User Original E
     C                     Z-ADDBECXDT    $NCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $NJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $NA1WG           Order Weight To
     C                     MOVELBEXIST    $NXIST           Credit Hold
     C                     MOVELBEXJST    $NXJST           Production Hold
     C                     MOVELBEXKST    $NXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $NEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $NAFTM           Requested Deliv
     C                     MOVELBEE8CD    $NE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $NE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $NRMNB           Load ID
     C                     Z-ADDBETBNB    $NTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $NR1NB           Rated Freight
     C                     MOVELBEPJST    $NPJST           LTL Flag
     C                     MOVELBEU0ST    $NU0ST           Price Audit
     C                     MOVELBEU1ST    $NU1ST           Price Status
     C                     MOVELBEQ2CD    $NQ2CD           Shipping Method
     C                     MOVELBEU2ST    $NU2ST           Export Status
     C                     MOVELBEVEST    $NVEST           Palletize
     C                     MOVELBEVFST    $NVFST           Shrink Wrap
     C                     MOVELBEVGST    $NVGST           Slip Sheet
     C                     MOVELBERPCD    $NRPCD           Age Code
     C                     Z-ADDBERNNB    $NRNNB           Reefer Temperat
     C                     MOVELBEVDST    $NVDST           Load Type
     C                     Z-ADDBEATIN    $NATIN           Attach to Invoi
     C                     MOVELBEU4ST    $NU4ST           Load Plan Order
     C                     MOVELBEU5ST    $NU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $NRSRN           Resell Referenc
     C                     MOVELBEMHNA    $NMHNA           Special Comment
     C                     MOVELBEMINA    $NMINA           Special Comment
     C                     MOVELBEWBST    $NWBST           Affect Auto Acc
     C                     MOVELBER4CD    $NR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $NBFCD           Manager Level C
     C                     MOVELBEQ4CD    $NQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $NT3NB           Attach to Order
     C                     MOVELBESICD    $NSICD           Reason for Pric
     C                     Z-ADDBECONB    $NCONB           Invoice Number
     C                     MOVELBECEST    $NCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $NAWDT           Invoice Date
     C                     MOVELBEJPCD    $NJPCD           Event Code
     C                     MOVELBEXUST    $NXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $NZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $NVRVA           A/R order Value
     C                     MOVELBEOBST    $NOBST           Billing Activit
     C                     MOVELBEBCST    $NBCST           Block Order Fla
     C                     MOVELBEBDST    $NBDST           Order Certifica
     C                     Z-ADDBEB7VL    $NB7VL           Invoice Order V
     C                     MOVELBEGASX    $NGASX           Invoice Price T
     C                     MOVELBEGBSX    $NGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $NGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $NGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $NFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $NFOSX           Email Cust On O
     C                     MOVELBEFPSX    $NFPSX           Order Emailed
     C                     MOVELBEFQSX    $NFQSX           Export Docs Go
     C                     MOVELBEFRSX    $NFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $NFSSX           Broker Order St
     C                     MOVELBEFTSX    $NFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $NFUSX           Signal Demand S
     C                     MOVELBEFVSX    $NFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $NFWSX           Export USDA App
     C                     MOVELBEFXSX    $NFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $NFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $NNODT           OH Unused Date
     C                     Z-ADDBENPDT    $NNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $NNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $NNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $NNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $NBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $NBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $NBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $NBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $NBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $NH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $NH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $NH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $NH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $NH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $NC0C7           Claim Number
     C                     MOVELBEUVST    $NUVST           EDI Status 1
     C                     MOVELBEUWST    $NUWST           EDI Status 2
     C                     MOVELBEUXST    $NUXST           EDI Status 3
     C                     Z-ADDBEAATM    $NAATM           Job Time
     C                     MOVELBEAYNA    $NAYNA           User Id
     C                     MOVELBEA0NA    $NA0NA           Job Name
     C                     Z-ADDBEAXDT    $NAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $FAIC3           Company Number
     C                     Z-ADDBEC4NB    $FC4NB           Order Number
     C                     MOVELBEJNCD    $FJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $FANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $FBKC7           Ship To Custome
     C                     MOVELBEBRTX    $FBRTX           Ship To Name
     C                     MOVELBEHMNA    $FHMNA           Ship To Address
     C                     MOVELBEHONA    $FHONA           Ship To Address
     C                     MOVELBEHPNA    $FHPNA           Ship To Address
     C                     MOVELBEHNNA    $FHNNA           Ship To City
     C                     MOVELBEDBCD    $FDBCD           Ship To State C
     C                     MOVELBECKTX    $FCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $FB0C7           Bill to Custome
     C                     MOVELBEAETX    $FAETX           Bill to Name
     C                     MOVELBEB1NA    $FB1NA           Bill to Address
     C                     MOVELBEB3NA    $FB3NA           Bill to Address
     C                     MOVELBEB4NA    $FB4NA           Bill to Address
     C                     MOVELBEB2NA    $FB2NA           Bill to City
     C                     MOVELBEBHCD    $FBHCD           Bill to State C
     C                     MOVELBEC8TX    $FC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $FBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $FA0DT           Order Date
     C                     Z-ADDBEA5DT    $FA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $FGNDT           Actual Shipped
     C                     Z-ADDBEACDT    $FACDT           Cancel Date
     C                     MOVELBEAQCD    $FAQCD           Terms Code
     C                     MOVELBEB6NA    $FB6NA           Special Instruc
     C                     MOVELBEBYNA    $FBYNA           Special Instruc
     C                     MOVELBEBZNA    $FBZNA           Carrier Code
     C                     MOVELBEGTST    $FGTST           Comment Print A
     C                     MOVELBEGVST    $FGVST           Comment Print I
     C                     MOVELBEGUST    $FGUST           Comment Print P
     C                     MOVELBEQFST    $FQFST           Comment Print S
     C                     MOVELBECQCD    $FCQCD           Reason Code
     C                     MOVELBEGJST    $FGJST           Order in Use
     C                     MOVELBEGWST    $FGWST           Header Status
     C                     MOVELBEGXST    $FGXST           Header Status L
     C                     MOVELBEGYST    $FGYST           Order Type Prin
     C                     Z-ADDBEAODT    $FAODT           Scheduled Ship
     C                     MOVELBEAIVN    $FAIVN           User Original E
     C                     Z-ADDBECXDT    $FCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $FJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $FA1WG           Order Weight To
     C                     MOVELBEXIST    $FXIST           Credit Hold
     C                     MOVELBEXJST    $FXJST           Production Hold
     C                     MOVELBEXKST    $FXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $FEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $FAFTM           Requested Deliv
     C                     MOVELBEE8CD    $FE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $FE9CD           Accounts Receiv
     C                     Z-ADDBERMNB    $FRMNB           Load ID
     C                     Z-ADDBETBNB    $FTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $FR1NB           Rated Freight
     C                     MOVELBEPJST    $FPJST           LTL Flag
     C                     MOVELBEU0ST    $FU0ST           Price Audit
     C                     MOVELBEU1ST    $FU1ST           Price Status
     C                     MOVELBEQ2CD    $FQ2CD           Shipping Method
     C                     MOVELBEU2ST    $FU2ST           Export Status
     C                     MOVELBEVEST    $FVEST           Palletize
     C                     MOVELBEVFST    $FVFST           Shrink Wrap
     C                     MOVELBEVGST    $FVGST           Slip Sheet
     C                     MOVELBERPCD    $FRPCD           Age Code
     C                     Z-ADDBERNNB    $FRNNB           Reefer Temperat
     C                     MOVELBEVDST    $FVDST           Load Type
     C                     Z-ADDBEATIN    $FATIN           Attach to Invoi
     C                     MOVELBEU4ST    $FU4ST           Load Plan Order
     C                     MOVELBEU5ST    $FU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $FRSRN           Resell Referenc
     C                     MOVELBEMHNA    $FMHNA           Special Comment
     C                     MOVELBEMINA    $FMINA           Special Comment
     C                     MOVELBEWBST    $FWBST           Affect Auto Acc
     C                     MOVELBER4CD    $FR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $FBFCD           Manager Level C
     C                     MOVELBEQ4CD    $FQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $FT3NB           Attach to Order
     C                     MOVELBESICD    $FSICD           Reason for Pric
     C                     Z-ADDBECONB    $FCONB           Invoice Number
     C                     MOVELBECEST    $FCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $FAWDT           Invoice Date
     C                     MOVELBEJPCD    $FJPCD           Event Code
     C                     MOVELBEXUST    $FXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $FZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $FVRVA           A/R order Value
     C                     MOVELBEOBST    $FOBST           Billing Activit
     C                     MOVELBEBCST    $FBCST           Block Order Fla
     C                     MOVELBEBDST    $FBDST           Order Certifica
     C                     Z-ADDBEB7VL    $FB7VL           Invoice Order V
     C                     MOVELBEGASX    $FGASX           Invoice Price T
     C                     MOVELBEGBSX    $FGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $FGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $FGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $FFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $FFOSX           Email Cust On O
     C                     MOVELBEFPSX    $FFPSX           Order Emailed
     C                     MOVELBEFQSX    $FFQSX           Export Docs Go
     C                     MOVELBEFRSX    $FFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $FFSSX           Broker Order St
     C                     MOVELBEFTSX    $FFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $FFUSX           Signal Demand S
     C                     MOVELBEFVSX    $FFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $FFWSX           Export USDA App
     C                     MOVELBEFXSX    $FFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $FFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $FNODT           OH Unused Date
     C                     Z-ADDBENPDT    $FNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $FNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $FNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $FNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $FBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $FBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $FBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $FBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $FBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $FH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $FH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $FH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $FH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $FH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $FC0C7           Claim Number
     C                     MOVELBEUVST    $FUVST           EDI Status 1
     C                     MOVELBEUWST    $FUWST           EDI Status 2
     C                     MOVELBEUXST    $FUXST           EDI Status 3
     C                     Z-ADDBEAATM    $FAATM           Job Time
     C                     MOVELBEAYNA    $FAYNA           User Id
     C                     MOVELBEA0NA    $FA0NA           Job Name
     C                     Z-ADDBEAXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Pick Slip          PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEAIC3    WZA001           Company Number
     C                     Z-ADDBEAIC3    WZA001
     C           *LIKE     DEFN BEC4NB    WZA002           Order Number
     C                     Z-ADDBEC4NB    WZA002
     C           *LIKE     DEFN BEBKC7    WZA003           Ship To Custome
     C                     Z-ADDBEBKC7    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@BFCPY8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Order Number
     C                     MOVEL*BLANK    W0AL02  1        Ship To Custome
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
     C                     MOVEL'Y'       W0AL02  1        Ship To Custome
     C                     ELSE
      * Next record - Detect level breaks
     C           BEAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BEC4NB    IFNE WZA002                     Order Number
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           BEBKC7    IFNE WZA003                     Ship To Custome
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR SLRVGN
      * RTV Country Code       RT - Customer  * 
     C                     EXSR SMRVGN
      * RTV Description        RT - Sales Route  * 
     C                     EXSR SNRVGN
      * Print country if not USA
      * CASE: WRK.Country Code is USA
     C           WUKXCD    IFEQ 'USA'                      *IF
     C                     MOVEL'N'       WUD4ST           USR Flag 1
      * ** Clear country description if USA           05/10/2007
     C                     MOVEL*BLANK    WUDATX           Country Descrip
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
      * RTV Desc, Status       RT - Country  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     MOVEL$OBRTX    WUADTX           Name
     C                     MOVEL$OHMNA    WUACNA           Address Line 1
     C                     MOVEL$OHONA    WUADNA           Address Line 2
     C                     MOVEL$OHPNA    WUAENA           Address Line 3
     C                     MOVEL$OHNNA    WUAJNA           City
     C                     MOVEL$ODBCD    WUEINA           State
     C                     MOVEL$OCKTX    WUBTTX           Zip/Postal Code
      * RTV Comprs Nme/Add/CtryUS - /UT User Source  * Ship To Address
      * Use this function to compress name/address information
      *
     C                     MOVELWUADTX    UUADTX           Name
     C                     MOVELWUACNA    UUACNA           Address 1
     C                     MOVELWUADNA    UUADNA           Address 2
     C                     MOVELWUAENA    UUAENA           Address 3
     C                     MOVELWUAJNA    UUAJNA           City
     C                     MOVELWUEINA    UUEINA           State
     C                     MOVELWUBTTX    UUBTTX           Zip
     C                     MOVELWUDATX    UUDATX           Country
     C                     EXSR UJ1UF
     C                     MOVELUAD,1     $OGNNA
     C                     MOVELUAD,2     $OGONA
     C                     MOVELUAD,3     $OGPNA
     C                     MOVELUAD,4     $OGQNA
     C                     MOVELUAD,5     $OGRNA
     C                     MOVELUAD,6     $ONWNA
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 14
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $OBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$OBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VOBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VOBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$OKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * PRTOBJ calls after print of Order Number format
      * Embedded PRTOBJ : PRT Header comments    PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDYL0002    $SCDWG           USR Weight Accu
     C                     Z-ADDYL0001    $SA4WG           Tare Weight Tot
     C           $SCDWG    ADD  $SA4WG    $SWUNB           USR Weight Bill
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 5
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$SFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Pick Slip          PO: Mainline
      *================================================================
      * PRT Pick Slip          PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQKB01           Company Number
     C           *LIKE     DEFN WAC4NB    WQKB02           Order Number
      * Define keylist
     C           KPSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADD$FAIC3    WQKB01           Company Number
     C                     Z-ADD$FC4NB    WQKB02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSB      SETLL@BGWKAE                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     MOVEL'Y'       W0BL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $MBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     $MCDWG           USR Weight Accu
     C                     Z-ADDWAAIC3    $MAIC3           Company Number
     C                     Z-ADDWAC4NB    $MC4NB           Order Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $LOTTX           Blank for 4
     C                     Z-ADDWAAIC3    $LAIC3           Company Number
     C                     Z-ADDWAC4NB    $LC4NB           Order Number
     C                     Z-ADDWADPNB    $LDPNB           Order Sequence
     C                     Z-ADDWAUENB    $LUENB           Order Secondary
     C                     Z-ADDWAHGCD    $LHGCD           Item Code
     C                     MOVELWAAJCD    $LAJCD           Warehouse Code
     C                     Z-ADDWABKC7    $LBKC7           Ship To Custome
     C                     Z-ADDWACFC7    $LCFC7           Order Group Cod
     C                     MOVELWAGMST    $LGMST           Detail Line Sta
     C                     MOVELWAGNST    $LGNST           Detail Line Sta
     C                     Z-ADDWAMAVA    $LMAVA           Billing Detail
     C                     Z-ADDWAKDVA    $LKDVA           Billing Detail
     C                     Z-ADDWAL8VA    $LL8VA           Billing Detail
     C                     Z-ADDWAL9VA    $LL9VA           Quantity to Sub
     C                     MOVELWAGTST    $LGTST           Comment Print A
     C                     MOVELWAGVST    $LGVST           Comment Print I
     C                     MOVELWAGUST    $LGUST           Comment Print P
     C                     MOVELWAQFST    $LQFST           Comment Print S
     C                     Z-ADDWAEXDT    $LEXDT           Market Pricing
     C                     MOVELWALQCD    $LLQCD           Commodity Marke
     C                     MOVELWARDCD    $LRDCD           Date Method Cod
     C                     MOVELWAQ7CD    $LQ7CD           Price Method Co
     C                     Z-ADDWABZPR    $LBZPR           Price Overage O
     C                     Z-ADDWAL6NB    $LL6NB           Contract Number
     C                     MOVELWAU1ST    $LU1ST           Price Status
     C                     Z-ADDWAGIDT    $LGIDT           Pricing Date Us
     C                     MOVELWACRCD    $LCRCD           U/M - Base Pric
     C                     MOVELWAAGCD    $LAGCD           U/M - Ordered
     C                     MOVELWARZST    $LRZST           Work Confirm St
     C                     MOVELWAR0ST    $LR0ST           Work Over/Short
     C                     MOVELWAR1ST    $LR1ST           OD Production P
     C                     MOVELWAG7NA    $LG7NA           Order Desc. Lin
     C                     MOVELWAG8NA    $LG8NA           Order Desc. Lin
     C                     MOVELWARPCD    $LRPCD           Age Code
     C                     MOVELWAVEST    $LVEST           Palletize
     C                     MOVELWAVGST    $LVGST           Slip Sheet
     C                     MOVELWAAVST    $LAVST           Catch Weight St
     C                     MOVELWAU0ST    $LU0ST           Price Audit
     C                     MOVELWARFCD    $LRFCD           Price Audit Rea
     C                     MOVELWAFZST    $LFZST           Production Date
     C                     Z-ADDWAR1NB    $LR1NB           Rated Freight
     C                     Z-ADDWAAVQT    $LAVQT           Quantity Ordere
     C                     Z-ADDWAD0WG    $LD0WG           Weight Ordered
     C                     Z-ADDWACCQT    $LCCQT           Quantity Schedu
     C                     Z-ADDWAAUWG    $LAUWG           Weight Schedule
     C                     Z-ADDWACBQT    $LCBQT           Quantity Shippe
     C                     Z-ADDWAATWG    $LATWG           Weight Shipped
     C                     Z-ADDWAAQCS    $LAQCS           Unit Cost Prici
     C                     Z-ADDWAAGCS    $LAGCS           Unit Cost Per P
     C                     Z-ADDWAALPR    $LALPR           Unit Price - Cr
     C                     Z-ADDWAAUPR    $LAUPR           Unit Price Orde
     C                     Z-ADDWAAVWG    $LAVWG           Unit Weight Ord
     C                     Z-ADDWAA4WG    $LA4WG           Tare Weight Tot
     C                     Z-ADDWAA5DT    $LA5DT           Requested Ship
     C                     Z-ADDWAAODT    $LAODT           Scheduled Ship
     C                     Z-ADDWAGNDT    $LGNDT           Actual Shipped
     C                     MOVELWAAMST    $LAMST           Affect Inventor
     C                     MOVELWAANST    $LANST           Affect Sales Do
     C                     MOVELWAVAST    $LVAST           Affect Sales Pn
     C                     Z-ADDWARGNB    $LRGNB           Item Structure
     C                     Z-ADDWARHNB    $LRHNB           Item Structure
     C                     Z-ADDWARINB    $LRINB           Item Structure
     C                     MOVELWARBCD    $LRBCD           Item Level
     C                     MOVELWAHICD    $LHICD           Quality Level
     C                     MOVELWARNCD    $LRNCD           Pricing Product
     C                     MOVELWAROCD    $LROCD           Season Product
     C                     Z-ADDWACXDT    $LCXDT           Date of Origina
     C                     MOVELWAAJVN    $LAJVN           User Profile Na
     C                     MOVELWAKXCD    $LKXCD           Country Code
     C                     MOVELWAJPCD    $LJPCD           Event Code
     C                     MOVELWACQCD    $LCQCD           Reason Code
     C                     MOVELWAR4CD    $LR4CD           Sales Route Cod
     C                     MOVELWAZ1ST    $LZ1ST           Modified Flag
     C                     MOVELWAZ3ST    $LZ3ST           Substituted Fla
     C                     MOVELWAZ4ST    $LZ4ST           OD Schedule Ove
     C                     Z-ADDWADUPR    $LDUPR           Invoice Unit Pr
     C                     Z-ADDWAB6VL    $LB6VL           Invoice Extende
     C                     Z-ADDWAA1AA    $LA1AA           Ham Group Numbe
     C                     MOVELWAFZSX    $LFZSX           OD Adj Type Ove
     C                     MOVELWAF0SX    $LF0SX           Affect Trade Fu
     C                     MOVELWAF1SX    $LF1SX           Affect Commissi
     C                     MOVELWAF2SX    $LF2SX           Affect Pricing
     C                     MOVELWAF3SX    $LF3SX           Released by Use
     C                     MOVELWAF4SX    $LF4SX           Ord TF Exempt C
     C                     MOVELWAF5SX    $LF5SX           OD Pallet Type
     C                     MOVELWAF6SX    $LF6SX           Production Ware
     C                     MOVELWAF7SX    $LF7SX           OD Price Type
     C                     Z-ADDWANTDT    $LNTDT           Warehouse Palle
     C                     Z-ADDWANUDT    $LNUDT           Consumed Item C
     C                     Z-ADDWANVDT    $LNVDT           Deadline Depart
     C                     Z-ADDWANWDT    $LNWDT           OD Price Type R
     C                     Z-ADDWANXDT    $LNXDT           OD Unused Date
     C                     Z-ADDWABUTM    $LBUTM           Deadline Depart
     C                     Z-ADDWABVTM    $LBVTM           Price Code
     C                     Z-ADDWABWTM    $LBWTM           Maximum Net Wei
     C                     Z-ADDWABXTM    $LBXTM           Substitution Li
     C                     Z-ADDWABYTM    $LBYTM           Max Qty to sche
     C                     Z-ADDWAH5NX    $LH5NX           Warehouse Palle
     C                     Z-ADDWAH6NX    $LH6NX           Warehouse Avg P
     C                     Z-ADDWAH7NX    $LH7NX           OD Item Target
     C                     Z-ADDWAH8NX    $LH8NX           OD Minimum Unit
     C                     Z-ADDWAH9NX    $LH9NX           OD Maximum Unit
     C                     Z-ADDWADVPR    $LDVPR           Order Gate Pric
     C                     Z-ADDWADWPR    $LDWPR           OD Ceiling Pric
     C                     Z-ADDWADXPR    $LDXPR           OD Unused Prc 3
     C                     Z-ADDWADYPR    $LDYPR           OD Unused Prc 4
     C                     Z-ADDWADZPR    $LDZPR           OD Unused Prc 5
     C                     Z-ADDWAGSPR    $LGSPR           OD Unused Prc 6
     C                     Z-ADDWAGTPR    $LGTPR           OD Unused Prc 7
     C                     Z-ADDWAGUPR    $LGUPR           OD Unused Prc 8
     C                     MOVELWAHOST    $LHOST           OD UnUsed Price
     C                     MOVELWAHPST    $LHPST           OD UnUsed Price
     C                     MOVELWAIOST    $LIOST           OD UnUsed Price
     C                     Z-ADDWAPEWG    $LPEWG           Weight Amount E
     C                     Z-ADDWARINY    $LRINY           Item Age Days
     C                     Z-ADDWATIDT    $LTIDT           Production Ovr
     C                     Z-ADDWATJDT    $LTJDT           Production Ovr
     C                     MOVELWAH2ST    $LH2ST           OD UnUsed Statu
     C                     MOVELWAH0ST    $LH0ST           OD UnUsed Statu
     C                     MOVELWAH1ST    $LH1ST           OD UnUsed Statu
     C                     Z-ADDWATKDT    $LTKDT           OD Market Begin
     C                     Z-ADDWATLDT    $LTLDT           OD Market Endin
     C                     Z-ADDWATMDT    $LTMDT           OD UnUsed Date
     C                     MOVELWAUVST    $LUVST           EDI Status 1
     C                     MOVELWAUWST    $LUWST           EDI Status 2
     C                     MOVELWAUXST    $LUXST           EDI Status 3
     C                     Z-ADDWAAATM    $LAATM           Job Time
     C                     MOVELWAAYNA    $LAYNA           User Id
     C                     MOVELWAA0NA    $LA0NA           Job Name
     C                     Z-ADDWAAXDT    $LAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAAIC3    $GAIC3           Company Number
     C                     Z-ADDWAC4NB    $GC4NB           Order Number
     C                     Z-ADDWADPNB    $GDPNB           Order Sequence
     C                     Z-ADDWAUENB    $GUENB           Order Secondary
     C                     MOVELWAAJCD    $GAJCD           Warehouse Code
     C                     Z-ADDWAA1AA    $GA1AA           Ham Group Numbe
     C                     Z-ADDWAHGCD    $GHGCD           Item Code
     C                     Z-ADD*ZERO     $GCDWG           USR Weight Accu
     C                     Z-ADDWAA4WG    $GA4WG           Tare Weight Tot
     C                     Z-ADDWACCQT    $GCCQT           Quantity Schedu
     C                     Z-ADDWABKC7    $GBKC7           Ship To Custome
     C                     Z-ADDWACFC7    $GCFC7           Order Group Cod
     C                     MOVELWAGMST    $GGMST           Detail Line Sta
     C                     MOVELWAGNST    $GGNST           Detail Line Sta
     C                     Z-ADDWAMAVA    $GMAVA           Billing Detail
     C                     Z-ADDWAKDVA    $GKDVA           Billing Detail
     C                     Z-ADDWAL8VA    $GL8VA           Billing Detail
     C                     Z-ADDWAL9VA    $GL9VA           Quantity to Sub
     C                     MOVELWAGTST    $GGTST           Comment Print A
     C                     MOVELWAGVST    $GGVST           Comment Print I
     C                     MOVELWAGUST    $GGUST           Comment Print P
     C                     MOVELWAQFST    $GQFST           Comment Print S
     C                     Z-ADDWAEXDT    $GEXDT           Market Pricing
     C                     MOVELWALQCD    $GLQCD           Commodity Marke
     C                     MOVELWARDCD    $GRDCD           Date Method Cod
     C                     MOVELWAQ7CD    $GQ7CD           Price Method Co
     C                     Z-ADDWABZPR    $GBZPR           Price Overage O
     C                     Z-ADDWAL6NB    $GL6NB           Contract Number
     C                     MOVELWAU1ST    $GU1ST           Price Status
     C                     Z-ADDWAGIDT    $GGIDT           Pricing Date Us
     C                     MOVELWACRCD    $GCRCD           U/M - Base Pric
     C                     MOVELWAAGCD    $GAGCD           U/M - Ordered
     C                     Z-ADD*ZERO     $GTNDT           Production AgeD
     C                     Z-ADD*ZERO     $GTODT           Production AgeD
     C                     MOVELWARPCD    $GRPCD           Age Code
     C                     MOVEL*BLANK    $GL3NA           USR Description
     C                     MOVELWARZST    $GRZST           Work Confirm St
     C                     MOVELWAR0ST    $GR0ST           Work Over/Short
     C                     MOVELWAR1ST    $GR1ST           OD Production P
     C                     MOVELWAG7NA    $GG7NA           Order Desc. Lin
     C                     MOVELWAG8NA    $GG8NA           Order Desc. Lin
     C                     MOVELWAVEST    $GVEST           Palletize
     C                     MOVELWAVGST    $GVGST           Slip Sheet
     C                     MOVELWAAVST    $GAVST           Catch Weight St
     C                     MOVELWAU0ST    $GU0ST           Price Audit
     C                     MOVELWARFCD    $GRFCD           Price Audit Rea
     C                     MOVELWAFZST    $GFZST           Production Date
     C                     Z-ADDWAR1NB    $GR1NB           Rated Freight
     C                     Z-ADDWAAVQT    $GAVQT           Quantity Ordere
     C                     Z-ADDWAD0WG    $GD0WG           Weight Ordered
     C                     Z-ADDWAAUWG    $GAUWG           Weight Schedule
     C                     Z-ADDWACBQT    $GCBQT           Quantity Shippe
     C                     Z-ADDWAATWG    $GATWG           Weight Shipped
     C                     Z-ADDWAAQCS    $GAQCS           Unit Cost Prici
     C                     Z-ADDWAAGCS    $GAGCS           Unit Cost Per P
     C                     Z-ADDWAALPR    $GALPR           Unit Price - Cr
     C                     Z-ADDWAAUPR    $GAUPR           Unit Price Orde
     C                     Z-ADDWAAVWG    $GAVWG           Unit Weight Ord
     C                     Z-ADDWAA5DT    $GA5DT           Requested Ship
     C                     Z-ADDWAAODT    $GAODT           Scheduled Ship
     C                     Z-ADDWAGNDT    $GGNDT           Actual Shipped
     C                     MOVELWAAMST    $GAMST           Affect Inventor
     C                     MOVELWAANST    $GANST           Affect Sales Do
     C                     MOVELWAVAST    $GVAST           Affect Sales Pn
     C                     Z-ADDWARGNB    $GRGNB           Item Structure
     C                     Z-ADDWARHNB    $GRHNB           Item Structure
     C                     Z-ADDWARINB    $GRINB           Item Structure
     C                     MOVELWARBCD    $GRBCD           Item Level
     C                     MOVELWAHICD    $GHICD           Quality Level
     C                     MOVELWARNCD    $GRNCD           Pricing Product
     C                     MOVELWAROCD    $GROCD           Season Product
     C                     Z-ADDWACXDT    $GCXDT           Date of Origina
     C                     MOVELWAAJVN    $GAJVN           User Profile Na
     C                     MOVELWAKXCD    $GKXCD           Country Code
     C                     MOVELWAJPCD    $GJPCD           Event Code
     C                     MOVELWACQCD    $GCQCD           Reason Code
     C                     MOVELWAR4CD    $GR4CD           Sales Route Cod
     C                     MOVELWAZ1ST    $GZ1ST           Modified Flag
     C                     MOVELWAZ3ST    $GZ3ST           Substituted Fla
     C                     MOVELWAZ4ST    $GZ4ST           OD Schedule Ove
     C                     Z-ADDWADUPR    $GDUPR           Invoice Unit Pr
     C                     Z-ADDWAB6VL    $GB6VL           Invoice Extende
     C                     MOVELWAFZSX    $GFZSX           OD Adj Type Ove
     C                     MOVELWAF0SX    $GF0SX           Affect Trade Fu
     C                     MOVELWAF1SX    $GF1SX           Affect Commissi
     C                     MOVELWAF2SX    $GF2SX           Affect Pricing
     C                     MOVELWAF3SX    $GF3SX           Released by Use
     C                     MOVELWAF4SX    $GF4SX           Ord TF Exempt C
     C                     MOVELWAF5SX    $GF5SX           OD Pallet Type
     C                     MOVELWAF6SX    $GF6SX           Production Ware
     C                     MOVELWAF7SX    $GF7SX           OD Price Type
     C                     Z-ADDWANTDT    $GNTDT           Warehouse Palle
     C                     Z-ADDWANUDT    $GNUDT           Consumed Item C
     C                     Z-ADDWANVDT    $GNVDT           Deadline Depart
     C                     Z-ADDWANWDT    $GNWDT           OD Price Type R
     C                     Z-ADDWANXDT    $GNXDT           OD Unused Date
     C                     Z-ADDWABUTM    $GBUTM           Deadline Depart
     C                     Z-ADDWABVTM    $GBVTM           Price Code
     C                     Z-ADDWABWTM    $GBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     $GUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     $GUQNB           Max Carcass Wei
     C                     Z-ADDWABXTM    $GBXTM           Substitution Li
     C                     Z-ADDWABYTM    $GBYTM           Max Qty to sche
     C                     Z-ADDWAH5NX    $GH5NX           Warehouse Palle
     C                     Z-ADDWAH6NX    $GH6NX           Warehouse Avg P
     C                     Z-ADDWAH7NX    $GH7NX           OD Item Target
     C                     Z-ADDWAH8NX    $GH8NX           OD Minimum Unit
     C                     Z-ADDWAH9NX    $GH9NX           OD Maximum Unit
     C                     Z-ADDWADVPR    $GDVPR           Order Gate Pric
     C                     Z-ADDWADWPR    $GDWPR           OD Ceiling Pric
     C                     Z-ADDWADXPR    $GDXPR           OD Unused Prc 3
     C                     Z-ADDWADYPR    $GDYPR           OD Unused Prc 4
     C                     Z-ADDWADZPR    $GDZPR           OD Unused Prc 5
     C                     Z-ADDWAGSPR    $GGSPR           OD Unused Prc 6
     C                     Z-ADDWAGTPR    $GGTPR           OD Unused Prc 7
     C                     Z-ADDWAGUPR    $GGUPR           OD Unused Prc 8
     C                     MOVELWAHOST    $GHOST           OD UnUsed Price
     C                     MOVELWAHPST    $GHPST           OD UnUsed Price
     C                     MOVELWAIOST    $GIOST           OD UnUsed Price
     C                     Z-ADDWAPEWG    $GPEWG           Weight Amount E
     C                     Z-ADDWARINY    $GRINY           Item Age Days
     C                     Z-ADDWATIDT    $GTIDT           Production Ovr
     C                     Z-ADDWATJDT    $GTJDT           Production Ovr
     C                     MOVELWAH2ST    $GH2ST           OD UnUsed Statu
     C                     MOVELWAH0ST    $GH0ST           OD UnUsed Statu
     C                     MOVELWAH1ST    $GH1ST           OD UnUsed Statu
     C                     Z-ADDWATKDT    $GTKDT           OD Market Begin
     C                     Z-ADDWATLDT    $GTLDT           OD Market Endin
     C                     Z-ADDWATMDT    $GTMDT           OD UnUsed Date
     C                     MOVELWAUVST    $GUVST           EDI Status 1
     C                     MOVELWAUWST    $GUWST           EDI Status 2
     C                     MOVELWAUXST    $GUXST           EDI Status 3
     C                     Z-ADDWAAATM    $GAATM           Job Time
     C                     MOVELWAAYNA    $GAYNA           User Id
     C                     MOVELWAA0NA    $GA0NA           Job Name
     C                     Z-ADDWAAXDT    $GAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Detail Comment     PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Pick Slip         PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     MOVEL'N'       WUJDST           USR Check Y/N S
     C                     ADD  $GCDWG    YL0002           USR Weight Accu
     C                     ADD  $GA4WG    YL0001           Tare Weight Tot
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAAIC3    WZB001           Company Number
     C                     Z-ADDWAAIC3    WZB001
     C           *LIKE     DEFN WAC4NB    WZB002           Order Number
     C                     Z-ADDWAC4NB    WZB002
     C           *LIKE     DEFN WADPNB    WZB003           Order Sequence
     C                     Z-ADDWADPNB    WZB003
     C           *LIKE     DEFN WAUENB    WZB004           Order Secondary
     C                     Z-ADDWAUENB    WZB004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BGWKAE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Order Sequence
     C                     MOVEL*BLANK    W0BL03  1        Order Secondary
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     MOVEL'Y'       W0BL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           WAAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WAC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WADPNB    IFNE WZB003                     Order Sequence
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           WAUENB    IFNE WZB004                     Order Secondary
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL03    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Secondary Line Seq format
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SKRVGN
      * CASE: WRK.Lot Tracking Flag is yes
     C           WUVHST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$LKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * CASE: PAR.Palletize is yes
     C           $FVEST    IFEQ 'Y'                        *IF
     C                     END                             *FI
     C                     Z-ADD$FBPTM    $MBPTM           Maximum Gross W
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 5
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           $FBPTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           $FVEST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           $FVFST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           $FVGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print format
     C                     WRITE$MKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Detail Comment     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPAIC3    WQKC01           Company Number
     C           *LIKE     DEFN CPC4NB    WQKC02           Order Number
     C           *LIKE     DEFN CPDPNB    WQKC03           Order Sequence
     C           *LIKE     DEFN CPUENB    WQKC04           Order Secondary
      * Define keylist
     C           KPSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WQKC03           Order Sequence
     C                     KFLD           WQKC04           Order Secondary
     C                     KFLD           CPDXNB           Sequence Number
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WQKC03           Order Sequence
     C                     KFLD           WQKC04           Order Secondary
      * Setup key
     C                     Z-ADD$GAIC3    WQKC01           Company Number
     C                     Z-ADD$GC4NB    WQKC02           Order Number
     C                     Z-ADD$GDPNB    WQKC03           Order Sequence
     C                     Z-ADD$GUENB    WQKC04           Order Secondary
     C                     Z-ADD*ZERO     CPDXNB           Sequence Number
      * Establish starting position
     C           KPSC      SETLL@CPCPOL                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDCPAIC3    $HAIC3           Company Number
     C                     Z-ADDCPC4NB    $HC4NB           Order Number
     C                     Z-ADDCPDPNB    $HDPNB           Order Sequence
     C                     Z-ADDCPUENB    $HUENB           Order Secondary
      * Load related totals format
     C                     Z-ADDCPAIC3    $JAIC3           Company Number
     C                     Z-ADDCPC4NB    $JC4NB           Order Number
     C                     Z-ADDCPDPNB    $JDPNB           Order Sequence
     C                     Z-ADDCPUENB    $JUENB           Order Secondary
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCPAIC3    $IAIC3           Company Number
     C                     Z-ADDCPC4NB    $IC4NB           Order Number
     C                     Z-ADDCPDPNB    $IDPNB           Order Sequence
     C                     Z-ADDCPUENB    $IUENB           Order Secondary
     C                     MOVELCPG4NA    $IG4NA           Comment Text
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN CPAIC3    WZC001           Company Number
     C                     Z-ADDCPAIC3    WZC001
     C           *LIKE     DEFN CPC4NB    WZC002           Order Number
     C                     Z-ADDCPC4NB    WZC002
     C           *LIKE     DEFN CPDPNB    WZC003           Order Sequence
     C                     Z-ADDCPDPNB    WZC003
     C           *LIKE     DEFN CPUENB    WZC004           Order Secondary
     C                     Z-ADDCPUENB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@CPCPOL                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           CPAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           CPC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           CPDPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           CPUENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt Pick Slip         PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN L8AIC3    WQKD01           Company Number
     C           *LIKE     DEFN L8C4NB    WQKD02           Order Number
     C           *LIKE     DEFN L8DPNB    WQKD03           Order Sequence
     C           *LIKE     DEFN L8UENB    WQKD04           Order Secondary
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
     C                     KFLD           WQKD03           Order Sequence
     C                     KFLD           WQKD04           Order Secondary
      * Setup key
     C                     Z-ADD$GAIC3    WQKD01           Company Number
     C                     Z-ADD$GC4NB    WQKD02           Order Number
     C                     Z-ADD$GDPNB    WQKD03           Order Sequence
     C                     Z-ADD$GUENB    WQKD04           Order Secondary
      * Establish starting position
     C           KRSD      SETLL@L8CPZO                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Order Sequence
     C                     MOVEL'Y'       W0DL03  1        Order Secondary
     C                     MOVEL'Y'       W0DL04  1        Production Date
     C                     MOVEL'Y'       W0DL05  1        Lot Number
     C                     MOVEL'Y'       W0DL06  1        Location Code
     C                     MOVEL'Y'       W0DL07  1        Location Level
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP04  1
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP05  1
     C                     END
      *
     C           W0DL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP06  1
     C                     END
      *
     C           W0DL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP07  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDL8AIC3    $KAIC3           Company Number
     C                     Z-ADDL8C4NB    $KC4NB           Order Number
     C                     Z-ADDL8DPNB    $KDPNB           Order Sequence
     C                     Z-ADDL8UENB    $KUENB           Order Secondary
     C                     Z-ADDL8ALSW    $KALSW           Allocation Seq
     C                     Z-ADDL8G9WG    $KG9WG           OIA Alloc/Shipp
     C                     Z-ADDL8HAWG    $KHAWG           OIA Serial Numb
     C                     MOVELL8IOSE    $KIOSE           OIA Create Sts
     C                     MOVELL8OIMN    $KOIMN           OIA Modified St
     C                     MOVELL8SOAS    $KSOAS           OIA Allocation
     C                     MOVELL8OTUS    $KOTUS           OIA Unused Sts
     C                     MOVELL8OTMP    $KOTMP           OIA Unused Sts
     C                     Z-ADDL8HGCD    $KHGCD           Item Code
     C                     MOVELL8AJCD    $KAJCD           Warehouse Code
     C                     Z-ADDL8LXNM    $KLXNM           Lot Number
     C                     MOVELL8YMCD    $KYMCD           Location Code
     C                     Z-ADDL8YNCD    $KYNCD           Location Level
     C                     Z-ADDL8J6QT    $KJ6QT           OIA Alloc/Shipp
     C                     MOVEL*BLANK    $KPCTX           Item Weight Typ
     C                     MOVELL8ARSX    $KARSX           OIA Loc Pick St
     C                     MOVEL*BLANK    $KAMSX           ILL Status
     C                     MOVEL*BLANK    $KYSCD           Inv Hold Reason
     C                     Z-ADDL8ELDT    $KELDT           Production Date
     C                     Z-ADDL8J9QT    $KJ9QT           OIA Co-Packer L
     C                     MOVELL8UVST    $KUVST           EDI Status 1
     C                     MOVELL8UWST    $KUWST           EDI Status 2
     C                     MOVELL8UXST    $KUXST           EDI Status 3
     C                     MOVELL8VSST    $KVSST           Record Status
     C                     Z-ADDL8AATM    $KAATM           Job Time
     C                     MOVELL8AYNA    $KAYNA           User Id
     C                     MOVELL8A0NA    $KA0NA           Job Name
     C                     Z-ADDL8AXDT    $KAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN L8AIC3    WZD001           Company Number
     C                     Z-ADDL8AIC3    WZD001
     C           *LIKE     DEFN L8C4NB    WZD002           Order Number
     C                     Z-ADDL8C4NB    WZD002
     C           *LIKE     DEFN L8DPNB    WZD003           Order Sequence
     C                     Z-ADDL8DPNB    WZD003
     C           *LIKE     DEFN L8UENB    WZD004           Order Secondary
     C                     Z-ADDL8UENB    WZD004
     C           *LIKE     DEFN L8ELDT    WZD005           Production Date
     C                     Z-ADDL8ELDT    WZD005
     C           *LIKE     DEFN L8LXNM    WZD006           Lot Number
     C                     Z-ADDL8LXNM    WZD006
     C           *LIKE     DEFN L8YMCD    WZD007           Location Code
     C                     MOVELL8YMCD    WZD007
     C           *LIKE     DEFN L8YNCD    WZD008           Location Level
     C                     Z-ADDL8YNCD    WZD008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@L8CPZO                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C                     MOVEL*BLANK    W0DL01  1        Order Number
     C                     MOVEL*BLANK    W0DL02  1        Order Sequence
     C                     MOVEL*BLANK    W0DL03  1        Order Secondary
     C                     MOVEL*BLANK    W0DL04  1        Production Date
     C                     MOVEL*BLANK    W0DL05  1        Lot Number
     C                     MOVEL*BLANK    W0DL06  1        Location Code
     C                     MOVEL*BLANK    W0DL07  1        Location Level
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Order Sequence
     C                     MOVEL'Y'       W0DL03  1        Order Secondary
     C                     MOVEL'Y'       W0DL04  1        Production Date
     C                     MOVEL'Y'       W0DL05  1        Lot Number
     C                     MOVEL'Y'       W0DL06  1        Location Code
     C                     MOVEL'Y'       W0DL07  1        Location Level
     C                     ELSE
      * Next record - Detect level breaks
     C           L8AIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           L8C4NB    IFNE WZD002                     Order Number
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           L8DPNB    IFNE WZD003                     Order Sequence
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           L8UENB    IFNE WZD004                     Order Secondary
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C           L8ELDT    IFNE WZD005                     Production Date
     C           W0DL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL04
     C                     END
     C           L8LXNM    IFNE WZD006                     Lot Number
     C           W0DL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL05
     C                     END
     C           L8YMCD    IFNE WZD007                     Location Code
     C           W0DL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL06
     C                     END
     C           L8YNCD    IFNE WZD008                     Location Level
     C           W0DL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL07
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP07
     C                     END
      *
     C           W0DL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP06
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP05
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP04
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * PRT Header comments    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN COAIC3    WQKE01           Company Number
     C           *LIKE     DEFN COC4NB    WQKE02           Order Number
     C           *LIKE     DEFN COI1SX    WQKE03           Comment Type
      * Define keylist
     C           KPSE      KLIST
     C                     KFLD           WQKE01           Company Number
     C                     KFLD           WQKE02           Order Number
     C                     KFLD           WQKE03           Comment Type
     C                     KFLD           CODXNB           Sequence Number
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Company Number
     C                     KFLD           WQKE02           Order Number
     C                     KFLD           WQKE03           Comment Type
      * Setup key
     C                     Z-ADD$OAIC3    WQKE01           Company Number
     C                     Z-ADD$OC4NB    WQKE02           Order Number
     C                     MOVEL'PI'      WQKE03           Comment Type
     C                     Z-ADD1         CODXNB           Sequence Number
      * Establish starting position
     C           KPSE      SETLL@COCPNU                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Company Number
     C                     MOVEL'Y'       W0EL01  1        Order Number
     C                     MOVEL'Y'       W0EL02  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDCOAIC3    $PAIC3           Company Number
     C                     Z-ADDCOC4NB    $PC4NB           Order Number
     C                     MOVELCOI1SX    $PI1SX           Comment Type
     C                     MOVEL*BLANK    $PHLTX           Condition Desc.
     C                     MOVEL*BLANK    $PSHTX           Text USR 40
      * Load related totals format
     C                     Z-ADDCOAIC3    $RAIC3           Company Number
     C                     Z-ADDCOC4NB    $RC4NB           Order Number
     C                     MOVELCOI1SX    $RI1SX           Comment Type
      * USER: Process before print of Comment Type format
      * Get the text definition of the Comment type for Heading SAZ 2/8/0
      * CUR.Text USR 40 = Condition name of CUR.Comment Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1603273   Y2LSNO  70       List number
     C                     PARM $PI1SX    W0INVL 25        Comment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $PSHTX    PARM           W0CNNM 25        Text USR 40
      *
     C                     Z-ADD1         ZQ      50
     C           $PSHTX    CAT  @CN,002:ZQ$PSHTX    P      Text USR 40
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP02  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCOAIC3    $QAIC3           Company Number
     C                     Z-ADDCOC4NB    $QC4NB           Order Number
     C                     MOVELCOI1SX    $QI1SX           Comment Type
     C                     MOVELCOG4NA    $QG4NA           Comment Text
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN COAIC3    WZE001           Company Number
     C                     Z-ADDCOAIC3    WZE001
     C           *LIKE     DEFN COC4NB    WZE002           Order Number
     C                     Z-ADDCOC4NB    WZE002
     C           *LIKE     DEFN COI1SX    WZE003           Comment Type
     C                     MOVELCOI1SX    WZE003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@COCPNU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Company Number
     C                     MOVEL*BLANK    W0EL01  1        Order Number
     C                     MOVEL*BLANK    W0EL02  1        Comment Type
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Company Number
     C                     MOVEL'Y'       W0EL01  1        Order Number
     C                     MOVEL'Y'       W0EL02  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           COAIC3    IFNE WZE001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           COC4NB    IFNE WZE002                     Order Number
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C           COI1SX    IFNE WZE003                     Comment Type
     C           W0EL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL02
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$RKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP02
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Pick List-NoLdGUY PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Pick List-NoLdGUY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Pick List-NoLdGUY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Order Number of Prt Pick List-NoLdGUY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * RTV 1st Warehouse      RT - Order Detail  * 
     C                     EXSR SDRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $DAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $DEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDEIDT
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Ship To Customer of Prt Pick List-NoLdGUY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of Prt Pick List-NoLdGUY PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$FDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Pick Slip          PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Pick Slip          PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of PRT Pick Slip          PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0BP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Pick Slip          PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Pick Slip          PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Detail line. of PRT Pick Slip          PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv Tare Weight        RT - Company/Item  * 
     C                     EXSR SERVGN
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
     C                     EXSR SFRVGN
     C           WUA3WG    ADD  WUAIWG    WUA4WG           Tare Weight Tot
     C           WUA4WG    MULT $GCCQT    WN0001    H      @Weight
     C                     Z-ADDWN0001    $GA4WG           Tare Weight Tot
     C           $GA4WG    ADD  WAAUWG    $GCDWG           USR Weight Accu
      * RMC 04/21/05 print new fields, and move to 5,0 length
     C                     Z-ADDWAH8NX    $GUPNB           Min Carcass Wei
     C                     Z-ADDWAH9NX    $GUQNB           Max Carcass Wei
      * fp1309 add new calculation
      * RTV Requested Dlvry dt RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    WUECST           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           WUEIDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  WUEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           $GAODT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $GAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GHGCD    WQ0004  70       Item Code
     C                     PARM $GAJCD    WQ0005  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0006  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0007 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0008 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0009 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0010 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0011 30        Error Reason De
     C                     PARM $GAIC3    WQ0012  30       Company Number
     C                     PARM $GAODT    WQ0013  70       Scheduled Ship
     C                     PARM WUEIDT    WQ0014  70       Requested Deliv
     C                     PARM $GRINY    WQ0015  40       Item Age Days
     C                     PARM $GTIDT    WQ0016  70       Production Ovr
     C                     PARM $GTJDT    WQ0017  70       Production Ovr
     C           $GTNDT    PARM $GTNDT    WQ0018  70       Production AgeD
     C           $GTODT    PARM $GTODT    WQ0019  70       Production AgeD
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * verify if message should be sent  if par states validation
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'C'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $GTNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$GRINY    ZA0004           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $GTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $GTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$GRINY    ZA0007           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $GTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $GTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$GRINY    ZA0010           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $GTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $GTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD$GRINY    ZA0013           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $GTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  $GTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           $GTIDT    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD$GRINY    ZA0016           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $GTNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  $GTODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $GTNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGTNDT
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  $GTODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGTODT
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Print format
     C                     WRITE$HKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of PRT Detail Comment     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Order Number of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print Order Sequence Number of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Order Secondary Line Seq of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print Production Date of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP04
     C                     END                             FI
      * Print Lot Number of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP05
     C                     END                             FI
      * Print Location Code of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP06
     C                     END                             FI
      * Print Location Level of Prt Pick Slip         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP07
     C                     END                             FI
      * Print Detail line. of Prt Pick Slip         PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv Avail Ship Date   RT - IC Item Lot Location  * 
     C                     EXSR SIRVGN
      * CASE: PAR.Scheduled Ship Date LT PAR.ILL Avail Ship Date
     C           $LAODT    IFLT WN0005                     *IF
     C                     MOVEL'Y'       WN0006           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0006           Display Flag
     C                     END                             *FI
      * Item Weight Type
      * CASE: PAR.Catch Weight Status is yes
     C           $GAVST    IFEQ 'Y'                        *IF
     C                     MOVEL'CW'      $KPCTX           Item Weight Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SW'      $KPCTX           Item Weight Typ
     C                     END                             *FI
      * Rtv Status/Reason     RT - IC Item Lot Location  * 
     C                     EXSR SJRVGN
      * 5/31/01  RMC Dont print items on HOLD
      * CASE: CUR.ILL Status is Hold
     C           $KAMSX    IFEQ 'H'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  $KELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VKELDT
     C                     MOVEL'0'       *IN79
     C           WN0006    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Company Number of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Order Number of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print Comment Type of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP02    ANDEQ'P'
      * Print format
     C                     WRITE$PKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EP02
     C                     END                             FI
      * Print Detail line. of PRT Header comments    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$QCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$QDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Pick List-NoLdGUY PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Pick List-NoLdGUY PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Pick List-NoLdGUY PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt Pick List-NoLdGUY PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Pick List-NoLdGUY PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Pick Slip          PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Pick Slip          PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Pick Slip          PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Pick Slip          PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Pick Slip          PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Pick Slip          PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Detail Comment     PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Detail Comment     PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Detail Comment     PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Detail Comment     PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Detail Comment     PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Detail Comment     PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Pick Slip         PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Pick Slip         PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Pick Slip         PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of Prt Pick Slip         PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of Prt Pick Slip         PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Date of Prt Pick Slip         PO
     C           W0DP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Lot Number of Prt Pick Slip         PO
     C           W0DP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Location Code of Prt Pick Slip         PO
     C           W0DP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Location Level of Prt Pick Slip         PO
     C           W0DP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Pick Slip         PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD1         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Header comments    PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Header comments    PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Header comments    PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of PRT Header comments    PO
     C           W0EP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Header comments    PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP2AIC3    $BAIC3           Company Number
     C                     Z-ADDP2C4NB    $BC4NB           Order Number
     C                     MOVEL*BLANK    $BSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBC4NB           CD7 Ext Numeric
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BSQTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    WQSD01           Company Number
     C                     Z-ADD$DC4NB    WQSD02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSD     SETLL@BGWKL1                    *
     C           KRSSD     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELOMAJCD    $DAJCD           Warehouse Code
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$GAIC3    BZAIC3           Company Number
     C                     Z-ADD$GHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    $GL3NA           Description Lin
     C                     Z-ADDBZA3WG    WUA3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  3        Item Type Code
     C                     MOVEL*BLANK    WN0003  1        Package Type Co
     C                     Z-ADD*ZERO     WN0004 112       Unit Weight USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSF01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSF02           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
      * Setup key
     C                     Z-ADD$GAIC3    WQSF01           Company Number
     C                     Z-ADD$GHGCD    WQSF02           Item Code
      * Establish starting position
     C           KRSSF     SETLL@IORETI                    *
     C           KRSSF     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
     C                     EXSR SGRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0002    IFEQ 'PS'                       *IF
     C           WN0003    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SFEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     END                             *FI
     C           KRSSF     READE@IORETI                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDWN0004    WUAIWG           Unit Weight
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WUAIWG           Unit Weight
     C                     MOVELBZN0CD    WN0002           Item Type Code
     C                     MOVELBZX4ST    WN0003           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Requested Dlvry dt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBEIDT    WUEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    WUAFTM           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Avail Ship Date   RT - IC Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           L5AIC3           Company Number
     C                     KFLD           L5HGCD           Item Code
     C                     KFLD           L5AJCD           Warehouse Code
     C                     KFLD           L5ELDT           Production Date
     C                     KFLD           L5LXNM           Lot Number
     C                     KFLD           L5YMCD           Location Code
     C                     KFLD           L5YNCD           Location Level
      * Setup key
     C                     Z-ADD$KAIC3    L5AIC3           Company Number
     C                     Z-ADD$KHGCD    L5HGCD           Item Code
     C                     MOVEL$KAJCD    L5AJCD           Warehouse Code
     C                     Z-ADD$KELDT    L5ELDT           Production Date
     C                     Z-ADD$KLXNM    L5LXNM           Lot Number
     C                     MOVEL$KYMCD    L5YMCD           Location Code
     C                     Z-ADD$KYNCD    L5YNCD           Location Level
      * Establish starting position
     C           KRSSI     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0005           ILL Avail Ship
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDL5LODT    WN0005           ILL Avail Ship
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Status/Reason     RT - IC Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           L5AIC3           Company Number
     C                     KFLD           L5HGCD           Item Code
     C                     KFLD           L5AJCD           Warehouse Code
     C                     KFLD           L5ELDT           Production Date
     C                     KFLD           L5LXNM           Lot Number
     C                     KFLD           L5YMCD           Location Code
     C                     KFLD           L5YNCD           Location Level
      * Setup key
     C                     Z-ADD$KAIC3    L5AIC3           Company Number
     C                     Z-ADD$KHGCD    L5HGCD           Item Code
     C                     MOVEL$KAJCD    L5AJCD           Warehouse Code
     C                     Z-ADD$KELDT    L5ELDT           Production Date
     C                     Z-ADD$KLXNM    L5LXNM           Lot Number
     C                     MOVEL$KYMCD    L5YMCD           Location Code
     C                     Z-ADD$KYNCD    L5YNCD           Location Level
      * Establish starting position
     C           KRSSJ     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $KAMSX           ILL Status
     C                     MOVEL*BLANK    $KYSCD           Inv Hold Reason
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELL5AMSX    $KAMSX           ILL Status
     C                     MOVELL5YSCD    $KYSCD           Inv Hold Reason
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$LAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUVHST           Lot Tracking Fl
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADVHST    WUVHST           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$OBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    $OCDTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Country Code       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$OBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBKXCD    WUKXCD           Country Code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Description        RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL$OR4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSN     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $OMZNA           Sales Route Des
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    $OMZNA           Sales Route Des
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Desc, Status       RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWUKXCD    E5KXCD           Country Code
      * Establish starting position
     C           KRSSO     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUDATX           Country Descrip
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE5DATX    WUDATX           Country Descrip
     C                     MOVELE5VSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Pick Slip          PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       @Weight
      *
      * PRT Pick Slip          PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Detail Comment     PO
      *================================================================
      * PRT Detail Comment     PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Pick Slip         PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       ILL Avail Ship
     C                     MOVEL*BLANK    WN0006  1        Display Flag
      *
      * Prt Pick Slip         PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Header comments    PO
      *================================================================
      * PRT Header comments    PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
     C           UJ1UF     BEGSR
      *============================================================
      * UJ1UF - COMPRESS NAME/ADDRESS/COUNTRY INFORMATION
      *============================================================
      *
     C           *LIKE     DEFN WUADTX    UUADTX
     C           *LIKE     DEFN WUACNA    UUACNA
     C           *LIKE     DEFN WUADNA    UUADNA
     C           *LIKE     DEFN WUAENA    UUAENA
     C           *LIKE     DEFN WUAJNA    UUAJNA
     C           *LIKE     DEFN WUEINA    UUEINA
     C           *LIKE     DEFN WUBTTX    UUBTTX- 1
     C           *LIKE     DEFN WUDATX    UUDATX
      * FILL OUTPUT ARRAY
     C                     MOVE *BLANK    UAD
     C                     Z-ADD1         UX      20
     C                     MOVELUUADTX    UAD,UX
     C                     ADD  1         UX
     C           UUACNA    IFNE *BLANK
     C                     MOVELUUACNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUADNA    IFNE *BLANK
     C                     MOVELUUADNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUAENA    IFNE *BLANK
     C                     MOVELUUAENA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C                     MOVE *BLANK    UUCSTZ 34
     C                     MOVELUUAJNA    UUCST  23
     C                     MOVE UUEINA    UUCST
     C                     MOVELUUCST     UUCSTZ
     C                     MOVE UUBTTX    UUCSTZ
     C                     MOVELUUCSTZ    UAD,UX
     C           UUDATX    IFNE *BLANK
     C                     ADD  1         UX
     C                     MOVELUUDATX    UAD,UX
     C                     END
     C                     ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Pick Slip          PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUJDST           USR Check Y/N S
     C                     Z-ADD*ZERO     YL0002           USR Weight Accu
     C                     Z-ADD*ZERO     YL0001           Tare Weight Tot
      * Change Log:
      *   OMS349 - Calculates an 'Oldest Label Date' and prints on report
      *   John Tremper - 10/13/98
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $FAIC3    WQ0001  30       Company Number
     C           WUYISX    PARM *BLANK    WQ0002  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0003  1        Company Organiz
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BEC4NB           Order Number
     C                     MOVEL*LOVAL    BEBKC7           Ship To Custome
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Unused Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WADYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WADZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WAGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field Plant Company Sts
     C                     MOVEL*BLANK    WUYISX  1
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAAIC3           Company Number
     C                     MOVEL*LOVAL    WAC4NB           Order Number
     C                     MOVEL*LOVAL    WADPNB           Order Sequence
     C                     MOVEL*LOVAL    WAUENB           Order Secondary
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Tare Weight Total
     C                     Z-ADD*ZERO     WUA4WG 112
      * Define work field Requested Delivery Date
     C                     Z-ADD*ZERO     WUEIDT  70
      * Define work field Requested Delivery Time
     C                     Z-ADD*ZERO     WUAFTM  40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Unused Date
     C                     Z-ADD*ZERO     WBNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    CPAIC3           Company Number
     C                     MOVEL*LOVAL    CPC4NB           Order Number
     C                     MOVEL*LOVAL    CPDPNB           Order Sequence
     C                     MOVEL*LOVAL    CPUENB           Order Secondary
     C                     MOVEL*LOVAL    CPDXNB           Sequence Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    L8AIC3           Company Number
     C                     MOVEL*LOVAL    L8C4NB           Order Number
     C                     MOVEL*LOVAL    L8DPNB           Order Sequence
     C                     MOVEL*LOVAL    L8UENB           Order Secondary
     C                     MOVEL*LOVAL    L8ELDT           Production Date
     C                     MOVEL*LOVAL    L8LXNM           Lot Number
     C                     MOVEL*LOVAL    L8YMCD           Location Code
     C                     MOVEL*LOVAL    L8YNCD           Location Level
      * Define work field Lot Tracking Flag
     C                     MOVEL*BLANK    WUVHST  1
      * Define work field Country Code
     C                     MOVEL*BLANK    WUKXCD  6
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Country Description
     C                     MOVEL*BLANK    WUDATX 30
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field Address Line 1
     C                     MOVEL*BLANK    WUACNA 30
      * Define work field Address Line 2
     C                     MOVEL*BLANK    WUADNA 30
      * Define work field Address Line 3
     C                     MOVEL*BLANK    WUAENA 30
      * Define work field City
     C                     MOVEL*BLANK    WUAJNA 20
      * Define work field State
     C                     MOVEL*BLANK    WUEINA  2
      * Define work field Zip/Postal Code
     C                     MOVEL*BLANK    WUBTTX 11
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    COAIC3           Company Number
     C                     MOVEL*LOVAL    COC4NB           Order Number
     C                     MOVEL*LOVAL    COI1SX           Comment Type
     C                     MOVEL*LOVAL    CODXNB           Sequence Number
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Tare Weight Total
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field USR Weight Accumulated
     C                     Z-ADD*ZERO     YL0002 112
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * ** Change Log
      *  E01342 New report for orders that are NOT load planned
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 Comments
