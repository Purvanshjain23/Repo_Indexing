// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKJYXFR
// ?Date: 14.08.2025 Time: 02:51:54
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications and Comments
DO;

//?H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Number
ENDDO;

EXECUTE FUNCTION(Rtv Payment Processing RT) TYPE(RTVOBJ) FILE(PKC4REP)          AB1147409;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER(WRK.Pmt_Current_Payment_Step);
PARAMETER(WRK.PP_Commission_Paym_Error);
PARAMETER(WRK.PP_Payment_Error);
PARAMETER(WRK.PP_Unused_Nbr_1);
PARAMETER(WRK.PP_Repayment_Status);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Rtv Unpaid Tattoo LvRs RT) TYPE(RTVOBJ) FILE(PKA1CPP)          AB1197589;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER(PAR.TH_Live_Purchase_Price);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.TH Live Purchase Price is Zeros
 IF DB1.TH_Live_Purchase_Price = *ZERO;

 CASE;

 // IF DB1.TH Live Purchase UOM EQ WRK.Blank Usr 1 fld Usr
 IF DB1.TH_Live_Purchase_UOM = WRK.Blank_Usr_1_fld_Usr;

 // WRK.TH Live Purchase UOM = CND.Live Hundred Weight
 WRK.TH_Live_Purchase_UOM = 'LW';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.TH Live Purchase UOM = DB1.TH Live Purchase UOM
 WRK.TH_Live_Purchase_UOM = DB1.TH_Live_Purchase_UOM;

 ENDIF;

 // WRK.TH Payment Sts = DB1.TH Payment Sts
 WRK.TH_Payment_Sts = DB1.TH_Payment_Sts;

 CASE;

 // IF DB1.TH Payment Sts is Paid Producer
 IF DB1.TH_Payment_Sts = 'PL'/'PC'/'NC'/'NL';

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF WRK.TH Live Purchase UOM is *ALL values
 IF WRK.TH_Live_Purchase_UOM = 'RH'/'LW'/'CW'/'FL'/'GV'/'CH'/'YH'/'DH'/'KH'/'NH'/'NL'
 /'BD'/'SW'/'DY'/'RX'/'LX'/'SX'/*BLANK/'HM'/'DE';

 CASE;

 // IF DB1.TH Source Type is External
 IF DB1.TH_Source_Type = 'E';

 // WRK.TH Payment Sts = CND.Select Live
 WRK.TH_Payment_Sts = 'SL';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.TH Payment Sts = CND.Sl Int Live
 WRK.TH_Payment_Sts = 'IL';

 ENDIF;

 ENDIF;

 ENDIF;

 //?Lf is only unpaid Internal Resale Hogs
 EXECUTE FUNCTION(Chg Lv Prc/Market Prc CH) TYPE(CHGOBJ) FILE(PKA1CPP)           AB1197596;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(WRK.TH_Live_Purchase_UOM);
 PARAMETER(PAR.TH_Live_Purchase_Price);
 PARAMETER(PAR.TH_Live_Purchase_Price);
 PARAMETER(PAR.TH_Live_Purchase_Price);
 PARAMETER(WRK.TH_Payment_Sts);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 ENDIF;

}


// Call program Zzz Verif Live Price  PF.
CALL PROGRAM(Zzz Verif Live Price  PF) ('PKJZPFR');
PARAMETER(PAR.CC_Company_Number);

