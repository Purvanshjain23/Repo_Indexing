// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for VNDFAXR
// ?Date: 14.08.2025 Time: 02:43:40
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modification history
DO;

//? 3/12/2020 JBB P16169 - JDE World to JDE E1
//?     Project SDN465     Function created.  Use Company Values to
//?                        determine whether to call JDE World or JDE
//?                        Enterprise 1 programs.
ENDDO;

//?Since the Address Book file does not contain a company number,
//?hard code company 350 at this time.
// LCL.OMS Company Number = CON.350
LCL.OMS_Company_Number = 350;

//?Retrieve Company Values for E1 Live, JW Live, and M3 Live
// Call program Rtv Live In E1/JW/M3  XF.
CALL PROGRAM(Rtv Live In E1/JW/M3  XF) ('E1JUXFR');
PARAMETER(LCL.OMS_Company_Number);
PARAMETER(LCL.E1_Live);
PARAMETER(LCL.JW_Live);
PARAMETER(LCL.M3_Live);
PARAMETER(LCL.E1_Parallel);
PARAMETER(LCL.JW_Parallel);
PARAMETER(LCL.M3_Parallel);

//?Logic based upon Live In flag (Y/N/P)
CASE;

// IF LCL.E1 Live is Yes or Parallel
IF LCL.E1_Live = 'P'/'Y';

// OR LCL.JW Live is Parallel
OR LCL.JW_Live = 'P';

// Call program Rtv Vendor Addr/FaxE1 UP.
CALL PROGRAM(Rtv Vendor Addr/FaxE1 UP) ('VNDFAXRE1');
PARAMETER(LCL.Return_Code);
PARAMETER(PAR.Address_Number);
PARAMETER(PAR.Name_Alpha);
PARAMETER(PAR.Address_Line_1);
PARAMETER(PAR.Address_Line_2);
PARAMETER(PAR.Address_Line_3);
PARAMETER(PAR.Address_Line_4);
PARAMETER(PAR.State);
PARAMETER(PAR.Postal_Code);
PARAMETER(PAR.Phone_Prefix);
PARAMETER(PAR.Phone_Number);
PARAMETER(PAR.Phone_Area_1);
PARAMETER(PAR.Phone_Number_1);
PARAMETER(PAR.Phone_Area_2);
PARAMETER(PAR.Phone_Number_2);
PARAMETER(PAR.Ten_99);
PARAMETER(PAR.Tax_ID_16A);
PARAMETER(PAR.Country);
PARAMETER(PAR.TPST);

//?If PGM.*Return Code <> blank, set LCL.Return Code to 'ERR    '
CASE;

// IF NOT PGM.*Return code is *Normal
IF ! PGM.*Return_code = *BLANK;

// LCL.Return Code = CND.Error
LCL.Return_Code = 'ERR';

ENDIF;

//?Logic based upon Live In flag (Y/N/P)
// IF LCL.JW Live is Yes
IF LCL.JW_Live = 'Y';

// Call program Rtv Vendor Addr/Fax W UP.
CALL PROGRAM(Rtv Vendor Addr/Fax W UP) ('VNDFAXRW');
PARAMETER(LCL.Return_Code);
PARAMETER(PAR.Address_Number);
PARAMETER(PAR.Name_Alpha);
PARAMETER(PAR.Address_Line_1);
PARAMETER(PAR.Address_Line_2);
PARAMETER(PAR.Address_Line_3);
PARAMETER(PAR.Address_Line_4);
PARAMETER(PAR.State);
PARAMETER(PAR.Postal_Code);
PARAMETER(PAR.Phone_Prefix);
PARAMETER(PAR.Phone_Number);
PARAMETER(PAR.Phone_Area_1);
PARAMETER(PAR.Phone_Number_1);
PARAMETER(PAR.Phone_Area_2);
PARAMETER(PAR.Phone_Number_2);
PARAMETER(PAR.Ten_99);
PARAMETER(PAR.Tax_ID_16A);
PARAMETER(PAR.Country);
PARAMETER(PAR.TPST);

//?Logic based upon Live In flag (Y/N/P)
// IF *OTHERWISE
IF *OTHERWISE;

// Call program Rtv Vendor Addr/Fax W UP.
CALL PROGRAM(Rtv Vendor Addr/Fax W UP) ('VNDFAXRW');
PARAMETER(LCL.Return_Code);
PARAMETER(PAR.Address_Number);
PARAMETER(PAR.Name_Alpha);
PARAMETER(PAR.Address_Line_1);
PARAMETER(PAR.Address_Line_2);
PARAMETER(PAR.Address_Line_3);
PARAMETER(PAR.Address_Line_4);
PARAMETER(PAR.State);
PARAMETER(PAR.Postal_Code);
PARAMETER(PAR.Phone_Prefix);
PARAMETER(PAR.Phone_Number);
PARAMETER(PAR.Phone_Area_1);
PARAMETER(PAR.Phone_Number_1);
PARAMETER(PAR.Phone_Area_2);
PARAMETER(PAR.Phone_Number_2);
PARAMETER(PAR.Ten_99);
PARAMETER(PAR.Tax_ID_16A);
PARAMETER(PAR.Country);
PARAMETER(PAR.TPST);

ENDIF;

//?Pass back the return code to the calling program
// PGM.*Return code = LCL.Return Code
PGM.*Return_code = LCL.Return_Code;

RETURN;

