/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - BUILD XLS OF CUSTOMER ABSORBED FREIGHT RATES        */
/*                                                                  */
/*  COMPANY   - SEABOARD FOODS                                      */
/*  SYSTEM    - ORDER MANAGEMENT                                    */
/*  USER NAME - PURVA DROGE                                         */
/*  DATE      - 04/23/08                                            */
/*                                                                  */
/*  PROGRAM   - BUILD XLS OF CUSTOMER ABSORBED FREIGHT RATES        */
/*                                                                  */
/********************************************************************/
/********************************************************************/
 PMLPUPC:    PGM        PARM(&CO &SLSRT &RCDSTS &EMAIL)

        DCL    &CO        *DEC    (3 0)           /*  COMPANY #     */
        DCL    &SLSRT     *DEC    (3 0)           /*  SALES ROUTE   */
        DCL    &RCDSTS    *CHAR   (1  )           /*  RECORD STS    */
        DCL    &EMAIL     *CHAR   (50 )           /*  EMAIL         */

/* ERROR MESSAGE FIELDS                                                       */
        DCL    &MSG        *CHAR   (512)         /* message                   */
        DCL    &MSGID      *CHAR   (7)           /* message id                */
        DCL    &MSGL       *DEC    (5 0)
/********************************************************************/
/*   INITIALIZE                                                     */
/********************************************************************/
             ADDLIBLE   LIB(MARGINMGT) POSITION(*LAST)
             MONMSG     MSGID(CPF0000)

             CLRPFM     FILE(PMDSCPP)
             MONMSG     MSGID(CPF0000)

/*********************************************************************/
/*   CALL LISTING PROGRAM                                            */
/*********************************************************************/
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

             OVRPRTF    FILE(PMTMPFR$) HOLD(*YES)

             CALL       PGM(PMTMPFR) PARM('' &CO &SLSRT &RCDSTS)

             EXECUTE    VIEW(CDFTCO_V) PCFMT(*XLS) RECIPIENT(&EMAIL)

             GOTO       CMDLBL(END)

/*********************************************************************/
/*----------------------RECEIVE MESSAGES----------------------------*/
/*********************************************************************/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))


 END:        ENDPGM
