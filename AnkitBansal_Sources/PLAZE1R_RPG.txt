     H/TITLE Edt Delivery Tracking ER  Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISELOUC
     H* Date          : 06/02/23  Time  : 13:32:07
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPLAZE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Delivery Tracking ER  Edit record(1 screen)
      *
     FPLAFCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Delivery Tracking         Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPLANREL1IF  E           K        DISK
      * RTV : Contract Hauler Reason    Retrieval index
      *
     FPLAJCPL1IF  E           K        DISK
      * RTV : Delivery Tracking Split   Retrieval index
      *
     FPLAIREL1IF  E           K        DISK
      * RTV : Delivery Reason           Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPLADCPL0IF  E           K        DISK
      * RTV : Delivery Sched Header     Retrieval index
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPLAFCPL0UF  E           K        DISK                      A
      * UPD : Delivery Tracking         Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * KEY Screen: Field position and name array
     E                    W0BEG   5 005  5 0A
     E                    W0END   5 005  5 0A
     E                    W0NAM   5 005 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 049  5 0A
     E                    W1END   7 049  5 0A
     E                    W1NAM   7 049 10
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WAABCD
     I              AFAECD                          WAAECD
     I              AFA8TX                          WAA8TX
     I              AFGLNB                          WAGLNB
     I              AFATST                          WAATST
     I              AFASNB                          WAASNB
     I              AFAUST                          WAAUST
     I              AFQNST                          WAQNST
     I              AFQOST                          WAQOST
     I              AFQPST                          WAQPST
     I              AFQQST                          WAQQST
     I              AFQRST                          WAQRST
     I              AFN0TX                          WAN0TX
     I              AFQSST                          WAQSST
     I              AFQTST                          WAQTST
     I              AFQUST                          WAQUST
     I              AFQVST                          WAQVST
     I              AFR8ST                          WAR8ST
     I              AFR9ST                          WAR9ST
     I              AFSAST                          WASAST
     I              AFSBST                          WASBST
     I              AFSDST                          WASDST
     I              AFSEST                          WASEST
     I              AFSFST                          WASFST
     I              AFHWNB                          WAHWNB
     I              AFFUCD                          WAFUCD
     I              AFAAVN                          WAAAVN
     I              AFAADT                          WAAADT
     I              AFAMTM                          WAAMTM
     I              AFAJST                          WAAJST
     I              AFAHVN                          WAAHVN
     I              AFAGVN                          WAAGVN
     I              AFABVN                          WAABVN
     I              AFABDT                          WAABDT
     I              AFABTM                          WAABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@AFCPI4
      * Delivery Tracking         BOH CO/BO/BOL/KillDt
      * Renamed input format fields
     I              AFHONB                          WCHONB
     I              AFE0DT                          WCE0DT
     I              AFE9DT                          WCE9DT
     I              AFAJTH                          WCAJTH
     I              AFH4A1                          WCH4A1
     I              AFFXDT                          WCFXDT
     I              AFJIA1                          WCJIA1
     I              AFIBA1                          WCIBA1
     I              AFW5ST                          WCW5ST
     I              AFICA1                          WCICA1
     I              AFK0CD                          WCK0CD
     I              AFK1CD                          WCK1CD
     I              AFLFCD                          WCLFCD
     I              AFLGCD                          WCLGCD
     I              AFIDA1                          WCIDA1
     I              AFIPA1                          WCIPA1
     I              AFLICD                          WCLICD
     I              AFJ8CD                          WCJ8CD
     I              AFJ9CD                          WCJ9CD
     I              AFMGCD                          WCMGCD
     I              AFXHST                          WCXHST
     I              AFXIST                          WCXIST
     I              AFIEA1                          WCIEA1
     I              AFKBCD                          WCKBCD
     I              AFKZCD                          WCKZCD
     I              AFLHCD                          WCLHCD
     I              AFFADT                          WCFADT
     I              AFAKTH                          WCAKTH
     I              AFBYTH                          WCBYTH
     I              AFW6ST                          WCW6ST
     I              AFXXST                          WCXXST
     I              AFFBDT                          WCFBDT
     I              AFALTH                          WCALTH
     I              AFBVTH                          WCBVTH
     I              AFAMTH                          WCAMTH
     I              AFFCDT                          WCFCDT
     I              AFANTH                          WCANTH
     I              AFBHTH                          WCBHTH
     I              AFFDDT                          WCFDDT
     I              AFAOTH                          WCAOTH
     I              AFBWTH                          WCBWTH
     I              AFAPTH                          WCAPTH
     I              AFFEDT                          WCFEDT
     I              AFAQTH                          WCAQTH
     I              AFARTH                          WCARTH
     I              AFFFDT                          WCFFDT
     I              AFASTH                          WCASTH
     I              AFATTH                          WCATTH
     I              AFFGDT                          WCFGDT
     I              AFAUTH                          WCAUTH
     I              AFFHDT                          WCFHDT
     I              AFAVTH                          WCAVTH
     I              AFAWTH                          WCAWTH
     I              AFBKTH                          WCBKTH
     I              AFBLTH                          WCBLTH
     I              AFXJST                          WCXJST
     I              AFK3CD                          WCK3CD
     I              AFFIDT                          WCFIDT
     I              AFAXTH                          WCAXTH
     I              AFAYTH                          WCAYTH
     I              AFFJDT                          WCFJDT
     I              AFAZTH                          WCAZTH
     I              AFA0TH                          WCA0TH
     I              AFFKDT                          WCFKDT
     I              AFA1TH                          WCA1TH
     I              AFA2TH                          WCA2TH
     I              AFFLDT                          WCFLDT
     I              AFA3TH                          WCA3TH
     I              AFA4TH                          WCA4TH
     I              AFBTTH                          WCBTTH
     I              AFFMDT                          WCFMDT
     I              AFA5TH                          WCA5TH
     I              AFA6TH                          WCA6TH
     I              AFBXTH                          WCBXTH
     I              AFXKST                          WCXKST
     I              AFYDST                          WCYDST
     I              AFFYDT                          WCFYDT
     I              AFB0TH                          WCB0TH
     I              AFBZTH                          WCBZTH
     I              AFH2A1                          WCH2A1
     I              AFJ2A1                          WCJ2A1
     I              AFJ3A1                          WCJ3A1
     I              AFKMA1                          WCKMA1
     I              AFJ4A1                          WCJ4A1
     I              AFJ5A1                          WCJ5A1
     I              AFJ6A1                          WCJ6A1
     I              AFJ7A1                          WCJ7A1
     I              AFJ8A1                          WCJ8A1
     I              AFJ9A1                          WCJ9A1
     I              AFKAA1                          WCKAA1
     I              AFKBA1                          WCKBA1
     I              AFKCA1                          WCKCA1
     I              AFKDA1                          WCKDA1
     I              AFKEA1                          WCKEA1
     I              AFKFA1                          WCKFA1
     I              AFKNA1                          WCKNA1
     I              AFKGA1                          WCKGA1
     I              AFKHA1                          WCKHA1
     I              AFKOA1                          WCKOA1
     I              AFKIA1                          WCKIA1
     I              AFKJA1                          WCKJA1
     I              AFKKA1                          WCKKA1
     I              AFKLA1                          WCKLA1
     I              AFYNST                          WCYNST
     I              AFYOST                          WCYOST
     I              AFABCD                          WCABCD
     I              AFAECD                          WCAECD
     I              AFAACD                          WCAACD
     I              AFHMNB                          WCHMNB
     I              AFBNNB                          WCBNNB
     I              AFBONB                          WCBONB
     I              AFAAVN                          WCAAVN
     I              AFAADT                          WCAADT
     I              AFAMTM                          WCAMTM
     I              AFAJST                          WCAJST
     I              AFAHVN                          WCAHVN
     I              AFAGVN                          WCAGVN
     I              AFABVN                          WCABVN
     I              AFABDT                          WCABDT
     I              AFABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPLAFCPL0
      * UPD : Delivery Tracking         Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            455
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             17
      * KEY : Delivery Tracking Comment Retrieval index
      * I : RST CC Company Number
     I                                    P   1   20PAHONB
      * I : RST DSH Kill Date
     I                                    P   3   60PAE0DT
      * I : RST DT Delivery Date
     I                                    P   7  100PAE9DT
      * I : RST DT Delivery Time
     I                                    P  11  130PAAJTH
      * I : RST DT Delivery Time Seq
     I                                    P  14  150PAH4A1
      *
      * Outward parameters
     IPBRC        DS                             17
      * KEY : Delivery Tracking Split   Retrieval index
      * I : RST CC Company Number
     I                                    P   1   20PBHONB
      * I : RST DSH Kill Date
     I                                    P   3   60PBE0DT
      * I : RST DT Delivery Date
     I                                    P   7  100PBE9DT
      * I : RST DT Delivery Time
     I                                    P  11  130PBAJTH
      * I : RST DT Delivery Time Seq
     I                                    P  14  150PBH4A1
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            583
     IYCRDCS      DS                            455
     IYDRDCS      DS                            583
     IYERDCS      DS                            583
     IYFRDCS      DS                            455
     IYGRDCS      DS                            583
     IYHRDCS      DS                            583
      * Outward parameters
     IPCRC        DS                             13
      * KEY : Delivery Tracking         BOH CO/BO/BOL/KillDt
      * I : RST BOH Company Number
     I                                    P   1   20PCHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PCBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PCBONB
      * I : RST DSH Kill Date
     I                                    P  10  130PCE0DT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             15
      * KEY: Delivery Tracking         Retrieval index
      * I : RST CC Company Number
     I                                    P   1   20P1HONB
      * I : RST DSH Kill Date
     I                                    P   3   60P1E0DT
      * I : RST DT Delivery Date
     I                                    P   7  100P1E9DT
      * I : RST DT Delivery Time
     I                                    P  11  130P1AJTH
      * I : RST DT Delivery Time Seq
     I                                    P  14  150P1H4A1
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Oms Warehouse Code
     I                                        1   3 P2J8NB
      * N :  Oms Application Code
     I                                        4   9 P2C7CD
      * N :  Oms SalesPerson Code
     I                                       10  12 P2C8CD
      * N :  Oms Allow Multi-Company
     I                                       13  13 P2G8ST
      * N :  Oms Default Printer
     I                                       14  23 P2G9ST
      * N :  Oms Name
     I                                       24  53 P2EUTX
      * N :  Oms System Value Alpha
     I                                       54  93 P2EVTX
      * N :  Oms Access Denied (Y/N)
     I                                       94  94 P2HAST
     IP3PARM      DS
      * O :  Status 1
     I                                        1   1 P3P4ST
     IP4PARM      DS
      * N :  Current System Date   USR
     I                                    P   1   40P4FWDT
     IP5PARM      DS
      * I :  Trk Arrival Sched Sts
     I                                        1   1 P5EOSS
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0001
      * Time USR
     I                                    P   5   70ZA0002
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0003
      * Date USR
     I                                    P   5   80ZA0004
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0005
      * Time USR
     I                                    P   5   70ZA0006
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0007
      * Time USR
     I                                    P   5   70ZA0008
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0009
      * Date USR
     I                                    P   5   80ZA0010
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0011
      * Time USR
     I                                    P   5   70ZA0012
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0013
      * Time USR
     I                                    P   5   70ZA0014
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0015
      * Date USR
     I                                    P   5   80ZA0016
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0017
      * Time USR
     I                                    P   5   70ZA0018
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0019
      * Time USR
     I                                    P   5   70ZA0020
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0021
      * Date USR
     I                                    P   5   80ZA0022
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0023
      * Time USR
     I                                    P   5   70ZA0024
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0025
      * Date USR
     I                                    P   5   80ZA0026
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0027
      * Time USR
     I                                    P   5   70ZA0028
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0029
      * Time USR
     I                                    P   5   70ZA0030
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0031
      * Date USR
     I                                    P   5   80ZA0032
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0033
      * Time USR
     I                                    P   5   70ZA0034
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0035
      * Time USR
     I                                    P   5   70ZA0036
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0037
      * Date USR
     I                                    P   5   80ZA0038
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0039
      * Time USR
     I                                    P   5   70ZA0040
      * Message data for 'Previous date/time not e'
      * Date USR
     I                                    P   1   40ZA0041
      * Time USR
     I                                    P   5   70ZA0042
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0043
      * Date USR
     I                                    P   5   80ZA0044
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0045
      * Time USR
     I                                    P   5   70ZA0046
      * Message data for 'Date 1 cant be > date 2'
      * Date To   USR
     I                                    P   1   40ZA0047
      * Date USR
     I                                    P   5   80ZA0048
      * Message data for 'Invalid date/time entries'
      * Date USR
     I                                    P   1   40ZA0049
      * Time USR
     I                                    P   5   70ZA0050
      * Message data for 'F8 not valid for Full'
      * Message data for 'Load type not found.'
      * DT Load Type
     I                                        1   2 ZA0051
      * Message data for 'Farm Site Invalid.'
      * HRH Farm Site
     I                                    P   1   30ZA0052
      * Message data for 'Buildng/Rm not val f/splt'
      * Message data for 'Buildng/room not valid'
      * Message data for 'Buildng/room mult group'
      * Message data for 'Driver not found'
      * DT Driver
     I                                        1   5 ZA0053
      * Message data for 'Contract Hauler Reason NF'
      * Message data for 'Loading Crew NF'
      * DT Loading Crew
     I                                        1   5 ZA0054
      * Message data for 'Delv Track Split Head Err'
      * Message data for 'Delv Track Split Exists'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Time entry must be milita'
      * Message data for 'Time must not be negative'
      * Message data for 'Unsch Movement not creatd'
      * DT Movement Number
     I                                    P   1   40ZA0055
      * Message data for 'Unsch Movement created'
      * DT Movement Number
     I                                    P   1   40ZA0056
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Delivery T
     C           P3P4ST    PARM P3P4ST    WP0001  1        Status 1
     C           P5EOSS    PARM           WP0002  1        Trk Arrival Sch
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Display and process key screen
     C                     EXSR BADSKY
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1HONB    IFEQ *ZERO                      CC Company Numb
     C           #1E0DT    OREQ *ZERO                      DSH Kill Date
     C           #1E9DT    OREQ *ZERO                      DT Delivery Dat
     C           #1AJTH    OREQ *ZERO                      DT Delivery Tim
     C           #1H4A1    OREQ *ZERO                      DT Delivery Tim
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           AFHONB           CC Company Numb
     C                     KFLD           AFE0DT           DSH Kill Date
     C                     KFLD           AFE9DT           DT Delivery Dat
     C                     KFLD           AFAJTH           DT Delivery Tim
     C                     KFLD           AFH4A1           DT Delivery Tim
      * Setup key
     C                     Z-ADD#1HONB    AFHONB
     C                     Z-ADD#1E0DT    AFE0DT
     C                     Z-ADD#1E9DT    AFE9DT
     C                     Z-ADD#1AJTH    AFAJTH
     C                     Z-ADD#1H4A1    AFH4A1
     C           KRTV      CHAIN@AFCPIJ              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     99    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    *
      * Send message 'Delivery Tracking      NF'
     C                     MOVEL'PRK1030' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
     C                     MOVELAFJ8CD    YL0001           DT Driver
     C                     Z-ADDAFICA1    YL0002           DT Farm Site Co
     C                     MOVELAFK0CD    YL0003           DT Building
     C                     MOVELAFK1CD    YL0004           DT Room
     C                     MOVELAFLICD    YL0005           DT Trucker Code
      * ******* Farm Dates and Times  *******
      * Validate: Frm Depart Date
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Frm Depart Date is Entered
      *   |- c2    : DTL.DT Frm Depart Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FFDT    IFNE 0                          *IF
     C           #1ASTH    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Validate with frm beg loading
      * CASE: DTL.DT Frm Beg Loading Date is Not Entered
     C           #1FDDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert DT Leave Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
     C                     Z-ADD#1ASTH    ZA0002           DT Leave Farm T
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT Frm Depart Date GT PAR.Current System Date   USR
     C           #1FFDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT Leave Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0004
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - (c1ANDc2)ORc3
      *   |- c1    : DTL.DT Frm Depart Date EQ DTL.DT Frm Beg Loading Dat
      *   |- c2    : DTL.DT Frm Depart Time LE DTL.DT Frm Beg Loading Tim
      *   |- c3    : DTL.DT Frm Depart Date LT DTL.DT Frm Beg Loading Dat
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FFDT    IFEQ #1FDDT                     *IF
     C           #1ASTH    IFLE #1AOTH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FFDT    IFLT #1FDDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT Leave Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
     C                     Z-ADD#1ASTH    ZA0006           DT Leave Farm T
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate: Frm Beg Loading
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Frm Beg Loading Date is Entered
      *   |- c2    : DTL.DT Frm Beg Loading Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FDDT    IFNE *ZERO                      *IF
     C           #1AOTH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * validate
      * CASE: DTL.DT Frm Arrival Date is Not Entered
     C           #1FCDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert DT Start Loading Date to display format
      * Convert date
     C           1000000   ADD  #1FDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
     C                     Z-ADD#1AOTH    ZA0008           DT Start Loadin
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT Frm Beg Loading Date GT PAR.Current System Date   US
     C           #1FDDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT Start Loading Date to display format
      * Convert date
     C           1000000   ADD  #1FDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0010
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - (c1ANDc2)ORc3
      *   |- c1    : DTL.DT Frm Beg Loading Date EQ DTL.DT Frm Arrival Da
      *   |- c2    : DTL.DT Frm Beg Loading Time LE DTL.DT Frm Arrival Ti
      *   |- c3    : DTL.DT Frm Beg Loading Date LT DTL.DT Frm Arrival Da
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FDDT    IFEQ #1FCDT                     *IF
     C           #1AOTH    IFLE #1ANTH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FDDT    IFLT #1FCDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT Start Loading Date to display format
      * Convert date
     C           1000000   ADD  #1FDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
     C                     Z-ADD#1AOTH    ZA0012           DT Start Loadin
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate: Frm Arrival Date
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Frm Arrival Date is Entered
      *   |- c2    : DTL.DT Frm Arrival Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FCDT    IFNE *ZERO                      *IF
     C           #1ANTH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Validate
      * CASE: DTL.DT Sched Route Start Date is Not Entered
     C           #1FBDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert DT Arrive @ Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FCDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0013
     C                     Z-ADD#1ANTH    ZA0014           DT Arrive @ Far
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT Frm Arrival Date GT PAR.Current System Date   USR
     C           #1FCDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT Arrive @ Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FCDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0016
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - (c1ANDc2)ORc3
      *   |- c1    : DTL.DT Frm Arrival Date EQ DTL.DT Sched Route Start
      *   |- c2    : DTL.DT Frm Arrival Time LE DTL.DT Sched Route Start
      *   |- c3    : DTL.DT Frm Arrival Date LT DTL.DT Sched Route Start
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FCDT    IFEQ #1FBDT                     *IF
     C           #1ANTH    IFLE #1ALTH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FCDT    IFLT #1FBDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT Arrive @ Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FCDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
     C                     Z-ADD#1ANTH    ZA0018           DT Arrive @ Far
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate: Route Start Date     (check GT Delv Date)
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Sched Route Start Date is Entered
      *   |- c2    : DTL.DT Sched Route Start Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FBDT    IFNE *ZERO                      *IF
     C           #1ALTH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.DT Delivery Date is Not Entered
     C           #1E9DT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert DT Route Start Date to display format
      * Convert date
     C           1000000   ADD  #1FBDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
     C                     Z-ADD#1ALTH    ZA0020           DT Route Start
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT Sched Route Start Date GT PAR.Current System Date
     C           #1FBDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT Route Start Date to display format
      * Convert date
     C           1000000   ADD  #1FBDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0021
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ******* Plant Dates and Times  *******
      * Validate: TrkScl Weigh-out
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT TrkScl Weigh-Out Date is Entered
      *   |- c2    : DTL.DT TrkScl Weigh-Out Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FMDT    IFNE *ZERO                      *IF
     C           #1A5TH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Validate
      * CASE: DTL.DT Beg Unload Date is Not Entered
     C           #1FKDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert DT TrkScl Weigh-Out Date to display format
      * Convert date
     C           1000000   ADD  #1FMDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0023
     C                     Z-ADD#1A5TH    ZA0024           DT TrkScl Weigh
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT TrkScl Weigh-Out Date GT PAR.Current System Date   U
     C           #1FMDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT TrkScl Weigh-Out Date to display format
      * Convert date
     C           1000000   ADD  #1FMDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0025
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0026
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - (c1ANDc2)ORc3
      *   |- c1    : DTL.DT TrkScl Weigh-Out Date EQ DTL.DT Beg Unload Da
      *   |- c2    : DTL.DT TrkScl Weigh-Out Time LE DTL.DT Beg Unload Ti
      *   |- c3    : DTL.DT TrkScl Weigh-Out Date LT DTL.DT Beg Unload Da
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FMDT    IFEQ #1FKDT                     *IF
     C           #1A5TH    IFLE #1A1TH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FMDT    IFLT #1FKDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT TrkScl Weigh-Out Date to display format
      * Convert date
     C           1000000   ADD  #1FMDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0027
     C                     Z-ADD#1A5TH    ZA0028           DT TrkScl Weigh
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate: Beg Unload
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Beg Unload Date is Entered
      *   |- c2    : DTL.DT Beg Unload Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FKDT    IFNE *ZERO                      *IF
     C           #1A1TH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * validate
      * CASE: DTL.DT Rcv Dock Arvl Date is Not Entered
     C           #1FJDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert DT Start Unloading Date to display format
      * Convert date
     C           1000000   ADD  #1FKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0029
     C                     Z-ADD#1A1TH    ZA0030           DT Start Unload
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT Beg Unload Date GT PAR.Current System Date   USR
     C           #1FKDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT Start Unloading Date to display format
      * Convert date
     C           1000000   ADD  #1FKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0031
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0032
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - (c1ANDc2)ORc3
      *   |- c1    : DTL.DT Beg Unload Date EQ DTL.DT Rcv Dock Arvl Date
      *   |- c2    : DTL.DT Beg Unload Time LE DTL.DT Rcv Dock Arvl Time
      *   |- c3    : DTL.DT Beg Unload Date LT DTL.DT Rcv Dock Arvl Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FKDT    IFEQ #1FJDT                     *IF
     C           #1A1TH    IFLE #1AZTH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FKDT    IFLT #1FJDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT Start Unloading Date to display format
      * Convert date
     C           1000000   ADD  #1FKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0033
     C                     Z-ADD#1A1TH    ZA0034           DT Start Unload
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate: Rcv Dock Arvl
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Rcv Dock Arvl Date is Entered
      *   |- c2    : DTL.DT Rcv Dock Arvl Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FJDT    IFNE *ZERO                      *IF
     C           #1AZTH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Validate
      * CASE: DTL.DT TrkScl Weigh-In Date is Not Entered
     C           #1FIDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert DT To Recv Dock Date to display format
      * Convert date
     C           1000000   ADD  #1FJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0035
     C                     Z-ADD#1AZTH    ZA0036           DT To Recv Dock
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT Rcv Dock Arvl Date GT PAR.Current System Date   USR
     C           #1FJDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT To Recv Dock Date to display format
      * Convert date
     C           1000000   ADD  #1FJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0037
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0038
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - (c1ANDc2)ORc3
      *   |- c1    : DTL.DT Rcv Dock Arvl Date EQ DTL.DT TrkScl Weigh-In
      *   |- c2    : DTL.DT Rcv Dock Arvl Time LE DTL.DT TrkScl Weigh-In
      *   |- c3    : DTL.DT Rcv Dock Arvl Date LT DTL.DT TrkScl Weigh-In
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FJDT    IFEQ #1FIDT                     *IF
     C           #1AZTH    IFLE #1AXTH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FJDT    IFLT #1FIDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT To Recv Dock Date to display format
      * Convert date
     C           1000000   ADD  #1FJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0039
     C                     Z-ADD#1AZTH    ZA0040           DT To Recv Dock
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate: TrkScl Weigh-In
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT TrkScl Weigh-In Date is Entered
      *   |- c2    : DTL.DT TrkScl Weigh-In Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FIDT    IFNE *ZERO                      *IF
     C           #1AXTH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * validate
      * CASE: DTL.DT Plt Arrival Date is Not Entered
     C           #1FHDT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert DT TrkScl Weigh-In Date to display format
      * Convert date
     C           1000000   ADD  #1FIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0041
     C                     Z-ADD#1AXTH    ZA0042           DT TrkScl Weigh
      * Send message 'Previous date/time not e'
     C                     MOVEL'PRK1059' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT TrkScl Weigh-In Date GT PAR.Current System Date   US
     C           #1FIDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT TrkScl Weigh-In Date to display format
      * Convert date
     C           1000000   ADD  #1FIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0043
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0044
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - (c1ANDc2)ORc3
      *   |- c1    : DTL.DT TrkScl Weigh-In Date EQ DTL.DT Plt Arrival Da
      *   |- c2    : DTL.DT TrkScl Weigh-In Time LE DTL.DT Plt Arrival Ti
      *   |- c3    : DTL.DT TrkScl Weigh-In Date LT DTL.DT Plt Arrival Da
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FIDT    IFEQ #1FHDT                     *IF
     C           #1AXTH    IFLE #1AVTH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FIDT    IFLT #1FHDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT TrkScl Weigh-In Date to display format
      * Convert date
     C           1000000   ADD  #1FIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0045
     C                     Z-ADD#1AXTH    ZA0046           DT TrkScl Weigh
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate: Plant Arrival
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Plt Arrival Date is Entered
      *   |- c2    : DTL.DT Plt Arrival Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FHDT    IFNE *ZERO                      *IF
     C           #1AVTH    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.DT Plt Arrival Date GT PAR.Current System Date   USR
     C           #1FHDT    IFGT P4FWDT                     *IF
      * Setup message data for message
      * Convert DT Arrive @ Plant Date to display format
      * Convert date
     C           1000000   ADD  #1FHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0047
      * Convert Current System Date   USR to display format
      * Convert date
     C           1000000   ADD  P4FWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0048
      * Send message 'Date 1 cant be > date 2'
     C                     MOVEL'PRK1084' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * CASE: DTL.DT Source Type is Internal
     C           #1XKST    IFEQ 'I'                        *IF
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : DTL.DT Plt Arrival Date LT DTL.DT Frm Depart Date
      *   |- c2    : DTL.DT Plt Arrival Date EQ DTL.DT Frm Depart Date
      *   |- c3    : DTL.DT Plt Arrival Time LT DTL.DT Frm Depart Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FHDT    IFLT #1FFDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1FHDT    IFEQ #1FFDT                     *IF
     C           #1AVTH    IFLT #1ASTH                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert DT Arrive @ Plant Date to display format
      * Convert date
     C           1000000   ADD  #1FHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0049
     C                     Z-ADD#1AVTH    ZA0050           DT Arrive @ Pla
      * Send message 'Invalid date/time entries'
     C                     MOVEL'PRK1060' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ******* Default Job Date into 1st blank date *******
     C                     EXSR UASUBR                     ******* Default
      * Get BOL Head shipped -- in case it changed
      * Rtv Avg Live Wgt      RT - Tattoo Header  * 
     C                     EXSR SARVGN
      * Rtv Shipped Head/Spr  RT - Buy Order Load  * 
     C                     EXSR SBRVGN
     C           #1IDA1    MULT YL0006    #1IPA1           DT Delivered We
     C                     MOVEL*BLANK    WUL9ST           Display Output
     C                     MOVEL*BLANK    #DOBTX           Text descriptio
      * Note Susan MTech changes
      * E2423 the HP292 will be used in the Mtech Live or Not MTech Live
      * CASE: DTL.DT Source Type is Internal
     C           #1XKST    IFEQ 'I'                        *IF
      * slm e2423 11/8/13 Verify that this is working
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0001  7        *Return code
     C           WUKQTX    PARM *BLANK    WQ0002 25        Farm site Name
     C                     PARM #1ICA1    WQ0003  50       Farm Site USR
     C                     PARM *BLANK    WQ0004  5        HPS FS Comp Rel
     C                     PARM *BLANK    WQ0005  3        State
     C                     PARM *BLANK    WQ0006 25        HPS Farm County
     C                     PARM *BLANK    WQ0007  5        HPS Cell Manage
     C                     PARM *BLANK    WQ0008 25        HPS Cell Manage
     C           #DYKTX    PARM *BLANK    WQ0009 20        MTech Farm Site
     C                     PARM *BLANK    WQ0010 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
      * 3/4/2014 correct to use the trucker from the drivere
      * Val HPS Driver ActOnlyUP - STR HPS Interface  * 
     C                     CALL 'HP292'                90  Val HPS Driver
     C           WULMST    PARM *BLANK    WQ0011  7        Return Code USR
     C                     PARM #1J8CD    WQ0012  5        DT Driver
     C                     PARM *BLANK    WQ0013 25        HPS Driver Name
     C                     PARM *BLANK    WQ0014  5        DT Transportati
     C                     PARM *BLANK    WQ0015  1        RS Record Statu
     C                     PARM *BLANK    WQ0016 15        DT Truck ID
     C                     PARM *BLANK    WQ0017 15        DT Trailer ID
     C           #1LICD    PARM *BLANK    WQ0018  5        DT Trucker Code
     C                     PARM *BLANK    WQ0019 25        DT Trucker Name
     C           #DYPTX    PARM *BLANK    WQ0020 20        MTech Trucker R
     C           #DYMTX    PARM *BLANK    WQ0021 20        MTech Driver Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP292'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993837*
     C                     END
      * Val HPS Trucker       UP - STR HPS Interface  * 
     C                     CALL 'HP275'                90  Val HPS Trucker
     C           WULMST    PARM *BLANK    WQ0022  7        Return Code USR
     C                     PARM #1LICD    WQ0023  5        DT Trucker Code
     C                     PARM *BLANK    WQ0024 25        HPS Trucker Nam
     C                     PARM *BLANK    WQ0025  1        HPS Trucker Typ
     C                     PARM *BLANK    WQ0026  1        RS Record Statu
     C           #DYPTX    PARM *BLANK    WQ0027 20        MTech Trucker R
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP275'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
     C                     END
      * CASE: DTL.DT Trucker Code HPS NE LCL.DT Trucker Code HPS Prior
     C           #1LICD    IFNE YL0005                     *IF
      * CASE: DB1.DT Trucker Code HPS is Entered
     C           AFLICD    IFNE *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  YL0005:ZQ #DOBTX    P      Text descriptio
     C                     Z-ADD1         ZQ      50
     C           #DOBTX    CAT  @CN,002:ZQ#DOBTX    P      Text descriptio
     C                     END                             *FI
     C                     END                             *FI
      * Val HPS Loading Crew  UP - STR HPS Interface  * 
     C                     CALL 'HP273'                90  Val HPS Loading
     C           WULMST    PARM *BLANK    WQ0028  7        Return Code USR
     C                     PARM AFJ9CD    WQ0029  5        DT Loading Crew
     C                     PARM *BLANK    WQ0030 25        HPS Loading Cre
     C           #1LHCD    PARM *BLANK    WQ0031  5        DT Transportati
     C                     PARM *BLANK    WQ0032  1        RS Record Statu
     C           #DYNTX    PARM *BLANK    WQ0033 20        MTech Load Crew
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP273'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
     C                     END
     C                     END                             *FI
      * CASE: DB1.DT GATE UPDATE *YES is *Yes
     C           AFYDST    IFEQ '*YES'                     *IF
     C                     MOVEL*BLANK    #DUPTX           Text of 35 size
     C                     MOVEL@CN,003   #DUPTX           Text of 35 size
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DUPTX           Text of 35 size
     C                     END                             *FI
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     99    *
      * Send message 'Delivery Tracking      EX'
     C                     MOVEL'PRK1031' ZAMSID
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
     C                     END
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Validate DT Load Type
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1XHST    W0NSRQ  1        DT Load Type
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1XHST'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1309802   Y2LSNO  70
     C           #1XHST    PARM #1XHST    W0EXVL 25        DT Load Type
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate DT Full/Split Load
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1XIST'  IFEQ YPMTFD
      * DT Full/Split Load
     C                     MOVEL#1XIST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHXIST
     C                     SELEC
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD1         ZHXIST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHXIST
     C                     ENDSL
     C                     EXFMTZGXIST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHXIST    WHEQ 1
     C                     MOVEL'F'       W0INVL           F
     C           ZHXIST    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1XIST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate DT Transportation Office
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1LHCD    W0NSRQ  1        DT Transportati
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1LHCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1309946   Y2LSNO  70
     C           #1LHCD    PARM #1LHCD    W0EXVL 25        DT Transportati
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate DT Route Start Time and convert to internal.
      * Validate DT Route Start Date
      * External date
     C                     Z-ADDV1FBDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     Z-ADDXDINDT    #1FBDT
      * Validate DT Arrive @ Plant Time and convert to internal.
      * Validate DT Arrive @ Plant Date
      * External date
     C                     Z-ADDV1FHDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C                     Z-ADDXDINDT    #1FHDT
      * Validate DT Arrive @ Farm Time and convert to internal.
      * Validate DT Arrive @ Farm Date
      * External date
     C                     Z-ADDV1FCDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
     C                     Z-ADDXDINDT    #1FCDT
      * Validate DT TrkScl Weigh-In Time and convert to internal.
      * Validate DT TrkScl Weigh-In Date
      * External date
     C                     Z-ADDV1FIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9950  *
     C                     END
     C                     Z-ADDXDINDT    #1FIDT
      * Validate DT Start Loading Time and convert to internal.
      * Validate DT Start Loading Date
      * External date
     C                     Z-ADDV1FDDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9952  *
     C                     END
     C                     Z-ADDXDINDT    #1FDDT
      * Validate DT To Recv Dock Time and convert to internal.
      * Validate DT To Recv Dock Date
      * External date
     C                     Z-ADDV1FJDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9954  *
     C                     END
     C                     Z-ADDXDINDT    #1FJDT
      * Validate DT Leave Farm Time and convert to internal.
      * Validate DT Leave Farm Date
      * External date
     C                     Z-ADDV1FFDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9956  *
     C                     END
     C                     Z-ADDXDINDT    #1FFDT
      * Validate DT Start Unloading Time and convert to internal.
      * Validate DT Start Unloading Date
      * External date
     C                     Z-ADDV1FKDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9958  *
     C                     END
     C                     Z-ADDXDINDT    #1FKDT
      * Validate DT TrkScl Weigh-Out Time and convert to internal.
      * Validate DT TrkScl Weigh-Out Date
      * External date
     C                     Z-ADDV1FMDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9960  *
     C                     END
     C                     Z-ADDXDINDT    #1FMDT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * F7=Edit Tracking Comments
      * CASE: DTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Edt Delv Track Cmnt   EF - Delivery Tracking Comment  * 
     C                     CLEARPARC
     C                     Z-ADD#1HONB    PAHONB           CC Company Numb
     C                     Z-ADD#1E0DT    PAE0DT           DSH Kill Date
     C                     Z-ADD#1E9DT    PAE9DT           DT Delivery Dat
     C                     Z-ADD#1AJTH    PAAJTH           DT Delivery Tim
     C                     Z-ADD#1H4A1    PAH4A1           DT Delivery Tim
      *
     C                     CALL 'PLAWEFR'              90  Edt Delv Track
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Delivery T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLAWEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F8=Edit Split
      * CASE: DTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * CASE: DTL.DT Full/Split Load is Full
     C           #1XIST    IFEQ 'F'                        *IF
      * Setup message data for message
      * Send message 'F8 not valid for Full'
     C                     MOVEL'PRK1062' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Edt Delv Trckng Split EF - Delivery Tracking Split  * 
     C                     CLEARPBRC
     C                     Z-ADD#1HONB    PBHONB           CC Company Numb
     C                     Z-ADD#1E0DT    PBE0DT           DSH Kill Date
     C                     Z-ADD#1E9DT    PBE9DT           DT Delivery Dat
     C                     Z-ADD#1AJTH    PBAJTH           DT Delivery Tim
     C                     Z-ADD#1H4A1    PBH4A1           DT Delivery Tim
      *
     C                     CALL 'PLA4EFR'              90  Edt Delv Trckng
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Delivery T
     C                     PARM #1IDA1    WQ0034  30       DT Delivered He
     C                     PARM #1ICA1    WQ0035  50       DT Farm Site Co
     C                     PARM #1XKST    WQ0036  1        DT Source Type
     C                     PARM #1IPA1    WQ0037  71       DT Delivered We
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLA4EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.DT Source Type is Internal
     C           #1XKST    IFEQ 'I'                        *IF
      * ******* Prompt HPS Fields  *******
      * Prompt
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * farm site
      * CASE: PGM.*Cursor field <IS> DTL.DT Farm Site Code
     C           W0CFL     IFEQ '#1ICA1'                   *IF
      * E2423 Mtech Live or Not Live will use this HPS program
      * E2423 the HP5003 will be used in the Mtech Live or Not MTech Live
      * slm e2423 11/8/13 Get LEANN to add two MTech Ref - Driver, and Tr
      * slm e2423 11/8/13 Verify that this is working
      * Sel HPS Farm Site     UP - STR HPS Interface  * 
     C                     CALL 'HP5003'               90  Sel HPS Farm Si
     C           WULMST    PARM WULMST    WQ0038  7        Return Code USR
     C           #1ICA1    PARM #1ICA1    WQ0039  50       HRH Farm Site
     C           WUKQTX    PARM WUKQTX    WQ0040 25        Farm site Name
     C           #DYKTX    PARM *BLANK    WQ0041 20        MTech Farm Site
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP5003'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
      * E2423 02202013 Removed Selection on Load Type - Now Condition
      * regardless of Live with Mtech or Not Live with MTech
      * Build Room
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0007    IFEQ 'N'                        *IF
      * E2423 022013
      * CASE:
      *  - c1ORc2
      *   |- c1    : PGM.*Cursor field <IS> DTL.DT Building
      *   |- c2    : PGM.*Cursor field <IS> DTL.DT Room
      *   '-
     C           W0CFL     IFEQ '#1K0CD'                   *IF
     C           W0CFL     OREQ '#1K1CD'                   *OR
      * E2423 Mtech Live will not use this HPS program
      * Z1Sel HPS Building/RoomUP - STR HPS Interface  * 
     C                     CALL 'HP5950'               90  Z1Sel HPS Build
     C                     PARM #1ICA1    WQ0042  50       DSD Farm Site C
     C                     PARM WUKQTX    WQ0043 25        Farm site Name
     C           #1K0CD    PARM #1K0CD    WQ0044  5        DSD Building
     C           #1K1CD    PARM #1K1CD    WQ0045  5        DSD Room
     C           WULGCD    PARM WULGCD    WQ0046  7        DSD Hog Group C
     C           WULLCD    PARM WULLCD    WQ0047  2        HPS Hog Group S
     C           WULNCD    PARM WULNCD    WQ0048  5        HPS Hog Product
     C           WULMCD    PARM WULMCD    WQ0049  5        HPS Hog Product
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP5950'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993334*
     C                     SETON                     35    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Driver
      * CASE: PGM.*Cursor field <IS> DTL.DT Driver
     C           W0CFL     IFEQ '#1J8CD'                   *IF
      * E2423 Mtech Live or Not Live will use this HPS program
     C                     MOVEL#1LICD    YL0005           DT Trucker Code
      * slm e2423 11/8/13 Verify that this is working
      * Sel HPS Driver        UP - STR HPS Interface  * 
     C                     CALL 'HP574'                90  Sel HPS Driver
     C                     PARM 'A'       WQ0050  1        RS Record Statu
     C           #1J8CD    PARM #1J8CD    WQ0051  5        DSD Driver
     C           WUC4TX    PARM WUC4TX    WQ0052 25        Condition Name
     C                     PARM #1LHCD    WQ0053  5        DSD Transportat
     C           #1LICD    PARM *BLANK    WQ0054  5        DT Trucker Code
     C           WUV7TX    PARM *BLANK    WQ0055 25        DT Trucker Name
     C           #DYPTX    PARM *BLANK    WQ0056 20        MTech Trucker R
     C           #DYMTX    PARM *BLANK    WQ0057 20        MTech Driver Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP574'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993842*
     C                     SETON                     37    *
     C                     END
     C                     MOVEL*BLANK    #DOBTX           Text descriptio
      * CASE: DTL.DT Trucker Code HPS NE LCL.DT Trucker Code HPS Prior
     C           #1LICD    IFNE YL0005                     *IF
      * CASE: DB1.DT Trucker Code HPS is Entered
     C           AFLICD    IFNE *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  YL0005:ZQ #DOBTX    P      Text descriptio
     C                     Z-ADD1         ZQ      50
     C           #DOBTX    CAT  @CN,002:ZQ#DOBTX    P      Text descriptio
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Load Crew
      * CASE: PGM.*Cursor field <IS> DTL.DT Loading Crew
     C           W0CFL     IFEQ '#1J9CD'                   *IF
      * E2423 Mtech Live or Not Live will use this HPS program
      * slm e2423 11/8/13 ADD o MTech Ref
      * slm e2423 11/8/13 Verify that this is working
      * Sel HPS Load Crew     UP - STR HPS Interface  * 
     C                     CALL 'HP592'                90  Sel HPS Load Cr
     C                     PARM 'A'       WQ0058  1        RS Record Statu
     C           #1J9CD    PARM #1J9CD    WQ0059  5        DSD Loading Cre
     C           WUC4TX    PARM WUC4TX    WQ0060 25        Condition Name
     C           #DYNTX    PARM *BLANK    WQ0061 20        MTech Load Crew
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP592'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
     C                     END
     C                     END                             *FI
      * Contrct Hauler Rsn
      * CASE: PGM.*Cursor field <IS> DTL.CHR Code
     C           W0CFL     IFEQ '#1MGCD'                   *IF
      * E2423 Mtech Live or Not Live will use this HPS program
      * Sel Contrct Hauler Rs SR - Contract Hauler Reason  * 
     C                     CALL 'PLDSSRR'              90  Sel Contrct Hau
     C                     PARM *BLANK    W0RTN   7
     C           #1MGCD    PARM #1MGCD    WQ0062  6        CHR Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLDSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     END                             *FI
      * Trucker  - add select new slm
      * CASE: PGM.*Cursor field <IS> DTL.DT Trucker Code HPS
     C           W0CFL     IFEQ '#1LICD'                   *IF
      * E2423 Mtech Live or Not Live will use this HPS program
     C                     MOVEL#1LICD    YL0005           DT Trucker Code
      * slm e2423 11/8/13 Verify that this is working
      * Sel HPS Trucker       UP - STR HPS Interface  * 
     C                     CALL 'HP538'                90  Sel HPS Trucker
     C                     PARM 'A'       WQ0063  1        RS Record Statu
     C           #1LICD    PARM #1LICD    WQ0064  5        DSD Trucker Cod
     C           WUC4TX    PARM WUC4TX    WQ0065 25        Condition Name
     C           #DYPTX    PARM *BLANK    WQ0066 20        MTech Trucker R
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP538'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
     C                     END
      * CASE: DTL.DT Trucker Code HPS NE LCL.DT Trucker Code HPS Prior
     C           #1LICD    IFNE YL0005                     *IF
      * CASE: DB1.DT Trucker Code HPS is Entered
     C           AFLICD    IFNE *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  YL0005:ZQ #DOBTX    P      Text descriptio
     C                     Z-ADD1         ZQ      50
     C           #DOBTX    CAT  @CN,002:ZQ#DOBTX    P      Text descriptio
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ******* Validate HPS Fields  *******
      * E2423 Live or Not Live we will use the condition file
      * Load type validation based on condition list
      * Validate Load Type - Required
      * CASE: DTL.DT Load Type is Entered List
     C           #1XHST    IFEQ 'BB'                       *IF
     C           #1XHST    OREQ 'CF'
     C           #1XHST    OREQ 'FD'
     C           #1XHST    OREQ 'FC'
     C           #1XHST    OREQ 'GN'
     C           #1XHST    OREQ 'NL'
     C           #1XHST    OREQ 'RS'
     C           #1XHST    OREQ 'RR'
     C           #1XHST    OREQ 'SC'
     C           #1XHST    OREQ 'TL'
     C           #1XHST    OREQ 'GT'
     C           #1XHST    OREQ 'PG'
     C           #1XHST    OREQ '2D'
     C           #1XHST    OREQ '3D'
     C           #1XHST    OREQ '4D'
     C           #1XHST    OREQ 'G2'
     C           #1XHST    OREQ 'G3'
     C           #1XHST    OREQ 'LD'
     C           #1XHST    OREQ 'G4'
     C           #1XHST    OREQ 'MA'
     C           #1XHST    OREQ 'PP'
     C           #1XHST    OREQ 'PT'
     C           #1XHST    OREQ 'P2'
     C           #1XHST    OREQ 'P3'
     C           #1XHST    OREQ 'CA'
     C           #1XHST    OREQ 'P4'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1XHST    ZA0051           DT Load Type
      * Send message 'Load type not found.'
     C                     MOVEL'PRK1067' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Validate Farm Site
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.DT Farm Site Code NE WRK.Zero USR
      *   |- c2    : LCL.MTech Live Yes or No is No MTech not Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1ICA1    IFNE WUE9NB                     *IF
     C           YL0007    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FP1180 Do not get the Driver nor the Trucker from
      * the farm site.
      * E2423 Mtech Not Live will use this HPS program
      * Change to NLL on the Trasportation office
      * slm e2423 11/8/13 Get LEANN to CHECK ON LOAD CREW
      * slm e2423 11/8/13 Verify that this is working
      * Val HPS Farm SiteNTrDr1IF
      * Modification history
     C                     EXSR UBSUBR                     Modification hi
      * E2423 02202013
      * This HPS program will be used for Mtech Live or not Mtech Live
      * Val HPS Farm Site DS  UP - STR HPS Interface  * 
     C                     CALL 'HP271'                90  Val HPS Farm Si
     C           WULMST    PARM *BLANK    WQ0067  7        Return Code USR
     C                     PARM #1ICA1    WQ0068  50       HRH Farm Site
     C           WUKQTX    PARM *BLANK    WQ0069 25        Farm site Name
     C           WUDRTX    PARM *BLANK    WQ0070  3        State
     C                     PARM *BLANK    WQ0071  5        DT Transportati
     C                     PARM *BLANK    WQ0072  5        DT Trucker Code
     C           YL0008    PARM *BLANK    WQ0073  5        DT Loading Crew
     C                     PARM *BLANK    WQ0074  5        DT Driver
     C           #DYKTX    PARM *BLANK    WQ0075 20        MTech Farm Site
     C                     PARM *BLANK    WQ0076 20        MTech Trucker R
     C           #DYNTX    PARM *BLANK    WQ0077 20        MTech Load Crew
     C                     PARM *BLANK    WQ0078 20        MTech Driver Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP271'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
      * CASE: WRK.Return Code USR is Error Found
     C           WULMST    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     Z-ADD#1ICA1    ZA0052           DT Farm Site Co
      * Send message 'Farm Site Invalid.'
     C                     MOVEL'PRK0688' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.DT Loading Crew is Not Entered
     C           #1J9CD    IFEQ *BLANK                     *IF
     C                     MOVELYL0008    #1J9CD           DT Loading Crew
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Building/Room -  rmc 2/15/05 if changed and not blank
      * CASE:
      *  - (c5ORc3ORc4)AND(c1ORc2)
      *   |- c5    : DTL.DT Farm Site Code NE LCL.DT Farm Site Code
      *   |- c3    : DTL.DT Building NE LCL.DT Building
      *   |- c4    : DTL.DT Room NE LCL.DT Room
      *   |- c1    : DTL.DT Building NE WRK.Blank Usr 2
      *   |- c2    : DTL.DT Room NE WRK.Blank Usr 2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1ICA1    IFNE YL0002                     *IF
     C           #1K0CD    ORNE YL0003                     *OR
     C           #1K1CD    ORNE YL0004                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1K0CD    IFNE WUJ6TX                     *IF
     C           #1K1CD    ORNE WUJ6TX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.DT Full/Split Load is Split
     C           #1XIST    IFEQ 'S'                        *IF
      * Setup message data for message
      * Send message 'Buildng/Rm not val f/splt'
     C                     MOVEL'PRK1061' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993435*
      *
     C                     END                             *FI
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0007    IFEQ 'N'                        *IF
      * E2423 Mtech Live or Not Live will use this program
      * Z1Val HPS Building/RoomUP - STR HPS Interface  * 
     C                     CALL 'HP274'                90  Z1Val HPS Build
     C           WULMST    PARM *BLANK    WQ0079  7        Return Code USR
     C                     PARM #1E9DT    WQ0080  70       DT Delivery Dat
     C                     PARM #1ICA1    WQ0081  50       DT Farm Site Co
     C                     PARM #1K0CD    WQ0082  5        DT Building
     C                     PARM #1K1CD    WQ0083  5        DT Room
     C           #1LGCD    PARM *BLANK    WQ0084 10        DT Hog Group Re
     C           #1LFCD    PARM *BLANK    WQ0085  5        DT Sire Line Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP274'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993334*
     C                     SETON                     35    *
     C                     END
      * CASE: WRK.Return Code USR is Error Found
     C           WULMST    IFEQ 'ERROR'                    *IF
      * Setup message data for message
      * Send message 'Buildng/room not valid'
     C                     MOVEL'PRK1077' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993435*
      *
     C                     ELSE
      * CASE: WRK.Return Code USR is Multiple group no selectn
     C           WULMST    IFEQ @CN,004                    *IF
      * Setup message data for message
      * Send message 'Buildng/room mult group'
     C                     MOVEL'PRK1129' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993435*
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1ICA1    YL0002           DT Farm Site Co
     C                     MOVEL#1K0CD    YL0003           DT Building
     C                     MOVEL#1K1CD    YL0004           DT Room
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0007    IFEQ 'Y'                        *IF
     C                     Z-ADD#1ICA1    YL0002           DT Farm Site Co
     C                     MOVEL#1K0CD    YL0003           DT Building
     C                     MOVEL#1K1CD    YL0004           DT Room
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Driver - without default from farm site
     C                     EXSR UCSUBR                     Validate Driver
      * Validate Trucker  / Contract Hauler Reason
      * CASE: DTL.DT Trucker Code HPS NE WRK.Blank Usr 2
     C           #1LICD    IFNE WUJ6TX                     *IF
      * Validate if entered .. but dont force it here. 01/22/04
      * CASE: DTL.CHR Code is Not Entered
     C           #1MGCD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Contrct Hauler Rs RT - Contract Hauler Reason  * 
     C                     EXSR SCRVGN
      * CASE: WRK.Return Code USR is *Record does not exist
     C           WULMST    IFEQ @CN,005                    *IF
      * Setup message data for message
      * Send message 'Contract Hauler Reason NF'
     C                     MOVEL'PRK1094' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load Crew
      * CASE: DTL.DT Loading Crew NE WRK.Blank Usr 2
     C           #1J9CD    IFNE WUJ6TX                     *IF
      * E2423 Mtech Live or Not Live will use this HPS program
      * slm e2423 11/8/13 Verify that this is working
      * Val HPS Loading Crew  UP - STR HPS Interface  * 
     C                     CALL 'HP273'                90  Val HPS Loading
     C           WULMST    PARM *BLANK    WQ0097  7        Return Code USR
     C                     PARM #1J9CD    WQ0098  5        DT Loading Crew
     C           WUSMTX    PARM *BLANK    WQ0099 25        HPS Loading Cre
     C           WULHCD    PARM *BLANK    WQ0100  5        DT Transportati
     C           WUAJST    PARM *BLANK    WQ0101  1        RS Record Statu
     C           #DYNTX    PARM *BLANK    WQ0102 20        MTech Load Crew
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP273'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
     C                     END
      * CASE: WRK.Return Code USR is Error Found
     C           WULMST    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVEL#1J9CD    ZA0054           DT Loading Crew
      * Send message 'Loading Crew NF'
     C                     MOVEL'PRK1065' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate DT Split Head total - Original Code
      * CASE: DTL.DT Full/Split Load is Split
     C           #1XIST    IFEQ 'S'                        *IF
      * Rtv Accum Split Hd    RT - Delivery Tracking Split  * 
     C                     EXSR SDRVGN
      * CASE: WRK.DTS Delivered Head NE DTL.DT Delivered Head
     C           WUIHA1    IFNE #1IDA1                     *IF
      * Setup message data for message
      * Send message 'Delv Track Split Head Err'
     C                     MOVEL'PRK1063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Split exists if changed to Full
      * CASE: DTL.DT Full/Split Load is Full
     C           #1XIST    IFEQ 'F'                        *IF
      * Rtv Accum Split Hd    RT - Delivery Tracking Split  * 
     C                     EXSR SERVGN
      * CASE: WRK.DTS Delivered Head GT WRK.Zero USR
     C           WUIHA1    IFGT WUE9NB                     *IF
      * Setup message data for message
      * Send message 'Delv Track Split Exists'
     C                     MOVEL'PRK1068' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Times as military 8/5/2021 negative not allowed
     C                     EXSR UDSUBR                     Validate Times
      * Default Route Start Date if >0, into all dates with times 2/11/04
      * CASE: DTL.DT Route Start Date is Entered
     C           #1FBDT    IFNE *ZERO                      *IF
     C                     Z-ADD#1FBDT    YL0012           Date USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1E9DT    YL0012           Date USR
     C                     END                             *FI
      * arrive @ farm
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Arrive @ Farm Time is Entered
      *   |- c2    : DTL.DT Arrive @ Farm Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1ANTH    IFGT *ZERO                      *IF
     C           #1FCDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FCDT           DT Arrive @ Far
     C                     END                             *FI
      * start loading
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Start Loading Time is Entered
      *   |- c2    : DTL.DT Start Loading Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AOTH    IFGT *ZERO                      *IF
     C           #1FDDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FDDT           DT Start Loadin
     C                     END                             *FI
      * leave farm
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Leave Farm Time is Entered
      *   |- c2    : DTL.DT Leave Farm Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1ASTH    IFGT 0                          *IF
     C           #1FFDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FFDT           DT Leave Farm D
     C                     END                             *FI
      * arrive @ plant
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Arrive @ Plant Time is Entered
      *   |- c2    : DTL.DT Arrive @ Plant Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AVTH    IFGT *ZERO                      *IF
     C           #1FHDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FHDT           DT Arrive @ Pla
     C                     END                             *FI
      * trk scl weigh in
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT TrkScl Weigh-In Time is Entered
      *   |- c2    : DTL.DT TrkScl Weigh-In Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AXTH    IFGT *ZERO                      *IF
     C           #1FIDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FIDT           DT TrkScl Weigh
     C                     END                             *FI
      * to recv dock
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT To Recv Dock Time is Entered
      *   |- c2    : DTL.DT To Recv Dock Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AZTH    IFGT *ZERO                      *IF
     C           #1FJDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FJDT           DT To Recv Dock
     C                     END                             *FI
      * start unloading
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT Start Unloading Time is Entered
      *   |- c2    : DTL.DT Start Unloading Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1A1TH    IFGT *ZERO                      *IF
     C           #1FKDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FKDT           DT Start Unload
     C                     END                             *FI
      * trk scl weigh out
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.DT TrkScl Weigh-Out Time is Entered
      *   |- c2    : DTL.DT TrkScl Weigh-Out Date is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1A5TH    IFGT *ZERO                      *IF
     C           #1FMDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    #1FMDT           DT TrkScl Weigh
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Delivery Reason
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Source
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Buy Order Load
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * DT Full/Split Load required
     C           #1XIST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Force PUTOVR
     C                     SETON                         86*
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Crt Delivery Tracking CR - Delivery Tracking  * 
     C                     EXSR SGCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Delivery Tracking IF
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UNSUBR                     Get the MTech L
      * Rtv DSH Status        RT - Delivery Sched Header  * 
     C                     EXSR SKRVGN
      * Update Date/Times only if the Time is also entered  2/26/03
     C                     EXSR UOSUBR                     Update Date/Tim
      * CASE: PAR.DT Arrive @ Plant Time is Entered
     C           #1AVTH    IFGT 0                          *IF
     C           #1AVTH    DIV  100       YL0015           DT Actual Deliv
     C                     END                             *FI
      * Chg Delivery Tracking CH - Delivery Tracking  * 
     C                     EXSR SLCHRC
      * E2423 changes due to farm site, and Live or not Live with Mtech
      * CASE: PAR.DT Source Type is Internal
     C           #1XKST    IFEQ 'I'                        *IF
      * E2423 changes due to farm site, and Live or not Live with Mtech
      * Get Farm Site Information either by Movement or Farm Site
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0013    IFEQ 'Y'                        *IF
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0125  7        *Return code
     C           WUKQTX    PARM *BLANK    WQ0126 25        Farm site Name
     C                     PARM #1ICA1    WQ0127  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0128  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0129  3        State
     C           WUQGTX    PARM *BLANK    WQ0130 25        HPS Farm County
     C           WUJXCD    PARM *BLANK    WQ0131  5        HPS Cell Manage
     C           WUQFTX    PARM *BLANK    WQ0132 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0133 20        MTech Farm Site
     C                     PARM *BLANK    WQ0134 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADD#1ICA1    YL0016           Farm Site USR
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0013    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0135  7        *Return code
     C                     PARM #1IEA1    WQ0136  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0137 25        Farm site Name
     C           YL0016    PARM *ZERO     WQ0138  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0139  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0140  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Upd Farm, Movement    RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0013    IFEQ 'N'                        *IF
      * E2423 Mtech Not Live
      * Get the next movement number using the HPS app - Not Live with Mt
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.DT Source Type is Internal
      *   |- c2    : LCL.DSH Status is Open for Live Prod
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XKST    IFEQ 'I'                        *IF
     C           YL0014    IFEQ '02'                       *IF
     C           YL0014    OREQ '03'
     C           YL0014    OREQ '05'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#1IEA1    YL0017           DT Movement Num
      * Z1d Shppd Mvmnts f/DT UP - STR HPS Interface  * 
     C                     CALL 'HP278'                90  Z1d Shppd Mvmnt
     C                     PARM #1HONB    WQ0151  30       CC Company Numb
     C                     PARM #1E0DT    WQ0152  70       DSH Kill Date
     C                     PARM #1E9DT    WQ0153  70       DT Delivery Dat
     C                     PARM #1AJTH    WQ0154  40       DT Delivery Tim
     C                     PARM #1H4A1    WQ0155  30       DT Delivery Tim
     C           YL0017    PARM YL0017    WQ0156  70       DT Movement Num
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP278'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.DT Movement Number EQ WRK.Zero USR
     C           #1IEA1    IFEQ WUE9NB                     *IF
      * CASE: LCL.DT Movement Number EQ WRK.Zero USR
     C           YL0017    IFEQ WUE9NB                     *IF
      * Setup message data for message
     C                     Z-ADDYL0017    ZA0055           DT Movement Num
      * Send message 'Unsch Movement not creatd'
     C                     MOVEL'PRK1072' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Movement #        RT - Delivery Tracking  * 
     C                     EXSR SPRVGN
      * since the movement is being created then what is the
      * farm site and state code for this movement
      * this was done to have the farm site movement and state code on
      * the tattoo header
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0157  7        *Return code
     C                     PARM YL0017    WQ0158  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0159 25        Farm site Name
     C           YL0016    PARM *ZERO     WQ0160  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0161  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0162  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Upd Farm, Movement,St RT - Tattoo Header  * 
     C                     EXSR SRRVGN
      * Setup message data for message
     C                     Z-ADDYL0017    ZA0056           DT Movement Num
      * Send message 'Unsch Movement created'
     C                     MOVEL'PRK1071' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0013    IFEQ 'Y'                        *IF
      * E2423 Mtech Live will not be assigning movement numbers
     C                     END                             *FI
     C                     END                             *FI
      * Susan Mason 8/11/2011 Changes to the Arrival Process
     C                     MOVELP5EOSS    YL0018           Trk Arrival Sch
      * CASE: LCL.Trk Arrival Sched Sts is Allow Arrival Process
     C           YL0018    IFEQ 'Y'                        *IF
      * If Arrival process = yes then dates are required
      * Validation for the Maintenance of the delivery tracking
      * Val DelTrck ArrvRules XF - Delivery Tracking  * 
     C                     CLEARPCRC
     C                     Z-ADD#1HMNB    PCHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PCBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PCBONB           BOL Load Number
     C                     Z-ADD#1E0DT    PCE0DT           DSH Kill Date
      *
     C                     CALL 'PLQGXFR'              90  Val DelTrck Arr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Delivery T
     C           WUPAST    PARM *BLANK    WQ0173  1        BOL Truck Scale
     C           W0RTN     PARM *BLANK    WQ0174  7        *Return code
     C                     PARM 'M'       WQ0175  1        TRK Arrival Ste
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLQGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is Arrival Date/Tm Error
     C           W0RTN     IFEQ 'A'                        *IF
     C                     ELSE
      * CASE: WRK.BOL Truck Scale Weigh Sts is In/Out/Respread
     C           WUPAST    IFEQ 'I'                        *IF
     C           WUPAST    OREQ 'O'
     C           WUPAST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0018           Trk Arrival Sch
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Trk Arrival Sched Sts is Authorized Process
     C           YL0018    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Arrive @ Plant Date is Entered
     C           #1FHDT    IFNE 0                          *IF
      * Set to A
      * Chg Bol Spr - ArvProc XF - Buy Order Load  * 
     C                     CALL 'PLQMXFR'              90  Chg Bol Spr - A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0176  30       BOH Company Num
     C                     PARM #1BNNB    WQ0177  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0178  50       BOL Load Number
     C                     PARM 'A'       WQ0179  1        BOL Truck Scale
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLQMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.DT Arrive @ Plant Date is Not Entered
     C           #1FHDT    IFEQ 0                          *IF
      * Set to none
      * Chg Bol Spr - ArvProc XF - Buy Order Load  * 
     C                     CALL 'PLQMXFR'              90  Chg Bol Spr - A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0180  30       BOH Company Num
     C                     PARM #1BNNB    WQ0181  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0182  50       BOL Load Number
     C                     PARM *BLANK    WQ0183  1        BOL Truck Scale
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLQMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YHRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUFKSS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0007    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Disable key screen
     C                     SETOF                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #1JIA1           DT Actual Deliv
     C                     Z-ADD*ZERO     #1IBA1           DT Scheduled Ho
     C                     Z-ADD*ZERO     #1H2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     #1J2A1           DT Head Receive
     C                     Z-ADD*ZERO     #1J3A1           DT Weight Recei
     C                     Z-ADD*ZERO     #1KMA1           DT Avg Weight R
     C                     Z-ADD*ZERO     #1J4A1           DT Head DOA
     C                     Z-ADD*ZERO     #1J5A1           DT Weight DOA
     C                     Z-ADD*ZERO     #1J6A1           DT Head Yard De
     C                     Z-ADD*ZERO     #1J7A1           DT Weight Yard
     C                     Z-ADD*ZERO     #1J8A1           DT Head Condemn
     C                     Z-ADD*ZERO     #1J9A1           DT Weight Conde
     C                     Z-ADD*ZERO     #1KAA1           DT Head Held Ov
     C                     Z-ADD*ZERO     #1KBA1           DT Weight Held
     C                     Z-ADD*ZERO     #1KCA1           DT Head Killed
     C                     Z-ADD*ZERO     #1KDA1           DT Weight Kille
     C                     Z-ADD*ZERO     #1KEA1           DT Head Market
     C                     Z-ADD*ZERO     #1KFA1           DT Weight Marke
     C                     Z-ADD*ZERO     #1KNA1           DT Avg Weight M
     C                     Z-ADD*ZERO     #1KGA1           DT Head Resale
     C                     Z-ADD*ZERO     #1KHA1           DT Weight Resal
     C                     Z-ADD*ZERO     #1KOA1           DT Avg Weight R
     C                     Z-ADD*ZERO     #1KIA1           DT Head Unused
     C                     Z-ADD*ZERO     #1KJA1           DT Weight Unuse
     C                     Z-ADD*ZERO     #1KKA1           DT Head Unused
     C                     Z-ADD*ZERO     #1KLA1           DT Weight Unuse
     C                     MOVEL*BLANK    #1YNST           DT Error Sts
     C                     MOVEL*BLANK    #1YOST           DT Error Reason
     C                     MOVEL*BLANK    #1LFCD           DT Sire Line Co
     C                     MOVEL*BLANK    #1AACD           SR Source Code
     C                     Z-ADD*ZERO     #1HMNB           BOH Company Num
     C                     MOVEL*BLANK    #1W5ST           DT Delivery Ini
     C                     MOVEL*BLANK    #1LGCD           DT Hog Group Re
     C                     MOVEL*BLANK    #1XXST           DT Route Start
     C                     MOVEL*BLANK    #1YDST           DT GATE UPDATE
     C                     Z-ADD*ZERO     #1BVTH           DT Route Start
     C                     Z-ADD*ZERO     #1FGDT           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     #1AUTH           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     #1FADT           DT Transprtn Of
     C                     Z-ADD*ZERO     #1AKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     #1BYTH           DT Arrive@Frm v
     C                     MOVEL*BLANK    #1W6ST           DT On-Time Farm
     C                     Z-ADD*ZERO     #1AMTH           DT Wait @ Trans
     C                     Z-ADD*ZERO     #1BHTH           DT Drive Time T
     C                     Z-ADD*ZERO     #1APTH           DT Wait @ Farm
     C                     Z-ADD*ZERO     #1BWTH           DT Start Loadin
     C                     Z-ADD*ZERO     #1FEDT           DT Frm End Load
     C                     Z-ADD*ZERO     #1AQTH           DT Frm End Load
     C                     Z-ADD*ZERO     #1ARTH           DT Load Time
     C                     Z-ADD*ZERO     #1ATTH           DT Wait-Depart
     C                     Z-ADD*ZERO     #1AWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     #1BKTH           DT Drive Time T
     C                     Z-ADD*ZERO     #1BLTH           DT Delv Time Va
     C                     MOVEL*BLANK    #1XJST           DT On Time Deli
     C                     MOVEL*BLANK    #1K3CD           Delivery Reason
     C                     Z-ADD*ZERO     #1AYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     #1A0TH           DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     #1A2TH           DT Wait @ Rcv D
     C                     Z-ADD*ZERO     #1A4TH           DT Unload Time
     C                     Z-ADD*ZERO     #1BTTH           DT Unload Varia
     C                     Z-ADD*ZERO     #1FLDT           DT End Unload D
     C                     Z-ADD*ZERO     #1A3TH           DT End Unload T
     C                     Z-ADD*ZERO     #1A6TH           DT Wait Time @
     C                     Z-ADD*ZERO     #1BXTH           DT Formula Wait
     C                     MOVEL*BLANK    #1XKST           DT Source Type
     C                     Z-ADD*ZERO     #1FYDT           DT Unused Date
     C                     Z-ADD*ZERO     #1B0TH           DT Unused Time
     C                     Z-ADD*ZERO     #1BZTH           DT Unused Wait
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVEL*BLANK    #1XHST           DT Load Type
     C                     Z-ADD*ZERO     #1IEA1           DT Movement Num
     C                     MOVEL*BLANK    #1XIST           DT Full/Split L
     C                     Z-ADD*ZERO     #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1ICA1           DT Farm Site Co
     C                     MOVEL*BLANK    #DYKTX           MTech Farm Site
     C                     Z-ADD*ZERO     #1BONB           BOL Load Number
     C                     MOVEL*BLANK    #1K0CD           DT Building
     C                     MOVEL*BLANK    #1K1CD           DT Room
     C                     Z-ADD*ZERO     #1FXDT           DT Actual Kill
      * Clear external version also
     C                     Z-ADD*ZERO     V1FXDT
     C                     MOVEL*BLANK    #1J9CD           DT Loading Crew
     C                     MOVEL*BLANK    #1LICD           DT Trucker Code
     C                     MOVEL*BLANK    #DYPTX           MTech Trucker R
     C                     MOVEL*BLANK    #DYNTX           MTech Load Crew
     C                     MOVEL*BLANK    #1J8CD           DT Driver
     C                     MOVEL*BLANK    #DYMTX           MTech Driver Re
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     Z-ADD*ZERO     #1IDA1           DT Delivered He
     C                     MOVEL*BLANK    #1KBCD           DT Truck ID
     C                     MOVEL*BLANK    #1AECD           PL Location Cod
     C                     Z-ADD*ZERO     #1IPA1           DT Delivered We
     C                     MOVEL*BLANK    #1KZCD           DT Trailer ID
     C                     MOVEL*BLANK    #DOBTX           Text descriptio
     C                     MOVEL*BLANK    #1MGCD           CHR Code
     C                     MOVEL*BLANK    #DUPTX           Text of 35 size
     C                     MOVEL*BLANK    #1LHCD           DT Transportati
     C                     Z-ADD*ZERO     #1ALTH           DT Route Start
     C                     Z-ADD*ZERO     #1FBDT           DT Route Start
      * Clear external version also
     C                     Z-ADD*ZERO     V1FBDT
     C                     Z-ADD*ZERO     #1AVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     #1FHDT           DT Arrive @ Pla
      * Clear external version also
     C                     Z-ADD*ZERO     V1FHDT
     C                     Z-ADD*ZERO     #1ANTH           DT Arrive @ Far
     C                     Z-ADD*ZERO     #1FCDT           DT Arrive @ Far
      * Clear external version also
     C                     Z-ADD*ZERO     V1FCDT
     C                     Z-ADD*ZERO     #1AXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     #1FIDT           DT TrkScl Weigh
      * Clear external version also
     C                     Z-ADD*ZERO     V1FIDT
     C                     Z-ADD*ZERO     #1AOTH           DT Start Loadin
     C                     Z-ADD*ZERO     #1FDDT           DT Start Loadin
      * Clear external version also
     C                     Z-ADD*ZERO     V1FDDT
     C                     Z-ADD*ZERO     #1AZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     #1FJDT           DT To Recv Dock
      * Clear external version also
     C                     Z-ADD*ZERO     V1FJDT
     C                     Z-ADD*ZERO     #1ASTH           DT Leave Farm T
     C                     Z-ADD*ZERO     #1FFDT           DT Leave Farm D
      * Clear external version also
     C                     Z-ADD*ZERO     V1FFDT
     C                     Z-ADD*ZERO     #1A1TH           DT Start Unload
     C                     Z-ADD*ZERO     #1FKDT           DT Start Unload
      * Clear external version also
     C                     Z-ADD*ZERO     V1FKDT
     C                     Z-ADD*ZERO     #1A5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     #1FMDT           DT TrkScl Weigh
      * Clear external version also
     C                     Z-ADD*ZERO     V1FMDT
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @AFCPIJ fields to screen
      *================================================================
     C                     Z-ADDAFJIA1    #1JIA1           DT Actual Deliv
     C                     Z-ADDAFIBA1    #1IBA1           DT Scheduled Ho
     C                     Z-ADDAFH2A1    #1H2A1           DSD Scheduled D
     C                     Z-ADDAFJ2A1    #1J2A1           DT Head Receive
     C                     Z-ADDAFJ3A1    #1J3A1           DT Weight Recei
     C                     Z-ADDAFKMA1    #1KMA1           DT Avg Weight R
     C                     Z-ADDAFJ4A1    #1J4A1           DT Head DOA
     C                     Z-ADDAFJ5A1    #1J5A1           DT Weight DOA
     C                     Z-ADDAFJ6A1    #1J6A1           DT Head Yard De
     C                     Z-ADDAFJ7A1    #1J7A1           DT Weight Yard
     C                     Z-ADDAFJ8A1    #1J8A1           DT Head Condemn
     C                     Z-ADDAFJ9A1    #1J9A1           DT Weight Conde
     C                     Z-ADDAFKAA1    #1KAA1           DT Head Held Ov
     C                     Z-ADDAFKBA1    #1KBA1           DT Weight Held
     C                     Z-ADDAFKCA1    #1KCA1           DT Head Killed
     C                     Z-ADDAFKDA1    #1KDA1           DT Weight Kille
     C                     Z-ADDAFKEA1    #1KEA1           DT Head Market
     C                     Z-ADDAFKFA1    #1KFA1           DT Weight Marke
     C                     Z-ADDAFKNA1    #1KNA1           DT Avg Weight M
     C                     Z-ADDAFKGA1    #1KGA1           DT Head Resale
     C                     Z-ADDAFKHA1    #1KHA1           DT Weight Resal
     C                     Z-ADDAFKOA1    #1KOA1           DT Avg Weight R
     C                     Z-ADDAFKIA1    #1KIA1           DT Head Unused
     C                     Z-ADDAFKJA1    #1KJA1           DT Weight Unuse
     C                     Z-ADDAFKKA1    #1KKA1           DT Head Unused
     C                     Z-ADDAFKLA1    #1KLA1           DT Weight Unuse
     C                     MOVELAFYNST    #1YNST           DT Error Sts
     C                     MOVELAFYOST    #1YOST           DT Error Reason
     C                     MOVELAFLFCD    #1LFCD           DT Sire Line Co
     C                     MOVELAFAACD    #1AACD           SR Source Code
     C                     Z-ADDAFHMNB    #1HMNB           BOH Company Num
     C                     MOVELAFW5ST    #1W5ST           DT Delivery Ini
     C                     MOVELAFLGCD    #1LGCD           DT Hog Group Re
     C                     MOVELAFXXST    #1XXST           DT Route Start
     C                     MOVELAFYDST    #1YDST           DT GATE UPDATE
     C                     Z-ADDAFBVTH    #1BVTH           DT Route Start
     C                     Z-ADDAFFGDT    #1FGDT           DT Plt TrkWsh A
     C                     Z-ADDAFAUTH    #1AUTH           DT Plt TrkWsh A
     C                     Z-ADDAFFADT    #1FADT           DT Transprtn Of
     C                     Z-ADDAFAKTH    #1AKTH           DT Transprtn Of
     C                     Z-ADDAFBYTH    #1BYTH           DT Arrive@Frm v
     C                     MOVELAFW6ST    #1W6ST           DT On-Time Farm
     C                     Z-ADDAFAMTH    #1AMTH           DT Wait @ Trans
     C                     Z-ADDAFBHTH    #1BHTH           DT Drive Time T
     C                     Z-ADDAFAPTH    #1APTH           DT Wait @ Farm
     C                     Z-ADDAFBWTH    #1BWTH           DT Start Loadin
     C                     Z-ADDAFFEDT    #1FEDT           DT Frm End Load
     C                     Z-ADDAFAQTH    #1AQTH           DT Frm End Load
     C                     Z-ADDAFARTH    #1ARTH           DT Load Time
     C                     Z-ADDAFATTH    #1ATTH           DT Wait-Depart
     C                     Z-ADDAFAWTH    #1AWTH           DT Wait @ TrkWs
     C                     Z-ADDAFBKTH    #1BKTH           DT Drive Time T
     C                     Z-ADDAFBLTH    #1BLTH           DT Delv Time Va
     C                     MOVELAFXJST    #1XJST           DT On Time Deli
     C                     MOVELAFK3CD    #1K3CD           Delivery Reason
     C                     Z-ADDAFAYTH    #1AYTH           DT Wait @ TrkSc
     C                     Z-ADDAFA0TH    #1A0TH           DT Wait-Rcv Doc
     C                     Z-ADDAFA2TH    #1A2TH           DT Wait @ Rcv D
     C                     Z-ADDAFA4TH    #1A4TH           DT Unload Time
     C                     Z-ADDAFBTTH    #1BTTH           DT Unload Varia
     C                     Z-ADDAFFLDT    #1FLDT           DT End Unload D
     C                     Z-ADDAFA3TH    #1A3TH           DT End Unload T
     C                     Z-ADDAFA6TH    #1A6TH           DT Wait Time @
     C                     Z-ADDAFBXTH    #1BXTH           DT Formula Wait
     C                     MOVELAFXKST    #1XKST           DT Source Type
     C                     Z-ADDAFFYDT    #1FYDT           DT Unused Date
     C                     Z-ADDAFB0TH    #1B0TH           DT Unused Time
     C                     Z-ADDAFBZTH    #1BZTH           DT Unused Wait
     C                     MOVELAFAAVN    #1AAVN           RS User Changed
     C                     Z-ADDAFAADT    #1AADT           RS Date Changed
     C                     Z-ADDAFAMTM    #1AMTM           RS Time Changed
     C                     MOVELAFAJST    #1AJST           RS Record Statu
     C                     MOVELAFAHVN    #1AHVN           RS Job
     C                     MOVELAFAGVN    #1AGVN           RS Program
     C                     MOVELAFABVN    #1ABVN           RS User Added
     C                     Z-ADDAFABDT    #1ABDT           RS Date Added
     C                     Z-ADDAFABTM    #1ABTM           RS Time Added
     C                     Z-ADDAFHONB    #1HONB           CC Company Numb
     C                     Z-ADDAFE0DT    #1E0DT           DSH Kill Date
     C                     MOVELAFXHST    #1XHST           DT Load Type
     C                     Z-ADDAFIEA1    #1IEA1           DT Movement Num
     C                     Z-ADDAFE9DT    #1E9DT           DT Delivery Dat
     C                     MOVELAFXIST    #1XIST           DT Full/Split L
     C                     Z-ADDAFBNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDAFAJTH    #1AJTH           DT Delivery Tim
     C                     Z-ADDAFICA1    #1ICA1           DT Farm Site Co
     C                     Z-ADDAFBONB    #1BONB           BOL Load Number
     C                     Z-ADDAFH4A1    #1H4A1           DT Delivery Tim
     C                     MOVELAFK0CD    #1K0CD           DT Building
     C                     MOVELAFK1CD    #1K1CD           DT Room
     C                     Z-ADDAFFXDT    #1FXDT           DT Actual Kill
     C                     MOVELAFJ9CD    #1J9CD           DT Loading Crew
     C                     MOVELAFLICD    #1LICD           DT Trucker Code
     C                     MOVELAFJ8CD    #1J8CD           DT Driver
     C                     MOVELAFABCD    #1ABCD           PD Producer Cod
     C                     Z-ADDAFIDA1    #1IDA1           DT Delivered He
     C                     MOVELAFKBCD    #1KBCD           DT Truck ID
     C                     MOVELAFAECD    #1AECD           PL Location Cod
     C                     Z-ADDAFIPA1    #1IPA1           DT Delivered We
     C                     MOVELAFKZCD    #1KZCD           DT Trailer ID
     C                     MOVELAFMGCD    #1MGCD           CHR Code
     C                     MOVELAFLHCD    #1LHCD           DT Transportati
     C                     Z-ADDAFALTH    #1ALTH           DT Route Start
     C                     Z-ADDAFFBDT    #1FBDT           DT Route Start
     C                     Z-ADDAFAVTH    #1AVTH           DT Arrive @ Pla
     C                     Z-ADDAFFHDT    #1FHDT           DT Arrive @ Pla
     C                     Z-ADDAFANTH    #1ANTH           DT Arrive @ Far
     C                     Z-ADDAFFCDT    #1FCDT           DT Arrive @ Far
     C                     Z-ADDAFAXTH    #1AXTH           DT TrkScl Weigh
     C                     Z-ADDAFFIDT    #1FIDT           DT TrkScl Weigh
     C                     Z-ADDAFAOTH    #1AOTH           DT Start Loadin
     C                     Z-ADDAFFDDT    #1FDDT           DT Start Loadin
     C                     Z-ADDAFAZTH    #1AZTH           DT To Recv Dock
     C                     Z-ADDAFFJDT    #1FJDT           DT To Recv Dock
     C                     Z-ADDAFASTH    #1ASTH           DT Leave Farm T
     C                     Z-ADDAFFFDT    #1FFDT           DT Leave Farm D
     C                     Z-ADDAFA1TH    #1A1TH           DT Start Unload
     C                     Z-ADDAFFKDT    #1FKDT           DT Start Unload
     C                     Z-ADDAFA5TH    #1A5TH           DT TrkScl Weigh
     C                     Z-ADDAFFMDT    #1FMDT           DT TrkScl Weigh
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     Z-ADDP1E0DT    #1E0DT           DSH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1E0DT
     C                     Z-ADDP1E9DT    #1E9DT           DT Delivery Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1E9DT
     C                     Z-ADDP1AJTH    #1AJTH           DT Delivery Tim
     C                     Z-ADDP1H4A1    #1H4A1           DT Delivery Tim
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert DSH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1E0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1E0DT
      * Convert DT Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1E9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1E9DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert DSH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1E0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1E0DT
      * Convert DT Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1E9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1E9DT
      * Convert DT Actual Kill Date to display format
      * Convert date
     C           1000000   ADD  #1FXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FXDT
      * Convert DT Route Start Date to display format
      * Convert date
     C           1000000   ADD  #1FBDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FBDT
      * Convert DT Arrive @ Plant Date to display format
      * Convert date
     C           1000000   ADD  #1FHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FHDT
      * Convert DT Arrive @ Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FCDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FCDT
      * Convert DT TrkScl Weigh-In Date to display format
      * Convert date
     C           1000000   ADD  #1FIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FIDT
      * Convert DT Start Loading Date to display format
      * Convert date
     C           1000000   ADD  #1FDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FDDT
      * Convert DT To Recv Dock Date to display format
      * Convert date
     C           1000000   ADD  #1FJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FJDT
      * Convert DT Leave Farm Date to display format
      * Convert date
     C           1000000   ADD  #1FFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FFDT
      * Convert DT Start Unloading Date to display format
      * Convert date
     C           1000000   ADD  #1FKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FKDT
      * Convert DT TrkScl Weigh-Out Date to display format
      * Convert date
     C           1000000   ADD  #1FMDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1FMDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Avg Live Wgt      RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           TH Avg Live Wgt
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSA02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSA03           BOL Load Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOH Buy Order N
     C                     KFLD           WQSA03           BOL Load Number
      * Setup key
     C                     Z-ADDAFHMNB    WQSA01           BOH Company Num
     C                     Z-ADDAFBNNB    WQSA02           BOH Buy Order N
     C                     Z-ADDAFBONB    WQSA03           BOL Load Number
      * Establish starting position
     C           KRSSA     SETLL@A1CPC4                    *
     C           KRSSA     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : PAR.TH Avg Live Wgt is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1LLST    IFEQ 'M'                        *IF
     C           YL0006    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDA1F7NB    YL0006           TH Avg Live Wgt
     C                     END                             *FI
     C           KRSSA     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Shipped Head/Spr  RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDAFHMNB    AXHMNB           BOH Company Num
     C                     Z-ADDAFBNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDAFBONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSB     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPAST           BOL Truck Scale
     C                     Z-ADD*ZERO     #1IDA1           BOL Shipped Hea
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAXPAST    WUPAST           BOL Truck Scale
     C                     Z-ADDAXLDSH    #1IDA1           BOL Shipped Hea
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Val Contrct Hauler Rs RT - Contract Hauler Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ANMGCD           CHR Code
      * Setup key
     C                     MOVEL#1MGCD    ANMGCD           CHR Code
      * Establish starting position
     C           KRSSC     CHAIN@ANREKG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1094' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WULMST           Return Code USR
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WULMST           Return Code USR
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Accum Split Hd    RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUIHA1           DT Delivered He
     C                     Z-ADD*ZERO     WUH3NB           Weight Tot USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSD01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSD02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSD03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSD04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSD05           DT Delivery Tim
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CC Company Numb
     C                     KFLD           WQSD02           DSH Kill Date
     C                     KFLD           WQSD03           DT Delivery Dat
     C                     KFLD           WQSD04           DT Delivery Tim
     C                     KFLD           WQSD05           DT Delivery Tim
      * Setup key
     C                     Z-ADD#1HONB    WQSD01           CC Company Numb
     C                     Z-ADD#1E0DT    WQSD02           DSH Kill Date
     C                     Z-ADD#1E9DT    WQSD03           DT Delivery Dat
     C                     Z-ADD#1AJTH    WQSD04           DT Delivery Tim
     C                     Z-ADD#1H4A1    WQSD05           DT Delivery Tim
      * Establish starting position
     C           KRSSD     SETLL@AJCPIY                    *
     C           KRSSD     READE@AJCPIY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1038' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUIHA1           DT Delivered He
     C                     Z-ADD*ZERO     WUH3NB           Weight Tot USR
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           AJAJST    IFEQ 'A'                        *IF
     C                     ADD  AJIHA1    WUIHA1           DT Delivered He
     C                     ADD  AJUNA1    WUH3NB           Weight Tot USR
     C                     END                             *FI
     C           KRSSD     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Accum Split Hd    RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUIHA1           DT Delivered He
     C                     Z-ADD*ZERO     WUH3NB           Weight Tot USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSE01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSE02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSE03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSE04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSE05           DT Delivery Tim
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CC Company Numb
     C                     KFLD           WQSE02           DSH Kill Date
     C                     KFLD           WQSE03           DT Delivery Dat
     C                     KFLD           WQSE04           DT Delivery Tim
     C                     KFLD           WQSE05           DT Delivery Tim
      * Setup key
     C                     Z-ADD#1HONB    WQSE01           CC Company Numb
     C                     Z-ADD#1E0DT    WQSE02           DSH Kill Date
     C                     Z-ADD#1E9DT    WQSE03           DT Delivery Dat
     C                     Z-ADD#1AJTH    WQSE04           DT Delivery Tim
     C                     Z-ADD#1H4A1    WQSE05           DT Delivery Tim
      * Establish starting position
     C           KRSSE     SETLL@AJCPIY                    *
     C           KRSSE     READE@AJCPIY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1038' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUIHA1           DT Delivered He
     C                     Z-ADD*ZERO     WUH3NB           Weight Tot USR
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           AJAJST    IFEQ 'A'                        *IF
     C                     ADD  AJIHA1    WUIHA1           DT Delivered He
     C                     ADD  AJUNA1    WUH3NB           Weight Tot USR
     C                     END                             *FI
     C           KRSSE     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFINFN    BEGSR
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      *================================================================
      * Val Time hhmm NegNALL IF
     C                     MOVEL'N'       WL0002           Status 2
     C                     MOVEL'N'       WL0003           Status 5 Usr
      * Military
      * CASE: PAR.Time USR NE WRK.Zero USR
     C           WL0001    IFNE WUE9NB                     *IF
     C                     Z-ADDWL0001    WUTMMM           Time MM USR
     C           WL0001    DIV  100       WUTMHH           Time HH USR
      * CASE:
      *  - c1ORc2
      *   |- c1    : WRK.Time MM USR is gt 59
      *   |- c2    : WRK.Time HH USR is GT 24
      *   '-
     C           WUTMMM    IFGT 59                         *IF
     C           WUTMHH    ORGT 24                         *OR
     C                     MOVEL'Y'       WL0002           Status 2
     C                     END                             *FI
     C                     END                             *FI
      * Negative not allowed
      * CASE: PAR.Time USR LT WRK.Zero USR
     C           WL0001    IFLT WUE9NB                     *IF
     C                     MOVEL'Y'       WL0003           Status 5 Usr
     C                     END                             *FI
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Delivery Tracking CR - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AFCPIC
     C                     Z-ADD#1HONB    AFHONB           CC Company Numb
     C                     Z-ADD#1E0DT    AFE0DT           DSH Kill Date
     C                     Z-ADD#1E9DT    AFE9DT           DT Delivery Dat
     C                     Z-ADD#1AJTH    AFAJTH           DT Delivery Tim
     C                     Z-ADD#1H4A1    AFH4A1           DT Delivery Tim
     C                     Z-ADD#1FXDT    AFFXDT           DT Actual Kill
     C                     Z-ADD#1JIA1    AFJIA1           DT Actual Deliv
     C                     Z-ADD#1IBA1    AFIBA1           DT Scheduled Ho
     C                     MOVEL#1W5ST    AFW5ST           DT Delivery Ini
     C                     Z-ADD#1ICA1    AFICA1           DT Farm Site Co
     C                     MOVEL#1K0CD    AFK0CD           DT Building
     C                     MOVEL#1K1CD    AFK1CD           DT Room
     C                     MOVEL#1LFCD    AFLFCD           DT Sire Line Co
     C                     MOVEL#1LGCD    AFLGCD           DT Hog Group Re
     C                     Z-ADD#1IDA1    AFIDA1           DT Delivered He
     C                     Z-ADD#1IPA1    AFIPA1           DT Delivered We
     C                     MOVEL#1LICD    AFLICD           DT Trucker Code
     C                     MOVEL#1J8CD    AFJ8CD           DT Driver
     C                     MOVEL#1J9CD    AFJ9CD           DT Loading Crew
     C                     MOVEL#1MGCD    AFMGCD           CHR Code
     C                     MOVEL#1XHST    AFXHST           DT Load Type
     C                     MOVEL#1XIST    AFXIST           DT Full/Split L
     C                     Z-ADD#1IEA1    AFIEA1           DT Movement Num
     C                     MOVEL#1KBCD    AFKBCD           DT Truck ID
     C                     MOVEL#1KZCD    AFKZCD           DT Trailer ID
     C                     MOVEL#1LHCD    AFLHCD           DT Transportati
     C                     Z-ADD#1FADT    AFFADT           DT Transprtn Of
     C                     Z-ADD#1AKTH    AFAKTH           DT Transprtn Of
     C                     Z-ADD#1BYTH    AFBYTH           DT Arrive@Frm v
     C                     MOVEL#1W6ST    AFW6ST           DT On-Time Farm
     C                     MOVEL#1XXST    AFXXST           DT Route Start
     C                     Z-ADD#1FBDT    AFFBDT           DT Route Start
     C                     Z-ADD#1ALTH    AFALTH           DT Route Start
     C                     Z-ADD#1BVTH    AFBVTH           DT Route Start
     C                     Z-ADD#1AMTH    AFAMTH           DT Wait @ Trans
     C                     Z-ADD#1FCDT    AFFCDT           DT Arrive @ Far
     C                     Z-ADD#1ANTH    AFANTH           DT Arrive @ Far
     C                     Z-ADD#1BHTH    AFBHTH           DT Drive Time T
     C                     Z-ADD#1FDDT    AFFDDT           DT Start Loadin
     C                     Z-ADD#1AOTH    AFAOTH           DT Start Loadin
     C                     Z-ADD#1BWTH    AFBWTH           DT Start Loadin
     C                     Z-ADD#1APTH    AFAPTH           DT Wait @ Farm
     C                     Z-ADD#1FEDT    AFFEDT           DT Frm End Load
     C                     Z-ADD#1AQTH    AFAQTH           DT Frm End Load
     C                     Z-ADD#1ARTH    AFARTH           DT Load Time
     C                     Z-ADD#1FFDT    AFFFDT           DT Leave Farm D
     C                     Z-ADD#1ASTH    AFASTH           DT Leave Farm T
     C                     Z-ADD#1ATTH    AFATTH           DT Wait-Depart
     C                     Z-ADD#1FGDT    AFFGDT           DT Plt TrkWsh A
     C                     Z-ADD#1AUTH    AFAUTH           DT Plt TrkWsh A
     C                     Z-ADD#1FHDT    AFFHDT           DT Arrive @ Pla
     C                     Z-ADD#1AVTH    AFAVTH           DT Arrive @ Pla
     C                     Z-ADD#1AWTH    AFAWTH           DT Wait @ TrkWs
     C                     Z-ADD#1BKTH    AFBKTH           DT Drive Time T
     C                     Z-ADD#1BLTH    AFBLTH           DT Delv Time Va
     C                     MOVEL#1XJST    AFXJST           DT On Time Deli
     C                     MOVEL#1K3CD    AFK3CD           Delivery Reason
     C                     Z-ADD#1FIDT    AFFIDT           DT TrkScl Weigh
     C                     Z-ADD#1AXTH    AFAXTH           DT TrkScl Weigh
     C                     Z-ADD#1AYTH    AFAYTH           DT Wait @ TrkSc
     C                     Z-ADD#1FJDT    AFFJDT           DT To Recv Dock
     C                     Z-ADD#1AZTH    AFAZTH           DT To Recv Dock
     C                     Z-ADD#1A0TH    AFA0TH           DT Wait-Rcv Doc
     C                     Z-ADD#1FKDT    AFFKDT           DT Start Unload
     C                     Z-ADD#1A1TH    AFA1TH           DT Start Unload
     C                     Z-ADD#1A2TH    AFA2TH           DT Wait @ Rcv D
     C                     Z-ADD#1FLDT    AFFLDT           DT End Unload D
     C                     Z-ADD#1A3TH    AFA3TH           DT End Unload T
     C                     Z-ADD#1A4TH    AFA4TH           DT Unload Time
     C                     Z-ADD#1BTTH    AFBTTH           DT Unload Varia
     C                     Z-ADD#1FMDT    AFFMDT           DT TrkScl Weigh
     C                     Z-ADD#1A5TH    AFA5TH           DT TrkScl Weigh
     C                     Z-ADD#1A6TH    AFA6TH           DT Wait Time @
     C                     Z-ADD#1BXTH    AFBXTH           DT Formula Wait
     C                     MOVEL#1XKST    AFXKST           DT Source Type
     C                     MOVEL#1YDST    AFYDST           DT GATE UPDATE
     C                     Z-ADD#1FYDT    AFFYDT           DT Unused Date
     C                     Z-ADD#1B0TH    AFB0TH           DT Unused Time
     C                     Z-ADD#1BZTH    AFBZTH           DT Unused Wait
     C                     Z-ADD#1H2A1    AFH2A1           DSD Scheduled D
     C                     Z-ADD#1J2A1    AFJ2A1           DT Head Receive
     C                     Z-ADD#1J3A1    AFJ3A1           DT Weight Recei
     C                     Z-ADD#1KMA1    AFKMA1           DT Avg Weight R
     C                     Z-ADD#1J4A1    AFJ4A1           DT Head DOA
     C                     Z-ADD#1J5A1    AFJ5A1           DT Weight DOA
     C                     Z-ADD#1J6A1    AFJ6A1           DT Head Yard De
     C                     Z-ADD#1J7A1    AFJ7A1           DT Weight Yard
     C                     Z-ADD#1J8A1    AFJ8A1           DT Head Condemn
     C                     Z-ADD#1J9A1    AFJ9A1           DT Weight Conde
     C                     Z-ADD#1KAA1    AFKAA1           DT Head Held Ov
     C                     Z-ADD#1KBA1    AFKBA1           DT Weight Held
     C                     Z-ADD#1KCA1    AFKCA1           DT Head Killed
     C                     Z-ADD#1KDA1    AFKDA1           DT Weight Kille
     C                     Z-ADD#1KEA1    AFKEA1           DT Head Market
     C                     Z-ADD#1KFA1    AFKFA1           DT Weight Marke
     C                     Z-ADD#1KNA1    AFKNA1           DT Avg Weight M
     C                     Z-ADD#1KGA1    AFKGA1           DT Head Resale
     C                     Z-ADD#1KHA1    AFKHA1           DT Weight Resal
     C                     Z-ADD#1KOA1    AFKOA1           DT Avg Weight R
     C                     Z-ADD#1KIA1    AFKIA1           DT Head Unused
     C                     Z-ADD#1KJA1    AFKJA1           DT Weight Unuse
     C                     Z-ADD#1KKA1    AFKKA1           DT Head Unused
     C                     Z-ADD#1KLA1    AFKLA1           DT Weight Unuse
     C                     MOVEL#1YNST    AFYNST           DT Error Sts
     C                     MOVEL#1YOST    AFYOST           DT Error Reason
     C                     MOVEL#1ABCD    AFABCD           PD Producer Cod
     C                     MOVEL#1AECD    AFAECD           PL Location Cod
     C                     MOVEL#1AACD    AFAACD           SR Source Code
     C                     Z-ADD#1HMNB    AFHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AFBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    AFBONB           BOL Load Number
     C                     MOVEL#1AAVN    AFAAVN           RS User Changed
     C                     Z-ADD#1AADT    AFAADT           RS Date Changed
     C                     Z-ADD#1AMTM    AFAMTM           RS Time Changed
     C                     MOVEL'A'       AFAJST           RS Record Statu
     C                     MOVEL#1AHVN    AFAHVN           RS Job
     C                     MOVEL#1AGVN    AFAGVN           RS Program
     C                     MOVEL#1ABVN    AFABVN           RS User Added
     C                     Z-ADD#1ABDT    AFABDT           RS Date Added
     C                     Z-ADD#1ABTM    AFABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       AFAJST           RS Record Statu
     C                     MOVEL##USR     AFABVN           RS User Added
     C                     Z-ADD##JDT     AFABDT           RS Date Added
     C                     Z-ADD##JTM     AFABTM           RS Time Added
     C                     MOVEL##PGM     AFAGVN           RS Program
     C                     MOVEL##JOB     AFAHVN           RS Job
     C           KLCRSG    KLIST
     C                     KFLD           AFHONB           CC Company Numb
     C                     KFLD           AFE0DT           DSH Kill Date
     C                     KFLD           AFE9DT           DT Delivery Dat
     C                     KFLD           AFAJTH           DT Delivery Tim
     C                     KFLD           AFH4A1           DT Delivery Tim
      * Check for duplicate primary key
     C           KLCRSG    SETLL@AFCPIC                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1031' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@AFCPIC                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Upd Farm, Movement    RT - Tattoo Header  * 
     C                     EXSR SHRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd Farm, Movement    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSH03           BOL Load Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
      * Setup key
     C                     Z-ADDAFHMNB    WQSH01           BOH Company Num
     C                     Z-ADDAFBNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDAFBONB    WQSH03           BOL Load Number
      * Establish starting position
     C           KRSSH     SETLL@A1CPC4                    *
     C           KRSSH     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH HPS Farm Site NE PAR.TH HPS Farm Site
     C           A1THHD    IFNE #1ICA1                     *IF
      * CASE: DB1.TH Source Type is Internal
     C           A1KAST    IFEQ 'I'                        *IF
      * Due to test with e2423 SAW that we were change the
      * movement and farm site and not the state code
      * use this retrieve regardless of Not Live Or Live with MTech
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0112  7        *Return code
     C                     PARM *BLANK    WQ0113 25        Farm site Name
     C                     PARM #1ICA1    WQ0114  50       Farm Site USR
     C                     PARM *BLANK    WQ0115  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0116  3        State
     C                     PARM *BLANK    WQ0117 25        HPS Farm County
     C                     PARM *BLANK    WQ0118  5        HPS Cell Manage
     C                     PARM *BLANK    WQ0119 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0120 20        MTech Farm Site
     C                     PARM *BLANK    WQ0121 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
      * Chg Farm, Movement    CH - Tattoo Header  * 
     C                     EXSR SICHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Farm, Movement    CH - Tattoo Header  * 
     C                     EXSR SJCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Farm, Movement    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0006  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0008  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0009  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0010  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0013  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0014  50       TH Held Over
     C                     Z-ADD*ZERO     WN0015  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0016  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0017  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0018  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0019  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0020  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0033  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0035  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0036  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0045  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0046  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0047  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0048  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0049  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0050  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0052  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0056  1        TH Header Error
     C                     MOVEL*BLANK    WN0057  1        TH Detail Error
     C                     MOVEL*BLANK    WN0058  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0059  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0060  80       TH Commission A
     C                     Z-ADD*ZERO     WN0061  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0062  1        TH User Error O
     C                     MOVEL*BLANK    WN0063  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0064  1        TH Sex
     C                     Z-ADD*ZERO     WN0065  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0066  70       TH Commission P
     C                     Z-ADD*ZERO     WN0067  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0068  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0069  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0070  31       TH FFLI
     C                     Z-ADD*ZERO     WN0071  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0072  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0073  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0074  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0075  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0076  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0077  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0078  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0079  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0080  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0081  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0082  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0083  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0084  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0085  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0086  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0087  1        TH Source Type
     C                     MOVEL*BLANK    WN0088  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0089  1        TH Payment Type
     C                     MOVEL*BLANK    WN0090  3        TH Source Code
     C                     MOVEL*BLANK    WN0091  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0092  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0093  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0094  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0095  3        TH Unused Code
     C                     MOVEL*BLANK    WN0096  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0097  1        TH Commission S
     C                     MOVEL*BLANK    WN0098  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0099  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0100  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0101  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0102  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0103  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0104  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0105  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0106  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0107  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0108  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0109  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0110  3        TH PHA Average
     C                     MOVEL*BLANK    WN0111  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0112  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0113  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0114  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0115  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0116  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0117  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0118  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0119  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0120  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0121  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0122  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0123  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0124 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0125 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0126 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0127 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0128  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0129  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0130  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0131  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0132  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0133  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0134  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0135  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0136  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0137  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0138  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0139  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0140  70       TH Unused Date
     C                     MOVEL*BLANK    WN0141  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0142  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0143  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0144  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0145  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0146  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0147  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0148  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0149  6        DF Defect Code
     C                     MOVEL*BLANK    WN0150  6        THP Process Cod
     C                     MOVEL*BLANK    WN0151  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0152  6        PL Location Cod
     C                     MOVEL*BLANK    WN0153  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0154  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0155  3        HC Class Code
     C                     MOVEL*BLANK    WN0156 10        RS User Changed
     C                     Z-ADD*ZERO     WN0157  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0158  60       RS Time Changed
     C                     MOVEL*BLANK    WN0159  1        RS Record Statu
     C                     MOVEL*BLANK    WN0160 10        RS Job
     C                     MOVEL*BLANK    WN0161 10        RS Program
     C                     MOVEL*BLANK    WN0162 10        RS User Added
     C                     Z-ADD*ZERO     WN0163  70       RS Date Added
     C                     Z-ADD*ZERO     WN0164  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDA1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WBBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    WBB0DT           TH Kill Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHSI    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#1IEA1    WBOXNB           TH HPS Movement
     C                     MOVELWUDRTX    WBNZTX    P      TH State
     C                     Z-ADD#1ICA1    WBTHHD           TH HPS Farm Sit
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Farm, Movement    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0165  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0166 10        TH Group Refere
     C                     MOVEL*BLANK    WN0167  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0168  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0169  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0170  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0171  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0172  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0173  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0174  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0175  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0176  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0177  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0178  50       TH Held Over
     C                     Z-ADD*ZERO     WN0179  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0180  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0181  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0182  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0183  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0184  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0185  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0186  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0187  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0188  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0189  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0190  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0191  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0192  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0193  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0194  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0195  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0196  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0197  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0198  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0199  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0200  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0201  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0202  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0203  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0204  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0205  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0206  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0207  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0208  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0209  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0210  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0211  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0212  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0213  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0214  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0215  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0216  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0217  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0218  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0219  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0220  1        TH Header Error
     C                     MOVEL*BLANK    WN0221  1        TH Detail Error
     C                     MOVEL*BLANK    WN0222  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0223  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0224  80       TH Commission A
     C                     Z-ADD*ZERO     WN0225  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0226  1        TH User Error O
     C                     MOVEL*BLANK    WN0227  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0228  1        TH Sex
     C                     Z-ADD*ZERO     WN0229  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0230  70       TH Commission P
     C                     Z-ADD*ZERO     WN0231  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0232  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0233  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0234  31       TH FFLI
     C                     Z-ADD*ZERO     WN0235  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0236  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0237  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0238  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0239  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0240  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0241  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0242  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0243  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0244  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0245  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0246  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0247  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0248  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0249  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0250  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0251  1        TH Source Type
     C                     MOVEL*BLANK    WN0252  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0253  1        TH Payment Type
     C                     MOVEL*BLANK    WN0254  3        TH Source Code
     C                     MOVEL*BLANK    WN0255  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0256  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0257  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0258  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0259  3        TH Unused Code
     C                     MOVEL*BLANK    WN0260  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0261  1        TH Commission S
     C                     MOVEL*BLANK    WN0262  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0263  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0264  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0265  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0266  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0267  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0268  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0269  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0270  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0271  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0272  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0273  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0274  3        TH PHA Average
     C                     MOVEL*BLANK    WN0275  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0276  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0277  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0278  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0279  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0280  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0281  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0282  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0283  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0284  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0285  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0286  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0287  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0288 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0289 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0290 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0291 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0292  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0293  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0294  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0295  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0296  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0297  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0298  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0299  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0300  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0301  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0302  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0303  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0304  70       TH Unused Date
     C                     MOVEL*BLANK    WN0305  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0306  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0307  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0308  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0309  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0310  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0311  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0312  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0313  6        DF Defect Code
     C                     MOVEL*BLANK    WN0314  6        THP Process Cod
     C                     MOVEL*BLANK    WN0315  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0316  6        PL Location Cod
     C                     MOVEL*BLANK    WN0317  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0318  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0319  3        HC Class Code
     C                     MOVEL*BLANK    WN0320 10        RS User Changed
     C                     Z-ADD*ZERO     WN0321  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0322  60       RS Time Changed
     C                     MOVEL*BLANK    WN0323  1        RS Record Statu
     C                     MOVEL*BLANK    WN0324 10        RS Job
     C                     MOVEL*BLANK    WN0325 10        RS Program
     C                     MOVEL*BLANK    WN0326 10        RS User Added
     C                     Z-ADD*ZERO     WN0327  70       RS Date Added
     C                     Z-ADD*ZERO     WN0328  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDA1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WBBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    WBB0DT           TH Kill Date
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHSJ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#1IEA1    WBOXNB           TH HPS Movement
     C                     MOVELA1NZTX    WBNZTX    P      TH State
     C                     Z-ADD#1ICA1    WBTHHD           TH HPS Farm Sit
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv DSH Status        RT - Delivery Sched Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           ADHONB           CC Company Numb
     C                     KFLD           ADE0DT           DSH Kill Date
      * Setup key
     C                     Z-ADD#1HONB    ADHONB           CC Company Numb
     C                     Z-ADD#1E0DT    ADE0DT           DSH Kill Date
      * Establish starting position
     C           KRSSK     CHAIN@ADCPID              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1026' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0014           DSH Status
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWXST    YL0014           DSH Status
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Delivery Tracking CH - Delivery Tracking  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0329  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN0330  50       DT Head Receive
     C                     Z-ADD*ZERO     WN0331  71       DT Weight Recei
     C                     Z-ADD*ZERO     WN0332  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0333  50       DT Head DOA
     C                     Z-ADD*ZERO     WN0334  71       DT Weight DOA
     C                     Z-ADD*ZERO     WN0335  50       DT Head Yard De
     C                     Z-ADD*ZERO     WN0336  71       DT Weight Yard
     C                     Z-ADD*ZERO     WN0337  50       DT Head Condemn
     C                     Z-ADD*ZERO     WN0338  71       DT Weight Conde
     C                     Z-ADD*ZERO     WN0339  50       DT Head Held Ov
     C                     Z-ADD*ZERO     WN0340  71       DT Weight Held
     C                     Z-ADD*ZERO     WN0341  50       DT Head Killed
     C                     Z-ADD*ZERO     WN0342  71       DT Weight Kille
     C                     Z-ADD*ZERO     WN0343  50       DT Head Market
     C                     Z-ADD*ZERO     WN0344  71       DT Weight Marke
     C                     Z-ADD*ZERO     WN0345  51       DT Avg Weight M
     C                     Z-ADD*ZERO     WN0346  50       DT Head Resale
     C                     Z-ADD*ZERO     WN0347  71       DT Weight Resal
     C                     Z-ADD*ZERO     WN0348  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0349  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0350  71       DT Weight Unuse
     C                     Z-ADD*ZERO     WN0351  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0352  71       DT Weight Unuse
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AFCPIC
     C                     Z-ADD#1HONB    AFHONB           CC Company Numb
     C                     Z-ADD#1E0DT    AFE0DT           DSH Kill Date
     C                     Z-ADD#1E9DT    AFE9DT           DT Delivery Dat
     C                     Z-ADD#1AJTH    AFAJTH           DT Delivery Tim
     C                     Z-ADD#1H4A1    AFH4A1           DT Delivery Tim
      *
     C           KLCHSL    KLIST
     C                     KFLD           AFHONB           CC Company Numb
     C                     KFLD           AFE0DT           DSH Kill Date
     C                     KFLD           AFE9DT           DT Delivery Dat
     C                     KFLD           AFAJTH           DT Delivery Tim
     C                     KFLD           AFH4A1           DT Delivery Tim
     C           KLCHSL    CHAIN@AFCPIC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAFCPL0'MDACP
     C                     MOVEL'@AFCPIC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @AFCPIC
     C                     Z-ADD#1FXDT    AFFXDT           DT Actual Kill
     C                     Z-ADDYL0015    AFJIA1           DT Actual Deliv
     C                     Z-ADD#1IBA1    AFIBA1           DT Scheduled Ho
     C                     MOVEL#1W5ST    AFW5ST    P      DT Delivery Ini
     C                     Z-ADD#1ICA1    AFICA1           DT Farm Site Co
     C                     MOVEL#1K0CD    AFK0CD    P      DT Building
     C                     MOVEL#1K1CD    AFK1CD    P      DT Room
     C                     MOVEL#1LFCD    AFLFCD    P      DT Sire Line Co
     C                     MOVEL#1LGCD    AFLGCD    P      DT Hog Group Re
     C                     Z-ADD#1IDA1    AFIDA1           DT Delivered He
     C                     Z-ADD#1IPA1    AFIPA1           DT Delivered We
     C                     MOVEL#1LICD    AFLICD    P      DT Trucker Code
     C                     MOVEL#1J8CD    AFJ8CD    P      DT Driver
     C                     MOVEL#1J9CD    AFJ9CD    P      DT Loading Crew
     C                     MOVEL#1MGCD    AFMGCD    P      CHR Code
     C                     MOVEL#1XHST    AFXHST    P      DT Load Type
     C                     MOVEL#1XIST    AFXIST    P      DT Full/Split L
     C                     Z-ADD#1IEA1    AFIEA1           DT Movement Num
     C                     MOVEL#1KBCD    AFKBCD    P      DT Truck ID
     C                     MOVEL#1KZCD    AFKZCD    P      DT Trailer ID
     C                     MOVEL#1LHCD    AFLHCD    P      DT Transportati
     C                     Z-ADD#1FADT    AFFADT           DT Transprtn Of
     C                     Z-ADD#1AKTH    AFAKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     AFBYTH           DT Arrive@Frm v
     C                     MOVEL#1W6ST    AFW6ST    P      DT On-Time Farm
     C                     MOVEL#1XXST    AFXXST    P      DT Route Start
     C                     Z-ADD#1FBDT    AFFBDT           DT Route Start
     C                     Z-ADD#1ALTH    AFALTH           DT Route Start
     C                     Z-ADD*ZERO     AFBVTH           DT Route Start
     C                     Z-ADD#1AMTH    AFAMTH           DT Wait @ Trans
     C                     Z-ADD#1FCDT    AFFCDT           DT Arrive @ Far
     C                     Z-ADD#1ANTH    AFANTH           DT Arrive @ Far
     C                     Z-ADD#1BHTH    AFBHTH           DT Drive Time T
     C                     Z-ADD#1FDDT    AFFDDT           DT Start Loadin
     C                     Z-ADD#1AOTH    AFAOTH           DT Start Loadin
     C                     Z-ADD*ZERO     AFBWTH           DT Start Loadin
     C                     Z-ADD#1APTH    AFAPTH           DT Wait @ Farm
     C                     Z-ADD#1FEDT    AFFEDT           DT Frm End Load
     C                     Z-ADD#1AQTH    AFAQTH           DT Frm End Load
     C                     Z-ADD#1ARTH    AFARTH           DT Load Time
     C                     Z-ADD#1FFDT    AFFFDT           DT Leave Farm D
     C                     Z-ADD#1ASTH    AFASTH           DT Leave Farm T
     C                     Z-ADD#1ATTH    AFATTH           DT Wait-Depart
     C                     Z-ADD#1FGDT    AFFGDT           DT Plt TrkWsh A
     C                     Z-ADD#1AUTH    AFAUTH           DT Plt TrkWsh A
     C                     Z-ADD#1FHDT    AFFHDT           DT Arrive @ Pla
     C                     Z-ADD#1AVTH    AFAVTH           DT Arrive @ Pla
     C                     Z-ADD#1AWTH    AFAWTH           DT Wait @ TrkWs
     C                     Z-ADD#1BKTH    AFBKTH           DT Drive Time T
     C                     Z-ADD#1BLTH    AFBLTH           DT Delv Time Va
     C                     MOVEL#1XJST    AFXJST    P      DT On Time Deli
     C                     MOVEL#1K3CD    AFK3CD    P      Delivery Reason
     C                     Z-ADD#1FIDT    AFFIDT           DT TrkScl Weigh
     C                     Z-ADD#1AXTH    AFAXTH           DT TrkScl Weigh
     C                     Z-ADD#1AYTH    AFAYTH           DT Wait @ TrkSc
     C                     Z-ADD#1FJDT    AFFJDT           DT To Recv Dock
     C                     Z-ADD#1AZTH    AFAZTH           DT To Recv Dock
     C                     Z-ADD#1A0TH    AFA0TH           DT Wait-Rcv Doc
     C                     Z-ADD#1FKDT    AFFKDT           DT Start Unload
     C                     Z-ADD#1A1TH    AFA1TH           DT Start Unload
     C                     Z-ADD#1A2TH    AFA2TH           DT Wait @ Rcv D
     C                     Z-ADD#1FLDT    AFFLDT           DT End Unload D
     C                     Z-ADD#1A3TH    AFA3TH           DT End Unload T
     C                     Z-ADD#1A4TH    AFA4TH           DT Unload Time
     C                     Z-ADD#1BTTH    AFBTTH           DT Unload Varia
     C                     Z-ADD#1FMDT    AFFMDT           DT TrkScl Weigh
     C                     Z-ADD#1A5TH    AFA5TH           DT TrkScl Weigh
     C                     Z-ADD#1A6TH    AFA6TH           DT Wait Time @
     C                     Z-ADD*ZERO     AFBXTH           DT Formula Wait
     C                     MOVEL#1XKST    AFXKST    P      DT Source Type
     C                     MOVEL#1YDST    AFYDST    P      DT GATE UPDATE
     C                     Z-ADD#1FYDT    AFFYDT           DT Unused Date
     C                     Z-ADD#1B0TH    AFB0TH           DT Unused Time
     C                     Z-ADD#1BZTH    AFBZTH           DT Unused Wait
     C                     MOVEL#1YNST    AFYNST    P      DT Error Sts
     C                     MOVEL#1YOST    AFYOST    P      DT Error Reason
     C                     MOVEL#1ABCD    AFABCD    P      PD Producer Cod
     C                     MOVEL#1AECD    AFAECD    P      PL Location Cod
     C                     MOVEL#1AACD    AFAACD    P      SR Source Code
     C                     Z-ADD#1HMNB    AFHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AFBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    AFBONB           BOL Load Number
     C                     MOVEL#1AAVN    AFAAVN    P      RS User Changed
     C                     Z-ADD#1AADT    AFAADT           RS Date Changed
     C                     Z-ADD#1AMTM    AFAMTM           RS Time Changed
     C                     MOVEL#1AJST    AFAJST    P      RS Record Statu
     C                     MOVEL#1AHVN    AFAHVN    P      RS Job
     C                     MOVEL#1AGVN    AFAGVN    P      RS Program
     C                     MOVEL#1ABVN    AFABVN    P      RS User Added
     C                     Z-ADD#1ABDT    AFABDT           RS Date Added
     C                     Z-ADD#1ABTM    AFABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     AFAAVN           RS User Changed
     C                     Z-ADD##JDT     AFAADT           RS Date Changed
     C                     Z-ADD##JTM     AFAMTM           RS Time Changed
     C                     MOVEL##JOB     AFAHVN           RS Job
     C                     MOVEL##PGM     AFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AFCPIC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Upd Farm, Movement    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSM02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSM03           BOL Load Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           BOH Buy Order N
     C                     KFLD           WQSM03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSM01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSM02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSM03           BOL Load Number
      * Establish starting position
     C           KRSSM     SETLL@A1CPC4                    *
     C           KRSSM     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH HPS Farm Site NE PAR.TH HPS Farm Site
     C           A1THHD    IFNE YL0016                     *IF
      * CASE: DB1.TH Source Type is Internal
     C           A1KAST    IFEQ 'I'                        *IF
      * Due to test with e2423 SAW that we were change the
      * movement and farm site and not the state code
      * use this retrieve regardless of Not Live Or Live with MTech
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0141  7        *Return code
     C                     PARM *BLANK    WQ0142 25        Farm site Name
     C                     PARM YL0016    WQ0143  50       Farm Site USR
     C                     PARM *BLANK    WQ0144  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0145  3        State
     C                     PARM *BLANK    WQ0146 25        HPS Farm County
     C                     PARM *BLANK    WQ0147  5        HPS Cell Manage
     C                     PARM *BLANK    WQ0148 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0149 20        MTech Farm Site
     C                     PARM *BLANK    WQ0150 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Chg Farm, Movement    CH - Tattoo Header  * 
     C                     EXSR SNCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Farm, Movement    CH - Tattoo Header  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Farm, Movement    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0353  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0354 10        TH Group Refere
     C                     MOVEL*BLANK    WN0355  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0356  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0357  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0358  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0359  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0360  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0361  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0362  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0363  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0364  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0365  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0366  50       TH Held Over
     C                     Z-ADD*ZERO     WN0367  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0368  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0369  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0370  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0371  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0372  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0373  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0374  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0375  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0376  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0377  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0378  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0379  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0380  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0381  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0382  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0383  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0384  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0385  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0386  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0387  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0388  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0389  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0390  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0391  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0392  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0393  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0394  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0395  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0396  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0397  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0398  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0399  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0400  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0401  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0402  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0403  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0404  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0405  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0406  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0407  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0408  1        TH Header Error
     C                     MOVEL*BLANK    WN0409  1        TH Detail Error
     C                     MOVEL*BLANK    WN0410  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0411  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0412  80       TH Commission A
     C                     Z-ADD*ZERO     WN0413  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0414  1        TH User Error O
     C                     MOVEL*BLANK    WN0415  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0416  1        TH Sex
     C                     Z-ADD*ZERO     WN0417  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0418  70       TH Commission P
     C                     Z-ADD*ZERO     WN0419  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0420  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0421  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0422  31       TH FFLI
     C                     Z-ADD*ZERO     WN0423  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0424  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0425  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0426  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0427  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0428  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0429  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0430  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0431  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0432  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0433  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0434  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0435  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0436  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0437  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0438  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0439  1        TH Source Type
     C                     MOVEL*BLANK    WN0440  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0441  1        TH Payment Type
     C                     MOVEL*BLANK    WN0442  3        TH Source Code
     C                     MOVEL*BLANK    WN0443  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0444  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0445  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0446  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0447  3        TH Unused Code
     C                     MOVEL*BLANK    WN0448  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0449  1        TH Commission S
     C                     MOVEL*BLANK    WN0450  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0451  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0452  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0453  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0454  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0455  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0456  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0457  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0458  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0459  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0460  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0461  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0462  3        TH PHA Average
     C                     MOVEL*BLANK    WN0463  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0464  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0465  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0466  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0467  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0468  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0469  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0470  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0471  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0472  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0473  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0474  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0475  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0476 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0477 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0478 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0479 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0480  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0481  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0482  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0483  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0484  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0485  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0486  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0487  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0488  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0489  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0490  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0491  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0492  70       TH Unused Date
     C                     MOVEL*BLANK    WN0493  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0494  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0495  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0496  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0497  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0498  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0499  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0500  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0501  6        DF Defect Code
     C                     MOVEL*BLANK    WN0502  6        THP Process Cod
     C                     MOVEL*BLANK    WN0503  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0504  6        PL Location Cod
     C                     MOVEL*BLANK    WN0505  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0506  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0507  3        HC Class Code
     C                     MOVEL*BLANK    WN0508 10        RS User Changed
     C                     Z-ADD*ZERO     WN0509  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0510  60       RS Time Changed
     C                     MOVEL*BLANK    WN0511  1        RS Record Statu
     C                     MOVEL*BLANK    WN0512 10        RS Job
     C                     MOVEL*BLANK    WN0513 10        RS Program
     C                     MOVEL*BLANK    WN0514 10        RS User Added
     C                     Z-ADD*ZERO     WN0515  70       RS Date Added
     C                     Z-ADD*ZERO     WN0516  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDA1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WBBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    WBB0DT           TH Kill Date
      *
     C           KLCHSN    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHSN    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#1IEA1    WBOXNB           TH HPS Movement
     C                     MOVELWUDRTX    WBNZTX    P      TH State
     C                     Z-ADDYL0016    WBTHHD           TH HPS Farm Sit
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Farm, Movement    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0517  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0518 10        TH Group Refere
     C                     MOVEL*BLANK    WN0519  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0520  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0521  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0522  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0523  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0524  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0525  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0526  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0527  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0528  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0529  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0530  50       TH Held Over
     C                     Z-ADD*ZERO     WN0531  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0532  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0533  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0534  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0535  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0536  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0537  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0538  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0539  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0540  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0541  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0542  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0543  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0544  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0545  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0546  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0547  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0548  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0549  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0550  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0551  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0552  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0553  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0554  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0555  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0556  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0557  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0558  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0559  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0560  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0561  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0562  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0563  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0564  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0565  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0566  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0567  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0568  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0569  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0570  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0571  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0572  1        TH Header Error
     C                     MOVEL*BLANK    WN0573  1        TH Detail Error
     C                     MOVEL*BLANK    WN0574  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0575  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0576  80       TH Commission A
     C                     Z-ADD*ZERO     WN0577  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0578  1        TH User Error O
     C                     MOVEL*BLANK    WN0579  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0580  1        TH Sex
     C                     Z-ADD*ZERO     WN0581  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0582  70       TH Commission P
     C                     Z-ADD*ZERO     WN0583  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0584  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0585  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0586  31       TH FFLI
     C                     Z-ADD*ZERO     WN0587  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0588  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0589  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0590  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0591  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0592  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0593  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0594  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0595  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0596  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0597  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0598  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0599  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0600  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0601  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0602  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0603  1        TH Source Type
     C                     MOVEL*BLANK    WN0604  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0605  1        TH Payment Type
     C                     MOVEL*BLANK    WN0606  3        TH Source Code
     C                     MOVEL*BLANK    WN0607  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0608  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0609  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0610  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0611  3        TH Unused Code
     C                     MOVEL*BLANK    WN0612  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0613  1        TH Commission S
     C                     MOVEL*BLANK    WN0614  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0615  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0616  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0617  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0618  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0619  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0620  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0621  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0622  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0623  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0624  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0625  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0626  3        TH PHA Average
     C                     MOVEL*BLANK    WN0627  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0628  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0629  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0630  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0631  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0632  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0633  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0634  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0635  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0636  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0637  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0638  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0639  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0640 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0641 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0642 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0643 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0644  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0645  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0646  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0647  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0648  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0649  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0650  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0651  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0652  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0653  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0654  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0655  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0656  70       TH Unused Date
     C                     MOVEL*BLANK    WN0657  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0658  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0659  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0660  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0661  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0662  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0663  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0664  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0665  6        DF Defect Code
     C                     MOVEL*BLANK    WN0666  6        THP Process Cod
     C                     MOVEL*BLANK    WN0667  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0668  6        PL Location Cod
     C                     MOVEL*BLANK    WN0669  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0670  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0671  3        HC Class Code
     C                     MOVEL*BLANK    WN0672 10        RS User Changed
     C                     Z-ADD*ZERO     WN0673  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0674  60       RS Time Changed
     C                     MOVEL*BLANK    WN0675  1        RS Record Statu
     C                     MOVEL*BLANK    WN0676 10        RS Job
     C                     MOVEL*BLANK    WN0677 10        RS Program
     C                     MOVEL*BLANK    WN0678 10        RS User Added
     C                     Z-ADD*ZERO     WN0679  70       RS Date Added
     C                     Z-ADD*ZERO     WN0680  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDA1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WBBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    WBB0DT           TH Kill Date
      *
     C           KLCHSO    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHSO    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#1IEA1    WBOXNB           TH HPS Movement
     C                     MOVELA1NZTX    WBNZTX    P      TH State
     C                     Z-ADDYL0016    WBTHHD           TH HPS Farm Sit
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Upd Movement #        RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSP02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSP03           BOL Load Number
     C           *LIKE     DEFN WCE0DT    WQSP04           DSH Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           BOH Buy Order N
     C                     KFLD           WQSP03           BOL Load Number
     C                     KFLD           WQSP04           DSH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSP01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSP02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSP03           BOL Load Number
     C                     Z-ADD#1E0DT    WQSP04           DSH Kill Date
      * Establish starting position
     C           KRSSP     SETLL@AFCPI4                    *
     C           KRSSP     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Movement #        CH - Delivery Tracking  * 
     C                     EXSR SQCHRC
     C           KRSSP     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Movement #        CH - Delivery Tracking  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0681  70       DT Actual Kill
     C                     Z-ADD*ZERO     WN0682  20       DT Actual Deliv
     C                     Z-ADD*ZERO     WN0683  20       DT Scheduled Ho
     C                     MOVEL*BLANK    WN0684  1        DT Delivery Ini
     C                     Z-ADD*ZERO     WN0685  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0686  5        DT Building
     C                     MOVEL*BLANK    WN0687  5        DT Room
     C                     MOVEL*BLANK    WN0688  5        DT Sire Line Co
     C                     MOVEL*BLANK    WN0689 10        DT Hog Group Re
     C                     Z-ADD*ZERO     WN0690  30       DT Delivered He
     C                     Z-ADD*ZERO     WN0691  71       DT Delivered We
     C                     MOVEL*BLANK    WN0692  5        DT Trucker Code
     C                     MOVEL*BLANK    WN0693  5        DT Driver
     C                     MOVEL*BLANK    WN0694  5        DT Loading Crew
     C                     MOVEL*BLANK    WN0695  6        CHR Code
     C                     MOVEL*BLANK    WN0696  2        DT Load Type
     C                     MOVEL*BLANK    WN0697  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0698 15        DT Truck ID
     C                     MOVEL*BLANK    WN0699 15        DT Trailer ID
     C                     MOVEL*BLANK    WN0700  5        DT Transportati
     C                     Z-ADD*ZERO     WN0701  70       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0702  40       DT Transprtn Of
     C                     Z-ADD*ZERO     WN0703  40       DT Arrive@Frm v
     C                     MOVEL*BLANK    WN0704  1        DT On-Time Farm
     C                     MOVEL*BLANK    WN0705  1        DT Route Start
     C                     Z-ADD*ZERO     WN0706  70       DT Route Start
     C                     Z-ADD*ZERO     WN0707  40       DT Route Start
     C                     Z-ADD*ZERO     WN0708  40       DT Route Start
     C                     Z-ADD*ZERO     WN0709  40       DT Wait @ Trans
     C                     Z-ADD*ZERO     WN0710  70       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0711  40       DT Arrive @ Far
     C                     Z-ADD*ZERO     WN0712  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0713  70       DT Start Loadin
     C                     Z-ADD*ZERO     WN0714  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0715  40       DT Start Loadin
     C                     Z-ADD*ZERO     WN0716  40       DT Wait @ Farm
     C                     Z-ADD*ZERO     WN0717  70       DT Frm End Load
     C                     Z-ADD*ZERO     WN0718  40       DT Frm End Load
     C                     Z-ADD*ZERO     WN0719  40       DT Load Time
     C                     Z-ADD*ZERO     WN0720  70       DT Leave Farm D
     C                     Z-ADD*ZERO     WN0721  40       DT Leave Farm T
     C                     Z-ADD*ZERO     WN0722  40       DT Wait-Depart
     C                     Z-ADD*ZERO     WN0723  70       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0724  40       DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WN0725  70       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0726  40       DT Arrive @ Pla
     C                     Z-ADD*ZERO     WN0727  40       DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WN0728  40       DT Drive Time T
     C                     Z-ADD*ZERO     WN0729  40       DT Delv Time Va
     C                     MOVEL*BLANK    WN0730  1        DT On Time Deli
     C                     MOVEL*BLANK    WN0731  6        Delivery Reason
     C                     Z-ADD*ZERO     WN0732  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0733  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0734  40       DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WN0735  70       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0736  40       DT To Recv Dock
     C                     Z-ADD*ZERO     WN0737  40       DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WN0738  70       DT Start Unload
     C                     Z-ADD*ZERO     WN0739  40       DT Start Unload
     C                     Z-ADD*ZERO     WN0740  40       DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WN0741  70       DT End Unload D
     C                     Z-ADD*ZERO     WN0742  40       DT End Unload T
     C                     Z-ADD*ZERO     WN0743  40       DT Unload Time
     C                     Z-ADD*ZERO     WN0744  40       DT Unload Varia
     C                     Z-ADD*ZERO     WN0745  70       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0746  40       DT TrkScl Weigh
     C                     Z-ADD*ZERO     WN0747  40       DT Wait Time @
     C                     Z-ADD*ZERO     WN0748  40       DT Formula Wait
     C                     MOVEL*BLANK    WN0749  1        DT Source Type
     C                     MOVEL*BLANK    WN0750  4        DT GATE UPDATE
     C                     Z-ADD*ZERO     WN0751  70       DT Unused Date
     C                     Z-ADD*ZERO     WN0752  40       DT Unused Time
     C                     Z-ADD*ZERO     WN0753  40       DT Unused Wait
     C                     Z-ADD*ZERO     WN0754  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN0755  50       DT Head Receive
     C                     Z-ADD*ZERO     WN0756  71       DT Weight Recei
     C                     Z-ADD*ZERO     WN0757  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0758  50       DT Head DOA
     C                     Z-ADD*ZERO     WN0759  71       DT Weight DOA
     C                     Z-ADD*ZERO     WN0760  50       DT Head Yard De
     C                     Z-ADD*ZERO     WN0761  71       DT Weight Yard
     C                     Z-ADD*ZERO     WN0762  50       DT Head Condemn
     C                     Z-ADD*ZERO     WN0763  71       DT Weight Conde
     C                     Z-ADD*ZERO     WN0764  50       DT Head Held Ov
     C                     Z-ADD*ZERO     WN0765  71       DT Weight Held
     C                     Z-ADD*ZERO     WN0766  50       DT Head Killed
     C                     Z-ADD*ZERO     WN0767  71       DT Weight Kille
     C                     Z-ADD*ZERO     WN0768  50       DT Head Market
     C                     Z-ADD*ZERO     WN0769  71       DT Weight Marke
     C                     Z-ADD*ZERO     WN0770  51       DT Avg Weight M
     C                     Z-ADD*ZERO     WN0771  50       DT Head Resale
     C                     Z-ADD*ZERO     WN0772  71       DT Weight Resal
     C                     Z-ADD*ZERO     WN0773  51       DT Avg Weight R
     C                     Z-ADD*ZERO     WN0774  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0775  71       DT Weight Unuse
     C                     Z-ADD*ZERO     WN0776  50       DT Head Unused
     C                     Z-ADD*ZERO     WN0777  71       DT Weight Unuse
     C                     MOVEL*BLANK    WN0778  1        DT Error Sts
     C                     MOVEL*BLANK    WN0779  2        DT Error Reason
     C                     MOVEL*BLANK    WN0780  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0781  6        PL Location Cod
     C                     MOVEL*BLANK    WN0782  3        SR Source Code
     C                     Z-ADD*ZERO     WN0783  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0784  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0785  50       BOL Load Number
     C                     MOVEL*BLANK    WN0786 10        RS User Changed
     C                     Z-ADD*ZERO     WN0787  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0788  60       RS Time Changed
     C                     MOVEL*BLANK    WN0789  1        RS Record Statu
     C                     MOVEL*BLANK    WN0790 10        RS Job
     C                     MOVEL*BLANK    WN0791 10        RS Program
     C                     MOVEL*BLANK    WN0792 10        RS User Added
     C                     Z-ADD*ZERO     WN0793  70       RS Date Added
     C                     Z-ADD*ZERO     WN0794  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @AFCPIC
     C                     Z-ADDWCHONB    AFHONB           CC Company Numb
     C                     Z-ADDWCE0DT    AFE0DT           DSH Kill Date
     C                     Z-ADDWCE9DT    AFE9DT           DT Delivery Dat
     C                     Z-ADDWCAJTH    AFAJTH           DT Delivery Tim
     C                     Z-ADDWCH4A1    AFH4A1           DT Delivery Tim
      *
     C           KLCHSQ    KLIST
     C                     KFLD           AFHONB           CC Company Numb
     C                     KFLD           AFE0DT           DSH Kill Date
     C                     KFLD           AFE9DT           DT Delivery Dat
     C                     KFLD           AFAJTH           DT Delivery Tim
     C                     KFLD           AFH4A1           DT Delivery Tim
     C           KLCHSQ    CHAIN@AFCPIC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAFCPL0'MDACP
     C                     MOVEL'@AFCPIC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YFRDCS
      * Move non-key fields to @AFCPIC
     C                     Z-ADDYL0017    AFIEA1           DT Movement Num
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@AFCPIC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Upd Farm, Movement,St RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSR03           BOL Load Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSR01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSR02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSR03           BOL Load Number
      * Establish starting position
     C           KRSSR     SETLL@A1CPC4                    *
     C           KRSSR     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH HPS Farm Site NE PAR.TH HPS Farm Site
     C           A1THHD    IFNE YL0016                     *IF
      * CASE: DB1.TH Source Type is Internal
     C           A1KAST    IFEQ 'I'                        *IF
      * Due to test with e2423 SAW that we were change the
      * movement and fram site and not the state code
      * use this retreiev regardless of Not Live Or Live with MTech
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0163  7        *Return code
     C                     PARM *BLANK    WQ0164 25        Farm site Name
     C                     PARM YL0016    WQ0165  50       Farm Site USR
     C                     PARM *BLANK    WQ0166  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0167  3        State
     C                     PARM *BLANK    WQ0168 25        HPS Farm County
     C                     PARM *BLANK    WQ0169  5        HPS Cell Manage
     C                     PARM *BLANK    WQ0170 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0171 20        MTech Farm Site
     C                     PARM *BLANK    WQ0172 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Chg Farm, Movement    CH - Tattoo Header  * 
     C                     EXSR SSCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Farm, Movement    CH - Tattoo Header  * 
     C                     EXSR STCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSR     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Farm, Movement    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0795  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0796 10        TH Group Refere
     C                     MOVEL*BLANK    WN0797  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0798  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0799  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0800  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0801  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0802  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0803  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0804  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0805  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0806  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0807  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0808  50       TH Held Over
     C                     Z-ADD*ZERO     WN0809  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0810  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0811  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0812  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0813  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0814  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0815  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0816  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0817  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0818  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0819  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0820  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0821  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0822  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0823  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0824  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0825  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0826  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0827  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0828  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0829  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0830  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0831  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0832  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0833  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0834  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0835  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0836  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0837  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0838  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0839  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0840  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0841  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0842  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0843  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0844  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0845  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0846  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0847  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0848  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0849  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0850  1        TH Header Error
     C                     MOVEL*BLANK    WN0851  1        TH Detail Error
     C                     MOVEL*BLANK    WN0852  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0853  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0854  80       TH Commission A
     C                     Z-ADD*ZERO     WN0855  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0856  1        TH User Error O
     C                     MOVEL*BLANK    WN0857  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0858  1        TH Sex
     C                     Z-ADD*ZERO     WN0859  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0860  70       TH Commission P
     C                     Z-ADD*ZERO     WN0861  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0862  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0863  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0864  31       TH FFLI
     C                     Z-ADD*ZERO     WN0865  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0866  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0867  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0868  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0869  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0870  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0871  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0872  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0873  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0874  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0875  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0876  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0877  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0878  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0879  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0880  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0881  1        TH Source Type
     C                     MOVEL*BLANK    WN0882  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0883  1        TH Payment Type
     C                     MOVEL*BLANK    WN0884  3        TH Source Code
     C                     MOVEL*BLANK    WN0885  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0886  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0887  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0888  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0889  3        TH Unused Code
     C                     MOVEL*BLANK    WN0890  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0891  1        TH Commission S
     C                     MOVEL*BLANK    WN0892  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0893  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0894  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0895  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0896  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0897  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0898  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0899  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0900  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0901  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0902  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0903  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0904  3        TH PHA Average
     C                     MOVEL*BLANK    WN0905  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0906  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0907  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0908  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0909  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0910  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0911  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0912  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0913  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0914  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0915  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0916  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0917  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0918 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0919 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0920 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0921 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0922  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0923  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0924  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0925  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0926  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0927  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0928  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0929  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0930  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0931  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0932  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0933  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0934  70       TH Unused Date
     C                     MOVEL*BLANK    WN0935  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0936  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0937  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0938  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0939  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0940  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0941  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0942  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0943  6        DF Defect Code
     C                     MOVEL*BLANK    WN0944  6        THP Process Cod
     C                     MOVEL*BLANK    WN0945  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0946  6        PL Location Cod
     C                     MOVEL*BLANK    WN0947  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0948  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0949  3        HC Class Code
     C                     MOVEL*BLANK    WN0950 10        RS User Changed
     C                     Z-ADD*ZERO     WN0951  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0952  60       RS Time Changed
     C                     MOVEL*BLANK    WN0953  1        RS Record Statu
     C                     MOVEL*BLANK    WN0954 10        RS Job
     C                     MOVEL*BLANK    WN0955 10        RS Program
     C                     MOVEL*BLANK    WN0956 10        RS User Added
     C                     Z-ADD*ZERO     WN0957  70       RS Date Added
     C                     Z-ADD*ZERO     WN0958  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDA1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WBBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    WBB0DT           TH Kill Date
      *
     C           KLCHSS    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHSS    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YGRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0017    WBOXNB           TH HPS Movement
     C                     MOVELWUDRTX    WBNZTX    P      TH State
     C                     Z-ADDYL0016    WBTHHD           TH HPS Farm Sit
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Farm, Movement    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0959  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0960 10        TH Group Refere
     C                     MOVEL*BLANK    WN0961  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0962  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0963  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0964  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0965  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0966  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0967  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0968  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0969  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0970  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0971  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0972  50       TH Held Over
     C                     Z-ADD*ZERO     WN0973  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0974  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0975  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0976  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0977  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0978  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0979  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0980  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0981  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0982  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0983  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0984  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0985  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0986  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0987  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0988  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0989  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0990  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0991  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0992  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0993  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0994  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0995  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0996  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0997  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0998  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0999  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN1000  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN1001  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN1002  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN1003  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN1004  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN1005  72       TH Additions Am
     C                     Z-ADD*ZERO     WN1006  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN1007  72       Th Payment Net
     C                     Z-ADD*ZERO     WN1008  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN1009  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN1010  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN1011  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN1012  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN1013  2        TH Payment Sts
     C                     MOVEL*BLANK    WN1014  1        TH Header Error
     C                     MOVEL*BLANK    WN1015  1        TH Detail Error
     C                     MOVEL*BLANK    WN1016  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN1017  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN1018  80       TH Commission A
     C                     Z-ADD*ZERO     WN1019  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN1020  1        TH User Error O
     C                     MOVEL*BLANK    WN1021  1        TH Held Over Re
     C                     MOVEL*BLANK    WN1022  1        TH Sex
     C                     Z-ADD*ZERO     WN1023  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN1024  70       TH Commission P
     C                     Z-ADD*ZERO     WN1025  70       TH Actual Check
     C                     Z-ADD*ZERO     WN1026  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN1027  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1028  31       TH FFLI
     C                     Z-ADD*ZERO     WN1029  72       TH Kill Product
     C                     Z-ADD*ZERO     WN1030  72       TH Cut Product
     C                     Z-ADD*ZERO     WN1031  72       TH Render Produ
     C                     Z-ADD*ZERO     WN1032  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN1033  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN1034  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN1035  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN1036  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN1037  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN1038  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN1039  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN1040  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN1041  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1042  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1043  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN1044  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN1045  1        TH Source Type
     C                     MOVEL*BLANK    WN1046  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN1047  1        TH Payment Type
     C                     MOVEL*BLANK    WN1048  3        TH Source Code
     C                     MOVEL*BLANK    WN1049  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN1050  1        TH Posted to HP
     C                     MOVEL*BLANK    WN1051  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN1052  1        TH Shift Held O
     C                     MOVEL*BLANK    WN1053  3        TH Unused Code
     C                     MOVEL*BLANK    WN1054  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1055  1        TH Commission S
     C                     MOVEL*BLANK    WN1056  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN1057  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN1058  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN1059  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN1060  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN1061  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN1062  50       TH Head Identif
     C                     Z-ADD*ZERO     WN1063  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN1064  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN1065  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN1066  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN1067  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN1068  3        TH PHA Average
     C                     MOVEL*BLANK    WN1069  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN1070  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN1071  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN1072  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN1073  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN1074  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN1075  50       TH Broken Back
     C                     Z-ADD*ZERO     WN1076  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN1077  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN1078  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN1079  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN1080  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN1081  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN1082 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN1083 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1084 112       TH Break Even P
     C                     Z-ADD*ZERO     WN1085 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN1086  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN1087  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN1088  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1089  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1090  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN1091  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN1092  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1093  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN1094  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1095  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1096  70       TH Head LFT
     C                     Z-ADD*ZERO     WN1097  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN1098  70       TH Unused Date
     C                     MOVEL*BLANK    WN1099  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN1100  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1101  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN1102  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN1103  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN1104  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN1105  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN1106  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN1107  6        DF Defect Code
     C                     MOVEL*BLANK    WN1108  6        THP Process Cod
     C                     MOVEL*BLANK    WN1109  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1110  6        PL Location Cod
     C                     MOVEL*BLANK    WN1111  3        HB Buyer Code
     C                     MOVEL*BLANK    WN1112  5        GN Genetic Code
     C                     MOVEL*BLANK    WN1113  3        HC Class Code
     C                     MOVEL*BLANK    WN1114 10        RS User Changed
     C                     Z-ADD*ZERO     WN1115  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1116  60       RS Time Changed
     C                     MOVEL*BLANK    WN1117  1        RS Record Statu
     C                     MOVEL*BLANK    WN1118 10        RS Job
     C                     MOVEL*BLANK    WN1119 10        RS Program
     C                     MOVEL*BLANK    WN1120 10        RS User Added
     C                     Z-ADD*ZERO     WN1121  70       RS Date Added
     C                     Z-ADD*ZERO     WN1122  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDA1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WBBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    WBB0DT           TH Kill Date
      *
     C           KLCHST    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHST    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YHRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0017    WBOXNB           TH HPS Movement
     C                     MOVELA1NZTX    WBNZTX    P      TH State
     C                     Z-ADDYL0016    WBTHHD           TH HPS Farm Sit
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ******* Default Job Date into 1st blank date *******
      *================================================================
      * Default/position cursor for Internals
      * CASE: DB1.DT Source Type is Internal
     C           AFXKST    IFEQ 'I'                        *IF
      * CASE: DTL.DT Route Start Date is Not Entered
     C           #1FBDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1E9DT    #1FBDT           DT Route Start
      * *Set Cursor: DTL.DT Route Start Time  (*Override=*NO)
     C                     Z-ADD016       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT Arrive @ Farm Date is Not Entered
     C           #1FCDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FBDT    #1FCDT           DT Arrive @ Far
      * *Set Cursor: DTL.DT Arrive @ Farm Time  (*Override=*NO)
     C                     Z-ADD017       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT Start Loading Date is Not Entered
     C           #1FDDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FBDT    #1FDDT           DT Start Loadin
      * *Set Cursor: DTL.DT Start Loading Time  (*Override=*NO)
     C                     Z-ADD018       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT Leave Farm Date is Not Entered
     C           #1FFDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FBDT    #1FFDT           DT Leave Farm D
      * *Set Cursor: DTL.DT Leave Farm Time  (*Override=*NO)
     C                     Z-ADD019       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT Arrive @ Plant Date is Not Entered
     C           #1FHDT    IFEQ 0                          *IF
     C                     Z-ADD#1FBDT    #1FHDT           DT Arrive @ Pla
      * *Set Cursor: DTL.DT Arrive @ Plant Time  (*Override=*NO)
     C                     Z-ADD016       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT TrkScl Weigh-In Date is Not Entered
     C           #1FIDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FBDT    #1FIDT           DT TrkScl Weigh
      * *Set Cursor: DTL.DT TrkScl Weigh-In Time  (*Override=*NO)
     C                     Z-ADD017       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT To Recv Dock Date is Not Entered
     C           #1FJDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FBDT    #1FJDT           DT To Recv Dock
      * *Set Cursor: DTL.DT To Recv Dock Time  (*Override=*NO)
     C                     Z-ADD018       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT Start Unloading Date is Not Entered
     C           #1FKDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FBDT    #1FKDT           DT Start Unload
      * *Set Cursor: DTL.DT Start Unloading Time  (*Override=*NO)
     C                     Z-ADD019       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT TrkScl Weigh-Out Date is Not Entered
     C           #1FMDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FBDT    #1FMDT           DT TrkScl Weigh
      * *Set Cursor: DTL.DT TrkScl Weigh-Out Time  (*Override=*NO)
     C                     Z-ADD020       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Default/position cursor for external
      * CASE: DB1.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
      * CASE: DTL.DT Arrive @ Plant Date is Not Entered
     C           #1FHDT    IFEQ 0                          *IF
     C                     Z-ADD#1E9DT    #1FHDT           DT Arrive @ Pla
      * *Set Cursor: DTL.DT Arrive @ Plant Time  (*Override=*NO)
     C                     Z-ADD016       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT TrkScl Weigh-In Date is Not Entered
     C           #1FIDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FHDT    #1FIDT           DT TrkScl Weigh
      * *Set Cursor: DTL.DT TrkScl Weigh-In Time  (*Override=*NO)
     C                     Z-ADD017       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT To Recv Dock Date is Not Entered
     C           #1FJDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FHDT    #1FJDT           DT To Recv Dock
      * *Set Cursor: DTL.DT To Recv Dock Time  (*Override=*NO)
     C                     Z-ADD018       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT Start Unloading Date is Not Entered
     C           #1FKDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FHDT    #1FKDT           DT Start Unload
      * *Set Cursor: DTL.DT Start Unloading Time  (*Override=*NO)
     C                     Z-ADD019       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     ELSE
      * CASE: DTL.DT TrkScl Weigh-Out Date is Not Entered
     C           #1FMDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1FHDT    #1FMDT           DT TrkScl Weigh
      * *Set Cursor: DTL.DT TrkScl Weigh-Out Time  (*Override=*NO)
     C                     Z-ADD020       W0ROW1
     C                     Z-ADD092       W0COL1
     C                     MOVEL'0'       W0OVR1           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * FP1108 Associate HPS Driver with Truckers
      * 03/18/2009 Will use the following program from HPS
      * but will not get the Trucker nor the Driver any more
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Validate Driver - without default from farm site
      *================================================================
      * reworked due to no longer default from farm site routine
      * Driver is a required field
      * E2423 Mtech Live or Not Live will use this program
      * slm e2423 11/8/13 Verify that this is working
      * Val HPS Driver ActOnlyUP - STR HPS Interface  * 
     C                     CALL 'HP292'                90  Val HPS Driver
     C           WULMST    PARM *BLANK    WQ0086  7        Return Code USR
     C                     PARM #1J8CD    WQ0087  5        DT Driver
     C                     PARM *BLANK    WQ0088 25        HPS Driver Name
     C                     PARM *BLANK    WQ0089  5        DT Transportati
     C                     PARM *BLANK    WQ0090  1        RS Record Statu
     C                     PARM *BLANK    WQ0091 15        DT Truck ID
     C                     PARM *BLANK    WQ0092 15        DT Trailer ID
     C           #1LICD    PARM *BLANK    WQ0093  5        DT Trucker Code
     C                     PARM *BLANK    WQ0094 25        DT Trucker Name
     C           #DYPTX    PARM *BLANK    WQ0095 20        MTech Trucker R
     C           #DYMTX    PARM *BLANK    WQ0096 20        MTech Driver Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP292'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993837*
     C                     END
      * CASE: WRK.Return Code USR is Error Found
     C           WULMST    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVEL#1J8CD    ZA0053           DT Driver
      * Send message 'Driver not found'
     C                     MOVEL'PRK1066' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
      * Default Trailer id
      * CASE:
      *  - c1ORc2
      *   |- c1    : DTL.DT Trailer ID is Not Entered
      *   |- c2    : DTL.DT Driver NE LCL.DT Driver
      *   '-
     C           #1KZCD    IFEQ *BLANK                     *IF
     C           #1J8CD    ORNE YL0001                     *OR
      * CASE: LCL.DT Trailer ID is Entered
     C           YL0009    IFNE *BLANK                     *IF
     C                     MOVELYL0009    #1KZCD           DT Trailer ID
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Validate Times as military 8/5/2021 negative not allowed
      *================================================================
      * slm 8/06/21 add validation for the military time and do not allow
      * negative time
      * move validation in order of the fields on the delivery tracking
      * data base
      * validate DT Route Start Time
     C                     EXSR UESUBR                     validate DT Rou
      * validate DT Arrive @ Farm Time
     C                     EXSR UFSUBR                     validate DT Arr
      * validate DT Start Loading Time
     C                     EXSR UGSUBR                     validate DT Sta
      * validate DT Leave Farm Time
     C                     EXSR UHSUBR                     validate DT Lea
      * validate DT Arrive @ Plant Time
     C                     EXSR UISUBR                     validate DT Arr
      * validate DT TrkScl Weigh-In Time
     C                     EXSR UJSUBR                     validate DT Trk
      * validate DT To Recv Dock Time
     C                     EXSR UKSUBR                     validate DT To
      * validate DT Start Unloading Time
     C                     EXSR ULSUBR                     validate DT Sta
      * validate DT TrkScl Weigh-Out Time
     C                     EXSR UMSUBR                     validate DT Trk
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * validate DT Route Start Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ALTH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * validate DT Arrive @ Farm Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANTH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * validate DT Start Loading Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AOTH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * validate DT Leave Farm Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ASTH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9955  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * validate DT Arrive @ Plant Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AVTH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * validate DT TrkScl Weigh-In Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AXTH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * validate DT To Recv Dock Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AZTH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * validate DT Start Unloading Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1A1TH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * validate DT TrkScl Weigh-Out Time
      *================================================================
      * Val Time hhmm NegNALL IF - STR Miscellaneous  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1A5TH    WL0001           Time USR
     C                     MOVELYL0010    WL0002    P      Status 2
     C                     MOVELYL0011    WL0003    P      Status 5 Usr
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0010    P      Status 2
     C                     MOVELWL0003    YL0011    P      Status 5 Usr
      * CASE: LCL.Status 2 is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time entry must be milita'
     C                     MOVEL'PRK1085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     END                             *FI
      * CASE: LCL.Status 5 Usr is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Send message 'Time must not be negative'
     C                     MOVEL'PRK1612' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0122  30       BOH Company Num
     C                     PARM @CN,006   WQ0123 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0124 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0013           MTech Live Yes
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Update Date/Times only if the Time is also entered  2/26/03
      *================================================================
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT Sched Route Start Time is Not Entered
      *   |- c2    : PAR.DT Sched Route Start Date is Not Entered
      *   '-
     C           #1ALTH    IFEQ 0                          *IF
     C           #1FBDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FBDT           DT Route Start
     C                     Z-ADD*ZERO     #1ALTH           DT Route Start
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT Frm Arrival Time is Not Entered
      *   |- c2    : PAR.DT Frm Arrival Date is Not Entered
      *   '-
     C           #1ANTH    IFEQ 0                          *IF
     C           #1FCDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FCDT           DT Arrive @ Far
     C                     Z-ADD*ZERO     #1ANTH           DT Arrive @ Far
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT Frm Beg Loading Time is Not Entered
      *   |- c2    : PAR.DT Frm Beg Loading Date is Not Entered
      *   '-
     C           #1AOTH    IFEQ 0                          *IF
     C           #1FDDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FDDT           DT Start Loadin
     C                     Z-ADD*ZERO     #1AOTH           DT Start Loadin
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT Frm Depart Time is Not Entered
      *   |- c2    : PAR.DT Frm Depart Date is Not Entered
      *   '-
     C           #1ASTH    IFEQ 0                          *IF
     C           #1FFDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FFDT           DT Leave Farm D
     C                     Z-ADD*ZERO     #1ASTH           DT Leave Farm T
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT Arrive @ Plant Time is Not Entered
      *   |- c2    : PAR.DT Arrive @ Plant Date is Not Entered
      *   '-
     C           #1AVTH    IFEQ 0                          *IF
     C           #1FHDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     #1AVTH           DT Arrive @ Pla
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT TrkScl Weigh-In Time is Not Entered
      *   |- c2    : PAR.DT TrkScl Weigh-In Date is Not Entered
      *   '-
     C           #1AXTH    IFEQ 0                          *IF
     C           #1FIDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     #1AXTH           DT TrkScl Weigh
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT Rcv Dock Arvl Time is Not Entered
      *   |- c2    : PAR.DT Rcv Dock Arvl Date is Not Entered
      *   '-
     C           #1AZTH    IFEQ 0                          *IF
     C           #1FJDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     #1AZTH           DT To Recv Dock
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT Beg Unload Time is Not Entered
      *   |- c2    : PAR.DT Beg Unload Date is Not Entered
      *   '-
     C           #1A1TH    IFEQ 0                          *IF
     C           #1FKDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FKDT           DT Start Unload
     C                     Z-ADD*ZERO     #1A1TH           DT Start Unload
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.DT TrkScl Weigh-Out Time is Not Entered
      *   |- c2    : PAR.DT TrkScl Weigh-Out Date is Not Entered
      *   '-
     C           #1A5TH    IFEQ 0                          *IF
     C           #1FMDT    OREQ 0                          *OR
     C                     Z-ADD*ZERO     #1FMDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     #1A5TH           DT TrkScl Weigh
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * MODIFICATION HISTORY
      *================================================================
      * WI572 EricL 5/31/23 - Added below Prop 12 cond values to PKVLLSP
      * PP Prop 12 pen gestated
      * PT Prop 12 pen gestated top
      * P2 Prop 12 2nd top
      * P3 Prop 12 3rd top
      * P4 Prop 12 4th top
      * CA California Prop 12
      * MA Massachusetts Question 3
      * E50577 JJH 07/24/19 - Add Load Type conditions
      * - Added Load Type - 2D, 3D, and 4D to Status Field DT Load Type
      * - Recompile only, no logic changes.
      * - Remove all code from E10812 for Split Loads.  This code was
      *   never implemented and never moved into Production.
      * - A saved copy of this function was moved to Edt Delivery Trackin
      * Susan Mason 01/30/2013  MTech changes
      * Load Type
      * Susan Mason 08/03/2011  Truck Arrival Schedule process
      * If the truck arrival schedule is allowed
      * then update the buy order load flagged with 'A'
      * SHOW THE GATE YES OR NO IF THIS IS FROM THE GATE PROCESS
      * ++++++++++++++++++++++++++++++++++++++++
      * E00347 6/16/2009 SLM - EMAIL from LeAnn,
      * Place in a different HPS program per Leann,
      * pertaining to driver.
      * H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Numbe
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0199  30       BOH Company Num
     C                     PARM @CN,006   WQ0200 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0201 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0007           MTech Live Yes
     C                     MOVELWUKBTX    WUFKSS           MTech Live Yes
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Delivery Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1K3CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Delivery Reason
     C           YPMTFD    OREQ '#1K3CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1K3CD' defaulted for 'Delivery Reason Code'.
     C                     CALL 'PLA1SRR'              90  Sel Delivery Re
     C                     PARM *BLANK    W0RTN   7
     C           #1K3CD    PARM #1K3CD    WQ0103  6        Delivery Reason
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLA1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1K3CD    IFNE *BLANK                     Delivery Reason
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1K3CD    IFEQ *BLANK                     Delivery Reason
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAAI    KLIST
     C                     KFLD           AIK3CD           Delivery Reason
      * Setup key
     C                     MOVEL#1K3CD    AIK3CD
     C           KLVAAI    CHAIN@AIREIV              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Delivery Reason        NF'
     C                     MOVEL'PRK1036' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK1036' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0104  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0105  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWA    KLIST
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    WAABCD
     C                     MOVEL#1AECD    WAAECD
     C           KLVBWA    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Source
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AACD    WK1X01  1
     C           WK1X01    IFEQ '?'                        SR Source Code
     C           YPMTFD    OREQ '#1AACD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AACD' defaulted for 'SR Source Code'.
     C                     CALL 'PKDRSRR'              90  Sel Source
     C                     PARM *BLANK    W0RTN   7
     C           #1AACD    PARM #1AACD    WQ0106  3        SR Source Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AACD    IFNE *BLANK                     SR Source Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AACD    IFEQ *BLANK                     SR Source Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAA    KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVEL#1AACD    AAAACD
     C           KLVCAA    CHAIN@AAREAC              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Source                 NF'
     C                     MOVEL'PRK0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0005' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Buy Order Load
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(DTL) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0107  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0108  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0109  50       BOL Load Number
     C                     PARM #1ABCD    WQ0110  6        PD Producer Cod
     C                     PARM #1AECD    WQ0111  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAX    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB
     C                     Z-ADD#1BNNB    AXBNNB
     C                     Z-ADD#1BONB    AXBONB
     C           KLVDAX    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR1    IFEQ '1'
     C           W0OVR1    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW1    ZZCSRW
     C                     Z-ADDW0COL1    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW1  30
     C                     Z-ADD0         W0COL1  30
     C                     MOVE '2'       W0OVR1  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE083
     C           ZHCSCL    ANDLE084
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1XHST'  YPMTFD           DT Load Type
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDEQ083
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1XIST'  YPMTFD           DT Full/Split L
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDGE093
     C           ZHCSCL    ANDLE097
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1LHCD'  YPMTFD           DT Transportati
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * Original Logic
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y'       P3P4ST           Status 1
      * Exc Clc DT Wait perDt XF - Delivery Tracking  * 
     C                     CALL 'PLC8XFR'              90  Exc Clc DT Wait
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0184  30       CC Company Numb
     C                     PARM P1E0DT    WQ0185  70       DSH Kill Date
     C                     PARM P1E9DT    WQ0186  70       DT Delivery Dat
     C                     PARM P1AJTH    WQ0187  40       DT Delivery Tim
     C                     PARM P1H4A1    WQ0188  30       DT Delivery Tim
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLC8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2J8NB           Oms Warehouse C
     C                     MOVEL*BLANK    P2C7CD           Oms Application
     C                     MOVEL*BLANK    P2C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P2G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P2G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P2EUTX           Oms Name
     C                     MOVEL*BLANK    P2EVTX           Oms System Valu
     C                     MOVEL*BLANK    P2HAST           Oms Access Deni
     C                     Z-ADD*ZERO     P4FWDT           Current System
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field BOL Truck Scale Weigh Sts
     C                     MOVEL*BLANK    WUPAST  1
      * Define work field Display Output Only Usr
     C                     MOVEL*BLANK    WUL9ST  1
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field DT Hog Group Reference
     C                     MOVEL*BLANK    WULGCD 10
      * Define work field HPS Hog Group Status
     C                     MOVEL*BLANK    WULLCD  2
      * Define work field HPS Hog Production Phase
     C                     MOVEL*BLANK    WULNCD  5
      * Define work field HPS Hog Production Type
     C                     MOVEL*BLANK    WULMCD  5
      * Define work field Condition Name USR
     C                     MOVEL*BLANK    WUC4TX 25
      * Define work field DT Trucker Name Usr 25
     C                     MOVEL*BLANK    WUV7TX 25
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Define work field Blank Usr 2
     C                     MOVEL*BLANK    WUJ6TX  1
      * Define work field HPS Loading Crew Desc
     C                     MOVEL*BLANK    WUSMTX 25
      * Define work field DT Transportation Office
     C                     MOVEL*BLANK    WULHCD  5
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field DTS Delivered Head
     C                     Z-ADD*ZERO     WUIHA1  30
      * Define work field Weight Tot USR
     C                     Z-ADD*ZERO     WUH3NB  71
      * Define work field Time MM USR
     C                     Z-ADD*ZERO     WUTMMM  20
      * Define work field Time HH USR
     C                     Z-ADD*ZERO     WUTMHH  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WAASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WAHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field HPS Farm County
     C                     MOVEL*BLANK    WUQGTX 25
      * Define work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    WUJXCD  5
      * Define work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    WUQFTX 25
      * Define work field MTech Live Yes or No
     C                     MOVEL*BLANK    WUFKSS  1
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SFINFN.
     C                     Z-ADD*ZERO     WL0001  40
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003  1
      * Define local work field DT Driver
     C                     MOVEL*BLANK    YL0001  5
      * Define local work field DT Farm Site Code
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field DT Building
     C                     MOVEL*BLANK    YL0003  5
      * Define local work field DT Room
     C                     MOVEL*BLANK    YL0004  5
      * Define local work field DT Trucker Code HPS Prior
     C                     MOVEL*BLANK    YL0005  5
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0006  51
      * Define null work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    YN0001  5
      * Define null work field State
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field HPS Farm County
     C                     MOVEL*BLANK    YN0003 25
      * Define null work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    YN0004  5
      * Define null work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    YN0005 25
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0006 20
      * Define null work field HPS Driver Name
     C                     MOVEL*BLANK    YN0007 25
      * Define null work field DT Transportation Office
     C                     MOVEL*BLANK    YN0008  5
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field DT Truck ID
     C                     MOVEL*BLANK    YN0010 15
      * Define null work field DT Trailer ID
     C                     MOVEL*BLANK    YN0011 15
      * Define null work field DT Trucker Name Usr 25
     C                     MOVEL*BLANK    YN0012 25
      * Define null work field HPS Trucker Name
     C                     MOVEL*BLANK    YN0013 25
      * Define null work field HPS Trucker Type
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field HPS Loading Crew Desc
     C                     MOVEL*BLANK    YN0015 25
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field DT Loading Crew
     C                     MOVEL*BLANK    YL0008  5
      * Define null work field DT Trucker Code HPS
     C                     MOVEL*BLANK    YN0016  5
      * Define null work field DT Driver
     C                     MOVEL*BLANK    YN0017  5
      * Define null work field MTech Trucker Ref
     C                     MOVEL*BLANK    YN0018 20
      * Define null work field MTech Driver Ref
     C                     MOVEL*BLANK    YN0019 20
      * Define local work field DT Trailer ID
     C                     MOVEL*BLANK    YL0009 15
      * Define local work field Status 2
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Status 5 Usr
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Date USR
     C                     Z-ADD*ZERO     YL0012  70
      * Define null work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    YN0020 25
      * Define null work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    YN0021  5
      * Define null work field HPS Farm County
     C                     MOVEL*BLANK    YN0022 25
      * Define null work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    YN0023  5
      * Define null work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    YN0024 25
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0025 20
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0026 20
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field DSH Status
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field DT Actual Delivery Hour
     C                     Z-ADD*ZERO     YL0015  20
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0027 20
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0028 20
      * Define local work field Farm Site USR
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field DT Movement Number
     C                     Z-ADD*ZERO     YL0017  70
      * Define null work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    YN0029 25
      * Define null work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    YN0030  5
      * Define null work field HPS Farm County
     C                     MOVEL*BLANK    YN0031 25
      * Define null work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    YN0032  5
      * Define null work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    YN0033 25
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0034 20
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0035 20
      * Define local work field Trk Arrival Sched Sts
     C                     MOVEL*BLANK    YL0018  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * MODIFICATION HISTORY
     C                     EXSR UPSUBR                     MODIFICATION HI
      * Val Application/User  IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P2J8NB    PARM *BLANK    WQ0189  3        Oms Warehouse C
     C           WUHONB    PARM *ZERO     WQ0190  30       CC Company Numb
     C                     PARM 'HPE'     WQ0191  6        Oms Application
     C           P2C8CD    PARM *BLANK    WQ0192  3        Oms SalesPerson
     C           P2G8ST    PARM *BLANK    WQ0193  1        Oms Allow Multi
     C           P2G9ST    PARM *BLANK    WQ0194 10        Oms Default Pri
     C           P2EUTX    PARM *BLANK    WQ0195 30        Oms Name
     C           P2EVTX    PARM *BLANK    WQ0196 40        Oms System Valu
     C           P2HAST    PARM *BLANK    WQ0197  1        Oms Access Deni
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
     C                     END                             *FI
     C                     MOVEL'N'       P3P4ST           Status 1
      * Rtv System Date       UP - STR User Source Functions  * 
     C                     CALL 'PKPSUPR'              90  Rtv System Date
     C           P4FWDT    PARM *ZERO     WQ0198  70       *DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPSUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UQSUBR                     Get the MTech L
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
0104801304015600181602072
** W0END
0105001311015670182002074
** W0NAM
#1HONB    V1E0DT    V1E9DT    #1AJTH    #1H4A1
** W1BEG
01041010660110701297013220136301553
01578016190164801809018340187501882
02065020900213202158023500238802414
02577026020264402833028580290003074
03165033300342104119041250418804194
04375043810444404450046310463704700
04706048870489304956049620521205218
** W1END
01043010730110801303013290136301559
01582016230166701813018360187901886
02072020940213602177023690239202433
02582026040265802838028650291403120
03170033640342504123041320419204201
04379043880444804457046350464404704
04713048910490004960049690521605225
** W1NAM
#1HONB    V1E0DT    #1XHST    #1IEA1    V1E9DT    #1XIST    #1BNNB
#1AJTH    #1ICA1    #DYKTX    #1BONB    #1H4A1    #1K0CD    #1K1CD
V1FXDT    #1J9CD    #1LICD    #DYPTX    #DYNTX    #1J8CD    #DYMTX
#1ABCD    #1IDA1    #1KBCD    #1AECD    #1IPA1    #1KZCD    #DOBTX
#1MGCD    #DUPTX    #1LHCD    #1ALTH    V1FBDT    #1AVTH    V1FHDT
#1ANTH    V1FCDT    #1AXTH    V1FIDT    #1AOTH    V1FDDT    #1AZTH
V1FJDT    #1ASTH    V1FFDT    #1A1TH    V1FKDT    #1A5TH    V1FMDT
** @CN
00001 Prior Trucker
00002 User must update
00003 Gate Update this record
00004 SELECT
00005 Y2U0005
00006 MTECHLIVE
