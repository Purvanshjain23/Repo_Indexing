/***************************************************************** */
/*š                                                              € */
/*š PROGRAM NUMBER:  HP4089CL                                    € */
/*š PROGRAM NAME:    INTERACTIVE ALLOCATE OBJECT                 € */
/*š PROGRAMMER:      BRAD BADEN                                  € */
/*š PROJECT:         E010812                                     € */
/*š CREATE DATE:      3/08/2018                                  € */
/*š                                                              € */
/*š FUNCTION:        THIS CL IS CALLED TO SEE IF A FILE IS       € */
/*š                  ALLOCATED OR NOT.  FIELD &ALLOCATED IS      € */
/*š                  RETURNED TO THE CALLING PROGRAM WITH        € */
/*š                  VALUE 'A' = ALLOCATED OR 'N' = NOT ALLOCATED€ */
/*=================================================================*/
/*  Modification History:                                          */
/*  xx/xx/xxxx xxx xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  */
/*                                                                 */
/*******************************************************************/

             PGM        PARM(&FILENAME &ALLOCATED)

             DCL        VAR(&FILENAME)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&ALLOCATED) TYPE(*CHAR) LEN(1)

          /*‚Default Allocated flag to 'N' */
             CHGVAR     VAR(&ALLOCATED) VALUE('N')

          /*‚Attempt to allocate the file for 10 seconds */
             ALCOBJ     OBJ((&FILENAME *FILE *EXCL)) WAIT(10)
             MONMSG     MSGID(CPF1002) EXEC(CHGVAR VAR(&ALLOCATED) +
                          VALUE('A'))

             IF         COND(&ALLOCATED = 'N') THEN(DLCOBJ +
                          OBJ((&FILENAME *FILE *EXCL)))

 EXIT:       ENDPGM
