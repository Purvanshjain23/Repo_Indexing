/*********************************************************************/
/*  PROGRAM  - PMVEUPC                                               */
/*  SYNOPSIS - PRINT A REPORT OF INTER-COMPANY ORDERS FROM THE       */
/*             SALES HISTORY (INVOICED) WHERE THE ITEM CODE HAS      */
/*             A COMMODITY GROUP OF "CWG" AND A COMMODITY CODE       */
/*             OF JLC (JACOBSEN LETTER CHICAGO)                      */
/*                                                                   */
/*  SYSTEM   - ORDER MANAGEMENT SYSTEM                               */
/*  DATE     - 06/04/2008                                            */
/*                                                                   */
/*      PARAMETERS:                                                  */
/*                                                                   */
/*     O    &RETURN     - RETURN CODE                                */
/*     B    &OUTQ       - OUTPUT QUEUE                               */
/*     B    &HOLD       - HOLD STATUS                                */
/*     B    &SAVE       - SAVE STATUS                                */
/*     B    &COPYN      - NO. OF COPIES  (PASSED)                    */
/*     B    &FDATEN     - FROM DATE      (PASSED)                    */
/*     B    &TDATEN     - THRU DATE      (PASSED)                    */
/*     I    &COMPNYN    - COMPANY NUMBER (PASSED AS 15.5)            */
/*********************************************************************/
 PPYKUPC:    PGM        PARM(&RETURN &OUTQ &HOLD &SAVE &COMPNYN +
                          &FDATEN &TDATEN &COPYN)
/* PARMS                                                                      */
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&COPYN) TYPE(*DEC)
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&FDATEN) TYPE(*DEC)
             DCL        VAR(&FDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&TDATEN) TYPE(*DEC)
             DCL        VAR(&TDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&COMPNYN) TYPE(*DEC) /*  FOR PASSING    */
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)

/* INTERNAL FIELDS                                                            */
             DCL        VAR(&COPY) TYPE(*DEC) LEN(2 0)

/* ERROR MESSAGE FIELDS                                                       */
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL) TYPE(*DEC) LEN(5 0)

/*------------------------------------------------------------------*/
/*   INITIALIZE VARIABLES                                           */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR     VAR(&FDATE) VALUE(&FDATEN)
             CHGVAR     VAR(&TDATE) VALUE(&TDATEN)
             CHGVAR     VAR(&COPY) VALUE(&COPYN)
             CHGVAR     VAR(&COMP) VALUE(&COMPNYN)

/*------------------------------------------------------------------*/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                      */
/*------------------------------------------------------------------*/
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/*------------------------------------------------------------------*/
/* OVERRIDE PRINTER FILE WITH USER SPECIFIED SELECTION VALUES       */
/*------------------------------------------------------------------*/
             OVRPRTF    FILE(PMVAPFR$) OUTQ(&OUTQ) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)

/*------------------------------------------------------------------*/
/* PRINT CWG/LARD AGREEMENT PRICING REPORT                          */
/*------------------------------------------------------------------*/
 CALL:       CALL       PGM(PMVAPFR) PARM(' ' &COMP &FDATE &TDATE)
             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))
/*------------------------------------------------------------------*/

 END:        ENDPGM
/*------------------------------------------------------------------*/
