
/***************************************************************** */
/*  PROGRAM NUMBER --> PKXDUPR                                     */
/*  PROGRAM NAME ----> SEQUEL                                      */
/*                     PRIMAL OPT - PRIMAL SCALE DATA              */
/*  PROGRAMMER ------> ROSE CENTONZE                               */
/*  DATE ------------> 04/11/01                                    */
/*                                                                 */
/*                                                                 */
/*  PROGRAM PURPOSE -> THIS CL EXECUTES A SEQUEL STATEMENT TO      */
/*                     CREATE AN OUTFILE.                          */
/*                                                                 */
/***************************************************************** */
/*  MODIFIED:                                                      */
/*                                                                 */
/***************************************************************** */

             PGM PARM(&RTN &SCALE &COMPX &FDATEX &TDATEX &DOCUM)
        DCL    &RTN       *CHAR   (7)
        DCL    &COMP      *DEC    (3 0)           /*  COMPANY #     */
        DCL    &COMPX     *CHAR   (3)           /*  COMPANY #     */
        DCL    &FDATE     *DEC    (7 0)          /*  FROM DATE      */
        DCL    &FDATEX    *CHAR   (7)          /*  FROM DATE      */
        DCL    &TDATE     *DEC    (7 0)          /*  TO  DATE      */
        DCL    &TDATEX    *CHAR   (7)          /*  TO DATE      */
        DCL    &SCALE     *CHAR   (2)           /*  SCALE   #     */
        DCL    &DOCUMENT  *CHAR   (10)
             DCL        VAR(&DOCUM) TYPE(*CHAR) LEN(08)
        DCL    &PCFILE    *CHAR   (32)
             DCL        VAR(&SEL)  TYPE(*CHAR) LEN(1500)

             CHGVAR    VAR(&COMP) VALUE(&COMPX) /* Change to length +
                          for print program */
             CHGVAR    VAR(&FDATE) VALUE(&FDATEX)
             CHGVAR    VAR(&TDATE) VALUE(&TDATEX) /* Change to length +
                          for print program */


             ADDLIBLE   LIB(SEQUEL)
             MONMSG     MSGID(CPF0000)

             CHGVAR     VAR(&SEL) VALUE('SELECT  DLHONB +
                          COLHDG("CMP"), DLYSNB COLHDG("SCALE" +
                          "ID"), DLCZDT COLHDG("CUT DATE"),DLAQTM +
                          COLHDG("CUT TIME"), DLYZNB COLHDG("SEQ"), +
                          DLYUNB COLHDG("COUNT"), DLYWNB +
                          COLHDG("WEIGHT"), DLYXNB +
                          COLHDG("TATTOO"),DLPWST COLHDG("SHIFT") +
                          FROM  PRKFLIB/PKDLCPP WHERE DLHONB=' *CAT +
                          &COMPX *BCAT 'AND DLCZDT BETWEEN' *BCAT +
                          &FDATEX *BCAT 'AND' *BCAT &TDATEX *BCAT +
                          'AND DLYSNB="' *CAT &SCALE *CAT '"  GROUP +
                          BY DLHONB, DLYSNB, DLCZDT, DLAQTM,DLYZNB, +
                          DLYUNB, DLYWNB, DLYXNB, DLPWST ORDER BY +
                          DLHONB, DLYSNB, DLCZDT, DLAQTM,DLYZNB')
             EXECUTE    SQL(&SEL) MBROPT(*REPLACE) NBRRCDS(*ALL) +
                          KEYFLDCNT(*ALL) ALWNULL(*NO) +
                          TOFLR('GUY.IS') TODOC(&DOCUM) +
                          PCFMT(*DELIMITED) REPLACE(*YES) +
                          TEXT('PRIMAL OPT-PRIMAL SCALE DATA') +
                          OPTIMIZE(*TOTAL) ALWCPY(*YES) MSG(*YES) +
                          UNIQUEKEY(*NONE) IGNDECERR(*NO) +
                          /*------------------------------------*/
   /* PUSH documents to /DOWNLOAD.PORK    */
   /*------------------------------------*/
             CHGVAR VAR(&DOCUMENT) VALUE(&DOCUM)
             CHGVAR VAR(&PCFILE)   VALUE(&DOCUM *TCAT '.CSV')
             CALL PGM(FTPTEST) PARM(&DOCUMENT &PCFILE)


             ENDPGM

