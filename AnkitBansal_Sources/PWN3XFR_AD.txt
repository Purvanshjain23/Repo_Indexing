// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWN3XFR
// ?Date: 14.08.2025 Time: 02:57:09
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modification history
DO;

//? 8/3/2021 JBB SDN619 - Repayments by Business Users
//?                       Function created.  This function verifies if
//?                       the approval sequel can be executed. If the
//?                       current TRD Status is other than Transferred,
//?                       Payment Edit Complete, or Approval already
//?                       executed, then the approval sequel cannot be
//?                       performed.
ENDDO;

EXECUTE FUNCTION(Chk Status for Apprvl RT) TYPE(RTVOBJ) FILE(PWAXCPP)           AB1370367;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.TRH_Repayment_ID);
PARAMETER(PAR.TRD_Payment_Sts);
PARAMETER(PAR.Continue_Process_USR);
{
 //?USER: Initialize routine

 //?Initialize Continue Flag = Yes
 // PAR.Continue Process USR = CND.Yes
 PAR.Continue_Process_USR = 'Y';

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 // PAR.Continue Process USR = CND.No
 PAR.Continue_Process_USR = 'N';

 //?USER: Process Data record

 //?If status is other than Created or Unpaid, do not allow Unpay
 CASE;

 // IF DB1.TRD Repayment Status is Invalid for Approval
 IF DB1.TRD_Repayment_Status = 'C'/'E'/'Q'/'X'/'I'/'R'/'U';

 // PAR.TRD Payment Sts = DB1.TRD Payment Sts
 PAR.TRD_Payment_Sts = DB1.TRD_Payment_Sts;

 // PAR.Continue Process USR = CND.No
 PAR.Continue_Process_USR = 'N';

 QUIT;

 ENDIF;

}


