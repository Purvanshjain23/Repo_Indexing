     H/TITLE Pmt Pre-Repay Edits   PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 01/20/22  Time  : 10:39:00
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPWL3PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Pmt Pre-Repay Edits   PV  Prompt & validate record
      *
     FPWAWCPL0IF  E           K        DISK
      * RTV : Tattoo Repayment Header   Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPWAYCPL3IF  E           K        DISK
      * RSQ : Tattoo Repayment Comment  Co#/Repay ID/Seq# (d)
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKEJCPL2IF  E           K        DISK
      * RSQ : Buy Order Load Weight     Co/BOL
      *
     FPWAYCPL0IF  E           K        DISK                      A
      * UPD : Tattoo Repayment Comment  Update index
      *
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@AYCPAP
      * Tattoo Repayment Comment  Update index
      * Renamed input format fields
     I              AYHONB                          WAHONB
     I              AYCDNZ                          WACDNZ
     I              AYCINZ                          WACINZ
     I              AYHMNB                          WAHMNB
     I              AYBNNB                          WABNNB
     I              AYBONB                          WABONB
     I              AYCVNB                          WACVNB
     I              AYB0DT                          WAB0DT
     I              AYG7T1                          WAG7T1
     I              AYMKSS                          WAMKSS
     I              AYAAVN                          WAAAVN
     I              AYAADT                          WAAADT
     I              AYAMTM                          WAAMTM
     I              AYAJST                          WAAJST
     I              AYAHVN                          WAAHVN
     I              AYAGVN                          WAAGVN
     I              AYABVN                          WAABVN
     I              AYABDT                          WAABDT
     I              AYABTM                          WAABTM
      *
     I@AYCPA6
      * Tattoo Repayment Comment  Co#/Repay ID/Seq# (d)
      * Renamed input format fields
     I              AYHONB                          WBHONB
     I              AYCDNZ                          WBCDNZ
     I              AYCINZ                          WBCINZ
     I              AYHMNB                          WBHMNB
     I              AYBNNB                          WBBNNB
     I              AYBONB                          WBBONB
     I              AYCVNB                          WBCVNB
     I              AYB0DT                          WBB0DT
     I              AYG7T1                          WBG7T1
     I              AYMKSS                          WBMKSS
     I              AYAAVN                          WBAAVN
     I              AYAADT                          WBAADT
     I              AYAMTM                          WBAMTM
     I              AYAJST                          WBAJST
     I              AYAHVN                          WBAHVN
     I              AYAGVN                          WBAGVN
     I              AYABVN                          WBABVN
     I              AYABDT                          WBABDT
     I              AYABTM                          WBABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WCHMNB
     I              AXBNNB                          WCBNNB
     I              AXBONB                          WCBONB
     I              AXCQDT                          WCCQDT
     I              AXABTH                          WCABTH
     I              AXACTH                          WCACTH
     I              AXBPNB                          WCBPNB
     I              AXCSNB                          WCCSNB
     I              AXAUDT                          WCAUDT
     I              AXCMST                          WCCMST
     I              AXAGPR                          WCAGPR
     I              AXATVA                          WCATVA
     I              AXI1ST                          WCI1ST
     I              AXDHNB                          WCDHNB
     I              AXDINB                          WCDINB
     I              AXCNST                          WCCNST
     I              AXGINB                          WCGINB
     I              AXBZDT                          WCBZDT
     I              AXLSNB                          WCLSNB
     I              AXF3TX                          WCF3TX
     I              AXO8ST                          WCO8ST
     I              AXO9ST                          WCO9ST
     I              AXPAST                          WCPAST
     I              AXLDSH                          WCLDSH
     I              AXPBST                          WCPBST
     I              AXPCST                          WCPCST
     I              AXPDST                          WCPDST
     I              AXUWST                          WCUWST
     I              AXUXST                          WCUXST
     I              AXUYST                          WCUYST
     I              AXJKRU                          WCJKRU
     I              AXKEOR                          WCKEOR
     I              AXIOEW                          WCIOEW
     I              AXKJIO                          WCKJIO
     I              AXIOJR                          WCIOJR
     I              AXEIRR                          WCEIRR
     I              AXITMF                          WCITMF
     I              AXODJE                          WCODJE
     I              AXRJIF                          WCRJIF
     I              AXOEJF                          WCOEJF
     I              AXD0DT                          WCD0DT
     I              AXD1DT                          WCD1DT
     I              AXD2DT                          WCD2DT
     I              AXD3DT                          WCD3DT
     I              AXD4DT                          WCD4DT
     I              AXBNCD                          WCBNCD
     I              AXABCD                          WCABCD
     I              AXAECD                          WCAECD
     I              AXAAVN                          WCAAVN
     I              AXAADT                          WCAADT
     I              AXAMTM                          WCAMTM
     I              AXAJST                          WCAJST
     I              AXAHVN                          WCAHVN
     I              AXAGVN                          WCAGVN
     I              AXABVN                          WCABVN
     I              AXABDT                          WCABDT
     I              AXABTM                          WCABTM
      *
     I@EJCPBK
      * Buy Order Load Weight     Co/BOL
      * Renamed input format fields
     I              EJHONB                          WDHONB
     I              EJABCD                          WDABCD
     I              EJAECD                          WDAECD
     I              EJBOMV                          WDBOMV
     I              EJSRST                          WDSRST
     I              EJBOSW                          WDBOSW
     I              EJDQDT                          WDDQDT
     I              EJA2TM                          WDA2TM
     I              EJSSST                          WDSSST
     I              EJSTST                          WDSTST
     I              EJSUST                          WDSUST
     I              EJHMNB                          WDHMNB
     I              EJBNNB                          WDBNNB
     I              EJBONB                          WDBONB
     I              EJAAVN                          WDAAVN
     I              EJAADT                          WDAADT
     I              EJAMTM                          WDAMTM
     I              EJAJST                          WDAJST
     I              EJAHVN                          WDAHVN
     I              EJAGVN                          WDAGVN
     I              EJABVN                          WDABVN
     I              EJABDT                          WDABDT
     I              EJABTM                          WDABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPWAY1    E DSPWAYCPL0
      * UPD : Tattoo Repayment Comment  Update index
      * Renamed input format fields
     I              AYHONB                          WAHONB
     I              AYCDNZ                          WACDNZ
     I              AYCINZ                          WACINZ
     I              AYHMNB                          WAHMNB
     I              AYBNNB                          WABNNB
     I              AYBONB                          WABONB
     I              AYCVNB                          WACVNB
     I              AYB0DT                          WAB0DT
     I              AYG7T1                          WAG7T1
     I              AYMKSS                          WAMKSS
     I              AYAAVN                          WAAAVN
     I              AYAADT                          WAAADT
     I              AYAMTM                          WAAMTM
     I              AYAJST                          WAAJST
     I              AYAHVN                          WAAHVN
     I              AYAGVN                          WAAGVN
     I              AYABVN                          WAABVN
     I              AYABDT                          WAABDT
     I              AYABTM                          WAABTM
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Repayment Detail
      * I : RST CC Company Number
     I                                    P   1   20P1HONB
      * I : RST TRH Repayment ID
     I                                    P   3   50P1CDNZ
      * I : RST BOH Company Number
     I                                    P   6   70P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   8  110P1BNNB
      * I : RST BOL Load Number
     I                                    P  12  140P1BONB
      * I : RST TH Tattoo Number
     I                                    P  15  170P1CVNB
      * I : RST TH Kill Date
     I                                    P  18  210P1B0DT
      * I :  TRD Repayment Status
     I                                       22  22 P1MCSS
      * I :  TRD Pen Head
     I                                    P  23  250P1C1NZ
      * I :  TRD Payment Sts
     I                                       26  27 P1MZSS
      * I :  TRD Process Code
     I                                       28  33 P1TNCD
      * I :  PD Producer Code
     I                                       34  39 P1ABCD
      * I :  PS Site ID
     I                                       40  49 P1NYCD
      * I :  SR Source Code
     I                                       50  52 P1AACD
      * I :  PL Location Code
     I                                       53  58 P1AECD
      * I :  PC Contract Code
     I                                       59  63 P1AKCD
      * I :  PSC Sub-Contract Code
     I                                       64  68 P1ALCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Repay: Edit Select Error'
      * Repay Edit Head Received
     I                                        1   1 ZA0001
      * Message data for 'Repay: Edit Select Error'
      * Repay Edit Head Received
     I                                        1   1 ZA0002
      * Message data for 'Repay: Edit Select Error'
      * Repay Edit Head Received
     I                                        1   1 ZA0003
      * Message data for 'Repay: Edit Select Error'
      * Repay Edit Head Received
     I                                        1   1 ZA0004
      * Message data for 'Repay: Transfer Process'
      * *SFLSEL
     I                                        1   1 ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1CDNZ    PARM           WP0002  50       TRH Repayment I
     C           P1HMNB    PARM           WP0003  30       BOH Company Num
     C           P1BNNB    PARM           WP0004  70       BOH Buy Order N
     C           P1BONB    PARM           WP0005  50       BOL Load Number
     C           P1CVNB    PARM           WP0006  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0007  70       TH Kill Date
     C           P1MCSS    PARM           WP0008  1        TRD Repayment S
     C           P1C1NZ    PARM           WP0009  50       TRD Pen Head
     C           P1MZSS    PARM           WP0010  2        TRD Payment Sts
     C           P1TNCD    PARM           WP0011  6        TRD Process Cod
     C           P1ABCD    PARM           WP0012  6        PD Producer Cod
     C           P1NYCD    PARM           WP0013 10        PS Site ID
     C           P1AACD    PARM           WP0014  3        SR Source Code
     C           P1AECD    PARM           WP0015  6        PL Location Cod
     C           P1AKCD    PARM           WP0016  5        PC Contract Cod
     C           P1ALCD    PARM           WP0017  5        PSC Sub-Contrac
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Validate only 1 edit is selected
     C                     EXSR UASUBR                     Validate only 1
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check restriction within
     C                     EXSR VACKRL
      * Check restriction within
     C                     EXSR VBCKRL
      * Check reference to Producer Site
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Source
     C                     EXSR VDCKRL
      * Check reference to Producer Location
     C                     EXSR VECKRL
      * Check reference to Producer Sub-Contract
     C                     EXSR VFCKRL
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * Process selected edit request
      * CASE: DTL.Repay Edit Head Received is Select
     C           #DHYT1    IFEQ '1'                        *IF
      * Edit Head Received
     C                     EXSR UBSUBR                     Edit Head Recei
     C                     ELSE
      * CASE: DTL.Repay Edit Producer/Loc is Select
     C           #DHZT1    IFEQ '1'                        *IF
      * Edit Producer/Location/Contract/Sub-Contract/Site ID
     C                     EXSR UCSUBR                     Edit Producer/L
     C                     ELSE
      * CASE: DTL.Repay Edit Transfer Tatt is Select
     C           #DH1T1    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DH1T1    ZA0005           Repay Edit Tran
      * Send message 'Repay: Transfer Process'
     C                     MOVEL'PRK1607' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: DTL.Repay Edit WW Bal to Kill is Select
     C           #DH2T1    IFEQ '1'                        *IF
      * Perform Balance to Kill
     C                     EXSR UDSUBR                     Perform Balance
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           #1CGNZ    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #1CENZ    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #1CFNZ    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #1IIDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     Z-ADD*ZERO     #1C1NZ           TRD Pen Head
     C                     MOVEL*BLANK    #1MZSS           TRD Payment Sts
     C                     MOVEL*BLANK    #1TNCD           TRD Process Cod
     C                     MOVEL*BLANK    #1NASS           TRD Trucker Pay
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #1AECD           PL Location Cod
     C                     MOVEL*BLANK    #1AKCD           PC Contract Cod
     C                     MOVEL*BLANK    #1ALCD           PSC Sub-Contrac
     C                     MOVEL*BLANK    #1NYCD           PS Site ID
     C                     MOVEL*BLANK    #1AACD           SR Source Code
     C                     MOVEL*BLANK    #1TOCD           Transfer Site I
     C                     MOVEL*BLANK    #1TPCD           Transfer Subsid
     C                     MOVEL*BLANK    #1INT1           Transfer State
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADDP1CDNZ    #1CDNZ           TRH Repayment I
     C                     MOVEL*BLANK    #1MCSS           TRD Repayment S
     C                     MOVEL*BLANK    #DIWTX           Status Desc USR
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1CGNZ           Transfer Buy Or
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADD*ZERO     #1CENZ           Transfer Buy Or
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #1CFNZ           Transfer Tattoo
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADD*ZERO     #1IIDT           Transfer Kill D
      * Clear external version also
     C                     Z-ADD*ZERO     V1IIDT
     C                     MOVEL*BLANK    #DHYT1           Repay Edit Head
     C                     MOVEL*BLANK    #DHZT1           Repay Edit Prod
     C                     MOVEL*BLANK    #DH1T1           Repay Edit Tran
     C                     MOVEL*BLANK    #DH2T1           Repay Edit WW B
      * Check restriction within
     C                     EXSR VGCKRL
      * Check restriction within
     C                     EXSR VHCKRL
      * USER: Load screen
      * DTL = PAR By name
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     Z-ADDP1CDNZ    #1CDNZ           TRH Repayment I
     C                     MOVELP1MCSS    #1MCSS           TRD Repayment S
     C                     Z-ADDP1C1NZ    #1C1NZ           TRD Pen Head
     C                     MOVELP1MZSS    #1MZSS           TRD Payment Sts
     C                     MOVELP1TNCD    #1TNCD           TRD Process Cod
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVELP1AKCD    #1AKCD           PC Contract Cod
     C                     MOVELP1ALCD    #1ALCD           PSC Sub-Contrac
     C                     MOVELP1NYCD    #1NYCD           PS Site ID
     C                     MOVELP1AACD    #1AACD           SR Source Code
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
     C                     MOVELP1MCSS    #1MCSS           TRD Repayment S
      * Determine Status text
      * CASE: PAR.TRD Repayment Status is Created
     C           P1MCSS    IFEQ 'C'                        *IF
     C                     MOVEL@CN,003   #DIWTX           Status Desc USR
     C                     ELSE
      * CASE: PAR.TRD Repayment Status is Unpaid
     C           P1MCSS    IFEQ 'U'                        *IF
     C                     MOVEL@CN,004   #DIWTX           Status Desc USR
     C                     ELSE
      * CASE: PAR.TRD Repayment Status is Edited
     C           P1MCSS    IFEQ 'E'                        *IF
     C                     MOVEL@CN,005   #DIWTX           Status Desc USR
     C                     ELSE
      * CASE: PAR.TRD Repayment Status is Payment Edit Complete
     C           P1MCSS    IFEQ 'P'                        *IF
     C                     MOVEL@CN,006   #DIWTX           Status Desc USR
     C                     ELSE
      * CASE: PAR.TRD Repayment Status is Payment Edit Error
     C           P1MCSS    IFEQ 'Q'                        *IF
     C                     MOVEL@CN,007   #DIWTX           Status Desc USR
     C                     ELSE
      * CASE: PAR.TRD Repayment Status is Payment Edit Executed
     C           P1MCSS    IFEQ 'X'                        *IF
     C                     MOVEL@CN,008   #DIWTX           Status Desc USR
     C                     ELSE
      * CASE: PAR.TRD Repayment Status is Payment Edit Incomplete
     C           P1MCSS    IFEQ 'I'                        *IF
     C                     MOVEL@CN,009   #DIWTX           Status Desc USR
     C                     ELSE
      * CASE: PAR.TRD Repayment Status is Repaid
     C           P1MCSS    IFEQ 'R'                        *IF
     C                     MOVEL@CN,010   #DIWTX           Status Desc USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      * Convert Transfer Kill Date to display format
      * Convert date
     C           1000000   ADD  #1IIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1IIDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SACRRC    BEGSR
      *================================================================
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       TRC Sequence
     C                     MOVEL*BLANK    WN0002 10        RS User Changed
     C                     Z-ADD*ZERO     WN0003  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0004  60       RS Time Changed
     C                     MOVEL*BLANK    WN0005  1        RS Record Statu
     C                     MOVEL*BLANK    WN0006 10        RS Job
     C                     MOVEL*BLANK    WN0007 10        RS Program
     C                     MOVEL*BLANK    WN0008 10        RS User Added
     C                     Z-ADD*ZERO     WN0009  70       RS Date Added
     C                     Z-ADD*ZERO     WN0010  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPAP
     C                     Z-ADD#1HONB    WAHONB           CC Company Numb
     C                     Z-ADD#1CDNZ    WACDNZ           TRH Repayment I
     C                     Z-ADD#1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WABONB           BOL Load Number
     C                     Z-ADD#1CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WAB0DT           TH Kill Date
     C                     MOVELYL0005    WAG7T1           TRC Comment
     C                     MOVEL'S'       WAMKSS           TRC Comment Typ
      *
      * USER: Processing before Data update
      * Make sure BOH Company Number is populated
      * CASE: PAR.BOH Company Number is *ZERO
     C           #1HMNB    IFEQ 0                          *IF
     C                     Z-ADD#1HONB    WAHMNB           BOH Company Num
     C                     END                             *FI
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
     C                     EXSR SBRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSA    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WACDNZ           TRH Repayment I
     C                     KFLD           WACINZ           TRC Sequence
      * Check for duplicate primary key
     C           KLCRSA    SETLL@AYCPAP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1569' W0RTN   7
      * Send message 'Tattoo Repayment Comme EX'
     C                     MOVEL'PRK1569' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPAP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSB01           CC Company Numb
     C           *LIKE     DEFN WBCDNZ    WQSB02           TRH Repayment I
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           CC Company Numb
     C                     KFLD           WQSB02           TRH Repayment I
      * Setup key
     C                     Z-ADD#1HONB    WQSB01           CC Company Numb
     C                     Z-ADD#1CDNZ    WQSB02           TRH Repayment I
      * Establish starting position
     C           KRSSB     SETLL@AYCPA6                    *
     C           KRSSB     READE@AYCPA6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1568' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WACINZ           TRC Sequence
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBCINZ    ADD  1         WACINZ           TRC Sequence
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@AYCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  50       TRC Sequence
     C                     MOVEL*BLANK    WN0012 10        RS User Changed
     C                     Z-ADD*ZERO     WN0013  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0014  60       RS Time Changed
     C                     MOVEL*BLANK    WN0015  1        RS Record Statu
     C                     MOVEL*BLANK    WN0016 10        RS Job
     C                     MOVEL*BLANK    WN0017 10        RS Program
     C                     MOVEL*BLANK    WN0018 10        RS User Added
     C                     Z-ADD*ZERO     WN0019  70       RS Date Added
     C                     Z-ADD*ZERO     WN0020  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPAP
     C                     Z-ADD#1HONB    WAHONB           CC Company Numb
     C                     Z-ADD#1CDNZ    WACDNZ           TRH Repayment I
     C                     Z-ADD#1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WABONB           BOL Load Number
     C                     Z-ADD#1CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WAB0DT           TH Kill Date
     C                     MOVELYL0005    WAG7T1           TRC Comment
     C                     MOVEL'S'       WAMKSS           TRC Comment Typ
      *
      * USER: Processing before Data update
      * Make sure BOH Company Number is populated
      * CASE: PAR.BOH Company Number is *ZERO
     C           #1HMNB    IFEQ 0                          *IF
     C                     Z-ADD#1HONB    WAHMNB           BOH Company Num
     C                     END                             *FI
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
     C                     EXSR SDRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSC    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WACDNZ           TRH Repayment I
     C                     KFLD           WACINZ           TRC Sequence
      * Check for duplicate primary key
     C           KLCRSC    SETLL@AYCPAP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1569' W0RTN   7
      * Send message 'Tattoo Repayment Comme EX'
     C                     MOVEL'PRK1569' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPAP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSD01           CC Company Numb
     C           *LIKE     DEFN WBCDNZ    WQSD02           TRH Repayment I
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CC Company Numb
     C                     KFLD           WQSD02           TRH Repayment I
      * Setup key
     C                     Z-ADD#1HONB    WQSD01           CC Company Numb
     C                     Z-ADD#1CDNZ    WQSD02           TRH Repayment I
      * Establish starting position
     C           KRSSD     SETLL@AYCPA6                    *
     C           KRSSD     READE@AYCPA6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1568' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WACINZ           TRC Sequence
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBCINZ    ADD  1         WACINZ           TRC Sequence
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@AYCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0021  50       TRC Sequence
     C                     MOVEL*BLANK    WN0022 10        RS User Changed
     C                     Z-ADD*ZERO     WN0023  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0024  60       RS Time Changed
     C                     MOVEL*BLANK    WN0025  1        RS Record Statu
     C                     MOVEL*BLANK    WN0026 10        RS Job
     C                     MOVEL*BLANK    WN0027 10        RS Program
     C                     MOVEL*BLANK    WN0028 10        RS User Added
     C                     Z-ADD*ZERO     WN0029  70       RS Date Added
     C                     Z-ADD*ZERO     WN0030  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPAP
     C                     Z-ADD#1HONB    WAHONB           CC Company Numb
     C                     Z-ADD#1CDNZ    WACDNZ           TRH Repayment I
     C                     Z-ADD#1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WABONB           BOL Load Number
     C                     Z-ADD#1CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WAB0DT           TH Kill Date
     C                     MOVELYL0005    WAG7T1           TRC Comment
     C                     MOVEL'S'       WAMKSS           TRC Comment Typ
      *
      * USER: Processing before Data update
      * Make sure BOH Company Number is populated
      * CASE: PAR.BOH Company Number is *ZERO
     C           #1HMNB    IFEQ 0                          *IF
     C                     Z-ADD#1HONB    WAHMNB           BOH Company Num
     C                     END                             *FI
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
     C                     EXSR SFRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WACDNZ           TRH Repayment I
     C                     KFLD           WACINZ           TRC Sequence
      * Check for duplicate primary key
     C           KLCRSE    SETLL@AYCPAP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1569' W0RTN   7
      * Send message 'Tattoo Repayment Comme EX'
     C                     MOVEL'PRK1569' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPAP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSF01           CC Company Numb
     C           *LIKE     DEFN WBCDNZ    WQSF02           TRH Repayment I
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           CC Company Numb
     C                     KFLD           WQSF02           TRH Repayment I
      * Setup key
     C                     Z-ADD#1HONB    WQSF01           CC Company Numb
     C                     Z-ADD#1CDNZ    WQSF02           TRH Repayment I
      * Establish starting position
     C           KRSSF     SETLL@AYCPA6                    *
     C           KRSSF     READE@AYCPA6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1568' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WACINZ           TRC Sequence
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBCINZ    ADD  1         WACINZ           TRC Sequence
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@AYCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv BOL Movment NumberRT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WCHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WCBONB           BOL Load Number
      * Establish starting position
     C           KRSSG     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           BOL HPS Movemen
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCJKRU    YL0002           BOL HPS Movemen
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHONB    WQSH01           CC Company Numb
     C           *LIKE     DEFN WDBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSH03           BOL Load Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           CC Company Numb
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSH01           CC Company Numb
     C                     Z-ADDP1BNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSH03           BOL Load Number
      * Establish starting position
     C           KRSSH     SETLL@EJCPBK                    *
     C           KRSSH     READE@EJCPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           BOLW Movement N
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBOMV    YL0002           BOLW Movement N
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Validate only 1 edit is selected
      *================================================================
     C                     Z-ADD*ZERO     YL0001           Count USR
      * Check Head Received selected
      * CASE: DTL.Repay Edit Head Received is Select
     C           #DHYT1    IFEQ '1'                        *IF
     C                     ADD  1         YL0001           Count USR
     C                     END                             *FI
      * Check Producer/Location or Site selected
      * CASE: DTL.Repay Edit Producer/Loc is Select
     C           #DHZT1    IFEQ '1'                        *IF
     C                     ADD  1         YL0001           Count USR
     C                     END                             *FI
      * Check Transfer selected
      * CASE: DTL.Repay Edit Transfer Tatt is Select
     C           #DH1T1    IFEQ '1'                        *IF
     C                     ADD  1         YL0001           Count USR
     C                     END                             *FI
      * Check Work With Balance to Kill selected
      * CASE: DTL.Repay Edit WW Bal to Kill is Select
     C           #DH2T1    IFEQ '1'                        *IF
     C                     ADD  1         YL0001           Count USR
     C                     END                             *FI
      * If Count > 1, send error message
      * CASE: LCL.Count USR is Greater than 1
     C           YL0001    IFGT 1                          *IF
      * Send messages for Head Received if selected
      * CASE: DTL.Repay Edit Head Received is Select
     C           #DHYT1    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DHYT1    ZA0001           Repay Edit Head
      * Send message 'Repay: Edit Select Error'
     C                     MOVEL'PRK1587' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Send messages for Producer/Location if selected
      * CASE: DTL.Repay Edit Producer/Loc is Select
     C           #DHZT1    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DHZT1    ZA0002           Repay Edit Prod
      * Send message 'Repay: Edit Select Error'
     C                     MOVEL'PRK1587' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * Send messages for Transfer if selected
      * CASE: DTL.Repay Edit Transfer Tatt is Select
     C           #DH1T1    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DH1T1    ZA0003           Repay Edit Tran
      * Send message 'Repay: Edit Select Error'
     C                     MOVEL'PRK1587' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * Send messages for Work With Balance to Kill if selected
      * CASE: DTL.Repay Edit WW Bal to Kill is Select
     C           #DH2T1    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DH2T1    ZA0004           Repay Edit WW B
      * Send message 'Repay: Edit Select Error'
     C                     MOVEL'PRK1587' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Edit Head Received
      *================================================================
      * RMC change to RST Kill date too
      * Chg Hd Rcvd for Repay EF - Tattoo Detail  * 
     C                     CALL 'PWNBEFR'              90  Chg Hd Rcvd for
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0014  30       BOH Company Num
     C                     PARM #1BNNB    WQ0015  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0016  50       BOL Load Number
     C                     PARM #1CVNB    WQ0017  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0018  70       TH Kill Date
     C                     PARM P1HONB    WQ0019  30       CC Company Numb
     C                     PARM P1CDNZ    WQ0020  50       TRH Repayment I
     C                     PARM P1C1NZ    WQ0021  50       TRD Pen Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNBEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Company = 360, respread the weight
      * CASE: DTL.CC Company Number is SBD Farms of Guymon, Ok
     C           #1HONB    IFEQ 360                        *IF
      * If BOLW Movement# <> 0, call function to respread the weight
      * CASE: LCL.BOLW Movement Number is Entered
     C           YL0002    IFNE *ZERO                      *IF
      * WW Buy Order Load Wt  DF - Buy Order Load Weight  * 
     C                     CALL 'PKPWDFR'              90  WW Buy Order Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0022  30       CC Company Numb
     C                     PARM #1ABCD    WQ0023  6        PD Producer Cod
     C                     PARM #1AECD    WQ0024  6        PL Location Cod
     C                     PARM YL0002    WQ0025  90       BOLW Movement N
     C                     PARM #1BNNB    WQ0026  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0027  50       BOL Load Number
     C                     PARM YL0003    WQ0028 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPWDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Repay: Respread Weight'
     C                     MOVEL'PRK1591' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * WW Bal To Kill-Repay  DF - Tattoo Header  * 
     C                     CALL 'PWNHDFR'              90  WW Bal To Kill-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0029  30       BOH Company Num
     C                     PARM #1BNNB    WQ0030  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0031  50       BOL Load Number
     C                     PARM #1CVNB    WQ0032  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0033  70       TH Kill Date
     C                     PARM #1CDNZ    WQ0034  50       TRH Repayment I
     C           YL0004    PARM *BLANK    WQ0035  1        Bal to Kill Exe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNHDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If repayment record existed and re-balanced
      * CASE: LCL.Bal to Kill Executed Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * Chg Tatt Repay Dtl Sts XF - Tattoo Repayment Detail  * All Edited
     C                     CALL 'PWNQXFR'              90  Chg Tatt Repay
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0036  30       CC Company Numb
     C                     PARM #1CDNZ    WQ0037  50       TRH Repayment I
     C                     PARM #1HMNB    WQ0038  30       BOH Company Num
     C                     PARM #1BNNB    WQ0039  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0040  50       BOL Load Number
     C                     PARM #1CVNB    WQ0041  50       TH Tattoo Numbe
     C                     PARM 'E'       WQ0042  1        TRD Repayment S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  @CN,002:ZQYL0005    P      TRC Comment
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
     C                     EXSR SACRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    #DHYT1           Repay Edit Head
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Edit Producer/Location/Contract/Sub-Contract/Site ID
      *================================================================
      * Chg Prdcr/Loc/Site/CAK PV - Tattoo Repayment Detail  * 
     C                     CALL 'PWNFPVR'              90  Chg Prdcr/Loc/S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0043  30       CC Company Numb
     C                     PARM #1CDNZ    WQ0044  50       TRH Repayment I
     C                     PARM #1HMNB    WQ0045  30       BOH Company Num
     C                     PARM #1BNNB    WQ0046  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0047  50       BOL Load Number
     C                     PARM #1CVNB    WQ0048  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0049  70       TH Kill Date
     C                     PARM #1C1NZ    WQ0050  50       TRD Pen Head
     C                     PARM P1MZSS    WQ0051  2        TRD Payment Sts
     C                     PARM P1TNCD    WQ0052  6        TRD Process Cod
     C                     PARM P1AACD    WQ0053  3        SR Source Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNFPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WW Bal To Kill-Repay  DF - Tattoo Header  * 
     C                     CALL 'PWNHDFR'              90  WW Bal To Kill-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0054  30       BOH Company Num
     C                     PARM #1BNNB    WQ0055  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0056  50       BOL Load Number
     C                     PARM #1CVNB    WQ0057  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0058  70       TH Kill Date
     C                     PARM #1CDNZ    WQ0059  50       TRH Repayment I
     C           YL0004    PARM *BLANK    WQ0060  1        Bal to Kill Exe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNHDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If repayment record existed and re-balanced
      * CASE: LCL.Bal to Kill Executed Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * Chg Tatt Repay Dtl Sts XF - Tattoo Repayment Detail  * All Edited
     C                     CALL 'PWNQXFR'              90  Chg Tatt Repay
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0061  30       CC Company Numb
     C                     PARM #1CDNZ    WQ0062  50       TRH Repayment I
     C                     PARM #1HMNB    WQ0063  30       BOH Company Num
     C                     PARM #1BNNB    WQ0064  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0065  50       BOL Load Number
     C                     PARM #1CVNB    WQ0066  50       TH Tattoo Numbe
     C                     PARM 'E'       WQ0067  1        TRD Repayment S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  @CN,002:ZQYL0005    P      TRC Comment
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
     C                     EXSR SCCRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    #DHZT1           Repay Edit Prod
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Perform Balance to Kill
      *================================================================
      * WW Bal To Kill-Repay  DF - Tattoo Header  * 
     C                     CALL 'PWNHDFR'              90  WW Bal To Kill-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0068  30       BOH Company Num
     C                     PARM #1BNNB    WQ0069  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0070  50       BOL Load Number
     C                     PARM #1CVNB    WQ0071  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0072  70       TH Kill Date
     C                     PARM #1CDNZ    WQ0073  50       TRH Repayment I
     C           YL0004    PARM *BLANK    WQ0074  1        Bal to Kill Exe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNHDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If repayment record existed and re-balanced
      * CASE: LCL.Bal to Kill Executed Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * Chg Tatt Repay Dtl Sts XF - Tattoo Repayment Detail  * All Edited
     C                     CALL 'PWNQXFR'              90  Chg Tatt Repay
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0075  30       CC Company Numb
     C                     PARM #1CDNZ    WQ0076  50       TRH Repayment I
     C                     PARM #1HMNB    WQ0077  30       BOH Company Num
     C                     PARM #1BNNB    WQ0078  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0079  50       BOL Load Number
     C                     PARM #1CVNB    WQ0080  50       TH Tattoo Numbe
     C                     PARM 'E'       WQ0081  1        TRD Repayment S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  @CN,002:ZQYL0005    P      TRC Comment
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
     C                     EXSR SECRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    #DH2T1           Repay Edit WW B
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  6/03/2021 JBB SDD619 - Repayments by Business Users
      *                         Funtion created.  This screen allows the
      *                         business users to select what field needs
      *                         to be edited for the repayment.
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      *
     C           KLVAAW    KLIST
     C                     KFLD           AWHONB           CC Company Numb
     C                     KFLD           AWCDNZ           TRH Repayment I
      * Setup key
     C                     Z-ADD#1HONB    AWHONB
     C                     Z-ADD#1CDNZ    AWCDNZ
     C           KLVAAW    CHAIN@AWCPAQ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Restrictor relation not satisfied
      * Send message 'Tattoo Repayment Heade NF'
     C                     MOVEL'PRK1564' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK1564' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     C           YPMTFD    OREQ '#1CVNB'
     C           YPMTFD    OREQ '#1B0DT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(DTL) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PKB7SRR'              90  Sel Kill/Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0001  30       BOH Company Num
     C           #1CVNB    PARM #1CVNB    WQ0002  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0003  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKB7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1B0DT    IFNE *ZERO                      TH Kill Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBA1    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB
     C                     Z-ADD#1BNNB    A1BNNB
     C                     Z-ADD#1BONB    A1BONB
     C                     Z-ADD#1CVNB    A1CVNB
     C                     Z-ADD#1B0DT    A1B0DT
     C           KLVBA1    CHAIN@A1CPC4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0061' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Producer Site
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1NYCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PS Site ID
     C           YPMTFD    OREQ '#1NYCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1NYCD' defaulted for 'PS Site ID'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *BLANK' defaulted for 'Oms System Value Alpha'.
     C                     CALL 'PLGKSRR'              90  Sel Producer Si
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0004  6        PD Producer Cod
     C           #1NYCD    PARM #1NYCD    WQ0005 10        PS Site ID
     C                     PARM *BLANK    WQ0006 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLGKSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1NYCD    IFNE *BLANK                     PS Site ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1NYCD    IFEQ *BLANK                     PS Site ID
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAT    KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVEL#1ABCD    ATABCD
     C                     MOVEL#1NYCD    ATNYCD
     C           KLVCAT    CHAIN@ATRELM              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Producer Site          NF'
     C                     MOVEL'PRK1137' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK1137' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Source
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AACD    WK1X01  1
     C           WK1X01    IFEQ '?'                        SR Source Code
     C           YPMTFD    OREQ '#1AACD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AACD' defaulted for 'SR Source Code'.
     C                     CALL 'PKDRSRR'              90  Sel Source
     C                     PARM *BLANK    W0RTN   7
     C           #1AACD    PARM #1AACD    WQ0007  3        SR Source Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AACD    IFNE *BLANK                     SR Source Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AACD    IFEQ *BLANK                     SR Source Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAA    KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVEL#1AACD    AAAACD
     C           KLVDAA    CHAIN@AAREAC              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0008  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0009  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AECD    IFEQ *BLANK                     PL Location Cod
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAF    KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    AFABCD
     C                     MOVEL#1AECD    AFAECD
     C           KLVEAF    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Producer Sub-Contract
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AKCD    WK1X01  1
     C                     MOVEL#1ALCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PC Contract Cod
     C           YPMTFD    OREQ '#1AKCD'
     C           WK1X02    OREQ '?'                        PSC Sub-Contrac
     C           YPMTFD    OREQ '#1ALCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AKCD' defaulted for 'PC Contract Code'.
      * Field '(DTL) #1ALCD' defaulted for 'PSC Sub-Contract Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKFFSRR'              90  Sel Sub-Contrac
     C                     PARM *BLANK    W0RTN   7
     C           #1AKCD    PARM #1AKCD    WQ0010  5        PC Contract Cod
     C           #1ALCD    PARM #1ALCD    WQ0011  5        PSC Sub-Contrac
     C                     PARM #1ABCD    WQ0012  6        PD Producer Cod
     C                     PARM #1AECD    WQ0013  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKFFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AKCD    IFNE *BLANK                     PC Contract Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1ALCD    IFNE *BLANK                     PSC Sub-Contrac
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AKCD    IFEQ *BLANK                     PC Contract Cod
     C           #1ALCD    ANDEQ*BLANK                     PSC Sub-Contrac
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFAQ    KLIST
     C                     KFLD           AQAKCD           PC Contract Cod
     C                     KFLD           AQALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVEL#1AKCD    AQAKCD
     C                     MOVEL#1ALCD    AQALCD
     C           KLVFAQ    CHAIN@AQCPA0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      *
     C           KLVGAW    KLIST
     C                     KFLD           AWHONB           CC Company Numb
     C                     KFLD           AWCDNZ           TRH Repayment I
      * Setup key
     C                     Z-ADD#1HONB    AWHONB
     C                     Z-ADD#1CDNZ    AWCDNZ
     C           KLVGAW    CHAIN@AWCPAQ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Restrictor relation not satisfied
      * Send message 'Tattoo Repayment Heade NF'
     C                     MOVEL'PRK1564' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK1564' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     C           YPMTFD    OREQ '#1CVNB'
     C           YPMTFD    OREQ '#1B0DT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(DTL) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PKB7SRR'              90  Sel Kill/Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0082  30       BOH Company Num
     C           #1CVNB    PARM #1CVNB    WQ0083  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0084  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKB7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1B0DT    IFNE *ZERO                      TH Kill Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VH999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVHA1    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB
     C                     Z-ADD#1BNNB    A1BNNB
     C                     Z-ADD#1BONB    A1BONB
     C                     Z-ADD#1CVNB    A1CVNB
     C                     Z-ADD#1B0DT    A1B0DT
     C           KLVHA1    CHAIN@A1CPC4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
     C           VH999     TAG
      * Restrictor relation not satisfied
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0061' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACDNZ           TRH Repayment I
     C                     Z-ADD*ZERO     WACINZ           TRC Sequence
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WCABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WCACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WCBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WCCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WCAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WCAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WCATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WCDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WCDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WCGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WCBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WCLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WCLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WCJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WCKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WCIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WCKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WCIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WCEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WCD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WCD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDBOMV           BOLW Movement N
     C                     Z-ADD*ZERO     WDBOSW           BOLW Scale Weig
     C                     Z-ADD*ZERO     WDDQDT           BOLW Scale Weig
     C                     Z-ADD*ZERO     WDA2TM           BOLW Scale Weig
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field BOLW Movement Number
     C                     Z-ADD*ZERO     YL0002  90
      * Define local work field Oms System Value Alpha
     C                     MOVEL*BLANK    YL0003 40
      * Define local work field Bal to Kill Executed Y/N
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field TRC Comment
     C                     MOVEL*BLANK    YL0005 60
      * Define local work field No Gate Flag
     C                     MOVEL*BLANK    YL0006 40
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modification history
     C                     EXSR UESUBR                     Modification hi
      * This flag is used to determine where the BOLW Movement# value is
      * retrieved from.
      * Rtv Company Values    XF - STR Order Management Sys  * NOGATE
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0085  30       BOH Company Num
     C                     PARM 'NOGATE'  WQ0086 10        Company Value C
     C           YL0006    PARM *BLANK    WQ0087 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Retrieve BOLW Movement Number
      * CASE: LCL.No Gate Flag is Yes
     C           YL0006    IFEQ 'Y'                        *IF
      * Rtv BOL Movment NumberRT - Buy Order Load  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Tattoo Balance/Validation
00002 process executed
00003 Created
00004 Unpaid
00005 Edited
00006 Pymt Edit Complete
00007 Pymt Edit Error
00008 Pymt Edit Executed
00009 Pymt Edit Incomplete
00010 Repaid
