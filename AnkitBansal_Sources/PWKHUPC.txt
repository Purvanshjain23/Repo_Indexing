/*********************************************************************/
/*                                                                   */
/* Program: PWKHUPC                                                  */
/* Author : Brad Baden                                               */
/* Date . :  2/03/2020                                               */
/*                                                                   */
/* Description:                                                      */
/* This program is called from prompt screen PWKG.  It's purpose is  */
/* to generate a Sequel ViewPoint spreadsheet and email it to the    */
/* email address passed into this program.                           */
/*                                                                   */
/*********************************************************************/
/* Modification History                                              */
/* xx/xx/xxxx XXX Exxxxx - xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  */
/*                         xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  */
/*                         xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  */
/*                                                                   */
/*********************************************************************/
             PGM        PARM(&COMP &FDATE &TDATE &EMAIL)

             DCL        VAR(&COMPA)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&COMP)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&FROMMDY)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATEFROM) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FDATE)    TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&TOMDY)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATETO)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&TDATE)    TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&EMAIL)    TYPE(*CHAR) LEN(50)
             DCL        VAR(&TEXT)     TYPE(*CHAR) LEN(200)

/* Convert numeric values to character values for sequel              */
             CHGVAR     VAR(&COMPA)    VALUE(&COMP)
             CHGVAR     VAR(&DATEFROM) VALUE(&FDATE)
             CHGVAR     VAR(&DATETO)   VALUE(&TDATE)

/* Convert dates for message                                          */
             CVTDAT     DATE(&DATEFROM) TOVAR(&FROMMDY) +
                          FROMFMT(*CYMD) TOFMT(*MDYY) TOSEP(/)

             CVTDAT     DATE(&DATETO) TOVAR(&TOMDY) FROMFMT(*CYMD) +
                          TOFMT(*MDYY) TOSEP(/)

             CHGVAR     VAR(&TEXT) VALUE('Co# ' *CAT &COMPA *CAT ' +
                          from ' *CAT &FROMMDY *CAT 'thru ' *CAT +
                          &TOMDY)

/* Execute the Sequel and email the results to the requested address  */
             EXECUTE    VIEW(*LIBL/DLVTRKSPLT) PCFMT(*XLS) +
                          REPLACE(*YES) RECIPIENT(&EMAIL) +
                          EMLMSG(&TEXT) SETVAR((&COMP &COMPA) +
                          (&FDATE &DATEFROM) (&TDATE &DATETO))

             ENDPGM
