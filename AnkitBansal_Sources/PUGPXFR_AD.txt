// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUGPXFR
// ?Date: 14.08.2025 Time: 03:50:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// Execute function EUS Repl SpcChar 2 BlnkUS.
EXECUTE FUNCTION(EUS Repl SpcChar 2 BlnkUS) TYPE(EXCUSRSRC) ('PUGOUFR');
PARAMETER(PAR.String_Text_Old_USR);
PARAMETER(PAR.String_Text_New_USR);
{
 * Scan and Replace Special Characters to Blank.
 d $string_data    s             80a   inz(*blank)
 d $new_string     s             80a   inz(*blank)
 d i               s              3  0
 d char            s              1a
 *
 /free
 $string_data = #II2U1;
 $new_string = #II2U1;
 #OI3U1 = *blank;

 // Read each character in '$string_data' and translate the special charc to a blank.
 for i = 1 to %len($string_data);
 char = %subst($string_data:i:1);
 if char = '*';
 $new_string = %xlate('*' : ' ' : $string_data);
 elseif char = '~';
 $new_string = %xlate('~' : ' ' : $string_data);
 elseif char = '<';
 $new_string = %xlate('<' : ' ' : $string_data);
 elseif char = '>';
 $new_string = %xlate('>' : ' ' : $string_data);
 elseif char = '!';
 $new_string = %xlate('!' : ' ' : $string_data);
 elseif char = '^';
 $new_string = %xlate('^' : ' ' : $string_data);
 endif;
 $string_data = $new_string;
 endfor;

 // S16672 DN 07/02/20-Commented out.
 // #OI3U1 = $new_string;

 // S16672 DN 07/02/20-If $new_string is blank then default to 'xxx'.
 if $new_string = *blank;
 #OI3U1 = 'xxx';
 else;
 #OI3U1 = $new_string;
 endif;

 /end-free
 *
}


