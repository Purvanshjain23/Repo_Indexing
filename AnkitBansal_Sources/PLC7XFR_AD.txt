// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLC7XFR
// ?Date: 14.08.2025 Time: 02:53:48
// ?------------------------------------------------------------------------------------------------

//?Execute user function

CASE;

// IF PAR.PI Scheduled Date is Not entered
IF PAR.PI_Scheduled_Date = 0;

// PAR.PI Scheduled Date = JOB.*Job date
PAR.PI_Scheduled_Date = JOB.*Job_date;

ENDIF;

// LCL.PI Scheduled Hour = CON.*ZERO
LCL.PI_Scheduled_Hour = 00;

// DOW LCL.PI Scheduled Hour is LT 24
DOW LCL.PI_Scheduled_Hour < 24;

// Call program Exc Bld Pen Inventory XF.
CALL PROGRAM(Exc Bld Pen Inventory XF) ('PLCHXFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.PI_Scheduled_Date);
PARAMETER(LCL.PI_Scheduled_Hour);

// LCL.PI Scheduled Hour = LCL.PI Scheduled Hour + CON.01
LCL.PI_Scheduled_Hour = LCL.PI_Scheduled_Hour + 01;

ENDDO;

// LCL.PI Scheduled Hour = CON.*ZERO
LCL.PI_Scheduled_Hour = 00;

// LCL.Date Beg USR = PAR.PI Scheduled Date + CON.-1 *DAYS
LCL.Date_Beg_USR = DATEINCR(PAR.PI_Scheduled_Date '-1' 'DY' 1111111 'NONE' 'N' 1);

// DOW LCL.PI Scheduled Hour is LT 24
DOW LCL.PI_Scheduled_Hour < 24;

// Call program Exc Bld Pen Inventory XF.
CALL PROGRAM(Exc Bld Pen Inventory XF) ('PLCHXFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(LCL.Date_Beg_USR);
PARAMETER(LCL.PI_Scheduled_Hour);

// LCL.PI Scheduled Hour = LCL.PI Scheduled Hour + CON.01
LCL.PI_Scheduled_Hour = LCL.PI_Scheduled_Hour + 01;

ENDDO;

