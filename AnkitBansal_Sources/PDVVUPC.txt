/********************************************************************/
/*  SYNOPSIS -  CALL LOAD CONFIRMATION FAX OR PRINT PROGRAM         */
/*                FROM WW LOADS AND WW ALL LOADS.                   */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - FAX OR PRINT LOAD CONFIRMATION                      */
/*  DATE      - 01/1997                                             */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*     O    &RETURN     - RETURN CODE                               */
/*     B    &COMPNYN    - COMPANY NUMBER 15.5                       */
/*     B    &LOADN      - LOAD NUMBER 15.5                          */
/*     B    &TRANSLDR   - TRANSLOADER FOR EXPORTS                   */
/*     B    &CARRIER    - CARRIER CODE (OVERLAND/TRUCK CARRIER)     */
/*     B    &SHIPPER    - OCEAN/SHIPPER CARRIER CODE                */
/*     B    &MEXCAR     - ADDITIONAL MEXICAN BUYER CARRIER          */
/*     B    &FAXDIS     - FAX DISPATCHER Y/N FLAG                   */
/*     B    &FAXTRN     - FAX TRANSLOADER Y/N FLAG                  */
/*     B    &FAXMEX     - FAX MEXICAN CARRIER Y/N FLAG              */
/*     B    &FAXEXP     - FAX SEABOARD EXPORT COORDINATOR Y/N FLAG  */
/*     B    &FAXSHP     - FAX OCEAN CARRIER Y/N FLAG                */
/*     B    &FAXCAR     - FAX OVERLAND CARRIER Y/N FLAG             */
/*     B    &PRTF       - NAME OF PRINTER FILE TO FAX OR PRINT      */
/*     B    &PRINTFAX   - PRINT ONLY OR FAX FLAG                    */
/*     B    &OUTQ, &HOLD, &SAVE, &COPYN (15.5) - REPORT PARMS       */
/*     B    &EMAIL      - 50 CHAR EMAIL ADDRESS - THIS MAY CONTAIN  */
/*                        MORE THAN ONE EMAIL ADDRESS               */
/********************************************************************/
/* 04/15/11 LJB P000737  REMOVE UNUSED PARMS, ADD EMAIL ADDRESS     */
/*    ADD MULTIPLE CARRIER CODES, ADD MULTIPLE FAX OR PRINT FLAGS,  */
/*    MODIFY REPORTING PARMS.  REPLACE PDA2UPR.                     */
/* MODIFIED:  RMC 5/24/02  ADDED FAX TO DISPATCH OFFICE PARM-&FAXDIS*/
/*    AND FAX TO CARRIER &FAXCAR                                    */
/* C3230:     RMC 10/14/97 CHANGED PROCESSING SO THIS CAN RUN       */
/*    INTERACTIVE.                                                  */
/* NOTE:  IF USER SELECTS A BUNCH OF LOADS, IT MAY BE SLOW          */
/********************************************************************/
 PDVVUPC:    PGM        PARM(&RETURN &COMPNYN &LOADN &TRANSLDR +
                          &CARRIER &SHIPPER &MEXCARR &FAXDIS +
                          &FAXTRN &FAXMEX &FAXEXP &FAXSHP &FAXCAR +
                          &PRTF &PRINTFAX &OUTQ &HOLD &SAVE &COPYN +
                          &EMAIL)
/* PARMS                                                            */
        DCL    &RETURN     *CHAR  (7)            /* Return Code     */
        DCL    &COMPNYN    *DEC                  /* CARRIER CODE    */
        DCL    &COMPANY    *DEC   (3 0)          /* Company Number  */
        DCL    &LOADN      *DEC                  /* LOAD NUMBER     */
        DCL    &LOAD       *DEC   (7 0)          /* FAX TO CARRIER  */
        DCL    &TRANSLDR   *CHAR  (3)            /* FAX TO DISPATCH */
        DCL    &CARRIER    *CHAR  (3)            /* FAX/PRINT FLAG  */
        DCL    &SHIPPER    *CHAR  (3)            /* PRINTER FILE    */
        DCL    &MEXCARR    *CHAR  (3)
        DCL    &FAXDIS     *CHAR  (1)
        DCL    &FAXTRN     *CHAR  (1)            /* Output Queue    */
        DCL    &FAXMEX     *CHAR  (1)            /* Hold Status     */
        DCL    &FAXEXP     *CHAR  (1)            /* Save Status     */
        DCL    &FAXSHP     *CHAR  (1)
        DCL    &FAXCAR     *CHAR  (1)
        DCL    &PRTF       *CHAR  (10)
        DCL    &PRINTFAX   *CHAR  (1)
        DCL    &OUTQ       *CHAR   (10)
        DCL    &HOLD       *CHAR   (4)
        DCL    &SAVE       *CHAR   (4)
        DCL    &COPYN      *DEC
        DCL    &EMAIL      *CHAR  (50)

/*      DCL    &DESC       *CHAR   (25)          /* Pgm Descriptio  */
/*      DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue */
/*      DCL    &NQSTAT     *CHAR   (1)           /* Night Queue STS */
/*      DCL    &PGM        *CHAR   (10)                             */
/*      DCL    &JOBCDE     *CHAR   (10)          /* JOB NAME CODE   */
/*      DCL    &APPLIC     *CHAR   (06)          /* Application Code*/
/*      DCL    &COPY       *DEC    (2 0)         /* Number of copies*/

/* ERROR MESSAGE FIELDS                                             */
        DCL    &MSG        *CHAR   (512)         /* message         */
        DCL    &MSGID      *CHAR   (7)           /* message id      */
        DCL    &MSGL       *DEC    (5 0)

/*   INITIALIZE VARIABLES                                           */
             CHGVAR     VAR(&RETURN) VALUE('       ')

/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                      */
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/********************************************************************/
/* CALL PRINT CL PROGRAM                                            */
/********************************************************************/
/* C3230: CHANGED PROCESSING SO THIS CAN RUN INTERACTIVE            */
/*        NOTE:  IF USER SELECTS A BUNCH OF LOADS, IT MAY BE SLOW   */
/* P000737: PASS REPORT PARMS, PRINTER FILE AND EMAIL               */

 CALL:       CALL       PGM(PDVVPCLP) PARM(&COMPNYN &LOADN &TRANSLDR +
                          &CARRIER &SHIPPER &MEXCARR &FAXDIS +
                          &FAXTRN &FAXMEX &FAXEXP &FAXSHP &FAXCAR +
                          &PRTF &PRINTFAX &OUTQ &HOLD &SAVE &COPYN +
                          &EMAIL)

             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
