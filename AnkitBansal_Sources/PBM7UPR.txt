             PGM
/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - CL PROGRAM TO RUN PRODUCTION SCH PACKAGING           */
/*                  DATA WILL BE SENT VIA SPREAD SHEET              */
/*                  DATA WILL BE CREATED VIA PRODUCTION SCHEDULES   */
/*                  SEQUEL WILL BE USED TO FORMAT INTO SPREAD SHEET */
/*                  THAT WILL BE EMAIL TO USERS FOR THE MORNING RUNS*/
/*                                                                  */
/*  E3113 - PROJECT USED BY THE PURCHASING GROUP BASED ON THE       */
/*  PRODUCTION SCHEDULES.  THIS SHOULD RUN AFTER ALL OF THE         */
/*  PRODUCITON SCHEDULES  ARE DONE IN THE MORNING.                  */
/*     BUT,BUT,BUT DOES NOT REQUIRE THIS.                           */
/*  DATE      -  6/26/2014                                          */
/*                                                                  */
/*  E9064 - Add company 440 processing to this program.  It is      */
/*          still called from IJS job INVNIGPKGU.                   */
/*           3/11/2017  Brad Baden                                  */
/*                                                                  */
/*------------------------------------------------------------------*/

             DCL        VAR(&DATE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&JOBDATE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&JOBDTE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PRDDTFMA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&DATEFRM) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PRDDTTOA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PRDDTTO) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DIST360) TYPE(*CHAR) LEN(50)
             DCL        VAR(&DIST440) TYPE(*CHAR) LEN(50)

             RTVJOBA    USER(&USER) DATE(&JOBDATE)

             CHGVAR     VAR(&DIST360) +
                          VALUE('prksched_pkg_360                  ')

             CHGVAR     VAR(&DIST440) +
                          VALUE('prksched_pkg_440                  ')

/* *****************************************************************/
/* USED THE FOLLOWING ONLY FOR TESTING                       *******/
/* *****************************************************************/
/*           IF         COND(&USER *EQ 'PRKTEST') THEN(DO)         */
/*           CHGVAR     VAR(&DIST) VALUE('prksched_pkg_360TEST   ')*/
/*           ENDDO                                                 */
/*           IF         COND(&USER *EQ 'ISJHIGH') THEN(DO)         */
/*           CHGVAR     VAR(&DIST) VALUE('prksched_pkg_360TEST   ')*/
/*           ENDDO                                                 */
/*           IF         COND(&USER *EQ 'ISSMASO') THEN(DO)         */
/*           CHGVAR     VAR(&DIST) VALUE('prksched_pkg_360TEST   ')*/
/*           ENDDO                                                 */
/* USED THE FOLLOWING ONLY FOR TESTING                       *******/
/* *****************************************************************/

             CVTDAT     DATE(&JOBDATE) TOVAR(&JOBDTE) FROMFMT(*MDY) +
                          TOFMT(*CYMD) TOSEP(*NONE)

/* Retrieve Nxt Production Date from Calendar                       */
             CHGVAR     VAR(&PRDDTFMA) VALUE(&JOBDTE)
             CALL       PGM(PBM8XFR) PARM('' '360' &PRDDTFMA &PRDDTTOA)
             MONMSG     MSGID(CPF0000)

/* Production Packaging Report and Excel Spreadsheet for 360       */
             CHGVAR     VAR(&DATE) VALUE(&JOBDTE)
             CALL       PGM(PBM5UPC) PARM('QPRINT2' '*YES' '*YES' +
                          '01' '360' &DATE &PRDDTTOA 'GP1' +
                          &DIST360)
             MONMSG     MSGID(CPF0000)

/* Production Packaging Report and Excel Spreadsheet for 440       */
             CHGVAR     VAR(&DATE) VALUE(&JOBDTE)
             CALL       PGM(PBM5UPC) PARM('QPRINT2' '*YES' '*YES' +
                          '01' '440' &DATE &PRDDTTOA 'ST1' +
                          &DIST440)
             MONMSG     MSGID(CPF0000)

             ENDPGM
