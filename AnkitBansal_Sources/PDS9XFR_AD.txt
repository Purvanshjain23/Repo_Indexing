// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDS9XFR
// ?Date: 14.08.2025 Time: 03:33:00
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(PRC Process Nite Cr Ck RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1439366;
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(PAR.Parent_Number);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(RTV Order Types        RT) TYPE(RTVOBJ) FILE(OPEXREP)          AC1168350;
 PARAMETER(DB1.Order_Type_Sales);
 PARAMETER(PAR.Order_Type_Description);
 PARAMETER(PAR.Processing_Cycle_Type);
 PARAMETER(PAR.Billing_Activity_Type);
 PARAMETER(PAR.Affect_Inventory_Default);
 PARAMETER(PAR.Affect_Sales_Doll_Default);
 PARAMETER(PAR.Affect_Sales_Pnds_Default);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Billing Type is Invoice and Aff Sales Dollar Default is Yes & Firm Order
 CASE;

 // IF PAR.Billing Activity Type is Invoice
 IF PAR.Billing_Activity_Type = '1';

 // AND PAR.Affect Sales Doll Default is yes
 AND PAR.Affect_Sales_Doll_Default = 'Y';

 // AND DB1.Block Order Flag is Firm Order
 AND DB1.Block_Order_Flag = 'F';

 //?  Credit information retreived for this ship to customer
 EXECUTE FUNCTION(RTV Credit Audit       RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1439533;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(PAR.Customer_Name);
 PARAMETER(PAR.AR_Customer_Number);
 PARAMETER(PAR.Parent_Customer);
 PARAMETER(PAR.Credit_Check_AR_Customer);
 PARAMETER(PAR.Credit_Check_Parent_Cust);
 PARAMETER(PAR.Order_Entry_Hold);
 PARAMETER(WRK.Parent_Credit_Limit);
 PARAMETER(WRK.AR_Credit_Limit);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Select Parent or ALL
 CASE;

 // IF PAR.Parent Number is equal to zero
 IF PAR.Parent_Number = *ZERO;

 // OR PAR.Parent Number EQ PAR.Parent Customer
 OR PAR.Parent_Number = PAR.Parent_Customer;

 //?Get A/R Customer name, credit limit
 EXECUTE FUNCTION(RTV Credit Limits,Name RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1470848;
 PARAMETER(PAR.AR_Customer_Number);
 PARAMETER(PAR.AR_Customer_Name);
 PARAMETER(WRK.Numeric_Field_Not_Needed);
 PARAMETER(WRK.TXT_field_not_needed);
 PARAMETER(WRK.TXT_field_not_needed);
 PARAMETER(WRK.Numeric_Field_Not_Needed);
 PARAMETER(PAR.AR_Credit_Limit);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Get Parent Customer name, credit limit
 EXECUTE FUNCTION(RTV Credit Limits,Name RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1470848;
 PARAMETER(PAR.Parent_Customer);
 PARAMETER(PAR.Customer_Name);
 PARAMETER(WRK.Numeric_Field_Not_Needed);
 PARAMETER(WRK.TXT_field_not_needed);
 PARAMETER(WRK.TXT_field_not_needed);
 PARAMETER(PAR.Parent_Credit_Limit);
 PARAMETER(WRK.Numeric_Field_Not_Needed);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Get Load Status (if any)
 CASE;

 // IF DB1.Load ID EQ WRK.ZERO
 IF DB1.Load_ID = WRK.ZERO;

 // PAR.Load Status = WRK.BLANK
 PAR.Load_Status = WRK.BLANK;

 //?Get Load Status (if any)
 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(RTV Load Status        RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1297640;
 PARAMETER(DB1.Load_ID);
 PARAMETER(PAR.Load_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

 //?Create A/R Orders by Audit File
 EXECUTE FUNCTION(CRT A/R Credit Check   CR) TYPE(CRTOBJ) FILE(PDK9REP)          AC1439370;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Scheduled_Ship_Date);
 PARAMETER(PAR.Parent_Customer);
 PARAMETER(DB1.AR_Customer_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(PAR.Customer_Name);
 PARAMETER(PAR.AR_Customer_Name);
 PARAMETER(DB1.Ship_To_Name);
 PARAMETER(PAR.Credit_Check_AR_Customer);
 PARAMETER(PAR.Credit_Check_Parent_Cust);
 PARAMETER(PAR.AR_Credit_Limit);
 PARAMETER(PAR.Parent_Credit_Limit);
 PARAMETER(PAR.Order_Entry_Hold);
 PARAMETER(DB1.Billing_Activity_Type);
 PARAMETER(DB1.Header_Status);
 PARAMETER(DB1.Header_Status_Last);
 PARAMETER(DB1.Order_Type_Sales);
 PARAMETER(DB1.Order_Value_Total);
 PARAMETER(DB1.Event_Code);
 PARAMETER(DB1.Credit_Hold);
 PARAMETER(DB1.Production_Hold);
 PARAMETER(DB1.Load_ID);
 PARAMETER(PAR.Load_Status);
 ENDIF;

 ENDIF;

}


