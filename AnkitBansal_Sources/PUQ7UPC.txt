/*********************************************************************/
/* PROGRAM : PUQ7UPC                                                 */
/* DESC    : PRT BUYING GROUP INFO CL  EXECUTE USER PROGRAM          */
/* DATE    : 05/18/2020                                              */
/* PROJECT : R16543 - BUYING GROUP INDICATOR FOR OMS                 */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Print Buying Group info. Call SEQUEL to print report as */
/*           an excel & send via ESEND.                              */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/*                                                                   */
/*********************************************************************/

             PGM        PARM(&STATUS &EMAIL)

             DCL        VAR(&STATUS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)

             DCL        VAR(&STS) TYPE(*CHAR) LEN(3)

             DCL        VAR(&RTNLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMLMSG) TYPE(*CHAR) LEN(170)

    /* Format Data */
             CHGVAR     VAR(&STS) VALUE(&STATUS)


/*-------------------------------------------------------------------*/
/* Create Excel Spreadsheet with SEQUEL Viewpoint and email to       */
/* receipient.                                                       */
/*-------------------------------------------------------------------*/

             CHGVAR     VAR(&EMLMSG) VALUE('Buying Group Listing +
                          By Status: BUYINGGRP Export to Excel')

    /* If BUYINGGRP return library not PRKPLIB then set 'TEST' in Email Msg */
             RTVOBJD    OBJ(BUYINGGRP) OBJTYPE(*USRSPC) +
                          RTNLIB(&RTNLIB)
             IF         COND(&RTNLIB *NE 'PRKPLIB') THEN(DO)
             CHGVAR     VAR(&EMLMSG) VALUE(&EMLMSG *BCAT '- TEST')
             ENDDO

    /* Call SEQUEL to Email Report */
             EXECUTE    VIEW(BUYINGGRP) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&EMLMSG) +
                          SETVAR((&STATUS &STS))

 ENDPGM:
             ENDPGM
