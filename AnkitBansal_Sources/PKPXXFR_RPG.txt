     H/TITLE Payment Producer Edit +XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 08/05/21  Time  : 14:34:10
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPKA1CPL5IF  E           K        DISK
      * RSQ : Tattoo Header             Shft/Kill/Err/Tatto
      *
     FPKA1CPO9IF  E           K        DISK
      * RSQ : Tattoo Header           Co/Shf/Kill/Tatt, Sel Comm
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAXCPL4IF  E           K        DISK
      * RSQ : Buy Order Load           Co/Trk/BO/Ld/NtPd/ActOnly
      *
     FPKBAREL0IF  E           K        DISK
      * RTV : Trucker                   Retrieval index
      *
     FPKA1CPNLIF  E           K        DISK
      * RSQ : Tattoo Header             Co/KillDt(D)/Tat/Sel=Unp
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPKC4REL0UF  E           K        DISK
      * UPD : Payment Processing Parms  Update index
      *
      * Long constants
     E                    @CN#    1  31  6   @CN    25
     I@C4REO7
      * Payment Processing Parms  Retrieval index
      * Renamed input format fields
     I              C4HONB                          WAHONB
     I              C4CKDT                          WACKDT
     I              C4M1NB                          WAM1NB
     I              C4KHST                          WAKHST
     I              C4KJST                          WAKJST
     I              C4PINB                          WAPINB
     I              C4KKST                          WAKKST
     I              C4AAVN                          WAAAVN
     I              C4AADT                          WAAADT
     I              C4AMTM                          WAAMTM
     I              C4AJST                          WAAJST
     I              C4AHVN                          WAAHVN
     I              C4AGVN                          WAAGVN
     I              C4ABVN                          WAABVN
     I              C4ABDT                          WAABDT
     I              C4ABTM                          WAABTM
      *
     I@C4REO6
      * Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WBHONB
     I              C4CKDT                          WBCKDT
     I              C4M1NB                          WBM1NB
     I              C4KHST                          WBKHST
     I              C4KJST                          WBKJST
     I              C4PINB                          WBPINB
     I              C4KKST                          WBKKST
     I              C4AAVN                          WBAAVN
     I              C4AADT                          WBAADT
     I              C4AMTM                          WBAMTM
     I              C4AJST                          WBAJST
     I              C4AHVN                          WBAHVN
     I              C4AGVN                          WBAGVN
     I              C4ABVN                          WBABVN
     I              C4ABDT                          WBABDT
     I              C4ABTM                          WBABTM
      *
     I@A1CPHN
      * Tattoo Header             Shft/Kill/Err/Tatto
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@A1CPBE
      * Tattoo Header           Co/Shf/Kill/Tatt, Sel Comm
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WEABCD
     I              ACAGTX                          WEAGTX
     I              ACALNB                          WEALNB
     I              ACAATH                          WEAATH
     I              ACAMNB                          WEAMNB
     I              ACIWST                          WEIWST
     I              ACAPST                          WEAPST
     I              ACGCNB                          WEGCNB
     I              ACGJNB                          WEGJNB
     I              ACC2TX                          WEC2TX
     I              ACAACD                          WEAACD
     I              ACACCD                          WEACCD
     I              ACADCD                          WEADCD
     I              ACAAVN                          WEAAVN
     I              ACAADT                          WEAADT
     I              ACAMTM                          WEAMTM
     I              ACAJST                          WEAJST
     I              ACAHVN                          WEAHVN
     I              ACAGVN                          WEAGVN
     I              ACABVN                          WEABVN
     I              ACABDT                          WEABDT
     I              ACABTM                          WEABTM
      *
     I@AXCPDV
      * Buy Order Load           Co/Trk/BO/Ld/NtPd/ActOnly
      * Renamed input format fields
     I              AXHMNB                          WFHMNB
     I              AXBNNB                          WFBNNB
     I              AXBONB                          WFBONB
     I              AXCQDT                          WFCQDT
     I              AXABTH                          WFABTH
     I              AXACTH                          WFACTH
     I              AXBPNB                          WFBPNB
     I              AXCSNB                          WFCSNB
     I              AXAUDT                          WFAUDT
     I              AXCMST                          WFCMST
     I              AXAGPR                          WFAGPR
     I              AXATVA                          WFATVA
     I              AXI1ST                          WFI1ST
     I              AXDHNB                          WFDHNB
     I              AXDINB                          WFDINB
     I              AXCNST                          WFCNST
     I              AXGINB                          WFGINB
     I              AXBZDT                          WFBZDT
     I              AXLSNB                          WFLSNB
     I              AXF3TX                          WFF3TX
     I              AXO8ST                          WFO8ST
     I              AXO9ST                          WFO9ST
     I              AXPAST                          WFPAST
     I              AXLDSH                          WFLDSH
     I              AXPBST                          WFPBST
     I              AXPCST                          WFPCST
     I              AXPDST                          WFPDST
     I              AXUWST                          WFUWST
     I              AXUXST                          WFUXST
     I              AXUYST                          WFUYST
     I              AXJKRU                          WFJKRU
     I              AXKEOR                          WFKEOR
     I              AXIOEW                          WFIOEW
     I              AXKJIO                          WFKJIO
     I              AXIOJR                          WFIOJR
     I              AXEIRR                          WFEIRR
     I              AXITMF                          WFITMF
     I              AXODJE                          WFODJE
     I              AXRJIF                          WFRJIF
     I              AXOEJF                          WFOEJF
     I              AXD0DT                          WFD0DT
     I              AXD1DT                          WFD1DT
     I              AXD2DT                          WFD2DT
     I              AXD3DT                          WFD3DT
     I              AXD4DT                          WFD4DT
     I              AXBNCD                          WFBNCD
     I              AXABCD                          WFABCD
     I              AXAECD                          WFAECD
     I              AXAAVN                          WFAAVN
     I              AXAADT                          WFAADT
     I              AXAMTM                          WFAMTM
     I              AXAJST                          WFAJST
     I              AXAHVN                          WFAHVN
     I              AXAGVN                          WFAGVN
     I              AXABVN                          WFABVN
     I              AXABDT                          WFABDT
     I              AXABTM                          WFABTM
      *
     I@BAREDS
      * Trucker                   Retrieval index
      * Renamed input format fields
     I              BABNCD                          WGBNCD
     I              BABJTX                          WGBJTX
     I              BAB6ST                          WGB6ST
     I              BAGMNB                          WGGMNB
     I              BAC3TX                          WGC3TX
     I              BAAAVN                          WGAAVN
     I              BAAADT                          WGAADT
     I              BAAMTM                          WGAMTM
     I              BAAJST                          WGAJST
     I              BAAHVN                          WGAHVN
     I              BAAGVN                          WGAGVN
     I              BAABVN                          WGABVN
     I              BAABDT                          WGABDT
     I              BAABTM                          WGABTM
      *
     I@A1CPXX
      * Tattoo Header             Co/KillDt(D)/Tat/Sel=Unp
      * Renamed input format fields
     I              A1HMNB                          WHHMNB
     I              A1BNNB                          WHBNNB
     I              A1BONB                          WHBONB
     I              A1CVNB                          WHCVNB
     I              A1B0DT                          WHB0DT
     I              A1AWDT                          WHAWDT
     I              A1BICD                          WHBICD
     I              A1CPST                          WHCPST
     I              A1ACPR                          WHACPR
     I              A1B9PR                          WHB9PR
     I              A1CAPR                          WHCAPR
     I              A1C4ST                          WHC4ST
     I              A1AIPR                          WHAIPR
     I              A1A6DT                          WHA6DT
     I              A1C2ST                          WHC2ST
     I              A1CXNB                          WHCXNB
     I              A1CWNB                          WHCWNB
     I              A1FCNB                          WHFCNB
     I              A1H9NB                          WHH9NB
     I              A1FDNB                          WHFDNB
     I              A1FENB                          WHFENB
     I              A1HENB                          WHHENB
     I              A1HFNB                          WHHFNB
     I              A1CYNB                          WHCYNB
     I              A1LRNB                          WHLRNB
     I              A1E0NB                          WHE0NB
     I              A1A5PC                          WHA5PC
     I              A1FBNB                          WHFBNB
     I              A1A4PC                          WHA4PC
     I              A1F7NB                          WHF7NB
     I              A1HDNB                          WHHDNB
     I              A1F5NB                          WHF5NB
     I              A1F4NB                          WHF4NB
     I              A1F3NB                          WHF3NB
     I              A1F2NB                          WHF2NB
     I              A1AVPC                          WHAVPC
     I              A1AWPC                          WHAWPC
     I              A1CWPC                          WHCWPC
     I              A1A8PC                          WHA8PC
     I              A1A7PC                          WHA7PC
     I              A1B8PR                          WHB8PR
     I              A1AMPR                          WHAMPR
     I              A1ANPR                          WHANPR
     I              A1AYVA                          WHAYVA
     I              A1AWVA                          WHAWVA
     I              A1AOPR                          WHAOPR
     I              A1AXVA                          WHAXVA
     I              A1APPR                          WHAPPR
     I              A1ASPR                          WHASPR
     I              A1A4VA                          WHA4VA
     I              A1ATPR                          WHATPR
     I              A1A5VA                          WHA5VA
     I              A1CBPR                          WHCBPR
     I              A1CCPR                          WHCCPR
     I              A1LPNB                          WHLPNB
     I              A1CDPR                          WHCDPR
     I              A1A7VA                          WHA7VA
     I              A1A2PR                          WHA2PR
     I              A1JWST                          WHJWST
     I              A1CWST                          WHCWST
     I              A1D7ST                          WHD7ST
     I              A1D8ST                          WHD8ST
     I              A1DWST                          WHDWST
     I              A1D6ST                          WHD6ST
     I              A1GHNB                          WHGHNB
     I              A1BYDT                          WHBYDT
     I              A1E0ST                          WHE0ST
     I              A1E1ST                          WHE1ST
     I              A1E2ST                          WHE2ST
     I              A1BSDT                          WHBSDT
     I              A1BTDT                          WHBTDT
     I              A1BUDT                          WHBUDT
     I              A1HGNB                          WHHGNB
     I              A1HHNB                          WHHHNB
     I              A1HINB                          WHHINB
     I              A1A3PR                          WHA3PR
     I              A1A4PR                          WHA4PR
     I              A1A6PR                          WHA6PR
     I              A1J9NB                          WHJ9NB
     I              A1D6PR                          WHD6PR
     I              A1D7PR                          WHD7PR
     I              A1D8PR                          WHD8PR
     I              A1D9PR                          WHD9PR
     I              A1EAPR                          WHEAPR
     I              A1EBPR                          WHEBPR
     I              A1ECPR                          WHECPR
     I              A1EDPR                          WHEDPR
     I              A1EEPR                          WHEEPR
     I              A1EFPR                          WHEFPR
     I              A1EGPR                          WHEGPR
     I              A1EHPR                          WHEHPR
     I              A1KAST                          WHKAST
     I              A1J7ST                          WHJ7ST
     I              A1J9ST                          WHJ9ST
     I              A1OXNB                          WHOXNB
     I              A1LKST                          WHLKST
     I              A1LLST                          WHLLST
     I              A1J8ST                          WHJ8ST
     I              A1LIST                          WHLIST
     I              A1LJST                          WHLJST
     I              A1NZTX                          WHNZTX
     I              A1HJCD                          WHHJCD
     I              A1R4ST                          WHR4ST
     I              A1R5ST                          WHR5ST
     I              A1R6ST                          WHR6ST
     I              A1R7ST                          WHR7ST
     I              A1THWT                          WHTHWT
     I              A1T2WT                          WHT2WT
     I              A1THHD                          WHTHHD
     I              A1T2HD                          WHT2HD
     I              A1OBPR                          WHOBPR
     I              A1KOER                          WHKOER
     I              A1OPIR                          WHOPIR
     I              A1OPEM                          WHOPEM
     I              A1IORP                          WHIORP
     I              A1OWEO                          WHOWEO
     I              A1OQET                          WHOQET
     I              A1URST                          WHURST
     I              A1USST                          WHUSST
     I              A1HHPC                          WHHHPC
     I              A1S9PR                          WHS9PR
     I              A1TAPR                          WHTAPR
     I              A1TBPR                          WHTBPR
     I              A1JFUR                          WHJFUR
     I              A1KRIF                          WHKRIF
     I              A1KORF                          WHKORF
     I              A1KAPR                          WHKAPR
     I              A1KROT                          WHKROT
     I              A1OTJG                          WHOTJG
     I              A1IRJG                          WHIRJG
     I              A1IMJF                          WHIMJF
     I              A1IRGF                          WHIRGF
     I              A1KRJF                          WHKRJF
     I              A1OJRF                          WHOJRF
     I              A1KFOR                          WHKFOR
     I              A1ORJK                          WHORJK
     I              A1OMVJ                          WHOMVJ
     I              A1MVNF                          WHMVNF
     I              A1MCNF                          WHMCNF
     I              A1NCNF                          WHNCNF
     I              A1NCHF                          WHNCHF
     I              A1IGIR                          WHIGIR
     I              A1KFJR                          WHKFJR
     I              A1EADT                          WHEADT
     I              A1EBDT                          WHEBDT
     I              A1ECDT                          WHECDT
     I              A1EDDT                          WHEDDT
     I              A1EEDT                          WHEEDT
     I              A1U4ST                          WHU4ST
     I              A1U5ST                          WHU5ST
     I              A1U6ST                          WHU6ST
     I              A1U7ST                          WHU7ST
     I              A1U8ST                          WHU8ST
     I              A1U9ST                          WHU9ST
     I              A1VAST                          WHVAST
     I              A1VBST                          WHVBST
     I              A1BDCD                          WHBDCD
     I              A1CSCD                          WHCSCD
     I              A1ABCD                          WHABCD
     I              A1AECD                          WHAECD
     I              A1ACCD                          WHACCD
     I              A1AGCD                          WHAGCD
     I              A1BECD                          WHBECD
     I              A1AAVN                          WHAAVN
     I              A1AADT                          WHAADT
     I              A1AMTM                          WHAMTM
     I              A1AJST                          WHAJST
     I              A1AHVN                          WHAHVN
     I              A1AGVN                          WHAGVN
     I              A1ABVN                          WHABVN
     I              A1ABDT                          WHABDT
     I              A1ABTM                          WHABTM
      *
     I@B4RET4
      * Producer EXT2             Retrieval index
      * Renamed input format fields
     I              B4ABCD                          WIABCD
     I              B4QHCD                          WIQHCD
     I              B4AAVN                          WIAAVN
     I              B4AADT                          WIAADT
     I              B4AMTM                          WIAMTM
     I              B4AJST                          WIAJST
     I              B4AHVN                          WIAHVN
     I              B4AGVN                          WIAGVN
     I              B4ABVN                          WIABVN
     I              B4ABDT                          WIABDT
     I              B4ABTM                          WIABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKC41    E DSPKC4REL0
      * UPD : Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WBHONB
     I              C4CKDT                          WBCKDT
     I              C4M1NB                          WBM1NB
     I              C4KHST                          WBKHST
     I              C4KJST                          WBKJST
     I              C4PINB                          WBPINB
     I              C4KKST                          WBKKST
     I              C4AAVN                          WBAAVN
     I              C4AADT                          WBAADT
     I              C4AMTM                          WBAMTM
     I              C4AJST                          WBAJST
     I              C4AHVN                          WBAHVN
     I              C4AGVN                          WBAGVN
     I              C4ABVN                          WBABVN
     I              C4ABDT                          WBABDT
     I              C4ABTM                          WBABTM
      *
     IYARDCS      DS                             72
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                             72
     IYCRDCS      DS                             72
     IYDRDCS      DS                             72
      * Outward parameters
     IPARC        DS                             12
      * KEY : Buy Order Load           Co/Trk/BO/Ld/NtPd/ActOnly
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : Buy Order Load           Co/Trk/BO/Ld/NtPd/ActOnly
      * I : RST BOH Company Number
     I                                    P   1   20PBHMNB
      *
     IYERDCS      DS                             72
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Tattoo Header             Co/kD/SRT/Pt/Tto *all*
      * I : RST BOH Company Number
     I                                    P   1   20PCHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PCB0DT
      *
      * Outward parameters
     IPDRC        DS                             11
      * KEY : Tattoo Header             Co/kD/SRT/Pt/Tto *all*
      * I : RST BOH Company Number
     I                                    P   1   20PDHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PDB0DT
      *
      * Outward parameters
     IPERC        DS                             21
      * KEY : Tattoo Header             Co/Prd/Loc/KlDte/Tto/Unp
      * I : RST BOH Company Number
     I                                    P   1   20PEHMNB
      * I : MAP TH Kill Date
     I                                    P  15  180PEB0DT
      *
      * Outward parameters
     IPFRC        DS                             22
      * KEY : Tattoo Header             Co/Prd/Bol/Tto, Unpd Com
      * I : RST BOH Company Number
     I                                    P   1   20PFHMNB
      * I : MAP TH Kill Date
     I                                    P  16  190PFB0DT
      *
     IYFRDCS      DS                             72
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Payment Processing Parms
      * I :  CC Company Number
     I                                    P   1   20P1HONB
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'SBD NPPC Warning'
      * CC Company Number
     I                                    P   1   20ZA0001
      * Message data for 'SND Alpha Pager Msg'
      * Pager Name USR
     I                                        1  10 ZA0002
      * Pager Msg USR
     I                                       11  90 ZA0003
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P2EVTX    PARM           WP0002 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Payment Producer Edit +XF
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Rtv Payment Processing RT - Payment Processing Parms  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUC3CD           Company Number
     C                     MOVELP1HONB    WUC3CD           Company Number
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Validate if Market Price exist for calculating NPPC for Seaboard.
     C                     EXSR UBSUBR                     Validate if Mar
      * Step 1: Validate if all Tattoo's are balanced.
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 1
     C           WUM1NB    IFLE 00001                      *IF
      * E15076 JJH 06/04/19 - Send Error Messages to PRKDEVxxx
      * Rtv User Class        UP - STR Miscellaneous  * 
     C                     CALL 'PKU3UPR'              90  Rtv User Class
     C           YL0003    PARM YL0003    WQ0009 10        User Class f/us
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKU3UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Determine Company Value Code to use for Error Distribution List
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     MOVEL@CN,002   YL0004           Company Value C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,003   YL0004           Company Value C
     C                     END                             *FI
      * Rtv Company Values    XF - STR Order Management Sys  * HPEPRKERR*
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0010  30       BOH Company Num
     C                     PARM YL0004    WQ0011 10        Company Value C
     C           YL0005    PARM *BLANK    WQ0012 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Step 1  Validate that job may continue - Current Payment Date
     C                     EXSR UCSUBR                     Step 1  Validat
      * Test for return code equal to blank, if not do not continue job
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
     C                     GOTO AAEXIT                     *QUIT
     C                     END                             *FI
      * Step 1  Validate that job may continue - Held Over
     C                     EXSR UDSUBR                     Step 1  Validat
      * Test for return code equal to blank, if not do not continue job
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
     C                     GOTO AAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Step 2 Create Carcass Detail Shell from Evaluation transaction
      * Update the Tattoo header for payment processed code, and R re-cal
      * Held over's are checked to see if they have been completed
      * If this needs to be rerun call IS Department to reset step to 1.
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 2
     C           WUM1NB    IFLE 00002                      *IF
      * Step 2 Create Carcass Records and Flag Tattoo Header for Payments
     C                     EXSR UESUBR                     Step 2 Create C
     C                     END                             *FI
      * Step 3 Create Freight Allocation, D/A's and Net Pay
      * This step may be rerun as many time as need through and including
      *           Step 5.
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 5
     C           WUM1NB    IFLE 00005                      *IF
      * Step 3 Carcass Merit Pgm, Frt Allocation, D/A and Net
     C                     EXSR UFSUBR                     Step 3 Carcass
     C                     END                             *FI
      * Step 4 Trucker Posting , This will process only Truckers that
      * have not been paid.  This print file program will also create the
      * vouchers, and update the buy order load as being paid.
      * After this has been printed only new buy order loads will appear
      * if freight was added after this run.
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 5
     C           WUM1NB    IFLE 00005                      *IF
     C                     MOVEL'N'       WUIYSS           PP Trucker Erro
      * Step 4  Trucker Posting/Create Trucker Vouchers
     C                     EXSR UGSUBR                     Step 4  Trucker
     C                     END                             *FI
      * Step 5 Producer Payment Edit
      * Step 5 : Pre-check Edit, prm purch journal, prt paym edit, comm e
      * CASE: WRK.Pmt Current Payment Step is 00005 Payment Listing
     C           WUM1NB    IFEQ 00005                      *IF
      * Step 5  Payment edits and pre edits  ** Edit **
     C                     EXSR UHSUBR                     Step 5  Payment
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WUM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    WUKHST           PP Commission P
     C                     MOVEL*BLANK    WUKJST           PP Payment Erro
     C                     Z-ADD*ZERO     WUPINB           PP Unused Nbr 1
     C                     MOVEL*BLANK    WUKKST           PP Repayment St
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACKDT    WUCKDT           Pmt Current Pay
     C                     Z-ADDWAM1NB    WUM1NB           Pmt Current Pay
     C                     MOVELWAKHST    WUKHST           PP Commission P
     C                     MOVELWAKJST    WUKJST           PP Payment Erro
     C                     Z-ADDWAPINB    WUPINB           PP Unused Nbr 1
     C                     MOVELWAKKST    WUKKST           PP Repayment St
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0004 10        RS User Changed
     C                     Z-ADD*ZERO     WN0005  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0006  60       RS Time Changed
     C                     MOVEL*BLANK    WN0007  1        RS Record Statu
     C                     MOVEL*BLANK    WN0008 10        RS Job
     C                     MOVEL*BLANK    WN0009 10        RS Program
     C                     MOVEL*BLANK    WN0010 10        RS User Added
     C                     Z-ADD*ZERO     WN0011  70       RS Date Added
     C                     Z-ADD*ZERO     WN0012  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0004           RS User Changed
     C                     Z-ADD##JDT     WN0005           RS Date Changed
     C                     Z-ADD##JTM     WN0006           RS Time Changed
     C                     MOVEL##JOB     WN0008           RS Job
     C                     MOVEL##PGM     WN0009           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSB    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YARDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSC02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSC03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSC04           TH Kill Balanci
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           TH Schedule Kil
     C                     KFLD           WQSC03           TH Kill Date
     C                     KFLD           WQSC04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSC01           BOH Company Num
     C                     MOVEL'1'       WQSC02           TH Schedule Kil
     C                     Z-ADDWUCKDT    WQSC03           TH Kill Date
     C                     MOVELWUDWST    WQSC04           TH Kill Balanci
      * Establish starting position
     C           KRSSC     SETLL@A1CPHN                    *
     C           KRSSC     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSD02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSD03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSD04           TH Kill Balanci
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           TH Schedule Kil
     C                     KFLD           WQSD03           TH Kill Date
     C                     KFLD           WQSD04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSD01           BOH Company Num
     C                     MOVEL'1'       WQSD02           TH Schedule Kil
     C                     Z-ADDWUCKDT    WQSD03           TH Kill Date
     C                     MOVELWUDWST    WQSD04           TH Kill Balanci
      * Establish starting position
     C           KRSSD     SETLL@A1CPHN                    *
     C           KRSSD     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Chk For Comm Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WDLIST    WQSE02           TH Schedule Kil
     C           *LIKE     DEFN WDB0DT    WQSE03           TH Kill Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           TH Schedule Kil
     C                     KFLD           WQSE03           TH Kill Date
      * Setup key
     C                     Z-ADDP1HONB    WQSE01           BOH Company Num
     C                     MOVEL'1'       WQSE02           TH Schedule Kil
     C                     Z-ADDWUCKDT    WQSE03           TH Kill Date
      * Establish starting position
     C           KRSSE     SETLL@A1CPBE                    *
     C           KRSSE     READE@A1CPBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Commission Prdcr   RT - Producer  * 
     C                     EXSR SFRVGN
      * CASE: WRK.Commission Producer Payee is Blank
     C           WUADCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@A1CPBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Commission Prdcr   RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEABCD           PD Producer Cod
      * Setup key
     C                     MOVELWDABCD    WEABCD           PD Producer Cod
      * Establish starting position
     C           KRSSF     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUADCD           Commission Prod
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEADCD    WUADCD           Commission Prod
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSG02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSG03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSG04           TH Kill Balanci
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           TH Schedule Kil
     C                     KFLD           WQSG03           TH Kill Date
     C                     KFLD           WQSG04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSG01           BOH Company Num
     C                     MOVEL'2'       WQSG02           TH Schedule Kil
     C                     Z-ADDWUCKDT    WQSG03           TH Kill Date
     C                     MOVELWUDWST    WQSG04           TH Kill Balanci
      * Establish starting position
     C           KRSSG     SETLL@A1CPHN                    *
     C           KRSSG     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSH02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSH03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSH04           TH Kill Balanci
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           TH Schedule Kil
     C                     KFLD           WQSH03           TH Kill Date
     C                     KFLD           WQSH04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSH01           BOH Company Num
     C                     MOVEL'2'       WQSH02           TH Schedule Kil
     C                     Z-ADDWUCKDT    WQSH03           TH Kill Date
     C                     MOVELWUDWST    WQSH04           TH Kill Balanci
      * Establish starting position
     C           KRSSH     SETLL@A1CPHN                    *
     C           KRSSH     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Chk For Comm Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WDLIST    WQSI02           TH Schedule Kil
     C           *LIKE     DEFN WDB0DT    WQSI03           TH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           TH Schedule Kil
     C                     KFLD           WQSI03           TH Kill Date
      * Setup key
     C                     Z-ADDP1HONB    WQSI01           BOH Company Num
     C                     MOVEL'2'       WQSI02           TH Schedule Kil
     C                     Z-ADDWUCKDT    WQSI03           TH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@A1CPBE                    *
     C           KRSSI     READE@A1CPBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Commission Prdcr   RT - Producer  * 
     C                     EXSR SJRVGN
      * CASE: WRK.Commission Producer Payee is Blank
     C           WUADCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@A1CPBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Commission Prdcr   RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WEABCD           PD Producer Cod
      * Setup key
     C                     MOVELWDABCD    WEABCD           PD Producer Cod
      * Establish starting position
     C           KRSSJ     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUADCD           Commission Prod
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEADCD    WUADCD           Commission Prod
     C                     GOTO SJEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSK02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSK03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSK04           TH Kill Balanci
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           TH Schedule Kil
     C                     KFLD           WQSK03           TH Kill Date
     C                     KFLD           WQSK04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSK01           BOH Company Num
     C                     MOVEL'1'       WQSK02           TH Schedule Kil
     C                     Z-ADDYL0011    WQSK03           TH Kill Date
     C                     MOVELWUDWST    WQSK04           TH Kill Balanci
      * Establish starting position
     C           KRSSK     SETLL@A1CPHN                    *
     C           KRSSK     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSK     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSL02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSL03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSL04           TH Kill Balanci
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           TH Schedule Kil
     C                     KFLD           WQSL03           TH Kill Date
     C                     KFLD           WQSL04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSL01           BOH Company Num
     C                     MOVEL'1'       WQSL02           TH Schedule Kil
     C                     Z-ADDYL0011    WQSL03           TH Kill Date
     C                     MOVELWUDWST    WQSL04           TH Kill Balanci
      * Establish starting position
     C           KRSSL     SETLL@A1CPHN                    *
     C           KRSSL     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSM02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSM03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSM04           TH Kill Balanci
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           TH Schedule Kil
     C                     KFLD           WQSM03           TH Kill Date
     C                     KFLD           WQSM04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSM01           BOH Company Num
     C                     MOVEL'2'       WQSM02           TH Schedule Kil
     C                     Z-ADDYL0011    WQSM03           TH Kill Date
     C                     MOVELWUDWST    WQSM04           TH Kill Balanci
      * Establish starting position
     C           KRSSM     SETLL@A1CPHN                    *
     C           KRSSM     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * PayEdt Chk For Errors RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WCLIST    WQSN02           TH Schedule Kil
     C           *LIKE     DEFN WCB0DT    WQSN03           TH Kill Date
     C           *LIKE     DEFN WCDWST    WQSN04           TH Kill Balanci
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           TH Schedule Kil
     C                     KFLD           WQSN03           TH Kill Date
     C                     KFLD           WQSN04           TH Kill Balanci
      * Setup key
     C                     Z-ADDP1HONB    WQSN01           BOH Company Num
     C                     MOVEL'2'       WQSN02           TH Schedule Kil
     C                     Z-ADDYL0011    WQSN03           TH Kill Date
     C                     MOVELWUDWST    WQSN04           TH Kill Balanci
      * Establish starting position
     C           KRSSN     SETLL@A1CPHN                    *
     C           KRSSN     READE@A1CPHN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * Check for Market or Subject if so record should be in balance
      * CASE: Only on Market or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WCLLST    IFEQ 'M'                        *IF
     C           WCLLST    OREQ 'S'                        *OR
      * Current Kill Date Validation
      * CASE: PAR.Date Type USR is Current Kill Date
     C           YL0006    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCH9NB    IFGT 0                          *IF
     C           WCBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Previous Kill Date Validation
      * CASE: PAR.Date Type USR is Previous Kill Date
     C           YL0006    IFEQ 'P'                        *IF
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     MOVEL*BLANK    YL0007           Buy Order Numbe
     C                     MOVELWCBNNB    YL0007           Buy Order Numbe
     C                     MOVEL*BLANK    YL0008           Load Number Alp
     C                     MOVELWCBONB    YL0008           Load Number Alp
     C                     MOVEL*BLANK    YL0009           Tattoo Number A
     C                     MOVELWCCVNB    YL0009           Tattoo Number A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Hog Class Type is Resale
     C           WCLLST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@A1CPHN                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0014 10        RS User Changed
     C                     Z-ADD*ZERO     WN0015  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0016  60       RS Time Changed
     C                     MOVEL*BLANK    WN0017  1        RS Record Statu
     C                     MOVEL*BLANK    WN0018 10        RS Job
     C                     MOVEL*BLANK    WN0019 10        RS Program
     C                     MOVEL*BLANK    WN0020 10        RS User Added
     C                     Z-ADD*ZERO     WN0021  70       RS Date Added
     C                     Z-ADD*ZERO     WN0022  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0014           RS User Changed
     C                     Z-ADD##JDT     WN0015           RS Date Changed
     C                     Z-ADD##JTM     WN0016           RS Time Changed
     C                     MOVEL##JOB     WN0018           RS Job
     C                     MOVEL##PGM     WN0019           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSO    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSO    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YBRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0023  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0024 10        RS User Changed
     C                     Z-ADD*ZERO     WN0025  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0026  60       RS Time Changed
     C                     MOVEL*BLANK    WN0027  1        RS Record Statu
     C                     MOVEL*BLANK    WN0028 10        RS Job
     C                     MOVEL*BLANK    WN0029 10        RS Program
     C                     MOVEL*BLANK    WN0030 10        RS User Added
     C                     Z-ADD*ZERO     WN0031  70       RS Date Added
     C                     Z-ADD*ZERO     WN0032  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0024           RS User Changed
     C                     Z-ADD##JDT     WN0025           RS Date Changed
     C                     Z-ADD##JTM     WN0026           RS Time Changed
     C                     MOVEL##JOB     WN0028           RS Job
     C                     MOVEL##PGM     WN0029           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSP    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSP    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YCRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0033  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0034 10        RS User Changed
     C                     Z-ADD*ZERO     WN0035  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0036  60       RS Time Changed
     C                     MOVEL*BLANK    WN0037  1        RS Record Statu
     C                     MOVEL*BLANK    WN0038 10        RS Job
     C                     MOVEL*BLANK    WN0039 10        RS Program
     C                     MOVEL*BLANK    WN0040 10        RS User Added
     C                     Z-ADD*ZERO     WN0041  70       RS Date Added
     C                     Z-ADD*ZERO     WN0042  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0034           RS User Changed
     C                     Z-ADD##JDT     WN0035           RS Date Changed
     C                     Z-ADD##JTM     WN0036           RS Time Changed
     C                     MOVEL##JOB     WN0038           RS Job
     C                     MOVEL##PGM     WN0039           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSQ    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YDRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Val Trucker M3/E1 Vnd RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * SDN440 RMC 5/20/21  if E1 is live , validate VND
     C                     MOVEL'N'       WUIYSS           PP Trucker Erro
      * get live with M3
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0074  30       BOH Company Num
     C                     PARM 'M3LIVE'  WQ0075 10        Company Value C
     C           WUG4SS    PARM *BLANK    WQ0076 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0077  30       BOH Company Num
     C                     PARM 'E1LIVE'  WQ0078 10        Company Value C
     C           WUMESS    PARM *BLANK    WQ0079 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSR01           BOH Company Num
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HONB    WQSR01           BOH Company Num
      * Establish starting position
     C           KRSSR     SETLL@AXCPDV                    *
     C           KRSSR     READE@AXCPDV                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOL Kill Date LE PAR.Pmt Current Payment Date
     C           WFCQDT    IFLE WUCKDT                     *IF
      * Rtv Trucker Vnd Add#M3RT - Trucker  * 
     C                     EXSR SSRVGN
      * Check for  M3
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.TRK M3 Supplier Id is Not Entered
      *   |- c2    : WRK.Live with M3   USR is Live or Parallel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0016    IFEQ *BLANK                     *IF
     C           WUG4SS    IFEQ 'P'                        *IF
     C           WUG4SS    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       WUIYSS           PP Trucker Erro
     C                     END                             *FI
      * Check E1 Vendor -- added for SDN440
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.TRK VND Address Number is Zero
      *   |- c2    : WRK.Live with E1 is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 0                          *IF
     C           WUMESS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       WUIYSS           PP Trucker Erro
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSR     READE@AXCPDV                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Trucker Vnd Add#M3RT - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WGBNCD           TRK Trucker Cod
      * Setup key
     C                     MOVELWFBNCD    WGBNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSS     CHAIN@BAREDS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0079' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0015           TRK VND Address
     C                     MOVEL*BLANK    YL0016           TRK M3 Supplier
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGGMNB    YL0015           TRK VND Address
     C                     MOVELWGC3TX    YL0016           TRK M3 Supplier
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0043  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0044 10        RS User Changed
     C                     Z-ADD*ZERO     WN0045  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0046  60       RS Time Changed
     C                     MOVEL*BLANK    WN0047  1        RS Record Statu
     C                     MOVEL*BLANK    WN0048 10        RS Job
     C                     MOVEL*BLANK    WN0049 10        RS Program
     C                     MOVEL*BLANK    WN0050 10        RS User Added
     C                     Z-ADD*ZERO     WN0051  70       RS Date Added
     C                     Z-ADD*ZERO     WN0052  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0044           RS User Changed
     C                     Z-ADD##JDT     WN0045           RS Date Changed
     C                     Z-ADD##JTM     WN0046           RS Time Changed
     C                     MOVEL##JOB     WN0048           RS Job
     C                     MOVEL##PGM     WN0049           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHST    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHST    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YERDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Val Producer M3/E1 Vnd RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Initialize Errros
     C                     MOVEL'N'       WUIZSS           PP Producer Err
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSU01           BOH Company Num
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           BOH Company Num
     C                     KFLD           WHB0DT           TH Kill Date
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HONB    WQSU01           BOH Company Num
     C                     Z-ADDWUCKDT    WHB0DT           TH Kill Date
      * Establish starting position
     C           KPSSU     SETLL@A1CPXX                    *
     C           KRSSU     READE@A1CPXX                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHHMNB    WQ0085  30       BOH Company Num
     C                     PARM 'M3LIVE'  WQ0086 10        Company Value C
     C           YL0017    PARM *BLANK    WQ0087 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHHMNB    WQ0088  30       BOH Company Num
     C                     PARM 'E1LIVE'  WQ0089 10        Company Value C
     C           YL0018    PARM *BLANK    WQ0090 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Get Producer M3 Supplier ID
      * Rtv Prdcr Vendor#,M3  RT - Producer  * 
     C                     EXSR SVRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.M3 Supplier ID is Not found
      *   |- c2    : LCL.Live with M3   USR is Live or Parallel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0020    IFEQ *BLANK                     *IF
     C           YL0017    IFEQ 'P'                        *IF
     C           YL0017    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       WUIZSS           PP Producer Err
     C                     END                             *FI
      * SDN 440 -- added for E1
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Live with E1 is Yes
      *   |- c2    : LCL.PD VND Address Number is Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0018    IFEQ 'Y'                        *IF
     C           YL0019    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       WUIZSS           PP Producer Err
     C                     END                             *FI
     C           KRSSU     READE@A1CPXX                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,M3  RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WEABCD           PD Producer Cod
      * Setup key
     C                     MOVELWHABCD    WEABCD           PD Producer Cod
      * Establish starting position
     C           KRSSV     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0019           PD VND Address
     C                     MOVEL*BLANK    YL0020           M3 Supplier ID
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEGCNB    YL0019           PD VND Address
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR SWRVGN
     C                     GOTO SVEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WIABCD           PD Producer Cod
      * Setup key
     C                     MOVELWEABCD    WIABCD           PD Producer Cod
      * Establish starting position
     C           KRSSW     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0020           M3 Supplier ID
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIQHCD    YL0020           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0053  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0054 10        RS User Changed
     C                     Z-ADD*ZERO     WN0055  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0056  60       RS Time Changed
     C                     MOVEL*BLANK    WN0057  1        RS Record Statu
     C                     MOVEL*BLANK    WN0058 10        RS Job
     C                     MOVEL*BLANK    WN0059 10        RS Program
     C                     MOVEL*BLANK    WN0060 10        RS User Added
     C                     Z-ADD*ZERO     WN0061  70       RS Date Added
     C                     Z-ADD*ZERO     WN0062  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0054           RS User Changed
     C                     Z-ADD##JDT     WN0055           RS Date Changed
     C                     Z-ADD##JTM     WN0056           RS Time Changed
     C                     MOVEL##JOB     WN0058           RS Job
     C                     MOVEL##PGM     WN0059           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSX    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSX    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YFRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKLST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * RMC 5/20/21 SDN440 E1 -- Check TRK and PD Vnd Addresses for zero
      * 11/04/20 ISE H16853-Recompiled due to change in Buy Order Number
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * - Send Payment Edit Balancing Error messages to ESEND Distributio
      *   List instead of using Halcyon.
      * E15076 JJH 06/04/19 - Send Error Messages to PRKDEVxxx
      * - 360 use HALCYON Broadcast Group PRKDEV360, Test PRKDEV360T
      * - 440 use HALCYON Broadcast Group PRKDEV440, Test PRKDEV440T
      * - 960 use HALCYON Broadcast Group PRKDEV960, Test PRKDEV960T
      * - 961 use HALCYON Broadcast Group PRKDEV960, Test PRKDEV960T
      * E14821 JBB 1/09/2019 - Print Payment Errors Report
      * - Added new function that checks for Pricing Errors in step 5.
      * - If pricing errors found, print Pricing Errors report.
      * E13016 JJH 05/03/18 - Update BOL Live Wgt Received
      * - These modifcations are occurring in Step 2
      * - This is a new program that will be ran at the end of Step 2 in
      *   in the Producer Payment Edit.
      * - This function will sum up the TH Live Weight for Market Hogs an
      *   populate this into the BOL Live Wgt Received.
      * - Company Value HPEBOLLVWT is Company specific, and initially thi
      *   program will only update 440.
      * - Compnay Value HPEBOLLVSC is Source Code specific, and initially
      *   we will only be updating Source Code = SO.
      * - This program is being ran so that the Freight Allocation which
      *   occurs in Step 3 of the Producer Payment Edit will be able to
      *   correctly allocate the Freight Amount if their are multiple
      *   Tattoo, like a Hold Over.
      * E12054 JJH 11/10/17 - Producer Payment Messages
      * - Include the Buy Order, Load, and Tattoo on the MPLUS messages
      *   that are generated during the Edit Payment.
      * - Output parms from: PayEdt Chk For Errors RT - Tattoo Header
      * - Messages are in Step 1: Validate if all Tattoo's are balanced.
      * E9904 JBB 09/06/17 - TF2 Push Payment Processing
      * - After the SNDPGR call, reset PGM.*Return Code to Record Found.
      * E9904 JBB 08/14/17 - TF2 Push Payment Processing
      * - Send email to user running the payment edit.  Uncomment the
      *   SNDPGR calls and pass in user ID.
      * E7519 JJH 06/26/17 - M3Supplier/Producer/Trk/Loc
      * - Step 4  Trucker Posting/Create Trucker Vouchers
      *   - Determine if there are any Truckers with a missing M3 Supplie
      *   - If no Truckers with missing M3 Supplier, do not print the Prt
      *     Trucker Validation Error's report (PWBJPFR).
      * - Step 5 Producer Payment Edi
      *   - Determine if there are any Producers with a missing M3 Suppli
      *   - If no Producers with missing M3 Supplier, do not print the Pr
      *     Pre-Chk Producer Missing Supplier report (PWCQPFR).
      *  5/30/2017 SLM E7519 - SEL 1 AND validate for errors   *** Warnin
      *  5/30/2017 SLM E7519 - SEL 2 AND validate for errors   *** Hard H
      *  5/09/2017 JBB E9890 - Don't allow Trucker payments for company
      *                        Check Company Values file for value
      *                        DALWTRKPMT to not allow the company to
      *                        make the Trucker Payment.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Validate if Market Price exist for calculating NPPC for Seaboard
      *================================================================
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0001  30       BOH Company Num
     C                     PARM WUCKDT    WQ0002  70       TH Purchase Dat
     C                     PARM 100       WQ0003  71       TH Live Wgt
     C                     PARM 'NPPCI'   WQ0004  5        DED D/A Code
     C           YL0001    PARM *ZERO     WQ0005  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Base Mkt Prc Amt Tot USR is Not Entered
     C           YL0001    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADDP1HONB    ZA0001           CC Company Numb
      * Retrieve message SBD NPPC Warning
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0990' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0002    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C                     MOVEL*BLANK    WN0001 40        System Value Al
     C                     MOVEL*BLANK    WN0002 10        Pager Name USR
      *
      * Snd Alpha Pager Msg   IF
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0006  30       BOH Company Num
     C                     PARM @CN,001   WQ0007 10        Company Value C
     C           WN0001    PARM *BLANK    WQ0008 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWN0001    WN0002           Pager Name USR
      * CASE: PAR.Pager Name USR is Not Entered
     C           WN0002    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELWN0002    ZA0002           Pager Name USR
     C                     MOVELYL0002    ZA0003           Pager Msg USR
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0991' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Step 1  Validate that job may continue - Current Payment Date
      *================================================================
     C                     MOVEL*BLANK    W0RTN            *Return code
      * UPD:  Current Payment Step = 1
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 1
     C           WUM1NB    IFLE 00001                      *IF
     C                     Z-ADD00001     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SBCHRC
     C                     END                             *FI
     C                     MOVEL'C'       YL0006           Date Type USR
      * Shift 1 Validation
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * **** Shift 1 -- Not balanced record  ****
      * Blank means that record was never balanced
      * See if there are any Unbalance Records for this Company/Payment d
     C                     MOVEL*BLANK    WUDWST           TH Kill Balanci
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SCRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 1 Not Bal Tattoo
      * Test are records balanced, if not quit - E12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - No Balance Error Shift 1
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,005:ZQYL0010    P      Email Subject-6
      * Email message - No Balance Error Shift 1
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,006:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Error Messages to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * OMS Model
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0013  7        Return Code USR
     C                     PARM YL0005    WQ0014 50        EMail Address
     C                     PARM YL0010    WQ0015 60        Email Subject-6
     C                     PARM WUKGTX    WQ0016256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 07/14/2017 JBB E9904 - Uncomment SNDPGRMSG
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
      * **** Shift 1 -- Error record  ****
      * Error means that there are records in error
      * See if there are any Error Records for this Company/Payment Dt
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SDRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 1 Error Tattoo
      * Test for records to be balanced, if not quit - E12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Shift 1 Error
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,009   CAT  'r':ZQ    YL0010    P      Email Subject-6
      * Email message - Shift 1 Error
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,010:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Tattoo Balance Error Msg to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * OMS Model
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0017  7        Return Code USR
     C                     PARM YL0005    WQ0018 50        EMail Address
     C                     PARM YL0010    WQ0019 60        Email Subject-6
     C                     PARM WUKGTX    WQ0020256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 07/14/2017 JBB E9904 - Uncomment SNDPGRMSG
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
      * Chk For Comm Errors RT - Tattoo Header  * 
     C                     EXSR SERVGN
      * Shift 1 Commission Error
      * Test for records in error, if so quit - E12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Commission Error Shift 1
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,011   CAT  @CN,012:ZQYL0010    P      Email Subject-6
      * Email message - Commission Error Shift 1
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,013:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Tattoo Balance Error Msg to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * OMS Model
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0021  7        Return Code USR
     C                     PARM YL0005    WQ0022 50        EMail Address
     C                     PARM YL0010    WQ0023 60        Email Subject-6
     C                     PARM WUKGTX    WQ0024256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 07/14/2017 JBB E9904 - Uncomment SNDPGRMSG
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Shift 2 Validation
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * **** Shift 2 -- Not balance record ****
      * Blank means that record was never balanced
      * See if there are any Unbalance Records for this Company/Payment D
     C                     MOVEL*BLANK    WUDWST           TH Kill Balanci
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SGRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 2 Not Bal Tattoo
      * Test are records balanced, if not quit - R12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - No Balance Error Shift 2
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,014:ZQYL0010    P      Email Subject-6
      * Email message - No Balance Error Shift 2
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,015:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Tattoo Balance Error Msg to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * OMS Model
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0025  7        Return Code USR
     C                     PARM YL0005    WQ0026 50        EMail Address
     C                     PARM YL0010    WQ0027 60        Email Subject-6
     C                     PARM WUKGTX    WQ0028256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 07/14/2017 JBB E9904 - Uncomment SNDPGRMSG
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
      * **** Shift 2 -- Error record  ****
      * Error means that there are records in error
      * See if there are any Unbalance Records for this Company/Payment D
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SHRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 2 Error Tattoo
      * Test for records to be balanced, if not quit - R12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Shift 2 Error
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,016   CAT  'r':ZQ    YL0010    P      Email Subject-6
      * Email message - Shift 2 Error
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,017:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Tattoo Balance Error Msg to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * OMS Model
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0029  7        Return Code USR
     C                     PARM YL0005    WQ0030 50        EMail Address
     C                     PARM YL0010    WQ0031 60        Email Subject-6
     C                     PARM WUKGTX    WQ0032256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 07/14/2017 JBB E9904 - Uncomment SNDPGRMSG
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
      * Chk For Comm Errors RT - Tattoo Header  * 
     C                     EXSR SIRVGN
      * Shift 2 Commision Error
      * Test for records in error, if so quit - R12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Commission Error Shift 2
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,011   CAT  @CN,018:ZQYL0010    P      Email Subject-6
      * Email message - Commission Error Shift 2
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,019:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Tattoo Balance Error Msg to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * OMS Model
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0033  7        Return Code USR
     C                     PARM YL0005    WQ0034 50        EMail Address
     C                     PARM YL0010    WQ0035 60        Email Subject-6
     C                     PARM WUKGTX    WQ0036256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 07/14/2017 JBB E9904 - Uncomment SNDPGRMSG
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Step 1  Validate that job may continue - Held Over
      *================================================================
     C                     MOVEL'P'       YL0006           Date Type USR
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0037  30       BOH Company Num
     C                     PARM WUCKDT    WQ0038  70       Cut Date
     C           YL0011    PARM *ZERO     WQ0039  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * **** Shift 1 -- Not balanced record  ****
      * Blank means that record was never balanced
      * See if there are any Unbalance Records for this Company/Payment d
     C                     MOVEL*BLANK    WUDWST           TH Kill Balanci
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SKRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 1 Not Bal Tattoo HO
      * Test are records balanced, if not quit - R12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Not Balanced Held Over Error Shift 1
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,020:ZQYL0010    P      Email Subject-6
      * Email message - Not Balanced Held Over Error Shift 1
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,021:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Error Messages to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0040  7        Return Code USR
     C                     PARM YL0005    WQ0041 50        EMail Address
     C                     PARM YL0010    WQ0042 60        Email Subject-6
     C                     PARM WUKGTX    WQ0043256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * **** Shift 1 -- Error record  ****
      * Error means that there are records in error
      * See if there are any Unbalance Records for this Company/Payment D
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SLRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 1 Error Tattoo HO
      * Test for records to be balanced, if not quit - E12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Held Over Error Shift 1
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,022   CAT  @CN,023:ZQYL0010    P      Email Subject-6
      * Email message - Held Over Error Shift 1
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,024:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Error Messages to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0044  7        Return Code USR
     C                     PARM YL0005    WQ0045 50        EMail Address
     C                     PARM YL0010    WQ0046 60        Email Subject-6
     C                     PARM WUKGTX    WQ0047256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * **** Shift 2 -- Not balance record ****
      * Blank means that record was never balanced
      * See if there are any Unbalance Records for this Company/Payment D
     C                     MOVEL*BLANK    WUDWST           TH Kill Balanci
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 2 Not Bal Tattoo HO
      * Test are records balanced, if not quit - E12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Held Over Not Balanced Shift 2
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,025:ZQYL0010    P      Email Subject-6
      * Email message - Held Over Not Balanced Shift 2
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,026:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Error Messages to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0048  7        Return Code USR
     C                     PARM YL0005    WQ0049 50        EMail Address
     C                     PARM YL0010    WQ0050 60        Email Subject-6
     C                     PARM WUKGTX    WQ0051256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * **** Shift 2 -- Error record  ****
      * Error means that there are records in error
      * See if there are any Unbalance Records for this Company/Payment D
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * PayEdt Chk For Errors RT - Tattoo Header  * 
     C                     EXSR SNRVGN
      * If a record is found then this is invalid
      * If no records are found then this is normal and processing may
      * continue
      * Shift 2 Error Tattoo HO
      * Test for records to be balanced, if not quit - E12054
      * CASE: PGM.*Return code is Record Found
     C           W0RTN     IFEQ '999'                      *IF
      * Error can not post and user select posting
      * CASE: *OTHERWISE
      * Email subject - Held Over Error Shift 2
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,027   CAT  @CN,023:ZQYL0010    P      Email Subject-6
      * Email message - Held Over Error Shift 2
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WUC3CD    CAT  @CN,028:ZQWUKGTX    P      Office Dist Mes
      * E12045 JJH 11/12/17 - Output Buy Order / Load / Tatooo
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,007:ZQWUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0007:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Ld':ZQ   WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0008:ZQ WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  '/':ZQ    WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  'Tat':ZQ  WUKGTX    P      Office Dist Mes
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  YL0009:ZQ WUKGTX    P      Office Dist Mes
      * E15076 JJH 06/04/19 - Add suffix "Test" if User Class = *PGMR
      * CASE: LCL.User Class f/usrprf   USR is *PGMR
     C           YL0003    IFEQ '*PGMR'                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  @CN,008:ZQYL0010    P      Email Subject-6
     C                     Z-ADD1         ZQ      50
     C           WUKGTX    CAT  @CN,008:ZQWUKGTX    P      Office Dist Mes
     C                     END                             *FI
      * E15076 JJH 06/04/19 - Send Error Messages to PRKDEVxxx
      * E15483 JBB  9/17/19 - New Distribution Lists for Tattoo Balance E
      * CLP Exe ESNDMAIL Cmd   UP - STR Order Management Sys  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM *BLANK    WQ0052  7        Return Code USR
     C                     PARM YL0005    WQ0053 50        EMail Address
     C                     PARM YL0010    WQ0054 60        Email Subject-6
     C                     PARM WUKGTX    WQ0055256        Email Message-2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Step 2 Create Carcass Records and Flag Tattoo Header for Payment
      *================================================================
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 1
     C           WUM1NB    IFLE 00001                      *IF
     C                     Z-ADD00002     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
      * Prc Crt CDtl/Prc Flg  XF - STR Batch Processing  * 
     C                     CALL 'PKPYXFR'              90  Prc Crt CDtl/Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0056  30       CC Company Numb
     C                     PARM WUCKDT    WQ0057  70       Pmt Current Pay
     C                     PARM P2EVTX    WQ0058 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E13016 JJH 05/03/18 - Update BOL Live Wgt Received
      * Check if Company updates BOL Weight prior to Step 3
      * CASE: *OTHERWISE
      * Get Company Value HPEBOLLVWT to determine if the update should
      * occur for the Company.  This Company Value was put in place to
      * allow this process to run for companies 440, 960, and 961. Compan
      * 360 will not call the program to update the BOL Live Weight.
      * Rtv Company Values    XF - STR Order Management Sys  * HPEBOLLVWT
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0059  30       BOH Company Num
     C                     PARM @CN,029   WQ0060 10        Company Value C
     C           YL0012    PARM *BLANK    WQ0061 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Update Live BOL Wgt Company flag = Y, update weight
      * CASE: LCL.Upd BOL Live Wgt Com USR is Yes
     C           YL0012    IFEQ 'Y'                        *IF
      * The date that is retrieved from the Company Values file is used t
      * determine if the next program is called to update the BOL Live
      * Weight Received.  If the Payment Date being processed is on or
      * after the date retrieved, then the program is called. Otherwise
      * The program is not called.
      * Rtv Company Value Nbr XF - STR Order Management Sys  * HPEBOLLVDT
     C                     CALL 'PDHGXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0062  30       BOH Company Num
     C                     PARM @CN,030   WQ0063 10        Company Value C
     C           YL0013    PARM *ZERO     WQ0064 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If current Payment Date >= HPEBOLLVDT, call pgm to update weight
      * CASE: WRK.Pmt Current Payment Date GE LCL.Upd BOL Live Wgt Dte US
     C           WUCKDT    IFGE YL0013                     *IF
      * Upd BOL Live Wgt Rcvd XF - STR Batch Processing  * 
     C                     CALL 'PWGTXFR'              90  Upd BOL LivWgt/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0065  30       CC Company Numb
     C                     PARM WUCKDT    WQ0066  70       Pmt Current Pay
     C                     PARM P2EVTX    WQ0067 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWGTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Step 2 ends
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 3
     C           WUM1NB    IFLE 00003                      *IF
     C                     Z-ADD00003     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Step 3 Carcass Merit Pgm, Frt Allocation, D/A and Net
      *================================================================
      * Prc Cmp/Frt/Da's/Net  XF - STR Batch Processing  * 
     C                     CALL 'PKSBXFR'              90  Prc Cmp/Frt/Da'
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0068  30       CC Company Numb
     C                     PARM P2EVTX    WQ0069 40        Oms System Valu
     C                     PARM WUCKDT    WQ0070  70       Pmt Current Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Step 3 complete set step to 4
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 3
     C           WUM1NB    IFLE 00003                      *IF
     C                     Z-ADD00004     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SQCHRC
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Step 4  Trucker Posting/Create Trucker Vouchers
      *================================================================
      * Rtv Company Values    XF - STR Order Management Sys  * DALWTRKPMT
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0071  30       BOH Company Num
     C                     PARM @CN,031   WQ0072 10        Company Value C
     C           YL0014    PARM *BLANK    WQ0073 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Don't Process Trucker Pymt is Yes, skip post
      * E7519 slm - validate for m3 supplier - if 1 is missing then do no
      * allow the trucker to create batches but go on with reports
      * If Don't Process Trucker Pymt is Yes, skip post
      * CASE: LCL.Don't Allow Trucker Pymt is Yes
     C           YL0014    IFEQ 'Y'                        *IF
      * Do not process Trucker Payments for current Company
     C                     ELSE
      * CASE: *OTHERWISE
      * E7519 JJH 06/26/17 - Determine if there are any Truckers without
      *   M3 Supplier ID. If no, do not print Prt Trucker Valiation Error
      * RMC 5/20/21 SDN440 E1 -- Check TRK Vnd Address for zero too
      * Val Trucker M3/E1 Vnd RT - Buy Order Load  * 
     C                     EXSR SRRVGN
      * CASE: WRK.PP Trucker Error is Errors
     C           WUIYSS    IFEQ 'E'                        *IF
      * Prt TruckerPaymentEdOnlPF - Buy Order Load  * 
     C                     CLEARPARC
     C                     Z-ADDP1HONB    PAHMNB           BOH Company Num
      *
     C                     CALL 'PWCDPFR'              90  Prt TruckerPaym
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Buy Order
     C                     PARM P2EVTX    WQ0080 40        Oms System Valu
     C                     PARM WUCKDT    WQ0081  70       Pmt Current Pay
     C           WUIYSS    PARM WUIYSS    WQ0082  1        PP Trucker Erro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWCDPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * E7519 SLM --- If there is a error do not run the trucker post
      * CASE: WRK.PP Trucker Error is No Errors
     C           WUIYSS    IFEQ 'N'                        *IF
      * E7519 SLM --- If there is a error do not run the trucker post
      * Prt Trucker Vch PyPrc PF - Buy Order Load  * 
     C                     CLEARPBRC
     C                     Z-ADDP1HONB    PBHMNB           BOH Company Num
      *
     C                     CALL 'PKSMPFR'              90  Prt Trucker Vch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Buy Order
     C                     PARM P2EVTX    WQ0083 40        Oms System Valu
     C                     PARM WUCKDT    WQ0084  70       Pmt Current Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKSMPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Step 4 complete ready for step 5
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 4
     C           WUM1NB    IFLE 00004                      *IF
     C                     Z-ADD00005     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR STCHRC
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Step 5  Payment edits and pre edits  ** Edit **
      *================================================================
     C                     MOVEL'N'       WUKLST           Pmt Payment Err
     C                     MOVEL'N'       WUKHST           PP Commission P
      * E7519 JJH 06/26/17 - Determine if there are any Producers without
      *   M3 Supplier ID. If no, do not print Prt Pre-Chk Producer Missin
      *   Supplier report (PWCQPFR).
      * RMC 5/20/21 SDN440 E1 -- Check Vnd Address for zero too
      * Val Producer M3/E1 Vnd RT - Tattoo Header  * 
     C                     EXSR SURVGN
      * CASE: WRK.PP Producer Error is Errors
     C           WUIZSS    IFEQ 'E'                        *IF
      * Prt Pre-Chk EditPrdM3EdPF - Tattoo Header  * 
     C                     CALL 'PWCQPFR'              90  Prt Pre-Chk Edi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0091  30       BOH Company Num
     C                     PARM WUCKDT    WQ0092  70       TH Kill Date
     C                     PARM 'E'       WQ0093  1        TH Source Type
     C                     PARM 'E'       WQ0094  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0095 40        Oms System Valu
     C                     PARM 'U'       WQ0096  1        @Status Unpaid/
     C           WUKLST    PARM WUKLST    WQ0097  1        Pmt Payment Err
     C           WUIZSS    PARM WUIZSS    WQ0098  1        PP Producer Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWCQPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * 01/02/19 JBB E14281 - Pricing Error Report
      * Chk for Pricing Error XF - Tattoo Header  * 
     C                     CALL 'PWH4XFR'              90  Chk for Pricing
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0099  30       BOH Company Num
     C                     PARM WUCKDT    WQ0100  70       TH Kill Date
     C                     PARM 'E'       WQ0101  1        TH Source Type
     C                     PARM 'E'       WQ0102  1        @Status Edit/Po
     C                     PARM 'U'       WQ0103  1        @Status Unpaid/
     C           YL0021    PARM YL0021    WQ0104  1        Pricing Error
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWH4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Pricing Error found, print Pricing Error Report (PWHYPFR)
      * CASE: LCL.Pricing Error is Yes
     C           YL0021    IFEQ 'Y'                        *IF
      * Prt Pricing Errors    PF - Tattoo Header  * 
     C                     CALL 'PWHYPFR'              90  Prt Pricing Err
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0105  30       BOH Company Num
     C                     PARM WUCKDT    WQ0106  70       TH Kill Date
     C                     PARM 'E'       WQ0107  1        TH Source Type
     C                     PARM 'E'       WQ0108  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0109 40        Oms System Valu
     C                     PARM 'U'       WQ0110  1        @Status Unpaid/
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWHYPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Prt Pre-Chk Edit Rep  PF - Tattoo Header  * 
     C                     CALL 'PKTQPFR'              90  Prt Pre-Chk Edi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0111  30       BOH Company Num
     C                     PARM WUCKDT    WQ0112  70       TH Kill Date
     C                     PARM 'E'       WQ0113  1        TH Source Type
     C                     PARM 'E'       WQ0114  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0115 40        Oms System Valu
     C                     PARM 'U'       WQ0116  1        @Status Unpaid/
     C           WUKLST    PARM WUKLST    WQ0117  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTQPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Prt Pur-Jrn Prm/      PF - Tattoo Header  * 
     C                     CLEARPCRC
     C                     Z-ADDP1HONB    PCHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PCB0DT           TH Kill Date
      *
     C                     CALL 'PKTTPFR'              90  Prt Pur-Jrn Prm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Tattoo Hea
     C                     PARM 'E'       WQ0118  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0119 40        Oms System Valu
     C                     PARM 'U'       WQ0120  1        @Status Unpaid/
     C           WUKLST    PARM WUKLST    WQ0121  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTTPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Pur-Jrn Resale    PF - Tattoo Header  * 
     C                     CLEARPDRC
     C                     Z-ADDP1HONB    PDHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PDB0DT           TH Kill Date
      *
     C                     CALL 'PKTZPFR'              90  Prt Pur-Jrn Rsl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Tattoo Hea
     C                     PARM 'E'       WQ0122  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0123 40        Oms System Valu
     C                     PARM 'U'       WQ0124  1        @Status Unpaid/
     C           WUKLST    PARM WUKLST    WQ0125  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Payment Edit/Post PF - Tattoo Header  * 
     C                     CLEARPERC
     C                     Z-ADDP1HONB    PEHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PEB0DT           TH Kill Date
      *
     C                     CALL 'PKS2PFR'              90  Prt Payment Edi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Tattoo Hea
     C                     PARM 'E'       WQ0126  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0127 40        Oms System Valu
     C                     PARM 'A'       WQ0128  1        @Status Unpaid/
     C           WUKLST    PARM WUKLST    WQ0129  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKS2PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Payment Comm E/P  PF - Tattoo Header  * commission paym e/p
     C                     CLEARPFRC
     C                     Z-ADDP1HONB    PFHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PFB0DT           TH Kill Date
      *
     C                     CALL 'PKPMPFR'              90  Prt Payment Com
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Tattoo Hea
     C                     PARM 'E'       WQ0130  1        @Status Edit/Po
     C           WUKHST    PARM WUKHST    WQ0131  1        PP Commission P
     C                     PARM P2EVTX    WQ0132 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPMPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Recalc Live Wgt   PF - Tattoo Header  * 
     C                     CALL 'PKP1PFR'              90  Prt Recalc Live
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0133  30       BOH Company Num
     C                     PARM WUCKDT    WQ0134  70       TH Kill Date
     C                     PARM P2EVTX    WQ0135 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKP1PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKLST    WUKJST           PP Payment Erro
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SXCHRC
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Pmt Current Payment Date
     C                     Z-ADD*ZERO     WUCKDT  70
      * Define work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     WUM1NB  50
      * Define work field PP Commission Paym Error
     C                     MOVEL*BLANK    WUKHST  1
      * Define work field PP Payment Error
     C                     MOVEL*BLANK    WUKJST  1
      * Define work field PP Unused Nbr 1
     C                     Z-ADD*ZERO     WUPINB  50
      * Define work field PP Repayment Status
     C                     MOVEL*BLANK    WUKKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WAM1NB           Pmt Current Pay
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Company Number Alpha Usr
     C                     MOVEL*BLANK    WUC3CD  3
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUJ0ST  1
      * Define work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    WUDWST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WCACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WCB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WCCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WCAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WCA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WCCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WCCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WCFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WCH9NB           TH Held Over
     C                     Z-ADD*ZERO     WCFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WCFENB           TH Head Killed
     C                     Z-ADD*ZERO     WCHENB           TH Head Adds
     C                     Z-ADD*ZERO     WCHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WCCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WCLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WCE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WCA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WCFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WCA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WCF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WCHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WCF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WCF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WCAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WCAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WCCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WCA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WCA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WCB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WCAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WCAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WCAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WCAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WCAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WCASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WCA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WCATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WCA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WCCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WCCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WCLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WCCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WCA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WCA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WCBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     Z-ADD*ZERO     WCBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WCHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WCHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCHINB           TH FFLI
     C                     Z-ADD*ZERO     WCA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WCA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WCA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WCJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WCD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WCD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WCD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WCD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WCEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WCEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WCECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WCEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WCEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WCEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WCOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WCTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WCT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WCTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WCT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WCOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WCKOER           TH Head Identif
     C                     Z-ADD*ZERO     WCOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WCOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WCIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WCOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WCHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WCS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WCTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WCTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WCJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WCKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WCKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WCKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WCKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WCOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WCIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WCIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WCIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WCKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WCKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WCORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WCOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WCMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WCNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WCNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WCIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WCEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCECDT           TH Head LFT
     C                     Z-ADD*ZERO     WCEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WCEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Office Dist Message USR
     C                     MOVEL*BLANK    WUKGTX132
      * Define work field Commission Producer Payee
     C                     MOVEL*BLANK    WUADCD  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEALNB           PD Production C
     C                     Z-ADD*ZERO     WEAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WEAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WEGCNB           PD VND Address
     C                     Z-ADD*ZERO     WEGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field PP Trucker Error
     C                     MOVEL*BLANK    WUIYSS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WFABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WFACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WFBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WFCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WFAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WFAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WFATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WFDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WFDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WFGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WFBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WFLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WFLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WFJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WFKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WFIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WFKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WFEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Live with M3   USR
     C                     MOVEL*BLANK    WUG4SS  1
      * Define work field Live with E1
     C                     MOVEL*BLANK    WUMESS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGGMNB           TRK VND Address
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Pmt Payment Error
     C                     MOVEL*BLANK    WUKLST  1
      * Define work field PP Producer Error
     C                     MOVEL*BLANK    WUIZSS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Base Mkt Prc Amt Tot USR
     C                     Z-ADD*ZERO     YL0001  92
      * Define local work field Pager Msg USR
     C                     MOVEL*BLANK    YL0002 80
      * Define local work field User Class f/usrprf   USR
     C                     MOVEL*BLANK    YL0003 10
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field ESEND Distribution List
     C                     MOVEL*BLANK    YL0005 40
      * Define local work field Date Type USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Buy Order Number Alpha
     C                     MOVEL*BLANK    YL0007  7
      * Define local work field Load Number Alpha
     C                     MOVEL*BLANK    YL0008  5
      * Define local work field Tattoo Number Alpha
     C                     MOVEL*BLANK    YL0009  5
      * Define local work field Email Subject-60 USR
     C                     MOVEL*BLANK    YL0010 60
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Upd BOL Live Wgt Com USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Upd BOL Live Wgt Dte USR
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Don't Allow Trucker Pymt
     C                     MOVEL*BLANK    YL0014  1
      * Define null work field TRK Name
     C                     MOVEL*BLANK    YN0001 40
      * Define local work field TRK VND Address Number
     C                     Z-ADD*ZERO     YL0015  80
      * Define local work field TRK M3 Supplier Id
     C                     MOVEL*BLANK    YL0016 10
      * Define local work field Live with M3   USR
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Live with E1
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field PD VND Address Number
     C                     Z-ADD*ZERO     YL0019  80
      * Define local work field M3 Supplier ID
     C                     MOVEL*BLANK    YL0020 10
      * Define local work field Pricing Error
     C                     MOVEL*BLANK    YL0021  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 HPESBDNPPC
00002 HPEPRKERRT
00003 HPEPRKERR
00004 Payment Edit Not Balanced
00005 Error on Shift 1
00006 Shift 1 Not Bal Tattoo
00007 - Buy Ord
00008 : TEST
00009 Payment Edit Shift 1 Erro
00010 Shift 1 Error Tattoo
00011 Payment Edit Commission E
00012 rror on Shift 1
00013 Commission Error Shift 1
00014 Error on Shift 2
00015 Shift 2 Not Bal Tattoo
00016 Payment Edit Shift 2 Erro
00017 Shift 2 Error Tattoo
00018 rror on Shift 2
00019 Shift 2 Commission Error
00020 Held Over Error - Shift 1
00021 Shift 1 Not Bal Tattoo HO
00022 Payment Edit Shift 1 Held
00023 Over Error
00024 Shift 1 Error Tattoo HO
00025 Held Over Error - Shift 2
00026 Shift 2 Not Bal Tattoo HO
00027 Payment Edit Shift 2 Held
00028 Shift 2 Error Tattoo HO
00029 HPEBOLLVWT
00030 HPEBOLLVDT
00031 DALWTRKPMT
