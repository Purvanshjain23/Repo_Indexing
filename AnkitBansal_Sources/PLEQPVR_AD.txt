// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLEQPVR
// ?Date: 14.08.2025 Time: 02:53:56
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Number
//?USER: Validate fields

CASE;

// IF DTL.Kill Date Usr is Entered
IF DTL.Kill_Date_Usr <> 0;

// OR DTL.Date To   USR is Entered
OR DTL.Date_To_USR <> *ZERO;

// OR DTL.Time Beg 4.0 USR is Entered
OR DTL.Time_Beg_4_0_USR <> *ZERO;

//?If kill date entered
CASE;

// IF DTL.Kill Date Usr is Entered
IF DTL.Kill_Date_Usr <> 0;

// WRK.Kill Date 3 Usr = DTL.Kill Date Usr
WRK.Kill_Date_3_Usr = DTL.Kill_Date_Usr;

//?If kill date entered
// IF *OTHERWISE
IF *OTHERWISE;

// WRK.Kill Date 3 Usr = DTL.DSH Kill Date
WRK.Kill_Date_3_Usr = DTL.DSH_Kill_Date;

ENDIF;

//?If delivery date entered
CASE;

// IF DTL.Date To   USR is Entered
IF DTL.Date_To_USR <> *ZERO;

// WRK.Date 2 USR = DTL.Date To   USR
WRK.Date_2_USR = DTL.Date_To_USR;

//?If delivery date entered
// IF *OTHERWISE
IF *OTHERWISE;

// WRK.Date 2 USR = DTL.DSD Delivery Date
WRK.Date_2_USR = DTL.DSD_Delivery_Date;

ENDIF;

//?If delivery time entered
CASE;

// IF DTL.Time Beg 4.0 USR is Entered
IF DTL.Time_Beg_4_0_USR <> *ZERO;

// WRK.Time End 4.0 USR = DTL.Time Beg 4.0 USR
WRK.Time_End_4_0_USR = DTL.Time_Beg_4_0_USR;

//?If delivery time entered
// IF *OTHERWISE
IF *OTHERWISE;

// WRK.Time End 4.0 USR = DTL.DSD Delivery Time
WRK.Time_End_4_0_USR = DTL.DSD_Delivery_Time;

ENDIF;

EXECUTE FUNCTION(Val Move Date/time    RT) TYPE(RTVOBJ) FILE(PLAECPP)           AB1260018;
PARAMETER(DTL.CC_Company_Number);
PARAMETER(WRK.Kill_Date_3_Usr);
PARAMETER(WRK.Date_2_USR);
PARAMETER(WRK.Time_End_4_0_USR);
PARAMETER(WRK.Status_1);
{
 //?USER: Initialize routine

 // PAR.Status 1 = CND.No
 PAR.Status_1 = 'N';

 //?USER: Process Data record

 // PAR.Status 1 = CND.Yes
 PAR.Status_1 = 'Y';

 QUIT;

}


CASE;

// IF WRK.Status 1 is No
IF WRK.Status_1 = 'N';

// Send error message - 'Inv Kill Dt/Dlv Dt/Tm combo. Kill Dt = &1, Dlv Dt = &2, Dlv Tm = &3'
ERROR(PRK1106);
MSGPARM(WRK.Kill_Date_3_Usr);
MSGPARM(WRK.Date_2_USR);
MSGPARM(WRK.Time_End_4_0_USR);

ENDIF;

ENDIF;

//?USER: User defined action

CASE;

// IF DTL.Kill Date Usr is Entered
IF DTL.Kill_Date_Usr <> 0;

// OR DTL.Date To   USR is Entered
OR DTL.Date_To_USR <> *ZERO;

// OR DTL.Time Beg 4.0 USR is Entered
OR DTL.Time_Beg_4_0_USR <> *ZERO;

// WRK.Movement Alpha USR = CVTVAR(DTL.DSD Movement Number)
WRK.Movement_Alpha_USR = CVTVAR(DTL.DSD_Movement_Number);

// WRK.Date Alpha USR = CVTVAR(DTL.Kill Date Usr)
WRK.Date_Alpha_USR = CVTVAR(DTL.Kill_Date_Usr);

// WRK.Date Alpha Usr 2 = CVTVAR(DTL.Date To   USR)
WRK.Date_Alpha_Usr_2 = CVTVAR(DTL.Date_To_USR);

// WRK.Time 4 Alpha USR = CVTVAR(DTL.Time Beg 4.0 USR)
WRK.Time_4_Alpha_USR = CVTVAR(DTL.Time_Beg_4_0_USR);

// Call program Exc Transfer Del WEB  XF.
CALL PROGRAM(Exc Transfer Del WEB  XF) ('PLDEXFR');
PARAMETER(WRK.Movement_Alpha_USR);
PARAMETER(WRK.Date_Alpha_USR);
PARAMETER(WRK.Date_Alpha_Usr_2);
PARAMETER(WRK.Time_4_Alpha_USR);

ENDIF;

