// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLL2XFR
// ?Date: 14.08.2025 Time: 02:54:39
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?MODIFICATIONS
//?11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5 TO 7
// PAR.BOL Head LFT = CON.*ZERO
PAR.BOL_Head_LFT = *ZERO;

// PAR.BOL Head EUT/KOA = CON.*ZERO
PAR.BOL_Head_EUT_KOA = *ZERO;

EXECUTE FUNCTION(Rtv TaDefTotalsTHdrBolRT) TYPE(RTVOBJ) FILE(PKDZREP)           AB1286752;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.BOL_Head_LFT);
PARAMETER(PAR.BOL_Head_EUT_KOA);
PARAMETER(PAR.TH_Hog_Class_Type);
{
 //?USER: Initialize routine

 // WRK.TH Head LFT = CON.*ZERO
 WRK.TH_Head_LFT = *ZERO;

 // WRK.TH Head EUT/KOA = CON.*ZERO
 WRK.TH_Head_EUT_KOA = *ZERO;

 //?USER: Process Data record

 //?Accumulate total for BOL
 CASE;

 // IF DB1.TDF Classification Defs is EUT/KOA
 IF DB1.TDF_Classification_Defs = 'E';

 // PAR.BOL Head EUT/KOA = PAR.BOL Head EUT/KOA + DB1.TDF Head Defect
 PAR.BOL_Head_EUT_KOA = PAR.BOL_Head_EUT_KOA + DB1.TDF_Head_Defect;

 //?Accumulate total for BOL
 // IF DB1.TDF Classification Defs is LFT
 IF DB1.TDF_Classification_Defs = 'L';

 // PAR.BOL Head LFT = PAR.BOL Head LFT + DB1.TDF Head Defect
 PAR.BOL_Head_LFT = PAR.BOL_Head_LFT + DB1.TDF_Head_Defect;

 ENDIF;

 //?Accumulate totals for this Tattoo
 CASE;

 // IF PAR.TH Tattoo Number EQ DB1.TH Tattoo Number
 IF PAR.TH_Tattoo_Number = DB1.TH_Tattoo_Number;

 // AND PAR.TH Kill Date EQ DB1.TH Kill Date
 AND PAR.TH_Kill_Date = DB1.TH_Kill_Date;

 CASE;

 // IF DB1.TDF Classification Defs is EUT/KOA
 IF DB1.TDF_Classification_Defs = 'E';

 // WRK.TH Head EUT/KOA = WRK.TH Head EUT/KOA + DB1.TDF Head Defect
 WRK.TH_Head_EUT_KOA = WRK.TH_Head_EUT_KOA + DB1.TDF_Head_Defect;

 // IF DB1.TDF Classification Defs is LFT
 IF DB1.TDF_Classification_Defs = 'L';

 // WRK.TH Head LFT = WRK.TH Head LFT + DB1.TDF Head Defect
 WRK.TH_Head_LFT = WRK.TH_Head_LFT + DB1.TDF_Head_Defect;

 ENDIF;

 ENDIF;

 //?USER: Exit processing

 EXECUTE FUNCTION(Chg THDR LFT/EUT      RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1286943;
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.BOH_Buy_Order_Number);
 PARAMETER(PAR.BOL_Load_Number);
 PARAMETER(PAR.TH_Tattoo_Number);
 PARAMETER(PAR.TH_Kill_Date);
 PARAMETER(WRK.TH_Head_LFT);
 PARAMETER(WRK.TH_Head_EUT_KOA);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(CHG THDR LFT/EUT      CH) TYPE(CHGOBJ) FILE(PKA1CPP)           AB1286944;
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.BOH_Buy_Order_Number);
  PARAMETER(DB1.BOL_Load_Number);
  PARAMETER(DB1.TH_Tattoo_Number);
  PARAMETER(DB1.TH_Kill_Date);
  PARAMETER(DB1.TH_Purchase_Date);
  PARAMETER(PAR.TH_Head_LFT);
  PARAMETER(PAR.TH_Head_EUT_KOA);
 }

}


EXECUTE FUNCTION(Chg BOL LFT/EUT       CH) TYPE(CHGOBJ) FILE(PKAXCPP)           AB1286995;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.BOL_Head_LFT);
PARAMETER(PAR.BOL_Head_EUT_KOA);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Change Stamp-SysDtIF) TYPE(EXCINTFUN)                      AB1237006;
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 {
  //?Execute internal function

  // PAR.RS User Changed = JOB.*USER
  PAR.RS_User_Changed = JOB.*USER;

  // Call program Rtv System Date & Tim UP.
  CALL PROGRAM(Rtv System Date & Tim UP) ('PKWDUPC');
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

 }

}


