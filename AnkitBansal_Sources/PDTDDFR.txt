     H/TITLE WW Load Plan PROTOTYPE DF Display file
     H            Y
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by  : SYNON/2  Version:  1204
     H* Function type : Display file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISMAREN
     H* Date          : 11/26/96  Time  : 09:33:07
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDTDDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Load Plan PROTOTYPE DF Display file
      *
     FOMFJCPLAIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : OM Load Header            Co/SchShp(d)/Seq SEL ECU
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : OM Load Detail            Co/Stop Descending
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : PD Order Header           Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : OM Load Detail            Co/Load/Stop
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : OM Load Detail            Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : PD Order Detail           co/
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company/Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : PD Item Bill Of Material  Retrieval index
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : PD Traffic Comments       Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : OM Load Header            Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : PD Order Header           Co/Load #/All orders
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : OP Order Events           Co/Order/Event Code
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : OM Truck Size             Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : OM Carrier                Retrieval index
      *
     FOPEYCPL5IF  E           K        DISK
      * RSQ : OP Order Events           Customer/Order/Event   N
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : PD Order Header           RSQ Co Load(Desc) not bl
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : PD Order Detail           Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : OM Load Header            Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : OM Load Detail            Update index
      *
     FOPEYCPL0UF  E           K        DISK
      * UPD : OP Order Events           Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : PD Order Detail           Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : PD Order Header           Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@FLCPEB
      * OM Load Detail            Co/Load/Stop
      * Renamed input format fields
     I              FLAIC3                          WAAIC3
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@FLCPBW
      * OM Load Detail            Retrieval index
      * Renamed input format fields
     I              FLAIC3                          WBAIC3
     I              FLRMNB                          WBRMNB
     I              FLRUNB                          WBRUNB
     I              FLRVNB                          WBRVNB
     I              FLDQTX                          WBDQTX
     I              FLRWNB                          WBRWNB
     I              FLRXNB                          WBRXNB
     I              FLSQNB                          WBSQNB
     I              FLT0NB                          WBT0NB
     I              FLT1NB                          WBT1NB
     I              FLR1NB                          WBR1NB
     I              FLC4NB                          WBC4NB
     I              FLVCST                          WBVCST
     I              FLUVST                          WBUVST
     I              FLUWST                          WBUWST
     I              FLUXST                          WBUXST
     I              FLAATM                          WBAATM
     I              FLAYNA                          WBAYNA
     I              FLA0NA                          WBA0NA
     I              FLAXDT                          WBAXDT
      *
     I@FJCPBN
      * OM Load Header            Retrieval index
      * Renamed input format fields
     I              FJAIC3                          WCAIC3
     I              FJRMNB                          WCRMNB
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@BFCPD9
      * PD Order Header           Co/Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@EYCPZR
      * OP Order Events           Customer/Order/Event   N
      * Renamed input format fields
     I              EYAIC3                          WEAIC3
     I              EYC4NB                          WEC4NB
     I              EYQ2NB                          WEQ2NB
     I              EYJPCD                          WEJPCD
     I              EYAUC3                          WEAUC3
     I              EYQ7NB                          WEQ7NB
     I              EYOMST                          WEOMST
     I              EYD2DT                          WED2DT
     I              EYONST                          WEONST
     I              EYOOST                          WEOOST
     I              EYOPST                          WEOPST
     I              EYAWC3                          WEAWC3
     I              EYQ8NB                          WEQ8NB
     I              EYQ9NB                          WEQ9NB
     I              EYBKC7                          WEBKC7
     I              EYUVST                          WEUVST
     I              EYUWST                          WEUWST
     I              EYUXST                          WEUXST
     I              EYAATM                          WEAATM
     I              EYAYNA                          WEAYNA
     I              EYA0NA                          WEA0NA
     I              EYAXDT                          WEAXDT
      *
     I@BFCPNQ
      * PD Order Header           RSQ Co Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BGWKL1
      * PD Order Detail           Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQOPBG1    E DSOPBGWKL0
      * UPD : PD Order Detail           Update index
     IYARDCS      DS                            340
     IQOPBF1    E DSOPBFCPL0
      * UPD : PD Order Header           Update index
     IYBRDCS      DS                            676
     IQOMFJ1    E DSOMFJCPL1
      * UPD : OM Load Header            Update index
     IYCRDCS      DS                            239
     IQOMFL1    E DSOMFLCPL0
      * UPD : OM Load Detail            Update index
     IYDRDCS      DS                            105
     IYERDCS      DS                            676
     IYFRDCS      DS                            340
     IYGRDCS      DS                            340
     IYHRDCS      DS                            340
     IYIRDCS      DS                            239
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P1DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P1DRCD
      * N :  Salesperson Code
     I                                       22  24 P1BCCD
      * N :  System Date Format
     I                                       25  27 P1B8NA
      * N :  User Profile Name
     I                                       28  37 P1AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P1I6ST
      * N :  Default Printer
     I                                       39  48 P1MPNA
      * N :  First Time Flag
     I                                       49  49 P1TAST
     IP2PARM      DS
      * N :  USR Output Only Status
     I                                        1   1 P2E5ST
     IP3PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P3G3TX
      * N :  PRT Printer Device
     I                                       26  35 P3WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P3WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P3WTST
      * N :  PRT Number of Copies
     I                                       44  450P3DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P3WUST
      * N :  PRT Night Queue
     I                                       47  56 P3BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P3AJAA
      * N :  Date 1          PASS  USR
     I                                    P  65  725P3AJAB
      * N :  Order Number 1  PASS  USR
     I                                    P  73  805P3AJAE
      * N :  System Value Numeric
     I                                    P  81  885P3M8NB
      * N :  Include Todays Trans
     I                                       89  89 P3KOST
     IP4PARM      DS
      * N :  Display Prt Opt Pmt USR
     I                                        1   4 P4XFST
     IP5PARM      DS
      * N :  USR Print Detail
     I                                        1   1 P5E7ST
     IP6PARM      DS
      * N :  Seq No 1  PASS        USR
     I                                    P   1   85P6SEQ1
     IP7PARM      DS
      * N :  USR Update Flag
     I                                        1   1 P7R4ST
     IP8PARM      DS
      * N : MAP Error Status
     I                                        1   1 P8ECST
     IP9PARM      DS
      * N :  USR Weight Accumulated
     I                                    P   1   62P9CDWG
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Company Number Req'
      * Company Number
     I                                        1   3 ZA0001
      * Message data for 'OM Load Header not found'
      * Load ID
     I                                    P   1   40ZA0002
      * Message data for 'Load Locked Can't Delete'
      * Load Status
     I                                        1   1 ZA0003
      * USR Stop
     I                                    P   2   30ZA0004
      * Message data for 'Order Picked/Confirmed'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Load ID
     I                                    P   2   50ZA0006
      * Message data for 'Order in Use;cant unlock'
      * *SFLSEL
     I                                        1   1 ZA0007
      * Load ID
     I                                    P   2   50ZA0008
      * Message data for 'Load Shipped Can't Delete'
      * Load Status
     I                                        1   1 ZA0009
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0010
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0011
      * Message data for 'No Orders Assigned'
      * Load ID
     I                                    P   1   40ZA0012
      * *SFLSEL
     I                                        5   5 ZA0013
      * Message data for 'Load Cant be Locked'
      * *SFLSEL
     I                                        1   1 ZA0014
      * Load ID
     I                                    P   2   50ZA0015
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0016
      * Load ID
     I                                    P   4   70ZA0017
      * Message data for 'Truck size must be enter'
      * Truck Size
     I                                        1   7 ZA0018
      * Load ID
     I                                    P   8  110ZA0019
      * Message data for 'Shipping Method required'
      * Shipping Method
     I                                        1   2 ZA0020
      * Message data for 'Load has orders w/o stop'
      * Load ID
     I                                    P   1   40ZA0021
      * Message data for 'Load has Orders on Hold'
      * Load ID
     I                                    P   1   40ZA0022
      * *SFLSEL
     I                                        5   5 ZA0023
      * Message data for 'Load has Cancelled Orders'
      * Load ID
     I                                    P   1   40ZA0024
      * *SFLSEL
     I                                        5   5 ZA0025
      * Message data for 'Load has Orders in Use'
      * *SFLSEL
     I                                        1   1 ZA0026
      * Load ID
     I                                    P   2   50ZA0027
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0028
      * Message data for 'Ship From Whs required'
      * Ship From Warehouse
     I                                        1   3 ZA0029
      * Message data for 'Ship to State required'
      * Ship To State Code
     I                                        1   2 ZA0030
      * Message data for 'Option invalid-not locked'
      * *SFLSEL
     I                                        1   1 ZA0031
      * Message data for 'Load Status inv for Chg'
      * *SFLSEL
     I                                        1   1 ZA0032
      * Load ID
     I                                    P   2   50ZA0033
      * Message data for 'Load Status inv for Chg'
      * *SFLSEL
     I                                        1   1 ZA0034
      * Load ID
     I                                    P   2   50ZA0035
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0036
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0037
      * Application Code
     I                                       11  16 ZA0038
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0039
      * Application Code
     I                                       11  16 ZA0040
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     MOVEL'N'       P1TAST           First Time Flag
      * Rtv Next Ship Date    RT - Calendar  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SBRVGN
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           FJAIC3           Company Number
     C                     KFLD           FJAODT           Scheduled Ship
     C                     KFLD           FJT4NB           Schedule Sequen
      * Setup key
     C                     Z-ADD#2AIC3    FJAIC3           Company Number
     C           #2AODT    IFEQ *ZERO
     C                     Z-ADD*HIVAL    FJAODT
     C                     ELSE
     C                     Z-ADD#2AODT    FJAODT           Scheduled Ship
     C                     END
     C                     Z-ADD#2T4NB    FJT4NB           Schedule Sequen
     C           KPOS      SETLL@FJCPJ1
     C                     READ @FJCPJ1                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2RPNB    WZRPNB
     C                     MOVEL#2RPNB    WZRPNB           Total Weight
     C           *LIKE     DEFN #CHNNA    WZHNNA
     C                     MOVEL#CHNNA    WZHNNA           Ship To City
     C           *LIKE     DEFN #2DXTX    WZDXTX
     C                     MOVEL#2DXTX    WZDXTX           Trailer Id
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #CADTX    WZADTX
     C                     MOVEL#CADTX    WZADTX           Name
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #CEIDT    WZEIDT
     C                     MOVEL#CEIDT    WZEIDT           Scheduled Deliv
     C           *LIKE     DEFN #2T4NB    WZT4NB
     C                     MOVEL#2T4NB    WZT4NB           Schedule Sequen
     C           *LIKE     DEFN #2PKST    WZPKST
     C                     MOVEL#2PKST    WZPKST           Load Status
     C           *LIKE     DEFN #2TLMI    WZTLMI
     C                     MOVEL#2TLMI    WZTLMI           Total Load Mile
     C           *LIKE     DEFN #CDTWG    WZDTWG
     C                     MOVEL#CDTWG    WZDTWG           Weight Adjust
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPJ1                  90*
     C  N82                READ @FJCPJ1                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,39
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2VDST    IFNE *BLANK                     Load Type
     C           FJVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2RPNB    IFNE *ZERO                      Total Weight
     C           FJRPNB    CABGT#2RPNB    BB020            Total Weight
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           FJRMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           FJAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2AODT    OREQ *ZERO                      Scheduled Ship
     C           #2T4NB    IFNE *ZERO                      Schedule Sequen
     C           FJT4NB    CABLT#2T4NB    BB020            Schedule Sequen
     C                     END
     C                     END
     C           #2TLMI    IFNE *ZERO                      Total Load Mile
     C           FJTLMI    CABNE#2TLMI    BB020            Total Load Mile
     C                     END
     C           #2BZNA    IFNE *BLANK                     Carrier Code
     C           FJBZNA    CABNE#2BZNA    BB020            Carrier Code
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * If company selection is made, then select only that company
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Accounting Company Number is not equal to zero
      *   |- c2    : DB1.Accounting Company Number NE CTL.Accounting Comp
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFNE *ZERO                      *IF
     C           FJAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process INC/EXC option
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: CTL.Load Status EQ WRK.BLANK
     C           #2PKST    IFEQ WUGSTX                     *IF
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
      * Select only records which match CTL load status
      * CASE: DB1.Load Status NE CTL.Load Status
     C           FJPKST    IFNE #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
      * Select only records which do NOT match CTL load status
      * CASE: DB1.Load Status EQ CTL.Load Status
     C           FJPKST    IFEQ #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELFJDXTX    WUASTR           AS Trailer Numb
     C                     MOVE WUASTR    #RUTRI           USR Trailer ID
     C                     END                             *FI
      * Get Last Stop on Order
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Last Stop Consign  RT - OM Load Detail  * 
     C                     EXSR SCRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Ship To State Code is State code not Blanks
      *   |- c2    : RCD.USR State Code NE CTL.Ship To State Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2DBCD    IFNE *BLANK                     *IF
     C           #RV9CD    IFNE #2DBCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Rtv 1st Ord Delv Date RT - OM Load Detail  * 
     C                     EXSR SERVGN
      * RST: Scheduled Ship Date
      * CASE: CTL.Scheduled Ship Date is entered
     C           #2AODT    IFNE *ZERO                      *IF
      * CASE: DB1.Scheduled Ship Date NE CTL.Scheduled Ship Date
     C           FJAODT    IFNE #2AODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV Gross Weight Load  RT - OM Load Detail  * 
     C                     EXSR SGRVGN
     C                     Z-ADDP9CDWG    #RDTWG           Weight Adjust
      * Highlight load number if traffic comments exist
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
     C                     EXSR SLRVGN
      * Set Highlight Flag
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'Y'       P3KOST           Include Todays
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3KOST           Include Todays
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @FJCPJ1                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2PKST'  IFEQ YPMTFD
      * Load Status
     C                     MOVEL#2PKST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFPKST
     C                     SELEC
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD1         ZFPKST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZFPKST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFPKST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD4         ZFPKST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD5         ZFPKST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD6         ZFPKST
     C           W0INVL    WHEQ '*BLANK'                   *BLANK
     C                     Z-ADD7         ZFPKST
     C                     ENDSL
     C                     EXFMTZEPKST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFPKST    WHEQ 1
     C                     MOVEL'U'       W0INVL           U
     C           ZFPKST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C           ZFPKST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFPKST    WHEQ 4
     C                     MOVEL'E'       W0INVL           E
     C           ZFPKST    WHEQ 5
     C                     MOVEL'C'       W0INVL           C
     C           ZFPKST    WHEQ 6
     C                     MOVEL'I'       W0INVL           I
     C           ZFPKST    WHEQ 7
     C                     MOVEL'*BLANK'  W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2PKST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZT4NB    CASNE#2T4NB    FBRQRL
     C           WZPKST    CASNE#2PKST    FBRQRL
     C           WZTLMI    CASNE#2TLMI    FBRQRL
     C           WZDBCD    CASNE#2DBCD    FBRQRL
     C           WZBZNA    CASNE#2BZNA    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P7R4ST           USR Update Flag
      * Display Unbooked Orders
      * CASE: CTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * DSP Unbooked Orders    DF - OP Order Header  * 
     C                     CALL 'PDCNDFR'              90  DSP Unbooked Or
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0001  30       Company Number
     C           WUBNVN    PARM WUBNVN    WQ0002 10        USR Program nam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCNDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Toggle Include/Exclude
      * CASE: CTL.*CMD key is *Option Toggle
     C           *IN08     IFEQ '1'                        *IF
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
     C                     MOVEL'EXC'     #CVQCD           Include/Exclude
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Process create load
      * CASE: CTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * CASE: CTL.Accounting Company Number is not equal to zero
     C           #2AIC3    IFNE *ZERO                      *IF
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVELWUGSTX    #2PKST           Load Status
      * Edt Load Plan          DF - OP Order Header  * 
     C                     CALL 'OMQ6DFR'              90  Edt Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0003  30       Company Number
     C           #2RMNB    PARM #2RMNB    WQ0004  70       Load ID
     C                     PARM #2PKST    WQ0005  1        Load Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMQ6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     SETON                     35    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0001           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company Number Req'
     C                     MOVEL'USR2183' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Work with All Loads
      * CASE: CTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * WW Load Plans ALL      DF - OM Load Header  * 
     C                     CALL 'PDNUDFR'              90  WW Load Plans A
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNUDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * CASE: PAR.USR Update Flag is No
     C           P7R4ST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P7R4ST           USR Update Flag
     C                     END                             *FI
     C                     MOVEL'Y'       P5E7ST           USR Print Detai
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,39
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * * Ensure have current data
      * RTV WW Screen Fields   RT - OM Load Header  * 
     C                     EXSR SMRVGN
      * Error if Load Header Not Found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0002           Load ID
      * Send message 'OM Load Header not found'
     C                     MOVEL'USR2313' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL#1DXTX    WUASTR           AS Trailer Numb
     C                     MOVE WUASTR    #RUTRI           USR Trailer ID
      * If delete request display pending message
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * CASE: RCD.Load Status is Lock
     C           #1PKST    IFEQ 'L'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
     C                     Z-ADDWUTENB    ZA0004           USR Stop
      * Send message 'Load Locked Can't Delete'
     C                     MOVEL'USR1269' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If an order assigned to this load is confirmed, then can't delete
      * Val Order for Load Dl RT - OP Order Header  * 
     C                     EXSR SNRVGN
      * If confirmed/picked order exists, can't delete
      * CASE: PGM.*Return code is Order on load can't unlck
     C           W0RTN     IFEQ 'NOUNLCK'                  *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0005           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0006           Load ID
      * Send message 'Order Picked/Confirmed'
     C                     MOVEL'USR1247' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: PGM.*Return code is Order in use
     C           W0RTN     IFEQ 'ORDUSE'                   *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0008           Load ID
      * Send message 'Order in Use;cant unlock'
     C                     MOVEL'USR2279' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't delete
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0009           Load Status
      * Send message 'Load Shipped Can't Delete'
     C                     MOVEL'USR1275' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Delete pending'
     C                     MOVEL'USR0597' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       P7R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If process unlock request, check for errors
      * CASE: RCD.*SFLSEL is *Unlock Load
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       P8ECST           Error Status
      * If load has been shipped, can't unlock
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0010           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0006  30       Company Number
     C                     PARM #1RMNB    WQ0007  70       Load ID
     C           WUZMST    PARM WUZMST    WQ0008  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0011           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P8ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P8ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P7R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
      * If process lock request, check for errors
      * CASE: RCD.*SFLSEL is *Lock Load
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0004  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0005  70       Minimum pounds
     C                     MOVEL*BLANK    WN0006  1        USR Orders on L
     C                     MOVEL*BLANK    WN0007  1        Order in Use
     C                     MOVEL*BLANK    WN0008  1        Header Status
      *
      * EDT Lock Load Edits    IF
      * assume will have error
     C                     MOVEL'Y'       P8ECST           Error Status
      * VAL no Stop Entered    RT - OM Load Detail  * 
     C                     EXSR SPRVGN
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0012           Load ID
     C                     MOVEL#1SEL     ZA0013           *SFLSEL
      * Send message 'No Orders Assigned'
     C                     MOVEL'USR1276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0014           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0015           Load ID
      * Send message 'Load Cant be Locked'
     C                     MOVEL'USR2189' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: PAR.Carrier Code EQ WRK.BLANK
     C           #1BZNA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0016           Carrier Code
     C                     Z-ADD#1RMNB    ZA0017           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           #1RONB    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1RONB    ZA0018           Truck Size
     C                     Z-ADD#1RMNB    ZA0019           Load ID
      * Send message 'Truck size must be enter'
     C                     MOVEL'USR1255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           #1Q2CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1Q2CD    ZA0020           Shipping Method
      * Send message 'Shipping Method required'
     C                     MOVEL'USR2197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0006    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0021           Load ID
      * Send message 'Load has orders w/o stop'
     C                     MOVEL'USR2196' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - OP Order Header  * 
     C                     EXSR SQRVGN
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0008    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0022           Load ID
     C                     MOVEL#1SEL     ZA0023           *SFLSEL
      * Send message 'Load has Orders on Hold'
     C                     MOVEL'USR1921' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0008    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0024           Load ID
     C                     MOVEL#1SEL     ZA0025           *SFLSEL
      * Send message 'Load has Cancelled Orders'
     C                     MOVEL'USR2236' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0007    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0026           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0027           Load ID
      * Send message 'Load has Orders in Use'
     C                     MOVEL'USR2280' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
     C                     EXSR SRRVGN
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           #1RPNB    IFLT WN0005                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0028           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P8ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           #1RPNB    IFGT WN0004                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P8ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P8ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P8ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P7R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
      * If process calc rated freight, check for errors
      * CASE: RCD.*SFLSEL is *Calc Rated Freight
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Find errors or send msg
      * CASE: RCD.Load Status is Lock
     C           #1PKST    IFEQ 'L'                        *IF
      * Warehouse, state required
      * CASE: RCD.Ship From Warehouse EQ WRK.BLANK
     C           #1VPCD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0029           *SFLSEL
      * Send message 'Ship From Whs required'
     C                     MOVEL'USR2228' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: RCD.Ship To State Code EQ WRK.BLANK
     C           #1DBCD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0030           *SFLSEL
      * Send message 'Ship to State required'
     C                     MOVEL'USR2229' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Name, Status       RT - OM Carrier  * 
     C                     EXSR SSRVGN
      * EDT Calc Rated Freight ET - OM Load Header  * 
     C                     CALL 'PDYLETR'              90  EDT Calc Rated
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0009  30       Company Number
     C                     PARM #1RMNB    WQ0010  70       Load ID
     C                     PARM #1RPNB    WQ0011  70       Total Weight
     C           #1FLAM    PARM #1FLAM    WQ0012 112       Flat Amount
     C           #1XQST    PARM #1XQST    WQ0013  1        Allocate Pounds
     C                     PARM #1BZNA    WQ0014  3        Carrier Code
     C           #1R1NB    PARM #1R1NB    WQ0015 112       Rated Freight
     C           #1TLMI    PARM #1TLMI    WQ0016  70       Total Load Mile
     C                     PARM #1VPCD    WQ0017  3        Ship From Wareh
     C                     PARM #1DBCD    WQ0018  2        Ship To State C
     C                     PARM WUGVTX    WQ0019 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYLETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV WW Screen Fields   RT - OM Load Header  * 
     C                     EXSR STRVGN
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL#1DXTX    WUASTR           AS Trailer Numb
     C                     MOVE WUASTR    #RUTRI           USR Trailer ID
     C                     END                             *FI
      * RTV Gross Weight Load  RT - OM Load Detail  * 
     C                     EXSR SURVGN
     C                     Z-ADDP9CDWG    #RDTWG           Weight Adjust
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0031           *SFLSEL
      * Send message 'Option invalid-not locked'
     C                     MOVEL'USR2109' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Process change load request
      * CASE: RCD.*SFLSEL is *Change Status
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0032           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0033           Load ID
      * Send message 'Load Status inv for Chg'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT Load Header        E1 - OM Load Header  * 
     C                     CALL 'PDCIE1R'              90  EDT Load Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0020  30       Company Number
     C                     PARM #1RMNB    WQ0021  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCIE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV WW Screen Fields   RT - OM Load Header  * 
     C                     EXSR SZRVGN
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL#1DXTX    WUASTR           AS Trailer Numb
     C                     MOVE WUASTR    #RUTRI           USR Trailer ID
     C                     END                             *FI
      * RTV Gross Weight Load  RT - OM Load Detail  * 
     C                     EXSR TARVGN
     C                     Z-ADDP9CDWG    #RDTWG           Weight Adjust
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     END                             *FI
      * Process display load request
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * used to call WW DSP ORDERS ON LOAD DF (Order Header) (PDJ6DFR)
      * WW Orders on Load      DF - OM Load Detail  * 
     C                     CALL 'PDODDFR'              90  WW Orders on Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0022  30       Company Number
     C                     PARM #1RMNB    WQ0023  70       Load ID
     C           P9CDWG    PARM P9CDWG    WQ0024 112       USR Weight Accu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDODDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * Process change load orders request
      * CASE: RCD.*SFLSEL is *Work with Orders
     C           #1SEL     IFEQ '10'                       *IF
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0034           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0035           Load ID
      * Send message 'Load Status inv for Chg'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edt Load Plan          DF - OP Order Header  * 
     C                     CALL 'OMQ6DFR'              90  Edt Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0025  30       Company Number
     C           #1RMNB    PARM #1RMNB    WQ0026  70       Load ID
     C                     PARM #1PKST    WQ0027  1        Load Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMQ6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV WW Screen Fields   RT - OM Load Header  * 
     C                     EXSR TFRVGN
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL#1DXTX    WUASTR           AS Trailer Numb
     C                     MOVE WUASTR    #RUTRI           USR Trailer ID
     C                     END                             *FI
      * RTV Gross Weight Load  RT - OM Load Detail  * 
     C                     EXSR TGRVGN
     C                     Z-ADDP9CDWG    #RDTWG           Weight Adjust
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     END                             *FI
      * Edit Traffic Comments
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * EDT PD Traffic Comment EF - PD Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0028  30       Company Number
     C                     PARM #1RMNB    WQ0029  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * Print
      * CASE: RCD.*SFLSEL is *Print
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0036           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Print options prompt
      * CASE: PAR.Display Prt Opt Pmt USR is *YES
     C           P4XFST    IFEQ '*YES'                     *IF
      * Pmt Print Option  SHR PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,01    WQ0030 25        PRT Description
     C           P3WRST    PARM P3WRST    WQ0031 10        PRT Printer Dev
     C           P3WSST    PARM P3WSST    WQ0032  4        PRT Hold Output
     C           P3WTST    PARM P3WTST    WQ0033  4        PRT Save Output
     C           P3DYNB    PARM P3DYNB    WQ0034  20       PRT Number of C
     C                     PARM P3WUST    WQ0035  1        PRT Night Queue
     C           P3BVVN    PARM P3BVVN    WQ0036 10        PRT Night Queue
     C                     PARM 'O/M'     WQ0037  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'N'       P5E7ST           USR Print Detai
     C                     END                             *FI
     C                     MOVEL*BLANK    P4XFST           Display Prt Opt
     C                     MOVEL'*NO'     P4XFST           Display Prt Opt
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * Print Load Confirmation
      * CASE: PAR.USR Print Detail is yes
     C           P5E7ST    IFEQ 'Y'                        *IF
     C                     Z-ADD#1AIC3    P3AJAA           Company Number
     C                     Z-ADD#1RMNB    P3AJAE           Order Number 1
     C                     Z-ADDP3DYNB    P3M8NB           System Value Nu
      * Pmt Pass Co/Load/Sts   UP - /UT User Programs  * 
     C                     CALL 'PDA2UPR'              90  Pmt Pass Co/Loa
     C           W0RTN     PARM *BLANK    WQ0038  1        USR Return Code
     C                     PARM 'O/M'     WQ0039  6        Application Cod
     C                     PARM 'PDMNPCLP'WQ0040 10        Program name US
     C           P3AJAA    PARM P3AJAA    WQ0041 155       Company Number
     C           P3AJAE    PARM P3AJAE    WQ0042 155       Order Number 1
     C           P3M8NB    PARM P3M8NB    WQ0043 155       System Value Nu
     C                     PARM P3G3TX    WQ0044 25        PRT Description
     C           P3WRST    PARM P3WRST    WQ0045 10        PRT Printer Dev
     C           P3WSST    PARM P3WSST    WQ0046  4        PRT Hold Output
     C           P3WTST    PARM P3WTST    WQ0047  4        PRT Save Output
     C           P3WUST    PARM P3WUST    WQ0048  1        PRT Night Queue
     C           P3BVVN    PARM P3BVVN    WQ0049 10        PRT Night Queue
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDA2UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Dispatcher
      * CASE: RCD.*SFLSEL is Option 14
     C           #1SEL     IFEQ '14'                       *IF
      * EDT Cst Srv/Dispatcher ER - OM Load Header  * 
     C                     CALL 'PDTFE1R'              90  EDT Cst Srv/Dis
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0050  30       Company Number
     C                     PARM #1RMNB    WQ0051  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTFE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * Edit Export Tracer
      * CASE: RCD.*SFLSEL is Option 16
     C           #1SEL     IFEQ '16'                       *IF
      * EDT Cst Srv/Export     ER - OM Load Header  * 
     C                     CALL 'PDTNE1R'              90  EDT Cst Srv/Exp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0052  30       Company Number
     C                     PARM #1RMNB    WQ0053  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTNE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * screen displays state of last stop on load, so get that field aga
      * do this @end of validate, so that processing will use REAL ship t
      * RTV Last Stop Consign  RT - OM Load Detail  * 
     C                     EXSR TLRVGN
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 20        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,39
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Process delete load request
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Dlt Load Header       DL - OM Load Header  * 
     C                     EXSR TNDLRC
      * Dlt Load Detail       RT - OM Load Detail  * 
     C                     EXSR TORVGN
      * CHG Load Number        RT - OP Order Header  * 
     C                     EXSR TQRVGN
      * Clear Program Message Q - UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS           ALREADY DEFINED
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Process unlock load
      * CASE: RCD.*SFLSEL is *Unlock Load
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * CHG Ld Sts,Rated Frts  CH - OM Load Header  * 
     C                     EXSR TYCHRC
      * CHG Clear Rated Frt    RT - OM Load Detail  * 
     C                     EXSR TZRVGN
      * Clear Program Message Q - UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS           ALREADY DEFINED
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0584  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0585  1        USR Status (Y/N
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * RTV for Accusort Load  RT - OM Load Detail  * 
     C                     EXSR NHRVGN
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0584    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0054  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0055  30       Company Number
     C                     PARM #1RMNB    WQ0056  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0057  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Process lock load
      * CASE: RCD.*SFLSEL is *Lock Load
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * Fill in ship from warehouse, if locking load and none entered
      * CASE: RCD.Ship From Warehouse EQ WRK.BLANK
     C           #1VPCD    IFEQ WUGSTX                     *IF
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR NLRVGN
     C                     END                             *FI
      * Fill in ship to state, if locking load and none entered
      * CASE: RCD.Ship To State Code EQ WRK.BLANK
     C           #1DBCD    IFEQ WUGSTX                     *IF
      * RTV Last Stop Consign  RT - OM Load Detail  * 
     C                     EXSR NORVGN
     C                     END                             *FI
      * CHG Lock Load          CH - OM Load Header  * 
     C                     EXSR NQCHRC
      * Clear Program Message Q - UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS           ALREADY DEFINED
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0628  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * RTV for Accusort Load  RT - OM Load Detail  * 
     C                     EXSR NRRVGN
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0628    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0058  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0059  30       Company Number
     C                     PARM #1RMNB    WQ0060  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0061  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN78
     C           P3KOST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPJ1 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Pallets
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     Z-ADDFJRPNB    #1RPNB           Total Weight
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     MOVELFJJ8TX    #1J8TX           Car/Veh. Initia
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Initials of Con
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Actual Freight
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Tare Lbs/Pallet
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #RHNNA           Ship To City
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #REIDT           Scheduled Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VREIDT
     C                     Z-ADD*ZERO     #RDTWG           Weight Adjust
     C                     MOVEL*BLANK    #RLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #RV9CD           USR State Code
     C                     Z-ADD*ZERO     #RUTRI           USR Trailer ID
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP8ECST    #PECST           Error Status
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     Z-ADD*ZERO     #2RPNB           Total Weight
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     MOVEL*BLANK    #2DXTX           Trailer Id
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CADTX           Name
     C                     MOVEL*BLANK    #CVQCD           Include/Exclude
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #CEIDT           Scheduled Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VCEIDT
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     MOVEL*BLANK    #2PKST           Load Status
     C                     Z-ADD*ZERO     #2TLMI           Total Load Mile
     C                     Z-ADD*ZERO     #CDTWG           Weight Adjust
     C                     MOVEL*BLANK    #CLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #CUTRI           USR Trailer ID
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Scheduled Ship Date to display format
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Scheduled Delivery Date to display format
     C           1000000   ADD  #REIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VREIDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Scheduled Delivery Date to display format
     C           1000000   ADD  #CEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCEIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - OM Load Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0239  50       Stop/Drop
     C                     MOVEL*BLANK    WN0240 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0241  72       Freight Charge
     C                     Z-ADD*ZERO     WN0242  70       Actual Freight
     C                     Z-ADD*ZERO     WN0243  70       Order Number
     C                     MOVEL*BLANK    WN0244  1        Ship Status
     C                     MOVEL*BLANK    WN0245  1        EDI Status 1
     C                     MOVEL*BLANK    WN0246  1        EDI Status 2
     C                     MOVEL*BLANK    WN0247  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0248  60       Job Time
     C                     MOVEL*BLANK    WN0249 10        User Id
     C                     MOVEL*BLANK    WN0250 10        Job Name
     C                     Z-ADD*ZERO     WN0251  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YDRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWAAIC3    FLAIC3           Company Number
     C                     Z-ADDWARMNB    FLRMNB           Load ID
     C                     Z-ADDWARUNB    FLRUNB           Stop/Drop Seque
      *
     C           KLCHNA    KLIST
     C                     KFLD           FLAIC3           Company Number
     C                     KFLD           FLRMNB           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
     C           KLCHNA    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO NAEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YDRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWARWNB    FLRWNB           Miles to next s
     C                     Z-ADD*ZERO     FLT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     FLT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     FLR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C                     MOVE 'Y'       YDRDC
     C                     END
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) FLAATM' defaulted for 'Job Time'.
      * Field '(DB1) FLAYNA' defaulted for 'User Id'.
      * Field '(DB1) FLA0NA' defaulted for 'Job Name'.
      * Field '(DB1) FLAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FLAATM           Job Time
     C                     MOVEL##USR     FLAYNA           User Id
     C                     MOVEL##JOB     FLA0NA           Job Name
     C                     Z-ADD##JDT     FLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C                     MOVE 'Y'       YDRDC
     C                     END
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQNB01           Company Number
     C           *LIKE     DEFN WFRMNB    WQNB02           Load ID
     C           *LIKE     DEFN WFC4NB    WQNB03           Order Number
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Company Number
     C                     KFLD           WQNB02           Load ID
     C                     KFLD           WQNB03           Order Number
      * Move fields to key list
     C                     Z-ADDWAAIC3    WQNB01           Company Number
     C                     Z-ADDWARMNB    WQNB02           Load ID
     C                     Z-ADDWAC4NB    WQNB03           Order Number
     C           KRSNB     SETLL@BFCPNQ                    *
     C           KRSNB     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - OP Order Header  * 
     C                     EXSR NCCHRC
      * UPD Rated Freight      RT - OM Shipping Detail  * 
     C                     EXSR NDRVGN
     C           KRSNB     READE@BFCPNQ                  90*
     C                     END
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - OP Order Header  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0252  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0253  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0254  70       Ship To Custome
     C                     MOVEL*BLANK    WN0255 30        Ship To Name
     C                     MOVEL*BLANK    WN0256 30        Ship To Address
     C                     MOVEL*BLANK    WN0257 30        Ship To Address
     C                     MOVEL*BLANK    WN0258 30        Ship To Address
     C                     MOVEL*BLANK    WN0259 20        Ship To City
     C                     MOVEL*BLANK    WN0260  2        Ship To State C
     C                     MOVEL*BLANK    WN0261 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0262  70       Bill to Custome
     C                     MOVEL*BLANK    WN0263 30        Bill to Name
     C                     MOVEL*BLANK    WN0264 30        Bill to Address
     C                     MOVEL*BLANK    WN0265 30        Bill to Address
     C                     MOVEL*BLANK    WN0266 30        Bill to Address
     C                     MOVEL*BLANK    WN0267 20        Bill to City
     C                     MOVEL*BLANK    WN0268  2        Bill to State C
     C                     MOVEL*BLANK    WN0269 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0270 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0271  70       Order Date
     C                     Z-ADD*ZERO     WN0272  70       Requested Ship
     C                     Z-ADD*ZERO     WN0273  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0274  70       Cancel Date
     C                     MOVEL*BLANK    WN0275  2        Terms Code
     C                     MOVEL*BLANK    WN0276 40        Special Instruc
     C                     MOVEL*BLANK    WN0277 40        Special Instruc
     C                     MOVEL*BLANK    WN0278  3        Carrier Code
     C                     MOVEL*BLANK    WN0279  1        Comment Print A
     C                     MOVEL*BLANK    WN0280  1        Comment Print I
     C                     MOVEL*BLANK    WN0281  1        Comment Print P
     C                     MOVEL*BLANK    WN0282  1        Comment Print S
     C                     MOVEL*BLANK    WN0283  3        Reason Code
     C                     MOVEL*BLANK    WN0284  1        Order in Use
     C                     MOVEL*BLANK    WN0285  1        Header Status
     C                     MOVEL*BLANK    WN0286  1        Header Status L
     C                     MOVEL*BLANK    WN0287  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0288  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0289 10        User Original E
     C                     Z-ADD*ZERO     WN0290  70       Date of Origina
     C                     Z-ADD*ZERO     WN0291 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0292 112       Order Weight To
     C                     MOVEL*BLANK    WN0293  1        Credit Hold
     C                     MOVEL*BLANK    WN0294  1        Production Hold
     C                     MOVEL*BLANK    WN0295  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0296  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0297  40       Requested Deliv
     C                     MOVEL*BLANK    WN0298  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0299 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0300  70       Load ID
     C                     Z-ADD*ZERO     WN0301  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0302  1        LTL Flag
     C                     MOVEL*BLANK    WN0303  1        Price Audit
     C                     MOVEL*BLANK    WN0304  1        Price Status
     C                     MOVEL*BLANK    WN0305  2        Shipping Method
     C                     MOVEL*BLANK    WN0306  1        Export Status
     C                     MOVEL*BLANK    WN0307  1        Palletize
     C                     MOVEL*BLANK    WN0308  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0309  1        Slip Sheet
     C                     MOVEL*BLANK    WN0310  1        Age Code
     C                     Z-ADD*ZERO     WN0311  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0312  1        Load Type
     C                     Z-ADD*ZERO     WN0313  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0314  1        Load Plan Order
     C                     MOVEL*BLANK    WN0315  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0316  70       Resell Referenc
     C                     MOVEL*BLANK    WN0317 30        Special Comment
     C                     MOVEL*BLANK    WN0318 30        Special Comment
     C                     MOVEL*BLANK    WN0319  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0320  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0321  2        Manager Level C
     C                     MOVEL*BLANK    WN0322  3        VP Level Code
     C                     Z-ADD*ZERO     WN0323  70       Attach to Order
     C                     MOVEL*BLANK    WN0324  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0325  70       Invoice Number
     C                     MOVEL*BLANK    WN0326  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0327  70       Invoice Date
     C                     MOVEL*BLANK    WN0328  2        Event Code
     C                     MOVEL*BLANK    WN0329  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0330  1        Modified Flag
     C                     Z-ADD*ZERO     WN0331 112       A/R order Value
     C                     MOVEL*BLANK    WN0332  1        Billing Activit
     C                     MOVEL*BLANK    WN0333  1        Unused Processi
     C                     MOVEL*BLANK    WN0334  1        Unused Processi
     C                     MOVEL*BLANK    WN0335  1        EDI Status 1
     C                     MOVEL*BLANK    WN0336  1        EDI Status 2
     C                     MOVEL*BLANK    WN0337  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0338  60       Job Time
     C                     MOVEL*BLANK    WN0339 10        User Id
     C                     MOVEL*BLANK    WN0340 10        Job Name
     C                     Z-ADD*ZERO     WN0341  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWFAIC3    BEAIC3           Company Number
     C                     Z-ADDWFC4NB    BEC4NB           Order Number
      *
     C           KLCHNC    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHNC    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO NCEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YERDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     BER1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C                     MOVE 'Y'       YERDC
     C                     END
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##JOB     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C                     MOVE 'Y'       YERDC
     C                     END
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - OM Shipping Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0342  30       Order Sequence
     C                     Z-ADD*ZERO     WN0343  30       Order Secondary
     C                     Z-ADD*ZERO     WN0344 112       Rated Freight
     C                     Z-ADD*ZERO     WN0345 112       @Rated Freight
     C                     MOVEL*BLANK    WN0346  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN0345           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN0346           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQND01           Company Number
     C           *LIKE     DEFN WGC4NB    WQND02           Order Number
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           Company Number
     C                     KFLD           WQND02           Order Number
      * Move fields to key list
     C                     Z-ADDWAAIC3    WQND01           Company Number
     C                     Z-ADDWFC4NB    WQND02           Order Number
     C           KRSND     SETLL@BGWKL1                    *
     C           KRSND     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WGGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
     C                     EXSR NECHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0346           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WFA1WG    IFEQ *ZERO                      *IF
     C           *ZERO     OREQ *ZERO                      *OR
     C                     Z-ADD*ZERO     WN0344           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           WGGMST    IFEQ 'C'                        *IF
     C           WGGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WGATWG    DIV  WFA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WGAVQT    MULT WGAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WFA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN0344    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
     C                     EXSR NFCHRC
     C                     ADD  WN0344    WN0345           @Rated Freight
     C                     Z-ADDWGDPNB    WN0342           Order Sequence
     C                     Z-ADDWGUENB    WN0343           Order Secondary
     C                     END                             *FI
     C           KRSND     READE@BGWKL1                  90*
     C                     END
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0345    IFNE *ZERO                      *IF
     C           WN0346    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN0345    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN0344           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
     C                     EXSR NGCHRC
     C                     END                             *FI
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NECHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0347  70       Item Code
     C                     MOVEL*BLANK    WN0348  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0349  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0350  70       Order Group Cod
     C                     MOVEL*BLANK    WN0351  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0352  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0353 112       Billing Detail
     C                     Z-ADD*ZERO     WN0354 112       Billing Detail
     C                     Z-ADD*ZERO     WN0355 112       Billing Detail
     C                     Z-ADD*ZERO     WN0356 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0357  1        Comment Print A
     C                     MOVEL*BLANK    WN0358  1        Comment Print I
     C                     MOVEL*BLANK    WN0359  1        Comment Print P
     C                     MOVEL*BLANK    WN0360  1        Comment Print S
     C                     Z-ADD*ZERO     WN0361 112       Extended Amount
     C                     Z-ADD*ZERO     WN0362  70       Market Pricing
     C                     MOVEL*BLANK    WN0363  3        Commodity Marke
     C                     MOVEL*BLANK    WN0364  3        Date Method Cod
     C                     MOVEL*BLANK    WN0365  3        Price Method Co
     C                     Z-ADD*ZERO     WN0366 114       Price Overage O
     C                     Z-ADD*ZERO     WN0367  70       Contract Number
     C                     MOVEL*BLANK    WN0368  1        Price Status
     C                     Z-ADD*ZERO     WN0369  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0370  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0371  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0372  1        Work Confirm St
     C                     MOVEL*BLANK    WN0373  1        Work Over/Short
     C                     MOVEL*BLANK    WN0374  1        Work Extra Stat
     C                     MOVEL*BLANK    WN0375 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0376 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0377  1        Age Code
     C                     MOVEL*BLANK    WN0378  1        Palletize
     C                     MOVEL*BLANK    WN0379  1        Slip Sheet
     C                     MOVEL*BLANK    WN0380  1        Catch Weight St
     C                     MOVEL*BLANK    WN0381  1        Price Audit
     C                     MOVEL*BLANK    WN0382  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0383  1        Production Date
     C                     Z-ADD*ZERO     WN0384 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0385 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0386 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0387 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0388 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0389 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0390 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0391 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0392 114       Unit Price
     C                     Z-ADD*ZERO     WN0393 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0394 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0395 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0396 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0397  70       Requested Ship
     C                     Z-ADD*ZERO     WN0398  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0399  70       Actual Shipped
     C                     MOVEL*BLANK    WN0400  1        Affect Inventor
     C                     MOVEL*BLANK    WN0401  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0402  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0403  30       Item Structure
     C                     Z-ADD*ZERO     WN0404  30       Item Structure
     C                     Z-ADD*ZERO     WN0405  30       Item Structure
     C                     MOVEL*BLANK    WN0406  2        Item Level
     C                     MOVEL*BLANK    WN0407  2        Quality Level
     C                     MOVEL*BLANK    WN0408  2        Pricing Product
     C                     MOVEL*BLANK    WN0409  2        Season Product
     C                     Z-ADD*ZERO     WN0410  70       Date of Origina
     C                     MOVEL*BLANK    WN0411 10        User Profile Na
     C                     MOVEL*BLANK    WN0412  6        Country Code
     C                     MOVEL*BLANK    WN0413  2        Event Code
     C                     MOVEL*BLANK    WN0414  3        Reason Code
     C                     MOVEL*BLANK    WN0415  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0416  1        Modified Flag
     C                     MOVEL*BLANK    WN0417  1        Substituted Fla
     C                     MOVEL*BLANK    WN0418  1        Order Detail St
     C                     MOVEL*BLANK    WN0419  1        EDI Status 1
     C                     MOVEL*BLANK    WN0420  1        EDI Status 2
     C                     MOVEL*BLANK    WN0421  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0422  60       Job Time
     C                     MOVEL*BLANK    WN0423 10        User Id
     C                     MOVEL*BLANK    WN0424 10        Job Name
     C                     Z-ADD*ZERO     WN0425  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWGAIC3    OMAIC3           Company Number
     C                     Z-ADDWGC4NB    OMC4NB           Order Number
     C                     Z-ADDWGDPNB    OMDPNB           Order Sequence
     C                     Z-ADDWGUENB    OMUENB           Order Secondary
      *
     C           KLCHNE    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHNE    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NEEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO NEEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD*ZERO     OMR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C                     MOVE 'Y'       YFRDC
     C                     END
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##JOB     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C                     MOVE 'Y'       YFRDC
     C                     END
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0426  70       Item Code
     C                     MOVEL*BLANK    WN0427  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0428  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0429  70       Order Group Cod
     C                     MOVEL*BLANK    WN0430  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0431  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0432 112       Billing Detail
     C                     Z-ADD*ZERO     WN0433 112       Billing Detail
     C                     Z-ADD*ZERO     WN0434 112       Billing Detail
     C                     Z-ADD*ZERO     WN0435 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0436  1        Comment Print A
     C                     MOVEL*BLANK    WN0437  1        Comment Print I
     C                     MOVEL*BLANK    WN0438  1        Comment Print P
     C                     MOVEL*BLANK    WN0439  1        Comment Print S
     C                     Z-ADD*ZERO     WN0440 112       Extended Amount
     C                     Z-ADD*ZERO     WN0441  70       Market Pricing
     C                     MOVEL*BLANK    WN0442  3        Commodity Marke
     C                     MOVEL*BLANK    WN0443  3        Date Method Cod
     C                     MOVEL*BLANK    WN0444  3        Price Method Co
     C                     Z-ADD*ZERO     WN0445 114       Price Overage O
     C                     Z-ADD*ZERO     WN0446  70       Contract Number
     C                     MOVEL*BLANK    WN0447  1        Price Status
     C                     Z-ADD*ZERO     WN0448  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0449  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0450  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0451  1        Work Confirm St
     C                     MOVEL*BLANK    WN0452  1        Work Over/Short
     C                     MOVEL*BLANK    WN0453  1        Work Extra Stat
     C                     MOVEL*BLANK    WN0454 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0455 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0456  1        Age Code
     C                     MOVEL*BLANK    WN0457  1        Palletize
     C                     MOVEL*BLANK    WN0458  1        Slip Sheet
     C                     MOVEL*BLANK    WN0459  1        Catch Weight St
     C                     MOVEL*BLANK    WN0460  1        Price Audit
     C                     MOVEL*BLANK    WN0461  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0462  1        Production Date
     C                     Z-ADD*ZERO     WN0463 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0464 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0465 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0466 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0467 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0468 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0469 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0470 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0471 114       Unit Price
     C                     Z-ADD*ZERO     WN0472 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0473 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0474 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0475 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0476  70       Requested Ship
     C                     Z-ADD*ZERO     WN0477  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0478  70       Actual Shipped
     C                     MOVEL*BLANK    WN0479  1        Affect Inventor
     C                     MOVEL*BLANK    WN0480  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0481  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0482  30       Item Structure
     C                     Z-ADD*ZERO     WN0483  30       Item Structure
     C                     Z-ADD*ZERO     WN0484  30       Item Structure
     C                     MOVEL*BLANK    WN0485  2        Item Level
     C                     MOVEL*BLANK    WN0486  2        Quality Level
     C                     MOVEL*BLANK    WN0487  2        Pricing Product
     C                     MOVEL*BLANK    WN0488  2        Season Product
     C                     Z-ADD*ZERO     WN0489  70       Date of Origina
     C                     MOVEL*BLANK    WN0490 10        User Profile Na
     C                     MOVEL*BLANK    WN0491  6        Country Code
     C                     MOVEL*BLANK    WN0492  2        Event Code
     C                     MOVEL*BLANK    WN0493  3        Reason Code
     C                     MOVEL*BLANK    WN0494  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0495  1        Modified Flag
     C                     MOVEL*BLANK    WN0496  1        Substituted Fla
     C                     MOVEL*BLANK    WN0497  1        Order Detail St
     C                     MOVEL*BLANK    WN0498  1        EDI Status 1
     C                     MOVEL*BLANK    WN0499  1        EDI Status 2
     C                     MOVEL*BLANK    WN0500  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0501  60       Job Time
     C                     MOVEL*BLANK    WN0502 10        User Id
     C                     MOVEL*BLANK    WN0503 10        Job Name
     C                     Z-ADD*ZERO     WN0504  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YGRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWGAIC3    OMAIC3           Company Number
     C                     Z-ADDWGC4NB    OMC4NB           Order Number
     C                     Z-ADDWGDPNB    OMDPNB           Order Sequence
     C                     Z-ADDWGUENB    OMUENB           Order Secondary
      *
     C           KLCHNF    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHNF    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NFEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO NFEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YGRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0344    OMR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YGRDCS
     C                     MOVE 'Y'       YGRDC
     C                     END
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##JOB     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YGRDCS
     C                     MOVE 'Y'       YGRDC
     C                     END
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0505  70       Item Code
     C                     MOVEL*BLANK    WN0506  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0507  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0508  70       Order Group Cod
     C                     MOVEL*BLANK    WN0509  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0510  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0511 112       Billing Detail
     C                     Z-ADD*ZERO     WN0512 112       Billing Detail
     C                     Z-ADD*ZERO     WN0513 112       Billing Detail
     C                     Z-ADD*ZERO     WN0514 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0515  1        Comment Print A
     C                     MOVEL*BLANK    WN0516  1        Comment Print I
     C                     MOVEL*BLANK    WN0517  1        Comment Print P
     C                     MOVEL*BLANK    WN0518  1        Comment Print S
     C                     Z-ADD*ZERO     WN0519 112       Extended Amount
     C                     Z-ADD*ZERO     WN0520  70       Market Pricing
     C                     MOVEL*BLANK    WN0521  3        Commodity Marke
     C                     MOVEL*BLANK    WN0522  3        Date Method Cod
     C                     MOVEL*BLANK    WN0523  3        Price Method Co
     C                     Z-ADD*ZERO     WN0524 114       Price Overage O
     C                     Z-ADD*ZERO     WN0525  70       Contract Number
     C                     MOVEL*BLANK    WN0526  1        Price Status
     C                     Z-ADD*ZERO     WN0527  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0528  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0529  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0530  1        Work Confirm St
     C                     MOVEL*BLANK    WN0531  1        Work Over/Short
     C                     MOVEL*BLANK    WN0532  1        Work Extra Stat
     C                     MOVEL*BLANK    WN0533 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0534 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0535  1        Age Code
     C                     MOVEL*BLANK    WN0536  1        Palletize
     C                     MOVEL*BLANK    WN0537  1        Slip Sheet
     C                     MOVEL*BLANK    WN0538  1        Catch Weight St
     C                     MOVEL*BLANK    WN0539  1        Price Audit
     C                     MOVEL*BLANK    WN0540  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0541  1        Production Date
     C                     Z-ADD*ZERO     WN0542 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0543 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0544 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0545 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0546 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0547 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0548 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0549 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0550 114       Unit Price
     C                     Z-ADD*ZERO     WN0551 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0552 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0553 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0554 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0555  70       Requested Ship
     C                     Z-ADD*ZERO     WN0556  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0557  70       Actual Shipped
     C                     MOVEL*BLANK    WN0558  1        Affect Inventor
     C                     MOVEL*BLANK    WN0559  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0560  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0561  30       Item Structure
     C                     Z-ADD*ZERO     WN0562  30       Item Structure
     C                     Z-ADD*ZERO     WN0563  30       Item Structure
     C                     MOVEL*BLANK    WN0564  2        Item Level
     C                     MOVEL*BLANK    WN0565  2        Quality Level
     C                     MOVEL*BLANK    WN0566  2        Pricing Product
     C                     MOVEL*BLANK    WN0567  2        Season Product
     C                     Z-ADD*ZERO     WN0568  70       Date of Origina
     C                     MOVEL*BLANK    WN0569 10        User Profile Na
     C                     MOVEL*BLANK    WN0570  6        Country Code
     C                     MOVEL*BLANK    WN0571  2        Event Code
     C                     MOVEL*BLANK    WN0572  3        Reason Code
     C                     MOVEL*BLANK    WN0573  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0574  1        Modified Flag
     C                     MOVEL*BLANK    WN0575  1        Substituted Fla
     C                     MOVEL*BLANK    WN0576  1        Order Detail St
     C                     MOVEL*BLANK    WN0577  1        EDI Status 1
     C                     MOVEL*BLANK    WN0578  1        EDI Status 2
     C                     MOVEL*BLANK    WN0579  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0580  60       Job Time
     C                     MOVEL*BLANK    WN0581 10        User Id
     C                     MOVEL*BLANK    WN0582 10        Job Name
     C                     Z-ADD*ZERO     WN0583  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YHRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWAAIC3    OMAIC3           Company Number
     C                     Z-ADDWFC4NB    OMC4NB           Order Number
     C                     Z-ADDWN0342    OMDPNB           Order Sequence
     C                     Z-ADDWN0343    OMUENB           Order Secondary
      *
     C           KLCHNG    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHNG    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO NGEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YHRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0344    OMR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C                     MOVE 'Y'       YHRDC
     C                     END
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##JOB     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C                     MOVE 'Y'       YHRDC
     C                     END
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * RTV for Accusort Load  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQNH01           Company Number
     C           *LIKE     DEFN WBRMNB    WQNH02           Load ID
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQNH01           Company Number
     C                     Z-ADD#1RMNB    WQNH02           Load ID
     C           KRSNH     SETLL@FLCPBW                    *
     C           KRSNH     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - OP Order Header  * 
     C                     EXSR NIRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WN0584           Trans Contol AS
     C                     GOTO NHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNH     READE@FLCPBW                  90*
     C                     END
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Move fields to key list
     C                     Z-ADDWBAIC3    BEAIC3           Company Number
     C                     Z-ADDWBC4NB    BEC4NB           Order Number
     C           KRSNI     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR NJRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO NIEXIT                     *QUIT
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQNJ01           Company Number
     C           *LIKE     DEFN WGC4NB    WQNJ02           Order Number
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           WQNJ01           Company Number
     C                     KFLD           WQNJ02           Order Number
      * Move fields to key list
     C                     Z-ADDBEAIC3    WQNJ01           Company Number
     C                     Z-ADDBEC4NB    WQNJ02           Order Number
     C           KRSNJ     SETLL@BGWKL1                    *
     C           KRSNJ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WGGMST    IFEQ 'L'                        *IF
     C           WGGMST    OREQ 'A'
     C           WGGMST    OREQ 'C'
     C           WGGMST    OREQ 'R'
     C           WGGMST    OREQ 'E'
     C           WGGMST    OREQ 'H'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR NKRVGN
     C                     GOTO NJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNJ     READE@BGWKL1                  90*
     C                     END
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Move fields to key list
     C                     MOVELWGAJCD    ADAJCD           Warehouse Code
     C           KRSNK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NKEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WUF8NA           Warehouse Descr
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     END
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQNL01           Company Number
     C           *LIKE     DEFN WARMNB    WQNL02           Load ID
      * Define keylist
     C           KPSNL     KLIST
     C                     KFLD           WQNL01           Company Number
     C                     KFLD           WQNL02           Load ID
     C                     KFLD           WARVNB           Stop/Drop
      * Define keylist
     C           KRSNL     KLIST
     C                     KFLD           WQNL01           Company Number
     C                     KFLD           WQNL02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQNL01           Company Number
     C                     Z-ADD#1RMNB    WQNL02           Load ID
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C           KPSNL     SETLL@FLCPEB                    *
     C           KRSNL     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
     C                     EXSR NMRVGN
     C                     GOTO NLEXIT                     *QUIT
     C           KRSNL     READE@FLCPEB                  90*
     C                     END
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQNM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQNM02           Order Number
      * Define keylist
     C           KPSNM     KLIST
     C                     KFLD           WQNM01           Company Number
     C                     KFLD           WQNM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WQNM01           Company Number
     C                     KFLD           WQNM02           Order Number
      * Move fields to key list
     C                     Z-ADDWAAIC3    WQNM01           Company Number
     C                     Z-ADDWAC4NB    WQNM02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
     C           KPSNM     SETLL@BGWKAE                    *
     C           KRSNM     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1VPCD           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO NMEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR NNRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #1VPCD           Warehouse Code
     C                     GOTO NMEXIT                     *QUIT
     C           KRSNM     READE@BGWKAE                  90*
     C                     END
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Move fields to key list
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
     C           KRSNN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NNEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     END
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLAIC3    WQNO01           Company Number
     C           *LIKE     DEFN FLRMNB    WQNO02           Load ID
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WQNO01           Company Number
     C                     KFLD           WQNO02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQNO01           Company Number
     C                     Z-ADD#1RMNB    WQNO02           Load ID
     C           KRSNO     SETLL@FLCPE8                    *
     C           KRSNO     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - OP Order Header  * 
     C                     EXSR NPRVGN
     C                     GOTO NOEXIT                     *QUIT
     C           KRSNO     READE@FLCPE8                  90*
     C                     END
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Move fields to key list
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
     C           KRSNP     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEBRTX    WUBRTX           Ship To Name
     C                     MOVELBEHMNA    WUHMNA           Ship To Address
     C                     MOVELBEHONA    WUHONA           Ship To Address
     C                     MOVELBEHPNA    WUHPNA           Ship To Address
     C                     MOVELBEHNNA    WUHNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    WUCKTX           Ship To Zip/Pos
     C                     MOVELBEBCNA    WUG0TX           Customer Purcha
     C                     MOVELBEB6NA    WUG0TX           Special Instruc
     C                     MOVELBEBYNA    WUG0TX           Special Instruc
     C                     Z-ADDBEEIDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDBEAFTM    WUNFNN           Requested Deliv
     C                     END
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQCHRC    BEGSR
      *================================================================
      * CHG Lock Load          CH - OM Load Header  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0586  1        LTL Flag
     C                     Z-ADD*ZERO     WN0587  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0588 15        Seal 1
     C                     MOVEL*BLANK    WN0589 15        Seal 2
     C                     MOVEL*BLANK    WN0590 15        Seal 3
     C                     Z-ADD*ZERO     WN0591  70       Total Weight
     C                     Z-ADD*ZERO     WN0592 112       Flat Amount
     C                     MOVEL*BLANK    WN0593  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0594  50       Total Stops
     C                     MOVEL*BLANK    WN0595 20        Trailer Id
     C                     MOVEL*BLANK    WN0596  3        Initials of Con
     C                     Z-ADD*ZERO     WN0597  40       BOL Time
     C                     MOVEL*BLANK    WN0598  3        Carrier Code
     C                     MOVEL*BLANK    WN0599  7        Truck Size
     C                     Z-ADD*ZERO     WN0600  70       Actual Freight
     C                     Z-ADD*ZERO     WN0601 112       Rated Freight
     C                     MOVEL*BLANK    WN0602  1        Ship Status
     C                     MOVEL*BLANK    WN0603  1        Load Type
     C                     Z-ADD*ZERO     WN0604  50       Number Pallets
     C                     Z-ADD*ZERO     WN0605  50       Number Pallets
     C                     Z-ADD*ZERO     WN0606 112       Tare Lbs/Pallet
     C                     Z-ADD*ZERO     WN0607  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0608  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0609  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0610 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0611 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0612  70       Actual Departur
     C                     Z-ADD*ZERO     WN0613  40       Departure Time
     C                     Z-ADD*ZERO     WN0614  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0615  52       Product Tempera
     C                     Z-ADD*ZERO     WN0616  50       Number Pallets
     C                     MOVEL*BLANK    WN0617 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0618  70       Total Load Mile
     C                     MOVEL*BLANK    WN0619 12        Recorder ID
     C                     MOVEL*BLANK    WN0620  2        Shipping Method
     C                     MOVEL*BLANK    WN0621  1        EDI Status 1
     C                     MOVEL*BLANK    WN0622  1        EDI Status 2
     C                     MOVEL*BLANK    WN0623  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0624  60       Job Time
     C                     MOVEL*BLANK    WN0625 10        User Id
     C                     MOVEL*BLANK    WN0626 10        Job Name
     C                     Z-ADD*ZERO     WN0627  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YIRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1AIC3    FJAIC3           Company Number
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLCHNQ    KLIST
     C                     KFLD           FJAIC3           Company Number
     C                     KFLD           FJRMNB           Load ID
     C           KLCHNQ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NQEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO NQEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YIRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1AODT    FJAODT           Scheduled Ship
     C                     MOVEL'L'       FJPKST           Load Status
     C                     MOVEL#1VPCD    FJVPCD           Ship From Wareh
     C                     MOVEL#1DBCD    FJDBCD           Ship To State C
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C                     MOVE 'Y'       YIRDC
     C                     END
      * USER: Processing before Data update
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C                     MOVE 'Y'       YIRDC
     C                     END
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * RTV for Accusort Load  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQNR01           Company Number
     C           *LIKE     DEFN WBRMNB    WQNR02           Load ID
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WQNR01           Company Number
     C                     KFLD           WQNR02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQNR01           Company Number
     C                     Z-ADD#1RMNB    WQNR02           Load ID
     C           KRSNR     SETLL@FLCPBW                    *
     C           KRSNR     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - OP Order Header  * 
     C                     EXSR NSRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WN0628           Trans Contol AS
     C                     GOTO NREXIT                     *QUIT
     C                     END                             *FI
     C           KRSNR     READE@FLCPBW                  90*
     C                     END
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Move fields to key list
     C                     Z-ADDWBAIC3    BEAIC3           Company Number
     C                     Z-ADDWBC4NB    BEC4NB           Order Number
     C           KRSNS     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NSEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR NTRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO NSEXIT                     *QUIT
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQNT01           Company Number
     C           *LIKE     DEFN WGC4NB    WQNT02           Order Number
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT01           Company Number
     C                     KFLD           WQNT02           Order Number
      * Move fields to key list
     C                     Z-ADDBEAIC3    WQNT01           Company Number
     C                     Z-ADDBEC4NB    WQNT02           Order Number
     C           KRSNT     SETLL@BGWKL1                    *
     C           KRSNT     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WGGMST    IFEQ 'L'                        *IF
     C           WGGMST    OREQ 'A'
     C           WGGMST    OREQ 'C'
     C           WGGMST    OREQ 'R'
     C           WGGMST    OREQ 'E'
     C           WGGMST    OREQ 'H'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR NURVGN
     C                     GOTO NTEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNT     READE@BGWKL1                  90*
     C                     END
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Move fields to key list
     C                     MOVELWGAJCD    ADAJCD           Warehouse Code
     C           KRSNU     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NUEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WUF8NA           Warehouse Descr
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     END
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * RTV Program Setup      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Move fields to key list
     C                     MOVELWN0629    DRAJVN           User Profile Na
     C           KRSNV     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NVEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    P1BCCD           Salesperson Cod
     C                     MOVELDRBUVN    WN0630           User Code Model
     C                     END
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * Retrieve Appl. Profile - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Move fields to key list
     C                     MOVELWN0629    DTAJVN           User Profile Na
     C                     MOVE *BLANK    DTDNCD           Application Cod
     C                     MOVEL'TRF'     DTDNCD           Application Cod
     C           KRSNW     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    P1AIC3           Company Number
     C                     MOVELDTAJCD    P1AJCD           Warehouse Code
     C                     END
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * Retrieve Appl. Profile - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Move fields to key list
     C                     MOVELWN0630    DTAJVN           User Profile Na
     C                     MOVE *BLANK    DTDNCD           Application Cod
     C                     MOVEL'TRF'     DTDNCD           Application Cod
     C           KRSNX     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    P1AIC3           Company Number
     C                     MOVELDTAJCD    P1AJCD           Warehouse Code
     C                     END
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNY01           Application Cod
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           WQNY01           Application Cod
      * Move fields to key list
     C                     MOVE *BLANK    WQNY01           Application Cod
     C                     MOVEL'TRF'     WQNY01           Application Cod
     C           KRSNY     SETLL@DNRESF                    *
     C           KRSNY     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NZRVGN
     C                     END                             *FI
     C           KRSNY     READE@DNRESF                  90*
     C                     END
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNZ01           Application Cod
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WQNZ01           Application Cod
      * Move fields to key list
     C                     MOVELDNRSCD    WQNZ01           Application Cod
     C           KRSNZ     SETLL@DNRESF                    *
     C           KRSNZ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NZEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNZ     READE@DNRESF                  90*
     C                     END
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Next Ship Date    RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Move fields to key list
     C                     Z-ADD#2AIC3    WQSA01           Company Number
     C                     Z-ADD##JDT     AFBCDT           Post to G/L Dat
     C           KPSSA     SETLL@AFREBE                    *
     C           KRSSA     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
     C                     GOTO SAEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: Todays date or Sunday
      *  - c1 OR c2
      *   |- c1    : DB1.Post to G/L Date EQ PAR.Post to G/L Date
      *   |- c2    : DB1.Day of Week is Sunday
      *   '-
     C           AFBCDT    IFEQ ##JDT                      *IF
     C           AFA9ST    OREQ '1'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDAFBCDT    #2AODT           Scheduled Ship
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@AFREBE                  90*
     C                     END
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Move fields to key list
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
     C           KRSSB     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CADTX           Name
     C                     GOTO SBEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CADTX           Name
     C                     END
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLAIC3    WQSC01           Company Number
     C           *LIKE     DEFN FLRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSC01           Company Number
     C                     Z-ADD#1RMNB    WQSC02           Load ID
     C           KRSSC     SETLL@FLCPE8                    *
     C           KRSSC     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - OP Order Header  * 
     C                     EXSR SDRVGN
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FLCPE8                  90*
     C                     END
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Move fields to key list
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
     C           KRSSD     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEBRTX    WUBRTX           Ship To Name
     C                     MOVELBEHMNA    WUHMNA           Ship To Address
     C                     MOVELBEHONA    WUHONA           Ship To Address
     C                     MOVELBEHPNA    WUHPNA           Ship To Address
     C                     MOVELBEHNNA    #RLINA           Ship To City
     C                     MOVELBEDBCD    #RV9CD           Ship To State C
     C                     MOVELBECKTX    WUCKTX           Ship To Zip/Pos
     C                     MOVELBEBCNA    WUG0TX           Customer Purcha
     C                     MOVELBEB6NA    WUG0TX           Special Instruc
     C                     MOVELBEBYNA    WUG0TX           Special Instruc
     C                     Z-ADDBEEIDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDBEAFTM    WUNFNN           Requested Deliv
     C                     END
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Date RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WARMNB    WQSE02           Load ID
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Load ID
     C                     KFLD           WARVNB           Stop/Drop
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSE01           Company Number
     C                     Z-ADD#1RMNB    WQSE02           Load ID
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C           KPSSE     SETLL@FLCPEB                    *
     C           KRSSE     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date     RT - OP Order Header  * 
     C                     EXSR SFRVGN
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@FLCPEB                  90*
     C                     END
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date     RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Move fields to key list
     C                     Z-ADDWAAIC3    BEAIC3           Company Number
     C                     Z-ADDWAC4NB    BEC4NB           Order Number
     C           KRSSF     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #REIDT           Scheduled Deliv
     C                     GOTO SFEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEEIDT    #REIDT           Scheduled Deliv
     C                     END
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Gross Weight Load  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P9CDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WBRMNB    WQSG02           Load ID
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Load ID
     C                     KFLD           WBRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSG01           Company Number
     C                     Z-ADD#1RMNB    WQSG02           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C           KPSSG     SETLL@FLCPBW                    *
     C           KRSSG     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Gross Weight       RT - PD Order Detail  * 
     C                     EXSR SHRVGN
     C           KRSSG     READE@FLCPBW                  90*
     C                     END
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Gross Weight       RT - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0001 112       Tare Weight Tot
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSH01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSH02           Order Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Move fields to key list
     C                     Z-ADDWBAIC3    WQSH01           Company Number
     C                     Z-ADDWBC4NB    WQSH02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
     C           KPSSH     SETLL@BGWKAE                    *
     C           KRSSH     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Tare Weight        RT - Company/Item  * 
     C                     EXSR SIRVGN
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
     C                     EXSR SJRVGN
     C           WUA3WG    ADD  WUAIWG    WUA4WG           Tare Weight Tot
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
     C           WUA4WG    MULT OMCBQT    WN0001           Tare Weight Tot
     C           WN0001    ADD  OMATWG    WUCDWG           USR Weight Accu
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUA4WG    MULT OMCCQT    WN0001           Tare Weight Tot
     C           WN0001    ADD  OMAUWG    WUCDWG           USR Weight Accu
     C                     END                             *FI
     C                     ADD  WUCDWG    P9CDWG           USR Weight Accu
     C           KRSSH     READE@BGWKAE                  90*
     C                     END
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     Z-ADDBZA3WG    WUA3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0002  3        Item Type Code
     C                     MOVEL*BLANK    WN0003  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSJ02           Item Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    WQSJ01           Company Number
     C                     Z-ADDOMHGCD    WQSJ02           Item Code
     C           KRSSJ     SETLL@IORETI                    *
     C           KRSSJ     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
     C                     EXSR SKRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0002    IFEQ 'PS'                       *IF
     C           WN0003    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SJEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     END                             *FI
     C           KRSSJ     READE@IORETI                  90*
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
     C           KRSSK     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WUAIWG           Unit Weight
     C                     MOVELBZN0CD    WN0002           Item Type Code
     C                     MOVELBZX4ST    WN0003           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN KEAIC3    WQSL01           Company Number
     C           *LIKE     DEFN KERMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSL01           Company Number
     C                     Z-ADD#1RMNB    WQSL02           Load ID
     C           KRSSL     SETLL@KECPGI                    *
     C           KRSSL     READE@KECPGI                  90*
      * Data record not found
     C   90                MOVEL'USR2199' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSL     READE@KECPGI                  90*
     C                     END
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRMNB           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
     C           KRSSM     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    #1AODT           Scheduled Ship
     C                     MOVELWCPKST    #1PKST           Load Status
     C                     Z-ADDWCRPNB    #1RPNB           Total Weight
     C                     Z-ADDWCFLAM    #1FLAM           Flat Amount
     C                     MOVELWCXQST    #1XQST           Allocate Pounds
     C                     MOVELWCDXTX    #1DXTX           Trailer Id
     C                     MOVELWCBZNA    #1BZNA           Carrier Code
     C                     MOVELWCRONB    #1RONB           Truck Size
     C                     MOVELWCVDST    #1VDST           Load Type
     C                     Z-ADDWCT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDWCTLMI    #1TLMI           Total Load Mile
     C                     MOVELWCQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWCVPCD    #1VPCD           Ship From Wareh
     C                     MOVELWCDBCD    #1DBCD           Ship To State C
     C                     END
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Order for Load Dl RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WDRMNB    WQSN02           Load ID
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSN01           Company Number
     C                     Z-ADD#1RMNB    WQSN02           Load ID
     C           KRSSN     SETLL@BFCPD9                    *
     C           KRSSN     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order in Use is yes
     C           WDGJST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ORDUSE'  W0RTN            *Return code
     C                     GOTO SNEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Confirmed & Complete
     C           WDGWST    IFEQ 'C'                        *IF
     C           WDGWST    OREQ 'R'
     C                     MOVEL'NOUNLCK' W0RTN            *Return code
     C                     GOTO SNEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Picked Event       RT - OP Order Events  * 
     C                     EXSR SORVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'NOUNLCK' W0RTN            *Return code
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@BFCPD9                  90*
     C                     END
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Picked Event       RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSO01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSO02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSO03           Event Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           WQSO03           Event Code
      * Move fields to key list
     C                     Z-ADDWDAIC3    WQSO01           Company Number
     C                     Z-ADDWDC4NB    WQSO02           Order Number
     C                     MOVEL'03'      WQSO03           Event Code
     C           KRSSO     SETLL@EYCPZE                    *
     C           KRSSO     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSO     READE@EYCPZE                  90*
     C                     END
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0006           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WARMNB    WQSP02           Load ID
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSP01           Company Number
     C                     Z-ADD#1RMNB    WQSP02           Load ID
     C           KRSSP     SETLL@FLCPEB                    *
     C           KRSSP     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     END
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           WARVNB    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       WN0006           Status - Y or N
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@FLCPEB                  90*
     C                     END
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0007           Order in Use
     C                     MOVEL*BLANK    WN0008           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WDRMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSQ01           Company Number
     C                     Z-ADD#1RMNB    WQSQ02           Load ID
     C           KRSSQ     SETLL@BFCPD9                    *
     C           KRSSQ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WDGWST    IFEQ 'H'                        *IF
     C                     MOVELWDGWST    WN0008           Header Status
     C                     GOTO SQEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WDGWST    IFEQ 'X'                        *IF
     C                     MOVELWDGWST    WN0008           Header Status
     C                     GOTO SQEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WDGJST    IFEQ 'Y'                        *IF
     C                     MOVELWDGJST    WN0007           Order in Use
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@BFCPD9                  90*
     C                     END
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Move fields to key list
     C                     MOVEL#1RONB    FKRONB           Truck Size
     C           KRSSR     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0004           Maximum pounds
     C                     Z-ADD*ZERO     WN0005           Minimum pounds
     C                     GOTO SREXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WN0004           Maximum pounds
     C                     Z-ADDFKTANB    WN0005           Minimum pounds
     C                     END
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Move fields to key list
     C                     MOVEL#1BZNA    FFBZNA           Carrier Code
     C           KRSSS     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUGVTX           Name
     C                     MOVEL*BLANK    WUG0TX           Record Status
     C                     GOTO SSEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WUGVTX           Name
     C                     MOVELFFVSST    WUG0TX           Record Status
     C                     END
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRMNB           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
     C           KRSST     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    #1AODT           Scheduled Ship
     C                     MOVELWCPKST    #1PKST           Load Status
     C                     Z-ADDWCRPNB    #1RPNB           Total Weight
     C                     Z-ADDWCFLAM    #1FLAM           Flat Amount
     C                     MOVELWCXQST    #1XQST           Allocate Pounds
     C                     MOVELWCDXTX    #1DXTX           Trailer Id
     C                     MOVELWCBZNA    #1BZNA           Carrier Code
     C                     MOVELWCRONB    #1RONB           Truck Size
     C                     MOVELWCVDST    #1VDST           Load Type
     C                     Z-ADDWCT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDWCTLMI    #1TLMI           Total Load Mile
     C                     MOVELWCQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWCVPCD    #1VPCD           Ship From Wareh
     C                     MOVELWCDBCD    #1DBCD           Ship To State C
     C                     END
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Gross Weight Load  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P9CDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WBRMNB    WQSU02           Load ID
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Load ID
     C                     KFLD           WBRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQSU01           Company Number
     C                     Z-ADD#1RMNB    WQSU02           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C           KPSSU     SETLL@FLCPBW                    *
     C           KRSSU     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Gross Weight       RT - PD Order Detail  * 
     C                     EXSR SVRVGN
     C           KRSSU     READE@FLCPBW                  90*
     C                     END
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Gross Weight       RT - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0009 112       Tare Weight Tot
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSV01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSV02           Order Number
      * Define keylist
     C           KPSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
      * Move fields to key list
     C                     Z-ADDWBAIC3    WQSV01           Company Number
     C                     Z-ADDWBC4NB    WQSV02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
     C           KPSSV     SETLL@BGWKAE                    *
     C           KRSSV     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Tare Weight        RT - Company/Item  * 
     C                     EXSR SWRVGN
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
     C                     EXSR SXRVGN
     C           WUA3WG    ADD  WUAIWG    WUA4WG           Tare Weight Tot
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
     C           WUA4WG    MULT OMCBQT    WN0009           Tare Weight Tot
     C           WN0009    ADD  OMATWG    WUCDWG           USR Weight Accu
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUA4WG    MULT OMCCQT    WN0009           Tare Weight Tot
     C           WN0009    ADD  OMAUWG    WUCDWG           USR Weight Accu
     C                     END                             *FI
     C                     ADD  WUCDWG    P9CDWG           USR Weight Accu
     C           KRSSV     READE@BGWKAE                  90*
     C                     END
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
     C           KRSSW     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     Z-ADDBZA3WG    WUA3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0010  3        Item Type Code
     C                     MOVEL*BLANK    WN0011  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSX01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSX02           Item Code
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    WQSX01           Company Number
     C                     Z-ADDOMHGCD    WQSX02           Item Code
     C           KRSSX     SETLL@IORETI                    *
     C           KRSSX     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
     C                     EXSR SYRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0010    IFEQ 'PS'                       *IF
     C           WN0011    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SXEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     END                             *FI
     C           KRSSX     READE@IORETI                  90*
     C                     END
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
     C           KRSSY     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WUAIWG           Unit Weight
     C                     MOVELBZN0CD    WN0010           Item Type Code
     C                     MOVELBZX4ST    WN0011           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRMNB           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
     C           KRSSZ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    #1AODT           Scheduled Ship
     C                     MOVELWCPKST    #1PKST           Load Status
     C                     Z-ADDWCRPNB    #1RPNB           Total Weight
     C                     Z-ADDWCFLAM    #1FLAM           Flat Amount
     C                     MOVELWCXQST    #1XQST           Allocate Pounds
     C                     MOVELWCDXTX    #1DXTX           Trailer Id
     C                     MOVELWCBZNA    #1BZNA           Carrier Code
     C                     MOVELWCRONB    #1RONB           Truck Size
     C                     MOVELWCVDST    #1VDST           Load Type
     C                     Z-ADDWCT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDWCTLMI    #1TLMI           Total Load Mile
     C                     MOVELWCQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWCVPCD    #1VPCD           Ship From Wareh
     C                     MOVELWCDBCD    WUDBCD           Ship To State C
     C                     END
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Gross Weight Load  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P9CDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQTA01           Company Number
     C           *LIKE     DEFN WBRMNB    WQTA02           Load ID
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Load ID
     C                     KFLD           WBRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQTA01           Company Number
     C                     Z-ADD#1RMNB    WQTA02           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C           KPSTA     SETLL@FLCPBW                    *
     C           KRSTA     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Gross Weight       RT - PD Order Detail  * 
     C                     EXSR TBRVGN
     C           KRSTA     READE@FLCPBW                  90*
     C                     END
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Gross Weight       RT - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0012 112       Tare Weight Tot
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTB02           Order Number
      * Define keylist
     C           KPSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
      * Move fields to key list
     C                     Z-ADDWBAIC3    WQTB01           Company Number
     C                     Z-ADDWBC4NB    WQTB02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
     C           KPSTB     SETLL@BGWKAE                    *
     C           KRSTB     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Tare Weight        RT - Company/Item  * 
     C                     EXSR TCRVGN
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
     C                     EXSR TDRVGN
     C           WUA3WG    ADD  WUAIWG    WUA4WG           Tare Weight Tot
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
     C           WUA4WG    MULT OMCBQT    WN0012           Tare Weight Tot
     C           WN0012    ADD  OMATWG    WUCDWG           USR Weight Accu
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUA4WG    MULT OMCCQT    WN0012           Tare Weight Tot
     C           WN0012    ADD  OMAUWG    WUCDWG           USR Weight Accu
     C                     END                             *FI
     C                     ADD  WUCDWG    P9CDWG           USR Weight Accu
     C           KRSTB     READE@BGWKAE                  90*
     C                     END
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
     C           KRSTC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     Z-ADDBZA3WG    WUA3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0013  3        Item Type Code
     C                     MOVEL*BLANK    WN0014  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQTD01           Company Number
     C           *LIKE     DEFN IOHGCD    WQTD02           Item Code
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    WQTD01           Company Number
     C                     Z-ADDOMHGCD    WQTD02           Item Code
     C           KRSTD     SETLL@IORETI                    *
     C           KRSTD     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
     C                     EXSR TERVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0013    IFEQ 'PS'                       *IF
     C           WN0014    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO TDEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     END                             *FI
     C           KRSTD     READE@IORETI                  90*
     C                     END
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
     C           KRSTE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WUAIWG           Unit Weight
     C                     MOVELBZN0CD    WN0013           Item Type Code
     C                     MOVELBZX4ST    WN0014           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRMNB           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
     C           KRSTF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    #1AODT           Scheduled Ship
     C                     MOVELWCPKST    #1PKST           Load Status
     C                     Z-ADDWCRPNB    #1RPNB           Total Weight
     C                     Z-ADDWCFLAM    #1FLAM           Flat Amount
     C                     MOVELWCXQST    #1XQST           Allocate Pounds
     C                     MOVELWCDXTX    #1DXTX           Trailer Id
     C                     MOVELWCBZNA    #1BZNA           Carrier Code
     C                     MOVELWCRONB    #1RONB           Truck Size
     C                     MOVELWCVDST    #1VDST           Load Type
     C                     Z-ADDWCT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDWCTLMI    #1TLMI           Total Load Mile
     C                     MOVELWCQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWCVPCD    #1VPCD           Ship From Wareh
     C                     MOVELWCDBCD    WUDBCD           Ship To State C
     C                     END
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Gross Weight Load  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P9CDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQTG01           Company Number
     C           *LIKE     DEFN WBRMNB    WQTG02           Load ID
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Load ID
     C                     KFLD           WBRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQTG01           Company Number
     C                     Z-ADD#1RMNB    WQTG02           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C           KPSTG     SETLL@FLCPBW                    *
     C           KRSTG     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Gross Weight       RT - PD Order Detail  * 
     C                     EXSR THRVGN
     C           KRSTG     READE@FLCPBW                  90*
     C                     END
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Gross Weight       RT - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0015 112       Tare Weight Tot
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCDWG           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTH01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTH02           Order Number
      * Define keylist
     C           KPSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Order Number
      * Move fields to key list
     C                     Z-ADDWBAIC3    WQTH01           Company Number
     C                     Z-ADDWBC4NB    WQTH02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
     C           KPSTH     SETLL@BGWKAE                    *
     C           KRSTH     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Tare Weight        RT - Company/Item  * 
     C                     EXSR TIRVGN
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
     C                     EXSR TJRVGN
     C           WUA3WG    ADD  WUAIWG    WUA4WG           Tare Weight Tot
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
     C           WUA4WG    MULT OMCBQT    WN0015           Tare Weight Tot
     C           WN0015    ADD  OMATWG    WUCDWG           USR Weight Accu
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUA4WG    MULT OMCCQT    WN0015           Tare Weight Tot
     C           WN0015    ADD  OMAUWG    WUCDWG           USR Weight Accu
     C                     END                             *FI
     C                     ADD  WUCDWG    P9CDWG           USR Weight Accu
     C           KRSTH     READE@BGWKAE                  90*
     C                     END
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
     C           KRSTI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     Z-ADDBZA3WG    WUA3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0016  3        Item Type Code
     C                     MOVEL*BLANK    WN0017  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN IOHGCD    WQTJ02           Item Code
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Item Code
      * Move fields to key list
     C                     Z-ADDOMAIC3    WQTJ01           Company Number
     C                     Z-ADDOMHGCD    WQTJ02           Item Code
     C           KRSTJ     SETLL@IORETI                    *
     C           KRSTJ     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
     C                     EXSR TKRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0016    IFEQ 'PS'                       *IF
     C           WN0017    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO TJEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     END                             *FI
     C           KRSTJ     READE@IORETI                  90*
     C                     END
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Move fields to key list
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
     C           KRSTK     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TKEXIT
     C                     END
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WUAIWG           Unit Weight
     C                     MOVELBZN0CD    WN0016           Item Type Code
     C                     MOVELBZX4ST    WN0017           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLAIC3    WQTL01           Company Number
     C           *LIKE     DEFN FLRMNB    WQTL02           Load ID
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQTL01           Company Number
     C                     Z-ADD#1RMNB    WQTL02           Load ID
     C           KRSTL     SETLL@FLCPE8                    *
     C           KRSTL     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - OP Order Header  * 
     C                     EXSR TMRVGN
     C                     GOTO TLEXIT                     *QUIT
     C           KRSTL     READE@FLCPE8                  90*
     C                     END
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Move fields to key list
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
     C           KRSTM     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEBRTX    WUBRTX           Ship To Name
     C                     MOVELBEHMNA    WUHMNA           Ship To Address
     C                     MOVELBEHONA    WUHONA           Ship To Address
     C                     MOVELBEHPNA    WUHPNA           Ship To Address
     C                     MOVELBEHNNA    #RLINA           Ship To City
     C                     MOVELBEDBCD    #RV9CD           Ship To State C
     C                     MOVELBECKTX    WUCKTX           Ship To Zip/Pos
     C                     MOVELBEBCNA    WUG0TX           Customer Purcha
     C                     MOVELBEB6NA    WUG0TX           Special Instruc
     C                     MOVELBEBYNA    WUG0TX           Special Instruc
     C                     Z-ADDBEEIDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDBEAFTM    WUNFNN           Requested Deliv
     C                     END
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNDLRC    BEGSR
      *================================================================
      * Dlt Load Header       DL - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FJCPBO
     C                     Z-ADD#1AIC3    FJAIC3           Company Number
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLDLTN    KLIST
     C                     KFLD           FJAIC3           Company Number
     C                     KFLD           FJRMNB           Load ID
     C           KLDLTN    CHAIN@FJCPBO              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     END
      *
      *................................................................
     C                     DELET@FJCPBO                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     END
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Dlt Load Detail       RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQTO01           Company Number
     C           *LIKE     DEFN WBRMNB    WQTO02           Load ID
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQTO01           Company Number
     C                     Z-ADD#1RMNB    WQTO02           Load ID
     C           KRSTO     SETLL@FLCPBW                    *
     C           KRSTO     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Load Detail       DL - OM Load Detail  * 
     C                     EXSR TPDLRC
     C           KRSTO     READE@FLCPBW                  90*
     C                     END
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPDLRC    BEGSR
      *================================================================
      * DLT Load Detail       DL - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADDWBAIC3    FLAIC3           Company Number
     C                     Z-ADDWBRMNB    FLRMNB           Load ID
     C                     Z-ADDWBRUNB    FLRUNB           Stop/Drop Seque
      *
     C           KLDLTP    KLIST
     C                     KFLD           FLAIC3           Company Number
     C                     KFLD           FLRMNB           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
     C           KLDLTP    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     END
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     END
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * CHG Load Number        RT - OP Order Header  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0018  50       Event Number
     C                     MOVEL*BLANK    WN0019  2        Event Code
     C                     Z-ADD*ZERO     WN0020  70       Event Date
     C                     MOVEL*BLANK    WN0021  1        Activity Hold
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTQ01           Company Number
     C           *LIKE     DEFN WDRMNB    WQTQ02           Load ID
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Company Number
     C                     KFLD           WQTQ02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQTQ01           Company Number
     C                     Z-ADD#1RMNB    WQTQ02           Load ID
     C           KRSTQ     SETLL@BFCPD9                    *
     C           KRSTQ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Specific Event Cde RT - OP Order Events  * 
     C                     EXSR TRRVGN
      * RTV Latest Event/Date  RT - OP Order Events  * 
     C                     EXSR TTRVGN
      * UPD Load Information   RT - OP Order Header  * 
     C                     EXSR TURVGN
     C           KRSTQ     READE@BFCPD9                  90*
     C                     END
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * DEL Specific Event Cde RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQTR01           Company Number
     C           *LIKE     DEFN EYC4NB    WQTR02           Order Number
     C           *LIKE     DEFN EYJPCD    WQTR03           Event Code
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WQTR02           Order Number
     C                     KFLD           WQTR03           Event Code
      * Move fields to key list
     C                     Z-ADDWDAIC3    WQTR01           Company Number
     C                     Z-ADDWDC4NB    WQTR02           Order Number
     C                     MOVEL'02'      WQTR03           Event Code
     C           KRSTR     SETLL@EYCPZE                    *
     C           KRSTR     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete OP Order Events - OP Order Events  * 
     C                     EXSR TSDLRC
     C           KRSTR     READE@EYCPZE                  90*
     C                     END
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSDLRC    BEGSR
      *================================================================
      * Delete OP Order Events - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
      *
     C           KLDLTS    KLIST
     C                     KFLD           EYAIC3           Company Number
     C                     KFLD           EYC4NB           Order Number
     C                     KFLD           EYQ2NB           Event Number
     C           KLDLTS    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     END
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     END
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Latest Event/Date  RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQTT01           Company Number
     C           *LIKE     DEFN WEC4NB    WQTT02           Order Number
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           Company Number
     C                     KFLD           WQTT02           Order Number
      * Move fields to key list
     C                     Z-ADDWDAIC3    WQTT01           Company Number
     C                     Z-ADDWDC4NB    WQTT02           Order Number
     C           KRSTT     SETLL@EYCPZR                    *
     C           KRSTT     READE@EYCPZR                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEQ2NB    WN0018           Event Number
     C                     MOVELWEJPCD    WN0019           Event Code
     C                     Z-ADDWED2DT    WN0020           Event Date
     C                     MOVELWEOOST    WN0021           Activity Hold
     C           KRSTT     READE@EYCPZR                  90*
     C                     END
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * UPD Load Information   RT - OP Order Header  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0022  1        Header Status
     C                     MOVEL*BLANK    WN0023  1        Header Status L
     C                     Z-ADD*ZERO     WN0024 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0025 112       Order Weight To
     C                     MOVEL*BLANK    WN0026  1        Credit Hold
     C                     MOVEL*BLANK    WN0027  1        Production Hold
     C                     Z-ADD*ZERO     WN0028 112       Total Freight
     C                     Z-ADD*ZERO     WN0029  70       Total Weight
     C                     MOVEL*BLANK    WN0030  1        Affect Sales Do
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Move fields to key list
     C                     Z-ADDWDAIC3    BEAIC3           Company Number
     C                     Z-ADDWDC4NB    BEC4NB           Order Number
     C           KRSTU     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Remove Credit Checking and Product Availability Allocation
      * MEA 06/11/96
      * did call CHG Sched Ship/Alloc RT (old Order Detail)
      * did call CLC Tot Ord Val No Upd RT (old Order Detail)
      * UPD Event: Ship Detail RT - OM Shipping Detail  * 
     C                     EXSR TVRVGN
      * Chg Load Information   CH - OP Order Header  * 
     C                     EXSR TXCHRC
     C                     END
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * UPD Event: Ship Detail RT - OM Shipping Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTV01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTV02           Order Number
      * Define keylist
     C           KPSTV     KLIST
     C                     KFLD           WQTV01           Company Number
     C                     KFLD           WQTV02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WQTV01           Company Number
     C                     KFLD           WQTV02           Order Number
      * Move fields to key list
     C                     Z-ADDWDAIC3    WQTV01           Company Number
     C                     Z-ADDWDC4NB    WQTV02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
     C           KPSTV     SETLL@BGWKAE                    *
     C           KRSTV     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Shipping Event     CH - PD Order Detail  * 
     C                     EXSR TWCHRC
     C           KRSTV     READE@BGWKAE                  90*
     C                     END
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * CHG Shipping Event     CH - PD Order Detail  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0031  70       Item Code
     C                     MOVEL*BLANK    WN0032  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0033  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0034  70       Order Group Cod
     C                     MOVEL*BLANK    WN0035  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0036  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0037 112       Billing Detail
     C                     Z-ADD*ZERO     WN0038 112       Billing Detail
     C                     Z-ADD*ZERO     WN0039 112       Billing Detail
     C                     Z-ADD*ZERO     WN0040 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0041  1        Comment Print A
     C                     MOVEL*BLANK    WN0042  1        Comment Print I
     C                     MOVEL*BLANK    WN0043  1        Comment Print P
     C                     MOVEL*BLANK    WN0044  1        Comment Print S
     C                     Z-ADD*ZERO     WN0045 112       Extended Amount
     C                     Z-ADD*ZERO     WN0046  70       Market Pricing
     C                     MOVEL*BLANK    WN0047  3        Commodity Marke
     C                     MOVEL*BLANK    WN0048  3        Date Method Cod
     C                     MOVEL*BLANK    WN0049  3        Price Method Co
     C                     Z-ADD*ZERO     WN0050 114       Price Overage O
     C                     Z-ADD*ZERO     WN0051  70       Contract Number
     C                     MOVEL*BLANK    WN0052  1        Price Status
     C                     Z-ADD*ZERO     WN0053  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0054  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0055  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0056  1        Work Confirm St
     C                     MOVEL*BLANK    WN0057  1        Work Over/Short
     C                     MOVEL*BLANK    WN0058  1        Work Extra Stat
     C                     MOVEL*BLANK    WN0059 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0060 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0061  1        Age Code
     C                     MOVEL*BLANK    WN0062  1        Palletize
     C                     MOVEL*BLANK    WN0063  1        Slip Sheet
     C                     MOVEL*BLANK    WN0064  1        Catch Weight St
     C                     MOVEL*BLANK    WN0065  1        Price Audit
     C                     MOVEL*BLANK    WN0066  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0067  1        Production Date
     C                     Z-ADD*ZERO     WN0068 112       Rated Freight
     C                     Z-ADD*ZERO     WN0069 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0070 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0071 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0072 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0073 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0074 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0075 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0076 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0077 114       Unit Price
     C                     Z-ADD*ZERO     WN0078 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0079 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0080 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0081 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0082  70       Requested Ship
     C                     Z-ADD*ZERO     WN0083  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0084  70       Actual Shipped
     C                     MOVEL*BLANK    WN0085  1        Affect Inventor
     C                     MOVEL*BLANK    WN0086  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0087  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0088  30       Item Structure
     C                     Z-ADD*ZERO     WN0089  30       Item Structure
     C                     Z-ADD*ZERO     WN0090  30       Item Structure
     C                     MOVEL*BLANK    WN0091  2        Item Level
     C                     MOVEL*BLANK    WN0092  2        Quality Level
     C                     MOVEL*BLANK    WN0093  2        Pricing Product
     C                     MOVEL*BLANK    WN0094  2        Season Product
     C                     Z-ADD*ZERO     WN0095  70       Date of Origina
     C                     MOVEL*BLANK    WN0096 10        User Profile Na
     C                     MOVEL*BLANK    WN0097  6        Country Code
     C                     MOVEL*BLANK    WN0098  3        Reason Code
     C                     MOVEL*BLANK    WN0099  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0100  1        Modified Flag
     C                     MOVEL*BLANK    WN0101  1        Substituted Fla
     C                     MOVEL*BLANK    WN0102  1        Order Detail St
     C                     MOVEL*BLANK    WN0103  1        EDI Status 1
     C                     MOVEL*BLANK    WN0104  1        EDI Status 2
     C                     MOVEL*BLANK    WN0105  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0106  60       Job Time
     C                     MOVEL*BLANK    WN0107 10        User Id
     C                     MOVEL*BLANK    WN0108 10        Job Name
     C                     Z-ADD*ZERO     WN0109  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YARDC   1
      *
      * Move key fields to @BGWKL0
      *
     C           KLCHTW    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHTW    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TWEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWN0019    OMJPCD           Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##JOB     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     END
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * Chg Load Information   CH - OP Order Header  * 
      *================================================================
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0110  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0111  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0112  70       Ship To Custome
     C                     MOVEL*BLANK    WN0113 30        Ship To Name
     C                     MOVEL*BLANK    WN0114 30        Ship To Address
     C                     MOVEL*BLANK    WN0115 30        Ship To Address
     C                     MOVEL*BLANK    WN0116 30        Ship To Address
     C                     MOVEL*BLANK    WN0117 20        Ship To City
     C                     MOVEL*BLANK    WN0118  2        Ship To State C
     C                     MOVEL*BLANK    WN0119 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0120  70       Bill to Custome
     C                     MOVEL*BLANK    WN0121 30        Bill to Name
     C                     MOVEL*BLANK    WN0122 30        Bill to Address
     C                     MOVEL*BLANK    WN0123 30        Bill to Address
     C                     MOVEL*BLANK    WN0124 30        Bill to Address
     C                     MOVEL*BLANK    WN0125 20        Bill to City
     C                     MOVEL*BLANK    WN0126  2        Bill to State C
     C                     MOVEL*BLANK    WN0127 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0128 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0129  70       Order Date
     C                     Z-ADD*ZERO     WN0130  70       Requested Ship
     C                     Z-ADD*ZERO     WN0131  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0132  70       Cancel Date
     C                     MOVEL*BLANK    WN0133  2        Terms Code
     C                     MOVEL*BLANK    WN0134 40        Special Instruc
     C                     MOVEL*BLANK    WN0135 40        Special Instruc
     C                     MOVEL*BLANK    WN0136  1        Comment Print A
     C                     MOVEL*BLANK    WN0137  1        Comment Print I
     C                     MOVEL*BLANK    WN0138  1        Comment Print P
     C                     MOVEL*BLANK    WN0139  1        Comment Print S
     C                     MOVEL*BLANK    WN0140  3        Reason Code
     C                     MOVEL*BLANK    WN0141  1        Order in Use
     C                     MOVEL*BLANK    WN0142  1        Header Status
     C                     MOVEL*BLANK    WN0143  1        Header Status L
     C                     MOVEL*BLANK    WN0144  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0145  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0146 10        User Original E
     C                     Z-ADD*ZERO     WN0147  70       Date of Origina
     C                     Z-ADD*ZERO     WN0148 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0149 112       Order Weight To
     C                     MOVEL*BLANK    WN0150  1        Credit Hold
     C                     MOVEL*BLANK    WN0151  1        Production Hold
     C                     MOVEL*BLANK    WN0152  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0153  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0154  40       Requested Deliv
     C                     MOVEL*BLANK    WN0155  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0156 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0157  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0158  1        LTL Flag
     C                     MOVEL*BLANK    WN0159  1        Price Audit
     C                     MOVEL*BLANK    WN0160  1        Price Status
     C                     MOVEL*BLANK    WN0161  2        Shipping Method
     C                     MOVEL*BLANK    WN0162  1        Export Status
     C                     MOVEL*BLANK    WN0163  1        Palletize
     C                     MOVEL*BLANK    WN0164  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0165  1        Slip Sheet
     C                     MOVEL*BLANK    WN0166  1        Age Code
     C                     Z-ADD*ZERO     WN0167  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0168  1        Load Type
     C                     Z-ADD*ZERO     WN0169  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0170  1        Load Plan Order
     C                     MOVEL*BLANK    WN0171  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0172  70       Resell Referenc
     C                     MOVEL*BLANK    WN0173 30        Special Comment
     C                     MOVEL*BLANK    WN0174 30        Special Comment
     C                     MOVEL*BLANK    WN0175  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0176  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0177  2        Manager Level C
     C                     MOVEL*BLANK    WN0178  3        VP Level Code
     C                     Z-ADD*ZERO     WN0179  70       Attach to Order
     C                     MOVEL*BLANK    WN0180  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0181  70       Invoice Number
     C                     MOVEL*BLANK    WN0182  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0183  70       Invoice Date
     C                     MOVEL*BLANK    WN0184  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0185  1        Modified Flag
     C                     Z-ADD*ZERO     WN0186 112       A/R order Value
     C                     MOVEL*BLANK    WN0187  1        Billing Activit
     C                     MOVEL*BLANK    WN0188  1        Unused Processi
     C                     MOVEL*BLANK    WN0189  1        Unused Processi
     C                     MOVEL*BLANK    WN0190  1        EDI Status 1
     C                     MOVEL*BLANK    WN0191  1        EDI Status 2
     C                     MOVEL*BLANK    WN0192  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0193  60       Job Time
     C                     MOVEL*BLANK    WN0194 10        User Id
     C                     MOVEL*BLANK    WN0195 10        Job Name
     C                     Z-ADD*ZERO     WN0196  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWDAIC3    BEAIC3           Company Number
     C                     Z-ADDWDC4NB    BEC4NB           Order Number
      *
     C           KLCHTX    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHTX    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TXEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL*BLANK    BEBZNA           Carrier Code
     C                     Z-ADD*ZERO     BERMNB           Load ID
     C                     Z-ADD*ZERO     BER1NB           Rated Freight
     C                     MOVELWN0019    BEJPCD           Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C                     MOVE 'Y'       YBRDC
     C                     END
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) BEAATM' defaulted for 'Job Time'.
      * Field '(DB1) BEAYNA' defaulted for 'User Id'.
      * Field '(DB1) BEA0NA' defaulted for 'Job Name'.
      * Field '(DB1) BEAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##JOB     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C                     MOVE 'Y'       YBRDC
     C                     END
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - OM Load Header  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0197  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0198  1        LTL Flag
     C                     Z-ADD*ZERO     WN0199  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0200 15        Seal 1
     C                     MOVEL*BLANK    WN0201 15        Seal 2
     C                     MOVEL*BLANK    WN0202 15        Seal 3
     C                     Z-ADD*ZERO     WN0203  70       Total Weight
     C                     Z-ADD*ZERO     WN0204  50       Total Stops
     C                     MOVEL*BLANK    WN0205 20        Trailer Id
     C                     MOVEL*BLANK    WN0206  3        Initials of Con
     C                     Z-ADD*ZERO     WN0207  40       BOL Time
     C                     MOVEL*BLANK    WN0208  3        Carrier Code
     C                     MOVEL*BLANK    WN0209  7        Truck Size
     C                     Z-ADD*ZERO     WN0210  70       Actual Freight
     C                     MOVEL*BLANK    WN0211  1        Ship Status
     C                     MOVEL*BLANK    WN0212  1        Load Type
     C                     Z-ADD*ZERO     WN0213  50       Number Pallets
     C                     Z-ADD*ZERO     WN0214  50       Number Pallets
     C                     Z-ADD*ZERO     WN0215 112       Tare Lbs/Pallet
     C                     Z-ADD*ZERO     WN0216  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0217  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0218  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0219 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0220 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0221  70       Actual Departur
     C                     Z-ADD*ZERO     WN0222  40       Departure Time
     C                     Z-ADD*ZERO     WN0223  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0224  52       Product Tempera
     C                     Z-ADD*ZERO     WN0225  50       Number Pallets
     C                     MOVEL*BLANK    WN0226 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0227  70       Total Load Mile
     C                     MOVEL*BLANK    WN0228 12        Recorder ID
     C                     MOVEL*BLANK    WN0229  2        Shipping Method
     C                     MOVEL*BLANK    WN0230  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0231  2        Ship To State C
     C                     MOVEL*BLANK    WN0232  1        EDI Status 1
     C                     MOVEL*BLANK    WN0233  1        EDI Status 2
     C                     MOVEL*BLANK    WN0234  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0235  60       Job Time
     C                     MOVEL*BLANK    WN0236 10        User Id
     C                     MOVEL*BLANK    WN0237 10        Job Name
     C                     Z-ADD*ZERO     WN0238  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1AIC3    FJAIC3           Company Number
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLCHTY    KLIST
     C                     KFLD           FJAIC3           Company Number
     C                     KFLD           FJRMNB           Load ID
     C           KLCHTY    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TYEXIT
     C                     END
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       FJPKST           Load Status
     C                     Z-ADD*ZERO     FJFLAM           Flat Amount
     C                     MOVEL#1XQST    FJXQST           Allocate Pounds
     C                     Z-ADD*ZERO     FJR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     END
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     END
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     END
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQTZ01           Company Number
     C           *LIKE     DEFN WARMNB    WQTZ02           Load ID
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WQTZ01           Company Number
     C                     KFLD           WQTZ02           Load ID
      * Move fields to key list
     C                     Z-ADD#1AIC3    WQTZ01           Company Number
     C                     Z-ADD#1RMNB    WQTZ02           Load ID
     C           KRSTZ     SETLL@FLCPEB                    *
     C           KRSTZ     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - OM Load Detail  * 
     C                     EXSR NACHRC
      * CHG Clear Rated Frt    RT - OP Order Header  * 
     C                     EXSR NBRVGN
     C           KRSTZ     READE@FLCPEB                  90*
     C                     END
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
     C           XDINYY    IFLT 40
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD012       ZHSTRW  40
     C                     Z-ADD020       ZHNDRW  40
     C                     Z-ADD001       ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ037
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2PKST'  YPMTFD           Load Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              92    *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     MOVEL*BLANK    P2E5ST           USR Output Only
     C                     MOVEL*BLANK    P3G3TX           PRT Description
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P3WSST           PRT Hold Output
     C                     MOVEL*BLANK    P3WTST           PRT Save Output
     C                     Z-ADD*ZERO     P3DYNB           PRT Number of C
     C                     MOVEL*BLANK    P3WUST           PRT Night Queue
     C                     MOVEL*BLANK    P3BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P3AJAA           Company Number
     C                     Z-ADD*ZERO     P3AJAB           Date 1
     C                     Z-ADD*ZERO     P3AJAE           Order Number 1
     C                     Z-ADD*ZERO     P3M8NB           System Value Nu
     C                     MOVEL*BLANK    P3KOST           Include Todays
     C                     MOVEL*BLANK    P4XFST           Display Prt Opt
     C                     MOVEL*BLANK    P5E7ST           USR Print Detai
     C                     Z-ADD*ZERO     P6SEQ1           Seq No 1  PASS
     C                     MOVEL*BLANK    P7R4ST           USR Update Flag
     C                     MOVEL*BLANK    P8ECST           Error Status
     C                     Z-ADD*ZERO     P9CDWG           USR Weight Accu
      *
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field AS Trailer Number
     C                     MOVEL*BLANK    WUASTR  8
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field USR Weight Accumulated
     C                     Z-ADD*ZERO     WUCDWG 112
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Tare Weight Total
     C                     Z-ADD*ZERO     WUA4WG 112
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR Program name
     C                     MOVEL*BLANK    WUBNVN 10
      * Define work field USR Stop
     C                     Z-ADD*ZERO     WUTENB  30
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field USR Carrier Name
     C                     MOVEL*BLANK    WUGVTX 30
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD09        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD500       W0SLM   50
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * OMS169 - 8/26/96 - S. Schertz
      * Change 'Total Weight' in the header to reflect ' Gross Weight'.
      * OMS184 - 9/06/96 - S. Schertz
      * 1. Present the loads with Traffic Comments attached to them in
      *    a different color on the screen.
      * 2. Add an option to get to the Traffic Comments from the OMPVDFR-
      *    WW Load Plans screen.
      * 3. States displayed in subfile should be the same as the control
      *    field if the control field is not blank.
     C                     Z-ADD999999    W0SLM            *Scan limit
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0629 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0629           User Profile Na
      * Clear all neither parameters
     C                     MOVEL*BLANK    WN0630 10        User Code Model
      *
      * VAL User/Application   IF
      * RTV Program Setup      RT - User Profile Control  * 
     C                     EXSR NVRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Set Message Queue Dest. - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0629    ZA0037           User Profile Na
     C                     MOVEL'TRF'     ZA0038           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0630    IFEQ *BLANK                     *IF
      * Retrieve Appl. Profile - Application Profile  * 
     C                     EXSR NWRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Retrieve Appl. Profile - Application Profile  * 
     C                     EXSR NXRVGN
     C                     END                             *FI
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Set Message Queue Dest. - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0629    ZA0039           User Profile Na
     C                     MOVEL'TRF'     ZA0040           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NYRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * Move Appl Desc to Co Head - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
     C                     MOVEL'N'       P3WUST           PRT Night Queue
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
     C                     MOVEL'Y'       P5E7ST           USR Print Detai
     C                     MOVEL'Y'       P1TAST           First Time Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 Print Load Confirm.
