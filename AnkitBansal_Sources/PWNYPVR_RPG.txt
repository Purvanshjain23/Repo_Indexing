     H/TITLE Cpy Site ID to Prodcr PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 07/26/21  Time  : 13:47:08
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPWNYPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Cpy Site ID to Prodcr PV  Prompt & validate record
      *
     FPWADCPL1IF  E           K        DISK
      * RTV : Producer Location From/TO Retrieval index
      *
     FPLATREL3IF  E           K        DISK
      * RSQ : Producer Site             Last Seq#
      *
     FPLASREL1IF  E           K        DISK
      * RTV : Producer Site Mileage     Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPLATREL0UF  E           K        DISK                      A
      * UPD : Producer Site             Update index
      *
     FPLASREL0UF  E           K        DISK                      A
      * UPD : Producer Site Mileage     Update index
      *
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 007  5 0A
     E                    W0END   7 007  5 0A
     E                    W0NAM   7 007 10
      * Long constants
     E                    @CN#    1  03  6   @CN    25
      * Set wdw location allowed?
     E                    YSL         1  1
     I@ADCPXE
      * Producer Location From/TO Retrieval index
      * Renamed input format fields
     I              ADSDCD                          WASDCD
     I              ADSECD                          WASECD
     I              ADSFCD                          WASFCD
     I              ADSGCD                          WASGCD
     I              ADISSS                          WAISSS
     I              ADITSS                          WAITSS
     I              ADIUSS                          WAIUSS
     I              ADAAVN                          WAAAVN
     I              ADAADT                          WAAADT
     I              ADAMTM                          WAAMTM
     I              ADAJST                          WAAJST
     I              ADAHVN                          WAAHVN
     I              ADAGVN                          WAAGVN
     I              ADABVN                          WAABVN
     I              ADABDT                          WAABDT
     I              ADABTM                          WAABTM
      *
     I@ATREL3
      * Producer Site             Last Seq#
      * Renamed input format fields
     I              ATABCD                          WBABCD
     I              ATNYCD                          WBNYCD
     I              ATTETX                          WBTETX
     I              ATTZTX                          WBTZTX
     I              ATT0TX                          WBT0TX
     I              ATT1TX                          WBT1TX
     I              ATT2TX                          WBT2TX
     I              ATT3TX                          WBT3TX
     I              ATTWTX                          WBTWTX
     I              ATTXTX                          WBTXTX
     I              ATMDA1                          WBMDA1
     I              ATMEA1                          WBMEA1
     I              ATTYTX                          WBTYTX
     I              ATAXSS                          WBAXSS
     I              ATAYSS                          WBAYSS
     I              ATAZSS                          WBAZSS
     I              ATMFA1                          WBMFA1
     I              ATT4TX                          WBT4TX
     I              ATT5TX                          WBT5TX
     I              ATBGT1                          WBBGT1
     I              ATAAVN                          WBAAVN
     I              ATAADT                          WBAADT
     I              ATAMTM                          WBAMTM
     I              ATAJST                          WBAJST
     I              ATAHVN                          WBAHVN
     I              ATAGVN                          WBAGVN
     I              ATABVN                          WBABVN
     I              ATABDT                          WBABDT
     I              ATABTM                          WBABTM
      *
     I@ATRELL
      * Producer Site             Update index
      * Renamed input format fields
     I              ATABCD                          WCABCD
     I              ATNYCD                          WCNYCD
     I              ATTETX                          WCTETX
     I              ATTZTX                          WCTZTX
     I              ATT0TX                          WCT0TX
     I              ATT1TX                          WCT1TX
     I              ATT2TX                          WCT2TX
     I              ATT3TX                          WCT3TX
     I              ATTWTX                          WCTWTX
     I              ATTXTX                          WCTXTX
     I              ATMDA1                          WCMDA1
     I              ATMEA1                          WCMEA1
     I              ATTYTX                          WCTYTX
     I              ATAXSS                          WCAXSS
     I              ATAYSS                          WCAYSS
     I              ATAZSS                          WCAZSS
     I              ATMFA1                          WCMFA1
     I              ATT4TX                          WCT4TX
     I              ATT5TX                          WCT5TX
     I              ATBGT1                          WCBGT1
     I              ATAAVN                          WCAAVN
     I              ATAADT                          WCAADT
     I              ATAMTM                          WCAMTM
     I              ATAJST                          WCAJST
     I              ATAHVN                          WCAHVN
     I              ATAGVN                          WCAGVN
     I              ATABVN                          WCABVN
     I              ATABDT                          WCABDT
     I              ATABTM                          WCABTM
      *
     I@ASREK9
      * Producer Site Mileage     Retrieval index
      * Renamed input format fields
     I              ASABCD                          WDABCD
     I              ASNYCD                          WDNYCD
     I              ASLKA1                          WDLKA1
     I              ASLLA1                          WDLLA1
     I              ASTITX                          WDTITX
     I              ASA0SS                          WDA0SS
     I              ASA1SS                          WDA1SS
     I              ASAAVN                          WDAAVN
     I              ASAADT                          WDAADT
     I              ASAMTM                          WDAMTM
     I              ASAJST                          WDAJST
     I              ASAHVN                          WDAHVN
     I              ASAGVN                          WDAGVN
     I              ASABVN                          WDABVN
     I              ASABDT                          WDABDT
     I              ASABTM                          WDABTM
      *
     I@ASREK8
      * Producer Site Mileage     Update index
      * Renamed input format fields
     I              ASABCD                          WEABCD
     I              ASNYCD                          WENYCD
     I              ASLKA1                          WELKA1
     I              ASLLA1                          WELLA1
     I              ASTITX                          WETITX
     I              ASA0SS                          WEA0SS
     I              ASA1SS                          WEA1SS
     I              ASAAVN                          WEAAVN
     I              ASAADT                          WEAADT
     I              ASAMTM                          WEAMTM
     I              ASAJST                          WEAJST
     I              ASAHVN                          WEAHVN
     I              ASAGVN                          WEAGVN
     I              ASABVN                          WEABVN
     I              ASABDT                          WEABDT
     I              ASABTM                          WEABTM
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WFABCD
     I              ACAGTX                          WFAGTX
     I              ACALNB                          WFALNB
     I              ACAATH                          WFAATH
     I              ACAMNB                          WFAMNB
     I              ACIWST                          WFIWST
     I              ACAPST                          WFAPST
     I              ACGCNB                          WFGCNB
     I              ACGJNB                          WFGJNB
     I              ACC2TX                          WFC2TX
     I              ACAACD                          WFAACD
     I              ACACCD                          WFACCD
     I              ACADCD                          WFADCD
     I              ACAAVN                          WFAAVN
     I              ACAADT                          WFAADT
     I              ACAMTM                          WFAMTM
     I              ACAJST                          WFAJST
     I              ACAHVN                          WFAHVN
     I              ACAGVN                          WFAGVN
     I              ACABVN                          WFABVN
     I              ACABDT                          WFABDT
     I              ACABTM                          WFABTM
      *
     I@ATRELM
      * Producer Site             Retrieval index
      * Renamed input format fields
     I              ATABCD                          WGABCD
     I              ATNYCD                          WGNYCD
     I              ATTETX                          WGTETX
     I              ATTZTX                          WGTZTX
     I              ATT0TX                          WGT0TX
     I              ATT1TX                          WGT1TX
     I              ATT2TX                          WGT2TX
     I              ATT3TX                          WGT3TX
     I              ATTWTX                          WGTWTX
     I              ATTXTX                          WGTXTX
     I              ATMDA1                          WGMDA1
     I              ATMEA1                          WGMEA1
     I              ATTYTX                          WGTYTX
     I              ATAXSS                          WGAXSS
     I              ATAYSS                          WGAYSS
     I              ATAZSS                          WGAZSS
     I              ATMFA1                          WGMFA1
     I              ATT4TX                          WGT4TX
     I              ATT5TX                          WGT5TX
     I              ATBGT1                          WGBGT1
     I              ATAAVN                          WGAAVN
     I              ATAADT                          WGAADT
     I              ATAMTM                          WGAMTM
     I              ATAJST                          WGAJST
     I              ATAHVN                          WGAHVN
     I              ATAGVN                          WGAGVN
     I              ATABVN                          WGABVN
     I              ATABDT                          WGABDT
     I              ATABTM                          WGABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPLAT1    E DSPLATREL0
      * UPD : Producer Site             Update index
      * Renamed input format fields
     I              ATABCD                          WCABCD
     I              ATNYCD                          WCNYCD
     I              ATTETX                          WCTETX
     I              ATTZTX                          WCTZTX
     I              ATT0TX                          WCT0TX
     I              ATT1TX                          WCT1TX
     I              ATT2TX                          WCT2TX
     I              ATT3TX                          WCT3TX
     I              ATTWTX                          WCTWTX
     I              ATTXTX                          WCTXTX
     I              ATMDA1                          WCMDA1
     I              ATMEA1                          WCMEA1
     I              ATTYTX                          WCTYTX
     I              ATAXSS                          WCAXSS
     I              ATAYSS                          WCAYSS
     I              ATAZSS                          WCAZSS
     I              ATMFA1                          WCMFA1
     I              ATT4TX                          WCT4TX
     I              ATT5TX                          WCT5TX
     I              ATBGT1                          WCBGT1
     I              ATAAVN                          WCAAVN
     I              ATAADT                          WCAADT
     I              ATAMTM                          WCAMTM
     I              ATAJST                          WCAJST
     I              ATAHVN                          WCAHVN
     I              ATAGVN                          WCAGVN
     I              ATABVN                          WCABVN
     I              ATABDT                          WCABDT
     I              ATABTM                          WCABTM
      *
     IQPLAS1    E DSPLASREL0
      * UPD : Producer Site Mileage     Update index
      * Renamed input format fields
     I              ASABCD                          WEABCD
     I              ASNYCD                          WENYCD
     I              ASLKA1                          WELKA1
     I              ASLLA1                          WELLA1
     I              ASTITX                          WETITX
     I              ASA0SS                          WEA0SS
     I              ASA1SS                          WEA1SS
     I              ASAAVN                          WEAAVN
     I              ASAADT                          WEAADT
     I              ASAMTM                          WEAMTM
     I              ASAJST                          WEAJST
     I              ASAHVN                          WEAHVN
     I              ASAGVN                          WEAGVN
     I              ASABVN                          WEABVN
     I              ASABDT                          WEABDT
     I              ASABTM                          WEABTM
      *
      * Outward parameters
     IPARC        DS                             16
      * KEY : Producer Site             Retrieval index
      * I : RST PD Producer Code
     I                                        1   6 PAABCD
      * I : RST PS Site ID
     I                                        7  16 PANYCD
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Producer Site
      * I :  PD Producer Code
     I                                        1   6 P1ABCD
      * I :  PS Site ID
     I                                        7  16 P1NYCD
      * N :  PS Site Name
     I                                       17  56 P1TETX
      * N :  PS Manager
     I                                       57  96 P1TZTX
      * N :  PS Address
     I                                       97 136 P1T0TX
      * N :  PS City
     I                                      137 176 P1T1TX
      * N :  PS State
     I                                      177 179 P1T2TX
      * N :  PS Zip Code
     I                                      180 191 P1T3TX
      * N :  PS Latitude
     I                                      192 221 P1TWTX
      * N :  PS Longitude
     I                                      222 251 P1TXTX
      * N :  PS User Mileage 1
     I                                    P 252 2540P1MDA1
      * N :  PS User Mileage 2
     I                                    P 255 2570P1MEA1
      * N :  PS Facility Type/County
     I                                      258 287 P1TYTX
      * N :  PS Status 1
     I                                      288 288 P1AXSS
      * N :  PS Status 2
     I                                      289 289 P1AYSS
      * N :  PS Status 3
     I                                      290 290 P1AZSS
      * N :  PS Trace Sequence #
     I                                    P 291 2940P1MFA1
      * N :  PS Veterinarian
     I                                      295 334 P1T4TX
      * N :  PS Nutritionist
     I                                      335 374 P1T5TX
      * N :  PS Premises ID
     I                                      375 381 P1BGT1
     IP2PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Producer Site updated STP'
      * PS Site ID
     I                                        1  10 ZA0001
      * Message data for 'Producer not found.'
      * Message data for 'Producer Site Exists'
      * PD Producer Code
     I                                        1   6 ZA0002
      * PS Site ID
     I                                        7  16 ZA0003
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1ABCD    PARM           WP0001  6        PD Producer Cod
     C           P1NYCD    PARM           WP0002 10        PS Site ID
     C           P2EVTX    PARM           WP0003 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * F4=Prompt
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Prompt on new Producer Code
      * CASE: PGM.*Cursor field <IS> DTL.Producer Code New
     C           W0CFL     IFEQ '#DO4CD'                   *IF
      * Sel Producer          SR - Producer  * 
     C                     CALL 'PKA1SRR'              90  Sel Producer
     C                     PARM *BLANK    W0RTN   7
     C           #DO4CD    PARM #DO4CD    WQ0001  6        PD Producer Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKA1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Crt Producer Site     IF
      * R10369 JJH 05/22/17 - Producer Site Sync 960 with 440
      * Rtv Producer To-1stRcdRT - Producer Location From/TO  * 
     C                     EXSR SARVGN
      * CASE: LCL.Producer To is Blank
     C           YL0002    IFEQ *BLANK                     *IF
      * Producer is not in the Producer Location From/To file.
     C                     MOVEL'N'       YL0003           Copy Producer S
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Company Values    XF - STR Order Management Sys  * PRDSTFMLIB
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0002  30       BOH Company Num
     C                     PARM @CN,001   WQ0003 10        Company Value C
     C           YL0004    PARM *BLANK    WQ0004 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * PRDSTTOLIB
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0005  30       BOH Company Num
     C                     PARM @CN,002   WQ0006 10        Company Value C
     C           YL0005    PARM *BLANK    WQ0007 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Producer Site From Lib is Blank
      *   |- c2    : LCL.Producer Site To Lib is Blank
      *   '-
     C           YL0004    IFEQ *BLANK                     *IF
     C           YL0005    OREQ *BLANK                     *OR
      * Send message 'Producer Site CoValue Mis'
     C                     MOVEL'PRK1435' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0003           Copy Producer S
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD999999    YL0006           PS Trace Sequen
      * Rtv Last Seq#         RT - Producer Site  * 
     C                     EXSR SBRVGN
      * E3814 JJH 10/05/15 - Add PS Premises ID
      * Crt Producer Site     CR - Producer Site  * 
     C                     EXSR SCCRRC
      * R10369 JJH 05/22/17 - Producer Site Sync 960 with 440
      * CASE: LCL.Copy Producer Site to STP is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * Cpy PrdcrSite FmToLib CL - Producer Site  * 
     C                     CALL 'PWB9UPC'              90  Cpy PrdcrSite F
     C                     PARM #DO4CD    WQ0010  6        PD Producer Cod
     C                     PARM #DOWCD    WQ0011 10        PS Site ID
     C                     PARM YL0004    WQ0012 10        Producer Site F
     C                     PARM YL0005    WQ0013 10        Producer Site T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWB9UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     END
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.Action Type is Copy
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'Y'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DOWCD    ZA0001           PS Site ID
      * Send message 'Producer Site updated STP'
     C                     MOVEL'PRK1436' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Site Milg for Cpy RT - Producer Site Mileage  * 
     C                     EXSR SDRVGN
      * Edt Site Information  ET - Producer Site  * 
     C                     CLEARPARC
     C                     MOVEL#DO4CD    PAABCD    P      PD Producer Cod
     C                     MOVEL#DOWCD    PANYCD    P      PS Site ID
      *
     C                     CALL 'PLGMETR'              90  Edt Site Inform
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Producer S
     C                     PARM P2EVTX    WQ0014 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLGMETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
      * If F3 pressed from edit screen, delete temporary records
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,003                    *IF
      * Dlt Producer Site     IF
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Rtv Producer To-1stRcdRT - Producer Location From/TO  * 
     C                     EXSR SFRVGN
      * If Producer To is not blank, set up From and To libraries
      * CASE: LCL.Producer To is Blank
     C           YL0007    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       YL0008           Copy Producer S
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Company Values    XF - STR Order Management Sys  * PRDSTFMLIB
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0015  30       BOH Company Num
     C                     PARM @CN,001   WQ0016 10        Company Value C
     C           YL0009    PARM *BLANK    WQ0017 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * PRDSTTOLIB
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0018  30       BOH Company Num
     C                     PARM @CN,002   WQ0019 10        Company Value C
     C           YL0010    PARM *BLANK    WQ0020 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If either Producer From Lib or Producer To Lib are blank. SNDERRM
      * CASE: Producer From Lib OR Producer To Lib are blank
      *  - c1 OR c2
      *   |- c1    : LCL.Producer Site From Lib is Blank
      *   |- c2    : LCL.Producer Site To Lib is Blank
      *   '-
     C           YL0009    IFEQ *BLANK                     *IF
     C           YL0010    OREQ *BLANK                     *OR
      * Send message 'Producer Site CoValue Mis'
     C                     MOVEL'PRK1435' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0008           Copy Producer S
     C                     END                             *FI
     C                     END                             *FI
      * Delete Producer Site
      * Del Producer Site     DL - Producer Site  * 
     C                     EXSR SGDLRC
      * Delete Producer Site Mileage
      * Dlt Site Milg for Cpy RT - Producer Site Mileage  * 
     C                     EXSR SHRVGN
      * Producer Site Sync 960 with 440: Delete 440 Producer Site
      * CASE: LCL.Copy Producer Site to STP is Yes
     C           YL0008    IFEQ 'Y'                        *IF
      * Dlt PrdcrSite FmToLib CL - Producer Site  * 
     C                     CALL 'PWNZUPC'              90  Dlt PrdcrSite F
     C                     PARM #DO4CD    WQ0021  6        PD Producer Cod
     C                     PARM #DOWCD    WQ0022 10        PS Site ID
     C                     PARM YL0009    WQ0023 10        Producer Site F
     C                     PARM YL0010    WQ0024 10        Producer Site T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNZUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Rtv Producer Record   RT - Producer  * Check exists
     C                     EXSR SJRVGN
      * If record not found, send error message
      * CASE:
      *  - NOTc1
      *   |- c1    : PGM.*Return code is *Normal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Send message 'Producer not found.'
     C                     MOVEL'PRK1045' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Producer
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DTFTX           Site Name DRV
      * Site Name DRV
      * Rtv Site Name ActOnly RT - Producer Site  * 
     C                     EXSR SKRVGN
     C                     MOVEL*BLANK    #DA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SLRVGN
     C                     MOVEL*BLANK    #DIST1           Producer Name N
      * Producer Name New     DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SMRVGN
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * Chk Site Exists       RT - Producer Site  * 
     C                     EXSR SNRVGN
      * If New Producer Site already exists, send error message
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DO4CD    ZA0002           Producer Code N
     C                     MOVEL#DOWCD    ZA0003           Site Id New
      * Send message 'Producer Site Exists'
     C                     MOVEL'PRK1610' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993132*
      *
     C                     END                             *FI
     C                     END
      * Producer Code New required
     C           #DO4CD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Site Id New required
     C           #DOWCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     EXSR ZVCFPM
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVEL*BLANK    #1TETX           PS Site Name
     C                     MOVEL*BLANK    #1TZTX           PS Manager
     C                     MOVEL*BLANK    #1T0TX           PS Address
     C                     MOVEL*BLANK    #1T1TX           PS City
     C                     MOVEL*BLANK    #1T2TX           PS State
     C                     MOVEL*BLANK    #1T3TX           PS Zip Code
     C                     MOVEL*BLANK    #1TWTX           PS Latitude
     C                     MOVEL*BLANK    #1TXTX           PS Longitude
     C                     Z-ADD*ZERO     #1MDA1           PS User Mileage
     C                     Z-ADD*ZERO     #1MEA1           PS User Mileage
     C                     MOVEL*BLANK    #1TYTX           PS Facility Typ
     C                     MOVEL*BLANK    #1AXSS           PS Status 1
     C                     MOVEL*BLANK    #1AYSS           PS Status 2
     C                     MOVEL*BLANK    #1AZSS           PS Status 3
     C                     MOVEL*BLANK    #1T4TX           PS Veterinarian
     C                     MOVEL*BLANK    #1T5TX           PS Nutritionist
     C                     MOVEL*BLANK    #1BGT1           PS Premises ID
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #DA4TX           Producer Name
     C                     MOVEL*BLANK    #1NYCD           PS Site ID
     C                     MOVEL*BLANK    #DTFTX           Site Name DRV
     C                     MOVEL*BLANK    #DO4CD           Producer Code N
     C                     MOVEL*BLANK    #DIST1           Producer Name N
     C                     MOVEL*BLANK    #DOWCD           Site Id New
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DTFTX           Site Name DRV
      * Site Name DRV
      * Rtv Site Name ActOnly RT - Producer Site  * 
     C                     EXSR SORVGN
     C                     MOVEL*BLANK    #DA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    #DIST1           Producer Name N
      * Producer Name New     DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SQRVGN
      * USER: Load screen
      * DTL = PAR By name
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP1NYCD    #1NYCD           PS Site ID
     C                     MOVELP1TETX    #1TETX           PS Site Name
     C                     MOVELP1TZTX    #1TZTX           PS Manager
     C                     MOVELP1T0TX    #1T0TX           PS Address
     C                     MOVELP1T1TX    #1T1TX           PS City
     C                     MOVELP1T2TX    #1T2TX           PS State
     C                     MOVELP1T3TX    #1T3TX           PS Zip Code
     C                     MOVELP1TWTX    #1TWTX           PS Latitude
     C                     MOVELP1TXTX    #1TXTX           PS Longitude
     C                     Z-ADDP1MDA1    #1MDA1           PS User Mileage
     C                     Z-ADDP1MEA1    #1MEA1           PS User Mileage
     C                     MOVELP1TYTX    #1TYTX           PS Facility Typ
     C                     MOVELP1AXSS    #1AXSS           PS Status 1
     C                     MOVELP1AYSS    #1AYSS           PS Status 2
     C                     MOVELP1AZSS    #1AZSS           PS Status 3
     C                     MOVELP1T4TX    #1T4TX           PS Veterinarian
     C                     MOVELP1T5TX    #1T5TX           PS Nutritionist
     C                     MOVELP1BGT1    #1BGT1           PS Premises ID
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Producer To-1stRcdRT - Producer Location From/TO  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WASDCD    WQSA01           Producer From
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Producer From
      * Setup key
     C                     MOVEL#DO4CD    WQSA01           Producer From
      * Establish starting position
     C           KRSSA     SETLL@ADCPXE                    *
     C           KRSSA     READE@ADCPXE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1426' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Producer To
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWASFCD    YL0002           Producer To
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@ADCPXE                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Last Seq#         RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WBMFA1           PS Trace Sequen
      * Setup key
     C                     Z-ADDYL0006    WBMFA1           PS Trace Sequen
      * Establish starting position
     C           KPSSB     SETLL@ATREL3                    *
     C                     READ @ATREL3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * The trace sequence number will start at 900000
     C                     Z-ADD900000    YL0006           PS Trace Sequen
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBMFA1    ADD  1         YL0006           PS Trace Sequen
     C                     GOTO SBEXIT                     *QUIT
     C                     READ @ATREL3                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt Producer Site     CR - Producer Site  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 10        RS User Changed
     C                     Z-ADD*ZERO     WN0002  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0003  60       RS Time Changed
     C                     MOVEL*BLANK    WN0004 10        RS Job
     C                     MOVEL*BLANK    WN0005 10        RS Program
     C                     MOVEL*BLANK    WN0006 10        RS User Added
     C                     Z-ADD*ZERO     WN0007  70       RS Date Added
     C                     Z-ADD*ZERO     WN0008  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ATRELL
     C                     MOVEL#DO4CD    WCABCD           PD Producer Cod
     C                     MOVEL#DOWCD    WCNYCD           PS Site ID
     C                     MOVEL#1TETX    WCTETX           PS Site Name
     C                     MOVEL#1TZTX    WCTZTX           PS Manager
     C                     MOVEL#1T0TX    WCT0TX           PS Address
     C                     MOVEL#1T1TX    WCT1TX           PS City
     C                     MOVEL#1T2TX    WCT2TX           PS State
     C                     MOVEL#1T3TX    WCT3TX           PS Zip Code
     C                     MOVEL#1TWTX    WCTWTX           PS Latitude
     C                     MOVEL#1TXTX    WCTXTX           PS Longitude
     C                     Z-ADD#1MDA1    WCMDA1           PS User Mileage
     C                     Z-ADD#1MEA1    WCMEA1           PS User Mileage
     C                     MOVEL#1TYTX    WCTYTX           PS Facility Typ
     C                     MOVEL#1AXSS    WCAXSS           PS Status 1
     C                     MOVEL#1AYSS    WCAYSS           PS Status 2
     C                     MOVEL#1AZSS    WCAZSS           PS Status 3
     C                     Z-ADDYL0006    WCMFA1           PS Trace Sequen
     C                     MOVEL#1T4TX    WCT4TX           PS Veterinarian
     C                     MOVEL#1T5TX    WCT5TX           PS Nutritionist
     C                     MOVEL#1BGT1    WCBGT1           PS Premises ID
     C                     MOVEL'A'       WCAJST           RS Record Statu
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WCABDT    PARM *ZERO     WQ0008  70       *DATE
     C           WCABTM    PARM *ZERO     WQ0009  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSC    KLIST
     C                     KFLD           WCABCD           PD Producer Cod
     C                     KFLD           WCNYCD           PS Site ID
      * Check for duplicate primary key
     C           KLCRSC    SETLL@ATRELL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1138' W0RTN   7
      * Send message 'Producer Site          EX'
     C                     MOVEL'PRK1138' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@ATRELL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Site Milg for Cpy RT - Producer Site Mileage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDABCD    WQSD01           PD Producer Cod
     C           *LIKE     DEFN WDNYCD    WQSD02           PS Site ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           PD Producer Cod
     C                     KFLD           WQSD02           PS Site ID
      * Setup key
     C                     MOVEL#1ABCD    WQSD01           PD Producer Cod
     C                     MOVEL#1NYCD    WQSD02           PS Site ID
      * Establish starting position
     C           KRSSD     SETLL@ASREK9                    *
     C           KRSSD     READE@ASREK9                  90*
      * Data record not found
     C   90                MOVEL'PRK1132' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Prod Site Mlg Cpy CR - Producer Site Mileage  * 
     C                     EXSR SECRRC
     C           KRSSD     READE@ASREK9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Prod Site Mlg Cpy CR - Producer Site Mileage  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0009 10        RS User Changed
     C                     Z-ADD*ZERO     WN0010  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0011  60       RS Time Changed
     C                     MOVEL*BLANK    WN0012  1        RS Record Statu
     C                     MOVEL*BLANK    WN0013 10        RS Job
     C                     MOVEL*BLANK    WN0014 10        RS Program
     C                     MOVEL*BLANK    WN0015 10        RS User Added
     C                     Z-ADD*ZERO     WN0016  70       RS Date Added
     C                     Z-ADD*ZERO     WN0017  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ASREK8
     C                     MOVEL#DO4CD    WEABCD           PD Producer Cod
     C                     MOVEL#DOWCD    WENYCD           PS Site ID
     C                     Z-ADDWDLKA1    WELKA1           PSM Company Num
     C                     Z-ADDWDLLA1    WELLA1           PSM Miles to Co
     C                     MOVELWDTITX    WETITX           PSM User Status
     C                     MOVELWDA0SS    WEA0SS           PSM User Status
     C                     MOVELWDA1SS    WEA1SS           PSM User Status
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL'I'       WEAJST           RS Record Statu
     C           KLCRSE    KLIST
     C                     KFLD           WEABCD           PD Producer Cod
     C                     KFLD           WENYCD           PS Site ID
     C                     KFLD           WELKA1           PSM Company Num
      * Check for duplicate primary key
     C           KLCRSE    SETLL@ASREK8                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1133' W0RTN   7
      * Send message 'Producer Site Mileage  EX'
     C                     MOVEL'PRK1133' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@ASREK8                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Producer To-1stRcdRT - Producer Location From/TO  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WASDCD    WQSF01           Producer From
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Producer From
      * Setup key
     C                     MOVEL#DO4CD    WQSF01           Producer From
      * Establish starting position
     C           KRSSF     SETLL@ADCPXE                    *
     C           KRSSF     READE@ADCPXE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1426' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Producer To
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWASFCD    YL0007           Producer To
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@ADCPXE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Del Producer Site     DL - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @ATRELL
     C                     MOVEL#DO4CD    WCABCD           PD Producer Cod
     C                     MOVEL#DOWCD    WCNYCD           PS Site ID
      *
     C           KLDLSG    KLIST
     C                     KFLD           WCABCD           PD Producer Cod
     C                     KFLD           WCNYCD           PS Site ID
     C           KLDLSG    CHAIN@ATRELL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLATREL0'MDACP
     C                     MOVEL'@ATRELL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@ATRELL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Dlt Site Milg for Cpy RT - Producer Site Mileage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDABCD    WQSH01           PD Producer Cod
     C           *LIKE     DEFN WDNYCD    WQSH02           PS Site ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           PD Producer Cod
     C                     KFLD           WQSH02           PS Site ID
      * Setup key
     C                     MOVEL#DO4CD    WQSH01           PD Producer Cod
     C                     MOVEL#DOWCD    WQSH02           PS Site ID
      * Establish starting position
     C           KRSSH     SETLL@ASREK9                    *
     C           KRSSH     READE@ASREK9                  90*
      * Data record not found
     C   90                MOVEL'PRK1132' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Prod Loc Dlv Co   DO - Producer Site Mileage  * 
     C                     EXSR SIDLRC
     C           KRSSH     READE@ASREK9                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Dlt Prod Loc Dlv Co   DO - Producer Site Mileage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @ASREK8
     C                     MOVELWDABCD    WEABCD           PD Producer Cod
     C                     MOVELWDNYCD    WENYCD           PS Site ID
     C                     Z-ADDWDLKA1    WELKA1           PSM Company Num
      *
     C           KLDLSI    KLIST
     C                     KFLD           WEABCD           PD Producer Cod
     C                     KFLD           WENYCD           PS Site ID
     C                     KFLD           WELKA1           PSM Company Num
     C           KLDLSI    CHAIN@ASREK8              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLASREL0'MDACP
     C                     MOVEL'@ASREK8' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@ASREK8                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Producer Record   RT - Producer  * Check exists
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WFABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#DO4CD    WFABCD           PD Producer Cod
      * Establish starting position
     C           KRSSJ     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Site Name ActOnly RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WGABCD           PD Producer Cod
     C                     KFLD           WGNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    WGABCD           PD Producer Cod
     C                     MOVELP1NYCD    WGNYCD           PS Site ID
      * Establish starting position
     C           KRSSK     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DTFTX           PS Site Name
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WGAJST    IFEQ 'A'                        *IF
     C                     MOVELWGTETX    #DTFTX           PS Site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DTFTX           PS Site Name
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WFABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WFABCD           PD Producer Cod
      * Establish starting position
     C           KRSSL     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAGTX    #DA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WFABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#DO4CD    WFABCD           PD Producer Cod
      * Establish starting position
     C           KRSSM     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAGTX    #DIST1           PD Name
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Chk Site Exists       RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WGABCD           PD Producer Cod
     C                     KFLD           WGNYCD           PS Site ID
      * Setup key
     C                     MOVEL#DO4CD    WGABCD           PD Producer Cod
     C                     MOVEL#DOWCD    WGNYCD           PS Site ID
      * Establish starting position
     C           KRSSN     CHAIN@ATRELM              90    *
      * Data record not found
     C   90                MOVEL'PRK1137' W0RTN   7
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Site Name ActOnly RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WGABCD           PD Producer Cod
     C                     KFLD           WGNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    WGABCD           PD Producer Cod
     C                     MOVELP1NYCD    WGNYCD           PS Site ID
      * Establish starting position
     C           KRSSO     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DTFTX           PS Site Name
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WGAJST    IFEQ 'A'                        *IF
     C                     MOVELWGTETX    #DTFTX           PS Site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DTFTX           PS Site Name
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WFABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WFABCD           PD Producer Cod
      * Establish starting position
     C           KRSSP     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAGTX    #DA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WFABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#DO4CD    WFABCD           PD Producer Cod
      * Establish starting position
     C           KRSSQ     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAGTX    #DIST1           PD Name
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv PrdSite Inform    RT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WGABCD           PD Producer Cod
     C                     KFLD           WGNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    WGABCD           PD Producer Cod
     C                     MOVELP1NYCD    WGNYCD           PS Site ID
      * Establish starting position
     C           KRSSR     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1TETX           PS Site Name
     C                     MOVEL*BLANK    P1TZTX           PS Manager
     C                     MOVEL*BLANK    P1T0TX           PS Address
     C                     MOVEL*BLANK    P1T1TX           PS City
     C                     MOVEL*BLANK    P1T2TX           PS State
     C                     MOVEL*BLANK    P1T3TX           PS Zip Code
     C                     MOVEL*BLANK    P1TWTX           PS Latitude
     C                     MOVEL*BLANK    P1TXTX           PS Longitude
     C                     Z-ADD*ZERO     P1MDA1           PS User Mileage
     C                     Z-ADD*ZERO     P1MEA1           PS User Mileage
     C                     MOVEL*BLANK    P1TYTX           PS Facility Typ
     C                     MOVEL*BLANK    P1AXSS           PS Status 1
     C                     MOVEL*BLANK    P1AYSS           PS Status 2
     C                     MOVEL*BLANK    P1AZSS           PS Status 3
     C                     Z-ADD*ZERO     P1MFA1           PS Trace Sequen
     C                     MOVEL*BLANK    P1T4TX           PS Veterinarian
     C                     MOVEL*BLANK    P1T5TX           PS Nutritionist
     C                     MOVEL*BLANK    P1BGT1           PS Premises ID
     C                     MOVEL*BLANK    YL0011           RS Record Statu
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGTETX    P1TETX           PS Site Name
     C                     MOVELWGTZTX    P1TZTX           PS Manager
     C                     MOVELWGT0TX    P1T0TX           PS Address
     C                     MOVELWGT1TX    P1T1TX           PS City
     C                     MOVELWGT2TX    P1T2TX           PS State
     C                     MOVELWGT3TX    P1T3TX           PS Zip Code
     C                     MOVELWGTWTX    P1TWTX           PS Latitude
     C                     MOVELWGTXTX    P1TXTX           PS Longitude
     C                     Z-ADDWGMDA1    P1MDA1           PS User Mileage
     C                     Z-ADDWGMEA1    P1MEA1           PS User Mileage
     C                     MOVELWGTYTX    P1TYTX           PS Facility Typ
     C                     MOVELWGAXSS    P1AXSS           PS Status 1
     C                     MOVELWGAYSS    P1AYSS           PS Status 2
     C                     MOVELWGAZSS    P1AZSS           PS Status 3
     C                     Z-ADDWGMFA1    P1MFA1           PS Trace Sequen
     C                     MOVELWGT4TX    P1T4TX           PS Veterinarian
     C                     MOVELWGT5TX    P1T5TX           PS Nutritionist
     C                     MOVELWGBGT1    P1BGT1           PS Premises ID
     C                     MOVELWGAJST    YL0011           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * WHD72337 JBB  7/26/21 - Copy Producer Site
      * - Function created.  Delete all records created from a copy
      *   Producer Site action.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modifiecation history
      *================================================================
      *  7/23/2021 JBB WHD72337 - [ME] Copy Function for Site Information
      *                           Function created. Copy a Producer Site
      *                           from one Producer/Site to another
      *                           Producer.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1NYCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PS Site ID
     C           YPMTFD    OREQ '#1NYCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1NYCD' defaulted for 'PS Site ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P2EVTX' defaulted for 'Oms System Value Alpha'.
     C                     CALL 'PLGKSRR'              90  Sel Producer Si
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0025  6        PD Producer Cod
     C           #1NYCD    PARM #1NYCD    WQ0026 10        PS Site ID
     C                     PARM P2EVTX    WQ0027 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLGKSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1NYCD    IFNE *BLANK                     PS Site ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Producer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
     C                     CALL 'PKA1SRR'              90  Sel Producer
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0028  6        PD Producer Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKA1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWF    KLIST
     C                     KFLD           WFABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WFABCD
     C           KLVBWF    CHAIN@ACREAI              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Producer               NF'
     C                     MOVEL'PRK0009' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0009' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     MOVEL'Y'       YSL,1            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C                     WRITEASSUME
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YSL,1     IFEQ 'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD076       YWWDWD           Window width
     C                     Z-ADD014       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZVCFPM    BEGSR
      *================================================================
      * Set Confirm Prompt window location
      *================================================================
      *
     C           ##WSR     ADD  014       YWWDRW
     C           ##WSC     ADD  076       YWWDCL
      *
     C                     ADD  1         YWWDCL
     C                     SUB  1         YWWDRW           Window start ro
     C                     SUB  21        YWWDCL           Window start co
     C                     Z-ADD18        YWWDWD           Window width
     C                     Z-ADD2         YWWDDP           Window depth
     C                     MOVEL'*TL  '   YWWDCR           Window referenc
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN           Retrieval Funct
     C                     EXSR ZURTLC                     Retrieve window
     C                     Z-ADDYWWDRW    ##WSRC           *Window start r
     C                     Z-ADDYWWDCL    ##WSCC           *Window start c
      *
      *================================================================
     CSR         ZVEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1TETX           PS Site Name
     C                     MOVEL*BLANK    P1TZTX           PS Manager
     C                     MOVEL*BLANK    P1T0TX           PS Address
     C                     MOVEL*BLANK    P1T1TX           PS City
     C                     MOVEL*BLANK    P1T2TX           PS State
     C                     MOVEL*BLANK    P1T3TX           PS Zip Code
     C                     MOVEL*BLANK    P1TWTX           PS Latitude
     C                     MOVEL*BLANK    P1TXTX           PS Longitude
     C                     Z-ADD*ZERO     P1MDA1           PS User Mileage
     C                     Z-ADD*ZERO     P1MEA1           PS User Mileage
     C                     MOVEL*BLANK    P1TYTX           PS Facility Typ
     C                     MOVEL*BLANK    P1AXSS           PS Status 1
     C                     MOVEL*BLANK    P1AYSS           PS Status 2
     C                     MOVEL*BLANK    P1AZSS           PS Status 3
     C                     Z-ADD*ZERO     P1MFA1           PS Trace Sequen
     C                     MOVEL*BLANK    P1T4TX           PS Veterinarian
     C                     MOVEL*BLANK    P1T5TX           PS Nutritionist
     C                     MOVEL*BLANK    P1BGT1           PS Premises ID
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBMDA1           PS User Mileage
     C                     Z-ADD*ZERO     WBMEA1           PS User Mileage
     C                     Z-ADD*ZERO     WBMFA1           PS Trace Sequen
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Clear all neither parameters
      * Crt Producer Site     CR - Producer Site  * 
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDLKA1           PSM Company Num
     C                     Z-ADD*ZERO     WDLLA1           PSM Miles to Co
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Clear all neither parameters
      * Crt Prod Site Mlg Cpy CR - Producer Site Mileage  * 
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFALNB           PD Production C
     C                     Z-ADD*ZERO     WFAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WFAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WFGCNB           PD VND Address
     C                     Z-ADD*ZERO     WFGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field PS Trace Sequence #
     C                     Z-ADD*ZERO     YL0001  60
      * Define local work field Producer To
     C                     MOVEL*BLANK    YL0002  6
      * Define local work field Copy Producer Site to STP
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Producer Site From Lib
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field Producer Site To Lib
     C                     MOVEL*BLANK    YL0005 10
      * Define local work field PS Trace Sequence #
     C                     Z-ADD*ZERO     YL0006  60
      * Define local work field Producer To
     C                     MOVEL*BLANK    YL0007  6
      * Define local work field Copy Producer Site to STP
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Producer Site From Lib
     C                     MOVEL*BLANK    YL0009 10
      * Define local work field Producer Site To Lib
     C                     MOVEL*BLANK    YL0010 10
      * Define null work field PD Name
     C                     MOVEL*BLANK    YN0001 40
      * Define null work field PD Production Capacity
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field PD Std Delv Time
     C                     Z-ADD*ZERO     YN0003  40
      * Define null work field PD Std Truck Size
     C                     Z-ADD*ZERO     YN0004  50
      * Define null work field PD Freight Exp Paid By
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field PD Fax Status
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field PD VND Address Number
     C                     Z-ADD*ZERO     YN0007  80
      * Define null work field PD EDI Trading Partner #
     C                     Z-ADD*ZERO     YN0008  80
      * Define null work field PD VND Category
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field SR Source Code
     C                     MOVEL*BLANK    YN0010  3
      * Define null work field HB Buyer Code
     C                     MOVEL*BLANK    YN0011  3
      * Define null work field Commission Producer Payee
     C                     MOVEL*BLANK    YN0012  6
      * Define null work field RS User Changed
     C                     MOVEL*BLANK    YN0013 10
      * Define null work field RS Date Changed
     C                     Z-ADD*ZERO     YN0014  70
      * Define null work field RS Time Changed
     C                     Z-ADD*ZERO     YN0015  60
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field RS Job
     C                     MOVEL*BLANK    YN0017 10
      * Define null work field RS Program
     C                     MOVEL*BLANK    YN0018 10
      * Define null work field RS User Added
     C                     MOVEL*BLANK    YN0019 10
      * Define null work field RS Date Added
     C                     Z-ADD*ZERO     YN0020  70
      * Define null work field RS Time Added
     C                     Z-ADD*ZERO     YN0021  60
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0011  1
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifiecation history
     C                     EXSR UBSUBR                     Modifiecation h
      * Retrieve Producer Site values from record being copied
      * Rtv PrdSite Inform    RT - Producer Site  * 
     C                     EXSR SRRVGN
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01302013140155801570023260233802582
** W0END
01307013530156701609023310237702591
** W0NAM
#1ABCD    #DA4TX    #1NYCD    #DTFTX    #DO4CD    #DIST1    #DOWCD
** @CN
00001 PRDSTFMLIB
00002 PRDSTTOLIB
00003 Y2U9999
