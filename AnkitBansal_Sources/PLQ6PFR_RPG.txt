     H/TITLE Prt Truck WaitTime ExcPF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 02/02/21  Time  : 13:05:42
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLBEREL1IF  E           K        DISK
      * RTV : Company Process Values    Retrieval index
      *
     FPLAFCPLCIF  E           K        DISK
      * RSQ : Delivery Tracking         co/delkey/killdate
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPLAHCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking Comment Rtv with Line No (D)
      *
     FPLAHCPL0IF  E           K        DISK                      A
      * UPD : Delivery Tracking Comment Update index
      *
     FPLQ6PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Truck WaitTime ExcPF  Print file
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WAABCD
     I              AFAECD                          WAAECD
     I              AFA8TX                          WAA8TX
     I              AFGLNB                          WAGLNB
     I              AFATST                          WAATST
     I              AFASNB                          WAASNB
     I              AFAUST                          WAAUST
     I              AFQNST                          WAQNST
     I              AFQOST                          WAQOST
     I              AFQPST                          WAQPST
     I              AFQQST                          WAQQST
     I              AFQRST                          WAQRST
     I              AFN0TX                          WAN0TX
     I              AFQSST                          WAQSST
     I              AFQTST                          WAQTST
     I              AFQUST                          WAQUST
     I              AFQVST                          WAQVST
     I              AFR8ST                          WAR8ST
     I              AFR9ST                          WAR9ST
     I              AFSAST                          WASAST
     I              AFSBST                          WASBST
     I              AFSDST                          WASDST
     I              AFSEST                          WASEST
     I              AFSFST                          WASFST
     I              AFHWNB                          WAHWNB
     I              AFFUCD                          WAFUCD
     I              AFAAVN                          WAAAVN
     I              AFAADT                          WAAADT
     I              AFAMTM                          WAAMTM
     I              AFAJST                          WAAJST
     I              AFAHVN                          WAAHVN
     I              AFAGVN                          WAAGVN
     I              AFABVN                          WAABVN
     I              AFABDT                          WAABDT
     I              AFABTM                          WAABTM
      *
     I@AHCPIR
      * Delivery Tracking Comment Update index
      * Renamed input format fields
     I              AHHONB                          WBHONB
     I              AHE0DT                          WBE0DT
     I              AHE9DT                          WBE9DT
     I              AHAJTH                          WBAJTH
     I              AHH4A1                          WBH4A1
     I              AHH7A1                          WBH7A1
     I              AHSGTX                          WBSGTX
     I              AHAAVN                          WBAAVN
     I              AHAADT                          WBAADT
     I              AHAMTM                          WBAMTM
     I              AHAJST                          WBAJST
     I              AHAHVN                          WBAHVN
     I              AHAGVN                          WBAGVN
     I              AHABVN                          WBABVN
     I              AHABDT                          WBABDT
     I              AHABTM                          WBABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXTCK2       DS
      * Time: hours, minutes, seconds (2)
     I                                        1   60XTTIM2
     I                                        1   20XTHH2
     I                                        3   40XTNN2
     I                                        5   60XTSS2
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
     IQPLAH1    E DSPLAHCPL0
      * UPD : Delivery Tracking Comment Update index
      * Renamed input format fields
     I              AHHONB                          WBHONB
     I              AHE0DT                          WBE0DT
     I              AHE9DT                          WBE9DT
     I              AHAJTH                          WBAJTH
     I              AHH4A1                          WBH4A1
     I              AHH7A1                          WBH7A1
     I              AHSGTX                          WBSGTX
     I              AHAAVN                          WBAAVN
     I              AHAADT                          WBAADT
     I              AHAMTM                          WBAMTM
     I              AHAJST                          WBAJST
     I              AHAHVN                          WBAHVN
     I              AHAGVN                          WBAGVN
     I              AHABVN                          WBABVN
     I              AHABDT                          WBABDT
     I              AHABTM                          WBABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Delivery Tracking
      * I : RST CC Company Number
     I                                    P   1   20P1HONB
      * I : POS DT Delivery Date
     I                                    P   3   60P1E9DT
     IP2PARM      DS
      * B : MAP Record was selected usr
     I                                        1   1 P2MXST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1E9DT    PARM           WP0002  70       DT Delivery Dat
     C           P2MXST    PARM P2MXST    WP0003  1        Record was sele
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Truck WaitTime ExcPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$GENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Truck WaitTime ExcPF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHONB    WQKA01           CC Company Numb
      * Define keylist
     C           KPSA      KLIST
     C                     KFLD           WQKA01           CC Company Numb
     C                     KFLD           AFE9DT           DT Delivery Dat
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WQKA01           CC Company Numb
     C                     Z-ADDP1E9DT    AFE9DT           DT Delivery Dat
      * Establish starting position
     C           KPSA      SETLL@AFCPQ9                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt  US - STR User Source Functions  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUMFST           Usr Display 1
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        CC Company Numb
     C                     MOVEL'Y'       W0AL01  1        DT Delivery Dat
     C                     MOVEL'Y'       W0AL02  1        DT Delivery Tim
     C                     MOVEL'Y'       W0AL03  1        DT Delivery Tim
     C                     MOVEL'Y'       W0AL04  1        DSH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CHONB           CC Company Numb
     C                     Z-ADD*ZERO     $CF2DT           Date From
     C                     Z-ADD*ZERO     $CB4DT           Date To   USR
     C                     Z-ADD*ZERO     $CA8TM           Time Beg USR
     C                     Z-ADD*ZERO     $CB7TH           COPR Time
     C                     MOVEL*BLANK    $CABCD           PD Producer Cod
     C                     MOVEL*BLANK    $CA4TX           Producer Name
     C                     MOVEL*BLANK    $CLHCD           DT Transportati
     C                     MOVEL*BLANK    $CSQTX           HPS Trans Ofc D
     C                     MOVEL*BLANK    $CLICD           DT Trucker Code
     C                     MOVEL*BLANK    $CSNTX           HPS Trucker Nam
     C                     MOVEL*BLANK    $CJ8CD           DT Driver
     C                     MOVEL*BLANK    $CSLTX           HPS Driver Name
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDAFHONB    $DHONB           CC Company Numb
     C                     Z-ADDAFIEA1    $DIEA1           DT Movement Num
     C                     Z-ADDAFICA1    $DICA1           DT Farm Site Co
     C                     MOVELAFJ9CD    $DJ9CD           DT Loading Crew
     C                     MOVELAFKBCD    $DKBCD           DT Truck ID
     C                     MOVELAFKZCD    $DKZCD           DT Trailer ID
     C                     Z-ADDAFE9DT    $DE9DT           DT Delivery Dat
     C                     Z-ADDAFAJTH    $DAJTH           DT Delivery Tim
     C                     Z-ADDAFH4A1    $DH4A1           DT Delivery Tim
     C                     Z-ADDAFE0DT    $DE0DT           DSH Kill Date
     C                     Z-ADDAFFBDT    $DFBDT           DT Route Start
     C                     Z-ADDAFFCDT    $DFCDT           DT Arrive @ Far
     C                     Z-ADDAFFDDT    $DFDDT           DT Start Loadin
     C                     Z-ADDAFFFDT    $DFFDT           DT Leave Farm D
     C                     Z-ADDAFFHDT    $DFHDT           DT Arrive @ Pla
     C                     Z-ADDAFAVTH    $DAVTH           DT Arrive @ Pla
     C                     Z-ADDAFFIDT    $DFIDT           DT TrkScl Weigh
     C                     Z-ADDAFAXTH    $DAXTH           DT TrkScl Weigh
     C                     Z-ADDAFFJDT    $DFJDT           DT To Recv Dock
     C                     Z-ADDAFFKDT    $DFKDT           DT Start Unload
     C                     Z-ADDAFFMDT    $DFMDT           DT TrkScl Weigh
     C                     MOVEL*BLANK    $DOBTX           Text descriptio
     C                     Z-ADDAFA5TH    $DA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     $DBQTM           Wait Time 4.0 U
     C                     Z-ADD*ZERO     $DBJTM           Wait Time
     C                     Z-ADDAFBNNB    $DBNNB           BOH Buy Order N
     C                     Z-ADDAFBONB    $DBONB           BOL Load Number
     C                     MOVELAFABCD    $DABCD           PD Producer Cod
     C                     MOVELAFAECD    $DAECD           PL Location Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAFHONB    $EHONB           CC Company Numb
     C                     MOVEL*BLANK    $EAFTX           SR Description
     C                     MOVEL*BLANK    $EPETX           Text 1
     C                     MOVELAFLHCD    $ELHCD           DT Transportati
     C                     MOVELAFLICD    $ELICD           DT Trucker Code
     C                     MOVELAFJ8CD    $EJ8CD           DT Driver
     C                     MOVEL*BLANK    $EIXTX           Blank Usr 1 fld
     C                     Z-ADDAFIEA1    $EIEA1           DT Movement Num
     C                     Z-ADDAFICA1    $EICA1           DT Farm Site Co
     C                     MOVELAFJ9CD    $EJ9CD           DT Loading Crew
     C                     Z-ADDAFFXDT    $EFXDT           DT Actual Kill
     C                     Z-ADDAFJIA1    $EJIA1           DT Actual Deliv
     C                     Z-ADDAFIBA1    $EIBA1           DT Scheduled Ho
     C                     MOVELAFW5ST    $EW5ST           DT Delivery Ini
     C                     MOVELAFK0CD    $EK0CD           DT Building
     C                     MOVELAFK1CD    $EK1CD           DT Room
     C                     MOVELAFLFCD    $ELFCD           DT Sire Line Co
     C                     MOVELAFLGCD    $ELGCD           DT Hog Group Re
     C                     Z-ADDAFIDA1    $EIDA1           DT Delivered He
     C                     Z-ADDAFIPA1    $EIPA1           DT Delivered We
     C                     MOVELAFMGCD    $EMGCD           CHR Code
     C                     MOVELAFXHST    $EXHST           DT Load Type
     C                     MOVELAFXIST    $EXIST           DT Full/Split L
     C                     MOVELAFKBCD    $EKBCD           DT Truck ID
     C                     MOVELAFKZCD    $EKZCD           DT Trailer ID
     C                     Z-ADDAFE9DT    $EE9DT           DT Delivery Dat
     C                     Z-ADDAFAJTH    $EAJTH           DT Delivery Tim
     C                     Z-ADDAFH4A1    $EH4A1           DT Delivery Tim
     C                     Z-ADDAFE0DT    $EE0DT           DSH Kill Date
     C                     Z-ADDAFFADT    $EFADT           DT Transprtn Of
     C                     Z-ADDAFAKTH    $EAKTH           DT Transprtn Of
     C                     Z-ADDAFBYTH    $EBYTH           DT Arrive@Frm v
     C                     MOVELAFW6ST    $EW6ST           DT On-Time Farm
     C                     MOVELAFXXST    $EXXST           DT Route Start
     C                     Z-ADDAFFBDT    $EFBDT           DT Route Start
     C                     Z-ADDAFBVTH    $EBVTH           DT Route Start
     C                     Z-ADDAFAMTH    $EAMTH           DT Wait @ Trans
     C                     Z-ADDAFFCDT    $EFCDT           DT Arrive @ Far
     C                     Z-ADDAFBHTH    $EBHTH           DT Drive Time T
     C                     Z-ADDAFFDDT    $EFDDT           DT Start Loadin
     C                     Z-ADDAFBWTH    $EBWTH           DT Start Loadin
     C                     Z-ADDAFAPTH    $EAPTH           DT Wait @ Farm
     C                     Z-ADDAFFEDT    $EFEDT           DT Frm End Load
     C                     Z-ADDAFAQTH    $EAQTH           DT Frm End Load
     C                     Z-ADDAFARTH    $EARTH           DT Load Time
     C                     Z-ADDAFFFDT    $EFFDT           DT Leave Farm D
     C                     Z-ADDAFATTH    $EATTH           DT Wait-Depart
     C                     Z-ADDAFFGDT    $EFGDT           DT Plt TrkWsh A
     C                     Z-ADDAFAUTH    $EAUTH           DT Plt TrkWsh A
     C                     Z-ADDAFFHDT    $EFHDT           DT Arrive @ Pla
     C                     Z-ADDAFAVTH    $EAVTH           DT Arrive @ Pla
     C                     Z-ADDAFAWTH    $EAWTH           DT Wait @ TrkWs
     C                     Z-ADDAFBKTH    $EBKTH           DT Drive Time T
     C                     Z-ADDAFBLTH    $EBLTH           DT Delv Time Va
     C                     MOVELAFXJST    $EXJST           DT On Time Deli
     C                     MOVELAFK3CD    $EK3CD           Delivery Reason
     C                     Z-ADDAFFIDT    $EFIDT           DT TrkScl Weigh
     C                     Z-ADDAFAYTH    $EAYTH           DT Wait @ TrkSc
     C                     Z-ADDAFFJDT    $EFJDT           DT To Recv Dock
     C                     Z-ADDAFA0TH    $EA0TH           DT Wait-Rcv Doc
     C                     Z-ADDAFFKDT    $EFKDT           DT Start Unload
     C                     Z-ADDAFA2TH    $EA2TH           DT Wait @ Rcv D
     C                     Z-ADDAFFLDT    $EFLDT           DT End Unload D
     C                     Z-ADDAFA3TH    $EA3TH           DT End Unload T
     C                     Z-ADDAFA4TH    $EA4TH           DT Unload Time
     C                     Z-ADDAFBTTH    $EBTTH           DT Unload Varia
     C                     Z-ADDAFFMDT    $EFMDT           DT TrkScl Weigh
     C                     MOVEL*BLANK    $EOBTX           Text descriptio
     C                     Z-ADD*ZERO     $EB5DT           Date USR
     C                     Z-ADD*ZERO     $EBPTH           Time Beg 4.0 US
     C                     Z-ADD*ZERO     $ECVDT           Date 2 USR
     C                     Z-ADD*ZERO     $EBQTH           Time End 4.0 US
     C                     Z-ADDAFALTH    $EALTH           DT Route Start
     C                     Z-ADDAFANTH    $EANTH           DT Arrive @ Far
     C                     Z-ADDAFAOTH    $EAOTH           DT Start Loadin
     C                     Z-ADDAFASTH    $EASTH           DT Leave Farm T
     C                     Z-ADDAFAXTH    $EAXTH           DT TrkScl Weigh
     C                     Z-ADDAFAZTH    $EAZTH           DT To Recv Dock
     C                     Z-ADDAFA1TH    $EA1TH           DT Start Unload
     C                     Z-ADDAFA5TH    $EA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     $EAWTM           Time Diff Usr
     C                     Z-ADDAFA6TH    $EA6TH           DT Wait Time @
     C                     Z-ADDAFBXTH    $EBXTH           DT Formula Wait
     C                     MOVELAFXKST    $EXKST           DT Source Type
     C                     MOVELAFYDST    $EYDST           DT GATE UPDATE
     C                     Z-ADDAFFYDT    $EFYDT           DT Unused Date
     C                     Z-ADDAFB0TH    $EB0TH           DT Unused Time
     C                     Z-ADDAFBZTH    $EBZTH           DT Unused Wait
     C                     Z-ADDAFH2A1    $EH2A1           DSD Scheduled D
     C                     Z-ADDAFJ2A1    $EJ2A1           DT Head Receive
     C                     Z-ADDAFJ3A1    $EJ3A1           DT Weight Recei
     C                     Z-ADDAFKMA1    $EKMA1           DT Avg Weight R
     C                     Z-ADDAFJ4A1    $EJ4A1           DT Head DOA
     C                     Z-ADDAFJ5A1    $EJ5A1           DT Weight DOA
     C                     Z-ADDAFJ6A1    $EJ6A1           DT Head Yard De
     C                     Z-ADDAFJ7A1    $EJ7A1           DT Weight Yard
     C                     Z-ADDAFJ8A1    $EJ8A1           DT Head Condemn
     C                     Z-ADDAFJ9A1    $EJ9A1           DT Weight Conde
     C                     Z-ADDAFKAA1    $EKAA1           DT Head Held Ov
     C                     Z-ADDAFKBA1    $EKBA1           DT Weight Held
     C                     Z-ADDAFKCA1    $EKCA1           DT Head Killed
     C                     Z-ADDAFKDA1    $EKDA1           DT Weight Kille
     C                     Z-ADDAFKEA1    $EKEA1           DT Head Market
     C                     Z-ADDAFKFA1    $EKFA1           DT Weight Marke
     C                     Z-ADDAFKNA1    $EKNA1           DT Avg Weight M
     C                     Z-ADDAFKGA1    $EKGA1           DT Head Resale
     C                     Z-ADDAFKHA1    $EKHA1           DT Weight Resal
     C                     Z-ADDAFKOA1    $EKOA1           DT Avg Weight R
     C                     Z-ADDAFKIA1    $EKIA1           DT Head Unused
     C                     Z-ADDAFKJA1    $EKJA1           DT Weight Unuse
     C                     Z-ADDAFKKA1    $EKKA1           DT Head Unused
     C                     Z-ADDAFKLA1    $EKLA1           DT Weight Unuse
     C                     MOVELAFYNST    $EYNST           DT Error Sts
     C                     MOVELAFYOST    $EYOST           DT Error Reason
     C                     MOVELAFAACD    $EAACD           SR Source Code
     C                     Z-ADDAFHMNB    $EHMNB           BOH Company Num
     C                     Z-ADDAFBNNB    $EBNNB           BOH Buy Order N
     C                     Z-ADDAFBONB    $EBONB           BOL Load Number
     C                     MOVELAFABCD    $EABCD           PD Producer Cod
     C                     MOVEL*BLANK    $EA4TX           Producer Name
     C                     MOVELAFAECD    $EAECD           PL Location Cod
     C                     MOVEL*BLANK    $EP1TX           Location Name D
     C                     MOVELAFAAVN    $EAAVN           RS User Changed
     C                     Z-ADDAFAADT    $EAADT           RS Date Changed
     C                     Z-ADDAFAMTM    $EAMTM           RS Time Changed
     C                     MOVELAFAJST    $EAJST           RS Record Statu
     C                     MOVELAFAHVN    $EAHVN           RS Job
     C                     MOVELAFAGVN    $EAGVN           RS Program
     C                     MOVELAFABVN    $EABVN           RS User Added
     C                     Z-ADDAFABDT    $EABDT           RS Date Added
     C                     Z-ADDAFABTM    $EABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AFHONB    WZA001           CC Company Numb
     C                     Z-ADDAFHONB    WZA001
     C           *LIKE     DEFN AFE9DT    WZA002           DT Delivery Dat
     C                     Z-ADDAFE9DT    WZA002
     C           *LIKE     DEFN AFAJTH    WZA003           DT Delivery Tim
     C                     Z-ADDAFAJTH    WZA003
     C           *LIKE     DEFN AFH4A1    WZA004           DT Delivery Tim
     C                     Z-ADDAFH4A1    WZA004
     C           *LIKE     DEFN AFE0DT    WZA005           DSH Kill Date
     C                     Z-ADDAFE0DT    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@AFCPQ9                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * The logical view has the selects for this process
      * Now all that is needed is to perform the calculation
      * of the difference in time and if this time exceeds the
      * company prod value then record will print on the report
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        CC Company Numb
     C                     MOVEL*BLANK    W0AL01  1        DT Delivery Dat
     C                     MOVEL*BLANK    W0AL02  1        DT Delivery Tim
     C                     MOVEL*BLANK    W0AL03  1        DT Delivery Tim
     C                     MOVEL*BLANK    W0AL04  1        DSH Kill Date
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        CC Company Numb
     C                     MOVEL'Y'       W0AL01  1        DT Delivery Dat
     C                     MOVEL'Y'       W0AL02  1        DT Delivery Tim
     C                     MOVEL'Y'       W0AL03  1        DT Delivery Tim
     C                     MOVEL'Y'       W0AL04  1        DSH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           AFHONB    IFNE WZA001                     CC Company Numb
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           AFE9DT    IFNE WZA002                     DT Delivery Dat
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           AFAJTH    IFNE WZA003                     DT Delivery Tim
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           AFH4A1    IFNE WZA004                     DT Delivery Tim
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           AFE0DT    IFNE WZA005                     DSH Kill Date
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * USER: On print of DT Delivery Date format
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Truck WaitTime ExcPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Truck WaitTime ExcPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1HONB    $CHONB           CC Company Numb
     C                     Z-ADDP1HONB    $CHONB           CC Company Numb
     C                     Z-ADDP1E9DT    $CF2DT           Date From
     C                     Z-ADD##JDT     $CB4DT           Date To   USR
     C                     Z-ADD##JTM     $CA8TM           Time Beg USR
     C                     Z-ADDWUB7TH    $CB7TH           COPR Time
     C                     MOVEL*BLANK    WUBFTX           THC Comment
     C                     Z-ADD1         ZQ      50
     C           WUBFTX    CAT  @CN,002:ZQWUBFTX    P      THC Comment
     C                     MOVEL*BLANK    WUCZCD           Date Alpha USR
     C                     MOVEL##JDT     WUCZCD           Date Alpha USR
     C                     MOVEL*BLANK    WUOITX           Date From Conve
     C                     MOVELWUCZCD    WUOITX           Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM WUOITX    WQ0001 10        Date From Conve
     C           WUOJTX    PARM *BLANK    WQ0002 11        Date To Convert
     C                     PARM '*CYMD'   WQ0003  8        Date From Forma
     C                     PARM '*MDY'    WQ0004  8        Date To Format
     C                     PARM '*NONE'   WQ0005  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUOJTX    WUFLCD           Code USR
     C                     MOVE WUFLCD    WUTANB           Date Num 6 Usr
      * ----------------------
     C                     MOVEL*BLANK    WUDKCD           Date Alpha Usr
     C                     MOVELWUTANB    WUDKCD           Date Alpha Usr
     C                     Z-ADD1         ZQ      50
     C           WUBFTX    CAT  @CN,003:ZQWUBFTX    P      THC Comment
     C                     Z-ADD1         ZQ      50
     C           WUBFTX    CAT  WUDKCD:ZQ WUBFTX    P      THC Comment
     C                     MOVEL*BLANK    WUDICD           Time  Alpha Usr
     C                     MOVEL##JTM     WUDICD           Time  Alpha Usr
     C                     Z-ADD1         ZQ      50
     C           WUBFTX    CAT  'Tm:':ZQ  WUBFTX    P      THC Comment
     C                     Z-ADD1         ZQ      50
     C           WUBFTX    CAT  WUDICD:ZQ WUBFTX    P      THC Comment
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Date From             USR to display format
      * Convert date
     C           1000000   ADD  $CF2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCF2DT
      * Convert Date To   USR to display format
      * Convert date
     C           1000000   ADD  $CB4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCB4DT
     C                     MOVEL'0'       *IN79
     C           WUMFST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print CC Company Number of Prt Truck WaitTime ExcPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Convert fields to external form
      * Convert DT Delivery Date to display format
      * Convert date
     C           1000000   ADD  $DE9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDE9DT
      * Convert DSH Kill Date to display format
      * Convert date
     C           1000000   ADD  $DE0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDE0DT
      * Convert DT Arrive @ Plant Date to display format
      * Convert date
     C           1000000   ADD  $DFHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDFHDT
      * Convert DT TrkScl Weigh-In Date to display format
      * Convert date
     C           1000000   ADD  $DFIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDFIDT
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print DT Delivery Date of Prt Truck WaitTime ExcPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print DT Delivery Time of Prt Truck WaitTime ExcPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print DT Delivery Time Seq of Prt Truck WaitTime ExcPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print DSH Kill Date of Prt Truck WaitTime ExcPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Prt Truck WaitTime ExcPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv Prdcr Name, Sts   RT - Producer  * 
     C                     EXSR SBRVGN
      * Rtv Pdctn Loc Nm,Sts  RT - Producer Location  * 
     C                     EXSR SCRVGN
     C                     Z-ADD*ZERO     $EAWTM           Time Diff Usr
     C                     Z-ADD*ZERO     WUAWTM           Time Diff Usr
     C                     Z-ADD##JDT     WUESDT           Date End USR
     C                     MOVEL##JHH     WUWBTX           Hour Usr Alpha
      * *** hh and mm to get alpha then concat and move to numeric
      * Calculation
     C                     EXSR UASUBR                     Calculation
      * CASE: CUR.Time Diff Usr GT WRK.COPR Time
     C           $EAWTM    IFGT WUB7TH                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * WHD 28489 SLM 02/15/2018
      * Validate that the delivery tracking with  bol found
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Val Buy Order Load    RT - Buy Order Load  * 
     C                     EXSR SERVGN
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0010    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * WHD 28489 SLM 02/15/2018
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
      * Create comment for history of wait time exceeds.
      * * out due maybe to many records at first
     C                     EXSR UBSUBR                     * out due maybe
     C                     MOVEL'Y'       P2MXST           Record was sele
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert DT Delivery Date to display format
      * Convert date
     C           1000000   ADD  $EE9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEE9DT
      * Convert DSH Kill Date to display format
      * Convert date
     C           1000000   ADD  $EE0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEE0DT
      * Convert DT Arrive @ Plant Date to display format
      * Convert date
     C           1000000   ADD  $EFHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEFHDT
      * Convert DT TrkScl Weigh-In Date to display format
      * Convert date
     C           1000000   ADD  $EFIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEFIDT
     C                     MOVEL'0'       *IN79
     C           YL0011    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Truck WaitTime ExcPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  12        W0FSUM
     C                     END                             FI
      *
      * * CC Company Number of Prt Truck WaitTime ExcPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * DT Delivery Date of Prt Truck WaitTime ExcPF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * DT Delivery Time of Prt Truck WaitTime ExcPF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * DT Delivery Time Seq of Prt Truck WaitTime ExcPF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * DSH Kill Date of Prt Truck WaitTime ExcPF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Truck WaitTime ExcPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP1HONB    $BHONB           CC Company Numb
     C                     Z-ADDP1HONB    $BHONB           CC Company Numb
     C                     Z-ADDP1E9DT    $BF2DT           Date From
     C                     Z-ADD##JDT     $BB4DT           Date To   USR
     C                     Z-ADD##JTM     $BA8TM           Time Beg USR
      * Convert fields to external form
      * Convert Date From             USR to display format
      * Convert date
     C           1000000   ADD  $BF2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBF2DT
      * Convert Date To   USR to display format
      * Convert date
     C           1000000   ADD  $BB4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBB4DT
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Company Process ValRT - Company Process Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BEHONB           CC Company Numb
     C                     KFLD           BEPFCD           COPR Value
      * Setup key
     C                     Z-ADDP1HONB    BEHONB           CC Company Numb
     C                     MOVEL@CN,001   BEPFCD           COPR Value
      * Establish starting position
     C           KRSSA     CHAIN@BEREQ3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1254' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB7TH           COPR Time
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEB7TH    WUB7TH           COPR Time
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Name, Sts   RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELAFABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSB     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    $EA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc Nm,Sts  RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAAECD           PL Location Cod
      * Setup key
     C                     MOVELAFABCD    WAABCD           PD Producer Cod
     C                     MOVELAFAECD    WAAECD           PL Location Cod
      * Establish starting position
     C           KRSSC     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAA8TX    $EP1TX           PL Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDINFN    BEGSR
      *================================================================
      * Clc Time Durations    IF - Delivery Tracking  * 
      *================================================================
      * Clc Time Durations    IF
     C                     Z-ADD*ZERO     WL0005           Wait Time 4.0 U
      * CASE:
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : PAR.Date Beg USR is Entered
      *   |- c2    : PAR.Date End USR is Entered
      *   |- c3    : PAR.Time Beg 4.0 USR is Entered
      *   |- c4    : PAR.Time End 4.0 USR is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0001    IFNE 0                          *IF
     C           WL0003    IFNE 0                          *IF
     C           WL0002    IFNE 0                          *IF
     C           WL0004    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WL0002    MULT 100       YL0002           Time Beg USR
     C           WL0004    MULT 100       YL0003           Time End USR
      * CASE: PAR.Date Beg USR LT PAR.Date End USR
     C           WL0001    IFLT WL0003                     *IF
      * LCL.Number 1 USR = PAR.Date End USR - PAR.Date Beg USR *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WL0001    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WL0003    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0004
     C                     ELSE
     C           XDURR     MULT -1        YL0004
     C                     END
     C           YL0004    MULT 240000    YL0005           Usr Elapsed hou
     C                     ADD  YL0005    YL0003           Time End USR
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Number 1 USR = PAR.Date Beg USR - PAR.Date End USR *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WL0003    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WL0001    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0004
     C                     ELSE
     C           XDURR     MULT -1        YL0004
     C                     END
     C           YL0004    MULT 240000    YL0005           Usr Elapsed hou
     C                     ADD  YL0005    YL0002           Time Beg USR
     C                     END                             *FI
      * LCL.Time Diff Usr = LCL.Time End USR - LCL.Time Beg USR *HHMMSS
     C                     Z-ADDYL0002    XTTIM2
     C                     Z-ADDYL0003    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       YL0006
     C                     ADD  XTNN      YL0006
     C                     MULT 100       YL0006
     C                     ADD  XTSS      YL0006
     C                     MULT XSGN      YL0006
      * LCL.Hours USR = LCL.Time Diff Usr *HOURS
     C                     Z-ADDYL0006    XTTIM
     C                     Z-ADDXTHH      YL0007
      * LCL.Minutes USR = LCL.Time Diff Usr *MINUTES
     C                     Z-ADDYL0006    XTTIM
     C                     Z-ADDXTNN      YL0008
     C           YL0007    MULT 60        YL0009           Wait Time 4.0 U
     C           YL0009    ADD  YL0008    WL0005           Wait Time 4.0 U
      * CASE: LCL.Time Diff Usr is lt 0
     C           YL0006    IFLT 0                          *IF
     C           *ZERO     SUB  WL0005    WL0005           Wait Time 4.0 U
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Val Buy Order Load    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD$EHMNB    AXHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSE     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Record Found US
     C                     MOVEL'N'       YL0010           Record Found US
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVEL'Y'       YL0010           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Next Line No      RT - Delivery Tracking Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AHHONB    WQSF01           CC Company Numb
     C           *LIKE     DEFN AHE0DT    WQSF02           DSH Kill Date
     C           *LIKE     DEFN AHE9DT    WQSF03           DT Delivery Dat
     C           *LIKE     DEFN AHAJTH    WQSF04           DT Delivery Tim
     C           *LIKE     DEFN AHH4A1    WQSF05           DT Delivery Tim
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           CC Company Numb
     C                     KFLD           WQSF02           DSH Kill Date
     C                     KFLD           WQSF03           DT Delivery Dat
     C                     KFLD           WQSF04           DT Delivery Tim
     C                     KFLD           WQSF05           DT Delivery Tim
      * Setup key
     C                     Z-ADD$EHONB    WQSF01           CC Company Numb
     C                     Z-ADD$EE0DT    WQSF02           DSH Kill Date
     C                     Z-ADD$EE9DT    WQSF03           DT Delivery Dat
     C                     Z-ADD$EAJTH    WQSF04           DT Delivery Tim
     C                     Z-ADD$EH4A1    WQSF05           DT Delivery Tim
      * Establish starting position
     C           KRSSF     SETLL@AHCPI3                    *
     C           KRSSF     READE@AHCPI3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1034' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUH7A1           DTC Line Number
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           AHH7A1    ADD  1         WUH7A1           DTC Line Number
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@AHCPI3                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Delv Track Cmnt   CR - Delivery Tracking Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AHCPIR
     C                     Z-ADD$EHONB    WBHONB           CC Company Numb
     C                     Z-ADD$EE0DT    WBE0DT           DSH Kill Date
     C                     Z-ADD$EE9DT    WBE9DT           DT Delivery Dat
     C                     Z-ADD$EAJTH    WBAJTH           DT Delivery Tim
     C                     Z-ADD$EH4A1    WBH4A1           DT Delivery Tim
     C                     Z-ADDWUH7A1    WBH7A1           DTC Line Number
     C                     MOVELWUBFTX    WBSGTX           DTC Comment
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSG    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBE0DT           DSH Kill Date
     C                     KFLD           WBE9DT           DT Delivery Dat
     C                     KFLD           WBAJTH           DT Delivery Tim
     C                     KFLD           WBH4A1           DT Delivery Tim
     C                     KFLD           WBH7A1           DTC Line Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@AHCPIR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1035' W0RTN   7
      * Send message 'Delivery Tracking Comm EX'
     C                     MOVEL'PRK1035' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@AHCPIR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Calculation
      *================================================================
     C                     MOVEL##JNN     WUWHTX           MIN 2APLHA USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUWBTX    CAT  WUWHTX:ZQ WUWITX    P      Hour + MiM Alph
     C                     MOVE WUWITX    WUBETM           HPS Shipped In
     C                     MOVE WUBETM    WUBQTH           Time End 4.0 US
      * *** hh and mm to get alpha then concat and move to numeric
      * Calculation with either the Weight in or the Arrival
      * CASE: DB1.DT TrkScl Weigh-In Date is Entered
     C           AFFIDT    IFNE *ZERO                      *IF
      * Clc Time Durations    IF - Delivery Tracking  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAFFIDT    WL0001           Date Beg USR
     C                     Z-ADDAFAXTH    WL0002           Time Beg 4.0 US
     C                     Z-ADDWUESDT    WL0003           Date End USR
     C                     Z-ADDWUBQTH    WL0004           Time End 4.0 US
     C                     Z-ADDWUAWTM    WL0005           Wait Time 4.0 U
     C                     EXSR SDINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUAWTM           Wait Time 4.0 U
     C                     Z-ADDWUAWTM    $EAWTM           Time Diff Usr
     C                     ELSE
      * CASE: DB1.DT Arrive @ Plant Date is Entered
     C           AFFHDT    IFNE *ZERO                      *IF
      * Clc Time Durations    IF - Delivery Tracking  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAFFHDT    WL0001           Date Beg USR
     C                     Z-ADDAFAVTH    WL0002           Time Beg 4.0 US
     C                     Z-ADDWUESDT    WL0003           Date End USR
     C                     Z-ADDWUBQTH    WL0004           Time End 4.0 US
     C                     Z-ADDWUAWTM    WL0005           Wait Time 4.0 U
     C                     EXSR SDINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUAWTM           Wait Time 4.0 U
     C                     Z-ADDWUAWTM    $EAWTM           Time Diff Usr
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * * out due maybe to many records at first
      *================================================================
     C                     Z-ADD999       WUH7A1           DTC Line Number
      * Crt Delv Track CmntTXTIF
      * Rtv Next Line No      RT - Delivery Tracking Comment  * 
     C                     EXSR SFRVGN
      * Crt Delv Track Cmnt   CR - Delivery Tracking Comment  * 
     C                     EXSR SGCRRC
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTCEL     BEGSR
      *================================================================
      * Calculate elapsed time from TME2 to TME1
      *================================================================
     C           XTTIM     IFGE XTTIM2
     C                     Z-ADD1         XSGN    10
     C                     Z-ADDXTNN      XTNNL   30
     C                     Z-ADDXTSS      XTSSL   30
     C           XTSSL     IFLT XTSS2
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS2     XTSS
     C           XTNNL     IFLT XTNN2
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH
     C                     END
     C           XTNNL     SUB  XTNN2     XTNN
     C                     SUB  XTHH2     XTHH
     C                     ELSE
     C                     Z-ADD-1        XSGN
     C                     Z-ADDXTNN2     XTNNL
     C                     Z-ADDXTSS2     XTSSL
     C           XTSSL     IFLT XTSS
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS      XTSS
     C           XTNNL     IFLT XTNN
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH2
     C                     END
     C           XTNNL     SUB  XTNN      XTNN
     C           XTHH2     SUB  XTHH      XTHH
     C                     END
      *================================================================
     CSR         XTCELE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Usr Display 1
     C                     MOVEL*BLANK    WUMFST  1
      * Define work field COPR Time
     C                     Z-ADD*ZERO     WUB7TH  40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AFHONB           CC Company Numb
     C                     MOVEL*LOVAL    AFE9DT           DT Delivery Dat
     C                     MOVEL*LOVAL    AFAJTH           DT Delivery Tim
     C                     MOVEL*LOVAL    AFH4A1           DT Delivery Tim
     C                     MOVEL*LOVAL    AFE0DT           DSH Kill Date
      * Define work field THC Comment
     C                     MOVEL*BLANK    WUBFTX 60
      * Define work field Date Alpha USR
     C                     MOVEL*BLANK    WUCZCD  7
      * Define work field Date From Convert USR
     C                     MOVEL*BLANK    WUOITX 10
      * Define work field Date To Convert USR
     C                     MOVEL*BLANK    WUOJTX 11
      * Define work field Code USR
     C                     MOVEL*BLANK    WUFLCD  6
      * Define work field Date Num 6 Usr
     C                     Z-ADD*ZERO     WUTANB  60
      * Define work field Date Alpha Usr 3
     C                     MOVEL*BLANK    WUDKCD  7
      * Define work field Time  Alpha Usr
     C                     MOVEL*BLANK    WUDICD  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WAASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WAHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Time Diff Usr
     C                     Z-ADD*ZERO     WUAWTM  60
      * Define work field Date End USR
     C                     Z-ADD*ZERO     WUESDT  70
      * Define work field Hour Usr Alpha
     C                     MOVEL*BLANK    WUWBTX  2
      * Define work field MIN 2APLHA USR
     C                     MOVEL*BLANK    WUWHTX  2
      * Define work field Hour + MiM Alpha 4 Usr
     C                     MOVEL*BLANK    WUWITX  4
      * Define work field HPS Shipped In Time
     C                     Z-ADD*ZERO     WUBETM  40
      * Define work field Time End 4.0 USR
     C                     Z-ADD*ZERO     WUBQTH  40
      * Define work field DTC Line Number
     C                     Z-ADD*ZERO     WUH7A1  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WBE9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     WBAJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     WBH4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     WBH7A1           DTC Line Number
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDINFN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  40
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  40
     C                     Z-ADD*ZERO     WL0005  40
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Time Beg USR
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field Time End USR
     C                     Z-ADD*ZERO     YL0003  60
      * Define local work field Number 1 USR
     C                     Z-ADD*ZERO     YL0004  20
      * Define local work field Usr Elapsed hours
     C                     Z-ADD*ZERO     YL0005  60
      * Define local work field Time Diff Usr
     C                     Z-ADD*ZERO     YL0006  60
      * Define local work field Hours USR
     C                     Z-ADD*ZERO     YL0007  50
      * Define local work field Minutes USR
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field Wait Time 4.0 USR
     C                     Z-ADD*ZERO     YL0009  40
      * Define null work field BOL Truck Scale Weigh Sts
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Status 1
     C                     MOVEL*BLANK    YL0011  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications
      * 01/23/2021 ISE H16853 - Increased the length from 5 to 7 and
      *                         corrected the alignment of Buy Order Numb
     C                     MOVEL'N'       WUMFST           Usr Display 1
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Rtv Company Process ValRT - Company Process Values  * 
     C                     EXSR SARVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 TRKRCVDTME
00002 Truck Wait Time Exceeded
00003 Job Dt:
