// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPVSXFR
// ?Date: 14.08.2025 Time: 03:42:03
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Create customer electronic commerce file
//?slm 08/09/05 added TF Exempt code
EXECUTE FUNCTION(Crt CustomerExt       RT) TYPE(RTVOBJ) FILE(CABBREP)           AC1768358;
{
 //?USER: Process Data record

 //?Create customer electronic commerce file
 // LCL.Customer Number Alpha = CVTVAR(DB1.Ship To Customer)
 LCL.Customer_Number_Alpha = CVTVAR(DB1.Ship_To_Customer);

 // LCL.Email User ID = CONCAT(CON.A,LCL.Customer Number Alpha,CON.*ZERO)
 LCL.Email_User_ID = 'A' + LCL.Customer_Number_Alpha (*ZERO);

 //?slm 08/09/05 added TF Exempt code
 EXECUTE FUNCTION(Crt CustExtMissing&Upd) TYPE(RTVOBJ) FILE(PDNEREP)             AC1768359;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(WRK.Internet_Password);
 PARAMETER(WRK.Email_Address);
 PARAMETER(LCL.Email_User_ID);
 PARAMETER(WRK.EDI_Trading_Partner_No);
 PARAMETER(WRK.EDI_Cust_Duns_Number);
 PARAMETER(WRK.EDI_Warehouse_Store_No);
 PARAMETER(WRK.State_Tax_ID);
 PARAMETER(WRK.Cust_Shipping_Temp_C_F);
 PARAMETER(WRK.One_Invoice_Per_PO);
 PARAMETER(WRK.EDI_Advanced_Ship_Notice);
 PARAMETER(WRK.Customer_G_L_Vendor_Num);
 PARAMETER(WRK.Air_Freight_Orders);
 PARAMETER(WRK.Regional_Mgr_Fax_Email);
 PARAMETER(WRK.Employee_Co_Packer_Sale);
 PARAMETER('NE');
 PARAMETER(WRK.Customer_Watch_Flag);
 PARAMETER(WRK.Customer_Sales_Region);
 PARAMETER(WRK.Customer_Market_Code);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Record_Status);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt Customer Ext Only  CR) TYPE(CRTOBJ) FILE(PDNEREP)          AC1768344;
  PARAMETER(PAR.Ship_To_Customer);
  PARAMETER(PAR.Internet_Password);
  PARAMETER(PAR.Email_Address);
  PARAMETER(PAR.Email_User_ID);
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(PAR.EDI_Cust_Duns_Number);
  PARAMETER(PAR.EDI_Warehouse_Store_No);
  PARAMETER(PAR.State_Tax_ID);
  PARAMETER(PAR.Cust_Shipping_Temp_C_F);
  PARAMETER(PAR.One_Invoice_Per_PO);
  PARAMETER(PAR.EDI_Advanced_Ship_Notice);
  PARAMETER(PAR.Customer_G_L_Vendor_Num);
  PARAMETER(PAR.Air_Freight_Orders);
  PARAMETER(PAR.Regional_Mgr_Fax_Email);
  PARAMETER(PAR.Employee_Co_Packer_Sale);
  PARAMETER(PAR.Customer_TF_Exempt_Code);
  PARAMETER(PAR.Customer_Watch_Flag);
  PARAMETER(PAR.Customer_Sales_Region);
  PARAMETER(PAR.Customer_Market_Code);
  PARAMETER(PAR.EDI_Status_1);
  PARAMETER(PAR.EDI_Status_2);
  PARAMETER(PAR.EDI_Status_3);
  PARAMETER(PAR.Record_Status);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  //?USER: Process Data record

  // LCL.Customer Number Alpha = CVTVAR(DB1.Ship To Customer)
  LCL.Customer_Number_Alpha = CVTVAR(DB1.Ship_To_Customer);

  // LCL.Email User ID = CONCAT(CON.A,LCL.Customer Number Alpha,CON.*ZERO)
  LCL.Email_User_ID = 'A' + LCL.Customer_Number_Alpha (*ZERO);

  CASE;

  // IF DB1.Email User ID is Not Entered
  IF DB1.Email_User_ID = *BLANK;

  EXECUTE FUNCTION(Chg CustExtEmailA000000) TYPE(CHGOBJ) FILE(PDNEREP)            AC1768360;
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(LCL.Email_User_ID);
  ENDIF;

 }

}


