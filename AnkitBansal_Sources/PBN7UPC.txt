/*********************************************************************/
/* PROGRAM    : PBN7UPC                                              */
/* TITLE      : CALL THE JOB TO EXECUTE THE SQLS THAT CREATE         */
/*                MANIFEST SPREADSHEETS AND EMAIL THEM               */
/* DATE       : 03/13/2013                                           */
/* Description: CALL T THE JOB TO EXECUTE THE SQLS THAT CREATE       */
/*                MANIFEST DETAIL OR THE MANIFEST SUMMARY            */
/*                SPREADSHEETS AND EMAIL THEM                        */
/*                SELECT=7 IS MANIFEST SUMMARY                       */
/*                SELECT=8 IS MANIFEST DETAIL                        */
/*                                                                   */
/* NOTE       : DON'T SUBMIT THIS JOB. THAT WILL CLEAR THE           */
/*              WORK FILE                                            */
/*                                                                   */
/*  Parameters:                                                      */
/*  FIELD       FIELD DESCRIPTION                                    */
/*  ----------  ------------------------------------------           */
/*  &RETURN     RETURN CODE                                          */
/*  &COMPN      COMPANY NUMBER AS 15.5                               */
/*  &ORDERN     ORDER NUMBER AS 15.5                                 */
/*  &PONBR      CUSTOMER PURCHASE ORDER NUMBER                       */
/*  &EMAILADDR  EMAIL ADDRESS TO SEND TO                             */
/*  &SUBJECT    SUBJECT LINE                                         */
/*  &SELECT     SELECTED MENU ITEM NUMBER                            */
/*********************************************************************/
/* Modifications:                                                    */
/* ---------- --- ------- -------------------------------------------*/
/* 09/19/2017 DN  E011527  UNDO &SELECT CHANGE FROM 2 BACK TO 1 BYTE */
/*                         AND CHANGED OPT 7 & 8 TO REMOVE PRICE     */
/*                         CODE RESTRICTION FROM SEQUEL.             */
/* 08/29/2017 LJB E011527  CHANGE &SELECT TO 2 CHARACTERS.           */
/*-------------------------------------------------------------------*/
/*********************************************************************/
 PBN7UPC:    PGM        PARM(&RETURN &COMPN &CUSTN &ORDERN &PONBR +
                          &MANTYPE &EMAILADDR &SUBJECT &SELECT)

             DCL        VAR(&RETURN)    TYPE(*CHAR) LEN(7)
             DCL        VAR(&COMPN)     TYPE(*DEC)
             DCL        VAR(&ORDERN)    TYPE(*DEC)
             DCL        VAR(&CUSTN)     TYPE(*DEC)
             DCL        VAR(&PONBR)     TYPE(*CHAR) LEN(15)
             DCL        VAR(&MANTYPE)   TYPE(*CHAR) LEN(2)
             DCL        VAR(&SUBJECT)   TYPE(*CHAR) LEN(60)
             DCL        VAR(&EMAILADDR) TYPE(*CHAR) LEN(50)
             DCL        VAR(&SELECT)    TYPE(*CHAR) LEN(1)

/* ERROR MESSAGE FIELDS                                                       */
             DCL        VAR(&MSG)   TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL)  TYPE(*DEC) LEN(5 0)
             DCL        VAR(&MSG2)  TYPE(*CHAR) LEN(512)

             MONMSG     MSGID(CPF2103 CPF9999)

/*********** FOR TEST                                      +
             RMVLIBLE   LIB(PRKDEVQRY)                     +
             ADDLIBLE   LIB(PRKDEVQRY) POSITION(*LAST)     ***********/

/*-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*/
/* PRINT MANIFEST SUMMARY REPORT                                     */
             IF         COND(&SELECT *EQ '7') THEN(DO)

 CALL:       CALL       PGM(PBOGUPC) PARM(&RETURN &COMPN &ORDERN  +
                          &PONBR &MANTYPE &EMAILADDR &SUBJECT &SELECT)
             GOTO       CMDLBL(END)
             ENDDO
/*-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*/
/* PRINT MANIFEST DETAIL REPORT                                     */
             IF         COND(&SELECT *EQ '8') THEN(DO)

 CALL2:      CALL       PGM(PBOFUPC) PARM(&RETURN &COMPN &ORDERN  +
                          &PONBR &MANTYPE &EMAILADDR &SUBJECT &SELECT)
             GOTO       CMDLBL(END)
             ENDDO
/*-*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*--*/

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000)

 END:        ENDPGM
