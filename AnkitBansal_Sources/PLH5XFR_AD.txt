// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLH5XFR
// ?Date: 14.08.2025 Time: 02:54:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications
//?11/05/2020 ISE H16853 - Recompiled due to change in Buy Order Number
// LCL.CC Company Number = PAR.Company Number USR
LCL.CC_Company_Number = PAR.Company_Number_USR;

// LCL.TP Tattoo Date = PAR.Date Beg USR
LCL.TP_Tattoo_Date = PAR.Date_Beg_USR;

// LCL.Scheduled Shift = PAR.TU Shift
LCL.Scheduled_Shift = PAR.TU_Shift;

// LCL.Date To   USR = PAR.Date End USR
LCL.Date_To_USR = PAR.Date_End_USR;

EXECUTE FUNCTION(Prt Tattoo/Unload Wrk RT) TYPE(RTVOBJ) FILE(PKFJCPP)           AB1275006;
PARAMETER(LCL.CC_Company_Number);
PARAMETER(LCL.TP_Tattoo_Date);
PARAMETER(LCL.Scheduled_Shift);
PARAMETER(LCL.Date_To_USR);
{
 //?USER: Initialize routine

 // WRK.TU Kill Date = CON.9999999
 WRK.TU_Kill_Date = 9999999;

 // WRK.TU Load = CON.99999
 WRK.TU_Load = 99999;

 // WRK.TU Shift = CND.*Blanks
 WRK.TU_Shift = *BLANK;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?Company Selection
 CASE;

 // IF PAR.CC Company Number is *ZERO
 IF PAR.CC_Company_Number = *ZERO;

 //?Company Selection
 // IF DB1.CC Company Number EQ PAR.CC Company Number
 IF DB1.CC_Company_Number = PAR.CC_Company_Number;

 //?Company Selection
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?Date Selection
 CASE;

 // IF DB1.TP Tattoo Date GE PAR.TP Tattoo Date
 IF DB1.TP_Tattoo_Date >= PAR.TP_Tattoo_Date;

 CASE;

 // IF DB1.TP Tattoo Date LE PAR.Date To   USR
 IF DB1.TP_Tattoo_Date <= PAR.Date_To_USR;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Rtv Employ Info       RT) TYPE(RTVOBJ) FILE(PKFIREP)           AB1275009;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.Employee_ID);
 PARAMETER(LCL.TU_Shift);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

 }

 //?Shift selection if shift was entered
 CASE;

 // IF PAR.Scheduled Shift is *Blanks
 IF PAR.Scheduled_Shift = *BLANK;

 //?Shift selection if shift was entered
 // IF PAR.Scheduled Shift EQ LCL.TU Shift
 IF PAR.Scheduled_Shift = LCL.TU_Shift;

 //?Shift selection if shift was entered
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 //?KILL DATE RECORD
 EXECUTE FUNCTION(Upd Tattoo/Upload Tot RT) TYPE(RTVOBJ) FILE(PLAXCPP)           AB1275008;
 PARAMETER(DB1.TP_Tattoo_Date);
 PARAMETER(LCL.TU_Shift);
 PARAMETER(*ZERO);
 PARAMETER(DB1.Employee_ID);
 PARAMETER(1);
 PARAMETER(*ZERO);
 PARAMETER(JOB.*JOB);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Tattoo UnLoader Cn) TYPE(CRTOBJ) FILE(PLAXCPP)          AB1275002;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(PAR.TU_Tattoo_Cnt);
  PARAMETER(PAR.TU_Unloader_Cnt);
  PARAMETER(PAR.*JOB);
  {
   //?USER: Processing if Data record already exists

   // PGM.*Return code = CND.*Record already exists
   PGM.*Return_code = 'Y2U0003';

  }

  //?USER: Process Data record

  // LCL.TU Tattoo Cnt = DB1.TU Tattoo Cnt + PAR.TU Tattoo Cnt
  LCL.TU_Tattoo_Cnt = DB1.TU_Tattoo_Cnt + PAR.TU_Tattoo_Cnt;

  // LCL.TU Unloader Cnt = DB1.TU Unloader Cnt + PAR.TU Unloader Cnt
  LCL.TU_Unloader_Cnt = DB1.TU_Unloader_Cnt + PAR.TU_Unloader_Cnt;

  EXECUTE FUNCTION(Change Tattoo UnLoader Cn) TYPE(CHGOBJ) FILE(PLAXCPP)          AB1275003;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(LCL.TU_Tattoo_Cnt);
  PARAMETER(LCL.TU_Unloader_Cnt);
  PARAMETER(DB1.*JOB);
 }

 EXECUTE FUNCTION(Upd Tattoo/Upload Tot RT) TYPE(RTVOBJ) FILE(PLAXCPP)           AB1275008;
 PARAMETER(DB1.TP_Tattoo_Date);
 PARAMETER(LCL.TU_Shift);
 PARAMETER(*ZERO);
 PARAMETER(DB1.Employee_Number_2_Employe);
 PARAMETER(*ZERO);
 PARAMETER(1);
 PARAMETER(JOB.*JOB);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Tattoo UnLoader Cn) TYPE(CRTOBJ) FILE(PLAXCPP)          AB1275002;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(PAR.TU_Tattoo_Cnt);
  PARAMETER(PAR.TU_Unloader_Cnt);
  PARAMETER(PAR.*JOB);
  {
   //?USER: Processing if Data record already exists

   // PGM.*Return code = CND.*Record already exists
   PGM.*Return_code = 'Y2U0003';

  }

  //?USER: Process Data record

  // LCL.TU Tattoo Cnt = DB1.TU Tattoo Cnt + PAR.TU Tattoo Cnt
  LCL.TU_Tattoo_Cnt = DB1.TU_Tattoo_Cnt + PAR.TU_Tattoo_Cnt;

  // LCL.TU Unloader Cnt = DB1.TU Unloader Cnt + PAR.TU Unloader Cnt
  LCL.TU_Unloader_Cnt = DB1.TU_Unloader_Cnt + PAR.TU_Unloader_Cnt;

  EXECUTE FUNCTION(Change Tattoo UnLoader Cn) TYPE(CHGOBJ) FILE(PLAXCPP)          AB1275003;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(LCL.TU_Tattoo_Cnt);
  PARAMETER(LCL.TU_Unloader_Cnt);
  PARAMETER(DB1.*JOB);
 }

 //?TOTAL RECORD     DATE = 999999 load 9999, shift of blank
 EXECUTE FUNCTION(Upd Tattoo/Upload Tot RT) TYPE(RTVOBJ) FILE(PLAXCPP)           AB1275008;
 PARAMETER(WRK.TU_Kill_Date);
 PARAMETER(WRK.TU_Shift);
 PARAMETER(WRK.TU_Load);
 PARAMETER(DB1.Employee_ID);
 PARAMETER(1);
 PARAMETER(0);
 PARAMETER(JOB.*JOB);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Tattoo UnLoader Cn) TYPE(CRTOBJ) FILE(PLAXCPP)          AB1275002;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(PAR.TU_Tattoo_Cnt);
  PARAMETER(PAR.TU_Unloader_Cnt);
  PARAMETER(PAR.*JOB);
  {
   //?USER: Processing if Data record already exists

   // PGM.*Return code = CND.*Record already exists
   PGM.*Return_code = 'Y2U0003';

  }

  //?USER: Process Data record

  // LCL.TU Tattoo Cnt = DB1.TU Tattoo Cnt + PAR.TU Tattoo Cnt
  LCL.TU_Tattoo_Cnt = DB1.TU_Tattoo_Cnt + PAR.TU_Tattoo_Cnt;

  // LCL.TU Unloader Cnt = DB1.TU Unloader Cnt + PAR.TU Unloader Cnt
  LCL.TU_Unloader_Cnt = DB1.TU_Unloader_Cnt + PAR.TU_Unloader_Cnt;

  EXECUTE FUNCTION(Change Tattoo UnLoader Cn) TYPE(CHGOBJ) FILE(PLAXCPP)          AB1275003;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(LCL.TU_Tattoo_Cnt);
  PARAMETER(LCL.TU_Unloader_Cnt);
  PARAMETER(DB1.*JOB);
 }

 EXECUTE FUNCTION(Upd Tattoo/Upload Tot RT) TYPE(RTVOBJ) FILE(PLAXCPP)           AB1275008;
 PARAMETER(WRK.TU_Kill_Date);
 PARAMETER(WRK.TU_Shift);
 PARAMETER(WRK.TU_Load);
 PARAMETER(DB1.Employee_Number_2_Employe);
 PARAMETER(0);
 PARAMETER(1);
 PARAMETER(JOB.*JOB);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Create Tattoo UnLoader Cn) TYPE(CRTOBJ) FILE(PLAXCPP)          AB1275002;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(PAR.TU_Tattoo_Cnt);
  PARAMETER(PAR.TU_Unloader_Cnt);
  PARAMETER(PAR.*JOB);
  {
   //?USER: Processing if Data record already exists

   // PGM.*Return code = CND.*Record already exists
   PGM.*Return_code = 'Y2U0003';

  }

  //?USER: Process Data record

  // LCL.TU Tattoo Cnt = DB1.TU Tattoo Cnt + PAR.TU Tattoo Cnt
  LCL.TU_Tattoo_Cnt = DB1.TU_Tattoo_Cnt + PAR.TU_Tattoo_Cnt;

  // LCL.TU Unloader Cnt = DB1.TU Unloader Cnt + PAR.TU Unloader Cnt
  LCL.TU_Unloader_Cnt = DB1.TU_Unloader_Cnt + PAR.TU_Unloader_Cnt;

  EXECUTE FUNCTION(Change Tattoo UnLoader Cn) TYPE(CHGOBJ) FILE(PLAXCPP)          AB1275003;
  PARAMETER(PAR.TU_Kill_Date);
  PARAMETER(PAR.TU_Shift);
  PARAMETER(PAR.TU_Load);
  PARAMETER(PAR.TU_Tattoo_Person);
  PARAMETER(LCL.TU_Tattoo_Cnt);
  PARAMETER(LCL.TU_Unloader_Cnt);
  PARAMETER(DB1.*JOB);
 }

 ENDIF;

}


