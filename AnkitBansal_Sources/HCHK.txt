
             PGM        PARM(&PROJ)

             DCL        VAR(&PROJ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TEXT) TYPE(*CHAR) LEN(30)
             DCL        VAR(&ATR) TYPE(*CHAR) LEN(3)
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(80)

             DCLF       FILE(YOBJLST)

             MONMSG     MSGID(CPF9815)

             YCVTJOBLST OBJLST(HPEDEVGEN/&PROJ) LSTOPT(*REPLACE)

             OVRDBF     FILE(YOBJLST) TOFILE(HPEDEVGEN/YOBJLST) +
                          MBR(&PROJ)

/*           Y2SYCM/ICRTPRJ PROJECT(&PROJ) */
/*           MONMSG     MSGID(CPF0000) */

 LOOP:       RCVF
             MONMSG     MSGID(CPF0864) EXEC(GOTO CMDLBL(DONE))
             MONMSG     MSGID(CPF0859)

             CHGVAR     VAR(&TEXT) VALUE(%SST(&ODOBTX 1 25))
             CHGVAR     VAR(&ATR) VALUE(' ')

/* OBJECT CODE */
             IF COND(&ODOBTP *EQ '*PNLGRP') THEN(DO)
              CHGVAR VAR(&ODOBAT) VALUE('PNLGRP')
              ENDDO

/*ATTRIBUTE TYPE */
             IF         COND(&ODOBTP *EQ '*FILE') +
             THEN(RTVMBRD    FILE(PRKSYNSRC/QDDSSRC) MBR(&ODOBNM) +
                          FILEATR(&ATR))
             ELSE +
             IF COND(&ODOBAT *EQ 'CLP') +
             THEN(RTVMBRD    FILE(PRKSYNSRC/QCLSRC) MBR(&ODOBNM) +
                          FILEATR(&ATR))
             ELSE +
             IF COND(&ODOBAT *EQ 'RPG') +
             THEN(RTVMBRD    FILE(PRKSYNSRC/QRPGSRC) MBR(&ODOBNM) +
                          FILEATR(&ATR))


             IF         COND(&ATR *NE ' ') THEN(DO)
/* ACTION=CHANGE */
             ICHKOUT    FRMENV(PRKHPEPRD) TOLIB(*USRPRF) +
                          TOENV(PRKHPEDEV) PRJREF(&PROJ) +
                          MBROBJ(&ODOBNM) OBJCODE(&ODOBAT) +
                          ACTION(*CHANGE) COMMENTS(&TEXT) +
                          CPYENV(*NONE) TOSRCF(*FRMENV) IGNWRN(*NO) +
                          REPLACE(*IGN)  /* WAS REPLACE(*NO)  */
             MONMSG     MSGID(CPF0001) EXEC(GOTO CMDLBL(ERROR))
             ENDDO
             ELSE       CMD(DO)
/* ACTION=CREATE */
             ICHKOUT    FRMENV(PRKHPEPRD) TOLIB(*USRPRF) +
                          TOENV(PRKHPEDEV) PRJREF(&PROJ) +
                          MBROBJ(&ODOBNM) OBJCODE(&ODOBAT) +
                          ACTION(*CREATE) COMMENTS(&TEXT) +
                          CPYENV(*NONE) TOSRCF(*FRMENV) IGNWRN(*NO) +
                          REPLACE(*IGN)    /* WAS REPLACE(*NO)  */
             MONMSG     MSGID(CPF0001) EXEC(GOTO CMDLBL(ERROR))
             ENDDO

             GOTO       CMDLBL(LOOP)

ERROR:
             RCVMSG     PGMQ(*SAME (*)) MSGTYPE(*DIAG) MSG(&MSG)
             SNDPGMMSG  MSG(&MSG)
/*           SNDPGMMSG  MSG('**LOCKED:' *BCAT &ODOBNM *TCAT ' - ' + */
/*                        *CAT &TEXT) */

             GOTO       CMDLBL(LOOP)
 DONE:       ENDPGM
