     H/TITLE Val CC/Obj/Subs    E1 XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISJBADE
     H* Date          : 04/14/20  Time  : 10:22:01
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FE10901LB  IF   E           K DISK
      * RSQ : Account Master     F0901  Biz Unit/Obj Acct/Subsid
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WQSA01         S                   LIKE(WAMCU)
     D  WQSA02         S                   LIKE(WAOBJ)
     D  WQSA03         S                   LIKE(WASUB)
     D  Y0CX01         S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS            26
      * KEY: Account Master     F0901  Biz Unit/Obj Acct/Subsid
      * I :  Business Unit/Cost Center
     D  P1MCU                  1     12
      * I :  Object Account
     D  P1OBJ                 13     18
      * I :  Subsidiary
     D  P1SUB                 19     26
     D P2PARM          DS
      * O :  Return Code
     D  P2LLTX                 1      7
     II0901LB
      * Account Master     F0901  Biz Unit/Obj Acct/Subsid
      * Renamed input format fields
     I              GMCO                        WACO
     I              GMAID                       WAAID
     I              GMMCU                       WAMCU
     I              GMOBJ                       WAOBJ
     I              GMSUB                       WASUB
     I              GMANS                       WAANS
     I              GMDL01                      WADL01
     I              GMLDA                       WALDA
     I              GMBPC                       WABPC
     I              GMPEC                       WAPEC
     I              GMBILL                      WABILL
     I              GMCRCD                      WACRCD
     I              GMUM                        WAUM
     I              GMR001                      WAR001
     I              GMR002                      WAR002
     I              GMR003                      WAR003
     I              GMR004                      WAR004
     I              GMR005                      WAR005
     I              GMR006                      WAR006
     I              GMR007                      WAR007
     I              GMR008                      WAR008
     I              GMR009                      WAR009
     I              GMR010                      WAR010
     I              GMR011                      WAR011
     I              GMR012                      WAR012
     I              GMR013                      WAR013
     I              GMR014                      WAR014
     I              GMR015                      WAR015
     I              GMR016                      WAR016
     I              GMR017                      WAR017
     I              GMR018                      WAR018
     I              GMR019                      WAR019
     I              GMR020                      WAR020
     I              GMR021                      WAR021
     I              GMR022                      WAR022
     I              GMR023                      WAR023
     I              GMOBJA                      WAOBJA
     I              GMSUBA                      WASUBA
     I              GMWCMP                      WAWCMP
     I              GMCCT                       WACCT
     I              GMERC                       WAERC
     I              GMHTC                       WAHTC
     I              GMQLDA                      WAQLDA
     I              GMCCC                       WACCC
     I              GMFMOD                      WAFMOD
     I              GMUSER                      WAUSER
     I              GMPID                       WAPID
     I              GMJOBN                      WAJOBN
     I              GMUPMJ                      WAUPMJ
     I              GMUPMT                      WAUPMT
     I              GMCEC1                      WACEC1
     I              GMCEC2                      WACEC2
     I              GMCEC3                      WACEC3
     I              GMCEC4                      WACEC4
     I              GMIEC                       WAIEC
     I              GMFPEC                      WAFPEC
     I              GMSTPC                      WASTPC
     I              GMTXGL                      WATXGL
     I              GMTOBJ                      WATOBJ
     I              GMTSUB                      WATSUB
     I              GMPRGF                      WAPRGF
     I              GMTXA1                      WATXA1
     I              GMR024                      WAR024
     I              GMR025                      WAR025
     I              GMR026                      WAR026
     I              GMR027                      WAR027
     I              GMR028                      WAR028
     I              GMR029                      WAR029
     I              GMR030                      WAR030
     I              GMR031                      WAR031
     I              GMR032                      WAR032
     I              GMR033                      WAR033
     I              GMR034                      WAR034
     I              GMR035                      WAR035
     I              GMR036                      WAR036
     I              GMR037                      WAR037
     I              GMR038                      WAR038
     I              GMR039                      WAR039
     I              GMR040                      WAR040
     I              GMR041                      WAR041
     I              GMR042                      WAR042
     I              GMR043                      WAR043
     I              GMADJE                      WAADJE
     I              GMUAFL                      WAUAFL
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         KEY: Account Ma
     C     P2LLTX        PARM      P2LLTX        WP0001                         Return Code
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Val CC/Obj/Subs    E1 XF
      * VAL CC/Obj/Subs    E1 RT - Account Master     F0901  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * VAL CC/Obj/Subs    E1 RT - Account Master     F0901  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Business Unit/C
     C                   KFLD                    WQSA02                         Object Account
     C                   KFLD                    WQSA03                         Subsidiary
      * Setup key
     C                   MOVEL     P1MCU         WQSA01                         Business Unit/C
     C                   MOVEL     P1OBJ         WQSA02                         Object Account
     C                   MOVEL     P1SUB         WQSA03                         Subsidiary
      * Establish starting position
     C     KRSSA         SETLL     I0901LB                                      *
     C     KRSSA         READE     I0901LB                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'E1I0096'     W0RTN
      * USER: Processing if Data record not found
     C                   EVAL      P2LLTX = ' '                                 Return Code
     C                   MOVEL     'Y'           P2LLTX                         Return Code
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CASE: Posting Edit flag is NOT 'I' and NOT 'N'
      *  - NOTc1 AND NOTc2
      *   |- c1    : DB1.Posting Edit is Inactive
      *   |- c2    : DB1.Posting Edit is Non-Post
      *   '-
     C                   DOW       NOT *IN90
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WAPEC = 'I'
     C                   ELSE
     C                   IF        WAPEC = 'N'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   EVAL      P2LLTX = ' '                                 Return Code
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      P2LLTX = ' '                                 Return Code
     C                   MOVEL     'Y'           P2LLTX                         Return Code
     C                   END                                                    *FI
     C     KRSSA         READE     I0901LB                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
