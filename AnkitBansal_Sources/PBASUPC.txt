/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  CALL PRINT AGED INVENTORY FROM JOB SCHEDULER       */
/*              AND SEND REPORTS TO VARIOUS DIST LISTS            */
/*********************************************************************/
/* Modifications:                                                    */
/*                                                                   */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/* 10/27/11  RMC NEW CLP CALLED FROM INVNIGHTRN AND INVNIGHTRS   */
/* 08/01/13  RMC E2703 CALL NEW PBJEPFR INSTEAD OF PBAMPFR-GUYMON      */
/* 08/14/13  RMC E2703 CALL NEW PBJEPFR INSTEAD OF PBAMPFR-& TRIUMPH   */
/* 02/28/17  JBB E9064 ADD COMPANY 440 PROCESSING.  ALSO ADDED       */
/*                     COMPANY AND WAREHOUSE CODES TO THE SUBJECT    */
/*                     LINE OF THE EMAILS.                           */
/* 06/15/17  RMC E9064 DO ABOVE WHEN 440 IS A PLANT COMPANY        */
/*********************************************************************/
/*                                                                  */
/*  COMPANY   - SEABOARD CORP                                       */
/*  SYSTEM    - INVENTORY CONTROL                                   */
/*  DATE      - 10/27/11                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*          &AVAILG     - AVAIL GROUP                               */
/*          &OUTQ       - OUTPUT QUEUE                             */
/********************************************************************/

 PBASUPC:   PGM        PARM(&RETURN)
             DCL        &RETURN     *CHAR    7
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10) +
                          VALUE(QPRINT2   ) /* OUTPUT QUEUE */
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)  VALUE(*YES)
             DCL        &AVAILG     *CHAR    3  /* AVAIL GROUP       */
             DCL        &SUBJECT    *CHAR    50    /* Email Subject     */
             DCL        &DISTAL3    *CHAR    40    /* AGED ALLOCATED      */
             DCL        &DISTNO3    *CHAR    40    /* AGED NOT ALLOC     */
             DCL        &DISTAL4    *CHAR    40    /* AGED ALLOCATED      */
             DCL        &DISTNO4    *CHAR    40    /* AGED NOT ALLOC     */
             DCL        &DISTAL9    *CHAR    40    /* AGED ALLOCATED      */
             DCL        &DISTNO9    *CHAR    40    /* AGED NOT ALLOC     */
             DCL        &AGEDAYS    *DEC         /*  AGEING DAYS  */
             DCL        &PLTCO      *CHAR    1     /* PLANT CO?           */
             DCL        &COORG      *CHAR    10    /* COMPANY ORG        */

/* GET EMAIL DIST LIST FOR AGED INV ALLOC           */
 GETEMLA3:  CALL       PGM(POMTXFR) PARM(' ' X'360F' 'INVAGEALC' &DISTAL3)
 GETEMLA4:  CALL       PGM(POMTXFR) PARM(' ' X'440F' 'INVAGEALC' &DISTAL4)
 GETEMLA9:  CALL       PGM(POMTXFR) PARM(' ' X'960F' 'INVAGEALC' &DISTAL9)
/* GET EMAIL DIST LIST FOR AGED INV NOT ALLOC REPORT      */
 GETEMLN3:  CALL       PGM(POMTXFR) PARM(' ' X'360F' 'INVAGENOT' &DISTNO3)
 GETEMLN4:  CALL       PGM(POMTXFR) PARM(' ' X'440F' 'INVAGENOT' &DISTNO4)
 GETEMLN9:  CALL       PGM(POMTXFR) PARM(' ' X'960F' 'INVAGENOT' &DISTNO9)
 GETPLT44:  CALL       PGM(PMOVXFR) PARM(' ' X'440F' &PLTCO &COORG)
/*------------------------------------------------------------------*/
/* PRINT THE AGED INVENTORY REPORTS FOR DIFF DL LISTS            */
/*------------------------------------------------------------------*/
/* AGED INVENTORY NOT ALLOCATED                     */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&AGEDAYS) VALUE(1)
             CALL       PGM(PDRZCLP) PARM('PBALPFR' 360.00000 'GP1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ &HOLD  '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)
             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Not Allocated +
                          - 360/GP1')
             ESNDMAIL   RECIPIENT(&DISTNO3) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBALPFR$ * *LAST *ONLY))
    IF COND(&PLTCO *EQ 'P') THEN(DO)
             CALL       PGM(PDRZCLP) PARM('PBALPFR' 440.00000 'ST1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ &HOLD  '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)
             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Not Allocated +
                          - 440/ST1')
             ESNDMAIL   RECIPIENT(&DISTNO4) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBALPFR$ * *LAST *ONLY))
                          ENDDO

             CALL       PGM(PDRZCLP) PARM('PBALPFR' 960.00000 'SJ1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ &HOLD  '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)
             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Not Allocated +
                          - 960/SJ1')
             ESNDMAIL   RECIPIENT(&DISTNO9) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBALPFR$ * *LAST *ONLY))

/*------------------------------------------------------------------*/
/* AGED INVENTORY ALLOCATED                     */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&AGEDAYS) VALUE(4)
     GOTO       CMDLBL(E2703G)
/*-------BY ITEM THEN ORDER    -------------------------------------*/
             CALL       PGM(PDRZCLP) PARM('PBAMPFR' 360.00000 'GP1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ &HOLD       '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)

             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Allocated by +
                          Item/Order - 360/GP1')
             ESNDMAIL   RECIPIENT(&DISTAL3) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBAMPFR$ * *LAST *ONLY))

    IF COND(&PLTCO *EQ 'P') THEN(DO)
             CALL       PGM(PDRZCLP) PARM('PBAMPFR' 440.00000 'ST1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ &HOLD       '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)

             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Allocated by +
                          Item/Order - 440/ST1')
             ESNDMAIL   RECIPIENT(&DISTAL4) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBAMPFR$ * *LAST *ONLY))
                          ENDDO

             CALL       PGM(PDRZCLP) PARM('PBAMPFR' 960.00000 'SJ1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ  &HOLD      '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)

             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Allocated by +
                          Item/Order - 960/SJ1')
             ESNDMAIL   RECIPIENT(&DISTAL9) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBAMPFR$ * *LAST *ONLY))

/*-------BY ORDER THEN ITEM   -------------------------------------*/
E2703G:      CALL       PGM(PDRZCLP) PARM('PBJEPFR' 360.00000 'GP1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ &HOLD       '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)

             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Allocated by +
                          Order/Item - 360/GP1')
             ESNDMAIL   RECIPIENT(&DISTAL3) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBJEPFR$ * *LAST *ONLY))

E9064B:    IF COND(&PLTCO *EQ 'P') THEN(DO)
             CALL       PGM(PDRZCLP) PARM('PBJEPFR' 440.00000 'ST1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ &HOLD       '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)

             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Allocated by +
                          Order/Item - 440/ST1')
             ESNDMAIL   RECIPIENT(&DISTAL4) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBJEPFR$ * *LAST *ONLY))
                          ENDDO

 TRIUMF:     CALL       PGM(PDRZCLP) PARM('PBJEPFR' 960.00000 'SJ1' +
                          0.00000 ' ' ' ' ' ' 0.00000 0.00000 +
                          0.00000 'Y' 'N' &OUTQ  &HOLD      '*YES' +
                          1.00000 '*JOBD' &AGEDAYS &AVAILG)

             CHGVAR     VAR(&SUBJECT) VALUE('Aged Inv Allocated by +
                          Order/Item - 960/SJ1')
             ESNDMAIL   RECIPIENT(&DISTAL9) SUBJECT(&SUBJECT) +
                          ATTLIST((* *PDF *N PBJEPFR$ * *LAST *ONLY))
             ENDPGM
