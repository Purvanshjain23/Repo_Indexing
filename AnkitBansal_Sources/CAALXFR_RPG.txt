     H/TITLE Prc Create Dtl Receipt XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/15/06  Time  : 08:09:39
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FCAB0REL0UF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WBAIC3
     I              B0HGCD                          WBHGCD
     I              B0AJCD                          WBAJCD
     I              B0AGCS                          WBAGCS
     I              B0AECS                          WBAECS
     I              B0BACS                          WBBACS
     I              B0BBCS                          WBBBCS
     I              B0CBPR                          WBCBPR
     I              B0GUDT                          WBGUDT
     I              B0XYST                          WBXYST
     I              B0CTPR                          WBCTPR
     I              B0G4DT                          WBG4DT
     I              B0BOWG                          WBBOWG
     I              B0DDQT                          WBDDQT
     I              B0DEQT                          WBDEQT
     I              B0DFQT                          WBDFQT
     I              B0HDQT                          WBHDQT
     I              B0HEQT                          WBHEQT
     I              B0AJQT                          WBAJQT
     I              B0AQQT                          WBAQQT
     I              B0AUQT                          WBAUQT
     I              B0EMQT                          WBEMQT
     I              B0DOQT                          WBDOQT
     I              B0ATNA                          WBATNA
     I              B0AKDT                          WBAKDT
     I              B0ANDT                          WBANDT
     I              B0IDVA                          WBIDVA
     I              B0JVST                          WBJVST
     I              B0BZPC                          WBBZPC
     I              B0DGQT                          WBDGQT
     I              B0DIDT                          WBDIDT
     I              B0ALCD                          WBALCD
     I              B0BFDY                          WBBFDY
     I              B0DJDT                          WBDJDT
     I              B0BGDY                          WBBGDY
     I              B0DKDT                          WBDKDT
     I              B0J2ST                          WBJ2ST
     I              B0DJQT                          WBDJQT
     I              B0BNWG                          WBBNWG
     I              B0DLDT                          WBDLDT
     I              B0DPQT                          WBDPQT
     I              B0DQQT                          WBDQQT
     I              B0DMDT                          WBDMDT
     I              B0M0ST                          WBM0ST
     I              B0J9ST                          WBJ9ST
     I              B0KBST                          WBKBST
     I              B0AKC8                          WBAKC8
     I              B0RINB                          WBRINB
     I              B0RHNB                          WBRHNB
     I              B0RGNB                          WBRGNB
     I              B0UVST                          WBUVST
     I              B0UWST                          WBUWST
     I              B0UXST                          WBUXST
     I              B0VSST                          WBVSST
     I              B0AATM                          WBAATM
     I              B0AYNA                          WBAYNA
     I              B0A0NA                          WBA0NA
     I              B0AXDT                          WBAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WCAIC3
     I              B0HGCD                          WCHGCD
     I              B0AJCD                          WCAJCD
     I              B0AGCS                          WCAGCS
     I              B0AECS                          WCAECS
     I              B0BACS                          WCBACS
     I              B0BBCS                          WCBBCS
     I              B0CBPR                          WCCBPR
     I              B0GUDT                          WCGUDT
     I              B0XYST                          WCXYST
     I              B0CTPR                          WCCTPR
     I              B0G4DT                          WCG4DT
     I              B0BOWG                          WCBOWG
     I              B0DDQT                          WCDDQT
     I              B0DEQT                          WCDEQT
     I              B0DFQT                          WCDFQT
     I              B0HDQT                          WCHDQT
     I              B0HEQT                          WCHEQT
     I              B0AJQT                          WCAJQT
     I              B0AQQT                          WCAQQT
     I              B0AUQT                          WCAUQT
     I              B0EMQT                          WCEMQT
     I              B0DOQT                          WCDOQT
     I              B0ATNA                          WCATNA
     I              B0AKDT                          WCAKDT
     I              B0ANDT                          WCANDT
     I              B0IDVA                          WCIDVA
     I              B0JVST                          WCJVST
     I              B0BZPC                          WCBZPC
     I              B0DGQT                          WCDGQT
     I              B0DIDT                          WCDIDT
     I              B0ALCD                          WCALCD
     I              B0BFDY                          WCBFDY
     I              B0DJDT                          WCDJDT
     I              B0BGDY                          WCBGDY
     I              B0DKDT                          WCDKDT
     I              B0J2ST                          WCJ2ST
     I              B0DJQT                          WCDJQT
     I              B0BNWG                          WCBNWG
     I              B0DLDT                          WCDLDT
     I              B0DPQT                          WCDPQT
     I              B0DQQT                          WCDQQT
     I              B0DMDT                          WCDMDT
     I              B0M0ST                          WCM0ST
     I              B0J9ST                          WCJ9ST
     I              B0KBST                          WCKBST
     I              B0AKC8                          WCAKC8
     I              B0RINB                          WCRINB
     I              B0RHNB                          WCRHNB
     I              B0RGNB                          WCRGNB
     I              B0UVST                          WCUVST
     I              B0UWST                          WCUWST
     I              B0UXST                          WCUXST
     I              B0VSST                          WCVSST
     I              B0AATM                          WCAATM
     I              B0AYNA                          WCAYNA
     I              B0A0NA                          WCA0NA
     I              B0AXDT                          WCAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WDAIC3
     I              B7HGCD                          WDHGCD
     I              B7AJCD                          WDAJCD
     I              B7W9ST                          WDW9ST
     I              B7BSST                          WDBSST
     I              B7B4DT                          WDB4DT
     I              B7C4NY                          WDC4NY
     I              B7DXNB                          WDDXNB
     I              B7ELDT                          WDELDT
     I              B7HVCD                          WDHVCD
     I              B7F1ST                          WDF1ST
     I              B7AUNA                          WDAUNA
     I              B7A5QT                          WDA5QT
     I              B7AHWG                          WDAHWG
     I              B7AKCS                          WDAKCS
     I              B7CGCD                          WDCGCD
     I              B7AYVA                          WDAYVA
     I              B7BJNA                          WDBJNA
     I              B7CKNB                          WDCKNB
     I              B7BMST                          WDBMST
     I              B7CQCD                          WDCQCD
     I              B7DTCD                          WDDTCD
     I              B7MGNA                          WDMGNA
     I              B7TRBN                          WDTRBN
     I              B7TRBS                          WDTRBS
     I              B7C4NB                          WDC4NB
     I              B7RINB                          WDRINB
     I              B7RHNB                          WDRHNB
     I              B7RGNB                          WDRGNB
     I              B7M3NA                          WDM3NA
     I              B7AWTM                          WDAWTM
     I              B7XLCD                          WDXLCD
     I              B7K7DT                          WDK7DT
     I              B7UVST                          WDUVST
     I              B7UWST                          WDUWST
     I              B7UXST                          WDUXST
     I              B7VSST                          WDVSST
     I              B7AATM                          WDAATM
     I              B7AYNA                          WDAYNA
     I              B7A0NA                          WDA0NA
     I              B7AXDT                          WDAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WEAIC3
     I              B7HGCD                          WEHGCD
     I              B7AJCD                          WEAJCD
     I              B7W9ST                          WEW9ST
     I              B7BSST                          WEBSST
     I              B7B4DT                          WEB4DT
     I              B7C4NY                          WEC4NY
     I              B7DXNB                          WEDXNB
     I              B7ELDT                          WEELDT
     I              B7HVCD                          WEHVCD
     I              B7F1ST                          WEF1ST
     I              B7AUNA                          WEAUNA
     I              B7A5QT                          WEA5QT
     I              B7AHWG                          WEAHWG
     I              B7AKCS                          WEAKCS
     I              B7CGCD                          WECGCD
     I              B7AYVA                          WEAYVA
     I              B7BJNA                          WEBJNA
     I              B7CKNB                          WECKNB
     I              B7BMST                          WEBMST
     I              B7CQCD                          WECQCD
     I              B7DTCD                          WEDTCD
     I              B7MGNA                          WEMGNA
     I              B7TRBN                          WETRBN
     I              B7TRBS                          WETRBS
     I              B7C4NB                          WEC4NB
     I              B7RINB                          WERINB
     I              B7RHNB                          WERHNB
     I              B7RGNB                          WERGNB
     I              B7M3NA                          WEM3NA
     I              B7AWTM                          WEAWTM
     I              B7XLCD                          WEXLCD
     I              B7K7DT                          WEK7DT
     I              B7UVST                          WEUVST
     I              B7UWST                          WEUWST
     I              B7UXST                          WEUXST
     I              B7VSST                          WEVSST
     I              B7AATM                          WEAATM
     I              B7AYNA                          WEAYNA
     I              B7A0NA                          WEA0NA
     I              B7AXDT                          WEAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WJAIC3
     I              B1HGCD                          WJHGCD
     I              B1AJCD                          WJAJCD
     I              B1ELDT                          WJELDT
     I              B1ABWG                          WJABWG
     I              B1AGQT                          WJAGQT
     I              B1AHQT                          WJAHQT
     I              B1AIQT                          WJAIQT
     I              B1CTST                          WJCTST
     I              B1ACWG                          WJACWG
     I              B1ARQT                          WJARQT
     I              B1ASQT                          WJASQT
     I              B1ATQT                          WJATQT
     I              B1HDQT                          WJHDQT
     I              B1HEQT                          WJHEQT
     I              B1F6ST                          WJF6ST
     I              B1BMWG                          WJBMWG
     I              B1DSQT                          WJDSQT
     I              B1DTQT                          WJDTQT
     I              B1DUQT                          WJDUQT
     I              B1DHDT                          WJDHDT
     I              B1AGCS                          WJAGCS
     I              B1AECS                          WJAECS
     I              B1IDVA                          WJIDVA
     I              B1K7DT                          WJK7DT
     I              B1RINB                          WJRINB
     I              B1RHNB                          WJRHNB
     I              B1RGNB                          WJRGNB
     I              B1UVST                          WJUVST
     I              B1UWST                          WJUWST
     I              B1UXST                          WJUXST
     I              B1VSST                          WJVSST
     I              B1AATM                          WJAATM
     I              B1AYNA                          WJAYNA
     I              B1A0NA                          WJA0NA
     I              B1AXDT                          WJAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WCAIC3
     I              B0HGCD                          WCHGCD
     I              B0AJCD                          WCAJCD
     I              B0AGCS                          WCAGCS
     I              B0AECS                          WCAECS
     I              B0BACS                          WCBACS
     I              B0BBCS                          WCBBCS
     I              B0CBPR                          WCCBPR
     I              B0GUDT                          WCGUDT
     I              B0XYST                          WCXYST
     I              B0CTPR                          WCCTPR
     I              B0G4DT                          WCG4DT
     I              B0BOWG                          WCBOWG
     I              B0DDQT                          WCDDQT
     I              B0DEQT                          WCDEQT
     I              B0DFQT                          WCDFQT
     I              B0HDQT                          WCHDQT
     I              B0HEQT                          WCHEQT
     I              B0AJQT                          WCAJQT
     I              B0AQQT                          WCAQQT
     I              B0AUQT                          WCAUQT
     I              B0EMQT                          WCEMQT
     I              B0DOQT                          WCDOQT
     I              B0ATNA                          WCATNA
     I              B0AKDT                          WCAKDT
     I              B0ANDT                          WCANDT
     I              B0IDVA                          WCIDVA
     I              B0JVST                          WCJVST
     I              B0BZPC                          WCBZPC
     I              B0DGQT                          WCDGQT
     I              B0DIDT                          WCDIDT
     I              B0ALCD                          WCALCD
     I              B0BFDY                          WCBFDY
     I              B0DJDT                          WCDJDT
     I              B0BGDY                          WCBGDY
     I              B0DKDT                          WCDKDT
     I              B0J2ST                          WCJ2ST
     I              B0DJQT                          WCDJQT
     I              B0BNWG                          WCBNWG
     I              B0DLDT                          WCDLDT
     I              B0DPQT                          WCDPQT
     I              B0DQQT                          WCDQQT
     I              B0DMDT                          WCDMDT
     I              B0M0ST                          WCM0ST
     I              B0J9ST                          WCJ9ST
     I              B0KBST                          WCKBST
     I              B0AKC8                          WCAKC8
     I              B0RINB                          WCRINB
     I              B0RHNB                          WCRHNB
     I              B0RGNB                          WCRGNB
     I              B0UVST                          WCUVST
     I              B0UWST                          WCUWST
     I              B0UXST                          WCUXST
     I              B0VSST                          WCVSST
     I              B0AATM                          WCAATM
     I              B0AYNA                          WCAYNA
     I              B0A0NA                          WCA0NA
     I              B0AXDT                          WCAXDT
      *
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WEAIC3
     I              B7HGCD                          WEHGCD
     I              B7AJCD                          WEAJCD
     I              B7W9ST                          WEW9ST
     I              B7BSST                          WEBSST
     I              B7B4DT                          WEB4DT
     I              B7C4NY                          WEC4NY
     I              B7DXNB                          WEDXNB
     I              B7ELDT                          WEELDT
     I              B7HVCD                          WEHVCD
     I              B7F1ST                          WEF1ST
     I              B7AUNA                          WEAUNA
     I              B7A5QT                          WEA5QT
     I              B7AHWG                          WEAHWG
     I              B7AKCS                          WEAKCS
     I              B7CGCD                          WECGCD
     I              B7AYVA                          WEAYVA
     I              B7BJNA                          WEBJNA
     I              B7CKNB                          WECKNB
     I              B7BMST                          WEBMST
     I              B7CQCD                          WECQCD
     I              B7DTCD                          WEDTCD
     I              B7MGNA                          WEMGNA
     I              B7TRBN                          WETRBN
     I              B7TRBS                          WETRBS
     I              B7C4NB                          WEC4NB
     I              B7RINB                          WERINB
     I              B7RHNB                          WERHNB
     I              B7RGNB                          WERGNB
     I              B7M3NA                          WEM3NA
     I              B7AWTM                          WEAWTM
     I              B7XLCD                          WEXLCD
     I              B7K7DT                          WEK7DT
     I              B7UVST                          WEUVST
     I              B7UWST                          WEUWST
     I              B7UXST                          WEUXST
     I              B7VSST                          WEVSST
     I              B7AATM                          WEAATM
     I              B7AYNA                          WEAYNA
     I              B7A0NA                          WEA0NA
     I              B7AXDT                          WEAXDT
      *
     IYARDCS      DS                            245
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     IYBRDCS      DS                            163
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Inventory Trans. ID
     I                                       10  10 P1W9ST
      * I :  Inventory Trans. Type
     I                                       11  12 P1BSST
      * I :  Transaction Date Code
     I                                    P  13  160P1B4DT
      * N :  ITD Sequence Number
     I                                    P  17  190P1C4NY
      * N :  Sequence Number
     I                                    P  20  210P1DXNB
      * I :  Production Date
     I                                    P  22  250P1ELDT
      * I :  Description
     I                                       26  55 P1AUNA
      * I :  Transaction Quantity
     I                                    P  56  612P1A5QT
      * I :  Transaction Weight
     I                                    P  62  672P1AHWG
      * N :  USR Transaction-Unit Cost
     I                                    P  68  734P1AKCS
      * N :  Extended Amount
     I                                    P  74  792P1AYVA
      * I :  Reason Code
     I                                       80  82 P1CQCD
      * I :  Shift Number
     I                                       83  83 P1XLCD
      * I :  Label Date
     I                                    P  84  870P1K7DT
     IP2PARM      DS
      * FLD: Company Item
      * N :  U/M - Primary
     I                                        1   2 P2ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P2AWPC
      * N :  Operation Factor 1
     I                                        8   8 P2LXST
      * N :  U/M - Second
     I                                        9  10 P2AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P2AXPC
      * N :  Operation Factor 2
     I                                       16  16 P2LYST
      * N :  U/M - Third
     I                                       17  18 P2AFCD
      * N :  U/M - Pricing
     I                                       19  20 P2AICD
      * N :  Unit Weight
     I                                    P  21  262P2AIWG
      * N :  Production Date Control
     I                                       27  27 P2FZST
      * N :  Catch Weight Status
     I                                       28  28 P2AVST
      * N :  Item Structure Class Code
     I                                    P  29  300P2RINB
      * N :  Item Structure Group Code
     I                                    P  31  320P2RHNB
      * N :  Item Structure Type Code
     I                                    P  33  340P2RGNB
      * N :  Default Commod Mark basis
     I                                       35  37 P2LNCD
      * N :  Price Method Default
     I                                       38  40 P2Q8CD
     IP3PARM      DS
      * FLD: Item Balance
      * N :  Unit Cost Per Pound
     I                                    P   1   64P3AGCS
      * N :  Revaluation Cost
     I                                    P   7  124P3CBPR
     IP4PARM      DS
      * FLD: STR Quantity/Price Convrt
      * N :  Cost based on U/M1 S
     I                                    P   1   64P4ANCS
      * N :  Cost based on U/M2 S
     I                                    P   7  124P4AOCS
      * N :  Cost based on U/M3 S
     I                                    P  13  184P4APCS
     IP5PARM      DS
      * N :  USR Reason Code
     I                                        1   3 P5O9CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1W9ST    PARM           WP0004  1        Inventory Trans
     C           P1BSST    PARM           WP0005  2        Inventory Trans
     C           P1B4DT    PARM           WP0006  70       Transaction Dat
     C           P1ELDT    PARM           WP0007  70       Production Date
     C           P1AUNA    PARM           WP0008 30        Description
     C           P1A5QT    PARM           WP0009 112       Transaction Qua
     C           P1AHWG    PARM           WP0010 112       Transaction Wei
     C           P1CQCD    PARM           WP0011  3        Reason Code
     C           P1XLCD    PARM           WP0012  1        Shift Number
     C           P1K7DT    PARM           WP0013  70       Label Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Create Dtl Receipt XF
     C                     MOVELP1CQCD    P5O9CD           USR Reason Code
      * RTV Dsc,U/M,PrcInf,Str RT - Company/Item  * 
     C                     EXSR SARVGN
      * Rtv Status/Default     RT - IC Item Balance  * 
     C                     EXSR SBRVGN
      * If item balance not found then create it
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
     C                     EXSR SCRVGN
     C                     Z-ADDP1B4DT    WUGIDT           Pricing Date Us
      * CLC Rtv Unit Cost/LB   XF - IC Item Balance  * 
     C                     CALL 'PDLSXFR'              90  CLC Rtv Unit Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1HGCD    WQ0002  70       Item Code
     C                     PARM P1AJCD    WQ0003  3        Warehouse Code
     C           P3AGCS    PARM P3AGCS    WQ0004 114       Unit Cost Per P
     C           WUBACS    PARM WUBACS    WQ0005 114       Cost per Primar
     C           WUGIDT    PARM WUGIDT    WQ0006  70       Pricing Date Us
     C           WUU1ST    PARM WUU1ST    WQ0007  1        Price Status
     C                     PARM P1B4DT    WQ0008  70       As of Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error transaction if no unit cost
      * CASE: PAR.Unit Cost Per Pound EQ WRK.ZERO
     C           P3AGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     P5O9CD           USR Reason Code
     C                     END                             *FI
      * Crt Item Balance       CR - IC Item Balance  * 
     C                     EXSR SDCRRC
     C                     END                             *FI
      * Create transaction in IC Transaction Detail file
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
     C                     EXSR SERVGN
     C           P1AHWG    MULT P3AGCS    P1AYVA    H      Extended Amount
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     EXSR SFCRRC
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
     C                     EXSR SGRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Dsc,U/M,PrcInf,Str RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    P2ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           U/M - Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           U/M - Third
     C                     MOVEL*BLANK    P2AICD           U/M - Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     Z-ADD*ZERO     P2RINB           Item Structure
     C                     Z-ADD*ZERO     P2RHNB           Item Structure
     C                     Z-ADD*ZERO     P2RGNB           Item Structure
     C                     MOVEL*BLANK    P2LNCD           Default Commod
     C                     MOVEL*BLANK    P2Q8CD           Price Method De
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WUAVNA           Description Lin
     C                     MOVELWAAWNA    WUAWNA           Description Lin
     C                     MOVELWAADCD    P2ADCD           U/M - Primary
     C                     Z-ADDWAAWPC    P2AWPC           Conversion Fact
     C                     MOVELWALXST    P2LXST           Operation Facto
     C                     MOVELWAAECD    P2AECD           U/M - Second
     C                     Z-ADDWAAXPC    P2AXPC           Conversion Fact
     C                     MOVELWALYST    P2LYST           Operation Facto
     C                     MOVELWAAFCD    P2AFCD           U/M - Third
     C                     MOVELWAAICD    P2AICD           U/M - Pricing
     C                     Z-ADDWAAIWG    P2AIWG           Unit Weight
     C                     MOVELWAFZST    P2FZST           Production Date
     C                     MOVELWAAVST    P2AVST           Catch Weight St
     C                     Z-ADDWARINB    P2RINB           Item Structure
     C                     Z-ADDWARHNB    P2RHNB           Item Structure
     C                     Z-ADDWARGNB    P2RGNB           Item Structure
     C                     MOVELWALNCD    P2LNCD           Default Commod
     C                     MOVELWAQ8CD    P2Q8CD           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Status/Default     RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1HGCD    WBHGCD           Item Code
     C                     MOVELP1AJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3AGCS           Unit Cost Per P
     C                     MOVEL*BLANK    WUJ9ST           Cost Update Pen
     C                     MOVEL*BLANK    WUKBST           Post G/L Status
     C                     Z-ADD*ZERO     WUAKC8           Vendor - Item/W
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    P3AGCS           Unit Cost Per P
     C                     MOVELWBJ9ST    WUJ9ST           Cost Update Pen
     C                     MOVELWBKBST    WUKBST           Post G/L Status
     C                     Z-ADDWBAKC8    WUAKC8           Vendor - Item/W
     C                     MOVELWBVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARINB    WURINB           Item Structure
     C                     Z-ADDWARHNB    WURHNB           Item Structure
     C                     Z-ADDWARGNB    WURGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     Z-ADDP1HGCD    WCHGCD           Item Code
     C                     MOVELP1AJCD    WCAJCD           Warehouse Code
     C                     Z-ADDP3AGCS    WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAECS           Last Cost
     C                     Z-ADD*ZERO     WCBACS           Cost per Primar
     C                     Z-ADD*ZERO     WCBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WCCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WCGUDT           Revaluation Eff
     C                     MOVEL*BLANK    WCXYST           Revaluation Cos
     C                     Z-ADD*ZERO     WCCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WCG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WCBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WCDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WCDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WCDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WCHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WCHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WCAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WCAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WCEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WCDOQT           Quantity Avail.
     C                     MOVEL*BLANK    WCATNA           Cycle Count Cod
     C                     Z-ADD*ZERO     WCAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WCANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WCIDVA           Value of On Han
     C                     MOVEL'N'       WCJVST           Inventory Plann
     C                     Z-ADD*ZERO     WCBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WCDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WCDIDT           Stock Out Date
     C                     MOVEL*BLANK    WCALCD           Buyer Code
     C                     Z-ADD*ZERO     WCBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WCDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WCBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WCDKDT           Lead Time - Dat
     C                     MOVEL'N'       WCJ2ST           Lead Time - Exc
     C                     Z-ADD*ZERO     WCDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WCBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WCDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WCDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WCDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WCDMDT           Last Physical C
     C                     MOVEL'N'       WCM0ST           Requisition Mod
     C                     MOVEL'N'       WCJ9ST           Cost Update Pen
     C                     MOVEL'N'       WCKBST           Post G/L Status
     C                     Z-ADD*ZERO     WCAKC8           Vendor - Item/W
     C                     Z-ADDWURINB    WCRINB           Item Structure
     C                     Z-ADDWURHNB    WCRHNB           Item Structure
     C                     Z-ADDWURGNB    WCRGNB           Item Structure
     C                     MOVEL*BLANK    WCUVST           EDI Status 1
     C                     MOVEL*BLANK    WCUWST           EDI Status 2
     C                     MOVEL*BLANK    WCUXST           EDI Status 3
     C                     MOVEL'A'       WCVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WCAATM' defaulted for 'Job Time'.
      * Field '(DB1) WCAYNA' defaulted for 'User Id'.
      * Field '(DB1) WCA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WCAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSD    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WDHGCD    WQSE02           Item Code
     C           *LIKE     DEFN WDAJCD    WQSE03           Warehouse Code
     C           *LIKE     DEFN WDW9ST    WQSE04           Inventory Trans
     C           *LIKE     DEFN WDBSST    WQSE05           Inventory Trans
     C           *LIKE     DEFN WDB4DT    WQSE06           Transaction Dat
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
     C                     KFLD           WQSE03           Warehouse Code
     C                     KFLD           WQSE04           Inventory Trans
     C                     KFLD           WQSE05           Inventory Trans
     C                     KFLD           WQSE06           Transaction Dat
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP1HGCD    WQSE02           Item Code
     C                     MOVELP1AJCD    WQSE03           Warehouse Code
     C                     MOVELP1W9ST    WQSE04           Inventory Trans
     C                     MOVELP1BSST    WQSE05           Inventory Trans
     C                     Z-ADDP1B4DT    WQSE06           Transaction Dat
      * Establish starting position
     C           KRSSE     SETLL@B7CPZA                    *
     C           KRSSE     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         P1C4NY           ITD Sequence Nu
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WDC4NY    ADD  1         P1C4NY           ITD Sequence Nu
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  60       Job Time
     C                     MOVEL*BLANK    WN0006 10        User Id
     C                     MOVEL*BLANK    WN0007 10        Job Name
     C                     Z-ADD*ZERO     WN0008  70       Job Date
     C                     Z-ADD*ZERO     WN0009  20       Production Hour
     C                     Z-ADD*ZERO     WN0010 112       Production Weig
     C                     Z-ADD*ZERO     WN0011  50       Production Quan
     C                     Z-ADD*ZERO     WN0012  70       Production Piec
     C                     MOVEL*BLANK    WN0013  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     Z-ADDP1HGCD    WEHGCD           Item Code
     C                     MOVELP1AJCD    WEAJCD           Warehouse Code
     C                     MOVELP1W9ST    WEW9ST           Inventory Trans
     C                     MOVELP1BSST    WEBSST           Inventory Trans
     C                     Z-ADDP1B4DT    WEB4DT           Transaction Dat
     C                     Z-ADDP1C4NY    WEC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WEDXNB           Sequence Number
     C                     Z-ADDP1ELDT    WEELDT           Production Date
     C                     MOVELP2ADCD    WEHVCD           U/M - Transacti
     C                     MOVEL'PL'      WEF1ST           Item Transactio
     C                     MOVELP1AUNA    WEAUNA           Description
     C                     Z-ADDP1A5QT    WEA5QT           Transaction Qua
     C                     Z-ADDP1AHWG    WEAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WEAKCS           USR Transaction
     C                     MOVEL'LB'      WECGCD           U/M - Cost
     C                     Z-ADDP1AYVA    WEAYVA           Extended Amount
     C                     MOVEL*BLANK    WEBJNA           Ticket Number
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     MOVEL'N'       WEBMST           G/L Update Stat
     C                     MOVELP5O9CD    WECQCD           Reason Code
     C                     MOVEL*BLANK    WEDTCD           Reference Numbe
     C                     MOVEL*BLANK    WEMGNA           Lot ID
     C                     Z-ADD*ZERO     WETRBN           Transfer Batch
     C                     Z-ADD*ZERO     WETRBS           Transfer Batch
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADDP2RINB    WERINB           Item Structure
     C                     Z-ADDP2RHNB    WERHNB           Item Structure
     C                     Z-ADDP2RGNB    WERGNB           Item Structure
     C                     MOVEL*BLANK    WEM3NA           Employee Badge
     C                     Z-ADD*ZERO     WEAWTM           Production Time
     C                     MOVELP1XLCD    WEXLCD           Shift Number
     C                     Z-ADDP1K7DT    WEK7DT           Label Date
     C                     MOVEL*BLANK    WEUVST           EDI Status 1
     C                     MOVEL*BLANK    WEUWST           EDI Status 2
     C                     MOVEL*BLANK    WEUXST           EDI Status 3
     C                     MOVEL'A'       WEVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEW9ST           Inventory Trans
     C                     KFLD           WEBSST           Inventory Trans
     C                     KFLD           WEB4DT           Transaction Dat
     C                     KFLD           WEC4NY           ITD Sequence Nu
     C                     KFLD           WEDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSF    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0009  30       Company Number
     C                     PARM WEHGCD    WQ0010  70       Item Code
     C                     PARM WEAJCD    WQ0011  3        Warehouse Code
     C                     PARM WEW9ST    WQ0012  1        Inventory Trans
     C                     PARM WEBSST    WQ0013  2        Inventory Trans
     C                     PARM WEB4DT    WQ0014  70       Transaction Dat
     C                     PARM WEDXNB    WQ0015  30       Sequence Number
     C                     PARM WEELDT    WQ0016  70       Production Date
     C                     PARM WEHVCD    WQ0017  2        U/M - Transacti
     C                     PARM WEF1ST    WQ0018  2        Item Transactio
     C                     PARM WEAUNA    WQ0019 30        Description
     C                     PARM WEA5QT    WQ0020 112       Transaction Qua
     C                     PARM WEAHWG    WQ0021 112       Transaction Wei
     C                     PARM WEAKCS    WQ0022 114       USR Transaction
     C                     PARM WECGCD    WQ0023  2        U/M - Cost
     C                     PARM WEAYVA    WQ0024 112       Extended Amount
     C                     PARM WEBJNA    WQ0025  6        Ticket Number
     C                     PARM WECKNB    WQ0026  80       G/L Document Nu
     C                     PARM WEBMST    WQ0027  1        G/L Update Stat
     C                     PARM WECQCD    WQ0028  3        Reason Code
     C                     PARM WEDTCD    WQ0029 15        Reference Numbe
     C                     PARM WEMGNA    WQ0030 10        Lot ID
     C                     PARM WETRBN    WQ0031  70       Transfer Batch
     C                     PARM WETRBS    WQ0032  30       Transfer Batch
     C                     PARM WEC4NB    WQ0033  70       Order Number
     C                     PARM WERINB    WQ0034  30       Item Structure
     C                     PARM WERHNB    WQ0035  30       Item Structure
     C                     PARM WERGNB    WQ0036  30       Item Structure
     C                     PARM WEM3NA    WQ0037 10        Employee Badge
     C                     PARM WEAWTM    WQ0038  60       Production Time
     C                     PARM WEXLCD    WQ0039  1        Shift Number
     C                     PARM WEK7DT    WQ0040  70       Label Date
     C                     PARM WEVSST    WQ0041  1        Record Status
     C                     PARM WEAATM    WQ0042  60       Job Time
     C                     PARM WEAXDT    WQ0043  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0014  2        U/M - Cost
     C                     Z-ADD*ZERO     WN0015 112       Extended Amount
     C                     MOVEL*BLANK    WN0016  1        G/L Update Stat
     C                     MOVEL*BLANK    WN0017 30        Description Lin
     C                     MOVEL*BLANK    WN0018  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0019  94       Conversion Fact
     C                     MOVEL*BLANK    WN0020  1        Operation Facto
     C                     MOVEL*BLANK    WN0021  2        U/M - Second
     C                     Z-ADD*ZERO     WN0022  94       Conversion Fact
     C                     MOVEL*BLANK    WN0023  1        Operation Facto
     C                     MOVEL*BLANK    WN0024  2        U/M - Third
     C                     MOVEL*BLANK    WN0025  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0026 112       Unit Weight
     C                     MOVEL*BLANK    WN0027  1        Production Date
     C                     MOVEL*BLANK    WN0028  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0029  30       Item Structure
     C                     Z-ADD*ZERO     WN0030  30       Item Structure
     C                     Z-ADD*ZERO     WN0031  30       Item Structure
     C                     Z-ADD*ZERO     WN0032 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0033 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0034 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0035 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0036 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFW9ST           Inventory Trans
     C                     KFLD           WFBSST           Inventory Trans
     C                     KFLD           WFB4DT           Transaction Dat
     C                     KFLD           WFC4NY           ITD Sequence Nu
     C                     KFLD           WFDXNB           Sequence Number
      * Setup key
     C                     Z-ADDP1AIC3    WFAIC3           Company Number
     C                     Z-ADDP1HGCD    WFHGCD           Item Code
     C                     MOVELP1AJCD    WFAJCD           Warehouse Code
     C                     MOVELP1W9ST    WFW9ST           Inventory Trans
     C                     MOVELP1BSST    WFBSST           Inventory Trans
     C                     Z-ADDP1B4DT    WFB4DT           Transaction Dat
     C                     Z-ADDP1C4NY    WFC4NY           ITD Sequence Nu
     C                     Z-ADDP1DXNB    WFDXNB           Sequence Number
      * Establish starting position
     C           KRSSG     CHAINRB7CPJ3              90    *
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
     C                     EXSR SHRVGN
      * Rtv Quantity/Dollars   RT - IC Item Balance  * 
     C                     EXSR SIRVGN
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWFAIC3    WAAIC3           Company Number
     C                     Z-ADDWFHGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0017           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    WN0018           U/M - Primary
     C                     Z-ADD*ZERO     WN0019           Conversion Fact
     C                     MOVEL*BLANK    WN0020           Operation Facto
     C                     MOVEL*BLANK    WN0021           U/M - Second
     C                     Z-ADD*ZERO     WN0022           Conversion Fact
     C                     MOVEL*BLANK    WN0023           Operation Facto
     C                     MOVEL*BLANK    WN0024           U/M - Third
     C                     MOVEL*BLANK    WUAICD           U/M - Pricing
     C                     Z-ADD*ZERO     WN0026           Unit Weight
     C                     MOVEL*BLANK    WN0027           Production Date
     C                     MOVEL*BLANK    WN0028           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WN0017           Description Lin
     C                     MOVELWAAWNA    WUAWNA           Description Lin
     C                     MOVELWAADCD    WN0018           U/M - Primary
     C                     Z-ADDWAAWPC    WN0019           Conversion Fact
     C                     MOVELWALXST    WN0020           Operation Facto
     C                     MOVELWAAECD    WN0021           U/M - Second
     C                     Z-ADDWAAXPC    WN0022           Conversion Fact
     C                     MOVELWALYST    WN0023           Operation Facto
     C                     MOVELWAAFCD    WN0024           U/M - Third
     C                     MOVELWAAICD    WUAICD           U/M - Pricing
     C                     Z-ADDWAAIWG    WN0026           Unit Weight
     C                     MOVELWAFZST    WN0027           Production Date
     C                     MOVELWAAVST    WN0028           Catch Weight St
     C                     Z-ADDWACHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWFAIC3    WBAIC3           Company Number
     C                     Z-ADDWFHGCD    WBHGCD           Item Code
     C                     MOVELWFAJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0036           Unit Cost Per P
     C                     Z-ADD*ZERO     WN0032           On Hand Weight
     C                     Z-ADD*ZERO     WN0033           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0034           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0035           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WUIDVA           Value of On Han
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    WN0036           Unit Cost Per P
     C                     Z-ADDWBBOWG    WN0032           On Hand Weight
     C                     Z-ADDWBDDQT    WN0033           On Hand U/M1 Su
     C                     Z-ADDWBDEQT    WN0034           On Hand U/M2 Su
     C                     Z-ADDWBDFQT    WN0035           On Hand U/M3 Su
     C                     Z-ADDWBIDVA    WUIDVA           Value of On Han
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0037 112       Quantity based
     C                     Z-ADD*ZERO     WN0038 112       Quantity based
     C                     Z-ADD*ZERO     WN0039 112       Quantity based
     C                     Z-ADD*ZERO     WN0040 114       Cost based on U
     C                     Z-ADD*ZERO     WN0041 114       Cost based on U
     C                     Z-ADD*ZERO     WN0042 114       Cost based on U
     C                     Z-ADD*ZERO     WN0043 112       Quantity Total
     C                     Z-ADD*ZERO     WN0044 112       Quantity Total
     C                     Z-ADD*ZERO     WN0045 112       Cost Replace Do
     C                     Z-ADD*ZERO     WN0046 112       USR Allocated P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      *
     C                     Z-ADD*ZERO     WN0047 114       Cost based on U
     C                     Z-ADD*ZERO     WN0048 114       Cost based on U
     C                     Z-ADD*ZERO     WN0049 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0040           Cost based on U
     C                     Z-ADD*ZERO     WN0041           Cost based on U
     C                     Z-ADD*ZERO     WN0042           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0018    IFEQ WFCGCD                     *IF
     C                     Z-ADDWN0036    WN0040           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0021    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0020    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0019    IFNE *ZERO                      *IF
     C           WN0036    DIV  WN0019    WN0048    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0020    IFEQ 'D'                        *IF
     C           WN0036    MULT WN0019    WN0048    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0048    WN0041           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0024    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0023    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0022    IFNE *ZERO                      *IF
     C           WN0048    DIV  WN0022    WN0042    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0023    IFEQ 'D'                        *IF
     C           WN0048    MULT WN0022    WN0042    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0021    IFEQ WFCGCD                     *IF
     C                     Z-ADDWN0036    WN0041           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0020    IFEQ 'M'                        *IF
     C           WN0036    MULT WN0019    WN0040    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0020    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0019    IFNE *ZERO                      *IF
     C           WN0036    DIV  WN0019    WN0040    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0024    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0023    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0022    IFNE *ZERO                      *IF
     C           WN0036    DIV  WN0022    WN0042    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0023    IFEQ 'D'                        *IF
     C           WN0036    MULT WN0022    WN0042    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0024    IFEQ WFCGCD                     *IF
     C                     Z-ADDWN0036    WN0042           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0023    IFEQ 'M'                        *IF
     C           WN0036    MULT WN0022    WN0048    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0023    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0022    IFNE *ZERO                      *IF
     C           WN0036    DIV  WN0022    WN0048    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0048    WN0041           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0020    IFEQ 'M'                        *IF
     C           WN0048    MULT WN0019    WN0040    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0020    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0019    IFNE *ZERO                      *IF
     C           WN0048    DIV  WN0019    WN0040    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0050 112       Quantity based
     C                     Z-ADD*ZERO     WN0051 112       Quantity based
     C                     Z-ADD*ZERO     WN0052 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0037           USR Qty based o
     C                     Z-ADD*ZERO     WN0038           USR Qty based o
     C                     Z-ADD*ZERO     WN0039           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0018    IFEQ WFHVCD                     *IF
     C                     Z-ADDWFA5QT    WN0037           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0021    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0020    IFEQ 'M'                        *IF
     C           WFA5QT    MULT WN0019    WN0051    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0020    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0019    IFNE *ZERO                      *IF
     C           WFA5QT    DIV  WN0019    WN0051    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0051    WN0038           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0024    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0023    IFEQ 'M'                        *IF
     C           WN0051    MULT WN0022    WN0052    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0023    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0022    IFNE *ZERO                      *IF
     C           WN0051    DIV  WN0022    WN0052    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0052    WN0039           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0021    IFEQ WFHVCD                     *IF
     C                     Z-ADDWFA5QT    WN0038           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0020    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0019    IFNE *ZERO                      *IF
     C           WFA5QT    DIV  WN0019    WN0037    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0020    IFEQ 'D'                        *IF
     C           WFA5QT    MULT WN0019    WN0037    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0024    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0023    IFEQ 'M'                        *IF
     C           WFA5QT    MULT WN0022    WN0052    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0023    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0022    IFNE *ZERO                      *IF
     C           WFA5QT    DIV  WN0022    WN0052    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0052    WN0039           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0024    IFEQ WFHVCD                     *IF
     C                     Z-ADDWFA5QT    WN0039           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0023    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0022    IFNE *ZERO                      *IF
     C           WFA5QT    DIV  WN0022    WN0051    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0023    IFEQ 'D'                        *IF
     C           WFA5QT    MULT WN0022    WN0051    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0051    WN0038           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0020    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0019    IFNE *ZERO                      *IF
     C           WN0051    DIV  WN0019    WN0037    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0020    IFEQ 'D'                        *IF
     C           WN0051    MULT WN0019    WN0037    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWFAIC3    WCAIC3           Company Number
     C                     Z-ADDWFHGCD    WCHGCD           Item Code
     C                     MOVELWFAJCD    WCAJCD    P      Warehouse Code
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C           KLCHSJ    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
      * Update IC Item Balance Detail
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
     C                     EXSR SKRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
     C                     EXSR SPRVGN
     C                     Z-ADD*ZERO     WCDOQT           Available Prima
      * Available Primary U/M
     C           WCDDQT    SUB  WCAJQT    WCDOQT           Available Prima
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WCAATM' defaulted for 'Job Time'.
      * Field '(DB1) WCAYNA' defaulted for 'User Id'.
      * Field '(DB1) WCA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WCAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0053 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0054 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0055 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0056 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0057 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0058 114       Last Cost
     C                     Z-ADD*ZERO     WN0059 112       Value of On Han
     C                     MOVEL*BLANK    WN0060  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Setup key
     C                     Z-ADDWCAIC3    WGAIC3           Company Number
     C                     Z-ADDWCHGCD    WGHGCD           Item Code
     C                     MOVELWCAJCD    WGAJCD           Warehouse Code
     C                     Z-ADDWFELDT    WGELDT           Production Date
      * Establish starting position
     C           KRSSK     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
     C           WN0037    IFEQ WUW0NB                     *IF
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCHGCD    WL0002           Item Code
     C                     MOVELWCAJCD    WL0003    P      Warehouse Code
     C                     Z-ADDWFELDT    WL0004           Production Date
     C                     Z-ADD*ZERO     WL0005           Physical Count
     C                     Z-ADD*ZERO     WL0006           Physical Count
     C                     Z-ADD*ZERO     WL0007           Physical Count
     C                     Z-ADD*ZERO     WL0008           Physical Count
     C                     MOVEL*BLANK    WL0009           Physical Count
     C                     Z-ADD*ZERO     WL0010           Quantity on Han
     C                     Z-ADDWN0037    WL0011           Quantity on Han
     C                     Z-ADD*ZERO     WL0012           Quantity on Han
     C                     Z-ADD*ZERO     WL0013           Quantity on Han
     C                     Z-ADD*ZERO     WL0014           Quantity In Chi
     C                     Z-ADD*ZERO     WL0015           Weight In Chill
     C                     MOVEL'N'       WL0016    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0017           Physical Start
     C                     Z-ADD*ZERO     WL0018           Physical Start
     C                     Z-ADD*ZERO     WL0019           Physical Start
     C                     Z-ADD*ZERO     WL0020           Physical Start
     C                     Z-ADD*ZERO     WL0021           Physical Start
     C                     Z-ADD*ZERO     WL0022           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0023           Last Cost
     C                     Z-ADD*ZERO     WL0024           Value of On Han
     C                     Z-ADDWFK7DT    WL0025           Label Date
     C                     Z-ADDWCRINB    WL0026           Item Structure
     C                     Z-ADDWCRHNB    WL0027           Item Structure
     C                     Z-ADDWCRGNB    WL0028           Item Structure
     C                     MOVEL*BLANK    WL0029           EDI Status 1
     C                     MOVEL*BLANK    WL0030           EDI Status 2
     C                     MOVEL*BLANK    WL0031           EDI Status 3
     C                     MOVEL'A'       WL0032    P      Record Status
     C                     EXSR SLCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCHGCD    WL0002           Item Code
     C                     MOVELWCAJCD    WL0003    P      Warehouse Code
     C                     Z-ADDWFELDT    WL0004           Production Date
     C                     Z-ADD*ZERO     WL0005           Physical Count
     C                     Z-ADD*ZERO     WL0006           Physical Count
     C                     Z-ADD*ZERO     WL0007           Physical Count
     C                     Z-ADD*ZERO     WL0008           Physical Count
     C                     MOVEL*BLANK    WL0009           Physical Count
     C                     Z-ADDWFAHWG    WL0010           Quantity on Han
     C                     Z-ADDWN0037    WL0011           Quantity on Han
     C                     Z-ADD*ZERO     WL0012           Quantity on Han
     C                     Z-ADD*ZERO     WL0013           Quantity on Han
     C                     Z-ADD*ZERO     WL0014           Quantity In Chi
     C                     Z-ADD*ZERO     WL0015           Weight In Chill
     C                     MOVEL'N'       WL0016    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0017           Physical Start
     C                     Z-ADD*ZERO     WL0018           Physical Start
     C                     Z-ADD*ZERO     WL0019           Physical Start
     C                     Z-ADD*ZERO     WL0020           Physical Start
     C                     Z-ADD*ZERO     WL0021           Physical Start
     C                     Z-ADD*ZERO     WL0022           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0023           Last Cost
     C                     Z-ADDWFAYVA    WL0024           Value of On Han
     C                     Z-ADDWFK7DT    WL0025           Label Date
     C                     Z-ADDWCRINB    WL0026           Item Structure
     C                     Z-ADDWCRHNB    WL0027           Item Structure
     C                     Z-ADDWCRGNB    WL0028           Item Structure
     C                     MOVEL*BLANK    WL0029           EDI Status 1
     C                     MOVEL*BLANK    WL0030           EDI Status 2
     C                     MOVEL*BLANK    WL0031           EDI Status 3
     C                     MOVEL'A'       WL0032    P      Record Status
     C                     EXSR SLCRRC
     C                     END                             *FI
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cash
     C           WFBSST    IFEQ 'AC'                       *IF
     C           WGIDVA    ADD  WFAYVA    WN0059           Value of On Han
     C                     ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C           WFBSST    IFEQ 'R'                        *IF
     C           WFBSST    OREQ 'RP'
     C           WFBSST    OREQ 'S'
     C           WFBSST    OREQ 'TW'
     C           WFBSST    OREQ 'RW'
     C           WFBSST    OREQ 'RR'
     C           WGIDVA    ADD  WFAYVA    WN0059           Value of On Han
     C                     END                             *FI
     C                     END                             *FI
     C           WFAHWG    ADD  WGACWG    WN0053           Quantity on Han
     C           WGARQT    ADD  WN0037    WN0054           Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WN0054    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0044  30       Company Number
     C                     PARM WGHGCD    WQ0045  70       Item Code
     C                     PARM WGAJCD    WQ0046  3        Warehouse Code
     C                     PARM WFB4DT    WQ0047  70       Transaction Dat
     C                     PARM WGELDT    WQ0048  70       Production Date
     C                     PARM WFHVCD    WQ0049  2        U/M - Transacti
     C                     PARM WN0053    WQ0050 112       Transaction Wei
     C                     PARM WN0057    WQ0051 114       USR Transaction
     C                     PARM WFCGCD    WQ0052  2        U/M - Cost
     C                     PARM WGRINB    WQ0053  30       Item Structure
     C                     PARM WGRHNB    WQ0054  30       Item Structure
     C                     PARM WGRGNB    WQ0055  30       Item Structure
     C                     PARM P1XLCD    WQ0056  1        Shift Number
     C                     PARM WGK7DT    WQ0057  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0053           Quantity on Han
     C                     Z-ADD*ZERO     WN0059           Value of On Han
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SMRVGN
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0054    IFEQ WUW0NB                     *IF
     C           WGELDT    IFNE WUW0NB                     *IF
     C           WN0060    IFEQ *BLANK                     *IF
     C           WN0060    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
     C                     EXSR SNDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0061  60       Job Time
     C                     MOVEL*BLANK    WN0062 10        User Id
     C                     MOVEL*BLANK    WN0063 10        Job Name
     C                     Z-ADD*ZERO     WN0064  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0001    WHAIC3           Company Number
     C                     Z-ADDWL0002    WHHGCD           Item Code
     C                     MOVELWL0003    WHAJCD           Warehouse Code
     C                     Z-ADDWL0004    WHELDT           Production Date
     C                     Z-ADDWL0005    WHABWG           Physical Count
     C                     Z-ADDWL0006    WHAGQT           Physical Count
     C                     Z-ADDWL0007    WHAHQT           Physical Count
     C                     Z-ADDWL0008    WHAIQT           Physical Count
     C                     MOVELWL0009    WHCTST           Physical Count
     C                     Z-ADDWL0010    WHACWG           Quantity on Han
     C                     Z-ADDWL0011    WHARQT           Quantity on Han
     C                     Z-ADDWL0012    WHASQT           Quantity on Han
     C                     Z-ADDWL0013    WHATQT           Quantity on Han
     C                     Z-ADDWL0014    WHHDQT           Quantity In Chi
     C                     Z-ADDWL0015    WHHEQT           Weight In Chill
     C                     MOVELWL0016    WHF6ST           Update Exceptio
     C                     Z-ADDWL0017    WHBMWG           Physical Start
     C                     Z-ADDWL0018    WHDSQT           Physical Start
     C                     Z-ADDWL0019    WHDTQT           Physical Start
     C                     Z-ADDWL0020    WHDUQT           Physical Start
     C                     Z-ADDWL0021    WHDHDT           Physical Start
     C                     Z-ADDWL0022    WHAGCS           Unit Cost Per P
     C                     Z-ADDWL0023    WHAECS           Last Cost
     C                     Z-ADDWL0024    WHIDVA           Value of On Han
     C                     Z-ADDWL0025    WHK7DT           Label Date
     C                     Z-ADDWL0026    WHRINB           Item Structure
     C                     Z-ADDWL0027    WHRHNB           Item Structure
     C                     Z-ADDWL0028    WHRGNB           Item Structure
     C                     MOVELWL0029    WHUVST           EDI Status 1
     C                     MOVELWL0030    WHUWST           EDI Status 2
     C                     MOVELWL0031    WHUXST           EDI Status 3
     C                     MOVELWL0032    WHVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSL    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSL    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0060           Lot Tracking Fl
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIVHST    WN0060           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNDLRC    BEGSR
      *================================================================
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGHGCD    WHHGCD           Item Code
     C                     MOVELWGAJCD    WHAJCD           Warehouse Code
     C                     Z-ADDWGELDT    WHELDT           Production Date
      *
     C           KLDLSN    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLDLSN    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0065  70       Label Date
     C                     MOVEL*BLANK    WN0066  1        EDI Status 1
     C                     MOVEL*BLANK    WN0067  1        EDI Status 2
     C                     MOVEL*BLANK    WN0068  1        EDI Status 3
     C                     MOVEL*BLANK    WN0069  1        Record Status
     C                     Z-ADD*ZERO     WN0070  60       Job Time
     C                     MOVEL*BLANK    WN0071 10        User Id
     C                     MOVEL*BLANK    WN0072 10        Job Name
     C                     Z-ADD*ZERO     WN0073  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGHGCD    WHHGCD           Item Code
     C                     MOVELWGAJCD    WHAJCD    P      Warehouse Code
     C                     Z-ADDWGELDT    WHELDT           Production Date
      *
     C           KLCHSO    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLCHSO    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YBRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWGABWG    WHABWG           Physical Count
     C                     Z-ADDWGAGQT    WHAGQT           Physical Count
     C                     Z-ADDWGAHQT    WHAHQT           Physical Count
     C                     Z-ADDWGAIQT    WHAIQT           Physical Count
     C                     MOVELWGCTST    WHCTST    P      Physical Count
     C                     Z-ADDWN0053    WHACWG           Quantity on Han
     C                     Z-ADDWN0054    WHARQT           Quantity on Han
     C                     Z-ADDWGASQT    WHASQT           Quantity on Han
     C                     Z-ADDWGATQT    WHATQT           Quantity on Han
     C                     Z-ADDWGHDQT    WHHDQT           Quantity In Chi
     C                     Z-ADDWGHEQT    WHHEQT           Weight In Chill
     C                     MOVELWGF6ST    WHF6ST    P      Update Exceptio
     C                     Z-ADDWGBMWG    WHBMWG           Physical Start
     C                     Z-ADDWGDSQT    WHDSQT           Physical Start
     C                     Z-ADDWGDTQT    WHDTQT           Physical Start
     C                     Z-ADDWGDUQT    WHDUQT           Physical Start
     C                     Z-ADDWGDHDT    WHDHDT           Physical Start
     C                     Z-ADDWGAGCS    WHAGCS           Unit Cost Per P
     C                     Z-ADDWGAECS    WHAECS           Last Cost
     C                     Z-ADDWN0059    WHIDVA           Value of On Han
     C                     Z-ADDWGRINB    WHRINB           Item Structure
     C                     Z-ADDWGRHNB    WHRHNB           Item Structure
     C                     Z-ADDWGRGNB    WHRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C                     MOVEL##PGM     WHA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WCBOWG           Quantity on Han
     C                     Z-ADD*ZERO     WCDDQT           Quantity on Han
     C                     Z-ADD*ZERO     WUNFNN           Quantity on Han
     C                     Z-ADD*ZERO     WUNFNN           Quantity on Han
     C                     Z-ADD*ZERO     WCIDVA           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSP02           Item Code
     C           *LIKE     DEFN WJAJCD    WQSP03           Warehouse Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Item Code
     C                     KFLD           WQSP03           Warehouse Code
      * Setup key
     C                     Z-ADDWCAIC3    WQSP01           Company Number
     C                     Z-ADDWCHGCD    WQSP02           Item Code
     C                     MOVELWCAJCD    WQSP03           Warehouse Code
      * Establish starting position
     C           KRSSP     SETLLCAB1RL4                    *
     C           KRSSP     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WJACWG    WCBOWG           Quantity on Han
     C                     ADD  WJARQT    WCDDQT           Quantity on Han
     C                     ADD  WJASQT    WUNFNN           Quantity on Han
     C                     ADD  WJATQT    WUNFNN           Quantity on Han
     C                     ADD  WJIDVA    WCIDVA           Value of On Han
     C           KRSSP     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1C4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     P1DXNB           Sequence Number
     C                     Z-ADD*ZERO     P1AKCS           USR Transaction
     C                     Z-ADD*ZERO     P1AYVA           Extended Amount
     C                     MOVEL*BLANK    P2ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           U/M - Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           U/M - Third
     C                     MOVEL*BLANK    P2AICD           U/M - Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     Z-ADD*ZERO     P2RINB           Item Structure
     C                     Z-ADD*ZERO     P2RHNB           Item Structure
     C                     Z-ADD*ZERO     P2RGNB           Item Structure
     C                     MOVEL*BLANK    P2LNCD           Default Commod
     C                     MOVEL*BLANK    P2Q8CD           Price Method De
     C                     Z-ADD*ZERO     P3AGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     P3CBPR           Revaluation Cos
     C                     Z-ADD*ZERO     P4ANCS           Cost based on U
     C                     Z-ADD*ZERO     P4AOCS           Cost based on U
     C                     Z-ADD*ZERO     P4APCS           Cost based on U
     C                     MOVEL*BLANK    P5O9CD           USR Reason Code
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WAILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           PM Lot Size
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Cost Update Pending
     C                     MOVEL*BLANK    WUJ9ST  1
      * Define work field Post G/L Status
     C                     MOVEL*BLANK    WUKBST  1
      * Define work field Vendor - Item/Whse Deflt.
     C                     Z-ADD*ZERO     WUAKC8  80
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBBACS           Cost per Primar
     C                     Z-ADD*ZERO     WBBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WBCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WBGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WBCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WBG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WBBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WBDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WBDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WBDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WBAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WBEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WBDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WBAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WBANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WBDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WBDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WBBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WBDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WBBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WBDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WBDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WBBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WBDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WBDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WBDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WBDMDT           Last Physical C
     C                     Z-ADD*ZERO     WBAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Pricing Date Used
     C                     Z-ADD*ZERO     WUGIDT  70
      * Define work field Cost per Primary U/M
     C                     Z-ADD*ZERO     WUBACS 114
      * Define work field Price Status
     C                     MOVEL*BLANK    WUU1ST  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Clear all neither parameters
      * Crt Item Balance       CR - IC Item Balance  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WDC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WDDXNB           Sequence Number
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WDAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WDAKCS           USR Transaction
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WDTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WDTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDAWTM           Production Time
     C                     Z-ADD*ZERO     WDK7DT           Label Date
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     WUIDVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WIBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SLCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 112
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     Z-ADD*ZERO     WL0012 112
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014 112
     C                     Z-ADD*ZERO     WL0015 112
     C                     MOVEL*BLANK    WL0016  1
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 112
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022 114
     C                     Z-ADD*ZERO     WL0023 114
     C                     Z-ADD*ZERO     WL0024 112
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  30
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
      *================================================================
     CSR         ZZEXIT    ENDSR
