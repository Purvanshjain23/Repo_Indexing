     H/TITLE BLD Claims by Customer XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 01/26/06  Time  : 15:05:38
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FPDMOCPL1IF  E           K        DISK
      * RTV : A/R Claim Product         Retrieval index
      *
     FPDMVCPL0IF  E           K        DISK                      A
      * UPD : WF A/R Claim/Item Rpts    Update index
      *
     I@MKCPWB
      * A/R Claim                 Retrieval index
      * Renamed input format fields
     I              MKC0C7                          WAC0C7
     I              MKZLCD                          WAZLCD
     I              MKBIC3                          WABIC3
     I              MKALNX                          WAALNX
     I              MKRMNB                          WARMNB
     I              MKC3C7                          WAC3C7
     I              MKRFTX                          WARFTX
     I              MKCHSX                          WACHSX
     I              MKCJSX                          WACJSX
     I              MKAYVL                          WAAYVL
     I              MKAZVL                          WAAZVL
     I              MKA0VL                          WAA0VL
     I              MKPQTX                          WAPQTX
     I              MKCNSX                          WACNSX
     I              MKPLTX                          WAPLTX
     I              MKCOSX                          WACOSX
     I              MKPMTX                          WAPMTX
     I              MKCPSX                          WACPSX
     I              MKA1VL                          WAA1VL
     I              MKPNTX                          WAPNTX
     I              MKPOTX                          WAPOTX
     I              MKMLDT                          WAMLDT
     I              MKEJDT                          WAEJDT
     I              MKCQSX                          WACQSX
     I              MKPPTX                          WAPPTX
     I              MKMMDT                          WAMMDT
     I              MKMNDT                          WAMNDT
     I              MKBGTM                          WABGTM
     I              MKCGVN                          WACGVN
     I              MKC4C7                          WAC4C7
     I              MKO2NA                          WAO2NA
     I              MKNFDT                          WANFDT
     I              MKBJTM                          WABJTM
     I              MKCQVN                          WACQVN
     I              MKMODT                          WAMODT
     I              MKBHTM                          WABHTM
     I              MKCHVN                          WACHVN
     I              MKCRSX                          WACRSX
     I              MKMPDT                          WAMPDT
     I              MKBITM                          WABITM
     I              MKCIVN                          WACIVN
     I              MKTBTX                          WATBTX
     I              MKEOVL                          WAEOVL
     I              MKEPVL                          WAEPVL
     I              MKP6DT                          WAP6DT
     I              MKCRTM                          WACRTM
     I              MKYSNX                          WAYSNX
     I              MKT5SX                          WAT5SX
     I              MKF7PC                          WAF7PC
     I              MKF8PC                          WAF8PC
     I              MKF9PC                          WAF9PC
     I              MKEQVL                          WAEQVL
     I              MKERVL                          WAERVL
     I              MKESVL                          WAESVL
     I              MKETVL                          WAETVL
     I              MKT7SX                          WAT7SX
     I              MKT8SX                          WAT8SX
     I              MKT9SX                          WAT9SX
     I              MKUASX                          WAUASX
     I              MKUBSX                          WAUBSX
     I              MKGAPC                          WAGAPC
     I              MKGBPC                          WAGBPC
     I              MKVSST                          WAVSST
     I              MKMJDT                          WAMJDT
     I              MKBETM                          WABETM
     I              MKCCVN                          WACCVN
     I              MKCDVN                          WACDVN
     I              MKMKDT                          WAMKDT
     I              MKBFTM                          WABFTM
     I              MKCEVN                          WACEVN
     I              MKCFVN                          WACFVN
      *
     I@MOCPWK
      * A/R Claim Product         Retrieval index
      * Renamed input format fields
     I              MOC0C7                          WBC0C7
     I              MOAFNX                          WBAFNX
     I              MOBIC3                          WBBIC3
     I              MOC1C7                          WBC1C7
     I              MOCQCD                          WBCQCD
     I              MOHHCD                          WBHHCD
     I              MOCISX                          WBCISX
     I              MOFUAA                          WBFUAA
     I              MODPNB                          WBDPNB
     I              MOUENB                          WBUENB
     I              MOKUQT                          WBKUQT
     I              MOHHWG                          WBHHWG
     I              MODIPR                          WBDIPR
     I              MOBNVL                          WBBNVL
     I              MOF0SX                          WBF0SX
     I              MOF1SX                          WBF1SX
     I              MOF2SX                          WBF2SX
     I              MOFXPR                          WBFXPR
     I              MOAMST                          WBAMST
     I              MOANST                          WBANST
     I              MOVAST                          WBVAST
     I              MOTNSX                          WBTNSX
     I              MOALNX                          WBALNX
     I              MORMNB                          WBRMNB
     I              MOYTNX                          WBYTNX
     I              MON0CD                          WBN0CD
     I              MOQYSX                          WBQYSX
     I              MOQZSX                          WBQZSX
     I              MOQ0SX                          WBQ0SX
     I              MOUCSX                          WBUCSX
     I              MOUDSX                          WBUDSX
     I              MOUESX                          WBUESX
     I              MOFYPR                          WBFYPR
     I              MOFZPR                          WBFZPR
     I              MOF0PR                          WBF0PR
     I              MOF1PR                          WBF1PR
     I              MOF2PR                          WBF2PR
     I              MOEUVL                          WBEUVL
     I              MOEVVL                          WBEVVL
     I              MOEWVL                          WBEWVL
     I              MOEXVL                          WBEXVL
     I              MOEYVL                          WBEYVL
     I              MOVSST                          WBVSST
     I              MOMJDT                          WBMJDT
     I              MOBETM                          WBBETM
     I              MOCCVN                          WBCCVN
     I              MOCDVN                          WBCDVN
     I              MOMKDT                          WBMKDT
     I              MOBFTM                          WBBFTM
     I              MOCEVN                          WBCEVN
     I              MOCFVN                          WBCFVN
      *
     I@MVCPXQ
      * WF A/R Claim/Item Rpts    Update index
      * Renamed input format fields
     I              MVC0C7                          WCC0C7
     I              MVAFNX                          WCAFNX
     I              MVBJC3                          WCBJC3
     I              MVC1C7                          WCC1C7
     I              MVCQCD                          WCCQCD
     I              MVHHCD                          WCHHCD
     I              MVCISX                          WCCISX
     I              MVFUAA                          WCFUAA
     I              MVDPNB                          WCDPNB
     I              MVUENB                          WCUENB
     I              MVKUQT                          WCKUQT
     I              MVHHWG                          WCHHWG
     I              MVDIPR                          WCDIPR
     I              MVBNVL                          WCBNVL
     I              MVZLCD                          WCZLCD
     I              MVBIC3                          WCBIC3
     I              MVALNX                          WCALNX
     I              MVC3C7                          WCC3C7
     I              MVRFTX                          WCRFTX
     I              MVCHSX                          WCCHSX
     I              MVCJSX                          WCCJSX
     I              MVAYVL                          WCAYVL
     I              MVAZVL                          WCAZVL
     I              MVA0VL                          WCA0VL
     I              MVPQTX                          WCPQTX
     I              MVCNSX                          WCCNSX
     I              MVPLTX                          WCPLTX
     I              MVCOSX                          WCCOSX
     I              MVPMTX                          WCPMTX
     I              MVCPSX                          WCCPSX
     I              MVA1VL                          WCA1VL
     I              MVPNTX                          WCPNTX
     I              MVPOTX                          WCPOTX
     I              MVMLDT                          WCMLDT
     I              MVEJDT                          WCEJDT
     I              MVCQSX                          WCCQSX
     I              MVPPTX                          WCPPTX
     I              MVMMDT                          WCMMDT
     I              MVMNDT                          WCMNDT
     I              MVBGTM                          WCBGTM
     I              MVCGVN                          WCCGVN
     I              MVC4C7                          WCC4C7
     I              MVO2NA                          WCO2NA
     I              MVNFDT                          WCNFDT
     I              MVBJTM                          WCBJTM
     I              MVCQVN                          WCCQVN
     I              MVMODT                          WCMODT
     I              MVBHTM                          WCBHTM
     I              MVCHVN                          WCCHVN
     I              MVCRSX                          WCCRSX
     I              MVMPDT                          WCMPDT
     I              MVBITM                          WCBITM
     I              MVCIVN                          WCCIVN
     I              MVP6DT                          WCP6DT
     I              MVCRTM                          WCCRTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDMV1    E DSPDMVCPL0
      * UPD : WF A/R Claim/Item Rpts    Update index
      * Renamed input format fields
     I              MVC0C7                          WCC0C7
     I              MVAFNX                          WCAFNX
     I              MVBJC3                          WCBJC3
     I              MVC1C7                          WCC1C7
     I              MVCQCD                          WCCQCD
     I              MVHHCD                          WCHHCD
     I              MVCISX                          WCCISX
     I              MVFUAA                          WCFUAA
     I              MVDPNB                          WCDPNB
     I              MVUENB                          WCUENB
     I              MVKUQT                          WCKUQT
     I              MVHHWG                          WCHHWG
     I              MVDIPR                          WCDIPR
     I              MVBNVL                          WCBNVL
     I              MVZLCD                          WCZLCD
     I              MVBIC3                          WCBIC3
     I              MVALNX                          WCALNX
     I              MVC3C7                          WCC3C7
     I              MVRFTX                          WCRFTX
     I              MVCHSX                          WCCHSX
     I              MVCJSX                          WCCJSX
     I              MVAYVL                          WCAYVL
     I              MVAZVL                          WCAZVL
     I              MVA0VL                          WCA0VL
     I              MVPQTX                          WCPQTX
     I              MVCNSX                          WCCNSX
     I              MVPLTX                          WCPLTX
     I              MVCOSX                          WCCOSX
     I              MVPMTX                          WCPMTX
     I              MVCPSX                          WCCPSX
     I              MVA1VL                          WCA1VL
     I              MVPNTX                          WCPNTX
     I              MVPOTX                          WCPOTX
     I              MVMLDT                          WCMLDT
     I              MVEJDT                          WCEJDT
     I              MVCQSX                          WCCQSX
     I              MVPPTX                          WCPPTX
     I              MVMMDT                          WCMMDT
     I              MVMNDT                          WCMNDT
     I              MVBGTM                          WCBGTM
     I              MVCGVN                          WCCGVN
     I              MVC4C7                          WCC4C7
     I              MVO2NA                          WCO2NA
     I              MVNFDT                          WCNFDT
     I              MVBJTM                          WCBJTM
     I              MVCQVN                          WCCQVN
     I              MVMODT                          WCMODT
     I              MVBHTM                          WCBHTM
     I              MVCHVN                          WCCHVN
     I              MVCRSX                          WCCRSX
     I              MVMPDT                          WCMPDT
     I              MVBITM                          WCBITM
     I              MVCIVN                          WCCIVN
     I              MVP6DT                          WCP6DT
     I              MVCRTM                          WCCRTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Reason Code
     I                                        1   3 P1CQCD
      * I :  Claim Status
     I                                        4   4 P1CJSX
      * I :  Salesperson to Rvw Claim
     I                                        5   7 P1ZLCD
      * I :  Claim Item Code
     I                                    P   8  110P1C1C7
      * I :  Claim Ship to Customer
     I                                    P  12  150P1C3C7
      * I :  Claim Item Company Number
     I                                    P  16  170P1BJC3
      * I :  Claim Start Number
     I                                    P  18  210P1DFC7
      * I :  Claim End Number
     I                                    P  22  250P1DGC7
      * I :  Claim Start Entry Date
     I                                    P  26  290P1NBDT
      * I :  Claim End Entry Date
     I                                    P  30  330P1NCDT
      * I :  Memo Posting Str Date Usr
     I                                    P  34  370P1QBDT
      * I :  Memo Posting End Date Usr
     I                                    P  38  410P1QCDT
     IP2PARM      DS
      * N :  Actual Shipped Date
     I                                    P   1   40P2GNDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1CQCD    PARM           WP0001  3        Reason Code
     C           P1CJSX    PARM           WP0002  1        Claim Status
     C           P1ZLCD    PARM           WP0003  3        Salesperson to
     C           P1C1C7    PARM           WP0004  70       Claim Item Code
     C           P1C3C7    PARM           WP0005  70       Claim Ship to C
     C           P1BJC3    PARM           WP0006  30       Claim Item Comp
     C           P1DFC7    PARM           WP0007  70       Claim Start Num
     C           P1DGC7    PARM           WP0008  70       Claim End Numbe
     C           P1NBDT    PARM           WP0009  70       Claim Start Ent
     C           P1NCDT    PARM           WP0010  70       Claim End Entry
     C           P1QBDT    PARM           WP0011  70       Memo Posting St
     C           P1QCDT    PARM           WP0012  70       Memo Posting En
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BLD Claims by Customer XF
      * 012606 LJB Added Select by Company Number to create work file fun
      * 051705 slm Allow department instead of responsibility department
      * 051705 slm Memo Posting Selection of from and to dates.
      * CRT WRKF Claims by Cst RT - A/R Claim  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CRT WRKF Claims by Cst RT - A/R Claim  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        *Record selecte
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log
      * ** 01/26/2006 LJB
      * ** Added Select by Company Number per request by Alice
      * *****
      * Establish starting position
     C           *LOVAL    SETLL@MKCPWB                    *
     C                     READ @MKCPWB                  90*
      * Data record not found
     C   90                MOVEL'USR2729' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0001           *Record selecte
      * Perform Selections.
     C                     EXSR UASUBR                     Perform Selecti
      * CASE: PAR.*Record selected is *YES
     C           WN0001    IFEQ 'Y'                        *IF
      * CRT WRKF Claims by Cst RT - A/R Claim Product  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C                     READ @MKCPWB                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * CRT WRKF Claims by Cst RT - A/R Claim Product  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  1        *Record selecte
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBC0C7    WQSB01           Claim Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Claim Number
      * Setup key
     C                     Z-ADDWAC0C7    WQSB01           Claim Number
      * Establish starting position
     C           KRSSB     SETLL@MOCPWK                    *
     C           KRSSB     READE@MOCPWK                  90*
      * Data record not found
     C   90                MOVEL'USR2737' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0002           *Record selecte
      * Perform Selections.
     C                     EXSR UISUBR                     Perform Selecti
      * CASE: PAR.*Record selected is *YES
     C           WN0002    IFEQ 'Y'                        *IF
      * CRT A/R Claim/Item Rpt CR - WF A/R Claim/Item Rpts  * 
     C                     EXSR SCCRRC
     C                     END                             *FI
     C           KRSSB     READE@MOCPWK                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * CRT A/R Claim/Item Rpt CR - WF A/R Claim/Item Rpts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @MVCPXQ
     C                     Z-ADDWBC0C7    WCC0C7           Claim Number
     C                     Z-ADDWBAFNX    WCAFNX           Claim Item Line
     C                     Z-ADDWBBIC3    WCBJC3           Claim Item Comp
     C                     Z-ADDWBC1C7    WCC1C7           Claim Item Code
     C                     MOVELWBCQCD    WCCQCD           Reason Code
     C                     MOVELWBHHCD    WCHHCD           U/M - Primary D
     C                     MOVELWBCISX    WCCISX           Responsible Dep
     C                     MOVELWBFUAA    WCFUAA           Claim Departmen
     C                     Z-ADDWBDPNB    WCDPNB           Order Sequence
     C                     Z-ADDWBUENB    WCUENB           Order Secondary
     C                     Z-ADDWBKUQT    WCKUQT           Claim Item Quan
     C                     Z-ADDWBHHWG    WCHHWG           Claim Item Weig
     C                     Z-ADDWBDIPR    WCDIPR           Claim Item Unit
     C                     Z-ADDWBBNVL    WCBNVL           Claim Item Amou
     C                     MOVELWAZLCD    WCZLCD           Salesperson to
     C                     Z-ADDWABIC3    WCBIC3           Claim Company N
     C                     Z-ADDWAALNX    WCALNX           Claim Order Num
     C                     Z-ADDWAC3C7    WCC3C7           Claim Ship to C
     C                     MOVELWARFTX    WCRFTX           Claim Customer
     C                     MOVELWACHSX    WCCHSX           Claim Type
     C                     MOVELWACJSX    WCCJSX           Claim Status
     C                     Z-ADDWAAYVL    WCAYVL           Claim Amount
     C                     Z-ADDWAAZVL    WCAZVL           Claim Net Loss
     C                     Z-ADDWAA0VL    WCA0VL           Claim Approved
     C                     MOVELWAPQTX    WCPQTX           Claim Contact N
     C                     MOVELWACNSX    WCCNSX           Product Inspect
     C                     MOVELWAPLTX    WCPLTX           Product Inspect
     C                     MOVELWACOSX    WCCOSX           Rep Inspection
     C                     MOVELWAPMTX    WCPMTX           Rep Inspection
     C                     MOVELWACPSX    WCCPSX           Lab Fee Involve
     C                     Z-ADDWAA1VL    WCA1VL           Lab Fee
     C                     MOVELWAPNTX    WCPNTX           Driver Name
     C                     MOVELWAPOTX    WCPOTX           Lab Name
     C                     Z-ADDWAMLDT    WCMLDT           Resolve Claim b
     C                     Z-ADDWAEJDT    WCEJDT           Actual Delivery
     C                     MOVELWACQSX    WCCQSX           Claim Called in
     C                     MOVELWAPPTX    WCPPTX           Claim Called in
     C                     Z-ADDWAMMDT    WCMMDT           Claim Called in
     C                     Z-ADDWAMNDT    WCMNDT           Claim Entry Dat
     C                     Z-ADDWABGTM    WCBGTM           Claim Entry Tim
     C                     MOVELWACGVN    WCCGVN           Claim Entry Use
     C                     Z-ADDWAC4C7    WCC4C7           Resale Ship to
     C                     MOVELWAO2NA    WCO2NA           Resale Purchase
     C                     Z-ADDWANFDT    WCNFDT           Sales Approved
     C                     Z-ADDWABJTM    WCBJTM           Sales Approved
     C                     MOVELWACQVN    WCCQVN           Sales Approved
     C                     Z-ADDWAMODT    WCMODT           Approved/Denied
     C                     Z-ADDWABHTM    WCBHTM           Approved/Denied
     C                     MOVELWACHVN    WCCHVN           Approved/Denied
     C                     MOVELWACRSX    WCCRSX           Memo Created
     C                     Z-ADDWAMPDT    WCMPDT           Memo Created Da
     C                     Z-ADDWABITM    WCBITM           Memo Created Ti
     C                     MOVELWACIVN    WCCIVN           Memo Created Us
     C                     Z-ADDWAP6DT    WCP6DT           Memo Post Date
     C                     Z-ADDWACRTM    WCCRTM           Memo Post Time
      *
     C           KLCRSC    KLIST
     C                     KFLD           WCC0C7           Claim Number
     C                     KFLD           WCAFNX           Claim Item Line
      * Check for duplicate primary key
     C           KLCRSC    SETLL@MVCPXQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2773' W0RTN   7
      * Send message 'WF A/R Claim/Item Rpts EX'
     C                     MOVEL'USR2773' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@MVCPXQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Perform Selections.
      *================================================================
      * Select by Company Number.          01/26/2006 LJB
     C                     EXSR UBSUBR                     Select by Compa
      * Select by Claim Number.
     C                     EXSR UCSUBR                     Select by Claim
      * Select by Entry Date.
     C                     EXSR UDSUBR                     Select by Entry
      * Select by Memo Posting date        051705 slm
     C                     EXSR UESUBR                     Select by Memo
      * Select by Customer.
     C                     EXSR UFSUBR                     Select by Custo
      * Select by Claim Status.
     C                     EXSR UGSUBR                     Select by Claim
      * Select by Salesperson.
     C                     EXSR UHSUBR                     Select by Sales
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Select by Company Number.          01/26/2006 LJB
      *================================================================
      * CASE: PAR.Claim Item Company Number is not equal to zero
     C           P1BJC3    IFNE *ZERO                      *IF
      * CASE: DB1.Claim Company Number NE PAR.Claim Item Company Number
     C           WABIC3    IFNE P1BJC3                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Select by Claim Number.
      *================================================================
      * CASE: PAR.Claim Start Number is Not Zero
     C           P1DFC7    IFNE *ZERO                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Number LT PAR.Claim Start Number
      *   |- c2    : DB1.Claim Number GT PAR.Claim End Number
      *   '-
     C           WAC0C7    IFLT P1DFC7                     *IF
     C           WAC0C7    ORGT P1DGC7                     *OR
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Select by Entry Date.
      *================================================================
      * CASE: PAR.Claim Start Entry Date is Entered
     C           P1NBDT    IFNE *ZERO                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Entry Date LT PAR.Claim Start Entry Date
      *   |- c2    : DB1.Claim Entry Date GT PAR.Claim End Entry Date
      *   '-
     C           WAMNDT    IFLT P1NBDT                     *IF
     C           WAMNDT    ORGT P1NCDT                     *OR
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Select by Memo Posting date        051705 slm
      *================================================================
      * CASE: PAR.Memo Posting Str Date Usr is Entered
     C           P1QBDT    IFNE *ZERO                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Memo Post Date LT PAR.Memo Posting Str Date Usr
      *   |- c2    : DB1.Memo Post Date GT PAR.Memo Posting End Date Usr
      *   '-
     C           WAP6DT    IFLT P1QBDT                     *IF
     C           WAP6DT    ORGT P1QCDT                     *OR
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Select by Customer.
      *================================================================
      * CASE: PAR.Claim Ship to Customer is not equal to zero
     C           P1C3C7    IFNE *ZERO                      *IF
      * CASE: DB1.Claim Ship to Customer NE PAR.Claim Ship to Customer
     C           WAC3C7    IFNE P1C3C7                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Select by Claim Status.
      *================================================================
      * CASE: PAR.Claim Status is Blank
     C           P1CJSX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Claim Status NE PAR.Claim Status
     C           WACJSX    IFNE P1CJSX                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Select by Salesperson.
      *================================================================
      * CASE: PAR.Salesperson to Rvw Claim is entered
     C           P1ZLCD    IFNE *BLANK                     *IF
      * CASE: DB1.Salesperson to Rvw Claim NE PAR.Salesperson to Rvw Clai
     C           WAZLCD    IFNE P1ZLCD                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Perform Selections.
      *================================================================
      * Select by Item Code.
     C                     EXSR UJSUBR                     Select by Item
      * Select by Reason Code.
     C                     EXSR UKSUBR                     Select by Reaso
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Select by Item Code.
      *================================================================
      * CASE: PAR.Claim Item Code is Entered
     C           P1C1C7    IFNE *ZERO                      *IF
      * CASE: DB1.Claim Item Code NE PAR.Claim Item Code
     C           WBC1C7    IFNE P1C1C7                     *IF
     C                     MOVEL'N'       WN0002           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Select by Reason Code.
      *================================================================
      * CASE: PAR.Reason Code is Entered
     C           P1CQCD    IFNE *BLANK                     *IF
      * CASE: DB1.Reason Code NE PAR.Reason Code
     C           WBCQCD    IFNE P1CQCD                     *IF
     C                     MOVEL'N'       WN0002           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2GNDT           Actual Shipped
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WABIC3           Claim Company N
     C                     Z-ADD*ZERO     WAALNX           Claim Order Num
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAC3C7           Claim Ship to C
     C                     Z-ADD*ZERO     WAAYVL           Claim Amount
     C                     Z-ADD*ZERO     WAAZVL           Claim Net Loss
     C                     Z-ADD*ZERO     WAA0VL           Claim Approved
     C                     Z-ADD*ZERO     WAA1VL           Lab Fee
     C                     Z-ADD*ZERO     WAMLDT           Resolve Claim b
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAMMDT           Claim Called in
     C                     Z-ADD*ZERO     WAMNDT           Claim Entry Dat
     C                     Z-ADD*ZERO     WABGTM           Claim Entry Tim
     C                     Z-ADD*ZERO     WAC4C7           Resale Ship to
     C                     Z-ADD*ZERO     WANFDT           Sales Approved
     C                     Z-ADD*ZERO     WABJTM           Sales Approved
     C                     Z-ADD*ZERO     WAMODT           Approved/Denied
     C                     Z-ADD*ZERO     WABHTM           Approved/Denied
     C                     Z-ADD*ZERO     WAMPDT           Memo Created Da
     C                     Z-ADD*ZERO     WABITM           Memo Created Ti
     C                     Z-ADD*ZERO     WAEOVL           Approved Net Lo
     C                     Z-ADD*ZERO     WAEPVL           Total Expense A
     C                     Z-ADD*ZERO     WAP6DT           Memo Post Date
     C                     Z-ADD*ZERO     WACRTM           Memo Post Time
     C                     Z-ADD*ZERO     WAYSNX           TFS Batch Numbe
     C                     Z-ADD*ZERO     WAF7PC           Avg TF Responsi
     C                     Z-ADD*ZERO     WAF8PC           Avg SBF Respons
     C                     Z-ADD*ZERO     WAF9PC           Unused % field
     C                     Z-ADD*ZERO     WAEQVL           AC Unused Value
     C                     Z-ADD*ZERO     WAERVL           AC Unused Value
     C                     Z-ADD*ZERO     WAESVL           AC Unused Value
     C                     Z-ADD*ZERO     WAETVL           AC Unused Value
     C                     Z-ADD*ZERO     WAGAPC           AC Unused % 1
     C                     Z-ADD*ZERO     WAGBPC           AC Unused % 2
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAFNX           Claim Item Line
     C                     Z-ADD*ZERO     WBBIC3           Claim Company N
     C                     Z-ADD*ZERO     WBC1C7           Claim Item Code
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBKUQT           Claim Item Quan
     C                     Z-ADD*ZERO     WBHHWG           Claim Item Weig
     C                     Z-ADD*ZERO     WBDIPR           Claim Item Unit
     C                     Z-ADD*ZERO     WBBNVL           Claim Item Amou
     C                     Z-ADD*ZERO     WBFXPR           Inventory Value
     C                     Z-ADD*ZERO     WBALNX           Claim Order Num
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBYTNX           Claim Memo Numb
     C                     Z-ADD*ZERO     WBFYPR           CP Unused Price
     C                     Z-ADD*ZERO     WBFZPR           CP Unused Price
     C                     Z-ADD*ZERO     WBF0PR           CP Unused Price
     C                     Z-ADD*ZERO     WBF1PR           CP Unused Price
     C                     Z-ADD*ZERO     WBF2PR           CP Unused Price
     C                     Z-ADD*ZERO     WBEUVL           CP Unused Value
     C                     Z-ADD*ZERO     WBEVVL           CP Unused Value
     C                     Z-ADD*ZERO     WBEWVL           CP Unused Value
     C                     Z-ADD*ZERO     WBEXVL           CP Unused Value
     C                     Z-ADD*ZERO     WBEYVL           CP Unused Value
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAFNX           Claim Item Line
     C                     Z-ADD*ZERO     WCBJC3           Claim Item Comp
     C                     Z-ADD*ZERO     WCC1C7           Claim Item Code
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCKUQT           Claim Item Quan
     C                     Z-ADD*ZERO     WCHHWG           Claim Item Weig
     C                     Z-ADD*ZERO     WCDIPR           Claim Item Unit
     C                     Z-ADD*ZERO     WCBNVL           Claim Item Amou
     C                     Z-ADD*ZERO     WCBIC3           Claim Company N
     C                     Z-ADD*ZERO     WCALNX           Claim Order Num
     C                     Z-ADD*ZERO     WCC3C7           Claim Ship to C
     C                     Z-ADD*ZERO     WCAYVL           Claim Amount
     C                     Z-ADD*ZERO     WCAZVL           Claim Net Loss
     C                     Z-ADD*ZERO     WCA0VL           Claim Approved
     C                     Z-ADD*ZERO     WCA1VL           Lab Fee
     C                     Z-ADD*ZERO     WCMLDT           Resolve Claim b
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCMMDT           Claim Called in
     C                     Z-ADD*ZERO     WCMNDT           Claim Entry Dat
     C                     Z-ADD*ZERO     WCBGTM           Claim Entry Tim
     C                     Z-ADD*ZERO     WCC4C7           Resale Ship to
     C                     Z-ADD*ZERO     WCNFDT           Sales Approved
     C                     Z-ADD*ZERO     WCBJTM           Sales Approved
     C                     Z-ADD*ZERO     WCMODT           Approved/Denied
     C                     Z-ADD*ZERO     WCBHTM           Approved/Denied
     C                     Z-ADD*ZERO     WCMPDT           Memo Created Da
     C                     Z-ADD*ZERO     WCBITM           Memo Created Ti
     C                     Z-ADD*ZERO     WCP6DT           Memo Post Date
     C                     Z-ADD*ZERO     WCCRTM           Memo Post Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
