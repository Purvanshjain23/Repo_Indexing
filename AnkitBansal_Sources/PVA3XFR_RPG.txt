     H/TITLE Cnv WIM Item Bal/Dtl  XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/27/24  Time  : 09:57:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAB0REL1  IF   E           K DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCABZREL1  IF   E           K DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL0  IF   E           K DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPUCGCPL0  IF A E           K DISK
      * UPD : WIM Item Balance          Update index
      *
     FPUCHCPL0  IF A E           K DISK
      * UPD : WIM Item Balance Detail   Update index
      *
      * Long constants
     D @CN#            S              6    DIM(04)CTDATA PERRCD(1)
     D @CN             S             25    DIM(04) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUCG1        E DS                  EXTNAME(PUCGCPL0)
      * UPD : WIM Item Balance          Update index
      * Renamed input format fields
     D  WCAIC3       E                     EXTFLD(CGAIC3)
     D  WCHGCD       E                     EXTFLD(CGHGCD)
     D  WCAJCD       E                     EXTFLD(CGAJCD)
     D  WCNDSC       E                     EXTFLD(CGNDSC)
     D  WCBOWG       E                     EXTFLD(CGBOWG)
     D  WCDDQT       E                     EXTFLD(CGDDQT)
     D  WCQVWG       E                     EXTFLD(CGQVWG)
     D  WCS9QT       E                     EXTFLD(CGS9QT)
     D  WCTAQT       E                     EXTFLD(CGTAQT)
     D  WCQYWG       E                     EXTFLD(CGQYWG)
     D  WCTDQT       E                     EXTFLD(CGTDQT)
     D  WCQZWG       E                     EXTFLD(CGQZWG)
     D  WCTEQT       E                     EXTFLD(CGTEQT)
     D  WCRINB       E                     EXTFLD(CGRINB)
     D  WCRHNB       E                     EXTFLD(CGRHNB)
     D  WCRGNB       E                     EXTFLD(CGRGNB)
     D  WCVSST       E                     EXTFLD(CGVSST)
     D  WCBGTS       E                     EXTFLD(CGBGTS)
     D  WCRUU1       E                     EXTFLD(CGRUU1)
     D  WCRVU1       E                     EXTFLD(CGRVU1)
     D  WCBHTS       E                     EXTFLD(CGBHTS)
     D  WCRWU1       E                     EXTFLD(CGRWU1)
     D  WCRXU1       E                     EXTFLD(CGRXU1)
      *
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XDI2T           DS
      * Internal date
     D  XDI2DT                 1     10
     D  XDI2CY                 1      4  0
     D  XDI2CC                 1      1  0
     D  XDI2YY                 2      4  0
     D  XDI2MM                 6      7  0
     D  XDI2DD                 9     10  0
     D QPUCH1        E DS                  EXTNAME(PUCHCPL0)
      * UPD : WIM Item Balance Detail   Update index
      * Renamed input format fields
     D  WEAIC3       E                     EXTFLD(CHAIC3)
     D  WEHGCD       E                     EXTFLD(CHHGCD)
     D  WEAJCD       E                     EXTFLD(CHAJCD)
     D  WENDSC       E                     EXTFLD(CHNDSC)
     D  WEELDT       E                     EXTFLD(CHELDT)
     D  WEABWG       E                     EXTFLD(CHABWG)
     D  WEAGQT       E                     EXTFLD(CHAGQT)
     D  WECTST       E                     EXTFLD(CHCTST)
     D  WEQWWG       E                     EXTFLD(CHQWWG)
     D  WETBQT       E                     EXTFLD(CHTBQT)
     D  WEQXWG       E                     EXTFLD(CHQXWG)
     D  WETCQT       E                     EXTFLD(CHTCQT)
     D  WEQ0WG       E                     EXTFLD(CHQ0WG)
     D  WETFQT       E                     EXTFLD(CHTFQT)
     D  WEQ1WG       E                     EXTFLD(CHQ1WG)
     D  WETGQT       E                     EXTFLD(CHTGQT)
     D  WEBMWG       E                     EXTFLD(CHBMWG)
     D  WEDSQT       E                     EXTFLD(CHDSQT)
     D  WEDHDT       E                     EXTFLD(CHDHDT)
     D  WEBITS       E                     EXTFLD(CHBITS)
     D  WEBGD8       E                     EXTFLD(CHBGD8)
     D  WERINB       E                     EXTFLD(CHRINB)
     D  WERHNB       E                     EXTFLD(CHRHNB)
     D  WERGNB       E                     EXTFLD(CHRGNB)
     D  WEVSST       E                     EXTFLD(CHVSST)
     D  WEBGTS       E                     EXTFLD(CHBGTS)
     D  WERUU1       E                     EXTFLD(CHRUU1)
     D  WERVU1       E                     EXTFLD(CHRVU1)
     D  WEBHTS       E                     EXTFLD(CHBHTS)
     D  WERWU1       E                     EXTFLD(CHRWU1)
     D  WERXU1       E                     EXTFLD(CHRXU1)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  YL0001         S             26
     D  YL0002         S              2
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              2
     D  YL0003         S              2
     D  WN0001         S             26
     D  WN0002         S             50
     D  WN0003         S             15
     D  WN0004         S             50
     D  WN0005         S             15
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  YL0004         S             26
     D  YL0005         S              2
     D  YL0006         S              2
     D  YL0007         S             10
     D  WN0006         S              4  0
     D  WN0007         S              2  0
     D  WN0008         S              2  0
     D  WN0009         S              4
     D  WN0010         S              2
     D  WN0011         S              2
     D  WN0012         S              2  0
     D  WN0013         S              2
     D  WN0014         S              7
     D  ZQ             S              5  0
     D  YL0008         S              4
     D  YL0009         S              5
     D  YL0010         S              3
     D  YL0011         S              5
     D  YL0012         S             26
     D  YL0013         S             26
     D  YL0014         S              7  0
     D  YL0015         S             10
     D  YL0016         S              1
     D  WN0015         S             26
     D  WN0016         S             50
     D  WN0017         S             15
     D  WN0018         S             50
     D  WN0019         S             15
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0PMT          S              1
     D                 DS
     D  ZAMSDA                 1    132
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                      WAAIC3
     I              B0HGCD                      WAHGCD
     I              B0AJCD                      WAAJCD
     I              B0AGCS                      WAAGCS
     I              B0AECS                      WAAECS
     I              B0BACS                      WABACS
     I              B0BBCS                      WABBCS
     I              B0CBPR                      WACBPR
     I              B0GUDT                      WAGUDT
     I              B0XYST                      WAXYST
     I              B0CTPR                      WACTPR
     I              B0G4DT                      WAG4DT
     I              B0BOWG                      WABOWG
     I              B0DDQT                      WADDQT
     I              B0DEQT                      WADEQT
     I              B0DFQT                      WADFQT
     I              B0HDQT                      WAHDQT
     I              B0HEQT                      WAHEQT
     I              B0AJQT                      WAAJQT
     I              B0AQQT                      WAAQQT
     I              B0AUQT                      WAAUQT
     I              B0EMQT                      WAEMQT
     I              B0DOQT                      WADOQT
     I              B0ATNA                      WAATNA
     I              B0AKDT                      WAAKDT
     I              B0ANDT                      WAANDT
     I              B0IDVA                      WAIDVA
     I              B0JVST                      WAJVST
     I              B0BZPC                      WABZPC
     I              B0DGQT                      WADGQT
     I              B0DIDT                      WADIDT
     I              B0ALCD                      WAALCD
     I              B0BFDY                      WABFDY
     I              B0DJDT                      WADJDT
     I              B0BGDY                      WABGDY
     I              B0DKDT                      WADKDT
     I              B0J2ST                      WAJ2ST
     I              B0DJQT                      WADJQT
     I              B0BNWG                      WABNWG
     I              B0DLDT                      WADLDT
     I              B0DPQT                      WADPQT
     I              B0DQQT                      WADQQT
     I              B0DMDT                      WADMDT
     I              B0M0ST                      WAM0ST
     I              B0J9ST                      WAJ9ST
     I              B0KBST                      WAKBST
     I              B0AKC8                      WAAKC8
     I              B0RINB                      WARINB
     I              B0RHNB                      WARHNB
     I              B0RGNB                      WARGNB
     I              B0UVST                      WAUVST
     I              B0UWST                      WAUWST
     I              B0UXST                      WAUXST
     I              B0VSST                      WAVSST
     I              B0AATM                      WAAATM
     I              B0AYNA                      WAAYNA
     I              B0A0NA                      WAA0NA
     I              B0AXDT                      WAAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                      WBAIC3
     I              BZHGCD                      WBHGCD
     I              BZAVNA                      WBAVNA
     I              BZAWNA                      WBAWNA
     I              BZL7NA                      WBL7NA
     I              BZL8NA                      WBL8NA
     I              BZL6NA                      WBL6NA
     I              BZMFNA                      WBMFNA
     I              BZADCD                      WBADCD
     I              BZAWPC                      WBAWPC
     I              BZLXST                      WBLXST
     I              BZAECD                      WBAECD
     I              BZAXPC                      WBAXPC
     I              BZLYST                      WBLYST
     I              BZAFCD                      WBAFCD
     I              BZAICD                      WBAICD
     I              BZAIWG                      WBAIWG
     I              BZHICD                      WBHICD
     I              BZRBCD                      WBRBCD
     I              BZFZST                      WBFZST
     I              BZAVST                      WBAVST
     I              BZCZWG                      WBCZWG
     I              BZC0WG                      WBC0WG
     I              BZURTN                      WBURTN
     I              BZAJC8                      WBAJC8
     I              BZRINB                      WBRINB
     I              BZRHNB                      WBRHNB
     I              BZRGNB                      WBRGNB
     I              BZLNCD                      WBLNCD
     I              BZTFNB                      WBTFNB
     I              BZN0CD                      WBN0CD
     I              BZX4ST                      WBX4ST
     I              BZTMVA                      WBTMVA
     I              BZTNVA                      WBTNVA
     I              BZBLPR                      WBBLPR
     I              BZBMPR                      WBBMPR
     I              BZLRCD                      WBLRCD
     I              BZU9ST                      WBU9ST
     I              BZCMCO                      WBCMCO
     I              BZQ1CD                      WBQ1CD
     I              BZQ8CD                      WBQ8CD
     I              BZCHTM                      WBCHTM
     I              BZQZCD                      WBQZCD
     I              BZXWST                      WBXWST
     I              BZXXST                      WBXXST
     I              BZVMST                      WBVMST
     I              BZSWGH                      WBSWGH
     I              BZPPHE                      WBPPHE
     I              BZR3CD                      WBR3CD
     I              BZSDCD                      WBSDCD
     I              BZICN1                      WBICN1
     I              BZSVCD                      WBSVCD
     I              BZICN2                      WBICN2
     I              BZSWCD                      WBSWCD
     I              BZV2NB                      WBV2NB
     I              BZSXCD                      WBSXCD
     I              BZITCN                      WBITCN
     I              BZSYCD                      WBSYCD
     I              BZITC5                      WBITC5
     I              BZSZCD                      WBSZCD
     I              BZICN6                      WBICN6
     I              BZS0CD                      WBS0CD
     I              BZICN7                      WBICN7
     I              BZS1CD                      WBS1CD
     I              BZICN8                      WBICN8
     I              BZS2CD                      WBS2CD
     I              BZICN9                      WBICN9
     I              BZS3CD                      WBS3CD
     I              BZICN0                      WBICN0
     I              BZS4CD                      WBS4CD
     I              BZSFNB                      WBSFNB
     I              BZA3WG                      WBA3WG
     I              BZSJNB                      WBSJNB
     I              BZLLCD                      WBLLCD
     I              BZLMCD                      WBLMCD
     I              BZP3ST                      WBP3ST
     I              BZSKNB                      WBSKNB
     I              BZSLNB                      WBSLNB
     I              BZSMNB                      WBSMNB
     I              BZP4ST                      WBP4ST
     I              BZCFNB                      WBCFNB
     I              BZCGNB                      WBCGNB
     I              BZILNB                      WBILNB
     I              BZCHNB                      WBCHNB
     I              BZCINB                      WBCINB
     I              BZCJNB                      WBCJNB
     I              BZCMNB                      WBCMNB
     I              BZCNNB                      WBCNNB
     I              BZCRNB                      WBCRNB
     I              BZCSNB                      WBCSNB
     I              BZCVNB                      WBCVNB
     I              BZCWNB                      WBCWNB
     I              BZCXNB                      WBCXNB
     I              BZCZNB                      WBCZNB
     I              BZC0NB                      WBC0NB
     I              BZN1CD                      WBN1CD
     I              BZB4NB                      WBB4NB
     I              BZB5NB                      WBB5NB
     I              BZX5ST                      WBX5ST
     I              BZX6ST                      WBX6ST
     I              BZX7ST                      WBX7ST
     I              BZPCCT                      WBPCCT
     I              BZBDNB                      WBBDNB
     I              BZBJNB                      WBBJNB
     I              BZSUST                      WBSUST
     I              BZSVST                      WBSVST
     I              BZSYST                      WBSYST
     I              BZSZST                      WBSZST
     I              BZS1ST                      WBS1ST
     I              BZXRCD                      WBXRCD
     I              BZXTCD                      WBXTCD
     I              BZXUCD                      WBXUCD
     I              BZF5WG                      WBF5WG
     I              BZF6WG                      WBF6WG
     I              BZF7WG                      WBF7WG
     I              BZBLNB                      WBBLNB
     I              BZBNNB                      WBBNNB
     I              BZS2ST                      WBS2ST
     I              BZS4ST                      WBS4ST
     I              BZS5ST                      WBS5ST
     I              BZS6ST                      WBS6ST
     I              BZS8ST                      WBS8ST
     I              BZS9ST                      WBS9ST
     I              BZTCST                      WBTCST
     I              BZTDST                      WBTDST
     I              BZUVST                      WBUVST
     I              BZUWST                      WBUWST
     I              BZUXST                      WBUXST
     I              BZVSST                      WBVSST
     I              BZAATM                      WBAATM
     I              BZAYNA                      WBAYNA
     I              BZA0NA                      WBA0NA
     I              BZAXDT                      WBAXDT
      *
     I@CGCPJ7
      * WIM Item Balance          Update index
      * Renamed input format fields
     I              CGAIC3                      WCAIC3
     I              CGHGCD                      WCHGCD
     I              CGAJCD                      WCAJCD
     I              CGNDSC                      WCNDSC
     I              CGBOWG                      WCBOWG
     I              CGDDQT                      WCDDQT
     I              CGQVWG                      WCQVWG
     I              CGS9QT                      WCS9QT
     I              CGTAQT                      WCTAQT
     I              CGQYWG                      WCQYWG
     I              CGTDQT                      WCTDQT
     I              CGQZWG                      WCQZWG
     I              CGTEQT                      WCTEQT
     I              CGRINB                      WCRINB
     I              CGRHNB                      WCRHNB
     I              CGRGNB                      WCRGNB
     I              CGVSST                      WCVSST
     I              CGBGTS                      WCBGTS
     I              CGRUU1                      WCRUU1
     I              CGRVU1                      WCRVU1
     I              CGBHTS                      WCBHTS
     I              CGRWU1                      WCRWU1
     I              CGRXU1                      WCRXU1
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                      WDAIC3
     I              B1HGCD                      WDHGCD
     I              B1AJCD                      WDAJCD
     I              B1ELDT                      WDELDT
     I              B1ABWG                      WDABWG
     I              B1AGQT                      WDAGQT
     I              B1AHQT                      WDAHQT
     I              B1AIQT                      WDAIQT
     I              B1CTST                      WDCTST
     I              B1ACWG                      WDACWG
     I              B1ARQT                      WDARQT
     I              B1ASQT                      WDASQT
     I              B1ATQT                      WDATQT
     I              B1HDQT                      WDHDQT
     I              B1HEQT                      WDHEQT
     I              B1F6ST                      WDF6ST
     I              B1BMWG                      WDBMWG
     I              B1DSQT                      WDDSQT
     I              B1DTQT                      WDDTQT
     I              B1DUQT                      WDDUQT
     I              B1DHDT                      WDDHDT
     I              B1AGCS                      WDAGCS
     I              B1AECS                      WDAECS
     I              B1IDVA                      WDIDVA
     I              B1K7DT                      WDK7DT
     I              B1RINB                      WDRINB
     I              B1RHNB                      WDRHNB
     I              B1RGNB                      WDRGNB
     I              B1UVST                      WDUVST
     I              B1UWST                      WDUWST
     I              B1UXST                      WDUXST
     I              B1VSST                      WDVSST
     I              B1AATM                      WDAATM
     I              B1AYNA                      WDAYNA
     I              B1A0NA                      WDA0NA
     I              B1AXDT                      WDAXDT
      *
     I@CHCPKA
      * WIM Item Balance Detail   Update index
      * Renamed input format fields
     I              CHAIC3                      WEAIC3
     I              CHHGCD                      WEHGCD
     I              CHAJCD                      WEAJCD
     I              CHNDSC                      WENDSC
     I              CHELDT                      WEELDT
     I              CHABWG                      WEABWG
     I              CHAGQT                      WEAGQT
     I              CHCTST                      WECTST
     I              CHQWWG                      WEQWWG
     I              CHTBQT                      WETBQT
     I              CHQXWG                      WEQXWG
     I              CHTCQT                      WETCQT
     I              CHQ0WG                      WEQ0WG
     I              CHTFQT                      WETFQT
     I              CHQ1WG                      WEQ1WG
     I              CHTGQT                      WETGQT
     I              CHBMWG                      WEBMWG
     I              CHDSQT                      WEDSQT
     I              CHDHDT                      WEDHDT
     I              CHBITS                      WEBITS
     I              CHBGD8                      WEBGD8
     I              CHRINB                      WERINB
     I              CHRHNB                      WERHNB
     I              CHRGNB                      WERGNB
     I              CHVSST                      WEVSST
     I              CHBGTS                      WEBGTS
     I              CHRUU1                      WERUU1
     I              CHRVU1                      WERVU1
     I              CHBHTS                      WEBHTS
     I              CHRWU1                      WERWU1
     I              CHRXU1                      WERXU1
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv WIM Item Bal/Dtl  XF
      * Build WIM Item Balance (PUCGCPP) Table.
      * Cnv Bld WIM Item Bal  RT - Item Balance  * 
     C                   EXSR      SARVGN
      * Build WIM Item Balance Detail (PUCHCPP) Table.
      * Cnv Bld WIM Item Bal DtRT - Item Balance Detail  * 
     C                   EXSR      SDRVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv Bld WIM Item Bal  RT - Item Balance  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     *ZERO         YL0001                         Update Date Tim
     C                   MOVEL     @CN(001)      YL0001                         Update Date Tim
      * Establish starting position
     C     *LOVAL        SETLL     @B0REJX                                      *
     C                   READ      @B0REJX                                90    *
      * Data record not found
     C   90              MOVEL     'USR0328'     W0RTN
      * USER: Process Data record
      * Per RyanH, create all records even if orphan records exist.
      * CASE: DB1.Company Number is not equal to zero
     C                   DOW       NOT *IN90
      * Rtv Label Type        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WAAIC3 <> 0
     C                   Z-ADD     WAAIC3        WL0001                         Company Number
     C                   Z-ADD     WAHGCD        WL0002                         Item Code
     C                   EXSR      SBRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        YL0002                         Label Type
      * Override 'Inventory Item Type' if 'WP' (Work in Progress).
      * CASE: LCL.Label Type is Work In Process
     C                   IF        YL0002 = 'WP'
     C                   MOVEL     'WP'          YL0003                         Inventory Item
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'FG'          YL0003                         Inventory Item
     C                   END                                                    *FI
      * Crt WIM Item Balance  CR - WIM Item Balance  * 
     C                   EXSR      SCCRRC
     C                   END                                                    *FI
     C                   READ      @B0REJX                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Label Type        RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0003 = ' '                                 Label Type
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBHGCD                         Item Code
      * Setup key
     C                   Z-ADD     WL0001        WBAIC3                         Company Number
     C                   Z-ADD     WL0002        WBHGCD                         Item Code
      * Establish starting position
     C     KRSSB         CHAIN     @BZREJU                            90        *
      * Data record not found
     C   90              MOVEL     'USR0326'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBS8ST        WL0003                         Label Type
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCRRC        BEGSR
      *================================================================
      * Crt WIM Item Balance  CR - WIM Item Balance  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0001                         Create Date Tim
     C                   EVAL      WN0002 = ' '                                 Create User ID
     C                   EVAL      WN0003 = ' '                                 Create Program
     C                   EVAL      WN0004 = ' '                                 Update User Id
     C                   EVAL      WN0005 = ' '                                 Update Program
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @CGCPJ7
     C                   Z-ADD     WAAIC3        WCAIC3                         Company Number
     C                   Z-ADD     WAHGCD        WCHGCD                         Item Code
     C                   MOVEL     WAAJCD        WCAJCD                         Warehouse Code
     C                   MOVEL     YL0003        WCNDSC                         Inventory Item
     C                   Z-ADD     WABOWG        WCBOWG                         On Hand Weight
     C                   Z-ADD     WADDQT        WCDDQT                         On Hand UOM1 Su
     C                   Z-ADD     *ZERO         WCQVWG                         In Transit Weig
     C                   Z-ADD     WAEMQT        WCS9QT                         In Transit UOM1
     C                   Z-ADD     WADOQT        WCTAQT                         Qty Available t
     C                   Z-ADD     *ZERO         WCQYWG                         On Hold Weight
     C                   Z-ADD     *ZERO         WCTDQT                         On Hold UOM1 Su
     C                   Z-ADD     *ZERO         WCQZWG                         Available Weigh
     C                   Z-ADD     *ZERO         WCTEQT                         Available UOM1
     C                   Z-ADD     WARINB        WCRINB                         Item Structure
     C                   Z-ADD     WARHNB        WCRHNB                         Item Structure
     C                   Z-ADD     WARGNB        WCRGNB                         Item Structure
     C                   MOVEL     WAVSST        WCVSST                         Record Status
     C                   MOVEL     YL0001        WCBHTS                         Update Date Tim
      *
      * USER: Processing before Data update
      * Set Crt Time Stamp DDL IF
      * *** Set CREATE Time Stamp Info.
      * PAR.Create Date Timestamp = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WCBGTS                         Create Date Tim
     C                   EVAL      WCRUU1 = ' '                                 Create User ID
     C                   MOVEL     ##USR         WCRUU1                         Create User ID
     C                   EVAL      WCRVU1 = ' '                                 Create Program
     C                   MOVEL     ##PGM         WCRVU1                         Create Program
      * *** Set CHANGE Time Stamp Info.
      * Cannot set Update Date TS here, will error.
     C                   EVAL      WCRWU1 = ' '                                 Update User Id
     C                   EVAL      WCRXU1 = ' '                                 Update Program
     C     KLCRSC        KLIST
     C                   KFLD                    WCAIC3                         Company Number
     C                   KFLD                    WCHGCD                         Item Code
     C                   KFLD                    WCAJCD                         Warehouse Code
     C                   KFLD                    WCNDSC                         Inventory Item
      * Check for duplicate primary key
     C     KLCRSC        SETLL     @CGCPJ7                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5250'     W0RTN
      * Send message 'WIM Item Balance       EX'
     C                   MOVEL     'USR5250'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
     C                   WRITE     @CGCPJ7                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Cnv Bld WIM Item Bal DtRT - Item Balance Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     *ZERO         YL0004                         Update Date Tim
     C                   MOVEL     @CN(001)      YL0004                         Update Date Tim
      * Establish starting position
     C     *LOVAL        SETLL     @B1REJ0                                      *
     C                   READ      @B1REJ0                                90    *
      * Data record not found
     C   90              MOVEL     'USR0330'     W0RTN
      * USER: Process Data record
      * Per RyanH, create all records even if orphan records exist.
      * CASE: DB1.Company Number is not equal to zero
     C                   DOW       NOT *IN90
      * Rtv Label Type        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WDAIC3 <> 0
     C                   Z-ADD     WDAIC3        WL0001                         Company Number
     C                   Z-ADD     WDHGCD        WL0002                         Item Code
     C                   EXSR      SBRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        YL0005                         Label Type
      * Override 'Inventory Item Type' if 'WP' (Work in Progress).
      * CASE: LCL.Label Type is Work In Process
     C                   IF        YL0005 = 'WP'
     C                   MOVEL     'WP'          YL0006                         Inventory Item
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'FG'          YL0006                         Inventory Item
     C                   END                                                    *FI
      * Format Physical Start Date.
      * CASE: DB1.Physical Start Date is entered
      *
     C                   IF        WDDHDT <> 0
     C                   Z-ADD     *ZERO         WN0006                         Year Code
     C                   Z-ADD     *ZERO         WN0007                         Month
     C                   Z-ADD     *ZERO         WN0008                         Day of Month US
     C                   EVAL      WN0009 = ' '                                 Year Alpha (YYY
     C                   EVAL      WN0010 = ' '                                 Month (Char) US
     C                   EVAL      WN0011 = ' '                                 Day   (Char) US
     C                   Z-ADD     *ZERO         WN0012                         Year  NBR USR
     C                   EVAL      WN0013 = ' '                                 Year  (Char) US
     C                   EVAL      WN0014 = ' '                                 Date (Alpha) US
      *
      * CVT *CYMD toYYYY-MM-DD IF
     C                   EVAL      WN0014 = ' '                                 Date (Alpha) US
     C                   MOVEL     WDDHDT        WN0014                         Date (Alpha) US
      * ** YEAR **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     2             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0014:ZQ     WN0013                 90      Year  (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     '20'          CAT(P)    WN0013:ZQ     YL0008                         Year Alpha (YYY
     C                   Z-ADD     *ZERO         ZQ
     C     YL0008        CAT(P)    '-':ZQ        YL0009                         Text USR 5
      * ** MONTH **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     4             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0014:ZQ     WN0010                 90      Month (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     WN0010        CAT(P)    '-':ZQ        YL0010                         Text 3 Length U
      * ** DAY **
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     6             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WN0014:ZQ     WN0011                 90      Day   (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     YL0010        CAT(P)    WN0011:ZQ     YL0011                         AS Date MM/DD
     C                   Z-ADD     *ZERO         ZQ
     C     YL0009        CAT(P)    YL0011:ZQ     YL0007                         Date Format
     C                   Z-ADD     *ZERO         ZQ
     C     YL0007        CAT(P)    @CN(002):ZQ   YL0012                         Date Timestamp
     C                   MOVEL     YL0012        YL0013                         Physical Start
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     *ZERO         YL0013                         Physical Start
     C                   MOVEL     @CN(001)      YL0013                         Physical Start
     C                   END                                                    *FI
     C                   Z-ADD     WDELDT        YL0014                         Production Date
      * LCL.Production Date YYYYMMDD = DB1.Production Date
     C     WDELDT        ADD       1000000       XDINDT                         Production Date
     C                   EXSR      XCVT2
     C                   MOVEL     XDI2DT        YL0015
      * If Prod Date=0 & is Bulk Item then Set Prod Date=930101.
      * CASE: DB1.Production Date is not entered
      * RTV Production Control RT - Company Item  * 
     C                   IF        WDELDT = 0
     C                   EXSR      SERVGN
      * Bulk Item.
      * CASE: LCL.Production Date Control is no
     C                   IF        YL0016 = 'N'
     C                   Z-ADD     930101        YL0014                         Production Date
      * LCL.Production Date YYYYMMDD = LCL.Production Date
     C     YL0014        ADD       1000000       XDINDT                         Production Date
     C                   EXSR      XCVT2
     C                   MOVEL     XDI2DT        YL0015
     C                   END                                                    *FI
      * Default Prod Date=1993-01-01 If 0.
      * CASE: LCL.Production Date is not entered
     C                   IF        YL0014 = 0
     C                   Z-ADD     930101        YL0014                         Production Date
     C                   MOVEL     @CN(004)      YL0015                         Production Date
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Crt WIM Item Bal Dtl  CR - WIM Item Balance Detail  * 
     C                   EXSR      SFCRRC
     C                   END                                                    *FI
     C                   READ      @B1REJ0                                90    *
     C                   ENDDO
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * RTV Production Control RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0016 = ' '                                 Production Date
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBHGCD                         Item Code
      * Setup key
     C                   Z-ADD     WDAIC3        WBAIC3                         Company Number
     C                   Z-ADD     WDHGCD        WBHGCD                         Item Code
      * Establish starting position
     C     KRSSE         CHAIN     @BZREJU                            90        *
      * Data record not found
     C   90              MOVEL     'USR0326'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBFZST        YL0016                         Production Date
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFCRRC        BEGSR
      *================================================================
      * Crt WIM Item Bal Dtl  CR - WIM Item Balance Detail  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0015                         Create Date Tim
     C                   EVAL      WN0016 = ' '                                 Create User ID
     C                   EVAL      WN0017 = ' '                                 Create Program
     C                   EVAL      WN0018 = ' '                                 Update User Id
     C                   EVAL      WN0019 = ' '                                 Update Program
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @CHCPKA
     C                   Z-ADD     WDAIC3        WEAIC3                         Company Number
     C                   Z-ADD     WDHGCD        WEHGCD                         Item Code
     C                   MOVEL     WDAJCD        WEAJCD                         Warehouse Code
     C                   MOVEL     YL0006        WENDSC                         Inventory Item
     C                   Z-ADD     YL0014        WEELDT                         Production Date
     C                   Z-ADD     WDABWG        WEABWG                         Physical Count
     C                   Z-ADD     WDAGQT        WEAGQT                         Physical Count
     C                   MOVEL     WDCTST        WECTST                         Physical Count
     C                   Z-ADD     WDACWG        WEQWWG                         On Hand Weight
     C                   Z-ADD     WDARQT        WETBQT                         On Hand UOM1 Qu
     C                   Z-ADD     *ZERO         WEQXWG                         In Transit Weig
     C                   Z-ADD     *ZERO         WETCQT                         In Transit UOM1
     C                   Z-ADD     *ZERO         WEQ0WG                         On Hold Weight
     C                   Z-ADD     *ZERO         WETFQT                         On Hold UOM1 Qu
     C                   Z-ADD     *ZERO         WEQ1WG                         Available Weigh
     C                   Z-ADD     *ZERO         WETGQT                         Available UOM1
     C                   Z-ADD     WDBMWG        WEBMWG                         Physical Start
     C                   Z-ADD     WDDSQT        WEDSQT                         Physical Start
     C                   Z-ADD     WDDHDT        WEDHDT                         Physical Start
     C                   MOVEL     YL0013        WEBITS                         Physical Start
     C                   MOVEL     YL0015        WEBGD8                         Production Date
     C                   Z-ADD     WDRINB        WERINB                         Item Structure
     C                   Z-ADD     WDRHNB        WERHNB                         Item Structure
     C                   Z-ADD     WDRGNB        WERGNB                         Item Structure
     C                   MOVEL     WDVSST        WEVSST                         Record Status
     C                   MOVEL     @CN(001)      WEBHTS                         Update Date Tim
      *
      * USER: Processing before Data update
      * Set Crt Time Stamp DDL IF
      * *** Set CREATE Time Stamp Info.
      * PAR.Create Date Timestamp = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WEBGTS                         Create Date Tim
     C                   EVAL      WERUU1 = ' '                                 Create User ID
     C                   MOVEL     ##USR         WERUU1                         Create User ID
     C                   EVAL      WERVU1 = ' '                                 Create Program
     C                   MOVEL     ##PGM         WERVU1                         Create Program
      * *** Set CHANGE Time Stamp Info.
      * Cannot set Update Date TS here, will error.
     C                   EVAL      WERWU1 = ' '                                 Update User Id
     C                   EVAL      WERXU1 = ' '                                 Update Program
     C     KLCRSF        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEHGCD                         Item Code
     C                   KFLD                    WEAJCD                         Warehouse Code
     C                   KFLD                    WENDSC                         Inventory Item
     C                   KFLD                    WEELDT                         Production Date
      * Check for duplicate primary key
     C     KLCRSF        SETLL     @CHCPKA                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5252'     W0RTN
      * Send message 'WIM Item Balance Detai EX'
     C                   MOVEL     'USR5252'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
     C                   WRITE     @CHCPKA                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   XCVT2         BEGSR
      *================================================================
      * Convert DTE to DT#
      *================================================================
     C                   MOVEL     '    -  -'    XDI2DT
     C                   IF        XDINDT = 1000000
     C                   Z-ADD     1             XDI2CY
     C                   Z-ADD     1             XDI2MM
     C                   Z-ADD     1             XDI2DD
     C                   ELSE
     C     XDINYY        ADD       1800          XDI2CY
     C                   Z-ADD     XDINMM        XDI2MM
     C                   Z-ADD     XDINDD        XDI2DD
     C                   END
      *================================================================
     CSR   XCVT2E        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAHGCD                         Item Code
     C                   Z-ADD     *ZERO         WAAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WAAECS                         Last Cost
     C                   Z-ADD     *ZERO         WABACS                         Cost per Primar
     C                   Z-ADD     *ZERO         WABBCS                         Cost per Pricin
     C                   Z-ADD     *ZERO         WACBPR                         Revaluation Cos
     C                   Z-ADD     *ZERO         WAGUDT                         Revaluation Eff
     C                   Z-ADD     *ZERO         WACTPR                         Last Revaluatio
     C                   Z-ADD     *ZERO         WAG4DT                         Last Revaluatio
     C                   Z-ADD     *ZERO         WABOWG                         On Hand Weight
     C                   Z-ADD     *ZERO         WADDQT                         On Hand UOM1 Su
     C                   Z-ADD     *ZERO         WADEQT                         On Hand UOM2 Su
     C                   Z-ADD     *ZERO         WADFQT                         On Hand UOM3 Su
     C                   Z-ADD     *ZERO         WAHDQT                         Quantity In Chi
     C                   Z-ADD     *ZERO         WAHEQT                         Weight In Chill
     C                   Z-ADD     *ZERO         WAAJQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WAAQQT                         Quantity on Sal
     C                   Z-ADD     *ZERO         WAAUQT                         Quantity on Pur
     C                   Z-ADD     *ZERO         WAEMQT                         Quantity on Tra
     C                   Z-ADD     *ZERO         WADOQT                         Quantity Avail
     C                   Z-ADD     *ZERO         WAAKDT                         Date of Last Or
     C                   Z-ADD     *ZERO         WAANDT                         Date of Last Sh
     C                   Z-ADD     *ZERO         WAIDVA                         Value of On Han
     C                   Z-ADD     *ZERO         WABZPC                         Safety Allowanc
     C                   Z-ADD     *ZERO         WADGQT                         Safety Allowanc
     C                   Z-ADD     *ZERO         WADIDT                         Stock Out Date
     C                   Z-ADD     *ZERO         WABFDY                         Lead Time Last
     C                   Z-ADD     *ZERO         WADJDT                         Lead Time Date
     C                   Z-ADD     *ZERO         WABGDY                         Lead Time Next
     C                   Z-ADD     *ZERO         WADKDT                         Lead Time Date
     C                   Z-ADD     *ZERO         WADJQT                         Usage Qty per C
     C                   Z-ADD     *ZERO         WABNWG                         Usage Weight pe
     C                   Z-ADD     *ZERO         WADLDT                         Inventory Manag
     C                   Z-ADD     *ZERO         WADPQT                         Minimum Quantit
     C                   Z-ADD     *ZERO         WADQQT                         Maximum Quantit
     C                   Z-ADD     *ZERO         WADMDT                         Last Physical C
     C                   Z-ADD     *ZERO         WAAKC8                         Vendor Item_Whs
     C                   Z-ADD     *ZERO         WARINB                         Item Structure
     C                   Z-ADD     *ZERO         WARHNB                         Item Structure
     C                   Z-ADD     *ZERO         WARGNB                         Item Structure
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBHGCD                         Item Code
     C                   Z-ADD     *ZERO         WBAWPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WBAXPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WBAIWG                         Unit Weight
     C                   Z-ADD     *ZERO         WBCZWG                         Minimum Weight
     C                   Z-ADD     *ZERO         WBC0WG                         Maximum Weight
     C                   Z-ADD     *ZERO         WBURTN                         Number Cases On
     C                   Z-ADD     *ZERO         WBAJC8                         Vendor Item Def
     C                   Z-ADD     *ZERO         WBRINB                         Item Structure
     C                   Z-ADD     *ZERO         WBRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WBRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WBTFNB                         Transportation
     C                   Z-ADD     *ZERO         WBTMVA                         Maximum Audit V
     C                   Z-ADD     *ZERO         WBTNVA                         Minimum Audit V
     C                   Z-ADD     *ZERO         WBBLPR                         Market Overage
     C                   Z-ADD     *ZERO         WBBMPR                         Standard Overag
     C                   Z-ADD     *ZERO         WBCMCO                         Item Pricing Co
     C                   Z-ADD     *ZERO         WBCHTM                         Fresh Chilling
     C                   Z-ADD     *ZERO         WBSWGH                         Std Weight_Head
     C                   Z-ADD     *ZERO         WBPPHE                         Pieces Per Head
     C                   Z-ADD     *ZERO         WBICN1                         Item Category N
     C                   Z-ADD     *ZERO         WBICN2                         Item Category N
     C                   Z-ADD     *ZERO         WBV2NB                         Item Category N
     C                   Z-ADD     *ZERO         WBITCN                         Item Category N
     C                   Z-ADD     *ZERO         WBITC5                         Item Category N
     C                   Z-ADD     *ZERO         WBICN6                         Item Category N
     C                   Z-ADD     *ZERO         WBICN7                         Item Category N
     C                   Z-ADD     *ZERO         WBICN8                         Item Category N
     C                   Z-ADD     *ZERO         WBICN9                         Item Category N
     C                   Z-ADD     *ZERO         WBICN0                         Item Category N
     C                   Z-ADD     *ZERO         WBSFNB                         Pallet Tare Wei
     C                   Z-ADD     *ZERO         WBA3WG                         Misc Tare Weigh
     C                   Z-ADD     *ZERO         WBSJNB                         Production Lead
     C                   Z-ADD     *ZERO         WBSKNB                         Agrimetrics gro
     C                   Z-ADD     *ZERO         WBSLNB                         Agrimetrics pac
     C                   Z-ADD     *ZERO         WBSMNB                         Agrimetrics gra
     C                   Z-ADD     *ZERO         WBCFNB                         PM Pounds per H
     C                   Z-ADD     *ZERO         WBCGNB                         Item Frt Overag
     C                   Z-ADD     *ZERO         WBILNB                         Packages per ca
     C                   Z-ADD     *ZERO         WBCHNB                         Use_Freeze_Sell
     C                   Z-ADD     *ZERO         WBCINB                         PM Batch Size
     C                   Z-ADD     *ZERO         WBCJNB                         Package Level s
     C                   Z-ADD     *ZERO         WBCMNB                         Partial Item Co
     C                   Z-ADD     *ZERO         WBCNNB                         WIP Item Code
     C                   Z-ADD     *ZERO         WBCRNB                         WIP Reject Code
     C                   Z-ADD     *ZERO         WBCSNB                         Std Costing Uni
     C                   Z-ADD     *ZERO         WBCVNB                         FP Std Green We
     C                   Z-ADD     *ZERO         WBCWNB                         PM Std LBS Man
     C                   Z-ADD     *ZERO         WBCXNB                         PM Raw Meat LBS
     C                   Z-ADD     *ZERO         WBCZNB                         PM Formula LBS
     C                   Z-ADD     *ZERO         WBC0NB                         PM Finished LBS
     C                   Z-ADD     *ZERO         WBB4NB                         PM Raw Material
     C                   Z-ADD     *ZERO         WBB5NB                         PM Line Number
     C                   Z-ADD     *ZERO         WBBDNB                         Pieces Per Bag
     C                   Z-ADD     *ZERO         WBBJNB                         Bags Per Unit
     C                   Z-ADD     *ZERO         WBF5WG                         Item Target Pri
     C                   Z-ADD     *ZERO         WBF6WG                         Minimum Piece W
     C                   Z-ADD     *ZERO         WBF7WG                         Maximum Piece W
     C                   Z-ADD     *ZERO         WBBLNB                         Seaboard Equiva
     C                   Z-ADD     *ZERO         WBBNNB                         Production Qty
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCHGCD                         Item Code
     C                   Z-ADD     *ZERO         WCBOWG                         On Hand Weight
     C                   Z-ADD     *ZERO         WCDDQT                         On Hand UOM1 Su
     C                   Z-ADD     *ZERO         WCQVWG                         In Transit Weig
     C                   Z-ADD     *ZERO         WCS9QT                         In Transit UOM1
     C                   Z-ADD     *ZERO         WCTAQT                         Qty Available t
     C                   Z-ADD     *ZERO         WCQYWG                         On Hold Weight
     C                   Z-ADD     *ZERO         WCTDQT                         On Hold UOM1 Su
     C                   Z-ADD     *ZERO         WCQZWG                         Available Weigh
     C                   Z-ADD     *ZERO         WCTEQT                         Available UOM1
     C                   Z-ADD     *ZERO         WCRINB                         Item Structure
     C                   Z-ADD     *ZERO         WCRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRGNB                         Item Structure
     C                   MOVEL     XDTSDL        WCBGTS                         Create Date Tim
     C                   MOVEL     XDTSDL        WCBHTS                         Update Date Tim
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAIC3                         Company Number
     C                   Z-ADD     *ZERO         WDHGCD                         Item Code
     C                   Z-ADD     *ZERO         WDELDT                         Production Date
     C                   Z-ADD     *ZERO         WDABWG                         Physical Count
     C                   Z-ADD     *ZERO         WDAGQT                         Physical Count
     C                   Z-ADD     *ZERO         WDAHQT                         Physical Count
     C                   Z-ADD     *ZERO         WDAIQT                         Physical Count
     C                   Z-ADD     *ZERO         WDACWG                         Quantity on Han
     C                   Z-ADD     *ZERO         WDARQT                         Quantity on Han
     C                   Z-ADD     *ZERO         WDASQT                         Quantity on Han
     C                   Z-ADD     *ZERO         WDATQT                         Quantity on Han
     C                   Z-ADD     *ZERO         WDHDQT                         Quantity In Chi
     C                   Z-ADD     *ZERO         WDHEQT                         Weight In Chill
     C                   Z-ADD     *ZERO         WDBMWG                         Physical Start
     C                   Z-ADD     *ZERO         WDDSQT                         Physical Start
     C                   Z-ADD     *ZERO         WDDTQT                         Physical Start
     C                   Z-ADD     *ZERO         WDDUQT                         Physical Start
     C                   Z-ADD     *ZERO         WDDHDT                         Physical Start
     C                   Z-ADD     *ZERO         WDAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WDAECS                         Last Cost
     C                   Z-ADD     *ZERO         WDIDVA                         Value of On Han
     C                   Z-ADD     *ZERO         WDK7DT                         Label Date
     C                   Z-ADD     *ZERO         WDRINB                         Item Structure
     C                   Z-ADD     *ZERO         WDRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WDRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEHGCD                         Item Code
     C                   Z-ADD     *ZERO         WEELDT                         Production Date
     C                   Z-ADD     *ZERO         WEABWG                         Physical Count
     C                   Z-ADD     *ZERO         WEAGQT                         Physical Count
     C                   Z-ADD     *ZERO         WEQWWG                         On Hand Weight
     C                   Z-ADD     *ZERO         WETBQT                         On Hand UOM1 Qu
     C                   Z-ADD     *ZERO         WEQXWG                         In Transit Weig
     C                   Z-ADD     *ZERO         WETCQT                         In Transit UOM1
     C                   Z-ADD     *ZERO         WEQ0WG                         On Hold Weight
     C                   Z-ADD     *ZERO         WETFQT                         On Hold UOM1 Qu
     C                   Z-ADD     *ZERO         WEQ1WG                         Available Weigh
     C                   Z-ADD     *ZERO         WETGQT                         Available UOM1
     C                   Z-ADD     *ZERO         WEBMWG                         Physical Start
     C                   Z-ADD     *ZERO         WEDSQT                         Physical Start
     C                   Z-ADD     *ZERO         WEDHDT                         Physical Start
     C                   MOVEL     XDTSDL        WEBITS                         Physical Start
     C                   MOVEL     @CN(003)      WEBGD8                         Production Date
     C                   Z-ADD     *ZERO         WERINB                         Item Structure
     C                   Z-ADD     *ZERO         WERHNB                         Item Structure
     C                   Z-ADD     *ZERO         WERGNB                         Item Structure
     C                   MOVEL     XDTSDL        WEBGTS                         Create Date Tim
     C                   MOVEL     XDTSDL        WEBHTS                         Update Date Tim
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SBRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
      * Define local work field Update Date Timestamp
     C                   MOVEL     XDTSDL        YL0001
      * Define local work field Label Type
     C                   EVAL      YL0002 = ' '
      * Define local work field Inventory Item Type
     C                   EVAL      YL0003 = ' '
      * Define local work field Update Date Timestamp
     C                   MOVEL     XDTSDL        YL0004
      * Define local work field Label Type
     C                   EVAL      YL0005 = ' '
      * Define local work field Inventory Item Type
     C                   EVAL      YL0006 = ' '
      * Define local work field Date Format
     C                   EVAL      YL0007 = ' '
      * Define local work field Year Alpha (YYYY) USR
     C                   EVAL      YL0008 = ' '
      * Define local work field Text USR 5
     C                   EVAL      YL0009 = ' '
      * Define local work field Text 3 Length USR
     C                   EVAL      YL0010 = ' '
      * Define local work field AS Date MM/DD
     C                   EVAL      YL0011 = ' '
      * Define local work field Date Timestamp Txt U
     C                   EVAL      YL0012 = ' '
      * Define local work field Physical Start Timestamp
     C                   MOVEL     XDTSDL        YL0013
      * Define local work field Production Date
     C                   Z-ADD     *ZERO         YL0014
      * Define local work field Production Date YYYYMMDD
     C                   MOVEL     @CN(003)      YL0015
      * Define local work field Production Date Control
     C                   EVAL      YL0016 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
00002 -00.00.00.000000
00003 0001-01-01
00004 1993-01-01
