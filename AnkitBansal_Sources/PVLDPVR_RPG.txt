     H/TITLE PMT Simulate carlisle  PV Prompt & validate record
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Prompt & validate record
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 07/22/25  Time  : 06:40:25
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0  IF   E           K DISK
      * Values list details file
      *
     FPVLDPVR#  CF   E             WORKSTN
     F                                     INFDS(INFDS#)
      * DSP: PMT Simulate carlisle  PV Prompt & validate record
      *
     FCAABREL1  IF   E           K DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FOPBFCPL1  IF   E           K DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKLA  IF   E           K DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1  IF   E           K DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL1  IF   E           K DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FCADRREL1  IF   E           K DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1  IF   E           K DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2  IF   E           K DISK
      * RSQ : Application               RSQ Application Code
      *
      * Long constants
     D @CN#            S              6    DIM(03)CTDATA PERRCD(1)
     D @CN             S             25    DIM(03) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * ABO DEFINE LARGE STRING FOR CL CMD
     D YARTCM          DS           512
     D  DUMMY1                 1      1
     D INFDS#        E DS                  EXTNAME(Y2I#DSP)
      * Display file information data structure
      *
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XDEX            DS
      * External date
     D  XDEXDT                 1      8  0
     D  XDEY01                 1      4  0
     D  XDEX01                 1      2  0
     D  XDEX02                 3      4  0
     D  XDEY02                 5      8  0
     D  XDEX03                 5      6  0
     D  XDEX04                 7      8  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0TRN          S              1
     D  W0HLP          S              1
     D  YPMT04         S              1
     D  HELP25         S              1
     D  ##OFF          S             30
     D  ZHCSRW         S              5  0
     D  ZHCSCL         S              5  0
     D  ZZCSRW         S              3  0
     D  ZZCSCL         S              3  0
     D  W0HPMB         S             10
     D  YYHPFL         S             10
     D  YYHPLB         S             10
     D  YYHLVN         S             10
     D  YYUSOP         S             10
     D  YYRW           S              5  0
     D  YYCL           S              5  0
     D  YYLGCT         S              5  0
     D  YYLGVN         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAFSMS         S              1
     D  W0DCF          S              1
     D  YL0001         S              1
     D  YL0002         S              7  0
     D  YL0003         S              7  0
     D  W0SJO          S            132
     D  #STYP          S              1
     D  #SLEN          S              5  0
     D  #SDEC          S              1  0
     D  #SPAK          S             30  9
     D  W0CLPG         S             10
     D  #SRQL          S             15  5
     D  W0JVN          S             10
     D  W0JUN          S             10
     D  W0JNB          S              6
     D  YL0004         S             10
     D  ZADFMF         S             10
     D  WUI3ST         S              1
     D  WUDMCD         S              3
     D  WUEOCD         S              7
     D  YL0005         S              1
     D  YN0001         S              2
     D  YN0002         S              7  0
     D  YN0003         S              7  0
     D  YN0004         S             30
     D  YN0005         S             30
     D  YN0006         S             30
     D  YN0007         S             30
     D  YN0008         S             20
     D  YN0009         S              2
     D  YN0010         S             11
     D  YN0011         S              7  0
     D  YN0012         S             30
     D  YN0013         S             30
     D  YN0014         S             30
     D  YN0015         S             30
     D  YN0016         S             20
     D  YN0017         S              2
     D  YN0018         S             11
     D  YN0019         S             15
     D  YN0020         S              7  0
     D  YN0021         S              7  0
     D  YN0022         S              7  0
     D  YN0023         S              2
     D  YN0024         S             40
     D  YN0025         S             40
     D  YN0026         S              3
     D  YN0027         S              1
     D  YN0028         S              1
     D  YN0029         S              1
     D  YN0030         S              1
     D  YN0031         S              3
     D  YN0032         S              1
     D  YL0006         S              1
     D  YN0033         S              1
     D  YN0034         S              1
     D  YN0035         S             10
     D  YN0036         S              7  0
     D  YN0037         S             11  2
     D  YN0038         S             11  2
     D  YN0039         S              1
     D  YN0040         S              1
     D  YN0041         S              1
     D  YN0042         S              7  0
     D  YN0043         S              4  0
     D  YN0044         S              4
     D  YN0045         S             12
     D  YL0007         S              7  0
     D  YN0046         S              5  2
     D  YN0047         S             11  2
     D  YN0048         S              1
     D  YN0049         S              1
     D  YN0050         S              1
     D  YN0051         S              2
     D  YN0052         S              1
     D  YN0053         S              1
     D  YN0054         S              1
     D  YN0055         S              1
     D  YN0056         S              1
     D  YN0057         S              5  2
     D  YN0058         S              1
     D  YN0059         S              7  0
     D  YN0060         S              1
     D  YN0061         S              1
     D  YN0062         S              7  0
     D  YN0063         S             30
     D  YN0064         S             30
     D  YN0065         S              1
     D  YN0066         S              3
     D  YN0067         S              2
     D  YN0068         S              3
     D  YN0069         S              7  0
     D  YN0070         S              3
     D  YN0071         S              7  0
     D  YN0072         S              2
     D  YN0073         S              7  0
     D  YN0074         S              2
     D  YN0075         S              1
     D  YN0076         S              1
     D  YN0077         S             11  2
     D  YN0078         S              1
     D  YL0008         S              1
     D  YN0079         S              1
     D  YN0080         S             11  2
     D  YN0081         S              1
     D  YN0082         S              1
     D  YN0083         S              1
     D  YN0084         S              1
     D  YN0085         S              1
     D  YN0086         S              1
     D  YN0087         S              1
     D  YN0088         S              1
     D  YN0089         S              1
     D  YN0090         S              1
     D  YN0091         S              1
     D  YN0092         S              2
     D  YN0093         S              2
     D  YN0094         S              2
     D  YN0095         S              3
     D  YN0096         S              3
     D  YN0097         S              7  0
     D  YN0098         S              7  0
     D  YN0099         S              7  0
     D  YN0100         S              7  0
     D  YN0101         S              7  0
     D  YN0102         S              6  0
     D  YN0103         S              6  0
     D  YN0104         S              6  0
     D  YN0105         S              6  0
     D  YN0106         S              6  0
     D  YN0107         S             11  2
     D  YN0108         S             11  2
     D  YN0109         S             11  2
     D  YN0110         S             11  2
     D  YN0111         S             11  2
     D  YN0112         S              7  0
     D  YN0113         S              1
     D  YN0114         S              1
     D  YN0115         S              1
     D  YN0116         S              6  0
     D  YN0117         S             10
     D  YN0118         S             10
     D  YN0119         S              7  0
     D  YL0009         S              3
     D  YL0010         S              6
     D  WQSD01         S                   LIKE(WCAIC3)
     D  WQSD02         S                   LIKE(WCC4NB)
     D  YL0011         S              1
     D  YL0012         S              1
     D  YN0120         S              1
     D  YN0121         S              1
     D  Y0CX01         S              1
     D  XDDTFM         S              3
     D  YL0013         S              1
     D  WQSF01         S                   LIKE(WEAIC3)
     D  WQSF02         S                   LIKE(WEC4NB)
     D  YL0014         S             11  2
     D  YL0015         S             11  2
     D  WQSG01         S                   LIKE(WFAIC3)
     D  WQSG02         S                   LIKE(WFC4NB)
     D  WQSG03         S                   LIKE(WFDPNB)
     D  WQSG04         S                   LIKE(WFUENB)
     D  WN30           S             30
     D  W0NSRQ         S              1
     D  Y2LSNO         S              7  0
     D  W0EXVL         S             25
     D  YPMTFD         S             10
     D  YAFSCH         S              4  0
     D  YPMRRN         S              4  0
     D  W0GRP          S              1
     D  YL0016         S              3  0
     D  WUBCCD         S              3
     D  YL0017         S              1
     D  YL0018         S             10
     D  WN0001         S             10
     D  WN0002         S             10
     D  YL0019         S              3  0
     D  YL0020         S              3
     D  WL0001         S             10
     D  WL0002         S              6
     D  WL0003         S              3  0
     D  WL0004         S              3
     D  WQ0001         S              3
     D  WQ0002         S              3  0
     D  WUAUNA         S             30
     D  WQSJ01         S                   LIKE(WIDNCD)
     D  WQSK01         S                   LIKE(WIDNCD)
     D  WUDSC4         S             40
     D  WUDE40         S             40
     D  YSETCS         S              1
     D  WCSRLC         S              3
     D  ZINPOS         S              5  0
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0CFL          S             10
     D  W0CRW          S              5  0
     D  W0CCL          S              5  0
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  @1FFL          S             10
     D  @1FLB          S             10
     D  @1FMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
     D J3              S              1    DIM(3)
     D K3              S              1    DIM(3)
     D J7              S              1    DIM(7)
     D K7              S              1    DIM(7)
     D #L3             S              1    DIM(3)
     D #L7             S              1    DIM(7)
     D UCT             S              1    DIM(40)                              CENTER TABLE
      * Submit job processing data structures.
     D #SRQS           DS          3000
     D  #SDMY1                 1      1
     D #SSTR           DS          3000
     D  #SDMY2                 1      1
     D #SWRK           DS          3000
     D  #SDMY3                 1      1
     D #SMRG           DS           256
     D  #SDMY4                 1      1
     D                 DS
     D#SCLL                    1     13    INZ('CMD(CALL PGM(')
     D#SPRM                   14     18    INZ('PARM(')
     D#SPRN                   19     19    INZ(')')
     D#SPRG                   20     29    INZ('          ')
      * Submit job command strings.
     D                 DS
     D#S0001                   1    256    INZ('SBMJOB     JOB(SHIPP-
     D                                     FSORD) JOBD(*USRPRF)-
     D                                      LOG(4 0 *SECLVL) LO-
     D                                     GCLPGM(*YES)')
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'Job Submitted'
      * Job
     D  ZA0001                 1     10
      * Jobq
     D  ZA0002                11     20
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Company not found'
      * Company Number
     D  ZA0003                 1      3
      * Message data for 'Order Number is not found'
      * Order Number
     D  ZA0004                 1      7
      * Message data for 'Order can not be shipped'
      * Company Number
     D  ZA0005                 1      3
      * Order Number
     D  ZA0006                 4     10
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     D  ZA0007                 1      4P 0
      * Message data for 'Load Id is not found'
      * Load ID
     D  ZA0008                 1      4P 0
      * Message data for 'Application access denied'
      * User Profile Name
     D  ZA0009                 1     10
      * Application Code
     D  ZA0010                11     16
      * Message data for 'Application access denied'
      * User Profile Name
     D  ZA0011                 1     10
      * Application Code
     D  ZA0012                11     16
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                      WAAIC3
     I              ABADTX                      WAADTX
     I              ABACNA                      WAACNA
     I              ABADNA                      WAADNA
     I              ABAENA                      WAAENA
     I              ABAJNA                      WAAJNA
     I              ABBTTX                      WABTTX
     I              ABBVTX                      WABVTX
     I              ABBWTX                      WABWTX
     I              ABA2NA                      WAA2NA
     I              ABABTX                      WAABTX
     I              ABBGCD                      WABGCD
     I              ABKXCD                      WAKXCD
     I              ABUVST                      WAUVST
     I              ABUWST                      WAUWST
     I              ABUXST                      WAUXST
     I              ABVSST                      WAVSST
     I              ABAATM                      WAAATM
     I              ABAYNA                      WAAYNA
     I              ABA0NA                      WAA0NA
     I              ABAXDT                      WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                      WBAIC3
     I              BEC4NB                      WBC4NB
     I              BEJNCD                      WBJNCD
     I              BEANC7                      WBANC7
     I              BEBKC7                      WBBKC7
     I              BEBRTX                      WBBRTX
     I              BEHMNA                      WBHMNA
     I              BEHONA                      WBHONA
     I              BEHPNA                      WBHPNA
     I              BEHNNA                      WBHNNA
     I              BEDBCD                      WBDBCD
     I              BECKTX                      WBCKTX
     I              BEB0C7                      WBB0C7
     I              BEAETX                      WBAETX
     I              BEB1NA                      WBB1NA
     I              BEB3NA                      WBB3NA
     I              BEB4NA                      WBB4NA
     I              BEB2NA                      WBB2NA
     I              BEBHCD                      WBBHCD
     I              BEC8TX                      WBC8TX
     I              BEBCNA                      WBBCNA
     I              BEA0DT                      WBA0DT
     I              BEA5DT                      WBA5DT
     I              BEGNDT                      WBGNDT
     I              BEACDT                      WBACDT
     I              BEAQCD                      WBAQCD
     I              BEB6NA                      WBB6NA
     I              BEBYNA                      WBBYNA
     I              BEBZNA                      WBBZNA
     I              BEGTST                      WBGTST
     I              BEGVST                      WBGVST
     I              BEGUST                      WBGUST
     I              BEQFST                      WBQFST
     I              BECQCD                      WBCQCD
     I              BEGJST                      WBGJST
     I              BEGWST                      WBGWST
     I              BEGXST                      WBGXST
     I              BEGYST                      WBGYST
     I              BEAODT                      WBAODT
     I              BEAIVN                      WBAIVN
     I              BECXDT                      WBCXDT
     I              BEJZVA                      WBJZVA
     I              BEA1WG                      WBA1WG
     I              BEXIST                      WBXIST
     I              BEXJST                      WBXJST
     I              BEXKST                      WBXKST
     I              BEEIDT                      WBEIDT
     I              BEAFTM                      WBAFTM
     I              BEE8CD                      WBE8CD
     I              BEE9CD                      WBE9CD
     I              BERMNB                      WBRMNB
     I              BETBNB                      WBTBNB
     I              BER1NB                      WBR1NB
     I              BEPJST                      WBPJST
     I              BEU0ST                      WBU0ST
     I              BEU1ST                      WBU1ST
     I              BEQ2CD                      WBQ2CD
     I              BEU2ST                      WBU2ST
     I              BEVEST                      WBVEST
     I              BEVFST                      WBVFST
     I              BEVGST                      WBVGST
     I              BERPCD                      WBRPCD
     I              BERNNB                      WBRNNB
     I              BEVDST                      WBVDST
     I              BEATIN                      WBATIN
     I              BEU4ST                      WBU4ST
     I              BEU5ST                      WBU5ST
     I              BERSRN                      WBRSRN
     I              BEMHNA                      WBMHNA
     I              BEMINA                      WBMINA
     I              BEWBST                      WBWBST
     I              BER4CD                      WBR4CD
     I              BEBFCD                      WBBFCD
     I              BEQ4CD                      WBQ4CD
     I              BET3NB                      WBT3NB
     I              BESICD                      WBSICD
     I              BECONB                      WBCONB
     I              BECEST                      WBCEST
     I              BEAWDT                      WBAWDT
     I              BEJPCD                      WBJPCD
     I              BEXUST                      WBXUST
     I              BEZ1ST                      WBZ1ST
     I              BEVRVA                      WBVRVA
     I              BEOBST                      WBOBST
     I              BEBCST                      WBBCST
     I              BEBDST                      WBBDST
     I              BEB7VL                      WBB7VL
     I              BEGASX                      WBGASX
     I              BEGBSX                      WBGBSX
     I              BEGCSX                      WBGCSX
     I              BEGDSX                      WBGDSX
     I              BEFNSX                      WBFNSX
     I              BEFOSX                      WBFOSX
     I              BEFPSX                      WBFPSX
     I              BEFQSX                      WBFQSX
     I              BEFRSX                      WBFRSX
     I              BEFSSX                      WBFSSX
     I              BEFTSX                      WBFTSX
     I              BEFUSX                      WBFUSX
     I              BEFVSX                      WBFVSX
     I              BEFWSX                      WBFWSX
     I              BEFXSX                      WBFXSX
     I              BEFYSX                      WBFYSX
     I              BENODT                      WBNODT
     I              BENPDT                      WBNPDT
     I              BENQDT                      WBNQDT
     I              BENRDT                      WBNRDT
     I              BENSDT                      WBNSDT
     I              BEBPTM                      WBBPTM
     I              BEBQTM                      WBBQTM
     I              BEBRTM                      WBBRTM
     I              BEBSTM                      WBBSTM
     I              BEBTTM                      WBBTTM
     I              BEH0NX                      WBH0NX
     I              BEH1NX                      WBH1NX
     I              BEH2NX                      WBH2NX
     I              BEH3NX                      WBH3NX
     I              BEH4NX                      WBH4NX
     I              BEC0C7                      WBC0C7
     I              BEUVST                      WBUVST
     I              BEUWST                      WBUWST
     I              BEUXST                      WBUXST
     I              BEAATM                      WBAATM
     I              BEAYNA                      WBAYNA
     I              BEA0NA                      WBA0NA
     I              BEAXDT                      WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                      WCAIC3
     I              OMC4NB                      WCC4NB
     I              OMDPNB                      WCDPNB
     I              OMUENB                      WCUENB
     I              OMHGCD                      WCHGCD
     I              OMAJCD                      WCAJCD
     I              OMBKC7                      WCBKC7
     I              OMCFC7                      WCCFC7
     I              OMGMST                      WCGMST
     I              OMGNST                      WCGNST
     I              OMMAVA                      WCMAVA
     I              OMKDVA                      WCKDVA
     I              OML8VA                      WCL8VA
     I              OML9VA                      WCL9VA
     I              OMGTST                      WCGTST
     I              OMGVST                      WCGVST
     I              OMGUST                      WCGUST
     I              OMQFST                      WCQFST
     I              OMAYVA                      WCAYVA
     I              OMEXDT                      WCEXDT
     I              OMLQCD                      WCLQCD
     I              OMRDCD                      WCRDCD
     I              OMQ7CD                      WCQ7CD
     I              OMBZPR                      WCBZPR
     I              OML6NB                      WCL6NB
     I              OMU1ST                      WCU1ST
     I              OMGIDT                      WCGIDT
     I              OMCRCD                      WCCRCD
     I              OMAGCD                      WCAGCD
     I              OMRZST                      WCRZST
     I              OMR0ST                      WCR0ST
     I              OMR1ST                      WCR1ST
     I              OMG7NA                      WCG7NA
     I              OMG8NA                      WCG8NA
     I              OMRPCD                      WCRPCD
     I              OMVEST                      WCVEST
     I              OMVGST                      WCVGST
     I              OMAVST                      WCAVST
     I              OMU0ST                      WCU0ST
     I              OMRFCD                      WCRFCD
     I              OMFZST                      WCFZST
     I              OMR1NB                      WCR1NB
     I              OMAVQT                      WCAVQT
     I              OMD0WG                      WCD0WG
     I              OMCCQT                      WCCCQT
     I              OMAUWG                      WCAUWG
     I              OMCBQT                      WCCBQT
     I              OMATWG                      WCATWG
     I              OMAQCS                      WCAQCS
     I              OMAGCS                      WCAGCS
     I              OMAKPR                      WCAKPR
     I              OMALPR                      WCALPR
     I              OMAUPR                      WCAUPR
     I              OMAVWG                      WCAVWG
     I              OMA4WG                      WCA4WG
     I              OMA5DT                      WCA5DT
     I              OMAODT                      WCAODT
     I              OMGNDT                      WCGNDT
     I              OMAMST                      WCAMST
     I              OMANST                      WCANST
     I              OMVAST                      WCVAST
     I              OMRGNB                      WCRGNB
     I              OMRHNB                      WCRHNB
     I              OMRINB                      WCRINB
     I              OMRBCD                      WCRBCD
     I              OMHICD                      WCHICD
     I              OMRNCD                      WCRNCD
     I              OMROCD                      WCROCD
     I              OMCXDT                      WCCXDT
     I              OMAJVN                      WCAJVN
     I              OMKXCD                      WCKXCD
     I              OMJPCD                      WCJPCD
     I              OMCQCD                      WCCQCD
     I              OMR4CD                      WCR4CD
     I              OMZ1ST                      WCZ1ST
     I              OMZ3ST                      WCZ3ST
     I              OMZ4ST                      WCZ4ST
     I              OMDUPR                      WCDUPR
     I              OMB6VL                      WCB6VL
     I              OMA1AA                      WCA1AA
     I              OMFZSX                      WCFZSX
     I              OMF0SX                      WCF0SX
     I              OMF1SX                      WCF1SX
     I              OMF2SX                      WCF2SX
     I              OMF3SX                      WCF3SX
     I              OMF4SX                      WCF4SX
     I              OMF5SX                      WCF5SX
     I              OMF6SX                      WCF6SX
     I              OMF7SX                      WCF7SX
     I              OMNTDT                      WCNTDT
     I              OMNUDT                      WCNUDT
     I              OMNVDT                      WCNVDT
     I              OMNWDT                      WCNWDT
     I              OMNXDT                      WCNXDT
     I              OMBUTM                      WCBUTM
     I              OMBVTM                      WCBVTM
     I              OMBWTM                      WCBWTM
     I              OMBXTM                      WCBXTM
     I              OMBYTM                      WCBYTM
     I              OMH5NX                      WCH5NX
     I              OMH6NX                      WCH6NX
     I              OMH7NX                      WCH7NX
     I              OMH8NX                      WCH8NX
     I              OMH9NX                      WCH9NX
     I              OMDVPR                      WCDVPR
     I              OMDWPR                      WCDWPR
     I              OMDXPR                      WCDXPR
     I              OMDYPR                      WCDYPR
     I              OMDZPR                      WCDZPR
     I              OMGSPR                      WCGSPR
     I              OMGTPR                      WCGTPR
     I              OMGUPR                      WCGUPR
     I              OMHOST                      WCHOST
     I              OMHPST                      WCHPST
     I              OMIOST                      WCIOST
     I              OMPEWG                      WCPEWG
     I              OMRINY                      WCRINY
     I              OMTIDT                      WCTIDT
     I              OMTJDT                      WCTJDT
     I              OMH2ST                      WCH2ST
     I              OMH0ST                      WCH0ST
     I              OMH1ST                      WCH1ST
     I              OMTKDT                      WCTKDT
     I              OMTLDT                      WCTLDT
     I              OMTMDT                      WCTMDT
     I              OMUVST                      WCUVST
     I              OMUWST                      WCUWST
     I              OMUXST                      WCUXST
     I              OMAATM                      WCAATM
     I              OMAYNA                      WCAYNA
     I              OMA0NA                      WCA0NA
     I              OMAXDT                      WCAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                      WDAJCD
     I              ADF8NA                      WDF8NA
     I              ADACNA                      WDACNA
     I              ADADNA                      WDADNA
     I              ADAENA                      WDAENA
     I              ADAJNA                      WDAJNA
     I              ADBTTX                      WDBTTX
     I              ADAOCD                      WDAOCD
     I              ADBGCD                      WDBGCD
     I              ADVHST                      WDVHST
     I              ADMPNA                      WDMPNA
     I              ADWPST                      WDWPST
     I              ADXUST                      WDXUST
     I              ADT0ST                      WDT0ST
     I              ADT1ST                      WDT1ST
     I              ADDBNB                      WDDBNB
     I              ADT2ST                      WDT2ST
     I              ADT3ST                      WDT3ST
     I              ADT4ST                      WDT4ST
     I              ADT6ST                      WDT6ST
     I              ADBWC3                      WDBWC3
     I              ADBTC3                      WDBTC3
     I              ADBUC3                      WDBUC3
     I              ADBVC3                      WDBVC3
     I              ADFCAA                      WDFCAA
     I              ADRQSX                      WDRQSX
     I              ADRRSX                      WDRRSX
     I              ADRSSX                      WDRSSX
     I              ADRTSX                      WDRTSX
     I              ADT7ST                      WDT7ST
     I              ADT8ST                      WDT8ST
     I              ADRNSX                      WDRNSX
     I              ADROSX                      WDROSX
     I              ADRPSX                      WDRPSX
     I              ADUVST                      WDUVST
     I              ADUWST                      WDUWST
     I              ADUXST                      WDUXST
     I              ADVSST                      WDVSST
     I              ADAATM                      WDAATM
     I              ADAYNA                      WDAYNA
     I              ADA0NA                      WDA0NA
     I              ADAXDT                      WDAXDT
     I              ADQDSC                      WDQDSC
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      WEAIC3
     I              OMC4NB                      WEC4NB
     I              OMDPNB                      WEDPNB
     I              OMUENB                      WEUENB
     I              OMHGCD                      WEHGCD
     I              OMAJCD                      WEAJCD
     I              OMBKC7                      WEBKC7
     I              OMCFC7                      WECFC7
     I              OMGMST                      WEGMST
     I              OMGNST                      WEGNST
     I              OMMAVA                      WEMAVA
     I              OMKDVA                      WEKDVA
     I              OML8VA                      WEL8VA
     I              OML9VA                      WEL9VA
     I              OMGTST                      WEGTST
     I              OMGVST                      WEGVST
     I              OMGUST                      WEGUST
     I              OMQFST                      WEQFST
     I              OMAYVA                      WEAYVA
     I              OMEXDT                      WEEXDT
     I              OMLQCD                      WELQCD
     I              OMRDCD                      WERDCD
     I              OMQ7CD                      WEQ7CD
     I              OMBZPR                      WEBZPR
     I              OML6NB                      WEL6NB
     I              OMU1ST                      WEU1ST
     I              OMGIDT                      WEGIDT
     I              OMCRCD                      WECRCD
     I              OMAGCD                      WEAGCD
     I              OMRZST                      WERZST
     I              OMR0ST                      WER0ST
     I              OMR1ST                      WER1ST
     I              OMG7NA                      WEG7NA
     I              OMG8NA                      WEG8NA
     I              OMRPCD                      WERPCD
     I              OMVEST                      WEVEST
     I              OMVGST                      WEVGST
     I              OMAVST                      WEAVST
     I              OMU0ST                      WEU0ST
     I              OMRFCD                      WERFCD
     I              OMFZST                      WEFZST
     I              OMR1NB                      WER1NB
     I              OMAVQT                      WEAVQT
     I              OMD0WG                      WED0WG
     I              OMCCQT                      WECCQT
     I              OMAUWG                      WEAUWG
     I              OMCBQT                      WECBQT
     I              OMATWG                      WEATWG
     I              OMAQCS                      WEAQCS
     I              OMAGCS                      WEAGCS
     I              OMAKPR                      WEAKPR
     I              OMALPR                      WEALPR
     I              OMAUPR                      WEAUPR
     I              OMAVWG                      WEAVWG
     I              OMA4WG                      WEA4WG
     I              OMA5DT                      WEA5DT
     I              OMAODT                      WEAODT
     I              OMGNDT                      WEGNDT
     I              OMAMST                      WEAMST
     I              OMANST                      WEANST
     I              OMVAST                      WEVAST
     I              OMRGNB                      WERGNB
     I              OMRHNB                      WERHNB
     I              OMRINB                      WERINB
     I              OMRBCD                      WERBCD
     I              OMHICD                      WEHICD
     I              OMRNCD                      WERNCD
     I              OMROCD                      WEROCD
     I              OMCXDT                      WECXDT
     I              OMAJVN                      WEAJVN
     I              OMKXCD                      WEKXCD
     I              OMJPCD                      WEJPCD
     I              OMCQCD                      WECQCD
     I              OMR4CD                      WER4CD
     I              OMZ1ST                      WEZ1ST
     I              OMZ3ST                      WEZ3ST
     I              OMZ4ST                      WEZ4ST
     I              OMDUPR                      WEDUPR
     I              OMB6VL                      WEB6VL
     I              OMA1AA                      WEA1AA
     I              OMFZSX                      WEFZSX
     I              OMF0SX                      WEF0SX
     I              OMF1SX                      WEF1SX
     I              OMF2SX                      WEF2SX
     I              OMF3SX                      WEF3SX
     I              OMF4SX                      WEF4SX
     I              OMF5SX                      WEF5SX
     I              OMF6SX                      WEF6SX
     I              OMF7SX                      WEF7SX
     I              OMNTDT                      WENTDT
     I              OMNUDT                      WENUDT
     I              OMNVDT                      WENVDT
     I              OMNWDT                      WENWDT
     I              OMNXDT                      WENXDT
     I              OMBUTM                      WEBUTM
     I              OMBVTM                      WEBVTM
     I              OMBWTM                      WEBWTM
     I              OMBXTM                      WEBXTM
     I              OMBYTM                      WEBYTM
     I              OMH5NX                      WEH5NX
     I              OMH6NX                      WEH6NX
     I              OMH7NX                      WEH7NX
     I              OMH8NX                      WEH8NX
     I              OMH9NX                      WEH9NX
     I              OMDVPR                      WEDVPR
     I              OMDWPR                      WEDWPR
     I              OMDXPR                      WEDXPR
     I              OMDYPR                      WEDYPR
     I              OMDZPR                      WEDZPR
     I              OMGSPR                      WEGSPR
     I              OMGTPR                      WEGTPR
     I              OMGUPR                      WEGUPR
     I              OMHOST                      WEHOST
     I              OMHPST                      WEHPST
     I              OMIOST                      WEIOST
     I              OMPEWG                      WEPEWG
     I              OMRINY                      WERINY
     I              OMTIDT                      WETIDT
     I              OMTJDT                      WETJDT
     I              OMH2ST                      WEH2ST
     I              OMH0ST                      WEH0ST
     I              OMH1ST                      WEH1ST
     I              OMTKDT                      WETKDT
     I              OMTLDT                      WETLDT
     I              OMTMDT                      WETMDT
     I              OMUVST                      WEUVST
     I              OMUWST                      WEUWST
     I              OMUXST                      WEUXST
     I              OMAATM                      WEAATM
     I              OMAYNA                      WEAYNA
     I              OMA0NA                      WEA0NA
     I              OMAXDT                      WEAXDT
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                      WFAIC3
     I              FNC4NB                      WFC4NB
     I              FNDPNB                      WFDPNB
     I              FNUENB                      WFUENB
     I              FNRZNB                      WFRZNB
     I              FNFOQT                      WFFOQT
     I              FNR0NB                      WFR0NB
     I              FNPMST                      WFPMST
     I              FNK7DT                      WFK7DT
     I              FNPFNX                      WFPFNX
     I              FNHGCD                      WFHGCD
     I              FNAJCD                      WFAJCD
     I              FNELDT                      WFELDT
     I              FNN5WG                      WFN5WG
     I              FNRZNA                      WFRZNA
     I              FNH5NY                      WFH5NY
     I              FNH6NY                      WFH6NY
     I              FNH7NY                      WFH7NY
     I              FNGBTX                      WFGBTX
     I              FNN6WG                      WFN6WG
     I              FNN7WG                      WFN7WG
     I              FNGCTX                      WFGCTX
     I              FNGDTX                      WFGDTX
     I              FNRBDT                      WFRBDT
     I              FNITNY                      WFITNY
     I              FNIVNY                      WFIVNY
     I              FNIUNY                      WFIUNY
     I              FNIWNY                      WFIWNY
     I              FNIXNY                      WFIXNY
     I              FNIYNY                      WFIYNY
     I              FNUVST                      WFUVST
     I              FNUWST                      WFUWST
     I              FNUXST                      WFUXST
     I              FNVSST                      WFVSST
     I              FNAATM                      WFAATM
     I              FNAYNA                      WFAYNA
     I              FNA0NA                      WFA0NA
     I              FNAXDT                      WFAXDT
     I              FNLPNZ                      WFLPNZ
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                      WGAJVN
     I              DRAUNA                      WGAUNA
     I              DRB8NA                      WGB8NA
     I              DRAHVN                      WGAHVN
     I              DRI6ST                      WGI6ST
     I              DRI7ST                      WGI7ST
     I              DRXMST                      WGXMST
     I              DRXNST                      WGXNST
     I              DRI8ST                      WGI8ST
     I              DRNLNB                      WGNLNB
     I              DRMPNA                      WGMPNA
     I              DRBCCD                      WGBCCD
     I              DRAIC3                      WGAIC3
     I              DRDQCD                      WGDQCD
     I              DRDRCD                      WGDRCD
     I              DRAJCD                      WGAJCD
     I              DRBUVN                      WGBUVN
     I              DRUVST                      WGUVST
     I              DRUWST                      WGUWST
     I              DRUXST                      WGUXST
     I              DRAATM                      WGAATM
     I              DRAYNA                      WGAYNA
     I              DRA0NA                      WGA0NA
     I              DRAXDT                      WGAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                      WHAJVN
     I              DTDNCD                      WHDNCD
     I              DTAIC3                      WHAIC3
     I              DTDQCD                      WHDQCD
     I              DTDRCD                      WHDRCD
     I              DTAJCD                      WHAJCD
     I              DTJFST                      WHJFST
     I              DTUVST                      WHUVST
     I              DTUWST                      WHUWST
     I              DTUXST                      WHUXST
     I              DTAATM                      WHAATM
     I              DTAYNA                      WHAYNA
     I              DTA0NA                      WHA0NA
     I              DTAXDT                      WHAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                      WIDNCD
     I              DNAUNA                      WIAUNA
     I              DNVKST                      WIVKST
     I              DNRSCD                      WIRSCD
     I              DNUVST                      WIUVST
     I              DNUWST                      WIUWST
     I              DNUXST                      WIUXST
     I              DNAATM                      WIAATM
     I              DNAYNA                      WIAYNA
     I              DNA0NA                      WIA0NA
     I              DNAXDT                      WIAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Conduct screen conversation
     C                   DO        *HIVAL
      * Start new transaction
     C                   MOVEL     'Y'           W0TRN
      * Process current transaction
      * Convert fields to external form
     C                   DOW       W0TRN = 'Y'
     C                   EXSR      MNCV#1
      * Display screen
     C                   EXSR      CAEXFM
      * Process response
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * HOME: Reset screen fields
     C   30              CAS                     MALDSC
      * Process screen input
     C                   CAS                     DAPRSC
     C                   END
      *
     C                   END
      *
     C                   END
      *****************************************************************
      /EJECT
     CSR   CAEXFM        BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                   TIME                    ##TME
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y0SET
     C                   END
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   EXFMT     #RCDDTL1
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   DAPRSC        BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                   MOVEL     'N'           W0DCF
      * Validate screen input
     C                   EXSR      DBVLSC
      * If error, exit
     C     *IN99         CABEQ     '1'           DAEXIT
      * Defer confirm/update requested
     C     W0DCF         CABEQ     'Y'           DAEXIT
      * Prompt for confirmation
     C                   EXSR      DHPMCF
      * Quit if not confirmed
     C     *IN99         CABEQ     '1'           DAEXIT
      * USER: User defined action
     C                   MOVEL     'N'           YL0001                         Access Denied (
      * SBMJOB: ADD Ready to Confirm  XL - Order Detail  * 
      *
     C                   EVAL      W0RTN = ' '
      * Build call string for processing in batch.
     C                   MOVEL(P)  #S0001        #SRQS
     C     #SRQS         CAT       #SCLL:1       #SRQS                          Call command
     C                   MOVEL(P)  'PNTKXFR '    #SPRG                          Load pgm name
     C     #SRQS         CAT       #SPRG:0       #SRQS                          Add pgm name
     C     #SRQS         CAT       #SPRN:0       #SRQS                          Parenthesis
      *................................................................
      * Build parameters string.
     C     #SRQS         CAT       #SPRM:1       #SRQS                          Parameters
      *
     C                   MOVEL(P)  W0RTN         #SSTR                          *Return code
     C                   CALL      'Y2BLSJR'
     C                   PARM                    W0RTN
     C                   PARM                    #SSTR
     C                   PARM      'A'           #STYP
     C                   PARM      7             #SLEN
     C                   PARM                    #SDEC
     C                   PARM                    #SRQS
      *
     C                   Z-ADD     #DAIC3        #SPAK                          Company Number
     C                   MOVEL(P)  #SPAK         #SSTR
     C                   CALL      'Y2BLSJR'
     C                   PARM                    W0RTN
     C                   PARM                    #SSTR
     C                   PARM      'P'           #STYP
     C                   PARM      3             #SLEN
     C                   PARM      0             #SDEC
     C                   PARM                    #SRQS
      *
     C                   Z-ADD     #DC4NB        #SPAK                          Order Number
     C                   MOVEL(P)  #SPAK         #SSTR
     C                   CALL      'Y2BLSJR'
     C                   PARM                    W0RTN
     C                   PARM                    #SSTR
     C                   PARM      'P'           #STYP
     C                   PARM      7             #SLEN
     C                   PARM      0             #SDEC
     C                   PARM                    #SRQS
      *
     C                   Z-ADD     YL0002        #SPAK                          Actual Shipped
     C                   MOVEL(P)  #SPAK         #SSTR
     C                   CALL      'Y2BLSJR'
     C                   PARM                    W0RTN
     C                   PARM                    #SSTR
     C                   PARM      'P'           #STYP
     C                   PARM      7             #SLEN
     C                   PARM      0             #SDEC
     C                   PARM                    #SRQS
      *
     C                   MOVEL(P)  YL0001        #SSTR                          Access Denied (
     C                   CALL      'Y2BLSJR'
     C                   PARM                    W0RTN
     C                   PARM                    #SSTR
     C                   PARM      'A'           #STYP
     C                   PARM      1             #SLEN
     C                   PARM                    #SDEC
     C                   PARM                    #SRQS
      *
     C                   Z-ADD     YL0003        #SPAK                          Scheduled Ship
     C                   MOVEL(P)  #SPAK         #SSTR
     C                   CALL      'Y2BLSJR'
     C                   PARM                    W0RTN
     C                   PARM                    #SSTR
     C                   PARM      'P'           #STYP
     C                   PARM      7             #SLEN
     C                   PARM      0             #SDEC
     C                   PARM                    #SRQS
      *
     C     #SRQS         CAT       #SPRN:0       #SRQS                          Parenthesis
      *................................................................
     C     #SRQS         CAT       #SPRN:0       #SRQS                          Parenthesis
      *
      * Build of submit job string ended in error.
     C                   IF        W0RTN <> ' '
     C                   MOVEL     'Y2U0065'     W0RTN
     C                   MOVEL(P)  'PNTKXFR '    W0CLPG
      * Send message '*Error occured on SBMJOB'
     C                   MOVEL     'Y2U0065'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   ELSE
      *
      * Merge variable submit job overrides.
     C                   IF        W0SJO <> ' '
     C                   CALL      'Y2MGRQR'                            90      *
     C                   PARM      #SRQS         #SWRK
     C                   PARM      W0SJO         #SMRG
     C  N90              MOVEL(P)  #SWRK         #SRQS
     C                   EVALR     W0SJO = ' '
     C                   END
      * Submit request.
     C                   CALL      'Y2CMEXC'                            90      *
     C                   PARM                    #SRQS
     C                   PARM      3000          #SRQL
     C                   PARM                    W0JVN
     C                   PARM                    W0JUN
     C                   PARM                    W0JNB
     C                   END
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNTKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        993132    *
     C                   END
      * Setup message data for message
     C                   MOVEL     @CN(001)      ZA0001                         Job
     C                   MOVEL     YL0004        ZA0002                         Jobq
      * Send message 'Job Submitted'
     C                   MOVEL     'USR2685'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
      * Request new transaction
     C                   MOVEL     'N'           W0TRN
      *================================================================
     CSR   DAEXIT        ENDSR
      /EJECT
     CSR   DBVLSC        BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                   MOVEL     VDAIC3        WUI3ST                         USR First Posit
     C                   EVAL      W0RTN = ' '                                  *Return code
      * CASE: WRK.USR First Position is Search request
     C                   IF        WUI3ST = '?'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     VDAIC3        WUDMCD                         CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
      * RIGHT JUSTIFY INPUT FIELD
     C                   MOVE      *BLANKS       JUSTC3            3
     C                   MOVEA     *BLANKS       K3
     C                   Z-ADD     3             C                 3 0
     C                   Z-ADD     3             D                 3 0
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                   MOVEA     WUDMCD        J3
     C                   MOVE      *BLANKS       W0RTN
     C                   DO        3
     C     J3(C)         IFNE      ' '
     C                   MOVEA     J3(C)         K3(D)
     C                   SUB       1             D
     C                   END
     C                   SUB       1             C
     C                   END
     C                   MOVEA     K3            JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                   MOVE      JUSTC3        TESTC             1
     C     TESTC         IFGT      '?'
     C     TESTC         ANDLT     '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   ELSE
     C                   MOVE      *IN60         HLDIN             1
     C                   TESTN                   JUSTC3               606060
     C     *IN60         IFEQ      '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   END
     C                   END
     C                   MOVE      JUSTC3        WUDMCD
     C                   MOVE      HLDIN         *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                   IF        W0RTN = @CN(002)
     C                   MOVEL     'USR0752'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   Z-ADD     *ZERO         #DAIC3                         CD3 Int Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVE      WUDMCD        #DAIC3                         CD3 Int Numeric
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                   MOVEL     VDC4NB        WUI3ST                         USR First Posit
     C                   EVAL      W0RTN = ' '                                  *Return code
      * CASE: WRK.USR First Position is Search request
     C                   IF        WUI3ST = '?'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     VDC4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
      * RIGHT JUSTIFY INPUT FIELD
     C                   MOVE      *BLANKS       JUSTC7            7
     C                   MOVEA     *BLANKS       K7
     C                   Z-ADD     7             C                 3 0
     C                   Z-ADD     7             D                 3 0
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                   MOVEA     WUEOCD        J7
     C                   MOVE      *BLANKS       W0RTN
     C                   DO        7
     C     J7(C)         IFNE      ' '
     C                   MOVEA     J7(C)         K7(D)
     C                   SUB       1             D
     C                   END
     C                   SUB       1             C
     C                   END
     C                   MOVEA     K7            JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                   MOVE      JUSTC7        TEST7             1
     C     TEST7         IFGT      '?'
     C     TEST7         ANDLT     '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   ELSE
     C                   MOVE      *IN60         HLDIN             1
     C                   TESTN                   JUSTC7               606060
     C     *IN60         IFEQ      '0'
     C                   MOVE      'USR0752'     W0RTN
     C                   END
     C                   END
     C                   MOVE      JUSTC7        WUEOCD
     C                   MOVE      HLDIN         *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                   IF        W0RTN = @CN(002)
     C                   MOVEL     'USR0802'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   Z-ADD     *ZERO         #DC4NB                         CD7 Int Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVE      WUEOCD        #DC4NB                         CD7 Int Numeric
     C                   END                                                    *FI
     C                   END                                                    *FI
      * USER: Validate fields
      * Validate company
      * CASE: DTL.Company Number is greater than zero
     C                   IF        YPMTFD = ' '
      * Val Company Number    RT - Company Name and Address  * 
     C                   IF        #DAIC3 > 0
     C                   EXSR      SARVGN
      * CASE: LCL.Record Found USR is Record Not Found
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C                   IF        YL0005 = 'N'
     C                   IF        #DAIC3 <> 0
     C                   EVAL      WUDMCD = ' '                                 CD3 Ext Numeric
     C                   MOVEL     #DAIC3        WUDMCD                         CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUDMCD        #L3                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        3
     C     #L3(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L3(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L3           WUDMCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUDMCD        ZA0003                         CD3 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      ZA0003 = ' '                                 CD3 Ext Numeric
     C                   END                                                    *FI
      * Send message 'Company not found'
     C                   MOVEL     'USR2831'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        9931      *
      *
     C                   GOTO      DBEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Validate Order
      * CASE: DTL.Order Number is Greater then zero
      * Val Order Hdr Exists   RT - Order Header TRG  * 
     C                   IF        #DC4NB > 0
     C                   EXSR      SBRVGN
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        #DC4NB <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     #DC4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        ZA0004                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      ZA0004 = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Send message 'Order Number is not found'
     C                   MOVEL     'USR1362'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        9932      *
      *
     C                   GOTO      DBEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV All Fields         RT - Order Header TRG  * 
     C                   EXSR      SCRVGN
      * RTV 1st Whse/Country   RT - Order Detail  * 
     C                   EXSR      SDRVGN
      * Show error if block order
      * CASE: LCL.Block Order Flag is Firm Order
     C                   IF        YL0008 = 'F'
     C                   ELSE
      * CASE: *OTHERWISE
      * Send message 'Block order No Ship'
     C                   MOVEL     'USR5557'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   GOTO      DBEXIT                                       *QUIT
     C                   END                                                    *FI
      * Validate warehouse is Live with Carlisle
      * CASE: LCL.Warehouse Code is Not Blanks
      * Rtv EDI 856 ASN Info RT - Warehouse Codes  * 
     C                   IF        YL0009 <> ' '
     C                   EXSR      SERVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Warehouse Location is Internal (Plant)
      *   |- c2    : LCL.WHS Live with Carlisle is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0011 = 'I'
     C                   IF        YL0012 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   ELSE
      * CASE: *OTHERWISE
      * Send message 'Warehouse is Not Live PFS'
     C                   MOVEL     'USR5556'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   GOTO      DBEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Show error if order can not be shipped
      * CASE: LCL.Header Status is Not Conf/Comp (PFS)
     C                   IF        YL0006 = 'L' OR
     C                             YL0006 = 'A' OR
     C                             YL0006 = 'E' OR
     C                             YL0006 = 'H'
     C                   ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C                   IF        #DAIC3 <> 0
     C                   EVAL      WUDMCD = ' '                                 CD3 Ext Numeric
     C                   MOVEL     #DAIC3        WUDMCD                         CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUDMCD        #L3                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        3
     C     #L3(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L3(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L3           WUDMCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUDMCD        ZA0005                         CD3 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      ZA0005 = ' '                                 CD3 Ext Numeric
     C                   END                                                    *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        #DC4NB <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     #DC4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        ZA0006                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      ZA0006 = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Send message 'Order can not be shipped'
     C                   MOVEL     'USR5555'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        993132    *
      *
     C                   GOTO      DBEXIT                                       *QUIT
     C                   END                                                    *FI
      * Validate Scheduled Ship Date
      * CASE: LCL.Scheduled Ship Date is not entered
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C                   IF        YL0003 = 0
     C     1000000       ADD       YL0003        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        ZA0007
      * Send message 'Scheduled Ship Date Req'd'
     C                   MOVEL     'USR2230'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
      * Validate Actual Shipped Date
      * CASE: LCL.Actual Shipped Date is not entered
      * Send message 'Actual ship date is reqd'
     C                   IF        YL0002 = 0
     C                   MOVEL     'USR5554'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
      * Show error if load id is zero
      * CASE: LCL.Load ID is Blank
      * Setup message data for message
     C                   IF        YL0007 = 0
     C                   Z-ADD     YL0007        ZA0008                         Load ID
      * Send message 'Load Id is not found'
     C                   MOVEL     'USR2783'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
      * RTV Manifest Detail PFSRT - Order Detail  * 
     C                   EXSR      SFRVGN
      * Show error if manifest detail is not found
      * CASE: LCL.USR Return Code is Does Not Exist
      * Send message 'Manifest Detail        NF'
     C                   IF        YL0013 = 'N'
     C                   MOVEL     'USR1196'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   GOTO      DBEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END
      * Bypass ref file checks if error already detected
     C   99              GOTO      DBEXIT
      * Company Number required
     C                   IF        #DAIC3 = *ZERO AND
     C                             YPMTFD = ' '
     C                   SETON                                        9931      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      * Order Number required
     C                   IF        #DC4NB = *ZERO AND
     C                             YPMTFD = ' '
     C                   SETON                                        9932      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      *================================================================
     CSR   DBEXIT        ENDSR
      /EJECT
     CSR   DHPMCF        BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                   EXSR      MNCV#1
      * Update screen time
     C                   TIME                    ##TME
      * Refresh screen
     C                   EVAL      ##CFCD = ' '
     C                   MOVEL     'N'           ##CFCD
      * Save CMD keys
     C                   MOVEA     *IN           WN30
     C                   SETOFF                                       29        *
      * Generate internal/external key list
     C     KINEX         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2INVL
      * Convert *CONFIRM to external value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2INVL = ' '
     C                   MOVEL     ##CFCD        Y2INVL                         *CONFIRM
     C     KINEX         CHAIN     @Y2INEX                            90        *
     C  N90              MOVEL     Y2EXVL        V#CFCD                         *CONFIRM
      *
     C                   DOU       W0HLP = 'N' AND
     C                             NOT *IN29
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   WRITE     #RCDDTL1
     C                   EXFMT     #CONFIRM
     C                   IF        *IN29
     C                   SETON                                        99
     C                   GOTO      DHEXIT
     C                   END
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
      * Validate *CONFIRM
     C                   EVAL      W0RTN = ' '
     C                   MOVEL     V#CFCD        W0NSRQ                         *CONFIRM
      * Name search required?
     C                   IF        W0NSRQ = '?' OR
     C                             'V#CFCD' = YPMTFD
     C                   CALL      'CAVLLSR'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1001713       Y2LSNO
     C     V#CFCD        PARM      V#CFCD        W0EXVL                         *CONFIRM
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   IF        W0NSRQ <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
     C                   END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C     KEXIN         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2EXVL
      * Convert *CONFIRM to internal value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2EXVL = ' '
     C                   MOVEL     V#CFCD        Y2EXVL                         *CONFIRM
     C     KEXIN         CHAIN     @Y2EXIN                            90        *
     C                   IF        *IN90
     C                   EVAL      ##CFCD = ' '
     C                   IF        YPMTFD = ' '
     C                   SETON                                        96        *
     C                   WRITE     #CONFIRM
     C                   SETOFF                                       96        *
     C                   END
     C                   ELSE
     C                   MOVEL     Y2INVL        ##CFCD                         *CONFIRM
     C                   END
      *
     C   90              SETON                                        29        *
     C  N90              SETOFF                                       29        *
     C                   END
      * Restore CMD keys
     C                   MOVEA     WN30          *IN
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   IF        ##CFCD = 'Y'
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   END
     C     ##CFCD        COMP      'Y'                                9999      *
      * Not confirmed
      *================================================================
     CSR   DHEXIT        ENDSR
      /EJECT
     CSR   MALDSC        BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                   Z-ADD     *ZERO         #DN0DT                         Date In  (7,0)
     C                   Z-ADD     *ZERO         #DKCDT                         Date In
     C                   Z-ADD     *ZERO         #DO6NB                         Number of Days
     C                   Z-ADD     *ZERO         #DAIC3                         Company Number
      * Clear external version also
     C                   EVAL      VDAIC3 = ' '
     C                   Z-ADD     *ZERO         #DC4NB                         Order Number
      * Clear external version also
     C                   EVAL      VDC4NB = ' '
      * USER: Load screen
     C                   Z-ADD     360           #DAIC3                         Company Number
      *================================================================
     CSR   MAEXIT        ENDSR
      /EJECT
     CSR   MNCV#1        BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C                   IF        #DAIC3 <> 0
     C                   EVAL      WUDMCD = ' '                                 CD3 Ext Numeric
     C                   MOVEL     #DAIC3        WUDMCD                         CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUDMCD        #L3                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        3
     C     #L3(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L3(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L3           WUDMCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUDMCD        VDAIC3                         CD3 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VDAIC3 = ' '                                 CD3 Ext Numeric
     C                   END                                                    *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        #DC4NB <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     #DC4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        VDC4NB                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VDC4NB = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      *================================================================
     CSR   MNEXIT        ENDSR
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Val Company Number    RT - Company Name and Address  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WAAIC3                         Company Number
      * Setup key
     C                   Z-ADD     #DAIC3        WAAIC3                         Company Number
      * Establish starting position
     C     KRSSA         CHAIN     @ABREAK                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0003'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'N'           YL0005                         Record Found US
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   MOVEL     'Y'           YL0005                         Record Found US
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Val Order Hdr Exists   RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
      * Setup key
     C                   Z-ADD     #DAIC3        WBAIC3                         Company Number
     C                   Z-ADD     #DC4NB        WBC4NB                         Order Number
      * Establish starting position
     C     KRSSB         CHAIN     @BECPFK                            90        *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
      * Setup key
     C                   Z-ADD     #DAIC3        WBAIC3                         Company Number
     C                   Z-ADD     #DC4NB        WBC4NB                         Order Number
      * Establish starting position
     C     KRSSC         CHAIN     @BECPFK                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0176'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0002                         Actual Shipped
     C                   EVAL      YL0006 = ' '                                 Header Status
     C                   Z-ADD     *ZERO         YL0003                         Scheduled Ship
     C                   Z-ADD     *ZERO         YL0007                         Load ID
     C                   EVAL      YL0008 = ' '                                 Block Order Fla
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WBGNDT        YL0002                         Actual Shipped
     C                   MOVEL     WBGWST        YL0006                         Header Status
     C                   Z-ADD     WBAODT        YL0003                         Scheduled Ship
     C                   Z-ADD     WBRMNB        YL0007                         Load ID
     C                   MOVEL     WBBCST        YL0008                         Block Order Fla
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * RTV 1st Whse/Country   RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSD         KLIST
     C                   KFLD                    WQSD01                         Company Number
     C                   KFLD                    WQSD02                         Order Number
     C                   KFLD                    WCDPNB                         Order Sequence
     C                   KFLD                    WCUENB                         Order Secondary
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WQSD01                         Company Number
     C                   KFLD                    WQSD02                         Order Number
      * Setup key
     C                   Z-ADD     #DAIC3        WQSD01                         Company Number
     C                   Z-ADD     #DC4NB        WQSD02                         Order Number
     C                   Z-ADD     1             WCDPNB                         Order Sequence
     C                   Z-ADD     1             WCUENB                         Order Secondary
      * Establish starting position
     C     KPSSD         SETLL     @BGWKAE                                      *
     C     KRSSD         READE     @BGWKAE                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WCAJCD        YL0009                         Warehouse Code
     C                   MOVEL     WCKXCD        YL0010                         Country Code
     C                   GOTO      SDEXIT                                       *QUIT
     C     KRSSD         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * Rtv EDI 856 ASN Info RT - Warehouse Codes  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WDAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     YL0009        WDAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSE         CHAIN     @ADREAO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0011 = ' '                                 Warehouse Locat
     C                   EVAL      YL0012 = ' '                                 WHS Live with C
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WDT0ST        YL0011                         Warehouse Locat
     C                   MOVEL     WDRRSX        YL0012                         WHS Live with C
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * RTV Manifest Detail PFSRT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0013                         USR Return Code
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WQSF01                         Company Number
     C                   KFLD                    WQSF02                         Order Number
      * Setup key
     C                   Z-ADD     #DAIC3        WQSF01                         Company Number
     C                   Z-ADD     #DC4NB        WQSF02                         Order Number
      * Establish starting position
     C     KRSSF         SETLL     @BGWKL1                                      *
     C     KRSSF         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * PFS Rtv Total Shipped RT - Manifest Detail  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SGRVGN
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   MOVEL     'E'           YL0013                         USR Return Code
     C                   GOTO      SFEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSF         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * PFS Rtv Total Shipped RT - Manifest Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0014                         Quantity Shippe
     C                   Z-ADD     *ZERO         YL0015                         Weight Shipped
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WQSG01                         Company Number
     C                   KFLD                    WQSG02                         Order Number
     C                   KFLD                    WQSG03                         Order Sequence
     C                   KFLD                    WQSG04                         Order Secondary
      * Setup key
     C                   Z-ADD     WEAIC3        WQSG01                         Company Number
     C                   Z-ADD     WEC4NB        WQSG02                         Order Number
     C                   Z-ADD     WEDPNB        WQSG03                         Order Sequence
     C                   Z-ADD     WEUENB        WQSG04                         Order Secondary
      * Establish starting position
     C     KRSSG         SETLL     @FNCPCT                                      *
     C     KRSSG         READE     @FNCPCT                                90    *
      * Data record not found
     C   90              MOVEL     'USR1196'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   ADD       WFFOQT        YL0014                         Quantity Shippe
     C                   ADD       WFR0NB        YL0015                         Weight Shipped
     C     KRSSG         READE     @FNCPCT                                90    *
     C                   ENDDO
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    WGAJVN                         User Profile Na
      * Setup key
     C                   MOVEL     WN0001        WGAJVN                         User Profile Na
      * Establish starting position
     C     KRSSH         CHAIN     @DRRETH                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0763'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WGI6ST        YL0017                         Allow Multi_Com
     C                   MOVEL     WGMPNA        YL0018                         Default Printer
     C                   MOVEL     WGBCCD        WUBCCD                         Salesperson Cod
     C                   Z-ADD     WGAIC3        YL0019                         Company Number
     C                   MOVEL     WGBUVN        WN0002                         User Code Model
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    WHAJVN                         User Profile Na
     C                   KFLD                    WHDNCD                         Application Cod
      * Setup key
     C                   MOVEL     WL0001        WHAJVN                         User Profile Na
     C                   MOVEL     WL0002        WHDNCD                         Application Cod
      * Establish starting position
     C     KRSSI         CHAIN     @DTRETE                            90        *
      * Data record not found
     C   90              MOVEL     'USR0767'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WHAIC3        WL0003                         Company Number
     C                   MOVEL     WHAJCD        WL0004                         Warehouse Code
     C                   ENDIF
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    WQSJ01                         Application Cod
      * Setup key
     C                   EVALR     WQSJ01 = ' '                                 Application Cod
     C                   MOVEL     'OMS'         WQSJ01                         Application Cod
      * Establish starting position
     C     KRSSJ         SETLL     @DNRESF                                      *
     C     KRSSJ         READE     @DNRESF                                90    *
      * Data record not found
     C   90              MOVEL     'USR0755'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C                   DOW       NOT *IN90
      * PAR = DB1 By name
     C                   IF        WIRSCD = ' '
     C                   MOVEL     WIAUNA        WUAUNA                         Description
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                   EXSR      SKRVGN
     C                   END                                                    *FI
     C     KRSSJ         READE     @DNRESF                                90    *
     C                   ENDDO
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WQSK01                         Application Cod
      * Setup key
     C                   MOVEL     WIRSCD        WQSK01                         Application Cod
      * Establish starting position
     C     KRSSK         SETLL     @DNRESF                                      *
     C     KRSSK         READE     @DNRESF                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0755'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WUAUNA = ' '                                 Description
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SKEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WIAUNA        WUAUNA                         Description
     C     KRSSK         READE     @DNRESF                                90    *
     C                   ENDDO
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * *****
      * 07/22/2025 JM WI642_1
      * ** Validate order and simulate shipping using this screen,
      * ** it will be similar to order shipped from Carlisle.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   XDVC2T        BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                   Z-ADD     0             XDEX01                         CC
     C                   IF        XDDTFM = 'DMY'
     C                   Z-ADD     XDINDD        XDEX02                         DD
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
     C                   IF        XDDTFM = 'MDY'
     C                   Z-ADD     XDINMM        XDEX02                         MM
     C                   Z-ADD     XDINDD        XDEX03                         DD
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
      * YMD format
     C                   Z-ADD     XDINYY        XDEX02                         YY
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINDD        XDEX04                         DD
     C                   END
     C                   END
      *================================================================
     CSR   XDVC2E        ENDSR
      /EJECT
     CSR   Y0SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y0EXIT        ENDSR
      /EJECT
     CSR   Y8TST         BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
      *================================================================
     CSR   Y8EXIT        ENDSR
      /EJECT
     CSR   Y9CLR         BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y9EXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZDVPMT        BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                   EVAL      YPMTFD = ' '
     C                   Z-ADD     *ZERO         YAFSCH
     C                   Z-ADD     *ZERO         YPMRRN
      *
      *
      * Extract cursor row and column
     C                   IF        *IN04
     C     @#RWCL        DIV       256           ZHCSRW
     C                   MVR                     ZHCSCL
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      * Error if user defined prompting is not specified.
     C                   IF        YPMTFD = ' '
     C                   IF        W0PMT = 'N'
     C                   MOVEL     '*NONE'       YPMTFD
     C                   MOVEL     'Y'           W0HLP
     C                   MOVEL     'Y'           ZAFSMS
      * Send error message.
     C                   MOVEL     'Y2U0101'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *
     C                   END
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZHHPKY        BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                   MOVEL     'Y'           W0HLP
      *
      * Extract cursor row and column
     C     @#RWCL        DIV       256           ZHCSRW                         Row
     C                   MVR                     ZHCSCL                         Column
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      *
     C                   CALL      'YDDSHPR'
     C                   PARM      ##PGM         W0HPMB                         Help text sourc
     C                   PARM      *BLANK        YYHPFL                         Help text file
     C                   PARM      *BLANK        YYHPLB                         Help text libra
     C                   PARM                    W0RTN
     C                   PARM      '*CSRLOC'     YYHLVN                         Help label
     C                   PARM      '*NORMAL'     YYUSOP                         Options
     C                   PARM      ZHCSRW        YYRW                           Row
     C                   PARM      ZHCSCL        YYCL                           Column
     C                   PARM      *ZERO         YYLGCT                         # of grps
     C                   PARM      *BLANK        YYLGVN                         Label grps
      *
      * Clear set cursor DDS indicator
     C  N94              MOVEL     'OFF'         WCSRLC
     C  N94              SETON                                        94        *
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Define work field USR First Position
     C                   EVAL      WUI3ST = ' '
      * Define work field CD3 Ext Numeric Key
     C                   EVAL      WUDMCD = ' '
      * Define work field CD7 Ext Numeric Key
     C                   EVAL      WUEOCD = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WBBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WBB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WBA0DT                         Order Date
     C                   Z-ADD     *ZERO         WBA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WBGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WBACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WBAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WBCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WBJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WBA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WBEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WBAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WBR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WBRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WBATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WBRSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WBT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WBCONB                         Invoice Number
     C                   Z-ADD     *ZERO         WBAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WBVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WBB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WBNODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBNPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WBNQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WBNRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBNSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WBBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WBBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WBH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WBH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WBH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WBH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WBC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCC4NB                         Order Number
     C                   Z-ADD     *ZERO         WCDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WCUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WCHGCD                         Item Code
     C                   Z-ADD     *ZERO         WCBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WCCFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WCMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WCKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WCL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WCL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WCAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WCEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WCBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WCL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WCGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WCR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WCAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WCD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WCCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WCAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WCCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WCATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WCAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WCAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WCAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WCALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WCAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WCAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WCA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WCA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WCAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WCGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WCRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRINB                         Item Structure
     C                   Z-ADD     *ZERO         WCCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WCDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WCB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WCA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WCNTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WCNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WCNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WCNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WCNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WCBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WCBVTM                         Price Code
     C                   Z-ADD     *ZERO         WCBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WCBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WCBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WCH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WCH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WCH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WCH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WCH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WCDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WCDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WCDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WCDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WCDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WCGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WCGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WCGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WCPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WCRINY                         Item Age Days
     C                   Z-ADD     *ZERO         WCTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WCTJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WCTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WCTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WCTMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDDBNB                         Warehouse Chill
     C                   Z-ADD     *ZERO         WDBWC3                         Shipping Compan
     C                   Z-ADD     *ZERO         WDBTC3                         Accounting Comp
     C                   Z-ADD     *ZERO         WDBUC3                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WDBVC3                         WHS Inventory C
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFAIC3                         Company Number
     C                   Z-ADD     *ZERO         WFC4NB                         Order Number
     C                   Z-ADD     *ZERO         WFDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WFUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WFRZNB                         Case Sequence N
     C                   Z-ADD     *ZERO         WFFOQT                         Case Quantity
     C                   Z-ADD     *ZERO         WFR0NB                         Case Weight
     C                   Z-ADD     *ZERO         WFK7DT                         Label Date
     C                   Z-ADD     *ZERO         WFPFNX                         PT Serial Numbe
     C                   Z-ADD     *ZERO         WFHGCD                         Item Code
     C                   Z-ADD     *ZERO         WFELDT                         Production Date
     C                   Z-ADD     *ZERO         WFN5WG                         Manifest Gross
     C                   Z-ADD     *ZERO         WFH5NY                         Manifest Total
     C                   Z-ADD     *ZERO         WFH6NY                         Manifest Co_Par
     C                   Z-ADD     *ZERO         WFH7NY                         Manifest Pallet
     C                   Z-ADD     *ZERO         WFN6WG                         HPB Meter Net G
     C                   Z-ADD     *ZERO         WFN7WG                         Manifest Net We
     C                   Z-ADD     *ZERO         WFRBDT                         Manifest Unused
     C                   Z-ADD     *ZERO         WFITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WFIVNY                         HPB Meter Start
     C                   Z-ADD     *ZERO         WFIUNY                         HPB Meter Endin
     C                   Z-ADD     *ZERO         WFIWNY                         HPB Meter Total
     C                   Z-ADD     *ZERO         WFIXNY                         HPB Meter Net W
     C                   Z-ADD     *ZERO         WFIYNY                         HPB Density Ref
     C                   Z-ADD     *ZERO         WFAATM                         Job Time
     C                   Z-ADD     *ZERO         WFAXDT                         Job Date
     C                   Z-ADD     *ZERO         WFLPNZ                         Manifest Pallet
      * Define work field Salesperson Code
     C                   EVAL      WUBCCD = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGNLNB                         Entity Number
     C                   Z-ADD     *ZERO         WGAIC3                         Company Number
     C                   Z-ADD     *ZERO         WGAATM                         Job Time
     C                   Z-ADD     *ZERO         WGAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WHAIC3                         Company Number
     C                   Z-ADD     *ZERO         WHAATM                         Job Time
     C                   Z-ADD     *ZERO         WHAXDT                         Job Date
      * Define work field Description
     C                   EVAL      WUAUNA = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WIAATM                         Job Time
     C                   Z-ADD     *ZERO         WIAXDT                         Job Date
      * Define work field USR Description 40
     C                   EVAL      WUDSC4 = ' '
      * Define work field USR Description 40   2
     C                   EVAL      WUDE40 = ' '
      * Flag no *SET CURSOR in the program
     C                   MOVE      'N'           YSETCS
     C                   EVALR     WCSRLC = ' '
      * Define *Synon program work fields
     C                   EVAL      W0CFL = ' '                                  *Cursor field
     C                   Z-ADD     *ZEROS        W0CRW                          *Cursor row
     C                   Z-ADD     *ZEROS        W0CCL                          *Cursor column
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   MOVE      ZZFFL         @1FFL
     C                   MOVE      ZZFLB         @1FLB
     C                   MOVE      ZZFMB         @1FMB
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      *
     C                   EVAL      W0SJO = ' '                                  *Sbmjob overrid
      * Define local variables for subroutine SIRVGN.
     C                   EVAL      WL0001 = ' '
     C                   EVAL      WL0002 = ' '
     C                   Z-ADD     *ZERO         WL0003
     C                   EVAL      WL0004 = ' '
      * Define local work field Access Denied (Y/N)
     C                   EVAL      YL0001 = ' '
      * Define local work field Actual Shipped Date
     C                   Z-ADD     *ZERO         YL0002
      * Define local work field Scheduled Ship Date
     C                   Z-ADD     *ZERO         YL0003
      * Define local work field Jobq
     C                   EVAL      YL0004 = ' '
      * Define local work field Record Found USR
     C                   EVAL      YL0005 = ' '
      * Define null work field Order Type_Sales
     C                   EVAL      YN0001 = ' '
      * Define null work field AR Customer Number
     C                   Z-ADD     *ZERO         YN0002
      * Define null work field Ship To Customer
     C                   Z-ADD     *ZERO         YN0003
      * Define null work field Ship To Name
     C                   EVAL      YN0004 = ' '
      * Define null work field Ship To Address Line 1
     C                   EVAL      YN0005 = ' '
      * Define null work field Ship To Address Line 2
     C                   EVAL      YN0006 = ' '
      * Define null work field Ship To Address Line 3
     C                   EVAL      YN0007 = ' '
      * Define null work field Ship To City
     C                   EVAL      YN0008 = ' '
      * Define null work field Ship To State Code
     C                   EVAL      YN0009 = ' '
      * Define null work field Ship To Zip_Postal Code
     C                   EVAL      YN0010 = ' '
      * Define null work field Bill to Customer
     C                   Z-ADD     *ZERO         YN0011
      * Define null work field Bill to Name
     C                   EVAL      YN0012 = ' '
      * Define null work field Bill to Address Line 1
     C                   EVAL      YN0013 = ' '
      * Define null work field Bill to Address Line 2
     C                   EVAL      YN0014 = ' '
      * Define null work field Bill to Address Line 3
     C                   EVAL      YN0015 = ' '
      * Define null work field Bill to City
     C                   EVAL      YN0016 = ' '
      * Define null work field Bill to State Code
     C                   EVAL      YN0017 = ' '
      * Define null work field Bill to Zip_Postal Code
     C                   EVAL      YN0018 = ' '
      * Define null work field Customer Purchase Order #
     C                   EVAL      YN0019 = ' '
      * Define null work field Order Date
     C                   Z-ADD     *ZERO         YN0020
      * Define null work field Requested Ship Date
     C                   Z-ADD     *ZERO         YN0021
      * Define null work field Cancel Date
     C                   Z-ADD     *ZERO         YN0022
      * Define null work field Terms Code
     C                   EVAL      YN0023 = ' '
      * Define null work field Special Instructions
     C                   EVAL      YN0024 = ' '
      * Define null work field Special Instructions 2
     C                   EVAL      YN0025 = ' '
      * Define null work field Carrier Code
     C                   EVAL      YN0026 = ' '
      * Define null work field Comment Print Acknowledge
     C                   EVAL      YN0027 = ' '
      * Define null work field Comment Print Inv_Cr_Memo
     C                   EVAL      YN0028 = ' '
      * Define null work field Comment Print Pick Slip
     C                   EVAL      YN0029 = ' '
      * Define null work field Comment Print Ship Doc
     C                   EVAL      YN0030 = ' '
      * Define null work field Reason Code
     C                   EVAL      YN0031 = ' '
      * Define null work field Order in Use
     C                   EVAL      YN0032 = ' '
      * Define local work field Header Status
     C                   EVAL      YL0006 = ' '
      * Define null work field Header Status Last
     C                   EVAL      YN0033 = ' '
      * Define null work field Order Type Print Status
     C                   EVAL      YN0034 = ' '
      * Define null work field User Original Entry
     C                   EVAL      YN0035 = ' '
      * Define null work field Date of Original Entry
     C                   Z-ADD     *ZERO         YN0036
      * Define null work field Order Value Total
     C                   Z-ADD     *ZERO         YN0037
      * Define null work field Order Weight Total
     C                   Z-ADD     *ZERO         YN0038
      * Define null work field Credit Hold
     C                   EVAL      YN0039 = ' '
      * Define null work field Production Hold
     C                   EVAL      YN0040 = ' '
      * Define null work field New Customer Hold
     C                   EVAL      YN0041 = ' '
      * Define null work field Requested Delivery Date
     C                   Z-ADD     *ZERO         YN0042
      * Define null work field Requested Delivery Time
     C                   Z-ADD     *ZERO         YN0043
      * Define null work field Accounts Receiv_Ent 1
     C                   EVAL      YN0044 = ' '
      * Define null work field Accounts Receiv_Ent 2
     C                   EVAL      YN0045 = ' '
      * Define local work field Load ID
     C                   Z-ADD     *ZERO         YL0007
      * Define null work field Absorbed Freight Rate CWT
     C                   Z-ADD     *ZERO         YN0046
      * Define null work field Rated Freight
     C                   Z-ADD     *ZERO         YN0047
      * Define null work field LTL Flag
     C                   EVAL      YN0048 = ' '
      * Define null work field Price Audit
     C                   EVAL      YN0049 = ' '
      * Define null work field Price Status
     C                   EVAL      YN0050 = ' '
      * Define null work field Shipping Method
     C                   EVAL      YN0051 = ' '
      * Define null work field Export Status
     C                   EVAL      YN0052 = ' '
      * Define null work field Palletize
     C                   EVAL      YN0053 = ' '
      * Define null work field Shrink Wrap
     C                   EVAL      YN0054 = ' '
      * Define null work field Slip Sheet
     C                   EVAL      YN0055 = ' '
      * Define null work field Age Code
     C                   EVAL      YN0056 = ' '
      * Define null work field Reefer Temperature
     C                   Z-ADD     *ZERO         YN0057
      * Define null work field Load Type
     C                   EVAL      YN0058 = ' '
      * Define null work field Attach to Invoice Number
     C                   Z-ADD     *ZERO         YN0059
      * Define null work field Load Plan Order
     C                   EVAL      YN0060 = ' '
      * Define null work field Print Pick Slip
     C                   EVAL      YN0061 = ' '
      * Define null work field Resell Reference Number
     C                   Z-ADD     *ZERO         YN0062
      * Define null work field Special Comment 1
     C                   EVAL      YN0063 = ' '
      * Define null work field Special Comment 2
     C                   EVAL      YN0064 = ' '
      * Define null work field Affect Auto Accruals
     C                   EVAL      YN0065 = ' '
      * Define null work field Sales Route Code
     C                   EVAL      YN0066 = ' '
      * Define null work field Manager Level Code
     C                   EVAL      YN0067 = ' '
      * Define null work field VP Level Code
     C                   EVAL      YN0068 = ' '
      * Define null work field Attach to Order Number
     C                   Z-ADD     *ZERO         YN0069
      * Define null work field Reason for Price Audit
     C                   EVAL      YN0070 = ' '
      * Define null work field Invoice Number
     C                   Z-ADD     *ZERO         YN0071
      * Define null work field Invoice Suffix
     C                   EVAL      YN0072 = ' '
      * Define null work field Invoice Date
     C                   Z-ADD     *ZERO         YN0073
      * Define null work field Event Code
     C                   EVAL      YN0074 = ' '
      * Define null work field Trans Contol AS400_Plant
     C                   EVAL      YN0075 = ' '
      * Define null work field Modified Flag
     C                   EVAL      YN0076 = ' '
      * Define null work field A_R order Value Total
     C                   Z-ADD     *ZERO         YN0077
      * Define null work field Billing Activity Type
     C                   EVAL      YN0078 = ' '
      * Define local work field Block Order Flag
     C                   EVAL      YL0008 = ' '
      * Define null work field Order Certification Flag
     C                   EVAL      YN0079 = ' '
      * Define null work field Invoice Order Value Tot
     C                   Z-ADD     *ZERO         YN0080
      * Define null work field Process Sts for 3C
     C                   EVAL      YN0081 = ' '
      * Define null work field Order Conf Fax Sts
     C                   EVAL      YN0082 = ' '
      * Define null work field Manifest Fax Sts
     C                   EVAL      YN0083 = ' '
      * Define null work field Invoice Fax Sts
     C                   EVAL      YN0084 = ' '
      * Define null work field Transfer in Storage Ind
     C                   EVAL      YN0085 = ' '
      * Define null work field Email Cust On Order Ship
     C                   EVAL      YN0086 = ' '
      * Define null work field Order Emailed
     C                   EVAL      YN0087 = ' '
      * Define null work field Export Docs Go w_Driver
     C                   EVAL      YN0088 = ' '
      * Define null work field Shipping Temp Code C_F
     C                   EVAL      YN0089 = ' '
      * Define null work field Broker Order Status
     C                   EVAL      YN0090 = ' '
      * Define null work field Air Freight Order
     C                   EVAL      YN0091 = ' '
      * Define null work field Order Requires Review
     C                   EVAL      YN0092 = ' '
      * Define null work field OH Load Plan Ready
     C                   EVAL      YN0093 = ' '
      * Define null work field Export USDA Approved
     C                   EVAL      YN0094 = ' '
      * Define null work field HPB Ship to Warehouse
     C                   EVAL      YN0095 = ' '
      * Define null work field OH TF Exempt Code
     C                   EVAL      YN0096 = ' '
      * Define null work field OH Appt Confirmation Dt
     C                   Z-ADD     *ZERO         YN0097
      * Define null work field JPN Invoice Issuance Date
     C                   Z-ADD     *ZERO         YN0098
      * Define null work field Load Actual Shipped Date
     C                   Z-ADD     *ZERO         YN0099
      * Define null work field Load BOL Complete Date
     C                   Z-ADD     *ZERO         YN0100
      * Define null work field Load Truck Departure Date
     C                   Z-ADD     *ZERO         YN0101
      * Define null work field Maximum Gross Weight
     C                   Z-ADD     *ZERO         YN0102
      * Define null work field Time of Original Entry
     C                   Z-ADD     *ZERO         YN0103
      * Define null work field OH Appt Confirmation Tm
     C                   Z-ADD     *ZERO         YN0104
      * Define null work field Load BOL Complete Time
     C                   Z-ADD     *ZERO         YN0105
      * Define null work field Load Truck Departure Time
     C                   Z-ADD     *ZERO         YN0106
      * Define null work field Act Frt Reference Amount
     C                   Z-ADD     *ZERO         YN0107
      * Define null work field Act Non_Ref Frt Amount
     C                   Z-ADD     *ZERO         YN0108
      * Define null work field OH Fuel Surcharge Amount
     C                   Z-ADD     *ZERO         YN0109
      * Define null work field OH Total Non_Ref Frt Amt
     C                   Z-ADD     *ZERO         YN0110
      * Define null work field OH Total Ref Frt Amt
     C                   Z-ADD     *ZERO         YN0111
      * Define null work field Claim Number
     C                   Z-ADD     *ZERO         YN0112
      * Define null work field EDI Status 1
     C                   EVAL      YN0113 = ' '
      * Define null work field EDI Status 2
     C                   EVAL      YN0114 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0115 = ' '
      * Define null work field Job Time
     C                   Z-ADD     *ZERO         YN0116
      * Define null work field User Id
     C                   EVAL      YN0117 = ' '
      * Define null work field Job Name
     C                   EVAL      YN0118 = ' '
      * Define null work field Job Date
     C                   Z-ADD     *ZERO         YN0119
      * Define local work field Warehouse Code
     C                   EVAL      YL0009 = ' '
      * Define local work field Country Code
     C                   EVAL      YL0010 = ' '
      * Define local work field Warehouse Location
     C                   EVAL      YL0011 = ' '
      * Define local work field WHS Live with Carlisle
     C                   EVAL      YL0012 = ' '
      * Define null work field WHS PFS Interface
     C                   EVAL      YN0120 = ' '
      * Define null work field Crt 856 ASN for 3PL Whse
     C                   EVAL      YN0121 = ' '
      * Define local work field USR Return Code
     C                   EVAL      YL0013 = ' '
      * Define local work field Quantity Shipped Total
     C                   Z-ADD     *ZERO         YL0014
      * Define local work field Weight Shipped Total
     C                   Z-ADD     *ZERO         YL0015
      * Define local work field Company Number
     C                   Z-ADD     *ZERO         YL0016
      * Define local work field Allow Multi_Company
     C                   EVAL      YL0017 = ' '
      * Define local work field Default Printer
     C                   EVAL      YL0018 = ' '
      * Define local work field Company Number
     C                   Z-ADD     *ZERO         YL0019
      * Define local work field Warehouse Code
     C                   EVAL      YL0020 = ' '
      * Obtain system date format
     C     *DTAARA       DEFINE    Y2DTFMA       XDDTFM
     C                   IN        XDDTFM
      * *DTAARA = *COMPANY N
     C     *DTAARA       DEFINE    YYCOTXA       ##CMP
     C                   IN        *DTAARA
      *................................................................
     C                   EVAL      W0GRP = ' '
      * USER: Initialize program
      * ***** Change Log and comments
     C                   EXSR      UASUBR                                       ***** Change Lo
      *
     C                   EVAL      WN0001 = ' '                                 User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                   MOVEL     ##USR         WN0001                         User Profile Na
      *
     C                   EVAL      WN0002 = ' '                                 User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                   EXSR      SHRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
      * SET Message Queue Dest US - /UT User Source  * 
     C                   IF        W0RTN = @CN(003)
     C                   MOVEL     '*PRV '       ZAPGRL                         PREVIOUS
      * Setup message data for message
     C                   MOVEL     WN0001        ZA0009                         User Profile Na
     C                   MOVEL     'OMS'         ZA0010                         Application Cod
      * Send message 'Application access denied'
     C                   MOVEL     'USR0810'     ZAMSID
     C                   MOVEL     '*PRV '       ZAPGRL                         Rel queue
     C                   MOVEL     '*COMP  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   MOVEL     'Y2U9999'     P0RTN                          *Return code
     C                   EXSR      ZYEXPG
     C                   END                                                    *FI
      * CASE: PAR.User Code Model is equal to blank
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WN0002 = ' '
     C                   MOVEL(P)  WN0001        WL0001                         User Profile Na
     C                   MOVEL(P)  'OMS'         WL0002                         Application Cod
     C                   EXSR      SIRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0003        YL0016                         Company Number
     C                   MOVEL(P)  WL0004        YL0020                         Warehouse Code
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  WN0002        WL0001                         User Profile Na
     C                   MOVEL(P)  'OMS'         WL0002                         Application Cod
     C                   EXSR      SIRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0003        YL0016                         Company Number
     C                   MOVEL(P)  WL0004        YL0020                         Warehouse Code
     C                   END                                                    *FI
     C                   MOVEL     YL0020        YL0009                         Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                   MOVEL     '*PRV '       ZAPGRL                         PREVIOUS
      * Setup message data for message
     C                   MOVEL     WN0001        ZA0011                         User Profile Na
     C                   MOVEL     'OMS'         ZA0012                         Application Cod
      * Send message 'Application access denied'
     C                   MOVEL     'USR0810'     ZAMSID
     C                   MOVEL     '*PRV '       ZAPGRL                         Rel queue
     C                   MOVEL     '*COMP  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   MOVEL     'Y2U9999'     P0RTN                          *Return code
     C                   EXSR      ZYEXPG
     C                   END                                                    *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C                   IF        YL0019 <> 0
     C                   Z-ADD     YL0019        YL0016                         Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                   IF        YL0020 <> ' '
     C                   CALL      'PNKDXFR'                            90      RTV Prod Whse f
     C                   PARM      *BLANK        W0RTN
     C     YL0009        PARM      *BLANK        WQ0001                         Warehouse Code
     C                   PARM      YL0019        WQ0002                         Shipping Compan
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNKDXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                   EXSR      SJRVGN
     C                   EVAL      WUDSC4 = ' '                                 USR Description
     C                   MOVEL     WUAUNA        WUDSC4                         USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                   MOVEA     WUDSC4        UCT                            LOAD ARRAY
     C                   Z-ADD     40            UX                2 0          SET COUNTER
     C     UX            DOWGT     0
     C     UCT(UX)       IFEQ      ' '
     C                   SUB       1             UX
     C                   ELSE
     C                   Z-ADD     UX            UXH               2 0
     C                   Z-ADD     0             UX
     C                   END
     C                   END
     C     40            SUB       UXH           UX
     C     UX            DIV       2             UX
     C     UX            IFGT      0
     C                   MOVE      *BLANKS       UCT
     C                   MOVEA     WUDSC4        UCT(UX)
     C                   END
     C                   MOVEA     UCT           WUDE40                         LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                   MOVE      WUDE40        ##CMP            40
      * Load screen
     C                   EXSR      MALDSC
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 SHIPPFSORD
00002 USR0752
00003 Y2U0005
