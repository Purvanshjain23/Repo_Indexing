     H/TITLE PRT Fix Consignee Addr XF Print file
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Print file
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 01/22/25  Time  : 09:54:13
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMRREL1  IF   E           K DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPVJEPFR$  O    E             PRINTER OFLIND(*IN97)
     F                                     INFDS(INFDS$)
      * PRT: PRT Fix Consignee Addr XF Print file
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D INFDS$        E DS                  EXTNAME(Y2I$DSP)
      * Printer file information data structure
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0PFM          S              1
     D  @$WRK          S              4  0
     D  @$HDL          S              4  0
     D  W0PGL          S              4  0
     D  W0OFL          S              4  0
     D  W0NEWP         S              1
     D  W0FSUM         S                   LIKE(@$CLN)
     D  W0DTLN         S                   LIKE(@$CLN)
     D  W0COLN         S                   LIKE(@$CLN)
     D  WQKA01         S                   LIKE(MRAIC3)
     D  WQKA02         S                   LIKE(MRC4NB)
     D  WQKA03         S                   LIKE(MRDGSX)
     D  WQKA04         S                   LIKE(MRKXCD)
     D  W0AL1P         S              1
     D  W0AL00         S              1
     D  W0AL01         S              1
     D  W0AL02         S              1
     D  W0AP1P         S              1
     D  W0AP00         S              1
     D  WUDMCD         S              3
     D  W0AP01         S              1
     D  W0AP02         S              1
     D  W0APDT         S              1
     D  W0ACDT         S              1
     D  WUEOCD         S              7
     D  WZA001         S                   LIKE(MRAIC3)
     D  WZA002         S                   LIKE(MRC4NB)
     D  WZA003         S                   LIKE(MRDGSX)
     D  W0EOFA         S              1
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  @1FFL          S             10
     D  @1FLB          S             10
     D  @1FMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
     D #L3             S              1    DIM(3)
     D #L7             S              1    DIM(7)
      /EJECT
      * Parameter declarations
     D P1PARM          DS          3848
      * RCD: Export Doc Order Hdr      Retrieval index
      * I : RST Company Number
     D  P1AIC3                 1      2P 0
      * I : RST Order Number
     D  P1C4NB                 3      6P 0
      * I : RST ED Export Document Type
     D  P1DGSX                 7      7
      * I : RST Country Code
     D  P1KXCD                 8     13
      * I :  ED Consignee Addr 3
     D  P1SCTX               581    643
      * I :  ED Consignee Addr 4
     D  P1SDTX               644    706
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Export Doc
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * PRT Fix Consignee Addr XF: Mainline
     C                   EXSR      A0MAIN
      * Print headers then End of report format
     C                   EXSR      Q0PRNT
     C                   WRITE     $GENDRPT
      * Exit program
     C                   EXSR      ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR   A0MAIN        BEGSR
      *================================================================
      * PRT Fix Consignee Addr XF: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KRSA          KLIST
     C                   KFLD                    WQKA01                         Company Number
     C                   KFLD                    WQKA02                         Order Number
     C                   KFLD                    WQKA03                         ED Export Docum
     C                   KFLD                    WQKA04                         Country Code
      * Setup key
     C                   Z-ADD     P1AIC3        WQKA01                         Company Number
     C                   Z-ADD     P1C4NB        WQKA02                         Order Number
     C                   MOVEL     P1DGSX        WQKA03                         ED Export Docum
     C                   MOVEL     P1KXCD        WQKA04                         Country Code
      * Establish starting position
     C     KRSA          SETLL     @MRREWT                                      *
      * Read first record with user selection
     C                   EXSR      A3READ
     C                   IF        W0EOFA <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0AL1P                         First page
     C                   MOVEL     'Y'           W0AL00                         Company Number
     C                   MOVEL     'Y'           W0AL01                         Order Number
     C                   MOVEL     'Y'           W0AL02                         ED Export Docum
      * Set column headings flag
     C                   MOVE      'Y'           W0ACDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFA = '0'
     C                   EXSR      A1PHDR
      * Print report detail line
     C                   EXSR      A2PDTL
      * Read next record with user selection
     C                   EXSR      A3READ
      * Print totals
     C                   EXSR      A4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   A0EXIT        ENDSR
      /EJECT
     CSR   A1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0AL1P = 'Y'
     C                   MOVE      'Y'           W0AP1P
     C                   END
      *
      * Load key header format
     C                   IF        W0AL00 = 'Y'
     C                   Z-ADD     MRAIC3        $DAIC3                         Company Number
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0AP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0AL01 = 'Y'
     C                   MOVE      'Y'           W0AP01
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0AL02 = 'Y'
     C                   MOVE      'Y'           W0AP02
     C                   END
      *
      *================================================================
     CSR   A1EXIT        ENDSR
      /EJECT
     CSR   A2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     MRAIC3        $EAIC3                         Company Number
     C                   Z-ADD     MRC4NB        $EC4NB                         Order Number
     C                   MOVEL     MRDGSX        $EDGSX                         ED Export Docum
     C                   MOVEL     MRKXCD        $EKXCD                         Country Code
     C                   MOVEL     MRZMCD        $EZMCD                         ED Area Office
     C                   MOVEL     MRPSTX        $EPSTX                         ED Destination
     C                   MOVEL     MRPUTX        $EPUTX                         ED Consignor Na
     C                   MOVEL     MRPVTX        $EPVTX                         ED Consignor Ad
     C                   MOVEL     MRPWTX        $EPWTX                         ED Consignor Ad
     C                   MOVEL     MRRVTX        $ERVTX                         ED Consignor Ad
     C                   MOVEL     MRPPU1        $EPPU1                         ED Consignor Ad
     C                   MOVEL     MRZ7AA        $EZ7AA                         ED Consignor St
     C                   MOVEL     MRPDU1        $EPDU1                         ED Consignor Po
     C                   MOVEL     MRZ8AA        $EZ8AA                         ED Consignor Co
     C                   MOVEL     MRRHTX        $ERHTX                         ED Consignee Na
     C                   MOVEL     MRRITX        $ERITX                         ED Consignee Ad
     C                   MOVEL     MRRJTX        $ERJTX                         ED Consignee Ad
     C                   EVAL      $EXHT1 = ' '                                 ED Consignee Ad
     C                   MOVEL     MRSCTX        $ESCTX                         ED Consignee Ad
     C                   EVAL      $EXIT1 = ' '                                 ED Consignee Ad
     C                   MOVEL     MRSDTX        $ESDTX                         ED Consignee Ad
     C                   MOVEL     MRAAAB        $EAAAB                         ED Consignee St
     C                   MOVEL     MRPHU1        $EPHU1                         ED Consignee Po
     C                   MOVEL     MRABAB        $EABAB                         ED Consignee Co
     C                   MOVEL     MRPXTX        $EPXTX                         ED Plant Locati
     C                   MOVEL     MRZOCD        $EZOCD                         ED Plant Locati
     C                   MOVEL     MRZNCD        $EZNCD                         ED Plant Number
     C                   MOVEL     MRCSSX        $ECSSX                         ED Processing P
     C                   MOVEL     MRCTSX        $ECTSX                         ED Attachment S
     C                   MOVEL     MRCUSX        $ECUSX                         ED Attachment T
     C                   MOVEL     MRCVSX        $ECVSX                         ED Xlate Desc t
     C                   MOVEL     MRPTTX        $EPTTX                         ED Unmarked Txt
     C                   MOVEL     MRORNA        $EORNA                         ED Shipping Mar
     C                   MOVEL     MRRKTX        $ERKTX                         ED Date of Slau
     C                   MOVEL     MRPZTX        $EPZTX                         ED Place of Sla
     C                   MOVEL     MRRLTX        $ERLTX                         ED Date of Proc
     C                   MOVEL     MRP0TX        $EP0TX                         ED Place of pro
     C                   MOVEL     MRP1TX        $EP1TX                         ED Continue Com
     C                   MOVEL     MRP2TX        $EP2TX                         ED Remark Const
     C                   MOVEL     MRP3TX        $EP3TX                         ED Remark Const
     C                   MOVEL     MRP4TX        $EP4TX                         ED Remark Const
     C                   MOVEL     MRP5TX        $EP5TX                         ED Remark Const
     C                   MOVEL     MRP6TX        $EP6TX                         ED Remark Const
     C                   MOVEL     MRYHTX        $EYHTX                         ED Remark Const
     C                   MOVEL     MRYITX        $EYITX                         ED Remark Const
     C                   MOVEL     MRCWSX        $ECWSX                         ED Certify that
     C                   MOVEL     MROUNA        $EOUNA                         ED Inspector Na
     C                   MOVEL     MRP7TX        $EP7TX                         ED Origin Count
     C                   MOVEL     MRP9TX        $EP9TX                         ED Port of Load
     C                   MOVEL     MROVNA        $EOVNA                         ED Transportion
     C                   MOVEL     MRQATX        $EQATX                         ED Seal Number
     C                   MOVEL     MRQBTX        $EQBTX                         ED Seal Number
     C                   MOVEL     MRQCTX        $EQCTX                         ED Can_Import C
     C                   MOVEL     MROWNA        $EOWNA                         ED Can_Import C
     C                   MOVEL     MROXNA        $EOXNA                         ED Can_Import C
     C                   Z-ADD     MRABNX        $EABNX                         ED Can_Import C
     C                   Z-ADD     MRACNX        $EACNX                         ED Can_Import C
     C                   Z-ADD     MRADNX        $EADNX                         ED Seaboard Pla
     C                   MOVEL     MRQDTX        $EQDTX                         ED USDA Cert Nb
     C                   MOVEL     MRQETX        $EQETX                         ED USDA Cert Nb
     C                   MOVEL     MROYNA        $EOYNA                         ED Can_Port of
     C                   MOVEL     MROZNA        $EOZNA                         ED Can_Reinsp E
     C                   MOVEL     MRO0NA        $EO0NA                         ED Can_Reinsp E
     C                   MOVEL     MRO1NA        $EO1NA                         ED Can_Reinsp E
     C                   MOVEL     MRCXSX        $ECXSX                         ED Herm Sealed
     C                   MOVEL     MRCYSX        $ECYSX                         ED Herm Sealed
     C                   MOVEL     MRAGNX        $EAGNX                         ED Herm Sealed
     C                   MOVEL     MRCZSX        $ECZSX                         ED Whole Bird S
     C                   MOVEL     MRC0SX        $EC0SX                         ED Marked Sts
     C                   MOVEL     MRC1SX        $EC1SX                         ED Tamper Evide
     C                   MOVEL     MRQFTX        $EQFTX                         ED Plant Contac
     C                   Z-ADD     MRAHNX        $EAHNX                         ED Plant Contac
     C                   MOVEL     MRQGTX        $EQGTX                         ED Modified Tex
     C                   MOVEL     MRQHTX        $EQHTX                         ED Issued Crt f
     C                   MOVEL     MRQITX        $EQITX                         ED Species
     C                   MOVEL     MRQJTX        $EQJTX                         ED Slaughter Pl
     C                   MOVEL     MRQKTX        $EQKTX                         ED Slaughter Pl
     C                   MOVEL     MRQMTX        $EQMTX                         ED Slaughter Pl
     C                   MOVEL     MRQNTX        $EQNTX                         ED Packaging Pl
     C                   MOVEL     MRQOTX        $EQOTX                         ED Packaging Pl
     C                   MOVEL     MRQPTX        $EQPTX                         ED Packaging Pl
     C                   MOVEL     MRQQTX        $EQQTX                         ED Manufact Pla
     C                   MOVEL     MRQRTX        $EQRTX                         ED Manufact Pla
     C                   MOVEL     MRQSTX        $EQSTX                         ED Manufact Pla
     C                   MOVEL     MRQTTX        $EQTTX                         ED USDA Name 1
     C                   MOVEL     MRQUTX        $EQUTX                         ED USDA Name 2
     C                   MOVEL     MRQVTX        $EQVTX                         ED USDA Name 3
     C                   MOVEL     MRQYTX        $EQYTX                         ED Title of Off
     C                   MOVEL     MRQWTX        $EQWTX                         ED Letter of Cr
     C                   MOVEL     MRQZTX        $EQZTX                         ED Unused prd m
     C                   Z-ADD     MRAINX        $EAINX                         ED Nbr of prods
     C                   MOVEL     MRQ1TX        $EQ1TX                         ED Importer Nam
     C                   MOVEL     MRQ2TX        $EQ2TX                         ED Importer Add
     C                   MOVEL     MRQ3TX        $EQ3TX                         ED Importer Add
     C                   MOVEL     MRQ4TX        $EQ4TX                         ED Purchaser Na
     C                   MOVEL     MRQ5TX        $EQ5TX                         ED Purchaser Ad
     C                   MOVEL     MRQ6TX        $EQ6TX                         ED Purchaser Ad
     C                   MOVEL     MRQ7TX        $EQ7TX                         ED Place Drct S
     C                   MOVEL     MRQ8TX        $EQ8TX                         ED Place Drct S
     C                   MOVEL     MRQ9TX        $EQ9TX                         ED Place Drct S
     C                   MOVEL     MRSMTX        $ESMTX                         ED Place Drct S
     C                   MOVEL     MRZQCD        $EZQCD                         ED Currency
     C                   MOVEL     MRZRCD        $EZRCD                         ED Conditions o
     C                   Z-ADD     MRA7VL        $EA7VL                         ED Total Unit P
     C                   Z-ADD     MRA8VL        $EA8VL                         ED Invoice Tota
     C                   MOVEL     MRC2SX        $EC2SX                         ED Live with PH
     C                   MOVEL     MRC8SX        $EC8SX                         ED Print Status
     C                   Z-ADD     MRHRWG        $EHRWG                         ED Total Net We
     C                   Z-ADD     MRBIVL        $EBIVL                         ED Total Net We
     C                   Z-ADD     MRK2QT        $EK2QT                         ED Nbr of Packa
     C                   MOVEL     MRO5NA        $EO5NA                         ED Customer PO
     C                   Z-ADD     MRHSWG        $EHSWG                         ED Total Gross
     C                   Z-ADD     MRBJVL        $EBJVL                         ED Total Gross
     C                   MOVEL     MRRATX        $ERATX                         ED Plant Number
     C                   MOVEL     MRRBTX        $ERBTX                         ED Language Xla
     C                   MOVEL     MRRCTX        $ERCTX                         ED Slaughter Da
     C                   MOVEL     MRRDTX        $ERDTX                         ED Production m
     C                   MOVEL     MRRETX        $ERETX                         ED Remark Const
     C                   MOVEL     MRC3SX        $EC3SX                         ED Allow Print
     C                   MOVEL     MRC4SX        $EC4SX                         ED Cert of Orig
     C                   MOVEL     MRC5SX        $EC5SX                         ED Use item lab
     C                   MOVEL     MRC6SX        $EC6SX                         ED Slg_Proc Dat
     C                   MOVEL     MRC7SX        $EC7SX                         ED Total Packag
     C                   Z-ADD     MRMQDT        $EMQDT                         ED Export Certi
     C                   Z-ADD     MRMRDT        $EMRDT                         ED Sail Date
     C                   Z-ADD     MRMSDT        $EMSDT                         ED Sworn on Dat
     C                   Z-ADD     MRAJNX        $EAJNX                         ED Consignee Ad
     C                   MOVEL     MRYFTX        $EYFTX                         ED Form Identif
     C                   MOVEL     MRX9TX        $EX9TX                         ED Cold Storage
     C                   MOVEL     MRYATX        $EYATX                         ED Cold Storage
     C                   MOVEL     MRYBTX        $EYBTX                         ED Cold Storage
     C                   MOVEL     MRB5AA        $EB5AA                         ED Cold Storage
     C                   MOVEL     MRYCTX        $EYCTX                         ED Slaughter Da
     C                   MOVEL     MRYDTX        $EYDTX                         ED Production m
     C                   MOVEL     MRYETX        $EYETX                         ED Production m
     C                   MOVEL     MRB6AA        $EB6AA                         ED Booking Nbr
     C                   Z-ADD     MRPADT        $EPADT                         ED Document Dat
     C                   Z-ADD     MRPBDT        $EPBDT                         ED Packing Date
     C                   Z-ADD     MRPCDT        $EPCDT                         ED Expiration D
     C                   Z-ADD     MRPDDT        $EPDDT                         ED Packing Date
     C                   Z-ADD     MRPEDT        $EPEDT                         ED Unused Date
     C                   MOVEL     MRO4SX        $EO4SX                         ED Print Kilogr
     C                   MOVEL     MRO5SX        $EO5SX                         ED MPR Canadian
     C                   MOVEL     MRC1T1        $EC1T1                         ED Container Nb
     C                   MOVEL     MRC2T1        $EC2T1                         ED Slaughter Da
     C                   MOVEL     MRLKSC        $ELKSC                         ED Submit Statu
     C                   MOVEL     MRLLSC        $ELLSC                         EDOH Unused Sts
     C                   MOVEL     MRPIU1        $EPIU1                         EDOH Unused Tex
     C                   MOVEL     MRPJU1        $EPJU1                         EDOH Unused Tex
     C                   Z-ADD     MRFFNZ        $EFFNZ                         EDOH Unused Num
     C                   Z-ADD     MRBUDX        $EBUDX                         EDOH Unused Dat
     C                   MOVEL     MRUVST        $EUVST                         EDI Status 1
     C                   MOVEL     MRUWST        $EUWST                         EDI Status 2
     C                   MOVEL     MRUXST        $EUXST                         EDI Status 3
     C                   MOVEL     MRVSST        $EVSST                         Record Status
     C                   Z-ADD     MRAATM        $EAATM                         Job Time
     C                   MOVEL     MRAYNA        $EAYNA                         User Id
     C                   MOVEL     MRA0NA        $EA0NA                         Job Name
     C                   Z-ADD     MRAXDT        $EAXDT                         Job Date
      * USER: Process before print of detail format
     C                   MOVEL     MRSCTX        $EXHT1                         ED Consignee Ad
     C                   MOVEL     MRSDTX        $EXIT1                         ED Consignee Ad
     C                   MOVEL     P1SCTX        $ESCTX                         ED Consignee Ad
     C                   MOVEL     P1SDTX        $ESDTX                         ED Consignee Ad
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0APDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   A2EXIT        ENDSR
      /EJECT
     CSR   A3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     MRAIC3        WZA001
     C                   Z-ADD     MRC4NB        WZA002
     C                   MOVEL     MRDGSX        WZA003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFA = '1'
     C     KRSA          READE     @MRREWT                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFA
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFA <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0AL00 = ' '                                 Company Number
     C                   EVAL      W0AL01 = ' '                                 Order Number
     C                   EVAL      W0AL02 = ' '                                 ED Export Docum
      * End of file - Signal all level breaks
     C                   IF        W0EOFA = '1'
     C                   MOVEL     'Y'           W0AL00                         Company Number
     C                   MOVEL     'Y'           W0AL01                         Order Number
     C                   MOVEL     'Y'           W0AL02                         ED Export Docum
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        MRAIC3 <> WZA001
     C                   MOVEL     'Y'           W0AL00
     C                   END
      * Set on level break indicator
     C                   IF        MRC4NB <> WZA002 OR
     C                             W0AL00 = 'Y'
     C                   MOVEL     'Y'           W0AL01
     C                   END
      * Set on level break indicator
     C                   IF        MRDGSX <> WZA003 OR
     C                             W0AL01 = 'Y'
     C                   MOVEL     'Y'           W0AL02
     C                   END
     C                   END
      *================================================================
     CSR   A3EXIT        ENDSR
      /EJECT
     CSR   A4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0AL02 = 'Y'
     C                   EVAL      W0AP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0AL01 = 'Y'
     C                   EVAL      W0AP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0AL00 = 'Y'
     C                   EVAL      W0AP00 = ' '
     C                   END
      *
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0EOFA = '1'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 2
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $FFINTTL
     C                   END
      *
      *================================================================
     CSR   A4EXIT        ENDSR
      /EJECT
     CSR   Q0PRNT        BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                   EXSR      Q1FSEL
      * Calculate length of formats selected for printing
     C                   EXSR      Q2PLEN
      * Add column heading length to print length
     C                   ADD       W0COLN        W0FSUM
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C                   IF        W0NEWP <> 'Y'
     C                   IF        W0FSUM > W0OFL
     C                   MOVE      'Y'           W0NEWP
     C                   ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                   ADD       W0DTLN        W0FSUM
     C                   IF        W0FSUM > W0PGL
     C                   MOVE      'Y'           W0NEWP
     C                   END
     C                   END
     C                   END
      * Print Standard report header of PRT Fix Consignee Addr XF
      * If it is ready to print, then do so,
     C                   IF        W0NEWP = 'Y'
     C                   EXSR      Q3PTNP
     C                   END                                                    FI
      *
      * Print First Page Format of PRT Fix Consignee Addr XF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0AP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP1P = 'P'
     C                   WRITE     $C1STPAG
      *
      * Reset format print flag
     C                   EVALR     W0AP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0AL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Fix Consignee Addr XF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C                   IF        W0AP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP00 = 'P'
     C                   IF        $DAIC3 <> 0
     C                   EVAL      WUDMCD = ' '                                 CD3 Ext Numeric
     C                   MOVEL     $DAIC3        WUDMCD                         CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUDMCD        #L3                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        3
     C     #L3(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L3(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L3           WUDMCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUDMCD        VDAIC3                         CD3 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VDAIC3 = ' '                                 CD3 Ext Numeric
     C                   END                                                    *FI
      * Print format
     C                   WRITE     $DKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0ACDT
      *
      * Reset format print flag
     C                   EVALR     W0AP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Fix Consignee Addr XF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0AP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP01 = 'P'
     C                   EVALR     W0AP01 = ' '
     C                   END                                                    FI
      * Print ED Export Document Type of PRT Fix Consignee Addr XF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0AP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP02 = 'P'
     C                   EVALR     W0AP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Fix Consignee Addr XF
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0ACDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        W0APDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0APDT = 'P'
     C                   IF        $EC4NB <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     $EC4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        VEC4NB                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VEC4NB = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0ACDT = 'Y'
     C                   WRITE     $ECOLHDG
      * Clear column headings control flag
     C                   EVALR     W0ACDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $EDTLRCD
      *
      * Reset format print flag
     C                   EVALR     W0APDT = ' '
     C                   END                                                    FI
      * Clear new page flag
     C                   EVALR     W0NEWP = ' '
      *================================================================
     CSR   Q0EXIT        ENDSR
      /EJECT
     CSR   Q1FSEL        BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR   Q1EXIT        ENDSR
      /EJECT
     CSR   Q2PLEN        BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C                   Z-ADD     @$CLN         W0FSUM
     C                   Z-ADD     *ZERO         W0DTLN
     C                   Z-ADD     *ZERO         W0COLN
      * * First Page Format of PRT Fix Consignee Addr XF
     C                   IF        W0AP1P = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Fix Consignee Addr XF
     C                   IF        W0AP00 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Fix Consignee Addr XF
     C                   IF        W0AP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * ED Export Document Type of PRT Fix Consignee Addr XF
     C                   IF        W0AP02 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Fix Consignee Addr XF
     C                   IF        W0APDT = 'Y'
     C                   Z-ADD     16            W0DTLN
     C                   IF        W0ACDT = 'Y'
     C                   Z-ADD     4             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      *================================================================
     CSR   Q2EXIT        ENDSR
      /EJECT
     CSR   Q3PTNP        BEGSR
      *================================================================
      * Format select
      *================================================================
     C                   WRITE     $APAGHDR
      * Clear page overflow indicator
     C                   SETOFF                                       97        *
      *================================================================
     CSR   Q3EXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Initialise indicators for re-entry
     C                   MOVE      '0'           *IN
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        MRAIC3                         Company Number
     C                   MOVEL     *LOVAL        MRC4NB                         Order Number
     C                   MOVEL     *LOVAL        MRDGSX                         ED Export Docum
     C                   MOVEL     *LOVAL        MRKXCD                         Country Code
      * Define work field CD3 Ext Numeric Key
     C                   EVAL      WUDMCD = ' '
      * Define work field CD7 Ext Numeric Key
     C                   EVAL      WUEOCD = ' '
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   MOVE      ZZFFL         @1FFL
     C                   MOVE      ZZFLB         @1FLB
     C                   MOVE      ZZFMB         @1FMB
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
     C                   MOVEL     'N'           W0PMT
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C     *DTAARA       DEFINE    YYCOTXA       $ACMP
     C                   IN        *DTAARA
      *................................................................
     C                   MOVEL     ##PGM         $APGM
     C                   MOVEL     ##USR         $AUSR
     C                   EVAL      W0PFM = ' '
     C                   Z-ADD     *ZERO         @$WRK
     C                   Z-ADD     *ZERO         @$HDL
     C                   Z-ADD     *ZERO         @$CLN
     C                   Z-ADD     *ZERO         @$PGN
      * Adjust page length and overflow as necessary
     C     @$PGL         SUB       2             W0PGL
     C                   IF        @$OFL >= W0PGL
     C     W0PGL         SUB       2             W0OFL
     C                   ELSE
     C                   Z-ADD     @$OFL         W0OFL
     C                   END
      * Clear overflow indicator
     C                   SETOFF                                       97
      * Request new page
     C                   MOVEL     'Y'           W0NEWP
      *================================================================
     CSR   ZZEXIT        ENDSR
