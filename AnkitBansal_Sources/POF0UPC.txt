/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - BUILD THE WORKFILE AND PRINT THE PACKAGING USAGE RPT */
/*                                                                  */
/*  COMPANY   - SEABOARD COPRORATION                                */
/*  SYSTEM    - ORDER MANAGEMENT                                    */
/*  USER NAME - ROSE CENTONZE                                       */
/*  DATE      - 05/23/00                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &PGM        - PROGRAM NAME                              */
/*          &COMPL      - COMPANY NUMBER - BLANK FOR ALL            */
/*          &FDATEL     - FROM ACTUAL SHIPPED DATE                */
/*          &TDATEL     - THROUGH    DATE                         */
/*          &SHIFT      - SHIFT NUMBER                             */
/********************************************************************/

 POF0UPC:    PGM        PARM(&RTN &COMPL &FDATEL &TDATEL &SHIFT +
                  &OUTQ &HOLD &SAVE &COPIESL)


             DCL        VAR(&RTN) TYPE(*CHAR) LEN(7) /*  RETURN +
                          CODE   */
        DCL    &COMP      *DEC    (3 0)           /*  COMPANY #     */
        DCL    &COMPL     *DEC                    /*  FOR PASSING   */
        DCL    &FDATE     *DEC    (7 0)          /*  FROM DATE      */
        DCL    &FDATEL    *DEC                   /*  FOR PASSING    */
        DCL    &FDATEX    *CHAR   (7)          /*  FROM DATE      */
        DCL    &TDATE     *DEC    (7 0)          /*  TO  DATE      */
        DCL    &TDATEL    *DEC                   /*  FOR PASSING    */
        DCL    &TDATEX    *CHAR   (7)          /*  TO DATE      */
        DCL    &SHIFT     *CHAR   (1)

        DCL    &COPIES    *DEC    (2 0)           /*  # OF COPIES   */
        DCL    &COPIESL   *DEC                    /*  FOR PASSING   */
        DCL    &OUTQ      *CHAR   10             /*  OUTPUT QUEUE   */
        DCL    &SAVE      *CHAR   4              /*  SAVE SPOOL     */
        DCL    &HOLD      *CHAR   4              /*  HOLD SPOOL     */

        DCL    &COMMAND    *CHAR   (512)

/* SEND PROGRAM MESSAGE PARAMETERS  */

             /* Internal Fields */

             CHGVAR    VAR(&COMP) VALUE(&COMPL) /* Change to length +
                          for print program */
             CHGVAR    VAR(&FDATE) VALUE(&FDATEL) /* Change to length +
                          for print program */
             CHGVAR    VAR(&FDATEX) VALUE(&FDATE) /* Change to CHAR  */
             CHGVAR    VAR(&TDATE) VALUE(&TDATEL) /* Change to length +
                          for print program */
             CHGVAR    VAR(&TDATEX) VALUE(&TDATE) /* Change to CHAR  */
             CHGVAR    VAR(&COPIES) VALUE(&COPIESL) /* change to +
                          length for print program */

   /*------------------------------------------------*/
   /* BUILD THE FILE               */
   /*-----------------------------------------------*/
             CALL       PGM(POFYXFR) PARM(&RTN &COMP &FDATE &TDATE +
                          &SHIFT)

   /*------------------------------------------------*/
   /* PRINT THE REPORT             */
   /*-----------------------------------------------*/

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(POFWPFR$) OUTQ(&OUTQ) +
                          COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

             CALL       PGM(POFWPFR) PARM(&RTN &COMP &FDATE &TDATE +
                          &SHIFT)

 END:        ENDPGM
