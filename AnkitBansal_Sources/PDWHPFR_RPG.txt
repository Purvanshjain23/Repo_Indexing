     H/TITLE PRT Frght by Shipto St PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 01/11/05  Time  : 13:36:17
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMHSTPL3IF  E           K        DISK
      * RSQ : Sales History             Co/Shipto St/Carrier/Ord
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FPDWHPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Frght by Shipto St PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    YK01      100  7  A            Prt Frght by St
      *
     I@FHSTD3
      * Sales History             Retrieval index
      * Renamed input format fields
     I              F4AIC3                          WBAIC3
     I              F4C4NB                          WBC4NB
     I              F4DPNB                          WBDPNB
     I              F4UENB                          WBUENB
     I              F4MONA                          WBMONA
     I              F4RJCD                          WBRJCD
     I              F4RKCD                          WBRKCD
     I              F4GPTX                          WBGPTX
     I              F4ABTX                          WBABTX
     I              F4KXCD                          WBKXCD
     I              F4BOCD                          WBBOCD
     I              F4BTC7                          WBBTC7
     I              F4ANC7                          WBANC7
     I              F4AQTX                          WBAQTX
     I              F4BKC7                          WBBKC7
     I              F4BRTX                          WBBRTX
     I              F4HNNA                          WBHNNA
     I              F4DBCD                          WBDBCD
     I              F4CKTX                          WBCKTX
     I              F4BCNA                          WBBCNA
     I              F4A0DT                          WBA0DT
     I              F4ACDT                          WBACDT
     I              F4R4CD                          WBR4CD
     I              F4R5CD                          WBR5CD
     I              F4BFCD                          WBBFCD
     I              F4Q4CD                          WBQ4CD
     I              F4AQCD                          WBAQCD
     I              F4TBNB                          WBTBNB
     I              F4BZNA                          WBBZNA
     I              F4RLCD                          WBRLCD
     I              F4JNCD                          WBJNCD
     I              F4Q2CD                          WBQ2CD
     I              F4U2ST                          WBU2ST
     I              F4ATIN                          WBATIN
     I              F4T3NB                          WBT3NB
     I              F4RSRN                          WBRSRN
     I              F4ORIT                          WBORIT
     I              F4AJCD                          WBAJCD
     I              F4AVQT                          WBAVQT
     I              F4D0WG                          WBD0WG
     I              F4CCQT                          WBCCQT
     I              F4AUWG                          WBAUWG
     I              F4AGCD                          WBAGCD
     I              F4AKPR                          WBAKPR
     I              F4AUPR                          WBAUPR
     I              F4CRCD                          WBCRCD
     I              F4A5DT                          WBA5DT
     I              F4AWDT                          WBAWDT
     I              F4HDDT                          WBHDDT
     I              F4AGCS                          WBAGCS
     I              F4AQCS                          WBAQCS
     I              F4AVWG                          WBAVWG
     I              F4AYVA                          WBAYVA
     I              F4AMST                          WBAMST
     I              F4ANST                          WBANST
     I              F4VAST                          WBVAST
     I              F4L6NB                          WBL6NB
     I              F4UMCD                          WBUMCD
     I              F4HCDT                          WBHCDT
     I              F4ESNB                          WBESNB
     I              F4ETNB                          WBETNB
     I              F4BZNB                          WBBZNB
     I              F4EXQT                          WBEXQT
     I              F4BYWG                          WBBYWG
     I              F4S5NB                          WBS5NB
     I              F4MAVA                          WBMAVA
     I              F4KDVA                          WBKDVA
     I              F4USVA                          WBUSVA
     I              F4UTVA                          WBUTVA
     I              F4A4WG                          WBA4WG
     I              F4CKNB                          WBCKNB
     I              F4BMST                          WBBMST
     I              F4R8NB                          WBR8NB
     I              F4RMCD                          WBRMCD
     I              F4BZPR                          WBBZPR
     I              F4RDCD                          WBRDCD
     I              F4Q7CD                          WBQ7CD
     I              F4EXDT                          WBEXDT
     I              F4LQCD                          WBLQCD
     I              F4HICD                          WBHICD
     I              F4RBCD                          WBRBCD
     I              F4RGNB                          WBRGNB
     I              F4RHNB                          WBRHNB
     I              F4RINB                          WBRINB
     I              F4R1NB                          WBR1NB
     I              F4CONB                          WBCONB
     I              F4CEST                          WBCEST
     I              F4GNDT                          WBGNDT
     I              F4RMNB                          WBRMNB
     I              F4AODT                          WBAODT
     I              F4LLCD                          WBLLCD
     I              F4LMCD                          WBLMCD
     I              F4SKNB                          WBSKNB
     I              F4SLNB                          WBSLNB
     I              F4SMNB                          WBSMNB
     I              F4G7NA                          WBG7NA
     I              F4ONVA                          WBONVA
     I              F4N0CD                          WBN0CD
     I              F4B4NB                          WBB4NB
     I              F4B5NB                          WBB5NB
     I              F4N1CD                          WBN1CD
     I              F4GIDT                          WBGIDT
     I              F4Z1ST                          WBZ1ST
     I              F4ULVA                          WBULVA
     I              F4UNVA                          WBUNVA
     I              F4UOVA                          WBUOVA
     I              F4UPVA                          WBUPVA
     I              F4UQVA                          WBUQVA
     I              F4SDCD                          WBSDCD
     I              F4QZCD                          WBQZCD
     I              F4XWST                          WBXWST
     I              F4T9CD                          WBT9CD
     I              F4UBCD                          WBUBCD
     I              F4CFC7                          WBCFC7
     I              F4X1CD                          WBX1CD
     I              F4GASX                          WBGASX
     I              F4DUPR                          WBDUPR
     I              F4B6VL                          WBB6VL
     I              F4IANX                          WBIANX
     I              F4IBNX                          WBIBNX
     I              F4RPCD                          WBRPCD
     I              F4NYDT                          WBNYDT
     I              F4BZTM                          WBBZTM
     I              F4Z4NB                          WBZ4NB
     I              F4XACD                          WBXACD
     I              F4OANA                          WBOANA
     I              F4OKTX                          WBOKTX
     I              F4K4TX                          WBK4TX
     I              F4NBBO                          WBNBBO
     I              F4OCFR                          WBOCFR
     I              F4C0C7                          WBC0C7
     I              F4A1AA                          WBA1AA
     I              F4VEST                          WBVEST
     I              F4A5PR                          WBA5PR
     I              F4CDPR                          WBCDPR
     I              F4D0PR                          WBD0PR
     I              F4D0VL                          WBD0VL
     I              F4IRSX                          WBIRSX
     I              F4CEVL                          WBCEVL
     I              F4ISSX                          WBISSX
     I              F4ITSX                          WBITSX
     I              F4IUSX                          WBIUSX
     I              F4OHDT                          WBOHDT
     I              F4D9PR                          WBD9PR
     I              F4CFVL                          WBCFVL
     I              F4UVST                          WBUVST
     I              F4UWST                          WBUWST
     I              F4UXST                          WBUXST
     I              F4AATM                          WBAATM
     I              F4AYNA                          WBAYNA
     I              F4A0NA                          WBA0NA
     I              F4AXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IYD01        DS
     I                                        1   2 YI0101
     I                                        3   70YI01
      *
     IYM01        DS                        100
     I                                        1  132WAETWG
     I                                       14  262WAU9VA
     I                                       27  392WATFAM
     I                                       40  41 WADBCD
      *
     IYW01        DS
     I                                        1  132XAETWG
     I                                       14  262XAU9VA
     I                                       27  392XATFAM
     I                                       40  41 XADBCD
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : RST Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  USR From Date
     I                                    P   1   40P2BDDT
     IP3PARM      DS
      * I :  USR To Date
     I                                    P   1   40P3FDDT
     IP4PARM      DS
      * I :  Export/Domestic
     I                                        1   1 P4SUST
     IP5PARM      DS
      * FLD: *Arrays
      * I :  USR Warehouse Code
     I                                        1   3 P5CPCD
      * I :  USR CDE Parm 1
     I                                        4   6 P5VSCD
      * I :  USR CDE Parm 2
     I                                        7   9 P5VTCD
      * I :  USR CDE Parm 3
     I                                       10  12 P5VUCD
      * I :  USR CDE Parm 4
     I                                       13  15 P5VVCD
      * I :  USR CDE Parm 5
     I                                       16  18 P5VWCD
      * I :  USR CDE Parm 6
     I                                       19  21 P5VXCD
      * I :  USR CDE Parm 7
     I                                       22  24 P5VYCD
      * I :  USR CDE Parm 8
     I                                       25  27 P5VZCD
      * I :  USR CDE Parm 9
     I                                       28  30 P5V0CD
      * I :  USR Select/Omit Flag
     I                                       31  31 P5CYST
     IP6PARM      DS
      * N :  Count USR
     I                                    P   1   30P6CNTU
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2BDDT    PARM           WP0002  70       USR From Date
     C           P3FDDT    PARM           WP0003  70       USR To Date
     C           P4SUST    PARM           WP0004  1        Export/Domestic
     C           P5CPCD    PARM           WP0005  3        USR Warehouse C
     C           P5VSCD    PARM           WP0006  3        USR CDE Parm 1
     C           P5VTCD    PARM           WP0007  3        USR CDE Parm 2
     C           P5VUCD    PARM           WP0008  3        USR CDE Parm 3
     C           P5VVCD    PARM           WP0009  3        USR CDE Parm 4
     C           P5VWCD    PARM           WP0010  3        USR CDE Parm 5
     C           P5VXCD    PARM           WP0011  3        USR CDE Parm 6
     C           P5VYCD    PARM           WP0012  3        USR CDE Parm 7
     C           P5VZCD    PARM           WP0013  3        USR CDE Parm 8
     C           P5V0CD    PARM           WP0014  3        USR CDE Parm 9
     C           P5CYST    PARM           WP0015  1        USR Select/Omit
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Frght by Shipto St PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$KENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Frght by Shipto St PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN F4AIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@HSTPM3                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Ship To State C
     C                     MOVEL'Y'       W0AL02  1        Carrier Code
     C                     MOVEL'Y'       W0AL03  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $BAIC3           Company Number
     C                     MOVEL*BLANK    $BAPTX           Company Name
     C                     Z-ADD*ZERO     $BBDDT           USR From Date
     C                     Z-ADD*ZERO     $BFDDT           USR To Date
     C                     MOVEL*BLANK    $BSUST           Export/Domestic
     C                     MOVEL*BLANK    $BMRTX           Export/Domestic
     C                     MOVEL*BLANK    $BCYST           USR Select/Omit
     C                     MOVEL*BLANK    $BCPCD           USR Warehouse C
     C                     MOVEL*BLANK    $BVSCD           USR CDE Parm 1
     C                     MOVEL*BLANK    $BVTCD           USR CDE Parm 2
     C                     MOVEL*BLANK    $BVUCD           USR CDE Parm 3
     C                     MOVEL*BLANK    $BVVCD           USR CDE Parm 4
     C                     MOVEL*BLANK    $BVWCD           USR CDE Parm 5
     C                     MOVEL*BLANK    $BVXCD           USR CDE Parm 6
     C                     MOVEL*BLANK    $BVYCD           USR CDE Parm 7
     C                     MOVEL*BLANK    $BVZCD           USR CDE Parm 8
     C                     MOVEL*BLANK    $BV0CD           USR CDE Parm 9
      * Load related totals format
     C                     Z-ADD*ZERO     $HETWG           Weight Total 13
     C                     Z-ADD*ZERO     $HU9VA           Quantity On Han
     C                     Z-ADD*ZERO     $HTFAM           Total Freight A
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDF4RMNB    $CRMNB           Load ID
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDF4AIC3    $GAIC3           Company Number
     C                     MOVELF4DBCD    $GDBCD           Ship To State C
     C                     Z-ADD*ZERO     $GETWG           Weight Total 13
     C                     Z-ADD*ZERO     $GU9VA           Quantity On Han
     C                     Z-ADD*ZERO     $GTFAM           Total Freight A
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDF4AIC3    $FAIC3           Company Number
     C                     MOVELF4DBCD    $FDBCD           Ship To State C
     C                     MOVELF4BZNA    $FBZNA           Carrier Code
     C                     Z-ADD*ZERO     $FETWG           Weight Total 13
     C                     Z-ADD*ZERO     $FU9VA           Quantity On Han
     C                     Z-ADD*ZERO     $FTFAM           Total Freight A
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDF4AIC3    $EAIC3           Company Number
     C                     Z-ADDF4C4NB    $EC4NB           Order Number
     C                     Z-ADDF4RMNB    $ERMNB           Load ID
     C                     MOVELF4DBCD    $EDBCD           Ship To State C
     C                     MOVELF4BZNA    $EBZNA           Carrier Code
     C                     MOVEL*BLANK    $EESNA           USR Description
     C                     Z-ADDF4GNDT    $EGNDT           Actual Shipped
     C                     Z-ADDF4AWDT    $EAWDT           Invoice Date
     C                     Z-ADDF4TBNB    $ETBNB           Absorbed Freigh
     C                     MOVELF4AQTX    $EAQTX           A/R Customer Na
     C                     MOVELF4HNNA    $EHNNA           Ship To City
     C                     Z-ADDF4BKC7    $EBKC7           Ship To Custome
     C                     MOVELF4BRTX    $EBRTX           Ship To Name
     C                     Z-ADD*ZERO     $EETWG           Weight Total 13
     C                     Z-ADD*ZERO     $EU9VA           Quantity On Han
     C                     Z-ADD*ZERO     $ETFAM           Total Freight A
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDF4AIC3    $DAIC3           Company Number
     C                     Z-ADDF4C4NB    $DC4NB           Order Number
     C                     Z-ADDF4DPNB    $DDPNB           Order Sequence
     C                     Z-ADDF4UENB    $DUENB           Order Secondary
     C                     MOVELF4MONA    $DMONA           A/R City
     C                     MOVELF4RJCD    $DRJCD           A/R State
     C                     MOVELF4RKCD    $DRKCD           A/R County Code
     C                     MOVELF4GPTX    $DGPTX           A/R Zip/Postal
     C                     MOVELF4ABTX    $DABTX           Alpha Search
     C                     MOVELF4BOCD    $DBOCD           Type Code
     C                     Z-ADDF4BTC7    $DBTC7           Parent Customer
     C                     Z-ADDF4ANC7    $DANC7           A/R Customer Nu
     C                     MOVELF4AQTX    $DAQTX           A/R Customer Na
     C                     MOVELF4DBCD    $DDBCD           Ship To State C
     C                     MOVELF4BZNA    $DBZNA           Carrier Code
     C                     Z-ADDF4GNDT    $DGNDT           Actual Shipped
     C                     MOVELF4HNNA    $DHNNA           Ship To City
     C                     Z-ADDF4BKC7    $DBKC7           Ship To Custome
     C                     MOVELF4BRTX    $DBRTX           Ship To Name
     C                     MOVELF4CKTX    $DCKTX           Ship To Zip/Pos
     C                     MOVELF4KXCD    $DKXCD           Country Code
     C                     MOVELF4BCNA    $DBCNA           Customer Purcha
     C                     Z-ADDF4A0DT    $DA0DT           Order Date
     C                     Z-ADDF4ACDT    $DACDT           Cancel Date
     C                     MOVELF4R4CD    $DR4CD           Sales Route Cod
     C                     MOVELF4R5CD    $DR5CD           Original Salesp
     C                     MOVELF4BFCD    $DBFCD           Manager Level C
     C                     MOVELF4Q4CD    $DQ4CD           VP Level Code
     C                     MOVELF4AQCD    $DAQCD           Terms Code
     C                     Z-ADDF4TBNB    $DTBNB           Absorbed Freigh
     C                     MOVELF4RLCD    $DRLCD           Order Header Re
     C                     MOVELF4JNCD    $DJNCD           Order Type - Sa
     C                     MOVELF4Q2CD    $DQ2CD           Shipping Method
     C                     MOVELF4U2ST    $DU2ST           Export Status
     C                     Z-ADDF4ATIN    $DATIN           Attach to Invoi
     C                     Z-ADDF4T3NB    $DT3NB           Attach to Order
     C                     Z-ADDF4RSRN    $DRSRN           Resell Referenc
     C                     Z-ADDF4ORIT    $DORIT           Original Item
     C                     MOVELF4AJCD    $DAJCD           Warehouse Code
     C                     Z-ADDF4AVQT    $DAVQT           Quantity Ordere
     C                     Z-ADDF4D0WG    $DD0WG           Weight Ordered
     C                     MOVELF4AGCD    $DAGCD           U/M - Ordered
     C                     Z-ADDF4AUPR    $DAUPR           Unit Price Orde
     C                     MOVELF4CRCD    $DCRCD           U/M - Base Pric
     C                     Z-ADDF4A5DT    $DA5DT           Requested Ship
     C                     Z-ADDF4AWDT    $DAWDT           Invoice Date
     C                     Z-ADDF4HDDT    $DHDDT           Deadline Depart
     C                     Z-ADDF4AGCS    $DAGCS           Unit Cost Per P
     C                     Z-ADDF4AQCS    $DAQCS           Unit Cost Order
     C                     Z-ADDF4AVWG    $DAVWG           Unit Weight Ord
     C                     Z-ADDF4AYVA    $DAYVA           Extended Amount
     C                     MOVELF4AMST    $DAMST           Affect Inventor
     C                     MOVELF4ANST    $DANST           Affect Sales Do
     C                     MOVELF4VAST    $DVAST           Affect Sales Pn
     C                     Z-ADDF4L6NB    $DL6NB           Contract Number
     C                     MOVELF4UMCD    $DUMCD           Export Country
     C                     Z-ADDF4HCDT    $DHCDT           LD Arrival Date
     C                     Z-ADDF4CCQT    $DCCQT           Quantity Schedu
     C                     Z-ADDF4AUWG    $DAUWG           Weight Schedule
     C                     Z-ADDF4ESNB    $DESNB           Accounting Year
     C                     Z-ADDF4ETNB    $DETNB           Accounting Peri
     C                     Z-ADDF4BZNB    $DBZNB           OM Week
     C                     Z-ADDF4EXQT    $DEXQT           Quantity Billed
     C                     Z-ADDF4BYWG    $DBYWG           Weight Billed
     C                     Z-ADDF4S5NB    $DS5NB           Shipped Item Co
     C                     Z-ADDF4MAVA    $DMAVA           Billing Detail
     C                     Z-ADDF4KDVA    $DKDVA           Billing Detail
     C                     Z-ADDF4USVA    $DUSVA           FOB Gross Amoun
     C                     Z-ADDF4UTVA    $DUTVA           Standard Overag
     C                     Z-ADDF4A4WG    $DA4WG           Tare Weight Tot
     C                     Z-ADDF4CKNB    $DCKNB           G/L Document Nu
     C                     MOVELF4BMST    $DBMST           G/L Update Stat
     C                     Z-ADDF4R8NB    $DR8NB           Original Order
     C                     MOVELF4RMCD    $DRMCD           Order Detail Re
     C                     Z-ADDF4BZPR    $DBZPR           Price Overage O
     C                     MOVELF4RDCD    $DRDCD           Date Method Cod
     C                     MOVELF4Q7CD    $DQ7CD           Price Method Co
     C                     Z-ADDF4RGNB    $DRGNB           Item Structure
     C                     Z-ADDF4RHNB    $DRHNB           Item Structure
     C                     Z-ADDF4RINB    $DRINB           Item Structure
     C                     Z-ADDF4R1NB    $DR1NB           Rated Freight
     C                     Z-ADDF4CONB    $DCONB           Invoice Number
     C                     MOVELF4CEST    $DCEST           Invoice Suffix
     C                     Z-ADDF4RMNB    $DRMNB           Load ID
     C                     Z-ADDF4AODT    $DAODT           Scheduled Ship
     C                     MOVELF4LLCD    $DLLCD           Packaging Code
     C                     MOVELF4LMCD    $DLMCD           Grade Code
     C                     Z-ADDF4SKNB    $DSKNB           Agrimetrics gro
     C                     Z-ADDF4SLNB    $DSLNB           Agrimetrics pac
     C                     Z-ADDF4SMNB    $DSMNB           Agrimetrics gra
     C                     Z-ADDF4EXDT    $DEXDT           Market Pricing
     C                     MOVELF4LQCD    $DLQCD           Commodity Marke
     C                     MOVELF4HICD    $DHICD           Quality Level
     C                     MOVELF4RBCD    $DRBCD           Item Level
     C                     MOVELF4G7NA    $DG7NA           Order Desc. Lin
     C                     Z-ADDF4ONVA    $DONVA           Actual Freight
     C                     MOVELF4N0CD    $DN0CD           Item Type Code
     C                     Z-ADDF4B4NB    $DB4NB           PM R/M Type Cod
     C                     Z-ADDF4B5NB    $DB5NB           PM Line Number
     C                     MOVELF4N1CD    $DN1CD           SH Broker Code
     C                     Z-ADDF4GIDT    $DGIDT           Pricing Date Us
     C                     MOVELF4Z1ST    $DZ1ST           Modified Flag
     C                     Z-ADDF4ULVA    $DULVA           Absorbed Freigh
     C                     Z-ADDF4UNVA    $DUNVA           Trade Fund Accr
     C                     Z-ADDF4UOVA    $DUOVA           Commission Amou
     C                     Z-ADDF4UPVA    $DUPVA           Financials Amou
     C                     Z-ADDF4UQVA    $DUQVA           Financials Amou
     C                     MOVELF4SDCD    $DSDCD           Group for Packa
     C                     MOVELF4QZCD    $DQZCD           Base/Conv/Loss
     C                     MOVELF4XWST    $DXWST           Variety/Rendere
     C                     MOVELF4T9CD    $DT9CD           Customer Group
     C                     MOVELF4UBCD    $DUBCD           Customer Group
     C                     Z-ADDF4CFC7    $DCFC7           Order Group Cod
     C                     MOVELF4X1CD    $DX1CD           Shipping Zone C
     C                     MOVELF4GASX    $DGASX           Invoice Price T
     C                     Z-ADDF4DUPR    $DDUPR           Invoice Unit Pr
     C                     Z-ADDF4B6VL    $DB6VL           Invoice Extende
     C                     Z-ADDF4IANX    $DIANX           Req Shipping Te
     C                     Z-ADDF4IBNX    $DIBNX           Actual Shipping
     C                     MOVELF4RPCD    $DRPCD           Age Code
     C                     Z-ADDF4NYDT    $DNYDT           Req Delivery Da
     C                     Z-ADDF4BZTM    $DBZTM           Req Delivery Ti
     C                     Z-ADDF4Z4NB    $DZ4NB           MPC Number
     C                     MOVELF4XACD    $DXACD           Shipping Line
     C                     MOVELF4OANA    $DOANA           Sail Port Delv
     C                     MOVELF4OKTX    $DOKTX           Sail Port City
     C                     MOVELF4K4TX    $DK4TX           Vessel Name
     C                     MOVELF4NBBO    $DNBBO           Booking Number
     C                     Z-ADDF4OCFR    $DOCFR           Ocean Freight
     C                     Z-ADDF4C0C7    $DC0C7           Claim Number
     C                     Z-ADDF4A1AA    $DA1AA           Ham Group Numbe
     C                     MOVELF4VEST    $DVEST           Palletize
     C                     MOVELF4UVST    $DUVST           EDI Status 1
     C                     MOVELF4UWST    $DUWST           EDI Status 2
     C                     MOVELF4UXST    $DUXST           EDI Status 3
     C                     Z-ADDF4AATM    $DAATM           Job Time
     C                     MOVELF4AYNA    $DAYNA           User Id
     C                     MOVELF4A0NA    $DA0NA           Job Name
     C                     Z-ADDF4AXDT    $DAXDT           Job Date
     C                     Z-ADDF4A5PR    $DA5PR           Commodity Marke
     C                     Z-ADDF4CDPR    $DCDPR           Market Value
     C                     Z-ADDF4D0PR    $DD0PR           Default Cmdty M
     C                     Z-ADDF4D0VL    $DD0VL           Raw Material Co
     C                     MOVELF4IRSX    $DIRSX           Sales Expense P
     C                     Z-ADDF4CEVL    $DCEVL           Sales Expense T
     C                     MOVELF4ISSX    $DISSX           Data Mart Proce
     C                     MOVELF4ITSX    $DITSX           LH Load Type
     C                     MOVELF4IUSX    $DIUSX           Sale Country
     C                     Z-ADDF4OHDT    $DOHDT           LD Sail Date
     C                     Z-ADDF4D9PR    $DD9PR           HST Unused Pric
     C                     Z-ADDF4CFVL    $DCFVL           HST Item Target
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN F4AIC3    WZA001           Company Number
     C                     Z-ADDF4AIC3    WZA001
     C           *LIKE     DEFN F4DBCD    WZA002           Ship To State C
     C                     MOVELF4DBCD    WZA002
     C           *LIKE     DEFN F4BZNA    WZA003           Carrier Code
     C                     MOVELF4BZNA    WZA003
     C           *LIKE     DEFN F4C4NB    WZA004           Order Number
     C                     Z-ADDF4C4NB    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@HSTPM3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * RTV Bill Type, Event   RT - PD Order Header  * 
     C                     EXSR SDRVGN
      * CASE: WRK.Billing Activity Type is Credit or Debit Memo
     C           WUOBST    IFEQ '2'                        *IF
     C           WUOBST    OREQ '3'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Export/Domestic Selection
     C                     EXSR UASUBR                     Export/Domestic
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Ship To State C
     C                     MOVEL*BLANK    W0AL02  1        Carrier Code
     C                     MOVEL*BLANK    W0AL03  1        Order Number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Ship To State C
     C                     MOVEL'Y'       W0AL02  1        Carrier Code
     C                     MOVEL'Y'       W0AL03  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           F4AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           F4DBCD    IFNE WZA002                     Ship To State C
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           F4BZNA    IFNE WZA003                     Carrier Code
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           F4C4NB    IFNE WZA004                     Order Number
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * RTV Carrier Name       RT - OM Carrier  * 
     C                     EXSR SFRVGN
     C                     ADD  $EETWG    $FETWG           Weight Total 13
     C                     ADD  $EU9VA    $FU9VA           Quantity On Han
     C                     ADD  $ETFAM    $FTFAM           Total Freight A
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $EGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEGNDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$EKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Carrier Code format
     C                     ADD  $FETWG    $GETWG           Weight Total 13
     C                     ADD  $FU9VA    $GU9VA           Quantity On Han
     C                     ADD  $FTFAM    $GTFAM           Total Freight A
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Ship To State Code format
      * CASE: CUR.Ship To State Code EQ WRK.BLANK
     C           $GDBCD    IFEQ WUGSTX                     *IF
      * CRT Prt Frght by State CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GETWG    WL0001           Weight Total 13
     C                     Z-ADD$GU9VA    WL0002           Quantity On Han
     C                     Z-ADD$GTFAM    WL0003           Total Freight A
     C                     MOVEL'`'       WL0004    P      Ship To State C
     C                     EXSR SGCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Prt Frght by State CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GETWG    WL0001           Weight Total 13
     C                     Z-ADD$GU9VA    WL0002           Quantity On Han
     C                     Z-ADD$GTFAM    WL0003           Total Freight A
     C                     MOVEL$GDBCD    WL0004    P      Ship To State C
     C                     EXSR SGCRRC
     C                     END                             *FI
     C                     ADD  1         P6CNTU           Count USR
     C                     ADD  $GETWG    $HETWG           Weight Total 13
     C                     ADD  $GU9VA    $HU9VA           Quantity On Han
     C                     ADD  $GTFAM    $HTFAM           Total Freight A
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$GKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HFINTTL
      * PRTOBJ calls after print of final totals format
      * Embedded PRTOBJ : PRT Frght by S/T St TtlPO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Frght by S/T St TtlPO: Mainline
      *================================================================
      * PRT Frght by S/T St TtlPO: Initialise
     C                     EXSR ZBINIT
      * Establish starting position
     C           *LOVAL    SETLL@FHSTD3                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBAIC3    $IAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELWBDBCD    $JDBCD           Ship To State C
     C                     Z-ADD*ZERO     $JETWG           Weight Total 13
     C                     Z-ADD*ZERO     $JU9VA           Quantity On Han
     C                     Z-ADD*ZERO     $JTFAM           Total Freight A
     C                     Z-ADDWBAIC3    $JAIC3           Company Number
     C                     Z-ADDWBC4NB    $JC4NB           Order Number
     C                     Z-ADDWBDPNB    $JDPNB           Order Sequence
     C                     Z-ADDWBUENB    $JUENB           Order Secondary
     C                     MOVELWBMONA    $JMONA           A/R City
     C                     MOVELWBRJCD    $JRJCD           A/R State
     C                     MOVELWBRKCD    $JRKCD           A/R County Code
     C                     MOVELWBGPTX    $JGPTX           A/R Zip/Postal
     C                     MOVELWBABTX    $JABTX           Alpha Search
     C                     MOVELWBKXCD    $JKXCD           Country Code
     C                     MOVELWBBOCD    $JBOCD           Type Code
     C                     Z-ADDWBBTC7    $JBTC7           Parent Customer
     C                     Z-ADDWBANC7    $JANC7           A/R Customer Nu
     C                     MOVELWBAQTX    $JAQTX           A/R Customer Na
     C                     Z-ADDWBBKC7    $JBKC7           Ship To Custome
     C                     MOVELWBBRTX    $JBRTX           Ship To Name
     C                     MOVELWBHNNA    $JHNNA           Ship To City
     C                     MOVELWBCKTX    $JCKTX           Ship To Zip/Pos
     C                     MOVELWBBCNA    $JBCNA           Customer Purcha
     C                     Z-ADDWBA0DT    $JA0DT           Order Date
     C                     Z-ADDWBACDT    $JACDT           Cancel Date
     C                     MOVELWBR4CD    $JR4CD           Sales Route Cod
     C                     MOVELWBR5CD    $JR5CD           Original Salesp
     C                     MOVELWBBFCD    $JBFCD           Manager Level C
     C                     MOVELWBQ4CD    $JQ4CD           VP Level Code
     C                     MOVELWBAQCD    $JAQCD           Terms Code
     C                     Z-ADDWBTBNB    $JTBNB           Absorbed Freigh
     C                     MOVELWBBZNA    $JBZNA           Carrier Code
     C                     MOVELWBRLCD    $JRLCD           Order Header Re
     C                     MOVELWBJNCD    $JJNCD           Order Type - Sa
     C                     MOVELWBQ2CD    $JQ2CD           Shipping Method
     C                     MOVELWBU2ST    $JU2ST           Export Status
     C                     Z-ADDWBATIN    $JATIN           Attach to Invoi
     C                     Z-ADDWBT3NB    $JT3NB           Attach to Order
     C                     Z-ADDWBRSRN    $JRSRN           Resell Referenc
     C                     Z-ADDWBORIT    $JORIT           Original Item
     C                     MOVELWBAJCD    $JAJCD           Warehouse Code
     C                     Z-ADDWBAVQT    $JAVQT           Quantity Ordere
     C                     Z-ADDWBD0WG    $JD0WG           Weight Ordered
     C                     Z-ADDWBCCQT    $JCCQT           Quantity Schedu
     C                     Z-ADDWBAUWG    $JAUWG           Weight Schedule
     C                     MOVELWBAGCD    $JAGCD           U/M - Ordered
     C                     Z-ADDWBAUPR    $JAUPR           Unit Price Orde
     C                     MOVELWBCRCD    $JCRCD           U/M - Base Pric
     C                     Z-ADDWBA5DT    $JA5DT           Requested Ship
     C                     Z-ADDWBAWDT    $JAWDT           Invoice Date
     C                     Z-ADDWBHDDT    $JHDDT           Deadline Depart
     C                     Z-ADDWBAGCS    $JAGCS           Unit Cost Per P
     C                     Z-ADDWBAQCS    $JAQCS           Unit Cost Order
     C                     Z-ADDWBAVWG    $JAVWG           Unit Weight Ord
     C                     Z-ADDWBAYVA    $JAYVA           Extended Amount
     C                     MOVELWBAMST    $JAMST           Affect Inventor
     C                     MOVELWBANST    $JANST           Affect Sales Do
     C                     MOVELWBVAST    $JVAST           Affect Sales Pn
     C                     Z-ADDWBL6NB    $JL6NB           Contract Number
     C                     MOVELWBUMCD    $JUMCD           Export Country
     C                     Z-ADDWBHCDT    $JHCDT           LD Arrival Date
     C                     Z-ADDWBESNB    $JESNB           Accounting Year
     C                     Z-ADDWBETNB    $JETNB           Accounting Peri
     C                     Z-ADDWBBZNB    $JBZNB           OM Week
     C                     Z-ADDWBEXQT    $JEXQT           Quantity Billed
     C                     Z-ADDWBBYWG    $JBYWG           Weight Billed
     C                     Z-ADDWBS5NB    $JS5NB           Shipped Item Co
     C                     Z-ADDWBMAVA    $JMAVA           Billing Detail
     C                     Z-ADDWBKDVA    $JKDVA           Billing Detail
     C                     Z-ADDWBUSVA    $JUSVA           FOB Gross Amoun
     C                     Z-ADDWBUTVA    $JUTVA           Standard Overag
     C                     Z-ADDWBA4WG    $JA4WG           Tare Weight Tot
     C                     Z-ADDWBCKNB    $JCKNB           G/L Document Nu
     C                     MOVELWBBMST    $JBMST           G/L Update Stat
     C                     Z-ADDWBR8NB    $JR8NB           Original Order
     C                     MOVELWBRMCD    $JRMCD           Order Detail Re
     C                     Z-ADDWBBZPR    $JBZPR           Price Overage O
     C                     MOVELWBRDCD    $JRDCD           Date Method Cod
     C                     MOVELWBQ7CD    $JQ7CD           Price Method Co
     C                     Z-ADDWBEXDT    $JEXDT           Market Pricing
     C                     MOVELWBLQCD    $JLQCD           Commodity Marke
     C                     MOVELWBHICD    $JHICD           Quality Level
     C                     MOVELWBRBCD    $JRBCD           Item Level
     C                     Z-ADDWBRGNB    $JRGNB           Item Structure
     C                     Z-ADDWBRHNB    $JRHNB           Item Structure
     C                     Z-ADDWBRINB    $JRINB           Item Structure
     C                     Z-ADDWBR1NB    $JR1NB           Rated Freight
     C                     Z-ADDWBCONB    $JCONB           Invoice Number
     C                     MOVELWBCEST    $JCEST           Invoice Suffix
     C                     Z-ADDWBGNDT    $JGNDT           Actual Shipped
     C                     Z-ADDWBRMNB    $JRMNB           Load ID
     C                     Z-ADDWBAODT    $JAODT           Scheduled Ship
     C                     MOVELWBLLCD    $JLLCD           Packaging Code
     C                     MOVELWBLMCD    $JLMCD           Grade Code
     C                     Z-ADDWBSKNB    $JSKNB           Agrimetrics gro
     C                     Z-ADDWBSLNB    $JSLNB           Agrimetrics pac
     C                     Z-ADDWBSMNB    $JSMNB           Agrimetrics gra
     C                     MOVELWBG7NA    $JG7NA           Order Desc. Lin
     C                     Z-ADDWBONVA    $JONVA           Actual Freight
     C                     MOVELWBN0CD    $JN0CD           Item Type Code
     C                     Z-ADDWBB4NB    $JB4NB           PM R/M Type Cod
     C                     Z-ADDWBB5NB    $JB5NB           PM Line Number
     C                     MOVELWBN1CD    $JN1CD           SH Broker Code
     C                     Z-ADDWBGIDT    $JGIDT           Pricing Date Us
     C                     MOVELWBZ1ST    $JZ1ST           Modified Flag
     C                     Z-ADDWBULVA    $JULVA           Absorbed Freigh
     C                     Z-ADDWBUNVA    $JUNVA           Trade Fund Accr
     C                     Z-ADDWBUOVA    $JUOVA           Commission Amou
     C                     Z-ADDWBUPVA    $JUPVA           Financials Amou
     C                     Z-ADDWBUQVA    $JUQVA           Financials Amou
     C                     MOVELWBSDCD    $JSDCD           Group for Packa
     C                     MOVELWBQZCD    $JQZCD           Base/Conv/Loss
     C                     MOVELWBXWST    $JXWST           Variety/Rendere
     C                     MOVELWBT9CD    $JT9CD           Customer Group
     C                     MOVELWBUBCD    $JUBCD           Customer Group
     C                     Z-ADDWBCFC7    $JCFC7           Order Group Cod
     C                     MOVELWBX1CD    $JX1CD           Shipping Zone C
     C                     MOVELWBGASX    $JGASX           Invoice Price T
     C                     Z-ADDWBDUPR    $JDUPR           Invoice Unit Pr
     C                     Z-ADDWBB6VL    $JB6VL           Invoice Extende
     C                     Z-ADDWBIANX    $JIANX           Req Shipping Te
     C                     Z-ADDWBIBNX    $JIBNX           Actual Shipping
     C                     MOVELWBRPCD    $JRPCD           Age Code
     C                     Z-ADDWBNYDT    $JNYDT           Req Delivery Da
     C                     Z-ADDWBBZTM    $JBZTM           Req Delivery Ti
     C                     Z-ADDWBZ4NB    $JZ4NB           MPC Number
     C                     MOVELWBXACD    $JXACD           Shipping Line
     C                     MOVELWBOANA    $JOANA           Sail Port Delv
     C                     MOVELWBOKTX    $JOKTX           Sail Port City
     C                     MOVELWBK4TX    $JK4TX           Vessel Name
     C                     MOVELWBNBBO    $JNBBO           Booking Number
     C                     Z-ADDWBOCFR    $JOCFR           Ocean Freight
     C                     Z-ADDWBC0C7    $JC0C7           Claim Number
     C                     Z-ADDWBA1AA    $JA1AA           Ham Group Numbe
     C                     MOVELWBVEST    $JVEST           Palletize
     C                     Z-ADDWBA5PR    $JA5PR           Commodity Marke
     C                     Z-ADDWBCDPR    $JCDPR           Market Value
     C                     Z-ADDWBD0PR    $JD0PR           Default Cmdty M
     C                     Z-ADDWBD0VL    $JD0VL           Raw Material Co
     C                     MOVELWBIRSX    $JIRSX           Sales Expense P
     C                     Z-ADDWBCEVL    $JCEVL           Sales Expense T
     C                     MOVELWBISSX    $JISSX           Data Mart Proce
     C                     MOVELWBITSX    $JITSX           LH Load Type
     C                     MOVELWBIUSX    $JIUSX           Sale Country
     C                     Z-ADDWBOHDT    $JOHDT           LD Sail Date
     C                     Z-ADDWBD9PR    $JD9PR           HST Unused Pric
     C                     Z-ADDWBCFVL    $JCFVL           HST Item Target
     C                     MOVELWBUVST    $JUVST           EDI Status 1
     C                     MOVELWBUWST    $JUWST           EDI Status 2
     C                     MOVELWBUXST    $JUXST           EDI Status 3
     C                     Z-ADDWBAATM    $JAATM           Job Time
     C                     MOVELWBAYNA    $JAYNA           User Id
     C                     MOVELWBA0NA    $JA0NA           Job Name
     C                     Z-ADDWBAXDT    $JAXDT           Job Date
      * USER: Process before print of detail format
      * RTV Prt Frght by State RT - *Arrays  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Ship To State Code EQ PAR.Ship To State 3A
     C           WN0002    IFEQ WN0003                     *IF
     C                     MOVEL*BLANK    $JDBCD           Ship To State C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWN0002    $JDBCD           Ship To State C
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBAIC3    WZB001           Company Number
     C                     Z-ADDWBAIC3    WZB001
     C           *LIKE     DEFN WBC4NB    WZB002           Order Number
     C                     Z-ADDWBC4NB    WZB002
     C           *LIKE     DEFN WBDPNB    WZB003           Order Sequence
     C                     Z-ADDWBDPNB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C                     READ @FHSTD3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     ADD  1         WN0001           Calc 5
      * CASE: PAR.Calc 5 GT PAR.Count USR
     C           WN0001    IFGT P6CNTU                     *IF
      * SET End of File 'B'    US - /UT User Source  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE 'B'
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Order Sequence
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     ELSE
      * Next record - Detect level breaks
     C           WBAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WBC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WBDPNB    IFNE WZB003                     Order Sequence
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Frght by Shipto St PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Frght by Shipto St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     Z-ADDP2BDDT    $BBDDT           USR From Date
     C                     Z-ADDP3FDDT    $BFDDT           USR To Date
     C                     MOVELP4SUST    $BSUST           Export/Domestic
     C                     MOVELP5CYST    $BCYST           USR Select/Omit
     C                     MOVELP5CPCD    $BCPCD           USR Warehouse C
     C                     MOVELP5VSCD    $BVSCD           USR CDE Parm 1
     C                     MOVELP5VTCD    $BVTCD           USR CDE Parm 2
     C                     MOVELP5VUCD    $BVUCD           USR CDE Parm 3
     C                     MOVELP5VVCD    $BVVCD           USR CDE Parm 4
     C                     MOVELP5VWCD    $BVWCD           USR CDE Parm 5
     C                     MOVELP5VXCD    $BVXCD           USR CDE Parm 6
     C                     MOVELP5VYCD    $BVYCD           USR CDE Parm 7
     C                     MOVELP5VZCD    $BVZCD           USR CDE Parm 8
     C                     MOVELP5V0CD    $BV0CD           USR CDE Parm 9
      * RTV Company Name Only  RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     Z-ADDP2BDDT    $BBDDT           USR From Date
     C                     Z-ADDP3FDDT    $BFDDT           USR To Date
      * CASE: PAR.Export/Domestic is Domestic
     C           P4SUST    IFEQ 'D'                        *IF
     C                     MOVEL*BLANK    $BMRTX           Export/Domestic
     C                     MOVEL'Domestic'$BMRTX           Export/Domestic
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Export/Domestic is Export
     C           P4SUST    IFEQ 'E'                        *IF
     C                     MOVEL*BLANK    $BMRTX           Export/Domestic
     C                     MOVEL'Export'  $BMRTX           Export/Domestic
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BMRTX           Export/Domestic
     C                     MOVEL'*All'    $BMRTX           Export/Domestic
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert USR From Date to display format
      * Convert date
     C           1000000   ADD  $BBDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBBDDT
      * Convert USR To Date to display format
      * Convert date
     C           1000000   ADD  $BFDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBFDDT
     C                     MOVEL'0'       *IN79
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$B1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of PRT Frght by Shipto St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print Ship To State Code of PRT Frght by Shipto St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Carrier Code of PRT Frght by Shipto St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Order Number of PRT Frght by Shipto St PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of PRT Frght by Shipto St PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
     C                     ADD  F4BYWG    $EETWG           Weight Total 13
     C                     ADD  F4EXQT    $EU9VA           Quantity On Han
     C                     ADD  F4ONVA    $ETFAM           Total Freight A
     C                     MOVEL'N'       W0PFM            *Print format
      * Mention hidden format
     C   99N99             WRITE$DDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Frght by S/T St TtlPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Frght by S/T St TtlPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Print format
     C                     WRITE$IKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0BP00
     C                     END                             FI
      * Print Order Number of PRT Frght by S/T St TtlPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Frght by S/T St TtlPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of PRT Frght by S/T St TtlPO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0BP00    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Frght by Shipto St PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  7         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Frght by Shipto St PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  5         W0FSUM
     C                     END                             FI
      *
      * * Ship To State Code of PRT Frght by Shipto St PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Carrier Code of PRT Frght by Shipto St PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Frght by Shipto St PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Frght by Shipto St PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Frght by S/T St TtlPO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Frght by S/T St TtlPO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Frght by S/T St TtlPO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Frght by S/T St TtlPO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Frght by S/T St TtlPO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name Only  RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREAK              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Bill Type, Event   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDF4AIC3    BEAIC3           Company Number
     C                     Z-ADDF4C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJPCD    WUJPCD           Event Code
     C                     MOVELBEOBST    WUOBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Export/Department RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDF4AIC3    BZAIC3           Company Number
     C                     Z-ADDF4S5NB    BZHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Department Code
     C                     MOVEL*BLANK    WUSUST           Export/Domestic
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZR3CD    WUG0TX           Department Code
     C                     MOVELBZSUST    WUSUST           Export/Domestic
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL$EBZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSF     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $EESNA           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $EESNA           Name
     C                     MOVELFFVSST    WUVSST           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * CRT Prt Frght by State CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     Z-ADD*ZERO     XAETWG           Weight Total 13
     C                     Z-ADD*ZERO     XAU9VA           Quantity On Han
     C                     Z-ADD*ZERO     XATFAM           Total Freight A
     C                     MOVEL*BLANK    XADBCD           Ship To State C
      * Move all fields to Prt Frght by State Summ
     C                     Z-ADDWL0001    XAETWG           Weight Total 13
     C                     Z-ADDWL0002    XAU9VA           Quantity On Han
     C                     Z-ADDWL0003    XATFAM           Total Freight A
     C                     MOVELWL0004    XADBCD           Ship To State C
      *
      * Move key fields to Prt Frght by State Summ
     C                     MOVELXADBCD    YI0101           Ship To State C
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XADBCD
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to Prt Frght by State Summ
     C                     MOVELXADBCD    YI0101           Ship To State C
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     Z-ADDXAETWG    WAETWG           Weight Total 13
     C                     Z-ADDXAU9VA    WAU9VA           Quantity On Han
     C                     Z-ADDXATFAM    WATFAM           Total Freight A
     C                     MOVELXADBCD    WADBCD           Ship To State C
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Prt Frght by State RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to Prt Frght by State Summ
     C                     MOVELWN0002    YI0101           Ship To State C
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * CASE: DB1.Ship To State Code EQ PAR.Ship To State Code
     C           WADBCD    IFEQ WN0002                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     Z-ADDWAETWG    $JETWG           Weight Total 13
     C                     Z-ADDWAU9VA    $JU9VA           Quantity On Han
     C                     Z-ADDWATFAM    $JTFAM           Total Freight A
     C                     MOVELWADBCD    WN0002           Ship To State C
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     ADD  1         YR01
     C                     ENDDO
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Export/Domestic Selection
      *================================================================
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Export/Domestic is Domestic
     C           P4SUST    IFEQ 'D'                        *IF
     C                     MOVEL'A'       WUVSST           Record Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Export/Domestic is Export
     C           P4SUST    IFEQ 'E'                        *IF
     C                     MOVEL'A'       WUVSST           Record Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Record Status is *blank
     C           WUVSST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Export/Department RT - Company/Item  * 
     C                     EXSR SERVGN
      * CASE: PAR.Export/Domestic EQ WRK.Export/Domestic
     C           P4SUST    IFEQ WUSUST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Frght by S/T St TtlPO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Calc 5
     C                     MOVEL*BLANK    WN0002  2        Ship To State C
     C                     MOVEL*BLANK    WN0003  3        Ship To State 3
      *
      * PRT Frght by S/T St TtlPO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Frght by S/T St TtlPO: Initialise
      *================================================================
      * USER: Initialize program
     C                     Z-ADD*ZERO     WN0001           Calc 5
     C                     MOVEL*BLANK    WN0002           Ship To State C
     C                     MOVEL*BLANK    WN0003           Ship To State 3
     C                     MOVEL'`'       WN0003           Ship To State 3
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6CNTU           Count USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    F4AIC3           Company Number
     C                     MOVEL*LOVAL    F4DBCD           Ship To State C
     C                     MOVEL*LOVAL    F4BZNA           Carrier Code
     C                     MOVEL*LOVAL    F4C4NB           Order Number
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Event Code
     C                     MOVEL*BLANK    WUJPCD  2
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBORIT           Original Item
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Order
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WBESNB           Accounting Year
     C                     Z-ADD*ZERO     WBETNB           Accounting Peri
     C                     Z-ADD*ZERO     WBBZNB           OM Week
     C                     Z-ADD*ZERO     WBEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WBBYWG           Weight Billed
     C                     Z-ADD*ZERO     WBS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WBUTVA           Standard Overag
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBR8NB           Original Order
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBONVA           Actual Freight
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WBUNVA           Trade Fund Accr
     C                     Z-ADD*ZERO     WBUOVA           Commission Amou
     C                     Z-ADD*ZERO     WBUPVA           Financials Amou
     C                     Z-ADD*ZERO     WBUQVA           Financials Amou
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WBIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WBNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WBBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WBCDPR           Market Value
     C                     Z-ADD*ZERO     WBD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WBD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WBCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WBOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WBD9PR           HST Unused Pric
     C                     Z-ADD*ZERO     WBCFVL           HST Item Target
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBAIC3           Company Number
     C                     MOVEL*LOVAL    WBC4NB           Order Number
     C                     MOVEL*LOVAL    WBDPNB           Order Sequence
     C                     MOVEL*LOVAL    WBUENB           Order Secondary
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SGCRRC.
     C                     Z-ADD*ZERO     WL0001 132
     C                     Z-ADD*ZERO     WL0002 132
     C                     Z-ADD*ZERO     WL0003 132
     C                     MOVEL*BLANK    WL0004  2
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     Z-ADD*ZERO     P6CNTU           Count USR
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
