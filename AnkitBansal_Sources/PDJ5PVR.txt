     H/TITLE Tst ReClc Sch Weight  PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by  : SYNON/2  Version:  1035
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISMAREN
     H* Date          : 11/07/98  Time  : 14:28:13
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDJ5PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Tst ReClc Sch Weight  PV  Prompt & validate record
      *
     FCABZRELPIF  E           K        DISK
      * RTV : Company/Item              Unit Wgt Chg Sts = Yes
      *
     FOPBGWKLFIF  E           K        DISK
      * RSQ : PD Order Detail           Co/Itm/Whs/SSD(d)/Od Omt
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : PD Order Detail Schedule  Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : PD Order Header           Retrieval index       NV
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : PD Order Detail           Update index
      *
     FPDKNCPL0UF  E           K        DISK
      * UPD : PD Order Detail Schedule  Update index
      *
     FCABZREL0UF  E           K        DISK
      * UPD : Company/Item              Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     I@BZREIT
      * Company/Item              Unit Wgt Chg Sts = Yes
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@BGWKKG
      * PD Order Detail           Co/Itm/Whs/SSD(d)/Od Omt
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@BGWKL0
      * PD Order Detail           Update index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@KNCPHO
      * PD Order Detail Schedule  Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WDAIC3
     I              KNC4NB                          WDC4NB
     I              KNDPNB                          WDDPNB
     I              KNUENB                          WDUENB
     I              KNJGDT                          WDJGDT
     I              KNAODT                          WDAODT
     I              KNAJCD                          WDAJCD
     I              KNAYAA                          WDAYAA
     I              KNHGCD                          WDHGCD
     I              KNIGQT                          WDIGQT
     I              KNFLWG                          WDFLWG
     I              KNIUQT                          WDIUQT
     I              KNF3WG                          WDF3WG
     I              KNIVQT                          WDIVQT
     I              KNF4WG                          WDF4WG
     I              KNP7ST                          WDP7ST
     I              KNP8ST                          WDP8ST
     I              KNQAST                          WDQAST
     I              KNUVST                          WDUVST
     I              KNUWST                          WDUWST
     I              KNUXST                          WDUXST
     I              KNVSST                          WDVSST
     I              KNAATM                          WDAATM
     I              KNAYNA                          WDAYNA
     I              KNA0NA                          WDA0NA
     I              KNAXDT                          WDAXDT
      *
     I@KNCPHN
      * PD Order Detail Schedule  Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@BECPFK
      * PD Order Header           Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BZREJV
      * Company/Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WHAIC3
     I              ABADTX                          WHADTX
     I              ABACNA                          WHACNA
     I              ABADNA                          WHADNA
     I              ABAENA                          WHAENA
     I              ABAJNA                          WHAJNA
     I              ABBTTX                          WHBTTX
     I              ABBVTX                          WHBVTX
     I              ABBWTX                          WHBWTX
     I              ABA2NA                          WHA2NA
     I              ABABTX                          WHABTX
     I              ABBGCD                          WHBGCD
     I              ABKXCD                          WHKXCD
     I              ABUVST                          WHUVST
     I              ABUWST                          WHUWST
     I              ABUXST                          WHUXST
     I              ABVSST                          WHVSST
     I              ABAATM                          WHAATM
     I              ABAYNA                          WHAYNA
     I              ABA0NA                          WHA0NA
     I              ABAXDT                          WHAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WIAIC3
     I              AFBCDT                          WIBCDT
     I              AFCQNB                          WICQNB
     I              AFESNB                          WIESNB
     I              AFETNB                          WIETNB
     I              AFBZNB                          WIBZNB
     I              AFA9ST                          WIA9ST
     I              AFEINB                          WIEINB
     I              AFC5ST                          WIC5ST
     I              AFAQNB                          WIAQNB
     I              AFCMST                          WICMST
     I              AFV9ST                          WIV9ST
     I              AFWAST                          WIWAST
     I              AFX2ST                          WIX2ST
     I              AFUVST                          WIUVST
     I              AFUWST                          WIUWST
     I              AFUXST                          WIUXST
     I              AFAATM                          WIAATM
     I              AFAYNA                          WIAYNA
     I              AFA0NA                          WIA0NA
     I              AFAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : PD Order Detail           Update index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     IYARDCS      DS                            340
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : PD Order Detail Schedule  Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     IYBRDCS      DS                            100
     IQCABZ1    E DSCABZREL0
      * UPD : Company/Item              Update index
      * Renamed input format fields
     I              BZAIC3                          WGAIC3
     I              BZHGCD                          WGHGCD
     I              BZAVNA                          WGAVNA
     I              BZAWNA                          WGAWNA
     I              BZL7NA                          WGL7NA
     I              BZL8NA                          WGL8NA
     I              BZL6NA                          WGL6NA
     I              BZMFNA                          WGMFNA
     I              BZADCD                          WGADCD
     I              BZAWPC                          WGAWPC
     I              BZLXST                          WGLXST
     I              BZAECD                          WGAECD
     I              BZAXPC                          WGAXPC
     I              BZLYST                          WGLYST
     I              BZAFCD                          WGAFCD
     I              BZAICD                          WGAICD
     I              BZAIWG                          WGAIWG
     I              BZHICD                          WGHICD
     I              BZRBCD                          WGRBCD
     I              BZFZST                          WGFZST
     I              BZAVST                          WGAVST
     I              BZCZWG                          WGCZWG
     I              BZC0WG                          WGC0WG
     I              BZURTN                          WGURTN
     I              BZAJC8                          WGAJC8
     I              BZRINB                          WGRINB
     I              BZRHNB                          WGRHNB
     I              BZRGNB                          WGRGNB
     I              BZLNCD                          WGLNCD
     I              BZTFNB                          WGTFNB
     I              BZN0CD                          WGN0CD
     I              BZX4ST                          WGX4ST
     I              BZTMVA                          WGTMVA
     I              BZTNVA                          WGTNVA
     I              BZBLPR                          WGBLPR
     I              BZBMPR                          WGBMPR
     I              BZLRCD                          WGLRCD
     I              BZU9ST                          WGU9ST
     I              BZCMCO                          WGCMCO
     I              BZQ1CD                          WGQ1CD
     I              BZQ8CD                          WGQ8CD
     I              BZCHTM                          WGCHTM
     I              BZQZCD                          WGQZCD
     I              BZXWST                          WGXWST
     I              BZXXST                          WGXXST
     I              BZVMST                          WGVMST
     I              BZSWGH                          WGSWGH
     I              BZPPHE                          WGPPHE
     I              BZR3CD                          WGR3CD
     I              BZSDCD                          WGSDCD
     I              BZICN1                          WGICN1
     I              BZSVCD                          WGSVCD
     I              BZICN2                          WGICN2
     I              BZSWCD                          WGSWCD
     I              BZV2NB                          WGV2NB
     I              BZSXCD                          WGSXCD
     I              BZITCN                          WGITCN
     I              BZSYCD                          WGSYCD
     I              BZITC5                          WGITC5
     I              BZSZCD                          WGSZCD
     I              BZICN6                          WGICN6
     I              BZS0CD                          WGS0CD
     I              BZICN7                          WGICN7
     I              BZS1CD                          WGS1CD
     I              BZICN8                          WGICN8
     I              BZS2CD                          WGS2CD
     I              BZICN9                          WGICN9
     I              BZS3CD                          WGS3CD
     I              BZICN0                          WGICN0
     I              BZS4CD                          WGS4CD
     I              BZSFNB                          WGSFNB
     I              BZA3WG                          WGA3WG
     I              BZSJNB                          WGSJNB
     I              BZLLCD                          WGLLCD
     I              BZLMCD                          WGLMCD
     I              BZP3ST                          WGP3ST
     I              BZSKNB                          WGSKNB
     I              BZSLNB                          WGSLNB
     I              BZSMNB                          WGSMNB
     I              BZP4ST                          WGP4ST
     I              BZCFNB                          WGCFNB
     I              BZCGNB                          WGCGNB
     I              BZILNB                          WGILNB
     I              BZCHNB                          WGCHNB
     I              BZCINB                          WGCINB
     I              BZCJNB                          WGCJNB
     I              BZCMNB                          WGCMNB
     I              BZCNNB                          WGCNNB
     I              BZCRNB                          WGCRNB
     I              BZCSNB                          WGCSNB
     I              BZCVNB                          WGCVNB
     I              BZCWNB                          WGCWNB
     I              BZCXNB                          WGCXNB
     I              BZCZNB                          WGCZNB
     I              BZC0NB                          WGC0NB
     I              BZN1CD                          WGN1CD
     I              BZB4NB                          WGB4NB
     I              BZB5NB                          WGB5NB
     I              BZX5ST                          WGX5ST
     I              BZX6ST                          WGX6ST
     I              BZX7ST                          WGX7ST
     I              BZPCCT                          WGPCCT
     I              BZBDNB                          WGBDNB
     I              BZBJNB                          WGBJNB
     I              BZSUST                          WGSUST
     I              BZSVST                          WGSVST
     I              BZSYST                          WGSYST
     I              BZSZST                          WGSZST
     I              BZS1ST                          WGS1ST
     I              BZXRCD                          WGXRCD
     I              BZXTCD                          WGXTCD
     I              BZXUCD                          WGXUCD
     I              BZF5WG                          WGF5WG
     I              BZF6WG                          WGF6WG
     I              BZF7WG                          WGF7WG
     I              BZBLNB                          WGBLNB
     I              BZBNNB                          WGBNNB
     I              BZS2ST                          WGS2ST
     I              BZS4ST                          WGS4ST
     I              BZS5ST                          WGS5ST
     I              BZS6ST                          WGS6ST
     I              BZS8ST                          WGS8ST
     I              BZS9ST                          WGS9ST
     I              BZTCST                          WGTCST
     I              BZTDST                          WGTDST
     I              BZUVST                          WGUVST
     I              BZUWST                          WGUWST
     I              BZUXST                          WGUXST
     I              BZVSST                          WGVSST
     I              BZAATM                          WGAATM
     I              BZAYNA                          WGAYNA
     I              BZA0NA                          WGA0NA
     I              BZAXDT                          WGAXDT
      *
     IYCRDCS      DS                            605
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Order De-Alc/Alc Sts USR
     I                                        1   1 P1F8ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1F8ST    PARM           WP0001  1        Order De-Alc/Al
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * UPS ReClc Wgt Sched   RT - Company/Item  * 
     C                     EXSR SARVGN
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Company Name and Address
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to Calendar
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 20        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVEL*BLANK    #1V5ST           Production Type
     C                     Z-ADD*ZERO     #1ELDT           Production Date
     C                     Z-ADD*ZERO     #1HVHD           Hog Volume
     C                     Z-ADD*ZERO     #1Z6NB           Average Live We
     C                     Z-ADD*ZERO     #1Z7NB           Average Hot Wei
     C                     Z-ADD*ZERO     #1DGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     #1AVCW           Average Cold We
     C                     Z-ADD*ZERO     #1DIPC           Average Lean Pe
     C                     Z-ADD*ZERO     #1Z0NB           Average Backfat
     C                     Z-ADD*ZERO     #1AVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     #1ECWG           Hot Weight Tota
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@BZREIT                    *
     C           KRSSA     READE@BZREIT                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * UPS ReClc Wgt Sched   RT - PD Order Detail  * 
     C                     EXSR SBRVGN
      * Chg Unit Wgt Chg Sts  CH - Company/Item  * 
     C                     EXSR SGCHRC
     C           KRSSA     READE@BZREIT                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAHGCD    WQSB02           Item Code
      * Establish starting position
     C           KRSSB     SETLL@BGWKKG                    *
     C           KRSSB     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBCCQT    MULT WAAIWG    WN0001    H      Weight Schedule
      * Chg Wgt Sched,Unit Wt CH - PD Order Detail  * 
     C                     EXSR SCCHRC
      * UPS ReClc Wgt Sched   RT - PD Order Detail Schedule  * 
     C                     EXSR SDRVGN
      * ****    PDD012   ********
      * EDT Post Open Orders   XF - PD Order Header  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM WBC4NB    WQ0002  70       Order Number
     C                     PARM WBBKC7    WQ0003  70       Ship To Custome
     C           WUB5VL    PARM WUB5VL    WQ0004 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0005 112       Order Weight To
     C                     PARM 'UWC'     WQ0006  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Load ID            RT - PD Order Header  * 
     C                     EXSR SFRVGN
      * RTV UPD Ld Abs.Frt/Wgt XF - PD Order Header  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0007  30       Company Number
     C                     PARM WURMNB    WQ0008  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0009  70       Total Weight
     C           WURQNB    PARM WURQNB    WQ0010 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KRSSB     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Wgt Sched,Unit Wt CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       Item Code
     C                     MOVEL*BLANK    WN0003  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0004  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0005  70       Order Group Cod
     C                     MOVEL*BLANK    WN0006  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0007  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0008 112       Billing Detail
     C                     Z-ADD*ZERO     WN0009 112       Billing Detail
     C                     Z-ADD*ZERO     WN0010 112       Billing Detail
     C                     Z-ADD*ZERO     WN0011 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0012  1        Comment Print A
     C                     MOVEL*BLANK    WN0013  1        Comment Print I
     C                     MOVEL*BLANK    WN0014  1        Comment Print P
     C                     MOVEL*BLANK    WN0015  1        Comment Print S
     C                     Z-ADD*ZERO     WN0016 112       Extended Amount
     C                     Z-ADD*ZERO     WN0017  70       Market Pricing
     C                     MOVEL*BLANK    WN0018  3        Commodity Marke
     C                     MOVEL*BLANK    WN0019  3        Date Method Cod
     C                     MOVEL*BLANK    WN0020  3        Price Method Co
     C                     Z-ADD*ZERO     WN0021 114       Price Overage O
     C                     Z-ADD*ZERO     WN0022  70       Contract Number
     C                     MOVEL*BLANK    WN0023  1        Price Status
     C                     Z-ADD*ZERO     WN0024  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0025  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0026  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0027  1        Work Confirm St
     C                     MOVEL*BLANK    WN0028  1        Work Over/Short
     C                     MOVEL*BLANK    WN0029  1        Work Extra Stat
     C                     MOVEL*BLANK    WN0030 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0031 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0032  1        Age Code
     C                     MOVEL*BLANK    WN0033  1        Palletize
     C                     MOVEL*BLANK    WN0034  1        Slip Sheet
     C                     MOVEL*BLANK    WN0035  1        Catch Weight St
     C                     MOVEL*BLANK    WN0036  1        Price Audit
     C                     MOVEL*BLANK    WN0037  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0038  1        Production Date
     C                     Z-ADD*ZERO     WN0039 112       Rated Freight
     C                     Z-ADD*ZERO     WN0040 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0041 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0042 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0043 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0044 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Price
     C                     Z-ADD*ZERO     WN0048 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0049 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0050 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0051  70       Requested Ship
     C                     Z-ADD*ZERO     WN0052  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0053  70       Actual Shipped
     C                     MOVEL*BLANK    WN0054  1        Affect Inventor
     C                     MOVEL*BLANK    WN0055  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0056  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     MOVEL*BLANK    WN0060  2        Item Level
     C                     MOVEL*BLANK    WN0061  2        Quality Level
     C                     MOVEL*BLANK    WN0062  2        Pricing Product
     C                     MOVEL*BLANK    WN0063  2        Season Product
     C                     Z-ADD*ZERO     WN0064  70       Date of Origina
     C                     MOVEL*BLANK    WN0065 10        User Profile Na
     C                     MOVEL*BLANK    WN0066  6        Country Code
     C                     MOVEL*BLANK    WN0067  2        Event Code
     C                     MOVEL*BLANK    WN0068  3        Reason Code
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  1        Modified Flag
     C                     MOVEL*BLANK    WN0071  1        Substituted Fla
     C                     MOVEL*BLANK    WN0072  1        Order Detail St
     C                     MOVEL*BLANK    WN0073  1        EDI Status 1
     C                     MOVEL*BLANK    WN0074  1        EDI Status 2
     C                     MOVEL*BLANK    WN0075  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0076  60       Job Time
     C                     MOVEL*BLANK    WN0077 10        User Id
     C                     MOVEL*BLANK    WN0078 10        Job Name
     C                     Z-ADD*ZERO     WN0079  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
     C                     Z-ADDWBDPNB    WCDPNB           Order Sequence
     C                     Z-ADDWBUENB    WCUENB           Order Secondary
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C           KLCHSC    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0001    WCAUWG           Weight Schedule
     C                     Z-ADDWAAIWG    WCAVWG           Unit Weight Ord
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * UPS ReClc Wgt Sched   RT - PD Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0080 112       OD Weight Sched
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
     C           *LIKE     DEFN WDDPNB    WQSD03           Order Sequence
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
      * Setup key
     C                     Z-ADDWBAIC3    WQSD01           Company Number
     C                     Z-ADDWBC4NB    WQSD02           Order Number
     C                     Z-ADDWBDPNB    WQSD03           Order Sequence
      * Establish starting position
     C           KRSSD     SETLL@KNCPHO                    *
     C           KRSSD     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WDIGQT    MULT WAAIWG    WN0080    H      OD Weight Sched
      * CHG Weight Scheduled   CH - PD Order Detail Schedule  * 
     C                     EXSR SECHRC
     C           KRSSD     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * CHG Weight Scheduled   CH - PD Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0081  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0082  3        Warehouse Code
     C                     MOVEL*BLANK    WN0083  3        Order From Ware
     C                     Z-ADD*ZERO     WN0084  70       Item Code
     C                     Z-ADD*ZERO     WN0085 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0086 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0087 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0088 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0089 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0090  1        OD Status Unuse
     C                     MOVEL*BLANK    WN0091  1        OD Status Unuse
     C                     MOVEL*BLANK    WN0092  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0093  1        EDI Status 1
     C                     MOVEL*BLANK    WN0094  1        EDI Status 2
     C                     MOVEL*BLANK    WN0095  1        EDI Status 3
     C                     MOVEL*BLANK    WN0096  1        Record Status
     C                     Z-ADD*ZERO     WN0097  60       Job Time
     C                     MOVEL*BLANK    WN0098 10        User Id
     C                     MOVEL*BLANK    WN0099 10        Job Name
     C                     Z-ADD*ZERO     WN0100  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDC4NB    WEC4NB           Order Number
     C                     Z-ADDWDDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWDUENB    WEUENB           Order Secondary
     C                     Z-ADDWDJGDT    WEJGDT           OD Production D
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHSE    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YBRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0080    WEFLWG           OD Weight Sched
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WFAIC3           Company Number
     C                     Z-ADDWBC4NB    WFC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFRMNB    WURMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Unit Wgt Chg Sts  CH - Company/Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0101 30        Description Lin
     C                     MOVEL*BLANK    WN0102 30        Description Lin
     C                     MOVEL*BLANK    WN0103 32        Item Label Line
     C                     MOVEL*BLANK    WN0104 32        Item Label Line
     C                     MOVEL*BLANK    WN0105 32        Item Label Line
     C                     MOVEL*BLANK    WN0106 32        Item Label Line
     C                     MOVEL*BLANK    WN0107  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0108  94       Conversion Fact
     C                     MOVEL*BLANK    WN0109  1        Operation Facto
     C                     MOVEL*BLANK    WN0110  2        U/M - Second
     C                     Z-ADD*ZERO     WN0111  94       Conversion Fact
     C                     MOVEL*BLANK    WN0112  1        Operation Facto
     C                     MOVEL*BLANK    WN0113  2        U/M - Third
     C                     MOVEL*BLANK    WN0114  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0115 112       Unit Weight
     C                     MOVEL*BLANK    WN0116  2        Quality Level
     C                     MOVEL*BLANK    WN0117  2        Item Level
     C                     MOVEL*BLANK    WN0118  1        Production Date
     C                     MOVEL*BLANK    WN0119  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0120 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0121 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0122  50       Number Cases On
     C                     Z-ADD*ZERO     WN0123  80       Vendor - Item D
     C                     Z-ADD*ZERO     WN0124  30       Item Structure
     C                     Z-ADD*ZERO     WN0125  30       Item Structure
     C                     Z-ADD*ZERO     WN0126  30       Item Structure
     C                     MOVEL*BLANK    WN0127  3        Default Commod
     C                     Z-ADD*ZERO     WN0128  30       Transportation
     C                     MOVEL*BLANK    WN0129  3        Item Type Code
     C                     MOVEL*BLANK    WN0130  1        Package Type Co
     C                     Z-ADD*ZERO     WN0131 112       Maximum Audit V
     C                     Z-ADD*ZERO     WN0132 112       Minimum Audit V
     C                     Z-ADD*ZERO     WN0133 114       Market Overage
     C                     Z-ADD*ZERO     WN0134 114       Standard Overag
     C                     MOVEL*BLANK    WN0135  7        Commodity Price
     C                     MOVEL*BLANK    WN0136  1        Item Pricing Op
     C                     Z-ADD*ZERO     WN0137 114       Item Pricing Co
     C                     MOVEL*BLANK    WN0138  3        Default Warehou
     C                     MOVEL*BLANK    WN0139  3        Price Method De
     C                     Z-ADD*ZERO     WN0140  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0141  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0142  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0143  1        Case Ready Stat
     C                     MOVEL*BLANK    WN0144  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0145 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0146  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0147  6        Department Code
     C                     MOVEL*BLANK    WN0148  1        PD Code UnUsed
     C                     Z-ADD*ZERO     WN0149  20       Item Category N
     C                     MOVEL*BLANK    WN0150  3        Item Category C
     C                     Z-ADD*ZERO     WN0151  20       Item Category N
     C                     MOVEL*BLANK    WN0152  3        Item Category C
     C                     Z-ADD*ZERO     WN0153  20       Item Category N
     C                     MOVEL*BLANK    WN0154  3        Item Category C
     C                     Z-ADD*ZERO     WN0155  20       Item Category N
     C                     MOVEL*BLANK    WN0156  3        Item Category C
     C                     Z-ADD*ZERO     WN0157  20       Item Category N
     C                     MOVEL*BLANK    WN0158  3        Item Category C
     C                     Z-ADD*ZERO     WN0159  20       Item Category N
     C                     MOVEL*BLANK    WN0160  3        Item Category C
     C                     Z-ADD*ZERO     WN0161  20       Item Category N
     C                     MOVEL*BLANK    WN0162  3        Item Category C
     C                     Z-ADD*ZERO     WN0163  20       Item Category N
     C                     MOVEL*BLANK    WN0164  3        Item Category C
     C                     Z-ADD*ZERO     WN0165  20       Item Category N
     C                     MOVEL*BLANK    WN0166  3        Item Category C
     C                     Z-ADD*ZERO     WN0167  20       Iten Category N
     C                     MOVEL*BLANK    WN0168  3        Item Category C
     C                     Z-ADD*ZERO     WN0169  52       UnUsed NBR 5.2
     C                     Z-ADD*ZERO     WN0170  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WN0171  30       Packages (Trays
     C                     MOVEL*BLANK    WN0172  3        Packaging Code
     C                     MOVEL*BLANK    WN0173  3        Grade Code
     C                     MOVEL*BLANK    WN0174  1        Agrimetrics Ran
     C                     Z-ADD*ZERO     WN0175  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0176  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0177  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0178  1        Agritech Captur
     C                     Z-ADD*ZERO     WN0179 114       PM Pounds per H
     C                     Z-ADD*ZERO     WN0180  74       PM Line Time Ef
     C                     Z-ADD*ZERO     WN0181  74       PM % 2nds Facto
     C                     Z-ADD*ZERO     WN0182  30       PM Crew Size
     C                     Z-ADD*ZERO     WN0183 114       PM Batch Size
     C                     Z-ADD*ZERO     WN0184 114       PM Lot Size
     C                     Z-ADD*ZERO     WN0185  70       PM BOM Spec Dat
     C                     Z-ADD*ZERO     WN0186  70       PM Seaboard Spe
     C                     Z-ADD*ZERO     WN0187  70       PM Seaboard Rep
     C                     Z-ADD*ZERO     WN0188  92       PM Raw Yield
     C                     Z-ADD*ZERO     WN0189  92       PM Formula Yiel
     C                     Z-ADD*ZERO     WN0190 114       PM Standard LBS
     C                     Z-ADD*ZERO     WN0191 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WN0192 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WN0193 114       PM Finished LBS
     C                     MOVEL*BLANK    WN0194  3        PM ABC Class
     C                     Z-ADD*ZERO     WN0195  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0196  50       PM Line Number
     C                     MOVEL*BLANK    WN0197  1        Seconds Item
     C                     MOVEL*BLANK    WN0198  2        Print on Realiz
     C                     MOVEL*BLANK    WN0199  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0200  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0201  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0202  1        Export/Domestic
     C                     MOVEL*BLANK    WN0203  1        Print On Schedu
     C                     MOVEL*BLANK    WN0204  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0205  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0206  1        Frozen Sched As
     C                     MOVEL*BLANK    WN0207  6        Primal Group Co
     C                     MOVEL*BLANK    WN0208 12        UPC Code 1
     C                     MOVEL*BLANK    WN0209 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0210 112       CI Unused Wgt 1
     C                     Z-ADD*ZERO     WN0211 112       CI Unused Wgt 2
     C                     Z-ADD*ZERO     WN0212 112       CI Unused Wgt 3
     C                     Z-ADD*ZERO     WN0213  70       CI Unused Nbr 1
     C                     Z-ADD*ZERO     WN0214  70       CI Unused Nbr 2
     C                     MOVEL*BLANK    WN0215  1        Scheduling Posi
     C                     MOVEL*BLANK    WN0216  1        CI Unused Sts 2
     C                     MOVEL*BLANK    WN0217  1        CI Unused Sts 3
     C                     MOVEL*BLANK    WN0218  1        CI Unused Sts 4
     C                     MOVEL*BLANK    WN0219  2        CI Unused Sts 5
     C                     MOVEL*BLANK    WN0220  2        CI Unused Sts 6
     C                     MOVEL*BLANK    WN0221  3        CI Unused Sts 7
     C                     MOVEL*BLANK    WN0222  3        CI Unused Sts 8
     C                     MOVEL*BLANK    WN0223  1        EDI Status 1
     C                     MOVEL*BLANK    WN0224  1        EDI Status 2
     C                     MOVEL*BLANK    WN0225  1        EDI Status 3
     C                     MOVEL*BLANK    WN0226  1        Record Status
     C                     Z-ADD*ZERO     WN0227  60       Job Time
     C                     MOVEL*BLANK    WN0228 10        User Id
     C                     MOVEL*BLANK    WN0229 10        Job Name
     C                     Z-ADD*ZERO     WN0230  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BZREJV
     C                     Z-ADDWAAIC3    WGAIC3           Company Number
     C                     Z-ADDWAHGCD    WGHGCD           Item Code
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C           KLCHSG    CHAIN@BZREJV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CABZREL0'MDACP
     C                     MOVEL'@BZREJV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCABZ1    YCRDCS
      * Move non-key fields to @BZREJV
     C                     MOVE *BLANK    WGX7ST           Unit Weight Cha
     C                     MOVEL'NO'      WGX7ST           Unit Weight Cha
      *
      * Set PGM.*Record Data Changed flag
     C           QCABZ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCABZ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BZREJV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0011  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWH    KLIST
     C                     KFLD           WHAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WHAIC3
     C           KLVAWH    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ELDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    WIAIC3
     C                     Z-ADD#1ELDT    WIBCDT
     C           KLVBWI    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE029
     C           ZHCSCL    ANDLE031
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3  30       Company Number
     C                     Z-ADD*ZERO     WAHGCD  70       Item Code
     C                     Z-ADD*ZERO     WAAWPC  94       Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC  94       Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG 112       Unit Weight
     C                     Z-ADD*ZERO     WACZWG 112       Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG 112       Maximum Weight
     C                     Z-ADD*ZERO     WAURTN  50       Number Cases On
     C                     Z-ADD*ZERO     WAAJC8  80       Vendor - Item D
     C                     Z-ADD*ZERO     WARINB  30       Item Structure
     C                     Z-ADD*ZERO     WARHNB  30       Item Structure
     C                     Z-ADD*ZERO     WARGNB  30       Item Structure
     C                     Z-ADD*ZERO     WATFNB  30       Transportation
     C                     Z-ADD*ZERO     WATMVA 112       Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA 112       Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR 114       Market Overage
     C                     Z-ADD*ZERO     WABMPR 114       Standard Overag
     C                     Z-ADD*ZERO     WACMCO 114       Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM  52       Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH 112       Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE  70       Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1  20       Item Category N
     C                     Z-ADD*ZERO     WAICN2  20       Item Category N
     C                     Z-ADD*ZERO     WAV2NB  20       Item Category N
     C                     Z-ADD*ZERO     WAITCN  20       Item Category N
     C                     Z-ADD*ZERO     WAITC5  20       Item Category N
     C                     Z-ADD*ZERO     WAICN6  20       Item Category N
     C                     Z-ADD*ZERO     WAICN7  20       Item Category N
     C                     Z-ADD*ZERO     WAICN8  20       Item Category N
     C                     Z-ADD*ZERO     WAICN9  20       Item Category N
     C                     Z-ADD*ZERO     WAICN0  20       Iten Category N
     C                     Z-ADD*ZERO     WASFNB  52       UnUsed NBR 5.2
     C                     Z-ADD*ZERO     WAA3WG  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB  30       Packages (Trays
     C                     Z-ADD*ZERO     WASKNB  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB  20       Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB 114       PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB  74       PM Line Time Ef
     C                     Z-ADD*ZERO     WAILNB  74       PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB  30       PM Crew Size
     C                     Z-ADD*ZERO     WACINB 114       PM Batch Size
     C                     Z-ADD*ZERO     WACJNB 114       PM Lot Size
     C                     Z-ADD*ZERO     WACMNB  70       PM BOM Spec Dat
     C                     Z-ADD*ZERO     WACNNB  70       PM Seaboard Spe
     C                     Z-ADD*ZERO     WACRNB  70       PM Seaboard Rep
     C                     Z-ADD*ZERO     WACSNB  92       PM Raw Yield
     C                     Z-ADD*ZERO     WACVNB  92       PM Formula Yiel
     C                     Z-ADD*ZERO     WACWNB 114       PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB 114       PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB 114       PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB 114       PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB  50       PM Line Number
     C                     Z-ADD*ZERO     WABDNB  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB  70       Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG 112       CI Unused Wgt 1
     C                     Z-ADD*ZERO     WAF6WG 112       CI Unused Wgt 2
     C                     Z-ADD*ZERO     WAF7WG 112       CI Unused Wgt 3
     C                     Z-ADD*ZERO     WABLNB  70       CI Unused Nbr 1
     C                     Z-ADD*ZERO     WABNNB  70       CI Unused Nbr 2
     C                     Z-ADD*ZERO     WAAATM  60       Job Time
     C                     Z-ADD*ZERO     WAAXDT  70       Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3  30       Company Number
     C                     Z-ADD*ZERO     WBC4NB  70       Order Number
     C                     Z-ADD*ZERO     WBDPNB  30       Order Sequence
     C                     Z-ADD*ZERO     WBUENB  30       Order Secondary
     C                     Z-ADD*ZERO     WBHGCD  70       Item Code
     C                     Z-ADD*ZERO     WBBKC7  70       Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7  70       Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA 112       Billing Detail
     C                     Z-ADD*ZERO     WBKDVA 112       Billing Detail
     C                     Z-ADD*ZERO     WBL8VA 112       Billing Detail
     C                     Z-ADD*ZERO     WBL9VA 112       Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA 112       Extended Amount
     C                     Z-ADD*ZERO     WBEXDT  70       Market Pricing
     C                     Z-ADD*ZERO     WBBZPR 114       Price Overage O
     C                     Z-ADD*ZERO     WBL6NB  70       Contract Number
     C                     Z-ADD*ZERO     WBGIDT  70       Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB 112       Rated Freight
     C                     Z-ADD*ZERO     WBAVQT 112       Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG 112       Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT 112       Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG 112       Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT 112       Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG 112       Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS 114       Unit Cost Order
     C                     Z-ADD*ZERO     WBAGCS 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR 114       Unit Price
     C                     Z-ADD*ZERO     WBALPR 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR 114       Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT  70       Requested Ship
     C                     Z-ADD*ZERO     WBAODT  70       Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT  70       Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB  30       Item Structure
     C                     Z-ADD*ZERO     WBRHNB  30       Item Structure
     C                     Z-ADD*ZERO     WBRINB  30       Item Structure
     C                     Z-ADD*ZERO     WBCXDT  70       Date of Origina
     C                     Z-ADD*ZERO     WBAATM  60       Job Time
     C                     Z-ADD*ZERO     WBAXDT  70       Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3  30       Company Number
     C                     Z-ADD*ZERO     WDC4NB  70       Order Number
     C                     Z-ADD*ZERO     WDDPNB  30       Order Sequence
     C                     Z-ADD*ZERO     WDUENB  30       Order Secondary
     C                     Z-ADD*ZERO     WDJGDT  70       OD Production D
     C                     Z-ADD*ZERO     WDAODT  70       Scheduled Ship
     C                     Z-ADD*ZERO     WDHGCD  70       Item Code
     C                     Z-ADD*ZERO     WDIGQT 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WDFLWG 112       OD Weight Sched
     C                     Z-ADD*ZERO     WDIUQT 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WDF3WG 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WDIVQT 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WDF4WG 112       OD Weight Unuse
     C                     Z-ADD*ZERO     WDAATM  60       Job Time
     C                     Z-ADD*ZERO     WDAXDT  70       Job Date
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3  30       Company Number
     C                     Z-ADD*ZERO     WFC4NB  70       Order Number
     C                     Z-ADD*ZERO     WFANC7  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7  70       Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7  70       Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT  70       Order Date
     C                     Z-ADD*ZERO     WFA5DT  70       Requested Ship
     C                     Z-ADD*ZERO     WFGNDT  70       Actual Shipped
     C                     Z-ADD*ZERO     WFACDT  70       Cancel Date
     C                     Z-ADD*ZERO     WFAODT  70       Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT  70       Date of Origina
     C                     Z-ADD*ZERO     WFJZVA 112       Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG 112       Order Weight To
     C                     Z-ADD*ZERO     WFEIDT  70       Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM  40       Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB  70       Load ID
     C                     Z-ADD*ZERO     WFTBNB  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB 112       Rated Freight
     C                     Z-ADD*ZERO     WFRNNB  52       Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN  70       Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN  70       Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB  70       Attach to Order
     C                     Z-ADD*ZERO     WFCONB  70       Invoice Number
     C                     Z-ADD*ZERO     WFAWDT  70       Invoice Date
     C                     Z-ADD*ZERO     WFVRVA 112       A/R order Value
     C                     Z-ADD*ZERO     WFAATM  60       Job Time
     C                     Z-ADD*ZERO     WFAXDT  70       Job Date
      * Define work field Total Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3  30       Company Number
     C                     Z-ADD*ZERO     WHAATM  60       Job Time
     C                     Z-ADD*ZERO     WHAXDT  70       Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3  30       Company Number
     C                     Z-ADD*ZERO     WIBCDT  70       Post to G/L Dat
     C                     Z-ADD*ZERO     WICQNB  50       Julian Date
     C                     Z-ADD*ZERO     WIESNB  40       Accounting Year
     C                     Z-ADD*ZERO     WIETNB  20       Accounting Peri
     C                     Z-ADD*ZERO     WIBZNB  30       OM Week
     C                     Z-ADD*ZERO     WIEINB  20       Week Number
     C                     Z-ADD*ZERO     WIAQNB  20       Billing Cycle
     C                     Z-ADD*ZERO     WIAATM  60       Job Time
     C                     Z-ADD*ZERO     WIAXDT  70       Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
