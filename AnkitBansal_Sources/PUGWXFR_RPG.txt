     H/TITLE Cnv Upd Dln Dpt Dte/TmeXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 03/29/18  Time  : 17:12:38
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     Fdldptdttm if   e           k disk                                         DLn Dpt DtTm RawData
     FOMFJCPL0  IF   E           K DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPL1  IF   E           K DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFJCPL1  UF   E           K DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0  UF   E           K DISK
      * UPD : Load Detail               Update index
      *
     FOPBGWKL0  UF   E           K DISK
      * UPD : Order Detail              Update index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QOMFJ1        E DS                  EXTNAME(OMFJCPL1)
      * UPD : Load Header               Update index
      * Renamed input format fields
     D  WBRMNB       E                     EXTFLD(FJRMNB)
     D  WBAIC3       E                     EXTFLD(FJAIC3)
     D  WBAODT       E                     EXTFLD(FJAODT)
     D  WBPJST       E                     EXTFLD(FJPJST)
     D  WBPKST       E                     EXTFLD(FJPKST)
     D  WBRNNB       E                     EXTFLD(FJRNNB)
     D  WBDMTX       E                     EXTFLD(FJDMTX)
     D  WBDNTX       E                     EXTFLD(FJDNTX)
     D  WBDOTX       E                     EXTFLD(FJDOTX)
     D  WBWTTX       E                     EXTFLD(FJWTTX)
     D  WBWUTX       E                     EXTFLD(FJWUTX)
     D  WBRPNB       E                     EXTFLD(FJRPNB)
     D  WBFLAM       E                     EXTFLD(FJFLAM)
     D  WBXQST       E                     EXTFLD(FJXQST)
     D  WBRRNB       E                     EXTFLD(FJRRNB)
     D  WBDXTX       E                     EXTFLD(FJDXTX)
     D  WBDYTX       E                     EXTFLD(FJDYTX)
     D  WBSBNB       E                     EXTFLD(FJSBNB)
     D  WBBZNA       E                     EXTFLD(FJBZNA)
     D  WBRONB       E                     EXTFLD(FJRONB)
     D  WBSQNB       E                     EXTFLD(FJSQNB)
     D  WBR1NB       E                     EXTFLD(FJR1NB)
     D  WBVCST       E                     EXTFLD(FJVCST)
     D  WBVDST       E                     EXTFLD(FJVDST)
     D  WBSDNB       E                     EXTFLD(FJSDNB)
     D  WBPAOU       E                     EXTFLD(FJPAOU)
     D  WBDGWG       E                     EXTFLD(FJDGWG)
     D  WBSXNB       E                     EXTFLD(FJSXNB)
     D  WBHADT       E                     EXTFLD(FJHADT)
     D  WBAART       E                     EXTFLD(FJAART)
     D  WBDHWG       E                     EXTFLD(FJDHWG)
     D  WBDIWG       E                     EXTFLD(FJDIWG)
     D  WBAQDT       E                     EXTFLD(FJAQDT)
     D  WBS6NB       E                     EXTFLD(FJS6NB)
     D  WBT4NB       E                     EXTFLD(FJT4NB)
     D  WBPRTM       E                     EXTFLD(FJPRTM)
     D  WBNPSV       E                     EXTFLD(FJNPSV)
     D  WBJ8TX       E                     EXTFLD(FJJ8TX)
     D  WBTLMI       E                     EXTFLD(FJTLMI)
     D  WBJ9TX       E                     EXTFLD(FJJ9TX)
     D  WBQ2CD       E                     EXTFLD(FJQ2CD)
     D  WBVPCD       E                     EXTFLD(FJVPCD)
     D  WBDBCD       E                     EXTFLD(FJDBCD)
     D  WBGRWE       E                     EXTFLD(FJGRWE)
     D  WBXCCD       E                     EXTFLD(FJXCCD)
     D  WBU2ST       E                     EXTFLD(FJU2ST)
     D  WBF9DT       E                     EXTFLD(FJF9DT)
     D  WBONTM       E                     EXTFLD(FJONTM)
     D  WBJ4DT       E                     EXTFLD(FJJ4DT)
     D  WBTRTM       E                     EXTFLD(FJTRTM)
     D  WBJ5DT       E                     EXTFLD(FJJ5DT)
     D  WBSPTM       E                     EXTFLD(FJSPTM)
     D  WBJ6DT       E                     EXTFLD(FJJ6DT)
     D  WBLFTM       E                     EXTFLD(FJLFTM)
     D  WBJ7DT       E                     EXTFLD(FJJ7DT)
     D  WBBOTM       E                     EXTFLD(FJBOTM)
     D  WBJ8DT       E                     EXTFLD(FJJ8DT)
     D  WBBLTM       E                     EXTFLD(FJBLTM)
     D  WBKIDT       E                     EXTFLD(FJKIDT)
     D  WBASTM       E                     EXTFLD(FJASTM)
     D  WBKADT       E                     EXTFLD(FJKADT)
     D  WBAJCM       E                     EXTFLD(FJAJCM)
     D  WBXACD       E                     EXTFLD(FJXACD)
     D  WBOANA       E                     EXTFLD(FJOANA)
     D  WBK4TX       E                     EXTFLD(FJK4TX)
     D  WBVOAG       E                     EXTFLD(FJVOAG)
     D  WBKBDT       E                     EXTFLD(FJKBDT)
     D  WBNBBO       E                     EXTFLD(FJNBBO)
     D  WBW4CD       E                     EXTFLD(FJW4CD)
     D  WBEFDT       E                     EXTFLD(FJEFDT)
     D  WBCNTN       E                     EXTFLD(FJCNTN)
     D  WBKCDT       E                     EXTFLD(FJKCDT)
     D  WBTMIN       E                     EXTFLD(FJTMIN)
     D  WBKDDT       E                     EXTFLD(FJKDDT)
     D  WBVMNB       E                     EXTFLD(FJVMNB)
     D  WBOCFR       E                     EXTFLD(FJOCFR)
     D  WBKJDT       E                     EXTFLD(FJKJDT)
     D  WBATTM       E                     EXTFLD(FJATTM)
     D  WBOTRS       E                     EXTFLD(FJOTRS)
     D  WBRNST       E                     EXTFLD(FJRNST)
     D  WBBRBK       E                     EXTFLD(FJBRBK)
     D  WBEIDT       E                     EXTFLD(FJEIDT)
     D  WBRMST       E                     EXTFLD(FJRMST)
     D  WBAJCD       E                     EXTFLD(FJAJCD)
     D  WBKKDT       E                     EXTFLD(FJKKDT)
     D  WBAVTM       E                     EXTFLD(FJAVTM)
     D  WBKZDT       E                     EXTFLD(FJKZDT)
     D  WBAXTM       E                     EXTFLD(FJAXTM)
     D  WBLHOS       E                     EXTFLD(FJLHOS)
     D  WBLHOR       E                     EXTFLD(FJLHOR)
     D  WBWNTX       E                     EXTFLD(FJWNTX)
     D  WBOITX       E                     EXTFLD(FJOITX)
     D  WBOJTX       E                     EXTFLD(FJOJTX)
     D  WBLLDT       E                     EXTFLD(FJLLDT)
     D  WBLSHG       E                     EXTFLD(FJLSHG)
     D  WBYPST       E                     EXTFLD(FJYPST)
     D  WBK0DT       E                     EXTFLD(FJK0DT)
     D  WBAYTM       E                     EXTFLD(FJAYTM)
     D  WBKNNX       E                     EXTFLD(FJKNNX)
     D  WBICWG       E                     EXTFLD(FJICWG)
     D  WBIDWG       E                     EXTFLD(FJIDWG)
     D  WBH9SX       E                     EXTFLD(FJH9SX)
     D  WBWOTX       E                     EXTFLD(FJWOTX)
     D  WBK1DT       E                     EXTFLD(FJK1DT)
     D  WBAZTM       E                     EXTFLD(FJAZTM)
     D  WBK2DT       E                     EXTFLD(FJK2DT)
     D  WBA0TM       E                     EXTFLD(FJA0TM)
     D  WBROST       E                     EXTFLD(FJROST)
     D  WBRPST       E                     EXTFLD(FJRPST)
     D  WBRQST       E                     EXTFLD(FJRQST)
     D  WBRRST       E                     EXTFLD(FJRRST)
     D  WBZBVA       E                     EXTFLD(FJZBVA)
     D  WBWPTX       E                     EXTFLD(FJWPTX)
     D  WBWQTX       E                     EXTFLD(FJWQTX)
     D  WBWRTX       E                     EXTFLD(FJWRTX)
     D  WBWSTX       E                     EXTFLD(FJWSTX)
     D  WBRVSX       E                     EXTFLD(FJRVSX)
     D  WBRUSX       E                     EXTFLD(FJRUSX)
     D  WBRWSX       E                     EXTFLD(FJRWSX)
     D  WBRXSX       E                     EXTFLD(FJRXSX)
     D  WBRYSX       E                     EXTFLD(FJRYSX)
     D  WBRZSX       E                     EXTFLD(FJRZSX)
     D  WBR0SX       E                     EXTFLD(FJR0SX)
     D  WBR1SX       E                     EXTFLD(FJR1SX)
     D  WBR2SX       E                     EXTFLD(FJR2SX)
     D  WBR3SX       E                     EXTFLD(FJR3SX)
     D  WBR4SX       E                     EXTFLD(FJR4SX)
     D  WBPYDT       E                     EXTFLD(FJPYDT)
     D  WBCKTM       E                     EXTFLD(FJCKTM)
     D  WBPZDT       E                     EXTFLD(FJPZDT)
     D  WBCLTM       E                     EXTFLD(FJCLTM)
     D  WBP0DT       E                     EXTFLD(FJP0DT)
     D  WBCMTM       E                     EXTFLD(FJCMTM)
     D  WBP1DT       E                     EXTFLD(FJP1DT)
     D  WBCNTM       E                     EXTFLD(FJCNTM)
     D  WBP2DT       E                     EXTFLD(FJP2DT)
     D  WBCOTM       E                     EXTFLD(FJCOTM)
     D  WBP3DT       E                     EXTFLD(FJP3DT)
     D  WBCQTM       E                     EXTFLD(FJCQTM)
     D  WBUVST       E                     EXTFLD(FJUVST)
     D  WBUWST       E                     EXTFLD(FJUWST)
     D  WBUXST       E                     EXTFLD(FJUXST)
     D  WBAATM       E                     EXTFLD(FJAATM)
     D  WBAYNA       E                     EXTFLD(FJAYNA)
     D  WBA0NA       E                     EXTFLD(FJA0NA)
     D  WBAXDT       E                     EXTFLD(FJAXDT)
      *
     D YARDCS          DS           793
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QOMFL1        E DS                  EXTNAME(OMFLCPL0)
      * UPD : Load Detail               Update index
      * Renamed input format fields
     D  WDRMNB       E                     EXTFLD(FLRMNB)
     D  WDRUNB       E                     EXTFLD(FLRUNB)
     D  WDRVNB       E                     EXTFLD(FLRVNB)
     D  WDDQTX       E                     EXTFLD(FLDQTX)
     D  WDRWNB       E                     EXTFLD(FLRWNB)
     D  WDRXNB       E                     EXTFLD(FLRXNB)
     D  WDSQNB       E                     EXTFLD(FLSQNB)
     D  WDT0NB       E                     EXTFLD(FLT0NB)
     D  WDT1NB       E                     EXTFLD(FLT1NB)
     D  WDR1NB       E                     EXTFLD(FLR1NB)
     D  WDAIC3       E                     EXTFLD(FLAIC3)
     D  WDC4NB       E                     EXTFLD(FLC4NB)
     D  WDVCST       E                     EXTFLD(FLVCST)
     D  WDKEDT       E                     EXTFLD(FLKEDT)
     D  WDSXNB       E                     EXTFLD(FLSXNB)
     D  WDKFDT       E                     EXTFLD(FLKFDT)
     D  WDACTM       E                     EXTFLD(FLACTM)
     D  WDK5TX       E                     EXTFLD(FLK5TX)
     D  WDW5CD       E                     EXTFLD(FLW5CD)
     D  WDEJDT       E                     EXTFLD(FLEJDT)
     D  WDAGTM       E                     EXTFLD(FLAGTM)
     D  WDKJDT       E                     EXTFLD(FLKJDT)
     D  WDATTM       E                     EXTFLD(FLATTM)
     D  WDHDDT       E                     EXTFLD(FLHDDT)
     D  WDAUTM       E                     EXTFLD(FLAUTM)
     D  WDKKDT       E                     EXTFLD(FLKKDT)
     D  WDAVTM       E                     EXTFLD(FLAVTM)
     D  WDZ4NB       E                     EXTFLD(FLZ4NB)
     D  WDY7ST       E                     EXTFLD(FLY7ST)
     D  WDY2ST       E                     EXTFLD(FLY2ST)
     D  WDWHTX       E                     EXTFLD(FLWHTX)
     D  WDWITX       E                     EXTFLD(FLWITX)
     D  WDWJTX       E                     EXTFLD(FLWJTX)
     D  WDWKTX       E                     EXTFLD(FLWKTX)
     D  WDWLTX       E                     EXTFLD(FLWLTX)
     D  WDN7DT       E                     EXTFLD(FLN7DT)
     D  WDN8DT       E                     EXTFLD(FLN8DT)
     D  WDN9DT       E                     EXTFLD(FLN9DT)
     D  WDB3TM       E                     EXTFLD(FLB3TM)
     D  WDB4TM       E                     EXTFLD(FLB4TM)
     D  WDB5TM       E                     EXTFLD(FLB5TM)
     D  WDIASX       E                     EXTFLD(FLIASX)
     D  WDIBSX       E                     EXTFLD(FLIBSX)
     D  WDICSX       E                     EXTFLD(FLICSX)
     D  WDWVTX       E                     EXTFLD(FLWVTX)
     D  WDWWTX       E                     EXTFLD(FLWWTX)
     D  WDWXTX       E                     EXTFLD(FLWXTX)
     D  WDUVST       E                     EXTFLD(FLUVST)
     D  WDUWST       E                     EXTFLD(FLUWST)
     D  WDUXST       E                     EXTFLD(FLUXST)
     D  WDAATM       E                     EXTFLD(FLAATM)
     D  WDAYNA       E                     EXTFLD(FLAYNA)
     D  WDA0NA       E                     EXTFLD(FLA0NA)
     D  WDAXDT       E                     EXTFLD(FLAXDT)
      *
     D YBRDCS          DS           367
     D QOPBG1        E DS                  EXTNAME(OPBGWKL0)
      * UPD : Order Detail              Update index
      * Renamed input format fields
     D  WFAIC3       E                     EXTFLD(OMAIC3)
     D  WFC4NB       E                     EXTFLD(OMC4NB)
     D  WFDPNB       E                     EXTFLD(OMDPNB)
     D  WFUENB       E                     EXTFLD(OMUENB)
     D  WFHGCD       E                     EXTFLD(OMHGCD)
     D  WFAJCD       E                     EXTFLD(OMAJCD)
     D  WFBKC7       E                     EXTFLD(OMBKC7)
     D  WFCFC7       E                     EXTFLD(OMCFC7)
     D  WFGMST       E                     EXTFLD(OMGMST)
     D  WFGNST       E                     EXTFLD(OMGNST)
     D  WFMAVA       E                     EXTFLD(OMMAVA)
     D  WFKDVA       E                     EXTFLD(OMKDVA)
     D  WFL8VA       E                     EXTFLD(OML8VA)
     D  WFL9VA       E                     EXTFLD(OML9VA)
     D  WFGTST       E                     EXTFLD(OMGTST)
     D  WFGVST       E                     EXTFLD(OMGVST)
     D  WFGUST       E                     EXTFLD(OMGUST)
     D  WFQFST       E                     EXTFLD(OMQFST)
     D  WFAYVA       E                     EXTFLD(OMAYVA)
     D  WFEXDT       E                     EXTFLD(OMEXDT)
     D  WFLQCD       E                     EXTFLD(OMLQCD)
     D  WFRDCD       E                     EXTFLD(OMRDCD)
     D  WFQ7CD       E                     EXTFLD(OMQ7CD)
     D  WFBZPR       E                     EXTFLD(OMBZPR)
     D  WFL6NB       E                     EXTFLD(OML6NB)
     D  WFU1ST       E                     EXTFLD(OMU1ST)
     D  WFGIDT       E                     EXTFLD(OMGIDT)
     D  WFCRCD       E                     EXTFLD(OMCRCD)
     D  WFAGCD       E                     EXTFLD(OMAGCD)
     D  WFRZST       E                     EXTFLD(OMRZST)
     D  WFR0ST       E                     EXTFLD(OMR0ST)
     D  WFR1ST       E                     EXTFLD(OMR1ST)
     D  WFG7NA       E                     EXTFLD(OMG7NA)
     D  WFG8NA       E                     EXTFLD(OMG8NA)
     D  WFRPCD       E                     EXTFLD(OMRPCD)
     D  WFVEST       E                     EXTFLD(OMVEST)
     D  WFVGST       E                     EXTFLD(OMVGST)
     D  WFAVST       E                     EXTFLD(OMAVST)
     D  WFU0ST       E                     EXTFLD(OMU0ST)
     D  WFRFCD       E                     EXTFLD(OMRFCD)
     D  WFFZST       E                     EXTFLD(OMFZST)
     D  WFR1NB       E                     EXTFLD(OMR1NB)
     D  WFAVQT       E                     EXTFLD(OMAVQT)
     D  WFD0WG       E                     EXTFLD(OMD0WG)
     D  WFCCQT       E                     EXTFLD(OMCCQT)
     D  WFAUWG       E                     EXTFLD(OMAUWG)
     D  WFCBQT       E                     EXTFLD(OMCBQT)
     D  WFATWG       E                     EXTFLD(OMATWG)
     D  WFAQCS       E                     EXTFLD(OMAQCS)
     D  WFAGCS       E                     EXTFLD(OMAGCS)
     D  WFAKPR       E                     EXTFLD(OMAKPR)
     D  WFALPR       E                     EXTFLD(OMALPR)
     D  WFAUPR       E                     EXTFLD(OMAUPR)
     D  WFAVWG       E                     EXTFLD(OMAVWG)
     D  WFA4WG       E                     EXTFLD(OMA4WG)
     D  WFA5DT       E                     EXTFLD(OMA5DT)
     D  WFAODT       E                     EXTFLD(OMAODT)
     D  WFGNDT       E                     EXTFLD(OMGNDT)
     D  WFAMST       E                     EXTFLD(OMAMST)
     D  WFANST       E                     EXTFLD(OMANST)
     D  WFVAST       E                     EXTFLD(OMVAST)
     D  WFRGNB       E                     EXTFLD(OMRGNB)
     D  WFRHNB       E                     EXTFLD(OMRHNB)
     D  WFRINB       E                     EXTFLD(OMRINB)
     D  WFRBCD       E                     EXTFLD(OMRBCD)
     D  WFHICD       E                     EXTFLD(OMHICD)
     D  WFRNCD       E                     EXTFLD(OMRNCD)
     D  WFROCD       E                     EXTFLD(OMROCD)
     D  WFCXDT       E                     EXTFLD(OMCXDT)
     D  WFAJVN       E                     EXTFLD(OMAJVN)
     D  WFKXCD       E                     EXTFLD(OMKXCD)
     D  WFJPCD       E                     EXTFLD(OMJPCD)
     D  WFCQCD       E                     EXTFLD(OMCQCD)
     D  WFR4CD       E                     EXTFLD(OMR4CD)
     D  WFZ1ST       E                     EXTFLD(OMZ1ST)
     D  WFZ3ST       E                     EXTFLD(OMZ3ST)
     D  WFZ4ST       E                     EXTFLD(OMZ4ST)
     D  WFDUPR       E                     EXTFLD(OMDUPR)
     D  WFB6VL       E                     EXTFLD(OMB6VL)
     D  WFA1AA       E                     EXTFLD(OMA1AA)
     D  WFFZSX       E                     EXTFLD(OMFZSX)
     D  WFF0SX       E                     EXTFLD(OMF0SX)
     D  WFF1SX       E                     EXTFLD(OMF1SX)
     D  WFF2SX       E                     EXTFLD(OMF2SX)
     D  WFF3SX       E                     EXTFLD(OMF3SX)
     D  WFF4SX       E                     EXTFLD(OMF4SX)
     D  WFF5SX       E                     EXTFLD(OMF5SX)
     D  WFF6SX       E                     EXTFLD(OMF6SX)
     D  WFF7SX       E                     EXTFLD(OMF7SX)
     D  WFNTDT       E                     EXTFLD(OMNTDT)
     D  WFNUDT       E                     EXTFLD(OMNUDT)
     D  WFNVDT       E                     EXTFLD(OMNVDT)
     D  WFNWDT       E                     EXTFLD(OMNWDT)
     D  WFNXDT       E                     EXTFLD(OMNXDT)
     D  WFBUTM       E                     EXTFLD(OMBUTM)
     D  WFBVTM       E                     EXTFLD(OMBVTM)
     D  WFBWTM       E                     EXTFLD(OMBWTM)
     D  WFBXTM       E                     EXTFLD(OMBXTM)
     D  WFBYTM       E                     EXTFLD(OMBYTM)
     D  WFH5NX       E                     EXTFLD(OMH5NX)
     D  WFH6NX       E                     EXTFLD(OMH6NX)
     D  WFH7NX       E                     EXTFLD(OMH7NX)
     D  WFH8NX       E                     EXTFLD(OMH8NX)
     D  WFH9NX       E                     EXTFLD(OMH9NX)
     D  WFDVPR       E                     EXTFLD(OMDVPR)
     D  WFDWPR       E                     EXTFLD(OMDWPR)
     D  WFDXPR       E                     EXTFLD(OMDXPR)
     D  WFDYPR       E                     EXTFLD(OMDYPR)
     D  WFDZPR       E                     EXTFLD(OMDZPR)
     D  WFGSPR       E                     EXTFLD(OMGSPR)
     D  WFGTPR       E                     EXTFLD(OMGTPR)
     D  WFGUPR       E                     EXTFLD(OMGUPR)
     D  WFHOST       E                     EXTFLD(OMHOST)
     D  WFHPST       E                     EXTFLD(OMHPST)
     D  WFIOST       E                     EXTFLD(OMIOST)
     D  WFPEWG       E                     EXTFLD(OMPEWG)
     D  WFRINY       E                     EXTFLD(OMRINY)
     D  WFTIDT       E                     EXTFLD(OMTIDT)
     D  WFTJDT       E                     EXTFLD(OMTJDT)
     D  WFH2ST       E                     EXTFLD(OMH2ST)
     D  WFH0ST       E                     EXTFLD(OMH0ST)
     D  WFH1ST       E                     EXTFLD(OMH1ST)
     D  WFTKDT       E                     EXTFLD(OMTKDT)
     D  WFTLDT       E                     EXTFLD(OMTLDT)
     D  WFTMDT       E                     EXTFLD(OMTMDT)
     D  WFUVST       E                     EXTFLD(OMUVST)
     D  WFUWST       E                     EXTFLD(OMUWST)
     D  WFUXST       E                     EXTFLD(OMUXST)
     D  WFAATM       E                     EXTFLD(OMAATM)
     D  WFAYNA       E                     EXTFLD(OMAYNA)
     D  WFA0NA       E                     EXTFLD(OMA0NA)
     D  WFAXDT       E                     EXTFLD(OMAXDT)
      *
     D YCRDCS          DS           525
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WN0001         S              3  0
     D  WN0002         S              7  0
     D  WN0003         S              1
     D  WN0004         S              1
     D  WN0005         S              5  2
     D  WN0006         S             15
     D  WN0007         S             15
     D  WN0008         S             15
     D  WN0009         S             15
     D  WN0010         S             15
     D  WN0011         S              7  0
     D  WN0012         S             11  2
     D  WN0013         S              1
     D  WN0014         S              5  0
     D  WN0015         S             20
     D  WN0016         S              3
     D  WN0017         S              4  0
     D  WN0018         S              3
     D  WN0019         S              7
     D  WN0020         S              7  0
     D  WN0021         S             11  2
     D  WN0022         S              1
     D  WN0023         S              1
     D  WN0024         S              5  0
     D  WN0025         S              5  0
     D  WN0026         S             11  2
     D  WN0027         S              6  0
     D  WN0028         S              7  0
     D  WN0029         S              4  0
     D  WN0030         S             11  2
     D  WN0031         S             11  2
     D  WN0032         S              7  0
     D  WN0033         S              4  0
     D  WN0034         S              5  0
     D  WN0035         S              5  2
     D  WN0036         S              5  0
     D  WN0037         S             12
     D  WN0038         S              7  0
     D  WN0039         S             12
     D  WN0040         S              2
     D  WN0041         S              3
     D  WN0042         S              2
     D  WN0043         S              7  0
     D  WN0044         S              3
     D  WN0045         S              1
     D  WN0046         S              7  0
     D  WN0047         S              1
     D  WN0048         S              7  0
     D  WN0049         S              6  0
     D  WN0050         S              7  0
     D  WN0051         S              6  0
     D  WN0052         S              7  0
     D  WN0053         S              6  0
     D  WN0054         S              7  0
     D  WN0055         S              6  0
     D  WN0056         S              7  0
     D  WN0057         S              6  0
     D  WN0058         S              7  0
     D  WN0059         S              6  0
     D  WN0060         S              7  0
     D  WN0061         S              6  0
     D  WN0062         S              3
     D  WN0063         S             20
     D  WN0064         S             30
     D  WN0065         S              5  0
     D  WN0066         S              7  0
     D  WN0067         S             12
     D  WN0068         S             20
     D  WN0069         S              7  0
     D  WN0070         S             12
     D  WN0071         S              7  0
     D  WN0072         S              6  0
     D  WN0073         S              7  0
     D  WN0074         S              6  0
     D  WN0075         S             11  2
     D  WN0076         S              7  0
     D  WN0077         S              6  0
     D  WN0078         S              1
     D  WN0079         S              1
     D  WN0080         S              7  0
     D  WN0081         S              7  0
     D  WN0082         S              1
     D  WN0083         S              3
     D  WN0084         S              7  0
     D  WN0085         S              6  0
     D  WN0086         S              1
     D  WN0087         S              1
     D  WN0088         S             15
     D  WN0089         S             25
     D  WN0090         S             20
     D  WN0091         S              7  0
     D  WN0092         S              1
     D  WN0093         S              1
     D  WN0094         S              7  0
     D  WN0095         S              6  0
     D  WN0096         S              5  0
     D  WN0097         S              9  2
     D  WN0098         S              9  2
     D  WN0099         S              1
     D  WN0100         S             25
     D  WN0101         S              7  0
     D  WN0102         S              6  0
     D  WN0103         S              7  0
     D  WN0104         S              6  0
     D  WN0105         S              1
     D  WN0106         S              1
     D  WN0107         S              1
     D  WN0108         S              1
     D  WN0109         S             11  2
     D  WN0110         S             15
     D  WN0111         S             15
     D  WN0112         S             25
     D  WN0113         S             25
     D  WN0114         S              1
     D  WN0115         S              1
     D  WN0116         S              1
     D  WN0117         S              1
     D  WN0118         S              1
     D  WN0119         S              1
     D  WN0120         S              2
     D  WN0121         S              2
     D  WN0122         S              2
     D  WN0123         S              3
     D  WN0124         S              3
     D  WN0125         S              7  0
     D  WN0126         S              6  0
     D  WN0127         S              7  0
     D  WN0128         S              6  0
     D  WN0129         S              7  0
     D  WN0130         S              6  0
     D  WN0131         S              7  0
     D  WN0132         S              6  0
     D  WN0133         S              7  0
     D  WN0134         S              6  0
     D  WN0135         S              7  0
     D  WN0136         S              6  0
     D  WN0137         S              1
     D  WN0138         S              1
     D  WN0139         S              1
     D  WN0140         S              6  0
     D  WN0141         S             10
     D  WN0142         S             10
     D  WN0143         S              7  0
     D  YARDC          S              1
     D  WQSC01         S                   LIKE(WCRMNB)
     D  WN0144         S              5  0
     D  WN0145         S             30
     D  WN0146         S              5  0
     D  WN0147         S              7  2
     D  WN0148         S              7  0
     D  WN0149         S             11  2
     D  WN0150         S              7  2
     D  WN0151         S             11  2
     D  WN0152         S              3  0
     D  WN0153         S              7  0
     D  WN0154         S              1
     D  WN0155         S              7  0
     D  WN0156         S              6  0
     D  WN0157         S              7  0
     D  WN0158         S              6  0
     D  WN0159         S             30
     D  WN0160         S             10
     D  WN0161         S              7  0
     D  WN0162         S              6  0
     D  WN0163         S              7  0
     D  WN0164         S              6  0
     D  WN0165         S              7  0
     D  WN0166         S              6  0
     D  WN0167         S              7  0
     D  WN0168         S              1
     D  WN0169         S              1
     D  WN0170         S             15
     D  WN0171         S             15
     D  WN0172         S             15
     D  WN0173         S             15
     D  WN0174         S             15
     D  WN0175         S              7  0
     D  WN0176         S              7  0
     D  WN0177         S              7  0
     D  WN0178         S              6  0
     D  WN0179         S              6  0
     D  WN0180         S              6  0
     D  WN0181         S              1
     D  WN0182         S              1
     D  WN0183         S              2
     D  WN0184         S             15
     D  WN0185         S             25
     D  WN0186         S             25
     D  WN0187         S              1
     D  WN0188         S              1
     D  WN0189         S              1
     D  WN0190         S              6  0
     D  WN0191         S             10
     D  WN0192         S             10
     D  WN0193         S              7  0
     D  YBRDC          S              1
     D  WQSE01         S                   LIKE(WEAIC3)
     D  WQSE02         S                   LIKE(WEC4NB)
     D  WN0194         S              7  0
     D  WN0195         S              3
     D  WN0196         S              7  0
     D  WN0197         S              7  0
     D  WN0198         S              1
     D  WN0199         S              1
     D  WN0200         S             11  2
     D  WN0201         S             11  2
     D  WN0202         S             11  2
     D  WN0203         S             11  2
     D  WN0204         S              1
     D  WN0205         S              1
     D  WN0206         S              1
     D  WN0207         S              1
     D  WN0208         S             11  2
     D  WN0209         S              7  0
     D  WN0210         S              3
     D  WN0211         S              3
     D  WN0212         S              3
     D  WN0213         S             11  4
     D  WN0214         S              7  0
     D  WN0215         S              1
     D  WN0216         S              7  0
     D  WN0217         S              2
     D  WN0218         S              2
     D  WN0219         S              1
     D  WN0220         S              1
     D  WN0221         S              1
     D  WN0222         S             30
     D  WN0223         S             30
     D  WN0224         S              1
     D  WN0225         S              1
     D  WN0226         S              1
     D  WN0227         S              1
     D  WN0228         S              1
     D  WN0229         S              3
     D  WN0230         S              1
     D  WN0231         S             11  2
     D  WN0232         S             11  2
     D  WN0233         S             11  2
     D  WN0234         S             11  2
     D  WN0235         S             11  2
     D  WN0236         S             11  2
     D  WN0237         S             11  2
     D  WN0238         S             11  4
     D  WN0239         S             11  4
     D  WN0240         S             11  4
     D  WN0241         S             11  4
     D  WN0242         S             11  4
     D  WN0243         S             11  2
     D  WN0244         S             11  2
     D  WN0245         S              7  0
     D  WN0246         S              7  0
     D  WN0247         S              7  0
     D  WN0248         S              1
     D  WN0249         S              1
     D  WN0250         S              1
     D  WN0251         S              3  0
     D  WN0252         S              3  0
     D  WN0253         S              3  0
     D  WN0254         S              2
     D  WN0255         S              2
     D  WN0256         S              2
     D  WN0257         S              2
     D  WN0258         S              7  0
     D  WN0259         S             10
     D  WN0260         S              6
     D  WN0261         S              2
     D  WN0262         S              3
     D  WN0263         S              3
     D  WN0264         S              1
     D  WN0265         S              1
     D  WN0266         S              1
     D  WN0267         S             11  4
     D  WN0268         S             11  2
     D  WN0269         S              3  0
     D  WN0270         S              1
     D  WN0271         S              1
     D  WN0272         S              1
     D  WN0273         S              1
     D  WN0274         S              1
     D  WN0275         S              2
     D  WN0276         S              2
     D  WN0277         S              3
     D  WN0278         S              3
     D  WN0279         S              7  0
     D  WN0280         S              7  0
     D  WN0281         S              7  0
     D  WN0282         S              7  0
     D  WN0283         S              6  0
     D  WN0284         S              6  0
     D  WN0285         S              6  0
     D  WN0286         S              6  0
     D  WN0287         S             11  2
     D  WN0288         S             11  2
     D  WN0289         S             11  2
     D  WN0290         S             11  2
     D  WN0291         S             11  2
     D  WN0292         S             11  4
     D  WN0293         S             11  4
     D  WN0294         S             11  4
     D  WN0295         S             11  4
     D  WN0296         S             11  4
     D  WN0297         S             11  4
     D  WN0298         S             11  4
     D  WN0299         S             11  4
     D  WN0300         S              1
     D  WN0301         S              1
     D  WN0302         S              1
     D  WN0303         S             11  2
     D  WN0304         S              4  0
     D  WN0305         S              7  0
     D  WN0306         S              7  0
     D  WN0307         S              1
     D  WN0308         S              2
     D  WN0309         S              3
     D  WN0310         S              7  0
     D  WN0311         S              7  0
     D  WN0312         S              7  0
     D  WN0313         S              1
     D  WN0314         S              1
     D  WN0315         S              1
     D  WN0316         S              6  0
     D  WN0317         S             10
     D  WN0318         S             10
     D  WN0319         S              7  0
     D  YCRDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Load Header
      * N :  Load ID
     D  P1RMNB                 1      4P 0
      * N :  Deadline Departure Date
     D  P1KZDT                 5      8P 0
      * N :  Deadline Departure Time
     D  P1AXTM                 9     12P 0
     D                 DS
     D  ZAMSDA                 1    132
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                      WARMNB
     I              FJAIC3                      WAAIC3
     I              FJAODT                      WAAODT
     I              FJPJST                      WAPJST
     I              FJPKST                      WAPKST
     I              FJRNNB                      WARNNB
     I              FJDMTX                      WADMTX
     I              FJDNTX                      WADNTX
     I              FJDOTX                      WADOTX
     I              FJWTTX                      WAWTTX
     I              FJWUTX                      WAWUTX
     I              FJRPNB                      WARPNB
     I              FJFLAM                      WAFLAM
     I              FJXQST                      WAXQST
     I              FJRRNB                      WARRNB
     I              FJDXTX                      WADXTX
     I              FJDYTX                      WADYTX
     I              FJSBNB                      WASBNB
     I              FJBZNA                      WABZNA
     I              FJRONB                      WARONB
     I              FJSQNB                      WASQNB
     I              FJR1NB                      WAR1NB
     I              FJVCST                      WAVCST
     I              FJVDST                      WAVDST
     I              FJSDNB                      WASDNB
     I              FJPAOU                      WAPAOU
     I              FJDGWG                      WADGWG
     I              FJSXNB                      WASXNB
     I              FJHADT                      WAHADT
     I              FJAART                      WAAART
     I              FJDHWG                      WADHWG
     I              FJDIWG                      WADIWG
     I              FJAQDT                      WAAQDT
     I              FJS6NB                      WAS6NB
     I              FJT4NB                      WAT4NB
     I              FJPRTM                      WAPRTM
     I              FJNPSV                      WANPSV
     I              FJJ8TX                      WAJ8TX
     I              FJTLMI                      WATLMI
     I              FJJ9TX                      WAJ9TX
     I              FJQ2CD                      WAQ2CD
     I              FJVPCD                      WAVPCD
     I              FJDBCD                      WADBCD
     I              FJGRWE                      WAGRWE
     I              FJXCCD                      WAXCCD
     I              FJU2ST                      WAU2ST
     I              FJF9DT                      WAF9DT
     I              FJONTM                      WAONTM
     I              FJJ4DT                      WAJ4DT
     I              FJTRTM                      WATRTM
     I              FJJ5DT                      WAJ5DT
     I              FJSPTM                      WASPTM
     I              FJJ6DT                      WAJ6DT
     I              FJLFTM                      WALFTM
     I              FJJ7DT                      WAJ7DT
     I              FJBOTM                      WABOTM
     I              FJJ8DT                      WAJ8DT
     I              FJBLTM                      WABLTM
     I              FJKIDT                      WAKIDT
     I              FJASTM                      WAASTM
     I              FJKADT                      WAKADT
     I              FJAJCM                      WAAJCM
     I              FJXACD                      WAXACD
     I              FJOANA                      WAOANA
     I              FJK4TX                      WAK4TX
     I              FJVOAG                      WAVOAG
     I              FJKBDT                      WAKBDT
     I              FJNBBO                      WANBBO
     I              FJW4CD                      WAW4CD
     I              FJEFDT                      WAEFDT
     I              FJCNTN                      WACNTN
     I              FJKCDT                      WAKCDT
     I              FJTMIN                      WATMIN
     I              FJKDDT                      WAKDDT
     I              FJVMNB                      WAVMNB
     I              FJOCFR                      WAOCFR
     I              FJKJDT                      WAKJDT
     I              FJATTM                      WAATTM
     I              FJOTRS                      WAOTRS
     I              FJRNST                      WARNST
     I              FJBRBK                      WABRBK
     I              FJEIDT                      WAEIDT
     I              FJRMST                      WARMST
     I              FJAJCD                      WAAJCD
     I              FJKKDT                      WAKKDT
     I              FJAVTM                      WAAVTM
     I              FJKZDT                      WAKZDT
     I              FJAXTM                      WAAXTM
     I              FJLHOS                      WALHOS
     I              FJLHOR                      WALHOR
     I              FJWNTX                      WAWNTX
     I              FJOITX                      WAOITX
     I              FJOJTX                      WAOJTX
     I              FJLLDT                      WALLDT
     I              FJLSHG                      WALSHG
     I              FJYPST                      WAYPST
     I              FJK0DT                      WAK0DT
     I              FJAYTM                      WAAYTM
     I              FJKNNX                      WAKNNX
     I              FJICWG                      WAICWG
     I              FJIDWG                      WAIDWG
     I              FJH9SX                      WAH9SX
     I              FJWOTX                      WAWOTX
     I              FJK1DT                      WAK1DT
     I              FJAZTM                      WAAZTM
     I              FJK2DT                      WAK2DT
     I              FJA0TM                      WAA0TM
     I              FJROST                      WAROST
     I              FJRPST                      WARPST
     I              FJRQST                      WARQST
     I              FJRRST                      WARRST
     I              FJZBVA                      WAZBVA
     I              FJWPTX                      WAWPTX
     I              FJWQTX                      WAWQTX
     I              FJWRTX                      WAWRTX
     I              FJWSTX                      WAWSTX
     I              FJRVSX                      WARVSX
     I              FJRUSX                      WARUSX
     I              FJRWSX                      WARWSX
     I              FJRXSX                      WARXSX
     I              FJRYSX                      WARYSX
     I              FJRZSX                      WARZSX
     I              FJR0SX                      WAR0SX
     I              FJR1SX                      WAR1SX
     I              FJR2SX                      WAR2SX
     I              FJR3SX                      WAR3SX
     I              FJR4SX                      WAR4SX
     I              FJPYDT                      WAPYDT
     I              FJCKTM                      WACKTM
     I              FJPZDT                      WAPZDT
     I              FJCLTM                      WACLTM
     I              FJP0DT                      WAP0DT
     I              FJCMTM                      WACMTM
     I              FJP1DT                      WAP1DT
     I              FJCNTM                      WACNTM
     I              FJP2DT                      WAP2DT
     I              FJCOTM                      WACOTM
     I              FJP3DT                      WAP3DT
     I              FJCQTM                      WACQTM
     I              FJUVST                      WAUVST
     I              FJUWST                      WAUWST
     I              FJUXST                      WAUXST
     I              FJAATM                      WAAATM
     I              FJAYNA                      WAAYNA
     I              FJA0NA                      WAA0NA
     I              FJAXDT                      WAAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                      WBRMNB
     I              FJAIC3                      WBAIC3
     I              FJAODT                      WBAODT
     I              FJPJST                      WBPJST
     I              FJPKST                      WBPKST
     I              FJRNNB                      WBRNNB
     I              FJDMTX                      WBDMTX
     I              FJDNTX                      WBDNTX
     I              FJDOTX                      WBDOTX
     I              FJWTTX                      WBWTTX
     I              FJWUTX                      WBWUTX
     I              FJRPNB                      WBRPNB
     I              FJFLAM                      WBFLAM
     I              FJXQST                      WBXQST
     I              FJRRNB                      WBRRNB
     I              FJDXTX                      WBDXTX
     I              FJDYTX                      WBDYTX
     I              FJSBNB                      WBSBNB
     I              FJBZNA                      WBBZNA
     I              FJRONB                      WBRONB
     I              FJSQNB                      WBSQNB
     I              FJR1NB                      WBR1NB
     I              FJVCST                      WBVCST
     I              FJVDST                      WBVDST
     I              FJSDNB                      WBSDNB
     I              FJPAOU                      WBPAOU
     I              FJDGWG                      WBDGWG
     I              FJSXNB                      WBSXNB
     I              FJHADT                      WBHADT
     I              FJAART                      WBAART
     I              FJDHWG                      WBDHWG
     I              FJDIWG                      WBDIWG
     I              FJAQDT                      WBAQDT
     I              FJS6NB                      WBS6NB
     I              FJT4NB                      WBT4NB
     I              FJPRTM                      WBPRTM
     I              FJNPSV                      WBNPSV
     I              FJJ8TX                      WBJ8TX
     I              FJTLMI                      WBTLMI
     I              FJJ9TX                      WBJ9TX
     I              FJQ2CD                      WBQ2CD
     I              FJVPCD                      WBVPCD
     I              FJDBCD                      WBDBCD
     I              FJGRWE                      WBGRWE
     I              FJXCCD                      WBXCCD
     I              FJU2ST                      WBU2ST
     I              FJF9DT                      WBF9DT
     I              FJONTM                      WBONTM
     I              FJJ4DT                      WBJ4DT
     I              FJTRTM                      WBTRTM
     I              FJJ5DT                      WBJ5DT
     I              FJSPTM                      WBSPTM
     I              FJJ6DT                      WBJ6DT
     I              FJLFTM                      WBLFTM
     I              FJJ7DT                      WBJ7DT
     I              FJBOTM                      WBBOTM
     I              FJJ8DT                      WBJ8DT
     I              FJBLTM                      WBBLTM
     I              FJKIDT                      WBKIDT
     I              FJASTM                      WBASTM
     I              FJKADT                      WBKADT
     I              FJAJCM                      WBAJCM
     I              FJXACD                      WBXACD
     I              FJOANA                      WBOANA
     I              FJK4TX                      WBK4TX
     I              FJVOAG                      WBVOAG
     I              FJKBDT                      WBKBDT
     I              FJNBBO                      WBNBBO
     I              FJW4CD                      WBW4CD
     I              FJEFDT                      WBEFDT
     I              FJCNTN                      WBCNTN
     I              FJKCDT                      WBKCDT
     I              FJTMIN                      WBTMIN
     I              FJKDDT                      WBKDDT
     I              FJVMNB                      WBVMNB
     I              FJOCFR                      WBOCFR
     I              FJKJDT                      WBKJDT
     I              FJATTM                      WBATTM
     I              FJOTRS                      WBOTRS
     I              FJRNST                      WBRNST
     I              FJBRBK                      WBBRBK
     I              FJEIDT                      WBEIDT
     I              FJRMST                      WBRMST
     I              FJAJCD                      WBAJCD
     I              FJKKDT                      WBKKDT
     I              FJAVTM                      WBAVTM
     I              FJKZDT                      WBKZDT
     I              FJAXTM                      WBAXTM
     I              FJLHOS                      WBLHOS
     I              FJLHOR                      WBLHOR
     I              FJWNTX                      WBWNTX
     I              FJOITX                      WBOITX
     I              FJOJTX                      WBOJTX
     I              FJLLDT                      WBLLDT
     I              FJLSHG                      WBLSHG
     I              FJYPST                      WBYPST
     I              FJK0DT                      WBK0DT
     I              FJAYTM                      WBAYTM
     I              FJKNNX                      WBKNNX
     I              FJICWG                      WBICWG
     I              FJIDWG                      WBIDWG
     I              FJH9SX                      WBH9SX
     I              FJWOTX                      WBWOTX
     I              FJK1DT                      WBK1DT
     I              FJAZTM                      WBAZTM
     I              FJK2DT                      WBK2DT
     I              FJA0TM                      WBA0TM
     I              FJROST                      WBROST
     I              FJRPST                      WBRPST
     I              FJRQST                      WBRQST
     I              FJRRST                      WBRRST
     I              FJZBVA                      WBZBVA
     I              FJWPTX                      WBWPTX
     I              FJWQTX                      WBWQTX
     I              FJWRTX                      WBWRTX
     I              FJWSTX                      WBWSTX
     I              FJRVSX                      WBRVSX
     I              FJRUSX                      WBRUSX
     I              FJRWSX                      WBRWSX
     I              FJRXSX                      WBRXSX
     I              FJRYSX                      WBRYSX
     I              FJRZSX                      WBRZSX
     I              FJR0SX                      WBR0SX
     I              FJR1SX                      WBR1SX
     I              FJR2SX                      WBR2SX
     I              FJR3SX                      WBR3SX
     I              FJR4SX                      WBR4SX
     I              FJPYDT                      WBPYDT
     I              FJCKTM                      WBCKTM
     I              FJPZDT                      WBPZDT
     I              FJCLTM                      WBCLTM
     I              FJP0DT                      WBP0DT
     I              FJCMTM                      WBCMTM
     I              FJP1DT                      WBP1DT
     I              FJCNTM                      WBCNTM
     I              FJP2DT                      WBP2DT
     I              FJCOTM                      WBCOTM
     I              FJP3DT                      WBP3DT
     I              FJCQTM                      WBCQTM
     I              FJUVST                      WBUVST
     I              FJUWST                      WBUWST
     I              FJUXST                      WBUXST
     I              FJAATM                      WBAATM
     I              FJAYNA                      WBAYNA
     I              FJA0NA                      WBA0NA
     I              FJAXDT                      WBAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                      WCRMNB
     I              FLRUNB                      WCRUNB
     I              FLRVNB                      WCRVNB
     I              FLDQTX                      WCDQTX
     I              FLRWNB                      WCRWNB
     I              FLRXNB                      WCRXNB
     I              FLSQNB                      WCSQNB
     I              FLT0NB                      WCT0NB
     I              FLT1NB                      WCT1NB
     I              FLR1NB                      WCR1NB
     I              FLAIC3                      WCAIC3
     I              FLC4NB                      WCC4NB
     I              FLVCST                      WCVCST
     I              FLKEDT                      WCKEDT
     I              FLSXNB                      WCSXNB
     I              FLKFDT                      WCKFDT
     I              FLACTM                      WCACTM
     I              FLK5TX                      WCK5TX
     I              FLW5CD                      WCW5CD
     I              FLEJDT                      WCEJDT
     I              FLAGTM                      WCAGTM
     I              FLKJDT                      WCKJDT
     I              FLATTM                      WCATTM
     I              FLHDDT                      WCHDDT
     I              FLAUTM                      WCAUTM
     I              FLKKDT                      WCKKDT
     I              FLAVTM                      WCAVTM
     I              FLZ4NB                      WCZ4NB
     I              FLY7ST                      WCY7ST
     I              FLY2ST                      WCY2ST
     I              FLWHTX                      WCWHTX
     I              FLWITX                      WCWITX
     I              FLWJTX                      WCWJTX
     I              FLWKTX                      WCWKTX
     I              FLWLTX                      WCWLTX
     I              FLN7DT                      WCN7DT
     I              FLN8DT                      WCN8DT
     I              FLN9DT                      WCN9DT
     I              FLB3TM                      WCB3TM
     I              FLB4TM                      WCB4TM
     I              FLB5TM                      WCB5TM
     I              FLIASX                      WCIASX
     I              FLIBSX                      WCIBSX
     I              FLICSX                      WCICSX
     I              FLWVTX                      WCWVTX
     I              FLWWTX                      WCWWTX
     I              FLWXTX                      WCWXTX
     I              FLUVST                      WCUVST
     I              FLUWST                      WCUWST
     I              FLUXST                      WCUXST
     I              FLAATM                      WCAATM
     I              FLAYNA                      WCAYNA
     I              FLA0NA                      WCA0NA
     I              FLAXDT                      WCAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                      WDRMNB
     I              FLRUNB                      WDRUNB
     I              FLRVNB                      WDRVNB
     I              FLDQTX                      WDDQTX
     I              FLRWNB                      WDRWNB
     I              FLRXNB                      WDRXNB
     I              FLSQNB                      WDSQNB
     I              FLT0NB                      WDT0NB
     I              FLT1NB                      WDT1NB
     I              FLR1NB                      WDR1NB
     I              FLAIC3                      WDAIC3
     I              FLC4NB                      WDC4NB
     I              FLVCST                      WDVCST
     I              FLKEDT                      WDKEDT
     I              FLSXNB                      WDSXNB
     I              FLKFDT                      WDKFDT
     I              FLACTM                      WDACTM
     I              FLK5TX                      WDK5TX
     I              FLW5CD                      WDW5CD
     I              FLEJDT                      WDEJDT
     I              FLAGTM                      WDAGTM
     I              FLKJDT                      WDKJDT
     I              FLATTM                      WDATTM
     I              FLHDDT                      WDHDDT
     I              FLAUTM                      WDAUTM
     I              FLKKDT                      WDKKDT
     I              FLAVTM                      WDAVTM
     I              FLZ4NB                      WDZ4NB
     I              FLY7ST                      WDY7ST
     I              FLY2ST                      WDY2ST
     I              FLWHTX                      WDWHTX
     I              FLWITX                      WDWITX
     I              FLWJTX                      WDWJTX
     I              FLWKTX                      WDWKTX
     I              FLWLTX                      WDWLTX
     I              FLN7DT                      WDN7DT
     I              FLN8DT                      WDN8DT
     I              FLN9DT                      WDN9DT
     I              FLB3TM                      WDB3TM
     I              FLB4TM                      WDB4TM
     I              FLB5TM                      WDB5TM
     I              FLIASX                      WDIASX
     I              FLIBSX                      WDIBSX
     I              FLICSX                      WDICSX
     I              FLWVTX                      WDWVTX
     I              FLWWTX                      WDWWTX
     I              FLWXTX                      WDWXTX
     I              FLUVST                      WDUVST
     I              FLUWST                      WDUWST
     I              FLUXST                      WDUXST
     I              FLAATM                      WDAATM
     I              FLAYNA                      WDAYNA
     I              FLA0NA                      WDA0NA
     I              FLAXDT                      WDAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      WEAIC3
     I              OMC4NB                      WEC4NB
     I              OMDPNB                      WEDPNB
     I              OMUENB                      WEUENB
     I              OMHGCD                      WEHGCD
     I              OMAJCD                      WEAJCD
     I              OMBKC7                      WEBKC7
     I              OMCFC7                      WECFC7
     I              OMGMST                      WEGMST
     I              OMGNST                      WEGNST
     I              OMMAVA                      WEMAVA
     I              OMKDVA                      WEKDVA
     I              OML8VA                      WEL8VA
     I              OML9VA                      WEL9VA
     I              OMGTST                      WEGTST
     I              OMGVST                      WEGVST
     I              OMGUST                      WEGUST
     I              OMQFST                      WEQFST
     I              OMAYVA                      WEAYVA
     I              OMEXDT                      WEEXDT
     I              OMLQCD                      WELQCD
     I              OMRDCD                      WERDCD
     I              OMQ7CD                      WEQ7CD
     I              OMBZPR                      WEBZPR
     I              OML6NB                      WEL6NB
     I              OMU1ST                      WEU1ST
     I              OMGIDT                      WEGIDT
     I              OMCRCD                      WECRCD
     I              OMAGCD                      WEAGCD
     I              OMRZST                      WERZST
     I              OMR0ST                      WER0ST
     I              OMR1ST                      WER1ST
     I              OMG7NA                      WEG7NA
     I              OMG8NA                      WEG8NA
     I              OMRPCD                      WERPCD
     I              OMVEST                      WEVEST
     I              OMVGST                      WEVGST
     I              OMAVST                      WEAVST
     I              OMU0ST                      WEU0ST
     I              OMRFCD                      WERFCD
     I              OMFZST                      WEFZST
     I              OMR1NB                      WER1NB
     I              OMAVQT                      WEAVQT
     I              OMD0WG                      WED0WG
     I              OMCCQT                      WECCQT
     I              OMAUWG                      WEAUWG
     I              OMCBQT                      WECBQT
     I              OMATWG                      WEATWG
     I              OMAQCS                      WEAQCS
     I              OMAGCS                      WEAGCS
     I              OMAKPR                      WEAKPR
     I              OMALPR                      WEALPR
     I              OMAUPR                      WEAUPR
     I              OMAVWG                      WEAVWG
     I              OMA4WG                      WEA4WG
     I              OMA5DT                      WEA5DT
     I              OMAODT                      WEAODT
     I              OMGNDT                      WEGNDT
     I              OMAMST                      WEAMST
     I              OMANST                      WEANST
     I              OMVAST                      WEVAST
     I              OMRGNB                      WERGNB
     I              OMRHNB                      WERHNB
     I              OMRINB                      WERINB
     I              OMRBCD                      WERBCD
     I              OMHICD                      WEHICD
     I              OMRNCD                      WERNCD
     I              OMROCD                      WEROCD
     I              OMCXDT                      WECXDT
     I              OMAJVN                      WEAJVN
     I              OMKXCD                      WEKXCD
     I              OMJPCD                      WEJPCD
     I              OMCQCD                      WECQCD
     I              OMR4CD                      WER4CD
     I              OMZ1ST                      WEZ1ST
     I              OMZ3ST                      WEZ3ST
     I              OMZ4ST                      WEZ4ST
     I              OMDUPR                      WEDUPR
     I              OMB6VL                      WEB6VL
     I              OMA1AA                      WEA1AA
     I              OMFZSX                      WEFZSX
     I              OMF0SX                      WEF0SX
     I              OMF1SX                      WEF1SX
     I              OMF2SX                      WEF2SX
     I              OMF3SX                      WEF3SX
     I              OMF4SX                      WEF4SX
     I              OMF5SX                      WEF5SX
     I              OMF6SX                      WEF6SX
     I              OMF7SX                      WEF7SX
     I              OMNTDT                      WENTDT
     I              OMNUDT                      WENUDT
     I              OMNVDT                      WENVDT
     I              OMNWDT                      WENWDT
     I              OMNXDT                      WENXDT
     I              OMBUTM                      WEBUTM
     I              OMBVTM                      WEBVTM
     I              OMBWTM                      WEBWTM
     I              OMBXTM                      WEBXTM
     I              OMBYTM                      WEBYTM
     I              OMH5NX                      WEH5NX
     I              OMH6NX                      WEH6NX
     I              OMH7NX                      WEH7NX
     I              OMH8NX                      WEH8NX
     I              OMH9NX                      WEH9NX
     I              OMDVPR                      WEDVPR
     I              OMDWPR                      WEDWPR
     I              OMDXPR                      WEDXPR
     I              OMDYPR                      WEDYPR
     I              OMDZPR                      WEDZPR
     I              OMGSPR                      WEGSPR
     I              OMGTPR                      WEGTPR
     I              OMGUPR                      WEGUPR
     I              OMHOST                      WEHOST
     I              OMHPST                      WEHPST
     I              OMIOST                      WEIOST
     I              OMPEWG                      WEPEWG
     I              OMRINY                      WERINY
     I              OMTIDT                      WETIDT
     I              OMTJDT                      WETJDT
     I              OMH2ST                      WEH2ST
     I              OMH0ST                      WEH0ST
     I              OMH1ST                      WEH1ST
     I              OMTKDT                      WETKDT
     I              OMTLDT                      WETLDT
     I              OMTMDT                      WETMDT
     I              OMUVST                      WEUVST
     I              OMUWST                      WEUWST
     I              OMUXST                      WEUXST
     I              OMAATM                      WEAATM
     I              OMAYNA                      WEAYNA
     I              OMA0NA                      WEA0NA
     I              OMAXDT                      WEAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                      WFAIC3
     I              OMC4NB                      WFC4NB
     I              OMDPNB                      WFDPNB
     I              OMUENB                      WFUENB
     I              OMHGCD                      WFHGCD
     I              OMAJCD                      WFAJCD
     I              OMBKC7                      WFBKC7
     I              OMCFC7                      WFCFC7
     I              OMGMST                      WFGMST
     I              OMGNST                      WFGNST
     I              OMMAVA                      WFMAVA
     I              OMKDVA                      WFKDVA
     I              OML8VA                      WFL8VA
     I              OML9VA                      WFL9VA
     I              OMGTST                      WFGTST
     I              OMGVST                      WFGVST
     I              OMGUST                      WFGUST
     I              OMQFST                      WFQFST
     I              OMAYVA                      WFAYVA
     I              OMEXDT                      WFEXDT
     I              OMLQCD                      WFLQCD
     I              OMRDCD                      WFRDCD
     I              OMQ7CD                      WFQ7CD
     I              OMBZPR                      WFBZPR
     I              OML6NB                      WFL6NB
     I              OMU1ST                      WFU1ST
     I              OMGIDT                      WFGIDT
     I              OMCRCD                      WFCRCD
     I              OMAGCD                      WFAGCD
     I              OMRZST                      WFRZST
     I              OMR0ST                      WFR0ST
     I              OMR1ST                      WFR1ST
     I              OMG7NA                      WFG7NA
     I              OMG8NA                      WFG8NA
     I              OMRPCD                      WFRPCD
     I              OMVEST                      WFVEST
     I              OMVGST                      WFVGST
     I              OMAVST                      WFAVST
     I              OMU0ST                      WFU0ST
     I              OMRFCD                      WFRFCD
     I              OMFZST                      WFFZST
     I              OMR1NB                      WFR1NB
     I              OMAVQT                      WFAVQT
     I              OMD0WG                      WFD0WG
     I              OMCCQT                      WFCCQT
     I              OMAUWG                      WFAUWG
     I              OMCBQT                      WFCBQT
     I              OMATWG                      WFATWG
     I              OMAQCS                      WFAQCS
     I              OMAGCS                      WFAGCS
     I              OMAKPR                      WFAKPR
     I              OMALPR                      WFALPR
     I              OMAUPR                      WFAUPR
     I              OMAVWG                      WFAVWG
     I              OMA4WG                      WFA4WG
     I              OMA5DT                      WFA5DT
     I              OMAODT                      WFAODT
     I              OMGNDT                      WFGNDT
     I              OMAMST                      WFAMST
     I              OMANST                      WFANST
     I              OMVAST                      WFVAST
     I              OMRGNB                      WFRGNB
     I              OMRHNB                      WFRHNB
     I              OMRINB                      WFRINB
     I              OMRBCD                      WFRBCD
     I              OMHICD                      WFHICD
     I              OMRNCD                      WFRNCD
     I              OMROCD                      WFROCD
     I              OMCXDT                      WFCXDT
     I              OMAJVN                      WFAJVN
     I              OMKXCD                      WFKXCD
     I              OMJPCD                      WFJPCD
     I              OMCQCD                      WFCQCD
     I              OMR4CD                      WFR4CD
     I              OMZ1ST                      WFZ1ST
     I              OMZ3ST                      WFZ3ST
     I              OMZ4ST                      WFZ4ST
     I              OMDUPR                      WFDUPR
     I              OMB6VL                      WFB6VL
     I              OMA1AA                      WFA1AA
     I              OMFZSX                      WFFZSX
     I              OMF0SX                      WFF0SX
     I              OMF1SX                      WFF1SX
     I              OMF2SX                      WFF2SX
     I              OMF3SX                      WFF3SX
     I              OMF4SX                      WFF4SX
     I              OMF5SX                      WFF5SX
     I              OMF6SX                      WFF6SX
     I              OMF7SX                      WFF7SX
     I              OMNTDT                      WFNTDT
     I              OMNUDT                      WFNUDT
     I              OMNVDT                      WFNVDT
     I              OMNWDT                      WFNWDT
     I              OMNXDT                      WFNXDT
     I              OMBUTM                      WFBUTM
     I              OMBVTM                      WFBVTM
     I              OMBWTM                      WFBWTM
     I              OMBXTM                      WFBXTM
     I              OMBYTM                      WFBYTM
     I              OMH5NX                      WFH5NX
     I              OMH6NX                      WFH6NX
     I              OMH7NX                      WFH7NX
     I              OMH8NX                      WFH8NX
     I              OMH9NX                      WFH9NX
     I              OMDVPR                      WFDVPR
     I              OMDWPR                      WFDWPR
     I              OMDXPR                      WFDXPR
     I              OMDYPR                      WFDYPR
     I              OMDZPR                      WFDZPR
     I              OMGSPR                      WFGSPR
     I              OMGTPR                      WFGTPR
     I              OMGUPR                      WFGUPR
     I              OMHOST                      WFHOST
     I              OMHPST                      WFHPST
     I              OMIOST                      WFIOST
     I              OMPEWG                      WFPEWG
     I              OMRINY                      WFRINY
     I              OMTIDT                      WFTIDT
     I              OMTJDT                      WFTJDT
     I              OMH2ST                      WFH2ST
     I              OMH0ST                      WFH0ST
     I              OMH1ST                      WFH1ST
     I              OMTKDT                      WFTKDT
     I              OMTLDT                      WFTLDT
     I              OMTMDT                      WFTMDT
     I              OMUVST                      WFUVST
     I              OMUWST                      WFUWST
     I              OMUXST                      WFUXST
     I              OMAATM                      WFAATM
     I              OMAYNA                      WFAYNA
     I              OMA0NA                      WFA0NA
     I              OMAXDT                      WFAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv Upd Dln Dpt Dte/TmeXF
      * Cnv Read DLDPTDTTM-BegUS - Load Header  * 
      *
      *
     C                   dow       not %eof(dldptdttm)
     C                   read      dldptdttm
      *
     C                   eval      P1RMNB = DDLOAD                              Load ID
     C                   eval      P1KZDT = DDDATE                              Deadline Dpt Date
     C                   eval      P1AXTM = DDTIME                              Deadline Dpt Time
      *
      * Update Deadline Departure Date & Time for Load Hdr/Dtl & Order Dt
      * Cnv Upd Dln Dpt Dte/TmeRT - Load Header  * 
     C                   EXSR      SARVGN
      * Cnv Read DLDPTDTTM-EndUS - Load Header  * 
      *
     C                   enddo                                                  dow not %eof
      *
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv Upd Dln Dpt Dte/TmeRT - Load Header  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WARMNB                         Load ID
      * Setup key
     C                   Z-ADD     P1RMNB        WARMNB                         Load ID
      * Establish starting position
     C     KRSSA         CHAIN     @FJCPBN                            90        *
      * Data record not found
     C   90              MOVEL     'USR1188'     W0RTN
      * USER: Process Data record
      * Update Only If Deadline Departure Date or Time is Different.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Deadline Departure Date NE DB1.Deadline Departur
      *   |- c2    : PAR.Deadline Departure Time NE DB1.Deadline Departur
      *   '-
     C                   IF        NOT *IN90
      * CHG Deadline Dep D/T   CH - Load Header  * 
     C                   IF        P1KZDT <> WAKZDT OR
     C                             P1AXTM <> WAAXTM
     C                   EXSR      SBCHRC
      * Update Load Detail.
      * Cnv Upd Dln Dpt Dte/TmeRT - Load Detail  * 
     C                   EXSR      SCRVGN
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBCHRC        BEGSR
      *================================================================
      * CHG Deadline Dep D/T   CH - Load Header  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Company Number
     C                   Z-ADD     *ZERO         WN0002                         Scheduled Ship
     C                   EVAL      WN0003 = ' '                                 LTL Flag
     C                   EVAL      WN0004 = ' '                                 Load Status
     C                   Z-ADD     *ZERO         WN0005                         Reefer Temperat
     C                   EVAL      WN0006 = ' '                                 Seal 1
     C                   EVAL      WN0007 = ' '                                 Seal 2
     C                   EVAL      WN0008 = ' '                                 Seal 3
     C                   EVAL      WN0009 = ' '                                 Seal 4
     C                   EVAL      WN0010 = ' '                                 Seal 2 Unused
     C                   Z-ADD     *ZERO         WN0011                         Total Load Orde
     C                   Z-ADD     *ZERO         WN0012                         Flat Amount
     C                   EVAL      WN0013 = ' '                                 Allocate Pounds
     C                   Z-ADD     *ZERO         WN0014                         Total Stops
     C                   EVAL      WN0015 = ' '                                 Trailer Id
     C                   EVAL      WN0016 = ' '                                 Transloader Car
     C                   Z-ADD     *ZERO         WN0017                         BOL Time
     C                   EVAL      WN0018 = ' '                                 Carrier Code
     C                   EVAL      WN0019 = ' '                                 Truck Size
     C                   Z-ADD     *ZERO         WN0020                         Ld Hdr/Ld Dtl U
     C                   Z-ADD     *ZERO         WN0021                         Rated Freight
     C                   EVAL      WN0022 = ' '                                 Ship Status
     C                   EVAL      WN0023 = ' '                                 Load Type
     C                   Z-ADD     *ZERO         WN0024                         Number Pallets
     C                   Z-ADD     *ZERO         WN0025                         Number Pallets
     C                   Z-ADD     *ZERO         WN0026                         Load Carrier Pa
     C                   Z-ADD     *ZERO         WN0027                         Estimated Arriv
     C                   Z-ADD     *ZERO         WN0028                         Actual Arrival
     C                   Z-ADD     *ZERO         WN0029                         Actual Arrival
     C                   Z-ADD     *ZERO         WN0030                         Trailer IN Weig
     C                   Z-ADD     *ZERO         WN0031                         Trailer OUT Wei
     C                   Z-ADD     *ZERO         WN0032                         Actual Departur
     C                   Z-ADD     *ZERO         WN0033                         Departure Time
     C                   Z-ADD     *ZERO         WN0034                         Schedule Sequen
     C                   Z-ADD     *ZERO         WN0035                         Product Tempera
     C                   Z-ADD     *ZERO         WN0036                         Number Spacers
     C                   EVAL      WN0037 = ' '                                 Car/Veh. Initia
     C                   Z-ADD     *ZERO         WN0038                         Total Load Mile
     C                   EVAL      WN0039 = ' '                                 Recorder ID
     C                   EVAL      WN0040 = ' '                                 Shipping Method
     C                   EVAL      WN0041 = ' '                                 Ship From Wareh
     C                   EVAL      WN0042 = ' '                                 Ship To State C
     C                   Z-ADD     *ZERO         WN0043                         Gross Weight
     C                   EVAL      WN0044 = ' '                                 Carrier Broker
     C                   EVAL      WN0045 = ' '                                 Export Status
     C                   Z-ADD     *ZERO         WN0046                         Actual Ship Dat
     C                   EVAL      WN0047 = ' '                                 On Time - (Y/N)
     C                   Z-ADD     *ZERO         WN0048                         Truck Ready Dat
     C                   Z-ADD     *ZERO         WN0049                         Truck Ready Tim
     C                   Z-ADD     *ZERO         WN0050                         Spotted Date
     C                   Z-ADD     *ZERO         WN0051                         Spotted Time
     C                   Z-ADD     *ZERO         WN0052                         Load Finished D
     C                   Z-ADD     *ZERO         WN0053                         Load Finished T
     C                   Z-ADD     *ZERO         WN0054                         BOL Complete Da
     C                   Z-ADD     *ZERO         WN0055                         BOL Complete Ti
     C                   Z-ADD     *ZERO         WN0056                         BOL Received Da
     C                   Z-ADD     *ZERO         WN0057                         BOL Received Ti
     C                   Z-ADD     *ZERO         WN0058                         Truck Departure
     C                   Z-ADD     *ZERO         WN0059                         Truck Departure
     C                   Z-ADD     *ZERO         WN0060                         Adjusted Depart
     C                   Z-ADD     *ZERO         WN0061                         Adjusted Depart
     C                   EVAL      WN0062 = ' '                                 Shipping Line
     C                   EVAL      WN0063 = ' '                                 Port Delv Termi
     C                   EVAL      WN0064 = ' '                                 Vessel Name
     C                   Z-ADD     *ZERO         WN0065                         Voyage
     C                   Z-ADD     *ZERO         WN0066                         Sail Date
     C                   EVAL      WN0067 = ' '                                 Booking Number
     C                   EVAL      WN0068 = ' '                                 Discharge Port
     C                   Z-ADD     *ZERO         WN0069                         Arrival Date
     C                   EVAL      WN0070 = ' '                                 Container Numbe
     C                   Z-ADD     *ZERO         WN0071                         Date In
     C                   Z-ADD     *ZERO         WN0072                         Time In
     C                   Z-ADD     *ZERO         WN0073                         Date Out
     C                   Z-ADD     *ZERO         WN0074                         Time Out
     C                   Z-ADD     *ZERO         WN0075                         Load Total Frei
     C                   Z-ADD     *ZERO         WN0076                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WN0077                         Scheduled Deliv
     C                   EVAL      WN0078 = ' '                                 LH Unused Sts
     C                   EVAL      WN0079 = ' '                                 LH Carrier Paym
     C                   Z-ADD     *ZERO         WN0080                         Bring Back Mile
     C                   Z-ADD     *ZERO         WN0081                         Requested Deliv
     C                   EVAL      WN0082 = ' '                                 Load Acceptance
     C                   EVAL      WN0083 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0084                         On Yard Date
     C                   Z-ADD     *ZERO         WN0085                         On Yard Time
     C                   EVAL      WN0086 = ' '                                 Load Held Over
     C                   EVAL      WN0087 = ' '                                 Load Held Over
     C                   EVAL      WN0088 = ' '                                 Load Held Over
     C                   EVAL      WN0089 = ' '                                 Ocean BOL Numbe
     C                   EVAL      WN0090 = ' '                                 Express Mail Nu
     C                   Z-ADD     *ZERO         WN0091                         Express Mail Da
     C                   EVAL      WN0092 = ' '                                 Load Shag Flag
     C                   EVAL      WN0093 = ' '                                 Load Wash Flag
     C                   Z-ADD     *ZERO         WN0094                         Product Complet
     C                   Z-ADD     *ZERO         WN0095                         Product Complet
     C                   Z-ADD     *ZERO         WN0096                         Pallets Loaded
     C                   Z-ADD     *ZERO         WN0097                         Avg Pallet Tare
     C                   Z-ADD     *ZERO         WN0098                         Tot Pallet Tare
     C                   EVAL      WN0099 = ' '                                 Load Confirmed
     C                   EVAL      WN0100 = ' '                                 Load Confirmed
     C                   Z-ADD     *ZERO         WN0101                         Load Confirmati
     C                   Z-ADD     *ZERO         WN0102                         Load Door 1
     C                   Z-ADD     *ZERO         WN0103                         Override Total
     C                   Z-ADD     *ZERO         WN0104                         Load Door 2
     C                   EVAL      WN0105 = ' '                                 Partial Load
     C                   EVAL      WN0106 = ' '                                 Load Confirmati
     C                   EVAL      WN0107 = ' '                                 Export Load USD
     C                   EVAL      WN0108 = ' '                                 Late Delivery E
     C                   Z-ADD     *ZERO         WN0109                         Load Actual Fre
     C                   EVAL      WN0110 = ' '                                 Hide on WW Load
     C                   EVAL      WN0111 = ' '                                 Late Billing Em
     C                   EVAL      WN0112 = ' '                                 Shipping Temp C
     C                   EVAL      WN0113 = ' '                                 LH Held Over Rs
     C                   EVAL      WN0114 = ' '                                 Multi Company L
     C                   EVAL      WN0115 = ' '                                 Fax Sent to SSI
     C                   EVAL      WN0116 = ' '                                 Schedule Pos Lo
     C                   EVAL      WN0117 = ' '                                 LH Power Only L
     C                   EVAL      WN0118 = ' '                                 MG Created Load
     C                   EVAL      WN0119 = ' '                                 LH Unused Sts 5
     C                   EVAL      WN0120 = ' '                                 Load U/M
     C                   EVAL      WN0121 = ' '                                 TPM Shipment St
     C                   EVAL      WN0122 = ' '                                 LH Unused Sts 8
     C                   EVAL      WN0123 = ' '                                 LH On-Time Reas
     C                   EVAL      WN0124 = ' '                                 LH Held Over Re
     C                   Z-ADD     *ZERO         WN0125                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WN0126                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WN0127                         LH Last Combo P
     C                   Z-ADD     *ZERO         WN0128                         LH Last Combo P
     C                   Z-ADD     *ZERO         WN0129                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WN0130                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WN0131                         TPM Planned Shi
     C                   Z-ADD     *ZERO         WN0132                         LH Unused Time
     C                   Z-ADD     *ZERO         WN0133                         LH Unused Date
     C                   Z-ADD     *ZERO         WN0134                         LH Unused Time
     C                   Z-ADD     *ZERO         WN0135                         LH Unused Date
     C                   Z-ADD     *ZERO         WN0136                         LH Unused Time
     C                   EVAL      WN0137 = ' '                                 EDI Status 1
     C                   EVAL      WN0138 = ' '                                 EDI Status 2
     C                   EVAL      WN0139 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0140                         Job Time
     C                   EVAL      WN0141 = ' '                                 User Id
     C                   EVAL      WN0142 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0143                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @FJCPBO
     C                   Z-ADD     WARMNB        WBRMNB                         Load ID
      *
     C     KLCHSB        KLIST
     C                   KFLD                    WBRMNB                         Load ID
     C     KLCHSB        CHAIN     @FJCPBO                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OMFJCPL1'    MDACP
     C                   MOVEL     '@FJCPBO'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOMFJ1        YARDCS
      * Move non-key fields to @FJCPBO
     C                   Z-ADD     P1KZDT        WBKZDT                         Deadline Depart
     C                   Z-ADD     P1AXTM        WBAXTM                         Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFJ1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                   Z-ADD     ##JTM         WBAATM                         Job Time
     C                   MOVEL     ##USR         WBAYNA                         User Id
     C                   MOVEL     ##JOB         WBA0NA                         Job Name
     C                   Z-ADD     ##JDT         WBAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFJ1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @FJCPBO                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OMFJCPL1                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Cnv Upd Dln Dpt Dte/TmeRT - Load Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC01                         Load ID
      * Setup key
     C                   Z-ADD     WARMNB        WQSC01                         Load ID
      * Establish starting position
     C     KRSSC         SETLL     @FLCPBW                                      *
     C     KRSSC         READE     @FLCPBW                                90    *
      * Data record not found
     C   90              MOVEL     'USR1192'     W0RTN
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SDCHRC
     C     KRSSC         READE     @FLCPBW                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDCHRC        BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0144                         Stop/Drop
     C                   EVAL      WN0145 = ' '                                 Comments for Pi
     C                   Z-ADD     *ZERO         WN0146                         Miles to next s
     C                   Z-ADD     *ZERO         WN0147                         Freight Charge
     C                   Z-ADD     *ZERO         WN0148                         Ld Hdr/Ld Dtl U
     C                   Z-ADD     *ZERO         WN0149                         Freight Misc. C
     C                   Z-ADD     *ZERO         WN0150                         Freight Stop Ch
     C                   Z-ADD     *ZERO         WN0151                         Rated Freight
     C                   Z-ADD     *ZERO         WN0152                         Company Number
     C                   Z-ADD     *ZERO         WN0153                         Order Number
     C                   EVAL      WN0154 = ' '                                 Ship Status
     C                   Z-ADD     *ZERO         WN0155                         Estimated Arriv
     C                   Z-ADD     *ZERO         WN0156                         Estimated Arriv
     C                   Z-ADD     *ZERO         WN0157                         Appointment Con
     C                   Z-ADD     *ZERO         WN0158                         Appointment Con
     C                   EVAL      WN0159 = ' '                                 Confirmation Ma
     C                   EVAL      WN0160 = ' '                                 Confirmation Nu
     C                   Z-ADD     *ZERO         WN0161                         Actual Delivery
     C                   Z-ADD     *ZERO         WN0162                         Actual Delivery
     C                   Z-ADD     *ZERO         WN0163                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WN0164                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WN0165                         On Yard Date
     C                   Z-ADD     *ZERO         WN0166                         On Yard Time
     C                   Z-ADD     *ZERO         WN0167                         MPC Number
     C                   EVAL      WN0168 = ' '                                 Load Dtl On Tim
     C                   EVAL      WN0169 = ' '                                 On Time Add'l R
     C                   EVAL      WN0170 = ' '                                 Seal Nbr 1
     C                   EVAL      WN0171 = ' '                                 Seal Nbr 2
     C                   EVAL      WN0172 = ' '                                 Seal Nbr 3
     C                   EVAL      WN0173 = ' '                                 Seal Nbr 4
     C                   EVAL      WN0174 = ' '                                 Seal Nbr 5
     C                   Z-ADD     *ZERO         WN0175                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WN0176                         LD Unused Date
     C                   Z-ADD     *ZERO         WN0177                         LD Unused Date
     C                   Z-ADD     *ZERO         WN0178                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WN0179                         LD Unused Time
     C                   Z-ADD     *ZERO         WN0180                         LD Unused Time
     C                   EVAL      WN0181 = ' '                                 Miles Error Sts
     C                   EVAL      WN0182 = ' '                                 LD Unused Sts 2
     C                   EVAL      WN0183 = ' '                                 HPB Transload S
     C                   EVAL      WN0184 = ' '                                 LD Cst Svc Trac
     C                   EVAL      WN0185 = ' '                                 LD Unused Txt 2
     C                   EVAL      WN0186 = ' '                                 LD Unused Txt 3
     C                   EVAL      WN0187 = ' '                                 EDI Status 1
     C                   EVAL      WN0188 = ' '                                 EDI Status 2
     C                   EVAL      WN0189 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0190                         Job Time
     C                   EVAL      WN0191 = ' '                                 User Id
     C                   EVAL      WN0192 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0193                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @FLCPBM
     C                   Z-ADD     WCRMNB        WDRMNB                         Load ID
     C                   Z-ADD     WCRUNB        WDRUNB                         Stop/Drop Seque
      *
     C     KLCHSD        KLIST
     C                   KFLD                    WDRMNB                         Load ID
     C                   KFLD                    WDRUNB                         Stop/Drop Seque
     C     KLCHSD        CHAIN     @FLCPBM                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OMFLCPL0'    MDACP
     C                   MOVEL     '@FLCPBM'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOMFL1        YBRDCS
      * Move non-key fields to @FLCPBM
     C                   Z-ADD     P1KZDT        WDHDDT                         Deadline Depart
     C                   Z-ADD     P1AXTM        WDAUTM                         Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFL1 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                   Z-ADD     ##JTM         WDAATM                         Job Time
     C                   MOVEL     ##USR         WDAYNA                         User Id
     C                   MOVEL     ##JOB         WDA0NA                         Job Name
     C                   Z-ADD     ##JDT         WDAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFL1 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @FLCPBM                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OMFLCPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                   EXSR      SERVGN
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WQSE01                         Company Number
     C                   KFLD                    WQSE02                         Order Number
      * Setup key
     C                   Z-ADD     WDAIC3        WQSE01                         Company Number
     C                   Z-ADD     WDC4NB        WQSE02                         Order Number
      * Establish starting position
     C     KRSSE         SETLL     @BGWKL1                                      *
     C     KRSSE         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SFCHRC
     C     KRSSE         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFCHRC        BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0194                         Item Code
     C                   EVAL      WN0195 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0196                         Ship To Custome
     C                   Z-ADD     *ZERO         WN0197                         Order Group Cod
     C                   EVAL      WN0198 = ' '                                 Detail Line Sta
     C                   EVAL      WN0199 = ' '                                 Detail Line Sta
     C                   Z-ADD     *ZERO         WN0200                         Billing Detail
     C                   Z-ADD     *ZERO         WN0201                         Billing Detail
     C                   Z-ADD     *ZERO         WN0202                         Billing Detail
     C                   Z-ADD     *ZERO         WN0203                         Quantity to Sub
     C                   EVAL      WN0204 = ' '                                 Comment Print A
     C                   EVAL      WN0205 = ' '                                 Comment Print I
     C                   EVAL      WN0206 = ' '                                 Comment Print P
     C                   EVAL      WN0207 = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         WN0208                         Extended Amount
     C                   Z-ADD     *ZERO         WN0209                         Market Pricing
     C                   EVAL      WN0210 = ' '                                 Commodity Marke
     C                   EVAL      WN0211 = ' '                                 Date Method Cod
     C                   EVAL      WN0212 = ' '                                 Price Method Co
     C                   Z-ADD     *ZERO         WN0213                         Price Overage O
     C                   Z-ADD     *ZERO         WN0214                         Contract Number
     C                   EVAL      WN0215 = ' '                                 Price Status
     C                   Z-ADD     *ZERO         WN0216                         Pricing Date Us
     C                   EVAL      WN0217 = ' '                                 U/M - Base Pric
     C                   EVAL      WN0218 = ' '                                 U/M - Ordered
     C                   EVAL      WN0219 = ' '                                 Work Confirm St
     C                   EVAL      WN0220 = ' '                                 Work Over/Short
     C                   EVAL      WN0221 = ' '                                 OD Production P
     C                   EVAL      WN0222 = ' '                                 Order Desc. Lin
     C                   EVAL      WN0223 = ' '                                 Order Desc. Lin
     C                   EVAL      WN0224 = ' '                                 Age Code
     C                   EVAL      WN0225 = ' '                                 Palletize
     C                   EVAL      WN0226 = ' '                                 Slip Sheet
     C                   EVAL      WN0227 = ' '                                 Catch Weight St
     C                   EVAL      WN0228 = ' '                                 Price Audit
     C                   EVAL      WN0229 = ' '                                 Price Audit Rea
     C                   EVAL      WN0230 = ' '                                 Production Date
     C                   Z-ADD     *ZERO         WN0231                         Rated Freight
     C                   Z-ADD     *ZERO         WN0232                         Quantity Ordere
     C                   Z-ADD     *ZERO         WN0233                         Weight Ordered
     C                   Z-ADD     *ZERO         WN0234                         Quantity Schedu
     C                   Z-ADD     *ZERO         WN0235                         Weight Schedule
     C                   Z-ADD     *ZERO         WN0236                         Quantity Shippe
     C                   Z-ADD     *ZERO         WN0237                         Weight Shipped
     C                   Z-ADD     *ZERO         WN0238                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WN0239                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WN0240                         Unit Price
     C                   Z-ADD     *ZERO         WN0241                         Unit Price - Cr
     C                   Z-ADD     *ZERO         WN0242                         Unit Price Orde
     C                   Z-ADD     *ZERO         WN0243                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WN0244                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WN0245                         Requested Ship
     C                   Z-ADD     *ZERO         WN0246                         Scheduled Ship
     C                   Z-ADD     *ZERO         WN0247                         Actual Shipped
     C                   EVAL      WN0248 = ' '                                 Affect Inventor
     C                   EVAL      WN0249 = ' '                                 Affect Sales Do
     C                   EVAL      WN0250 = ' '                                 Affect Sales Pn
     C                   Z-ADD     *ZERO         WN0251                         Item Structure
     C                   Z-ADD     *ZERO         WN0252                         Item Structure
     C                   Z-ADD     *ZERO         WN0253                         Item Structure
     C                   EVAL      WN0254 = ' '                                 Item Level
     C                   EVAL      WN0255 = ' '                                 Quality Level
     C                   EVAL      WN0256 = ' '                                 Pricing Product
     C                   EVAL      WN0257 = ' '                                 Season Product
     C                   Z-ADD     *ZERO         WN0258                         Date of Origina
     C                   EVAL      WN0259 = ' '                                 User Profile Na
     C                   EVAL      WN0260 = ' '                                 Country Code
     C                   EVAL      WN0261 = ' '                                 Event Code
     C                   EVAL      WN0262 = ' '                                 Reason Code
     C                   EVAL      WN0263 = ' '                                 Sales Route Cod
     C                   EVAL      WN0264 = ' '                                 Modified Flag
     C                   EVAL      WN0265 = ' '                                 Substituted Fla
     C                   EVAL      WN0266 = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         WN0267                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WN0268                         Invoice Extende
     C                   Z-ADD     *ZERO         WN0269                         Ham Group Numbe
     C                   EVAL      WN0270 = ' '                                 OD Adj Type Ove
     C                   EVAL      WN0271 = ' '                                 Affect Trade Fu
     C                   EVAL      WN0272 = ' '                                 Affect Commissi
     C                   EVAL      WN0273 = ' '                                 Affect Pricing
     C                   EVAL      WN0274 = ' '                                 Released by Use
     C                   EVAL      WN0275 = ' '                                 Ord TF Exempt C
     C                   EVAL      WN0276 = ' '                                 OD Pallet Type
     C                   EVAL      WN0277 = ' '                                 Production Ware
     C                   EVAL      WN0278 = ' '                                 OD Price Type
     C                   Z-ADD     *ZERO         WN0279                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0280                         Consumed Item C
     C                   Z-ADD     *ZERO         WN0281                         OD Price Type R
     C                   Z-ADD     *ZERO         WN0282                         OD Unused Date
     C                   Z-ADD     *ZERO         WN0283                         Price Code
     C                   Z-ADD     *ZERO         WN0284                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WN0285                         Substitution Li
     C                   Z-ADD     *ZERO         WN0286                         Max Qty to sche
     C                   Z-ADD     *ZERO         WN0287                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0288                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WN0289                         OD Item Target
     C                   Z-ADD     *ZERO         WN0290                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WN0291                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WN0292                         Order Gate/Fina
     C                   Z-ADD     *ZERO         WN0293                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WN0294                         OD Gate/Final P
     C                   Z-ADD     *ZERO         WN0295                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WN0296                         OD Unused Prc 5
     C                   Z-ADD     *ZERO         WN0297                         OD Unused Prc 6
     C                   Z-ADD     *ZERO         WN0298                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WN0299                         OD Unused Prc 8
     C                   EVAL      WN0300 = ' '                                 OD MPR Sent to
     C                   EVAL      WN0301 = ' '                                 OD MPR Prc Read
     C                   EVAL      WN0302 = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         WN0303                         Weight Amount E
     C                   Z-ADD     *ZERO         WN0304                         Item Age Days
     C                   Z-ADD     *ZERO         WN0305                         Production Ovr
     C                   Z-ADD     *ZERO         WN0306                         Production Ovr
     C                   EVAL      WN0307 = ' '                                 OD UnUsed Statu
     C                   EVAL      WN0308 = ' '                                 OD Clm Full Ret
     C                   EVAL      WN0309 = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         WN0310                         OD Market Begin
     C                   Z-ADD     *ZERO         WN0311                         OD Market Endin
     C                   Z-ADD     *ZERO         WN0312                         OD Atch to Ord
     C                   EVAL      WN0313 = ' '                                 EDI Status 1
     C                   EVAL      WN0314 = ' '                                 EDI Status 2
     C                   EVAL      WN0315 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0316                         Job Time
     C                   EVAL      WN0317 = ' '                                 User Id
     C                   EVAL      WN0318 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0319                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YCRDC = ' '
      *
      * Move key fields to @BGWKL0
     C                   Z-ADD     WEAIC3        WFAIC3                         Company Number
     C                   Z-ADD     WEC4NB        WFC4NB                         Order Number
     C                   Z-ADD     WEDPNB        WFDPNB                         Order Sequence
     C                   Z-ADD     WEUENB        WFUENB                         Order Secondary
      *
     C     KLCHSF        KLIST
     C                   KFLD                    WFAIC3                         Company Number
     C                   KFLD                    WFC4NB                         Order Number
     C                   KFLD                    WFDPNB                         Order Sequence
     C                   KFLD                    WFUENB                         Order Secondary
     C     KLCHSF        CHAIN     @BGWKL0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBG1        YCRDCS
      * Move non-key fields to @BGWKL0
     C                   Z-ADD     WDHDDT        WFNVDT                         Deadline Depart
     C                   Z-ADD     WDAUTM        WFBUTM                         Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                   Z-ADD     ##JTM         WFAATM                         Job Time
     C                   MOVEL     ##USR         WFAYNA                         User Id
     C                   MOVEL     ##JOB         WFA0NA                         Job Name
     C                   Z-ADD     ##JDT         WFAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YCRDC = 'Y'
     C                   UPDATE    @BGWKL0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBGWKL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Clear all neither parameters
     C                   Z-ADD     *ZERO         P1RMNB                         Load ID
     C                   Z-ADD     *ZERO         P1KZDT                         Deadline Depart
     C                   Z-ADD     *ZERO         P1AXTM                         Deadline Depart
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WARPNB                         Total Load Orde
     C                   Z-ADD     *ZERO         WAFLAM                         Flat Amount
     C                   Z-ADD     *ZERO         WARRNB                         Total Stops
     C                   Z-ADD     *ZERO         WASBNB                         BOL Time
     C                   Z-ADD     *ZERO         WASQNB                         Ld Hdr/Ld Dtl U
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WASDNB                         Number Pallets
     C                   Z-ADD     *ZERO         WAPAOU                         Number Pallets
     C                   Z-ADD     *ZERO         WADGWG                         Load Carrier Pa
     C                   Z-ADD     *ZERO         WASXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         WAHADT                         Actual Arrival
     C                   Z-ADD     *ZERO         WAAART                         Actual Arrival
     C                   Z-ADD     *ZERO         WADHWG                         Trailer IN Weig
     C                   Z-ADD     *ZERO         WADIWG                         Trailer OUT Wei
     C                   Z-ADD     *ZERO         WAAQDT                         Actual Departur
     C                   Z-ADD     *ZERO         WAS6NB                         Departure Time
     C                   Z-ADD     *ZERO         WAT4NB                         Schedule Sequen
     C                   Z-ADD     *ZERO         WAPRTM                         Product Tempera
     C                   Z-ADD     *ZERO         WANPSV                         Number Spacers
     C                   Z-ADD     *ZERO         WATLMI                         Total Load Mile
     C                   Z-ADD     *ZERO         WAGRWE                         Gross Weight
     C                   Z-ADD     *ZERO         WAF9DT                         Actual Ship Dat
     C                   Z-ADD     *ZERO         WAJ4DT                         Truck Ready Dat
     C                   Z-ADD     *ZERO         WATRTM                         Truck Ready Tim
     C                   Z-ADD     *ZERO         WAJ5DT                         Spotted Date
     C                   Z-ADD     *ZERO         WASPTM                         Spotted Time
     C                   Z-ADD     *ZERO         WAJ6DT                         Load Finished D
     C                   Z-ADD     *ZERO         WALFTM                         Load Finished T
     C                   Z-ADD     *ZERO         WAJ7DT                         BOL Complete Da
     C                   Z-ADD     *ZERO         WABOTM                         BOL Complete Ti
     C                   Z-ADD     *ZERO         WAJ8DT                         BOL Received Da
     C                   Z-ADD     *ZERO         WABLTM                         BOL Received Ti
     C                   Z-ADD     *ZERO         WAKIDT                         Truck Departure
     C                   Z-ADD     *ZERO         WAASTM                         Truck Departure
     C                   Z-ADD     *ZERO         WAKADT                         Adjusted Depart
     C                   Z-ADD     *ZERO         WAAJCM                         Adjusted Depart
     C                   Z-ADD     *ZERO         WAVOAG                         Voyage
     C                   Z-ADD     *ZERO         WAKBDT                         Sail Date
     C                   Z-ADD     *ZERO         WAEFDT                         Arrival Date
     C                   Z-ADD     *ZERO         WAKCDT                         Date In
     C                   Z-ADD     *ZERO         WATMIN                         Time In
     C                   Z-ADD     *ZERO         WAKDDT                         Date Out
     C                   Z-ADD     *ZERO         WAVMNB                         Time Out
     C                   Z-ADD     *ZERO         WAOCFR                         Load Total Frei
     C                   Z-ADD     *ZERO         WAKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WAATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WABRBK                         Bring Back Mile
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         WAAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         WAKZDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WAAXTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WALLDT                         Express Mail Da
     C                   Z-ADD     *ZERO         WAK0DT                         Product Complet
     C                   Z-ADD     *ZERO         WAAYTM                         Product Complet
     C                   Z-ADD     *ZERO         WAKNNX                         Pallets Loaded
     C                   Z-ADD     *ZERO         WAICWG                         Avg Pallet Tare
     C                   Z-ADD     *ZERO         WAIDWG                         Tot Pallet Tare
     C                   Z-ADD     *ZERO         WAK1DT                         Load Confirmati
     C                   Z-ADD     *ZERO         WAAZTM                         Load Door 1
     C                   Z-ADD     *ZERO         WAK2DT                         Override Total
     C                   Z-ADD     *ZERO         WAA0TM                         Load Door 2
     C                   Z-ADD     *ZERO         WAZBVA                         Load Actual Fre
     C                   Z-ADD     *ZERO         WAPYDT                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WACKTM                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WAPZDT                         LH Last Combo P
     C                   Z-ADD     *ZERO         WACLTM                         LH Last Combo P
     C                   Z-ADD     *ZERO         WAP0DT                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WACMTM                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WAP1DT                         TPM Planned Shi
     C                   Z-ADD     *ZERO         WACNTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WAP2DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WACOTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WAP3DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WACQTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCRMNB                         Load ID
     C                   Z-ADD     *ZERO         WCRUNB                         Stop/Drop Seque
     C                   Z-ADD     *ZERO         WCRVNB                         Stop/Drop
     C                   Z-ADD     *ZERO         WCRWNB                         Miles to next s
     C                   Z-ADD     *ZERO         WCRXNB                         Freight Charge
     C                   Z-ADD     *ZERO         WCSQNB                         Ld Hdr/Ld Dtl U
     C                   Z-ADD     *ZERO         WCT0NB                         Freight Misc. C
     C                   Z-ADD     *ZERO         WCT1NB                         Freight Stop Ch
     C                   Z-ADD     *ZERO         WCR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCC4NB                         Order Number
     C                   Z-ADD     *ZERO         WCKEDT                         Estimated Arriv
     C                   Z-ADD     *ZERO         WCSXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         WCKFDT                         Appointment Con
     C                   Z-ADD     *ZERO         WCACTM                         Appointment Con
     C                   Z-ADD     *ZERO         WCEJDT                         Actual Delivery
     C                   Z-ADD     *ZERO         WCAGTM                         Actual Delivery
     C                   Z-ADD     *ZERO         WCKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WCATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WCHDDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WCAUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WCKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         WCAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         WCZ4NB                         MPC Number
     C                   Z-ADD     *ZERO         WCN7DT                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WCN8DT                         LD Unused Date
     C                   Z-ADD     *ZERO         WCN9DT                         LD Unused Date
     C                   Z-ADD     *ZERO         WCB3TM                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WCB4TM                         LD Unused Time
     C                   Z-ADD     *ZERO         WCB5TM                         LD Unused Time
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEC4NB                         Order Number
     C                   Z-ADD     *ZERO         WEDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WEUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WEHGCD                         Item Code
     C                   Z-ADD     *ZERO         WEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WECFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WEMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WEKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WEL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WEL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WEAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WEEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WEBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WEL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WEGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WER1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WEAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WED0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WECCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WEAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WECBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WEATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WEAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WEAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WEAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WEALPR                         Unit Price - Cr
     C                   Z-ADD     *ZERO         WEAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WEAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WEA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WEA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WEAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WEGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WERGNB                         Item Structure
     C                   Z-ADD     *ZERO         WERHNB                         Item Structure
     C                   Z-ADD     *ZERO         WERINB                         Item Structure
     C                   Z-ADD     *ZERO         WECXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WEDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WEB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WEA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WENTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WENUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WENVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WENWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WENXDT                         OD Unused Date
     C                   Z-ADD     *ZERO         WEBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WEBVTM                         Price Code
     C                   Z-ADD     *ZERO         WEBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WEBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WEBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WEH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WEH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WEH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WEH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WEH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WEDVPR                         Order Gate/Fina
     C                   Z-ADD     *ZERO         WEDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WEDXPR                         OD Gate/Final P
     C                   Z-ADD     *ZERO         WEDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WEDZPR                         OD Unused Prc 5
     C                   Z-ADD     *ZERO         WEGSPR                         OD Unused Prc 6
     C                   Z-ADD     *ZERO         WEGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WEGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WEPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WERINY                         Item Age Days
     C                   Z-ADD     *ZERO         WETIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WETJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WETKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WETLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WETMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
