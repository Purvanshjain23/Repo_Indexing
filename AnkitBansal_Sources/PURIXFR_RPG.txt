     H/TITLE Cnv BUYGRPSTC Update  XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/02/20  Time  : 16:01:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     Fbuygrpstc if   e           k disk                                         Buying Group STC
     FPUAAREL1  IF   E           K DISK
      * RTV : Customer EXT2             Retrieval index
      *
     FCABBREL1  IF   E           K DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPUAAREL0  UF A E           K DISK
      * UPD : Customer EXT2             Update index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUAA1        E DS                  EXTNAME(PUAAREL0)
      * UPD : Customer EXT2             Update index
      * Renamed input format fields
     D  WCBKC7       E                     EXTFLD(AABKC7)
     D  WCVEAA       E                     EXTFLD(AAVEAA)
     D  WCD9SC       E                     EXTFLD(AAD9SC)
     D  WCZZAA       E                     EXTFLD(AAZZAA)
     D  WCK8SC       E                     EXTFLD(AAK8SC)
     D  WCK5SC       E                     EXTFLD(AAK5SC)
     D  WCK6SC       E                     EXTFLD(AAK6SC)
     D  WCK7SC       E                     EXTFLD(AAK7SC)
     D  WCZ3AA       E                     EXTFLD(AAZ3AA)
     D  WCZ4AA       E                     EXTFLD(AAZ4AA)
     D  WCZ5AA       E                     EXTFLD(AAZ5AA)
     D  WCFCNZ       E                     EXTFLD(AAFCNZ)
     D  WCXKDT       E                     EXTFLD(AAXKDT)
     D  WCO1U1       E                     EXTFLD(AAO1U1)
     D  WCVSST       E                     EXTFLD(AAVSST)
     D  WCMJDT       E                     EXTFLD(AAMJDT)
     D  WCBETM       E                     EXTFLD(AABETM)
     D  WCCCVN       E                     EXTFLD(AACCVN)
     D  WCCDVN       E                     EXTFLD(AACDVN)
     D  WCMKDT       E                     EXTFLD(AAMKDT)
     D  WCBFTM       E                     EXTFLD(AABFTM)
     D  WCCEVN       E                     EXTFLD(AACEVN)
     D  WCCFVN       E                     EXTFLD(AACFVN)
      *
     D YARDCS          DS           132
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              1
     D  YL0002         S              1
     D  YL0003         S              1
     D  YL0004         S              1
     D  WN0001         S              7  0
     D  WN0002         S              6  0
     D  WN0003         S             10
     D  WN0004         S             10
     D  WN0005         S              7  0
     D  WN0006         S              6  0
     D  WN0007         S             10
     D  WN0008         S             10
     D  ZADFMF         S             10
     D  WN0009         S             10
     D  WN0010         S              2
     D  WN0011         S              1
     D  WN0012         S              1
     D  WN0013         S              1
     D  WN0014         S              3
     D  WN0015         S              3
     D  WN0016         S              6
     D  WN0017         S              7  0
     D  WN0018         S              7  0
     D  WN0019         S             25
     D  WN0020         S              1
     D  WN0021         S              7  0
     D  WN0022         S              6  0
     D  WN0023         S             10
     D  WN0024         S             10
     D  WN0025         S              7  0
     D  WN0026         S              6  0
     D  WN0027         S             10
     D  WN0028         S             10
     D  YARDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Customer EXT2
      * N :  Ship To Customer
     D  P1BKC7                 1      4P 0
      * N :  Buying Group
     D  P1ZZAA                 5     14
      * N :  Buying Group Opt In/Out
     D  P1K8SC                15     15
     D                 DS
     D  ZAMSDA                 1    132
     I@AAREY9
      * Customer EXT2             Retrieval index
      * Renamed input format fields
     I              AABKC7                      WABKC7
     I              AAVEAA                      WAVEAA
     I              AAD9SC                      WAD9SC
     I              AAZZAA                      WAZZAA
     I              AAK8SC                      WAK8SC
     I              AAK5SC                      WAK5SC
     I              AAK6SC                      WAK6SC
     I              AAK7SC                      WAK7SC
     I              AAZ3AA                      WAZ3AA
     I              AAZ4AA                      WAZ4AA
     I              AAZ5AA                      WAZ5AA
     I              AAFCNZ                      WAFCNZ
     I              AAXKDT                      WAXKDT
     I              AAO1U1                      WAO1U1
     I              AAVSST                      WAVSST
     I              AAMJDT                      WAMJDT
     I              AABETM                      WABETM
     I              AACCVN                      WACCVN
     I              AACDVN                      WACDVN
     I              AAMKDT                      WAMKDT
     I              AABFTM                      WABFTM
     I              AACEVN                      WACEVN
     I              AACFVN                      WACFVN
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                      WBBKC7
     I              BBAYTX                      WBAYTX
     I              BBACNA                      WBACNA
     I              BBADNA                      WBADNA
     I              BBAENA                      WBAENA
     I              BBAJNA                      WBAJNA
     I              BBBGCD                      WBBGCD
     I              BBG5CD                      WBG5CD
     I              BBBTTX                      WBBTTX
     I              BBBVTX                      WBBVTX
     I              BBBWTX                      WBBWTX
     I              BBABTX                      WBABTX
     I              BBA2NA                      WBA2NA
     I              BBCBST                      WBCBST
     I              BBB0NA                      WBB0NA
     I              BBP3NB                      WBP3NB
     I              BBAXNA                      WBAXNA
     I              BBI6DT                      WBI6DT
     I              BBAYDT                      WBAYDT
     I              BBANC7                      WBANC7
     I              BBBTC7                      WBBTC7
     I              BBK6ST                      WBK6ST
     I              BBUZST                      WBUZST
     I              BBKXCD                      WBKXCD
     I              BBLTCD                      WBLTCD
     I              BBQNST                      WBQNST
     I              BBS2NB                      WBS2NB
     I              BBVHVA                      WBVHVA
     I              BBI7DT                      WBI7DT
     I              BBRJST                      WBRJST
     I              BBRKST                      WBRKST
     I              BBQWST                      WBQWST
     I              BBQXST                      WBQXST
     I              BBQYST                      WBQYST
     I              BBUNCS                      WBUNCS
     I              BBUVST                      WBUVST
     I              BBUWST                      WBUWST
     I              BBUXST                      WBUXST
     I              BBVSST                      WBVSST
     I              BBAATM                      WBAATM
     I              BBAYNA                      WBAYNA
     I              BBA0NA                      WBA0NA
     I              BBAXDT                      WBAXDT
      *
     I@AAREY8
      * Customer EXT2             Update index
      * Renamed input format fields
     I              AABKC7                      WCBKC7
     I              AAVEAA                      WCVEAA
     I              AAD9SC                      WCD9SC
     I              AAZZAA                      WCZZAA
     I              AAK8SC                      WCK8SC
     I              AAK5SC                      WCK5SC
     I              AAK6SC                      WCK6SC
     I              AAK7SC                      WCK7SC
     I              AAZ3AA                      WCZ3AA
     I              AAZ4AA                      WCZ4AA
     I              AAZ5AA                      WCZ5AA
     I              AAFCNZ                      WCFCNZ
     I              AAXKDT                      WCXKDT
     I              AAO1U1                      WCO1U1
     I              AAVSST                      WCVSST
     I              AAMJDT                      WCMJDT
     I              AABETM                      WCBETM
     I              AACCVN                      WCCCVN
     I              AACDVN                      WCCDVN
     I              AAMKDT                      WCMKDT
     I              AABFTM                      WCBFTM
     I              AACEVN                      WCCEVN
     I              AACFVN                      WCCFVN
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv BUYGRPSTC Update  XF
      * Cnv BUYGRPSTC Read    US - Customer EXT2  * 
      *
      *
     C                   dow       not %eof(buygrpstc)
     C                   read      buygrpstc
      *
     C                   eval      P1BKC7 = BGSTCN                              Ship To Customer #
     C                   eval      P1ZZAA = BGCODE                              Buying Group
     C                   eval      P1K8SC = BGOPTS                              Opt In/Out Sts
      *
      * Cnv BUYGRPSTC Update  RT - Customer EXT2  * 
     C                   EXSR      SARVGN
      * Cnv EndDo             US - /UT User Source  * 
      *
     C                   enddo                                                  dow not %eof
      *
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv BUYGRPSTC Update  RT - Customer EXT2  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WABKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     P1BKC7        WABKC7                         Ship To Custome
      * Establish starting position
     C     KRSSA         CHAIN     @AAREY9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR4969'     W0RTN
      * USER: Processing if Data record not found
      * RTV Record Sts         RT - Customer  * 
     C                   EXSR      SBRVGN
      * Customer Exist? Yes, Create Record.
      * CASE: PGM.*Return code is *Normal
      * Cnv Crt Customer EXT2 CR - Customer EXT2  * 
     C                   IF        W0RTN = ' '
     C                   EXSR      SCCRRC
     C                   END                                                    *FI
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Chg Buying Group Info CH - Customer EXT2  * 
     C                   IF        NOT *IN90
     C                   EXSR      SDCHRC
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV Record Sts         RT - Customer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     P1BKC7        WBBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSB         CHAIN     @BBREE9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0170'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0001 = ' '                                 Record Status
     C                   GOTO      SBEXIT                                       *QUIT
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBVSST        YL0001                         Record Status
     C                   GOTO      SBEXIT                                       *QUIT
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCRRC        BEGSR
      *================================================================
      * Cnv Crt Customer EXT2 CR - Customer EXT2  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Create Date
     C                   Z-ADD     *ZERO         WN0002                         Create Time
     C                   EVAL      WN0003 = ' '                                 Create User
     C                   EVAL      WN0004 = ' '                                 Create Program
     C                   Z-ADD     *ZERO         WN0005                         Change Date
     C                   Z-ADD     *ZERO         WN0006                         Change Time
     C                   EVAL      WN0007 = ' '                                 Change User
     C                   EVAL      WN0008 = ' '                                 Change Program
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @AAREY8
     C                   Z-ADD     P1BKC7        WCBKC7                         Ship To Custome
     C                   EVAL      WCVEAA = ' '                                 M3 Supplier ID
     C                   MOVEL     'FT'          WCD9SC                         Dft Mode of Tra
     C                   MOVEL     P1ZZAA        WCZZAA                         Buying Group
     C                   MOVEL     P1K8SC        WCK8SC                         Buying Group Op
     C                   MOVEL     YL0002        WCK5SC                         CEXT2 Unused St
     C                   MOVEL     YL0003        WCK6SC                         CEXT2 Unused St
     C                   MOVEL     YL0004        WCK7SC                         CEXT2 Unused St
     C                   EVAL      WCZ3AA = ' '                                 CEXT2 Unused Cd
     C                   EVAL      WCZ4AA = ' '                                 CEXT2 Unused Cd
     C                   EVAL      WCZ5AA = ' '                                 CEXT2 Unused Cd
     C                   Z-ADD     0             WCFCNZ                         CEXT2 Unused Nb
     C                   Z-ADD     0             WCXKDT                         CEXT2 Unused Dt
     C                   EVAL      WCO1U1 = ' '                                 CEXT2 Unused Tx
     C                   MOVEL     YL0001        WCVSST                         Record Status
      *
      * USER: Processing before Data update
      * Set Crt Date/Time 2    IF
      * *** Set CREATE fields. ***
     C                   Z-ADD     ##JDT         WCMJDT                         Create Date
     C                   Z-ADD     ##JTM         WCBETM                         Create Time
     C                   MOVEL     ##USR         WCCCVN                         Create User
     C                   MOVEL     ##PGM         WCCDVN                         Create Program
      * *** Set CHANGE fields. ***
     C                   Z-ADD     0             WCMKDT                         Change Date
     C                   Z-ADD     0             WCBFTM                         Change Time
     C                   EVAL      WCCEVN = ' '                                 Change User
     C                   EVAL      WCCFVN = ' '                                 Change Program
     C     KLCRSC        KLIST
     C                   KFLD                    WCBKC7                         Ship To Custome
      * Check for duplicate primary key
     C     KLCRSC        SETLL     @AAREY8                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR4970'     W0RTN
      * Send message 'Customer EXT2          EX'
     C                   MOVEL     'USR4970'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
     C                   WRITE     @AAREY8                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDCHRC        BEGSR
      *================================================================
      * Chg Buying Group Info CH - Customer EXT2  * 
      *================================================================
      *
     C                   EVAL      WN0009 = ' '                                 M3 Supplier ID
     C                   EVAL      WN0010 = ' '                                 Dft Mode of Tra
     C                   EVAL      WN0011 = ' '                                 CEXT2 Unused St
     C                   EVAL      WN0012 = ' '                                 CEXT2 Unused St
     C                   EVAL      WN0013 = ' '                                 CEXT2 Unused St
     C                   EVAL      WN0014 = ' '                                 CEXT2 Unused Cd
     C                   EVAL      WN0015 = ' '                                 CEXT2 Unused Cd
     C                   EVAL      WN0016 = ' '                                 CEXT2 Unused Cd
     C                   Z-ADD     *ZERO         WN0017                         CEXT2 Unused Nb
     C                   Z-ADD     *ZERO         WN0018                         CEXT2 Unused Dt
     C                   EVAL      WN0019 = ' '                                 CEXT2 Unused Tx
     C                   EVAL      WN0020 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0021                         Create Date
     C                   Z-ADD     *ZERO         WN0022                         Create Time
     C                   EVAL      WN0023 = ' '                                 Create User
     C                   EVAL      WN0024 = ' '                                 Create Program
     C                   Z-ADD     *ZERO         WN0025                         Change Date
     C                   Z-ADD     *ZERO         WN0026                         Change Time
     C                   EVAL      WN0027 = ' '                                 Change User
     C                   EVAL      WN0028 = ' '                                 Change Program
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AAREY8
     C                   Z-ADD     WABKC7        WCBKC7                         Ship To Custome
      *
     C     KLCHSD        KLIST
     C                   KFLD                    WCBKC7                         Ship To Custome
     C     KLCHSD        CHAIN     @AAREY8                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PUAAREL0'    MDACP
     C                   MOVEL     '@AAREY8'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPUAA1        YARDCS
      * USER: Processing after Data read
      * If Buying Group Info Changed Then Update Else Quit.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Buying Group NE DB1.Buying Group
      *   |- c2    : PAR.Buying Group Opt In/Out NE DB1.Buying Group Opt
      *   '-
      * Continue to update.
     C                   IF        P1ZZAA <> WCZZAA OR
     C                             P1K8SC <> WCK8SC
     C                   ELSE
      * CASE: *OTHERWISE
     C                   GOTO      SDEXIT                                       *QUIT
     C                   END                                                    *FI
      * Move non-key fields to @AAREY8
     C                   MOVEL(P)  P1ZZAA        WCZZAA                         Buying Group
     C                   MOVEL(P)  P1K8SC        WCK8SC                         Buying Group Op
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUAA1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                   Z-ADD     ##JDT         WCMKDT                         Change Date
     C                   Z-ADD     ##JTM         WCBFTM                         Change Time
     C                   MOVEL     ##USR         WCCEVN                         Change User
     C                   MOVEL     ##PGM         WCCFVN                         Change Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUAA1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AAREY8                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PUAAREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Clear all neither parameters
     C                   Z-ADD     *ZERO         P1BKC7                         Ship To Custome
     C                   EVAL      P1ZZAA = ' '                                 Buying Group
     C                   EVAL      P1K8SC = ' '                                 Buying Group Op
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAFCNZ                         CEXT2 Unused Nb
     C                   Z-ADD     *ZERO         WAXKDT                         CEXT2 Unused Dt
     C                   Z-ADD     *ZERO         WAMJDT                         Create Date
     C                   Z-ADD     *ZERO         WABETM                         Create Time
     C                   Z-ADD     *ZERO         WAMKDT                         Change Date
     C                   Z-ADD     *ZERO         WABFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WBP3NB                         D & B Number
     C                   Z-ADD     *ZERO         WBI6DT                         Date of D & B R
     C                   Z-ADD     *ZERO         WBAYDT                         Credit Line Exp
     C                   Z-ADD     *ZERO         WBANC7                         A/R Customer Nu
     C                   Z-ADD     *ZERO         WBBTC7                         Parent Customer
     C                   Z-ADD     *ZERO         WBS2NB                         Parent Credit L
     C                   Z-ADD     *ZERO         WBVHVA                         A/R Credit Limi
     C                   Z-ADD     *ZERO         WBI7DT                         Order Entry Hol
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Clear all neither parameters
      * Cnv Crt Customer EXT2 CR - Customer EXT2  * 
     C                   Z-ADD     *ZERO         WCMJDT                         Create Date
     C                   Z-ADD     *ZERO         WCBETM                         Create Time
     C                   Z-ADD     *ZERO         WCMKDT                         Change Date
     C                   Z-ADD     *ZERO         WCBFTM                         Change Time
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
     C                   MOVEL     'N'           W0PMT
      * Define local work field Record Status
     C                   EVAL      YL0001 = ' '
      * Define local work field CEXT2 Unused Sts 1
     C                   EVAL      YL0002 = ' '
      * Define local work field CEXT2 Unused Sts 2
     C                   EVAL      YL0003 = ' '
      * Define local work field CEXT2 Unused Sts 3
     C                   EVAL      YL0004 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
