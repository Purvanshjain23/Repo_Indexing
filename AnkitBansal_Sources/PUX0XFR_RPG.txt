     H/TITLE Prc EDI 824 Applic Adv XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) ACTGRP(*CALLER) BNDDIR(YBNDDIR)
     Z* DBGVIEW(*SOURCE) OPTIMIZE(*BASIC) CVTOPT(*DATETIME)
     Z* TGTRLS(V7R3M0)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSGOYA
     H* Date          : 12/31/24  Time  : 03:40:12
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FECP036L2  IF   E           K DISK
      * RTV : EDI Applic Advice    Hdr  Not processed
      *
     FCADPREL1  IF   E           K DISK
      * RTV : System Values             Retrieval index       NV
      *
     FECP038L2  IF   E           K DISK
      * RSQ : EDI Applic Advice    Err  Ctl#/RefIdQlf/ApplAck/Se
      *
     FOMFJCPL0  IF   E           K DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL6  IF   E           K DISK
      * RSQ : Order Header TRG          Load Exports
      *
     FPMAMREL2  IF   E           K DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FPMAMRELO  IF   E           K DISK
      * RSQ : Order Header Extension    AES ITN#
      *
     FPNGNREL1  IF   E           K DISK
      * RTV : EDI Interchange           Retrieval index
      *
     FECP038L1  IF   E           K DISK
      * RTV : EDI Applic Advice    Err  Retrieval index
      *
     FECP037L2  IF   E           K DISK
      * RSQ : EDI Applic Advice    Dtl  Ctl#/RefIdQlf/ApplAck
      *
     FECP136L3  IF   E           K DISK
      * RSQ : EDI Export Shpmnt Inf HDR Load ID/Rcd Proc/Ctl# (D
      *
     FECP036L0  UF   E           K DISK
      * UPD : EDI Applic Advice    Hdr  Update index
      *
     FECP136L0  UF   E           K DISK
      * UPD : EDI Export Shpmnt Inf HDR Update index
      *
      * Long constants
     D @CN#            S              6    DIM(30)CTDATA PERRCD(1)
     D @CN             S             25    DIM(30) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D YL0012          DS           500
     D QECP01        E DS                  EXTNAME(ECP036L0)
      * UPD : EDI Applic Advice    Hdr  Update index
      * Renamed input format fields
     D  WGHRNZ       E                     EXTFLD(EVHRNZ)
     D  WGRMNB       E                     EXTFLD(EVRMNB)
     D  WGTOU1       E                     EXTFLD(EVTOU1)
     D  WGA0ST       E                     EXTFLD(EVA0ST)
     D  WGHPAA       E                     EXTFLD(EVHPAA)
     D  WGTKAA       E                     EXTFLD(EVTKAA)
     D  WGVODT       E                     EXTFLD(EVVODT)
     D  WGA4AB       E                     EXTFLD(EVA4AB)
     D  WGTYPC       E                     EXTFLD(EVTYPC)
     D  WGO7T1       E                     EXTFLD(EVO7T1)
     D  WGDCDQ       E                     EXTFLD(EVDCDQ)
     D  WGTLU1       E                     EXTFLD(EVTLU1)
     D  WGTLAA       E                     EXTFLD(EVTLAA)
     D  WGDLU1       E                     EXTFLD(EVDLU1)
     D  WGS3U1       E                     EXTFLD(EVS3U1)
     D  WGTSU1       E                     EXTFLD(EVTSU1)
      *
     D YARDCS          DS           318
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D YL0025          DS           500
     D QECP11        E DS                  EXTNAME(ECP136L0)
      * UPD : EDI Export Shpmnt Inf HDR Update index
      * Renamed input format fields
     D  WMTSCN       E                     EXTFLD(COTSCN)
     D  WMA0ST       E                     EXTFLD(COA0ST)
     D  WMHPAA       E                     EXTFLD(COHPAA)
     D  WMA8AB       E                     EXTFLD(COA8AB)
     D  WMA9AB       E                     EXTFLD(COA9AB)
     D  WMBAAB       E                     EXTFLD(COBAAB)
     D  WMBBAB       E                     EXTFLD(COBBAB)
     D  WMHDNZ       E                     EXTFLD(COHDNZ)
     D  WMBEAB       E                     EXTFLD(COBEAB)
     D  WMVRNA       E                     EXTFLD(COVRNA)
     D  WMBCAB       E                     EXTFLD(COBCAB)
     D  WMS5U1       E                     EXTFLD(COS5U1)
     D  WMBDAB       E                     EXTFLD(COBDAB)
     D  WMB7DX       E                     EXTFLD(COB7DX)
     D  WMS6U1       E                     EXTFLD(COS6U1)
     D  WMS7U1       E                     EXTFLD(COS7U1)
     D  WMS8U1       E                     EXTFLD(COS8U1)
     D  WMBFAB       E                     EXTFLD(COBFAB)
     D  WMS9U1       E                     EXTFLD(COS9U1)
     D  WMTAU1       E                     EXTFLD(COTAU1)
     D  WMTBU1       E                     EXTFLD(COTBU1)
     D  WMTPU1       E                     EXTFLD(COTPU1)
     D  WMTQU1       E                     EXTFLD(COTQU1)
     D  WMTRU1       E                     EXTFLD(COTRU1)
     D  WMCADX       E                     EXTFLD(COCADX)
     D  WMBETM       E                     EXTFLD(COBETM)
     D  WMN8SC       E                     EXTFLD(CON8SC)
      *
     D YBRDCS          DS           287
     D YCRDCS          DS           287
     D YDRDCS          DS           287
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S             50
     D  YL0002         S             10
     D  YN0001         S             10
     D  YL0003         S              1
     D  WQSD01         S                   LIKE(WCHRNZ)
     D  WQSD02         S                   LIKE(WCA5AB)
     D  YL0004         S              1
     D  YL0005         S              7  0
     D  YL0006         S             15
     D  WQSF02         S                   LIKE(WERMNB)
     D  YL0007         S              7
     D  YL0008         S              7
     D  YL0009         S             15
     D  WL0001         S              7  0
     D  WL0002         S             15
     D  WQSG01         S                   LIKE(WFRMNB)
     D  YL0010         S             40
     D  YL0011         S             80
     D  ZQ             S              5  0
     D  WQ0001         S             50
     D  WQ0002         S             80
     D  WQ0003         S            500
     D  W0CLPG         S             10
     D  WL0003         S             11  0
     D  WL0004         S              1
     D  WN0001         S              7  0
     D  WN0002         S             50
     D  WN0003         S              6
     D  WN0004         S              2
     D  WN0005         S              8  0
     D  WN0006         S              2
     D  WN0007         S              3
     D  WN0008         S             60
     D  WN0009         S              2
     D  WN0010         S             40
     D  WN0011         S              2
     D  WN0012         S             60
     D  WN0013         S             50
     D  WN0014         S             25
     D  YARDC          S              1
     D  WQSI01         S                   LIKE(WHM2U1)
     D  YL0013         S              1
     D  WQ0004         S             50
     D  WQ0005         S             80
     D  WQ0006         S            500
     D  YL0014         S              1
     D  YL0015         S              1
     D  YL0016         S              1
     D  YL0017         S              1
     D  YL0018         S             15
     D  WL0005         S             11  0
     D  WL0006         S              3
     D  WL0007         S             50
     D  WQSL01         S                   LIKE(WKHRNZ)
     D  WQSL02         S                   LIKE(WKA5AB)
     D  YL0019         S              3
     D  YL0020         S             60
     D  YL0021         S              1
     D  YL0022         S              5  0
     D  WQSM01         S                   LIKE(WCHRNZ)
     D  YL0023         S             25
     D  WQSK01         S                   LIKE(WJHRNZ)
     D  YL0024         S             80
     D  YL0026         S             10
     D  YL0027         S              8
     D  YL0028         S              1
     D  YL0029         S             20
     D  YL0030         S             56
     D  Y0CX01         S              1
     D  WQ0007         S             50
     D  WQ0008         S             80
     D  WQ0009         S            500
     D  YL0031         S             15
     D  YL0032         S              1
     D  WQ0010         S              7  0
     D  WQ0011         S             15
     D  WQ0012         S              1
     D  WQ0013         S              1
     D  WQ0014         S             15
     D  YL0033         S              7  0
     D  YL0034         S              1
     D  WQ0015         S              7  0
     D  WQ0016         S             15
     D  WQ0017         S              1
     D  WQ0018         S              2
     D  WQ0019         S             15
     D  WQ0020         S             15
     D  WQ0021         S              7  0
     D  WQ0022         S              1
     D  WQSN01         S                   LIKE(WLHDNZ)
     D  WQSN02         S                   LIKE(WLA0ST)
     D  WN0015         S              1
     D  WN0016         S              6
     D  WN0017         S              1
     D  WN0018         S              2
     D  WN0019         S              2
     D  WN0020         S              2
     D  WN0021         S              7  0
     D  WN0022         S              2
     D  WN0023         S             20
     D  WN0024         S              4
     D  WN0025         S             28
     D  WN0026         S              3
     D  WN0027         S              8  0
     D  WN0028         S             30
     D  WN0029         S             30
     D  WN0030         S             50
     D  WN0031         S              2
     D  WN0032         S             15
     D  WN0033         S             30
     D  WN0034         S              1
     D  WN0035         S              4
     D  WN0036         S             15
     D  WN0037         S             15
     D  WN0038         S              8  0
     D  WN0039         S              6  0
     D  YBRDC          S              1
     D  YL0035         S              1
     D  WQSP01         S                   LIKE(WLHDNZ)
     D  WQSP02         S                   LIKE(WLA0ST)
     D  WL0008         S              9  0
     D  WL0009         S              1
     D  WL0010         S              2
     D  WN0040         S              6
     D  WN0041         S              1
     D  WN0042         S              2
     D  WN0043         S              2
     D  WN0044         S              7  0
     D  WN0045         S              2
     D  WN0046         S             20
     D  WN0047         S              4
     D  WN0048         S             28
     D  WN0049         S              3
     D  WN0050         S              8  0
     D  WN0051         S             30
     D  WN0052         S             30
     D  WN0053         S             50
     D  WN0054         S              2
     D  WN0055         S             15
     D  WN0056         S             30
     D  WN0057         S              1
     D  WN0058         S              4
     D  WN0059         S             15
     D  WN0060         S             15
     D  WN0061         S              8  0
     D  WN0062         S              6  0
     D  WN0063         S              1
     D  YCRDC          S              1
     D  WL0011         S              9  0
     D  WL0012         S              1
     D  WN0064         S              6
     D  WN0065         S              1
     D  WN0066         S              2
     D  WN0067         S              2
     D  WN0068         S              2
     D  WN0069         S              7  0
     D  WN0070         S              2
     D  WN0071         S             20
     D  WN0072         S              4
     D  WN0073         S             28
     D  WN0074         S              3
     D  WN0075         S              8  0
     D  WN0076         S             30
     D  WN0077         S             30
     D  WN0078         S             50
     D  WN0079         S              2
     D  WN0080         S             15
     D  WN0081         S             30
     D  WN0082         S              1
     D  WN0083         S              4
     D  WN0084         S             15
     D  WN0085         S             15
     D  WN0086         S              8  0
     D  WN0087         S              6  0
     D  WN0088         S              1
     D  YDRDC          S              1
     D  YL0036         S             15
     D  WQ0023         S              7  0
     D  WQ0024         S             15
     D  WQ0025         S              1
     D  WQ0026         S              1
     D  WQ0027         S             15
     D  WQSS01         S                   LIKE(WLHDNZ)
     D  WQSS02         S                   LIKE(WLA0ST)
     D  WQST01         S                   LIKE(WLHDNZ)
     D  WQST02         S                   LIKE(WLA0ST)
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0PMT          S              1
     d SysDateUSA      S               D   datfmt(*USA)
     d SysTimeHMS      S              8a
     D                 DS
     D  ZAMSDA                 1    132
     I@P008X3
      * EDI Applic Advice    Hdr  Not processed
      * Renamed input format fields
     I              EVHRNZ                      WAHRNZ
     I              EVRMNB                      WARMNB
     I              EVTOU1                      WATOU1
     I              EVA0ST                      WAA0ST
     I              EVHPAA                      WAHPAA
     I              EVTKAA                      WATKAA
     I              EVVODT                      WAVODT
     I              EVA4AB                      WAA4AB
     I              EVTYPC                      WATYPC
     I              EVO7T1                      WAO7T1
     I              EVDCDQ                      WADCDQ
     I              EVTLU1                      WATLU1
     I              EVTLAA                      WATLAA
     I              EVDLU1                      WADLU1
     I              EVS3U1                      WAS3U1
     I              EVTSU1                      WATSU1
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                      WBDOCD
     I              DPAUNA                      WBAUNA
     I              DPI5ST                      WBI5ST
     I              DPBXTX                      WBBXTX
     I              DPM8NB                      WBM8NB
     I              DPUVST                      WBUVST
     I              DPUWST                      WBUWST
     I              DPUXST                      WBUXST
     I              DPVSST                      WBVSST
     I              DPAATM                      WBAATM
     I              DPAYNA                      WBAYNA
     I              DPA0NA                      WBA0NA
     I              DPAXDT                      WBAXDT
      *
     I@P038LV
      * EDI Applic Advice    Err  Ctl#/RefIdQlf/ApplAck/Se
      * Renamed input format fields
     I              EZHRNZ                      WCHRNZ
     I              EZKGAA                      WCKGAA
     I              EZA5AB                      WCA5AB
     I              EZDXNB                      WCDXNB
     I              EZKHAA                      WCKHAA
     I              EZDNU1                      WCDNU1
     I              EZA7AB                      WCA7AB
     I              EZDMU1                      WCDMU1
     I              EZTUU1                      WCTUU1
     I              EZTVU1                      WCTVU1
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                      WDRMNB
     I              FJAIC3                      WDAIC3
     I              FJAODT                      WDAODT
     I              FJPJST                      WDPJST
     I              FJPKST                      WDPKST
     I              FJRNNB                      WDRNNB
     I              FJDMTX                      WDDMTX
     I              FJDNTX                      WDDNTX
     I              FJDOTX                      WDDOTX
     I              FJWTTX                      WDWTTX
     I              FJWUTX                      WDWUTX
     I              FJRPNB                      WDRPNB
     I              FJFLAM                      WDFLAM
     I              FJXQST                      WDXQST
     I              FJRRNB                      WDRRNB
     I              FJDXTX                      WDDXTX
     I              FJDYTX                      WDDYTX
     I              FJSBNB                      WDSBNB
     I              FJBZNA                      WDBZNA
     I              FJRONB                      WDRONB
     I              FJSQNB                      WDSQNB
     I              FJR1NB                      WDR1NB
     I              FJVCST                      WDVCST
     I              FJVDST                      WDVDST
     I              FJSDNB                      WDSDNB
     I              FJPAOU                      WDPAOU
     I              FJDGWG                      WDDGWG
     I              FJSXNB                      WDSXNB
     I              FJHADT                      WDHADT
     I              FJAART                      WDAART
     I              FJDHWG                      WDDHWG
     I              FJDIWG                      WDDIWG
     I              FJAQDT                      WDAQDT
     I              FJS6NB                      WDS6NB
     I              FJT4NB                      WDT4NB
     I              FJPRTM                      WDPRTM
     I              FJNPSV                      WDNPSV
     I              FJJ8TX                      WDJ8TX
     I              FJTLMI                      WDTLMI
     I              FJJ9TX                      WDJ9TX
     I              FJQ2CD                      WDQ2CD
     I              FJVPCD                      WDVPCD
     I              FJDBCD                      WDDBCD
     I              FJGRWE                      WDGRWE
     I              FJXCCD                      WDXCCD
     I              FJU2ST                      WDU2ST
     I              FJF9DT                      WDF9DT
     I              FJONTM                      WDONTM
     I              FJJ4DT                      WDJ4DT
     I              FJTRTM                      WDTRTM
     I              FJJ5DT                      WDJ5DT
     I              FJSPTM                      WDSPTM
     I              FJJ6DT                      WDJ6DT
     I              FJLFTM                      WDLFTM
     I              FJJ7DT                      WDJ7DT
     I              FJBOTM                      WDBOTM
     I              FJJ8DT                      WDJ8DT
     I              FJBLTM                      WDBLTM
     I              FJKIDT                      WDKIDT
     I              FJASTM                      WDASTM
     I              FJKADT                      WDKADT
     I              FJAJCM                      WDAJCM
     I              FJXACD                      WDXACD
     I              FJOANA                      WDOANA
     I              FJK4TX                      WDK4TX
     I              FJVOAG                      WDVOAG
     I              FJKBDT                      WDKBDT
     I              FJNBBO                      WDNBBO
     I              FJW4CD                      WDW4CD
     I              FJEFDT                      WDEFDT
     I              FJCNTN                      WDCNTN
     I              FJKCDT                      WDKCDT
     I              FJTMIN                      WDTMIN
     I              FJKDDT                      WDKDDT
     I              FJVMNB                      WDVMNB
     I              FJOCFR                      WDOCFR
     I              FJKJDT                      WDKJDT
     I              FJATTM                      WDATTM
     I              FJOTRS                      WDOTRS
     I              FJRNST                      WDRNST
     I              FJBRBK                      WDBRBK
     I              FJEIDT                      WDEIDT
     I              FJRMST                      WDRMST
     I              FJAJCD                      WDAJCD
     I              FJKKDT                      WDKKDT
     I              FJAVTM                      WDAVTM
     I              FJKZDT                      WDKZDT
     I              FJAXTM                      WDAXTM
     I              FJLHOS                      WDLHOS
     I              FJLHOR                      WDLHOR
     I              FJWNTX                      WDWNTX
     I              FJOITX                      WDOITX
     I              FJOJTX                      WDOJTX
     I              FJLLDT                      WDLLDT
     I              FJLSHG                      WDLSHG
     I              FJYPST                      WDYPST
     I              FJK0DT                      WDK0DT
     I              FJAYTM                      WDAYTM
     I              FJKNNX                      WDKNNX
     I              FJICWG                      WDICWG
     I              FJIDWG                      WDIDWG
     I              FJH9SX                      WDH9SX
     I              FJWOTX                      WDWOTX
     I              FJK1DT                      WDK1DT
     I              FJAZTM                      WDAZTM
     I              FJK2DT                      WDK2DT
     I              FJA0TM                      WDA0TM
     I              FJROST                      WDROST
     I              FJRPST                      WDRPST
     I              FJRQST                      WDRQST
     I              FJRRST                      WDRRST
     I              FJZBVA                      WDZBVA
     I              FJWPTX                      WDWPTX
     I              FJWQTX                      WDWQTX
     I              FJWRTX                      WDWRTX
     I              FJWSTX                      WDWSTX
     I              FJRVSX                      WDRVSX
     I              FJRUSX                      WDRUSX
     I              FJRWSX                      WDRWSX
     I              FJRXSX                      WDRXSX
     I              FJRYSX                      WDRYSX
     I              FJRZSX                      WDRZSX
     I              FJR0SX                      WDR0SX
     I              FJR1SX                      WDR1SX
     I              FJR2SX                      WDR2SX
     I              FJR3SX                      WDR3SX
     I              FJR4SX                      WDR4SX
     I              FJPYDT                      WDPYDT
     I              FJCKTM                      WDCKTM
     I              FJPZDT                      WDPZDT
     I              FJCLTM                      WDCLTM
     I              FJP0DT                      WDP0DT
     I              FJCMTM                      WDCMTM
     I              FJP1DT                      WDP1DT
     I              FJCNTM                      WDCNTM
     I              FJP2DT                      WDP2DT
     I              FJCOTM                      WDCOTM
     I              FJP3DT                      WDP3DT
     I              FJCQTM                      WDCQTM
     I              FJUVST                      WDUVST
     I              FJUWST                      WDUWST
     I              FJUXST                      WDUXST
     I              FJAATM                      WDAATM
     I              FJAYNA                      WDAYNA
     I              FJA0NA                      WDA0NA
     I              FJAXDT                      WDAXDT
      *
     I@BFCPMC
      * Order Header TRG          Load Exports
      * Renamed input format fields
     I              BEAIC3                      WEAIC3
     I              BEC4NB                      WEC4NB
     I              BEJNCD                      WEJNCD
     I              BEANC7                      WEANC7
     I              BEBKC7                      WEBKC7
     I              BEBRTX                      WEBRTX
     I              BEHMNA                      WEHMNA
     I              BEHONA                      WEHONA
     I              BEHPNA                      WEHPNA
     I              BEHNNA                      WEHNNA
     I              BEDBCD                      WEDBCD
     I              BECKTX                      WECKTX
     I              BEB0C7                      WEB0C7
     I              BEAETX                      WEAETX
     I              BEB1NA                      WEB1NA
     I              BEB3NA                      WEB3NA
     I              BEB4NA                      WEB4NA
     I              BEB2NA                      WEB2NA
     I              BEBHCD                      WEBHCD
     I              BEC8TX                      WEC8TX
     I              BEBCNA                      WEBCNA
     I              BEA0DT                      WEA0DT
     I              BEA5DT                      WEA5DT
     I              BEGNDT                      WEGNDT
     I              BEACDT                      WEACDT
     I              BEAQCD                      WEAQCD
     I              BEB6NA                      WEB6NA
     I              BEBYNA                      WEBYNA
     I              BEBZNA                      WEBZNA
     I              BEGTST                      WEGTST
     I              BEGVST                      WEGVST
     I              BEGUST                      WEGUST
     I              BEQFST                      WEQFST
     I              BECQCD                      WECQCD
     I              BEGJST                      WEGJST
     I              BEGWST                      WEGWST
     I              BEGXST                      WEGXST
     I              BEGYST                      WEGYST
     I              BEAODT                      WEAODT
     I              BEAIVN                      WEAIVN
     I              BECXDT                      WECXDT
     I              BEJZVA                      WEJZVA
     I              BEA1WG                      WEA1WG
     I              BEXIST                      WEXIST
     I              BEXJST                      WEXJST
     I              BEXKST                      WEXKST
     I              BEEIDT                      WEEIDT
     I              BEAFTM                      WEAFTM
     I              BEE8CD                      WEE8CD
     I              BEE9CD                      WEE9CD
     I              BERMNB                      WERMNB
     I              BETBNB                      WETBNB
     I              BER1NB                      WER1NB
     I              BEPJST                      WEPJST
     I              BEU0ST                      WEU0ST
     I              BEU1ST                      WEU1ST
     I              BEQ2CD                      WEQ2CD
     I              BEU2ST                      WEU2ST
     I              BEVEST                      WEVEST
     I              BEVFST                      WEVFST
     I              BEVGST                      WEVGST
     I              BERPCD                      WERPCD
     I              BERNNB                      WERNNB
     I              BEVDST                      WEVDST
     I              BEATIN                      WEATIN
     I              BEU4ST                      WEU4ST
     I              BEU5ST                      WEU5ST
     I              BERSRN                      WERSRN
     I              BEMHNA                      WEMHNA
     I              BEMINA                      WEMINA
     I              BEWBST                      WEWBST
     I              BER4CD                      WER4CD
     I              BEBFCD                      WEBFCD
     I              BEQ4CD                      WEQ4CD
     I              BET3NB                      WET3NB
     I              BESICD                      WESICD
     I              BECONB                      WECONB
     I              BECEST                      WECEST
     I              BEAWDT                      WEAWDT
     I              BEJPCD                      WEJPCD
     I              BEXUST                      WEXUST
     I              BEZ1ST                      WEZ1ST
     I              BEVRVA                      WEVRVA
     I              BEOBST                      WEOBST
     I              BEBCST                      WEBCST
     I              BEBDST                      WEBDST
     I              BEB7VL                      WEB7VL
     I              BEGASX                      WEGASX
     I              BEGBSX                      WEGBSX
     I              BEGCSX                      WEGCSX
     I              BEGDSX                      WEGDSX
     I              BEFNSX                      WEFNSX
     I              BEFOSX                      WEFOSX
     I              BEFPSX                      WEFPSX
     I              BEFQSX                      WEFQSX
     I              BEFRSX                      WEFRSX
     I              BEFSSX                      WEFSSX
     I              BEFTSX                      WEFTSX
     I              BEFUSX                      WEFUSX
     I              BEFVSX                      WEFVSX
     I              BEFWSX                      WEFWSX
     I              BEFXSX                      WEFXSX
     I              BEFYSX                      WEFYSX
     I              BENODT                      WENODT
     I              BENPDT                      WENPDT
     I              BENQDT                      WENQDT
     I              BENRDT                      WENRDT
     I              BENSDT                      WENSDT
     I              BEBPTM                      WEBPTM
     I              BEBQTM                      WEBQTM
     I              BEBRTM                      WEBRTM
     I              BEBSTM                      WEBSTM
     I              BEBTTM                      WEBTTM
     I              BEH0NX                      WEH0NX
     I              BEH1NX                      WEH1NX
     I              BEH2NX                      WEH2NX
     I              BEH3NX                      WEH3NX
     I              BEH4NX                      WEH4NX
     I              BEC0C7                      WEC0C7
     I              BEUVST                      WEUVST
     I              BEUWST                      WEUWST
     I              BEUXST                      WEUXST
     I              BEAATM                      WEAATM
     I              BEAYNA                      WEAYNA
     I              BEA0NA                      WEA0NA
     I              BEAXDT                      WEAXDT
      *
     I@AMREJM
      * Order Header Extension    Load ID/Order#/Co#
      * Renamed input format fields
     I              AMAIC3                      WFAIC3
     I              AMC4NB                      WFC4NB
     I              AMRMNB                      WFRMNB
     I              AMRUNB                      WFRUNB
     I              AMXACD                      WFXACD
     I              AMOANA                      WFOANA
     I              AMHBAA                      WFHBAA
     I              AMJ0T1                      WFJ0T1
     I              AMGENY                      WFGENY
     I              AMJ1T1                      WFJ1T1
     I              AMHCAA                      WFHCAA
     I              AMQWDT                      WFQWDT
     I              AMQXDT                      WFQXDT
     I              AMQYDT                      WFQYDT
     I              AMHDAA                      WFHDAA
     I              AMCCTX                      WFCCTX
     I              AMJ2T1                      WFJ2T1
     I              AMRLNA                      WFRLNA
     I              AMRMNA                      WFRMNA
     I              AMGINY                      WFGINY
     I              AMGFNY                      WFGFNY
     I              AMGGNY                      WFGGNY
     I              AMGHNY                      WFGHNY
     I              AMHEVL                      WFHEVL
     I              AMHFVL                      WFHFVL
     I              AMHGVL                      WFHGVL
     I              AMQZDT                      WFQZDT
     I              AMQ0DT                      WFQ0DT
     I              AMQ1DT                      WFQ1DT
     I              AMQ2DT                      WFQ2DT
     I              AMC2TX                      WFC2TX
     I              AMC3TX                      WFC3TX
     I              AMC6TX                      WFC6TX
     I              AMCHTX                      WFCHTX
     I              AMCITX                      WFCITX
     I              AMCLTX                      WFCLTX
     I              AMB4TX                      WFB4TX
     I              AMCUTX                      WFCUTX
     I              AMCVTX                      WFCVTX
     I              AMB9TX                      WFB9TX
     I              AMJWSC                      WFJWSC
     I              AMITNY                      WFITNY
     I              AMLMT1                      WFLMT1
     I              AMLWAA                      WFLWAA
     I              AMFVST                      WFFVST
     I              AMF0ST                      WFF0ST
     I              AMF2ST                      WFF2ST
     I              AMF3ST                      WFF3ST
     I              AMJUSC                      WFJUSC
     I              AMJVSC                      WFJVSC
     I              AMV3T1                      WFV3T1
     I              AMV4T1                      WFV4T1
     I              AMV5T1                      WFV5T1
     I              AMV6T1                      WFV6T1
     I              AMV7T1                      WFV7T1
     I              AMV8T1                      WFV8T1
     I              AMV9T1                      WFV9T1
     I              AMWAT1                      WFWAT1
     I              AMWBT1                      WFWBT1
     I              AMWCT1                      WFWCT1
     I              AMWDT1                      WFWDT1
     I              AMQJNY                      WFQJNY
     I              AMQKNY                      WFQKNY
     I              AMQLNY                      WFQLNY
     I              AMP8NY                      WFP8NY
     I              AMP9NY                      WFP9NY
     I              AMQANY                      WFQANY
     I              AMQCNY                      WFQCNY
     I              AMQDNY                      WFQDNY
     I              AMQENY                      WFQENY
     I              AMQFNY                      WFQFNY
     I              AMQGNY                      WFQGNY
     I              AMQHNY                      WFQHNY
     I              AMQINY                      WFQINY
     I              AMQMNY                      WFQMNY
     I              AMMYU1                      WFMYU1
     I              AMJXSC                      WFJXSC
     I              AMJYSC                      WFJYSC
     I              AMJZSC                      WFJZSC
     I              AMJ0SC                      WFJ0SC
     I              AMMZU1                      WFMZU1
     I              AMM0U1                      WFM0U1
     I              AMM1U1                      WFM1U1
     I              AMM2U1                      WFM2U1
     I              AMM3U1                      WFM3U1
     I              AMW5DT                      WFW5DT
     I              AMW6DT                      WFW6DT
     I              AMUVST                      WFUVST
     I              AMUWST                      WFUWST
     I              AMUXST                      WFUXST
     I              AMVSST                      WFVSST
     I              AMAATM                      WFAATM
     I              AMAYNA                      WFAYNA
     I              AMA0NA                      WFA0NA
     I              AMAXDT                      WFAXDT
      *
     I@EVRCX0
      * EDI Applic Advice    Hdr  Update index
      * Renamed input format fields
     I              EVHRNZ                      WGHRNZ
     I              EVRMNB                      WGRMNB
     I              EVTOU1                      WGTOU1
     I              EVA0ST                      WGA0ST
     I              EVHPAA                      WGHPAA
     I              EVTKAA                      WGTKAA
     I              EVVODT                      WGVODT
     I              EVA4AB                      WGA4AB
     I              EVTYPC                      WGTYPC
     I              EVO7T1                      WGO7T1
     I              EVDCDQ                      WGDCDQ
     I              EVTLU1                      WGTLU1
     I              EVTLAA                      WGTLAA
     I              EVDLU1                      WGDLU1
     I              EVS3U1                      WGS3U1
     I              EVTSU1                      WGTSU1
      *
     I@AMREWU
      * Order Header Extension    AES ITN#
      * Renamed input format fields
     I              AMAIC3                      WHAIC3
     I              AMC4NB                      WHC4NB
     I              AMRMNB                      WHRMNB
     I              AMRUNB                      WHRUNB
     I              AMXACD                      WHXACD
     I              AMOANA                      WHOANA
     I              AMHBAA                      WHHBAA
     I              AMJ0T1                      WHJ0T1
     I              AMGENY                      WHGENY
     I              AMJ1T1                      WHJ1T1
     I              AMHCAA                      WHHCAA
     I              AMQWDT                      WHQWDT
     I              AMQXDT                      WHQXDT
     I              AMQYDT                      WHQYDT
     I              AMHDAA                      WHHDAA
     I              AMCCTX                      WHCCTX
     I              AMJ2T1                      WHJ2T1
     I              AMRLNA                      WHRLNA
     I              AMRMNA                      WHRMNA
     I              AMGINY                      WHGINY
     I              AMGFNY                      WHGFNY
     I              AMGGNY                      WHGGNY
     I              AMGHNY                      WHGHNY
     I              AMHEVL                      WHHEVL
     I              AMHFVL                      WHHFVL
     I              AMHGVL                      WHHGVL
     I              AMQZDT                      WHQZDT
     I              AMQ0DT                      WHQ0DT
     I              AMQ1DT                      WHQ1DT
     I              AMQ2DT                      WHQ2DT
     I              AMC2TX                      WHC2TX
     I              AMC3TX                      WHC3TX
     I              AMC6TX                      WHC6TX
     I              AMCHTX                      WHCHTX
     I              AMCITX                      WHCITX
     I              AMCLTX                      WHCLTX
     I              AMB4TX                      WHB4TX
     I              AMCUTX                      WHCUTX
     I              AMCVTX                      WHCVTX
     I              AMB9TX                      WHB9TX
     I              AMJWSC                      WHJWSC
     I              AMITNY                      WHITNY
     I              AMLMT1                      WHLMT1
     I              AMLWAA                      WHLWAA
     I              AMFVST                      WHFVST
     I              AMF0ST                      WHF0ST
     I              AMF2ST                      WHF2ST
     I              AMF3ST                      WHF3ST
     I              AMJUSC                      WHJUSC
     I              AMJVSC                      WHJVSC
     I              AMV3T1                      WHV3T1
     I              AMV4T1                      WHV4T1
     I              AMV5T1                      WHV5T1
     I              AMV6T1                      WHV6T1
     I              AMV7T1                      WHV7T1
     I              AMV8T1                      WHV8T1
     I              AMV9T1                      WHV9T1
     I              AMWAT1                      WHWAT1
     I              AMWBT1                      WHWBT1
     I              AMWCT1                      WHWCT1
     I              AMWDT1                      WHWDT1
     I              AMQJNY                      WHQJNY
     I              AMQKNY                      WHQKNY
     I              AMQLNY                      WHQLNY
     I              AMP8NY                      WHP8NY
     I              AMP9NY                      WHP9NY
     I              AMQANY                      WHQANY
     I              AMQCNY                      WHQCNY
     I              AMQDNY                      WHQDNY
     I              AMQENY                      WHQENY
     I              AMQFNY                      WHQFNY
     I              AMQGNY                      WHQGNY
     I              AMQHNY                      WHQHNY
     I              AMQINY                      WHQINY
     I              AMQMNY                      WHQMNY
     I              AMMYU1                      WHMYU1
     I              AMJXSC                      WHJXSC
     I              AMJYSC                      WHJYSC
     I              AMJZSC                      WHJZSC
     I              AMJ0SC                      WHJ0SC
     I              AMMZU1                      WHMZU1
     I              AMM0U1                      WHM0U1
     I              AMM1U1                      WHM1U1
     I              AMM2U1                      WHM2U1
     I              AMM3U1                      WHM3U1
     I              AMW5DT                      WHW5DT
     I              AMW6DT                      WHW6DT
     I              AMUVST                      WHUVST
     I              AMUWST                      WHUWST
     I              AMUXST                      WHUXST
     I              AMVSST                      WHVSST
     I              AMAATM                      WHAATM
     I              AMAYNA                      WHAYNA
     I              AMA0NA                      WHA0NA
     I              AMAXDT                      WHAXDT
      *
     I@GNREHW
      * EDI Interchange           Retrieval index
      * Renamed input format fields
     I              GNM4AA                      WIM4AA
     I              GNAUNA                      WIAUNA
     I              GNW9T1                      WIW9T1
     I              GNM5AA                      WIM5AA
     I              GNVSST                      WIVSST
     I              GNMJDT                      WIMJDT
     I              GNBETM                      WIBETM
     I              GNCCVN                      WICCVN
     I              GNCDVN                      WICDVN
     I              GNMKDT                      WIMKDT
     I              GNBFTM                      WIBFTM
     I              GNCEVN                      WICEVN
     I              GNCFVN                      WICFVN
      *
     I@EZREYD
      * EDI Applic Advice    Err  Retrieval index
      * Renamed input format fields
     I              EZHRNZ                      WJHRNZ
     I              EZKGAA                      WJKGAA
     I              EZA5AB                      WJA5AB
     I              EZDXNB                      WJDXNB
     I              EZKHAA                      WJKHAA
     I              EZDNU1                      WJDNU1
     I              EZA7AB                      WJA7AB
     I              EZDMU1                      WJDMU1
     I              EZTUU1                      WJTUU1
     I              EZTVU1                      WJTVU1
      *
     I@P037LW
      * EDI Applic Advice    Dtl  Ctl#/RefIdQlf/ApplAck
      * Renamed input format fields
     I              EWHRNZ                      WKHRNZ
     I              EWKGAA                      WKKGAA
     I              EWA5AB                      WKA5AB
     I              EWS4U1                      WKS4U1
     I              EWA6AB                      WKA6AB
     I              EWNQNY                      WKNQNY
     I              EWNRNY                      WKNRNY
     I              EWNSNY                      WKNSNY
     I              EWTMAA                      WKTMAA
     I              EWVPDT                      WKVPDT
     I              EWOFAA                      WKOFAA
     I              EWMIVL                      WKMIVL
     I              EWTNAA                      WKTNAA
     I              EWMZVL                      WKMZVL
     I              EWTTU1                      WKTTU1
     I              EWHGNZ                      WKHGNZ
      *
     I@P136LU
      * EDI Export Shpmnt Inf HDR Load ID/Rcd Proc/Ctl# (D
      * Renamed input format fields
     I              COTSCN                      WLTSCN
     I              COA0ST                      WLA0ST
     I              COHPAA                      WLHPAA
     I              COA8AB                      WLA8AB
     I              COA9AB                      WLA9AB
     I              COBAAB                      WLBAAB
     I              COBBAB                      WLBBAB
     I              COHDNZ                      WLHDNZ
     I              COBEAB                      WLBEAB
     I              COVRNA                      WLVRNA
     I              COBCAB                      WLBCAB
     I              COS5U1                      WLS5U1
     I              COBDAB                      WLBDAB
     I              COB7DX                      WLB7DX
     I              COS6U1                      WLS6U1
     I              COS7U1                      WLS7U1
     I              COS8U1                      WLS8U1
     I              COBFAB                      WLBFAB
     I              COS9U1                      WLS9U1
     I              COTAU1                      WLTAU1
     I              COTBU1                      WLTBU1
     I              COTPU1                      WLTPU1
     I              COTQU1                      WLTQU1
     I              COTRU1                      WLTRU1
     I              COCADX                      WLCADX
     I              COBETM                      WLBETM
     I              CON8SC                      WLN8SC
      *
     I@COCPKT
      * EDI Export Shpmnt Inf HDR Update index
      * Renamed input format fields
     I              COTSCN                      WMTSCN
     I              COA0ST                      WMA0ST
     I              COHPAA                      WMHPAA
     I              COA8AB                      WMA8AB
     I              COA9AB                      WMA9AB
     I              COBAAB                      WMBAAB
     I              COBBAB                      WMBBAB
     I              COHDNZ                      WMHDNZ
     I              COBEAB                      WMBEAB
     I              COVRNA                      WMVRNA
     I              COBCAB                      WMBCAB
     I              COS5U1                      WMS5U1
     I              COBDAB                      WMBDAB
     I              COB7DX                      WMB7DX
     I              COS6U1                      WMS6U1
     I              COS7U1                      WMS7U1
     I              COS8U1                      WMS8U1
     I              COBFAB                      WMBFAB
     I              COS9U1                      WMS9U1
     I              COTAU1                      WMTAU1
     I              COTBU1                      WMTBU1
     I              COTPU1                      WMTPU1
     I              COTQU1                      WMTQU1
     I              COTRU1                      WMTRU1
     I              COCADX                      WMCADX
     I              COBETM                      WMBETM
     I              CON8SC                      WMN8SC
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Prc EDI 824 Applic Adv XF
      * NOTE: JS 'IB824ASTST' & 'IB824AS400' calls this function every 5
      *       mins interval.
      * Prc EDI 824 Applic Adv RT - EDI Applic Advice    Hdr  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Prc EDI 824 Applic Adv RT - EDI Applic Advice    Hdr  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * RTV System Value Alpha RT - System Values  * Get Export Doc Team
     C                   EXSR      SBRVGN
      * RTV Data Libraries     RT - System Values  * In TEST or PROD
     C                   EXSR      SCRVGN
      * Establish starting position
     C     *LOVAL        SETLL     @P008X3                                      *
     C                   READ      @P008X3                                90    *
      * Data record not found
     C   90              MOVEL     'USR4076'     W0RTN
      * USER: Process Data record
      * Validations.
      * CASE: *OTHERWISE
      * Valid Load ID.
      * CASE: *OTHERWISE
      * Val Shipment Cancelled RT - EDI Applic Advice    Err  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SDRVGN
      * Do Not Validate For Cancel/Delete Request on the 601.
      * CASE: LCL.Cancelled Flag USR is No
      * VAL Load Exist        RT - Load Header  * 
     C                   IF        YL0003 = 'N'
     C                   EXSR      SERVGN
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   MOVEL     'Y'           YL0004                         Process EDI 824
      * Rtv 1st Order#/PO#    RT - Order Header TRG  * 
     C                   EXSR      SFRVGN
     C                   EVAL      YL0007 = ' '                                 Load ID Alpha U
     C                   MOVEL     WARMNB        YL0007                         Load ID Alpha U
     C                   EVAL      YL0008 = ' '                                 Order Number Al
     C                   MOVEL     YL0005        YL0008                         Order Number Al
      * Rtv 1st Booking#      RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WARMNB        WL0001                         Load ID
     C                   EXSR      SGRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        YL0009                         OHE Booking Num
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           YL0004                         Process EDI 824
     C                   EVAL      YL0010 = ' '                                 Email Address U
     C                   MOVEL     @CN(004)      YL0010                         Email Address U
      * Format Email Data.
      * CASE: *OTHERWISE
     C                   EVAL      YL0007 = ' '                                 Load ID Alpha U
     C                   MOVEL     WARMNB        YL0007                         Load ID Alpha U
     C                   EVAL      YL0008 = ' '                                 Order Number Al
     C                   MOVEL     YL0005        YL0008                         Order Number Al
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(005)      CAT(P)    'PO:':ZQ      YL0011                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0011        CAT(P)    YL0007:ZQ     YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    '/':ZQ        YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    YL0008:ZQ     YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    '/':ZQ        YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    YL0006:ZQ     YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(006)      CAT(P)    @CN(007):ZQ   YL0012                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0012        CAT(P)    @CN(008):ZQ   YL0012                         Email Message 2
      * If Not PROD Then Append 'TEST' to Email Message.
      * CASE: LCL.Library List Code is Not PRKFLIB
     C                   IF        YL0002 <> @CN(009)
     C                   Z-ADD     1             ZQ
     C     YL0011        CAT(P)    @CN(010):ZQ   YL0011                         Email Subject 2
     C                   EVAL      YL0010 = ' '                                 Email Address U
     C                   MOVEL     @CN(011)      YL0010                         Email Address U
     C                   END                                                    *FI
      * Exc ESNDMAIL Generic2 CL - /UT User Programs  * 
     C                   CALL      'PUX2UPC'                            90      Exc ESNDMAIL Ge
     C                   PARM      YL0010        WQ0001                         Email Address
     C                   PARM      YL0011        WQ0002                         Email Subject 2
     C                   PARM      YL0012        WQ0003                         Email Message 2
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUX2UPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * Chg EDI-Record Proc StsCH - EDI Applic Advice    Hdr  * Error
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHRNZ        WL0003                         ST02-TRANS SET
     C                   MOVEL(P)  'E'           WL0004                         EDI-Record Proc
     C                   EXSR      SHCHRC
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Load has been deleted from database. Just use Load # from ECP036.
     C                   MOVEL     'Y'           YL0004                         Process EDI 824
     C                   Z-ADD     *ZERO         YL0005                         Order Number
     C                   EVAL      YL0006 = ' '                                 Customer Purcha
     C                   EVAL      YL0007 = ' '                                 Load ID Alpha U
     C                   MOVEL     WARMNB        YL0007                         Load ID Alpha U
     C                   EVAL      YL0008 = ' '                                 Order Number Al
     C                   MOVEL     YL0005        YL0008                         Order Number Al
      * Rtv 1st Booking#      RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WARMNB        WL0001                         Load ID
     C                   EXSR      SGRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        YL0009                         OHE Booking Num
      * No record found for Load ID, look for AES ITN#
      * CASE: PGM.*Return code is *Record does not exist
      * Rtv 1st Booking# w/ITN RT - Order Header Extension  * 
     C                   IF        W0RTN = @CN(012)
     C                   EXSR      SIRVGN
     C                   END                                                    *FI
     C                   END                                                    *FI
      * EDI Interchange 'APPADV' Active?
      * CASE: LCL.Process EDI 824 USR is Yes
      * RTV Record Status     RT - EDI Interchange  * APPADV
     C                   IF        YL0004 = 'Y'
     C                   EXSR      SJRVGN
      * EDI Interchange 'APPADV' Active?
      * CASE: LCL.Record Status is Active
     C                   IF        YL0013 = 'A'
     C                   MOVEL     'Y'           YL0004                         Process EDI 824
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           YL0004                         Process EDI 824
     C                   EVAL      YL0010 = ' '                                 Email Address U
     C                   MOVEL     @CN(013)      YL0010                         Email Address U
      * Format Email Data.
      * CASE: *OTHERWISE
     C                   EVAL      YL0007 = ' '                                 Load ID Alpha U
     C                   MOVEL     WARMNB        YL0007                         Load ID Alpha U
     C                   EVAL      YL0008 = ' '                                 Order Number Al
     C                   MOVEL     YL0005        YL0008                         Order Number Al
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(005)      CAT(P)    'PO:':ZQ      YL0011                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0011        CAT(P)    YL0007:ZQ     YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    '/':ZQ        YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    YL0008:ZQ     YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    '/':ZQ        YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0011        CAT(P)    YL0006:ZQ     YL0011                         Email Subject 2
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(006)      CAT(P)    @CN(014):ZQ   YL0012                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0012        CAT(P)    @CN(015):ZQ   YL0012                         Email Message 2
      * If Not PROD Then Append 'TEST' to Email Message.
      * CASE: LCL.Library List Code is Not PRKFLIB
     C                   IF        YL0002 <> @CN(009)
     C                   Z-ADD     1             ZQ
     C     YL0011        CAT(P)    @CN(010):ZQ   YL0011                         Email Subject 2
     C                   END                                                    *FI
      * Exc ESNDMAIL Generic2 CL - /UT User Programs  * 
     C                   CALL      'PUX2UPC'                            90      Exc ESNDMAIL Ge
     C                   PARM      YL0010        WQ0004                         Email Address
     C                   PARM      YL0011        WQ0005                         Email Subject 2
     C                   PARM      YL0012        WQ0006                         Email Message 2
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUX2UPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * Chg EDI-Record Proc StsCH - EDI Applic Advice    Hdr  * Error
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHRNZ        WL0003                         ST02-TRANS SET
     C                   MOVEL(P)  'E'           WL0004                         EDI-Record Proc
     C                   EXSR      SHCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Processing.
      * CASE: LCL.Process EDI 824 USR is Yes
      * Email Document Export Team for EDI Applic Advice Err (ECP038) Rec
      * IN05690 DN 08/30/23-Added Shipment Cancelled USR Parm.
      * Prc Email Export Team RT - EDI Applic Advice    Err  * 
     C                   IF        YL0004 = 'Y'
     C                   EXSR      SKRVGN
      * Continue Update If Email was Sent.
      * CASE: LCL.Send Email USR is Yes
      * Update EDI Record Processed in ECP036 per Error Disposition code.
      * Chg EDI-Record Proc StsCH - EDI Applic Advice    Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0015 = 'Y'
     C                   Z-ADD     WAHRNZ        WL0003                         ST02-TRANS SET
     C                   MOVEL(P)  YL0014        WL0004                         EDI-Record Proc
     C                   EXSR      SHCHRC
      * IN05690 DN 08/30/23-Commented Out & Moved Below.
      * Update OHE EDI 824 Info. Check Cancelled Shipment. IN05690 DN 08/
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Shipment Cancelled USR is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0016 = 'Y'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * Get AES ITN # If 824 Accepted.
      * CASE: LCL.EDI-Record Processed is Processed
     C                   IF        Y0CX01 = '1'
      * Rtv AES ITN #         RT - EDI Applic Advice    Dtl  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0014 = 'Y'
     C                   Z-ADD     WAHRNZ        WL0005                         ST02-TRANS SET
     C                   MOVEL(P)  'ES1'         WL0006                         OTI02-Ref ID Qu
     C                   EXSR      SLRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0007        YL0031                         OTI03-Ref ID TE
      * If 'Pending' 601 exist, then we want to update 'BA102-Action Code
      * 'RX' (Replace) since ITN# was received.
     C                   MOVEL     'Y'           YL0032                         Upd BA102-Actio
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0031 = ' '                                 OHE EDI 824 AES
     C                   MOVEL     'N'           YL0032                         Upd BA102-Actio
     C                   END                                                    *FI
      * Upd OHE EDI 824 Action XF - Order Header Extension  * 
     C                   CALL      'PUXXXFR'                            90      Upd OHE EDI 824
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WARMNB        WQ0010                         Load ID
     C                   PARM      YL0009        WQ0011                         OHE Booking Num
     C                   PARM      YL0014        WQ0012                         EDI-Record Proc
     C                   PARM      'A'           WQ0013                         Update OHE EDI
     C                   PARM      YL0031        WQ0014                         OHE EDI 824 AES
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUXXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
      * Processing for Shipment Cancelled. Reset EDI 601/824 Info to Blan
      * Upd OHE EDI 601/824 InfXF - Order Header Extension  * 
     C                   CALL      'PVA5XFR'                            90      Upd OHE EDI 601
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WARMNB        WQ0015                         Load ID
     C                   PARM      YL0009        WQ0016                         OHE Booking Num
     C                   PARM      *BLANK        WQ0017                         OHE EDI 824 Act
     C                   PARM      *BLANK        WQ0018                         OHE EDI 601 Act
     C                   PARM      *BLANK        WQ0019                         OHE EDI 824 AES
     C                   PARM      WATOU1        WQ0020                         OHE EDI 824 AES
     C     YL0033        PARM      *ZERO         WQ0021                         Load ID USR
     C     YL0034        PARM      *BLANK        WQ0022                         New LID added t
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVA5XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * Update '824 Received Sts' in EDI Export Shpmnt Inf HDR (ECP136).
      * CASE: *OTHERWISE
      * Upd 824 Received Sts  RT - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SNRVGN
      * Update 'Pending' Records in EDI Export Shpmnt Inf HDR (ECP136).
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Shipment Cancelled USR is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0016 = 'Y'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * IN05690 DN 08/30/23-Added to Check LCL.Shipment Cancelled USR Fla
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0035                         First Time Thro
      * Upd Pending EDI 601 RcdRT - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SPRVGN
     C                   ELSE
      * CASE: *OTHERWISE
      * Processing for Shipment Cancelled. Cancel any 601 Requests.
      * Upd Pending EDI 601 CanRT - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SSRVGN
      * Update 601 records for new Load ID
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.New LID added to order is Yes
      *   |- c2    : LCL.Load ID USR is entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0034 = 'Y'
     C                   IF        YL0033 <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Upd Pending EDI 601 NP RT - EDI Export Shpmnt Inf HDR  * 
     C                   IF        Y0CX01 = '1'
     C                   EXSR      STRVGN
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   READ      @P008X3                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * Get Export Doc Team
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBDOCD                         System Value Co
      * Setup key
     C                   MOVEL     @CN(001)      WBDOCD                         System Value Co
      * Establish starting position
     C     KRSSB         CHAIN     @DPRETD                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0759'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0001 = ' '                                 System Value Al
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBBXTX        YL0001                         System Value Al
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * RTV Data Libraries     RT - System Values  * In TEST or PROD
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KPSSC         KLIST
     C                   KFLD                    WBDOCD                         System Value Co
      * Setup key
     C                   EVALR     WBDOCD = ' '                                 System Value Co
     C                   MOVEL     'DTALIB'      WBDOCD                         System Value Co
      * Establish starting position
     C     KPSSC         SETLL     @DPRETD                                      *
     C                   READ      @DPRETD                                90    *
      * Data record not found
     C   90              MOVEL     'USR0759'     W0RTN
      * USER: Process Data record
      * CASE: DB1.System Value Code is Data File Library
     C                   DOW       NOT *IN90
     C                   IF        WBDOCD = @CN(002)
     C                   MOVEL     WBBXTX        YL0002                         Library List Co
     C                   ELSE
      * CASE: DB1.System Value Code is History File Library
     C                   IF        WBDOCD = @CN(003)
     C                   MOVEL     WBBXTX        YN0001                         @Library List C
     C                   GOTO      SCEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   READ      @DPRETD                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Val Shipment Cancelled RT - EDI Applic Advice    Err  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0003                         Cancelled Flag
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WQSD01                         ST02-TRANS SET
     C                   KFLD                    WQSD02                         OTI02-Ref ID Qu
      * Setup key
     C                   Z-ADD     WAHRNZ        WQSD01                         ST02-TRANS SET
     C                   MOVEL     'ES1'         WQSD02                         OTI02-Ref ID Qu
      * Establish starting position
     C     KRSSD         SETLL     @P038LV                                      *
     C     KRSSD         READE     @P038LV                                90    *
      * Data record not found
     C   90              MOVEL     'USR4088'     W0RTN
      * USER: Process Data record
      * CASE: DB1.TED01-Applic Err Cond Cde is Shipment Cancelled
     C                   DOW       NOT *IN90
     C                   IF        WCKHAA = '983'
     C                   MOVEL     'Y'           YL0003                         Cancelled Flag
     C                   GOTO      SDEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSD         READE     @P038LV                                90    *
     C                   ENDDO
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * VAL Load Exist        RT - Load Header  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WDRMNB                         Load ID
      * Setup key
     C                   Z-ADD     WARMNB        WDRMNB                         Load ID
      * Establish starting position
     C     KRSSE         CHAIN     @FJCPBN                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1188'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   GOTO      SEEXIT                                       *QUIT
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * Rtv 1st Order#/PO#    RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0005                         Order Number
     C                   EVAL      YL0006 = ' '                                 Customer Purcha
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WQSF02                         Load ID
      * Setup key
     C                   Z-ADD     WARMNB        WQSF02                         Load ID
      * Establish starting position
     C     KRSSF         SETLL     @BFCPMC                                      *
     C     KRSSF         READE     @BFCPMC                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Header Status is Not cancelled
     C                   DOW       NOT *IN90
      * PAR = DB1 By name
     C                   IF        WEGWST = 'L' OR
     C                             WEGWST = 'A' OR
     C                             WEGWST = 'C' OR
     C                             WEGWST = 'R' OR
     C                             WEGWST = 'E' OR
     C                             WEGWST = 'H' OR
     C                             WEGWST = 'I'
     C                   Z-ADD     WEC4NB        YL0005                         Order Number
     C                   MOVEL     WEBCNA        YL0006                         Customer Purcha
     C                   GOTO      SFEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSF         READE     @BFCPMC                                90    *
     C                   ENDDO
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * Rtv 1st Booking#      RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0002 = ' '                                 OHE Booking Num
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WQSG01                         Load ID
      * Setup key
     C                   Z-ADD     WL0001        WQSG01                         Load ID
      * Establish starting position
     C     KRSSG         SETLL     @AMREJM                                      *
     C     KRSSG         READE     @AMREJM                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3697'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CASE: DB1.OHE Booking Number is Entered
     C                   DOW       NOT *IN90
      * PAR = DB1 By name
     C                   IF        WFJ1T1 <> ' '
     C                   MOVEL     WFJ1T1        WL0002                         OHE Booking Num
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   GOTO      SGEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSG         READE     @AMREJM                                90    *
     C                   ENDDO
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHCHRC        BEGSR
      *================================================================
      * Chg EDI-Record Proc StsCH - EDI Applic Advice    Hdr  * Error
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Load ID
     C                   EVAL      WN0002 = ' '                                 Reference ITN
     C                   EVAL      WN0003 = ' '                                 TRADE PARTNER C
     C                   EVAL      WN0004 = ' '                                 BGN01-Trans Pur
     C                   Z-ADD     *ZERO         WN0005                         BGN03-Reference
     C                   EVAL      WN0006 = ' '                                 BGN06-Output Ba
     C                   EVAL      WN0007 = ' '                                 N101-NAME TYPE
     C                   EVAL      WN0008 = ' '                                 N102-USPPI Name
     C                   EVAL      WN0009 = ' '                                 N103-ID CODE QU
     C                   EVAL      WN0010 = ' '                                 N104-Identifica
     C                   EVAL      WN0011 = ' '                                 PER-Communicati
     C                   EVAL      WN0012 = ' '                                 PER-Communicati
     C                   EVAL      WN0013 = ' '                                 REF02-Filer Bat
     C                   EVAL      WN0014 = ' '                                 EDI AAH Unused
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @EVRCX0
     C                   Z-ADD     WL0003        WGHRNZ                         ST02-TRANS SET
      *
     C     KLCHSH        KLIST
     C                   KFLD                    WGHRNZ                         ST02-TRANS SET
     C     KLCHSH        CHAIN     @EVRCX0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP036L0'    MDACP
     C                   MOVEL     '@EVRCX0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP01        YARDCS
      * Move non-key fields to @EVRCX0
     C                   MOVEL(P)  WL0004        WGA0ST                         EDI-Record Proc
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP01 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @EVRCX0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP036L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * Rtv 1st Booking# w/ITN RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0009 = ' '                                 OHE Booking Num
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    WQSI01                         OHE EDI 824 AES
      * Setup key
     C                   MOVEL     WATOU1        WQSI01                         OHE EDI 824 AES
      * Establish starting position
     C     KRSSI         SETLL     @AMREWU                                      *
     C     KRSSI         READE     @AMREWU                                90    *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * CASE: DB1.OHE Booking Number is Entered
     C                   DOW       NOT *IN90
      * PAR = DB1 By name
     C                   IF        WHJ1T1 <> ' '
     C                   MOVEL     WHJ1T1        YL0009                         OHE Booking Num
     C                   GOTO      SIEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSI         READE     @AMREWU                                90    *
     C                   ENDDO
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * RTV Record Status     RT - EDI Interchange  * APPADV
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0013 = ' '                                 Record Status
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    WIM4AA                         Interchange Cod
      * Setup key
     C                   MOVEL     'APPADV'      WIM4AA                         Interchange Cod
      * Establish starting position
     C     KRSSJ         CHAIN     @GNREHW                            90        *
      * Data record not found
     C   90              MOVEL     'USR4367'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WIVSST        YL0013                         Record Status
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * Prc Email Export Team RT - EDI Applic Advice    Err  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   EVAL      YL0014 = ' '                                 EDI-Record Proc
     C                   MOVEL     'Y'           YL0017                         First Time Thro
     C                   MOVEL     'N'           YL0015                         Send Email USR
      * IN05690 DN 08/30/23-Initialize.
     C                   MOVEL     'N'           YL0016                         Shipment Cancel
      * Rtv AES ITN #         RT - EDI Applic Advice    Dtl  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHRNZ        WL0005                         ST02-TRANS SET
     C                   MOVEL(P)  'ES1'         WL0006                         OTI02-Ref ID Qu
     C                   EXSR      SLRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0007        YL0018                         OTI03-Ref ID TE
      * Get Error Disposition Info for 'ES1' Line.
      * Rtv Error Disposition RT - EDI Applic Advice    Err  * 
     C                   EXSR      SMRVGN
      * IN05690 DN 08/30/23-Check If Shipment Cancelled.
      * CASE: LCL.EDI 824 Err Disposition U is Accepted
     C                   IF        YL0021 = 'A'
     C                   EVAL      YL0023 = ' '                                 Error Descripti
     C                   MOVEL     YL0020        YL0023                         Error Descripti
      * Load Cancelled.
      * CASE: LCL.Error Description USR is Shipment Cancelled
     C                   IF        YL0023 = @CN(016)
     C                   MOVEL     'Y'           YL0016                         Shipment Cancel
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WQSK01                         ST02-TRANS SET
      * Setup key
     C                   Z-ADD     WAHRNZ        WQSK01                         ST02-TRANS SET
      * Establish starting position
     C     KRSSK         SETLL     @EZREYD                                      *
     C     KRSSK         READE     @EZREYD                                90    *
      * Data record not found
     C   90              MOVEL     'USR4088'     W0RTN
      * USER: Process Data record
      * Processing for Only 1 Record Exist.
      * CASE: LCL.Count Records        USR is EQ 1
     C                   DOW       NOT *IN90
      * Must be 'ES1' Record.
      * Format Email Data.
      * CASE: LCL.First Time Through USR is Yes
     C                   IF        YL0022 = 1
     C                   IF        YL0017 = 'Y'
     C                   MOVEL     'N'           YL0017                         First Time Thro
     C                   MOVEL     'Y'           YL0015                         Send Email USR
      * Format Email Subject Line.
      * CASE: *OTHERWISE
     C                   Z-ADD     1             ZQ
     C     @CN(017)      CAT(P)    YL0007:ZQ     YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    '/':ZQ        YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    YL0006:ZQ     YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    '/':ZQ        YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    YL0008:ZQ     YL0024                         Email Subject 2
      * If Not PROD Then Append 'TEST' to Email Subject Line.
      * CASE: PAR.Library List Code is Not PRKFLIB
     C                   IF        YL0002 <> @CN(009)
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    @CN(010):ZQ   YL0024                         Email Subject 2
     C                   END                                                    *FI
      * Format Email Message 'We have received' Line.
      * CASE: *OTHERWISE
     C                   Z-ADD     0             ZQ
     C     @CN(018)      CAT(P)    @CN(019):ZQ   YL0025                         Email Message 2
      * Get System Date/Time.
      * Get System Date/Time 2 US - /UT User Source  * 
      * Get System Date/Time 2 US
      *
      /free
         SysDateUSA = %date();
         YL0026 = %char(SysDateUSA);

         SysTimeHMS = %char(%time():*HMS);
         YL0027 = SysTimeHMS;
      /end-free
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0026:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0027:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     0             ZQ
     C     YL0025        CAT(P)    '.':ZQ        YL0025                         Email Message 2
      * Format Email Message 'Your Request to' Line.
      * CASE: *OTHERWISE
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(020):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     0             ZQ
     C     YL0025        CAT(P)    @CN(021):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     1             YRSW00
     C                   Z-ADD     3             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WJDNU1:ZQ     YL0021                 90      EDI 824 Err Dis
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * Set Error Disposition Accepted or Rejected Text.
      * CASE: LCL.EDI 824 Err Disposition U is Accepted
     C                   IF        YL0021 = 'A'
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(022):ZQ   YL0025                         Email Message 2
     C                   MOVEL     'Y'           YL0014                         EDI-Record Proc
     C                   ELSE
      * CASE: LCL.EDI 824 Err Disposition U is Rejected
     C                   IF        YL0021 = 'R'
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(023):ZQ   YL0025                         Email Message 2
     C                   MOVEL     'E'           YL0014                         EDI-Record Proc
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Format Email Message 'Shipment Reference #' Line.
      * CASE: *OTHERWISE
      * Force 2 New Lines.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(024):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    ':':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0007:ZQ     YL0025                         Email Message 2
      * Format Email Message 'AES ITN' Line if Exist.
      * CASE: LCL.EDI 824 Err Disposition U is Accepted
      * Force New Line.
     C                   IF        YL0021 = 'A'
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(025):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0018:ZQ     YL0025                         Email Message 2
     C                   END                                                    *FI
      * Format Email Message 'Attention' Line.
      * CASE: *OTHERWISE
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(026):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    @CN(026):ZQ   YL0025                         Email Message 2
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(027):ZQ   YL0025                         Email Message 2
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WJDNU1:ZQ     YL0028                 90      EDI 824 Error T
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * Set Error Type Code Text.
      * CASE: LCL.EDI 824 Error Type U is Fatal
     C                   IF        YL0028 = 'F'
     C                   EVAL      YL0029 = ' '                                 EDI 824 Error T
     C                   MOVEL     'FATAL'       YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: LCL.EDI 824 Error Type U is Verify
     C                   IF        YL0028 = 'V'
     C                   MOVEL     @CN(028)      YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: LCL.EDI 824 Error Type U is Compliance
     C                   IF        YL0028 = 'C'
     C                   MOVEL     @CN(029)      YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     @CN(030)      YL0029                         EDI 824 Error T
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '(':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     0             ZQ
     C     YL0025        CAT(P)    WJKHAA:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    '-':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    YL0029:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    ')':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     56            YRSW00
     C                   Z-ADD     5             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WJDNU1:ZQ     YL0030                 90      EDI 824 Error D
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0030:ZQ     YL0025                         Email Message 2
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Processing for Multiple Records Exist.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Count Records        USR is GT 1
      *   |- c2    : LCL.First Time Through USR is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0022 > 1
     C                   IF        YL0017 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Removed 'NOTc2 - DB1.OTI02-Ref ID Qualifier is ES1 (For ITN)'.
      * Format Email Data.
      * CASE: LCL.First Time Through USR is Yes
     C                   IF        Y0CX01 = '1'
     C                   IF        YL0017 = 'Y'
     C                   MOVEL     'N'           YL0017                         First Time Thro
     C                   MOVEL     'Y'           YL0015                         Send Email USR
      * Format Email Subject Line.
      * CASE: *OTHERWISE
     C                   Z-ADD     1             ZQ
     C     @CN(017)      CAT(P)    YL0007:ZQ     YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    '/':ZQ        YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    YL0006:ZQ     YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    '/':ZQ        YL0024                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    YL0008:ZQ     YL0024                         Email Subject 2
      * If Not PROD Then Append 'TEST' to Email Subject Line.
      * CASE: PAR.Library List Code is Not PRKFLIB
     C                   IF        YL0002 <> @CN(009)
     C                   Z-ADD     1             ZQ
     C     YL0024        CAT(P)    @CN(010):ZQ   YL0024                         Email Subject 2
     C                   END                                                    *FI
      * Format Email Message 'We have received' Line.
      * CASE: *OTHERWISE
     C                   Z-ADD     0             ZQ
     C     @CN(018)      CAT(P)    @CN(019):ZQ   YL0025                         Email Message 2
      * Get System Date/Time.
      * Get System Date/Time 2 US - /UT User Source  * 
      /free
         SysDateUSA = %date();
         YL0026 = %char(SysDateUSA);

         SysTimeHMS = %char(%time():*HMS);
         YL0027 = SysTimeHMS;
      /end-free
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0026:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0027:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     0             ZQ
     C     YL0025        CAT(P)    '.':ZQ        YL0025                         Email Message 2
      * Format Email Message 'Your Request to' Line.
      * CASE: *OTHERWISE
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(020):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     0             ZQ
     C     YL0025        CAT(P)    @CN(021):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     1             YRSW00
     C                   Z-ADD     3             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0020:ZQ     YL0021                 90      EDI 824 Err Dis
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * Set Error Disposition Accepted or Rejected Text.
      * CASE: LCL.EDI 824 Err Disposition U is Accepted
     C                   IF        YL0021 = 'A'
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(022):ZQ   YL0025                         Email Message 2
     C                   MOVEL     'Y'           YL0014                         EDI-Record Proc
     C                   ELSE
      * CASE: LCL.EDI 824 Err Disposition U is Rejected
     C                   IF        YL0021 = 'R'
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(023):ZQ   YL0025                         Email Message 2
     C                   MOVEL     'E'           YL0014                         EDI-Record Proc
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Format Email Message 'Shipment Reference #' Line.
      * CASE: *OTHERWISE
      * Force 2 New Lines.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(024):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    ':':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0007:ZQ     YL0025                         Email Message 2
      * Format Email Message 'AES ITN' Line if Exist.
      * CASE: LCL.EDI 824 Err Disposition U is Accepted
      * Force New Line.
     C                   IF        YL0021 = 'A'
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(025):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0018:ZQ     YL0025                         Email Message 2
     C                   END                                                    *FI
      * Format Email Message 'Attention' Line.
      * CASE: *OTHERWISE
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(026):ZQ   YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    @CN(026):ZQ   YL0025                         Email Message 2
      * Force New Line.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    @CN(027):ZQ   YL0025                         Email Message 2
      * 4/14/23 DN-Commented Out. Read thru DB1 Records & Build Instead.
      * Force New Line. - For DB1 Record.
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WJDNU1:ZQ     YL0028                 90      EDI 824 Error T
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * Set Error Type Code Text.
      * CASE: LCL.EDI 824 Error Type U is Fatal
     C                   IF        YL0028 = 'F'
     C                   EVAL      YL0029 = ' '                                 EDI 824 Error T
     C                   MOVEL     'FATAL'       YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: LCL.EDI 824 Error Type U is Verify
     C                   IF        YL0028 = 'V'
     C                   MOVEL     @CN(028)      YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: LCL.EDI 824 Error Type U is Compliance
     C                   IF        YL0028 = 'C'
     C                   MOVEL     @CN(029)      YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     @CN(030)      YL0029                         EDI 824 Error T
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '(':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     0             ZQ
     C     YL0025        CAT(P)    WJKHAA:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    '-':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    YL0029:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    ')':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     56            YRSW00
     C                   Z-ADD     5             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WJDNU1:ZQ     YL0030                 90      EDI 824 Error D
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0030:ZQ     YL0025                         Email Message 2
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Format Email Message Additional 'Attention' Lines if Exist.
      * CASE: LCL.Count Records        USR is NE 1
      * Force New Line.
     C                   IF        YL0022 <> 1
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '&N':ZQ       YL0025                         Email Message 2
     C                   Z-ADD     1             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WJDNU1:ZQ     YL0028                 90      EDI 824 Error T
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * Set Error Type Code Text.
      * CASE: LCL.EDI 824 Error Type U is Fatal
     C                   IF        YL0028 = 'F'
     C                   EVAL      YL0029 = ' '                                 EDI 824 Error T
     C                   MOVEL     'FATAL'       YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: LCL.EDI 824 Error Type U is Verify
     C                   IF        YL0028 = 'V'
     C                   MOVEL     @CN(028)      YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: LCL.EDI 824 Error Type U is Compliance
     C                   IF        YL0028 = 'C'
     C                   MOVEL     @CN(029)      YL0029                         EDI 824 Error T
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     @CN(030)      YL0029                         EDI 824 Error T
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    '(':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     0             ZQ
     C     YL0025        CAT(P)    WJKHAA:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    '-':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    YL0029:ZQ     YL0025                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0025        CAT(P)    ')':ZQ        YL0025                         Email Message 2
     C                   Z-ADD     56            YRSW00
     C                   Z-ADD     5             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WJDNU1:ZQ     YL0030                 90      EDI 824 Error D
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     1             ZQ
     C     YL0025        CAT(P)    YL0030:ZQ     YL0025                         Email Message 2
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSK         READE     @EZREYD                                90    *
     C                   ENDDO
      * USER: Exit processing
      * OK to Send Email?
      * CASE: PAR.Send Email USR is Yes
      * Exc ESNDMAIL Generic2 CL - /UT User Programs  * 
     C                   IF        YL0015 = 'Y'
     C                   CALL      'PUX2UPC'                            90      Exc ESNDMAIL Ge
     C                   PARM      YL0001        WQ0007                         Email Address
     C                   PARM      YL0024        WQ0008                         Email Subject 2
     C                   PARM      YL0025        WQ0009                         Email Message 2
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUX2UPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLRVGN        BEGSR
      *================================================================
      * Rtv AES ITN #         RT - EDI Applic Advice    Dtl  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0007 = ' '                                 OTI03-Ref ID TE
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSL         KLIST
     C                   KFLD                    WQSL01                         ST02-TRANS SET
     C                   KFLD                    WQSL02                         OTI02-Ref ID Qu
      * Setup key
     C                   Z-ADD     WL0005        WQSL01                         ST02-TRANS SET
     C                   MOVEL     WL0006        WQSL02                         OTI02-Ref ID Qu
      * Establish starting position
     C     KRSSL         SETLL     @P037LW                                      *
     C     KRSSL         READE     @P037LW                                90    *
      * Data record not found
     C   90              MOVEL     'USR4078'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WKS4U1        WL0007                         OTI03-Ref ID TE
     C     KRSSL         READE     @P037LW                                90    *
     C                   ENDDO
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   SMRVGN        BEGSR
      *================================================================
      * Rtv Error Disposition RT - EDI Applic Advice    Err  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0019 = ' '                                 TED01-Applic Er
     C                   EVAL      YL0020 = ' '                                 TED01-Err Descr
     C                   EVAL      YL0021 = ' '                                 EDI 824 Err Dis
     C                   Z-ADD     *ZERO         YL0022                         Count Records
     C                   Z-ADD     *ZERO         YL0022                         Count Records
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSM         KLIST
     C                   KFLD                    WQSM01                         ST02-TRANS SET
      * Setup key
     C                   Z-ADD     WAHRNZ        WQSM01                         ST02-TRANS SET
      * Establish starting position
     C     KRSSM         SETLL     @P038LV                                      *
     C     KRSSM         READE     @P038LV                                90    *
      * Data record not found
     C   90              MOVEL     'USR4088'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   ADD       1             YL0022                         Count Records
      * CASE: DB1.OTI02-Ref ID Qualifier is ES1 (For ITN)
      * PAR = DB1 By name
     C                   IF        WCA5AB = 'ES1'
     C                   MOVEL     WCKHAA        YL0019                         TED01-Applic Er
     C                   MOVEL     WCDNU1        YL0020                         TED01-Err Descr
     C                   Z-ADD     1             YRSW00
     C                   Z-ADD     3             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WCDNU1:ZQ     YL0021                 90      EDI 824 Err Dis
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   END                                                    *FI
     C     KRSSM         READE     @P038LV                                90    *
     C                   ENDDO
      *================================================================
     CSR   SMEXIT        ENDSR
      /EJECT
     CSR   SNRVGN        BEGSR
      *================================================================
      * Upd 824 Received Sts  RT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSN         KLIST
     C                   KFLD                    WQSN01                         BA105-Shipment
     C                   KFLD                    WQSN02                         EDI-Record Proc
      * Setup key
     C                   Z-ADD     WARMNB        WQSN01                         BA105-Shipment
     C                   MOVEL     'Y'           WQSN02                         EDI-Record Proc
      * Establish starting position
     C     KRSSN         SETLL     @P136LU                                      *
     C     KRSSN         READE     @P136LU                                90    *
      * Data record not found
     C   90              MOVEL     'USR5267'     W0RTN
      * USER: Process Data record
      * Update to 'Received' Status.
      * CASE: DB1.EDI 824 Received Sts is No
     C                   DOW       NOT *IN90
      * Chg 824 Received Sts  CH - EDI Export Shpmnt Inf HDR  * 
     C                   IF        WLN8SC = 'N'
     C                   EXSR      SOCHRC
     C                   END                                                    *FI
     C     KRSSN         READE     @P136LU                                90    *
     C                   ENDDO
      *================================================================
     CSR   SNEXIT        ENDSR
      /EJECT
     CSR   SOCHRC        BEGSR
      *================================================================
      * Chg 824 Received Sts  CH - EDI Export Shpmnt Inf HDR  * 
      *================================================================
      *
     C                   EVAL      WN0015 = ' '                                 EDI-Record Proc
     C                   EVAL      WN0016 = ' '                                 TRADE PARTNER C
     C                   EVAL      WN0017 = ' '                                 BA101-Related C
     C                   EVAL      WN0018 = ' '                                 BA102-Action Co
     C                   EVAL      WN0019 = ' '                                 BA103-Transport
     C                   EVAL      WN0020 = ' '                                 BA104-Country C
     C                   Z-ADD     *ZERO         WN0021                         BA105-Shipment
     C                   EVAL      WN0022 = ' '                                 BA108-Ship From
     C                   EVAL      WN0023 = ' '                                 BA109-IRS Ident
     C                   EVAL      WN0024 = ' '                                 BA110-SCAC
     C                   EVAL      WN0025 = ' '                                 BA112-Vessel Na
     C                   EVAL      WN0026 = ' '                                 YNQ01-Type of F
     C                   Z-ADD     *ZERO         WN0027                         DTM02-Sail Date
     C                   EVAL      WN0028 = ' '                                 PS03-Port of Ex
     C                   EVAL      WN0029 = ' '                                 P503-Port of Un
     C                   EVAL      WN0030 = ' '                                 REF02-Ref ITN
     C                   EVAL      WN0031 = ' '                                 M1201-Customs E
     C                   EVAL      WN0032 = ' '                                 M1202-Customs E
     C                   EVAL      WN0033 = ' '                                 M1203-Location
     C                   EVAL      WN0034 = ' '                                 M1204-Foreign P
     C                   EVAL      WN0035 = ' '                                 EDI ESIH-Unused
     C                   EVAL      WN0036 = ' '                                 ESIH OHE Bookin
     C                   EVAL      WN0037 = ' '                                 EDI ESIH-Unused
     C                   Z-ADD     *ZERO         WN0038                         Create Date D8#
     C                   Z-ADD     *ZERO         WN0039                         Create Time
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @COCPKT
     C                   Z-ADD     WLTSCN        WMTSCN                         ST02-TRANS SET
      *
     C     KLCHSO        KLIST
     C                   KFLD                    WMTSCN                         ST02-TRANS SET
     C     KLCHSO        CHAIN     @COCPKT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP136L0'    MDACP
     C                   MOVEL     '@COCPKT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SOEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SOEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP11        YBRDCS
      * Move non-key fields to @COCPKT
     C                   MOVEL(P)  'Y'           WMN8SC                         EDI 824 Receive
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP11 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @COCPKT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP136L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SOEXIT        ENDSR
      /EJECT
     CSR   SPRVGN        BEGSR
      *================================================================
      * Upd Pending EDI 601 RcdRT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSP         KLIST
     C                   KFLD                    WQSP01                         BA105-Shipment
     C                   KFLD                    WQSP02                         EDI-Record Proc
      * Setup key
     C                   Z-ADD     WARMNB        WQSP01                         BA105-Shipment
     C                   MOVEL     'P'           WQSP02                         EDI-Record Proc
      * Establish starting position
     C     KRSSP         SETLL     @P136LU                                      *
     C     KRSSP         READE     @P136LU                                90    *
      * Data record not found
     C   90              MOVEL     'USR5267'     W0RTN
      * USER: Process Data record
      * Update 'Pending' 601 Records.
      * CASE: PAR.First Time Through USR is Yes
     C                   DOW       NOT *IN90
     C                   IF        YL0035 = 'Y'
     C                   MOVEL     'N'           YL0035                         First Time Thro
      * GoAnywhere will process this record now.
      * Update 'BA102-Action Code' if Need To.
      * CASE: PAR.Upd BA102-Action Code USR is Yes
      * ITN# Received, Update to 'RX' (Change) if '1' (New).
      * CASE: DB1.BA102-Action Code is Add/New
     C                   IF        YL0032 = 'Y'
      * Chg Pending EDI 601 RcdCH - EDI Export Shpmnt Inf HDR  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WLA9AB = '1'
     C                   Z-ADD     WLTSCN        WL0008                         ST02-TRANS SET
     C                   MOVEL(P)  'N'           WL0009                         EDI-Record Proc
     C                   MOVEL(P)  'RX'          WL0010                         BA102-Action Co
     C                   EXSR      SQCHRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WLTSCN        WL0011                         ST02-TRANS SET
     C                   MOVEL(P)  'N'           WL0012                         EDI-Record Proc
     C                   EXSR      SRCHRC
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WLTSCN        WL0011                         ST02-TRANS SET
     C                   MOVEL(P)  'N'           WL0012                         EDI-Record Proc
     C                   EXSR      SRCHRC
     C                   END                                                    *FI
      * Reset OHE EDI 824 Action to 'Blank' to Reprocess.
      * Upd OHE EDI 824 Action XF - Order Header Extension  * 
     C                   CALL      'PUXXXFR'                            90      Upd OHE EDI 824
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WLHDNZ        WQ0023                         Load ID
     C                   PARM      YL0036        WQ0024                         OHE Booking Num
     C                   PARM      *BLANK        WQ0025                         EDI-Record Proc
     C                   PARM      '8'           WQ0026                         Update OHE EDI
     C                   PARM      *BLANK        WQ0027                         OHE EDI 824 AES
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUXXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
      * GoAnywhere will NOT process these records.
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * Cancel
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WLTSCN        WL0011                         ST02-TRANS SET
     C                   MOVEL(P)  'X'           WL0012                         EDI-Record Proc
     C                   EXSR      SRCHRC
     C                   END                                                    *FI
     C     KRSSP         READE     @P136LU                                90    *
     C                   ENDDO
      *================================================================
     CSR   SPEXIT        ENDSR
      /EJECT
     CSR   SQCHRC        BEGSR
      *================================================================
      * Chg Pending EDI 601 RcdCH - EDI Export Shpmnt Inf HDR  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   EVAL      WN0040 = ' '                                 TRADE PARTNER C
     C                   EVAL      WN0041 = ' '                                 BA101-Related C
     C                   EVAL      WN0042 = ' '                                 BA103-Transport
     C                   EVAL      WN0043 = ' '                                 BA104-Country C
     C                   Z-ADD     *ZERO         WN0044                         BA105-Shipment
     C                   EVAL      WN0045 = ' '                                 BA108-Ship From
     C                   EVAL      WN0046 = ' '                                 BA109-IRS Ident
     C                   EVAL      WN0047 = ' '                                 BA110-SCAC
     C                   EVAL      WN0048 = ' '                                 BA112-Vessel Na
     C                   EVAL      WN0049 = ' '                                 YNQ01-Type of F
     C                   Z-ADD     *ZERO         WN0050                         DTM02-Sail Date
     C                   EVAL      WN0051 = ' '                                 PS03-Port of Ex
     C                   EVAL      WN0052 = ' '                                 P503-Port of Un
     C                   EVAL      WN0053 = ' '                                 REF02-Ref ITN
     C                   EVAL      WN0054 = ' '                                 M1201-Customs E
     C                   EVAL      WN0055 = ' '                                 M1202-Customs E
     C                   EVAL      WN0056 = ' '                                 M1203-Location
     C                   EVAL      WN0057 = ' '                                 M1204-Foreign P
     C                   EVAL      WN0058 = ' '                                 EDI ESIH-Unused
     C                   EVAL      WN0059 = ' '                                 ESIH OHE Bookin
     C                   EVAL      WN0060 = ' '                                 EDI ESIH-Unused
     C                   Z-ADD     *ZERO         WN0061                         Create Date D8#
     C                   Z-ADD     *ZERO         WN0062                         Create Time
     C                   EVAL      WN0063 = ' '                                 EDI 824 Receive
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YCRDC = ' '
      *
      * Move key fields to @COCPKT
     C                   Z-ADD     WL0008        WMTSCN                         ST02-TRANS SET
      *
     C     KLCHSQ        KLIST
     C                   KFLD                    WMTSCN                         ST02-TRANS SET
     C     KLCHSQ        CHAIN     @COCPKT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP136L0'    MDACP
     C                   MOVEL     '@COCPKT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SQEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SQEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP11        YCRDCS
      * Move non-key fields to @COCPKT
     C                   MOVEL(P)  WL0009        WMA0ST                         EDI-Record Proc
     C                   MOVEL(P)  WL0010        WMA9AB                         BA102-Action Co
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP11 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YCRDC = 'Y'
     C                   UPDATE    @COCPKT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP136L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SQEXIT        ENDSR
      /EJECT
     CSR   SRCHRC        BEGSR
      *================================================================
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   EVAL      WN0064 = ' '                                 TRADE PARTNER C
     C                   EVAL      WN0065 = ' '                                 BA101-Related C
     C                   EVAL      WN0066 = ' '                                 BA102-Action Co
     C                   EVAL      WN0067 = ' '                                 BA103-Transport
     C                   EVAL      WN0068 = ' '                                 BA104-Country C
     C                   Z-ADD     *ZERO         WN0069                         BA105-Shipment
     C                   EVAL      WN0070 = ' '                                 BA108-Ship From
     C                   EVAL      WN0071 = ' '                                 BA109-IRS Ident
     C                   EVAL      WN0072 = ' '                                 BA110-SCAC
     C                   EVAL      WN0073 = ' '                                 BA112-Vessel Na
     C                   EVAL      WN0074 = ' '                                 YNQ01-Type of F
     C                   Z-ADD     *ZERO         WN0075                         DTM02-Sail Date
     C                   EVAL      WN0076 = ' '                                 PS03-Port of Ex
     C                   EVAL      WN0077 = ' '                                 P503-Port of Un
     C                   EVAL      WN0078 = ' '                                 REF02-Ref ITN
     C                   EVAL      WN0079 = ' '                                 M1201-Customs E
     C                   EVAL      WN0080 = ' '                                 M1202-Customs E
     C                   EVAL      WN0081 = ' '                                 M1203-Location
     C                   EVAL      WN0082 = ' '                                 M1204-Foreign P
     C                   EVAL      WN0083 = ' '                                 EDI ESIH-Unused
     C                   EVAL      WN0084 = ' '                                 ESIH OHE Bookin
     C                   EVAL      WN0085 = ' '                                 EDI ESIH-Unused
     C                   Z-ADD     *ZERO         WN0086                         Create Date D8#
     C                   Z-ADD     *ZERO         WN0087                         Create Time
     C                   EVAL      WN0088 = ' '                                 EDI 824 Receive
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YDRDC = ' '
      *
      * Move key fields to @COCPKT
     C                   Z-ADD     WL0011        WMTSCN                         ST02-TRANS SET
      *
     C     KLCHSR        KLIST
     C                   KFLD                    WMTSCN                         ST02-TRANS SET
     C     KLCHSR        CHAIN     @COCPKT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP136L0'    MDACP
     C                   MOVEL     '@COCPKT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL004.
     C                   MOVEL     'LBL004'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP11        YDRDCS
      * Move non-key fields to @COCPKT
     C                   MOVEL(P)  WL0012        WMA0ST                         EDI-Record Proc
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP11 <> YDRDCS AND
     C                             YDRDC <> 'N'
     C                   MOVE      'Y'           YDRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YDRDC = 'Y'
     C                   UPDATE    @COCPKT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP136L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SREXIT        ENDSR
      /EJECT
     CSR   SSRVGN        BEGSR
      *================================================================
      * Upd Pending EDI 601 CanRT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSS         KLIST
     C                   KFLD                    WQSS01                         BA105-Shipment
     C                   KFLD                    WQSS02                         EDI-Record Proc
      * Setup key
     C                   Z-ADD     WARMNB        WQSS01                         BA105-Shipment
     C                   MOVEL     'P'           WQSS02                         EDI-Record Proc
      * Establish starting position
     C     KRSSS         SETLL     @P136LU                                      *
     C     KRSSS         READE     @P136LU                                90    *
      * Data record not found
     C   90              MOVEL     'USR5267'     W0RTN
      * USER: Process Data record
      * GoAnywhere will NOT process these records.
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * Cancel
      * Move input parameters to subroutine local variables.
     C                   DOW       NOT *IN90
     C                   Z-ADD     WLTSCN        WL0011                         ST02-TRANS SET
     C                   MOVEL(P)  'X'           WL0012                         EDI-Record Proc
     C                   EXSR      SRCHRC
     C     KRSSS         READE     @P136LU                                90    *
     C                   ENDDO
      *================================================================
     CSR   SSEXIT        ENDSR
      /EJECT
     CSR   STRVGN        BEGSR
      *================================================================
      * Upd Pending EDI 601 NP RT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSST         KLIST
     C                   KFLD                    WQST01                         BA105-Shipment
     C                   KFLD                    WQST02                         EDI-Record Proc
      * Setup key
     C                   Z-ADD     YL0033        WQST01                         BA105-Shipment
     C                   MOVEL     'P'           WQST02                         EDI-Record Proc
      * Establish starting position
     C     KRSST         SETLL     @P136LU                                      *
     C     KRSST         READE     @P136LU                                90    *
      * Data record not found
     C   90              MOVEL     'USR5267'     W0RTN
      * USER: Process Data record
      * Chg Pending EDI 601 RcdCH - EDI Export Shpmnt Inf HDR  * 
      * Move input parameters to subroutine local variables.
     C                   DOW       NOT *IN90
     C                   Z-ADD     WLTSCN        WL0008                         ST02-TRANS SET
     C                   MOVEL(P)  'N'           WL0009                         EDI-Record Proc
     C                   MOVEL(P)  '1'           WL0010                         BA102-Action Co
     C                   EXSR      SQCHRC
     C     KRSST         READE     @P136LU                                90    *
     C                   ENDDO
      *================================================================
     CSR   STEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAHRNZ                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WAVODT                         BGN03-Reference
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBM8NB                         System Value Nu
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCHRNZ                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WCDXNB                         Sequence Number
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDRMNB                         Load ID
     C                   Z-ADD     *ZERO         WDAIC3                         Company Number
     C                   Z-ADD     *ZERO         WDAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WDRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WDRPNB                         Total Load Orde
     C                   Z-ADD     *ZERO         WDFLAM                         Flat Amount
     C                   Z-ADD     *ZERO         WDRRNB                         Total Stops
     C                   Z-ADD     *ZERO         WDSBNB                         BOL Time
     C                   Z-ADD     *ZERO         WDSQNB                         Ld Hdr_Ld Dtl U
     C                   Z-ADD     *ZERO         WDR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WDSDNB                         Number Pallets
     C                   Z-ADD     *ZERO         WDPAOU                         Number Pallets
     C                   Z-ADD     *ZERO         WDDGWG                         Load Carrier Pa
     C                   Z-ADD     *ZERO         WDSXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         WDHADT                         Actual Arrival
     C                   Z-ADD     *ZERO         WDAART                         Actual Arrival
     C                   Z-ADD     *ZERO         WDDHWG                         Trailer IN Weig
     C                   Z-ADD     *ZERO         WDDIWG                         Trailer OUT Wei
     C                   Z-ADD     *ZERO         WDAQDT                         Actual Departur
     C                   Z-ADD     *ZERO         WDS6NB                         Departure Time
     C                   Z-ADD     *ZERO         WDT4NB                         Schedule Sequen
     C                   Z-ADD     *ZERO         WDPRTM                         Product Tempera
     C                   Z-ADD     *ZERO         WDNPSV                         Number Spacers
     C                   Z-ADD     *ZERO         WDTLMI                         Total Load Mile
     C                   Z-ADD     *ZERO         WDGRWE                         Gross Weight
     C                   Z-ADD     *ZERO         WDF9DT                         Actual Ship Dat
     C                   Z-ADD     *ZERO         WDJ4DT                         Truck Ready Dat
     C                   Z-ADD     *ZERO         WDTRTM                         Truck Ready Tim
     C                   Z-ADD     *ZERO         WDJ5DT                         Spotted Date
     C                   Z-ADD     *ZERO         WDSPTM                         Spotted Time
     C                   Z-ADD     *ZERO         WDJ6DT                         Load Finished D
     C                   Z-ADD     *ZERO         WDLFTM                         Load Finished T
     C                   Z-ADD     *ZERO         WDJ7DT                         BOL Complete Da
     C                   Z-ADD     *ZERO         WDBOTM                         BOL Complete Ti
     C                   Z-ADD     *ZERO         WDJ8DT                         BOL Received Da
     C                   Z-ADD     *ZERO         WDBLTM                         BOL Received Ti
     C                   Z-ADD     *ZERO         WDKIDT                         Truck Departure
     C                   Z-ADD     *ZERO         WDASTM                         Truck Departure
     C                   Z-ADD     *ZERO         WDKADT                         Adjusted Depart
     C                   Z-ADD     *ZERO         WDAJCM                         Adjusted Depart
     C                   Z-ADD     *ZERO         WDVOAG                         Voyage
     C                   Z-ADD     *ZERO         WDKBDT                         Sail Date
     C                   Z-ADD     *ZERO         WDEFDT                         Arrival Date
     C                   Z-ADD     *ZERO         WDKCDT                         Date In
     C                   Z-ADD     *ZERO         WDTMIN                         Time In
     C                   Z-ADD     *ZERO         WDKDDT                         Date Out
     C                   Z-ADD     *ZERO         WDVMNB                         Time Out
     C                   Z-ADD     *ZERO         WDOCFR                         Load Total Frei
     C                   Z-ADD     *ZERO         WDKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WDATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WDBRBK                         Bring Back Mile
     C                   Z-ADD     *ZERO         WDEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WDKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         WDAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         WDKZDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WDAXTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WDLLDT                         Express Mail Da
     C                   Z-ADD     *ZERO         WDK0DT                         Product Complet
     C                   Z-ADD     *ZERO         WDAYTM                         Product Complet
     C                   Z-ADD     *ZERO         WDKNNX                         Pallets Loaded
     C                   Z-ADD     *ZERO         WDICWG                         Avg Pallet Tare
     C                   Z-ADD     *ZERO         WDIDWG                         Tot Pallet Tare
     C                   Z-ADD     *ZERO         WDK1DT                         Load Confirmati
     C                   Z-ADD     *ZERO         WDAZTM                         Load Door 1
     C                   Z-ADD     *ZERO         WDK2DT                         Override Total
     C                   Z-ADD     *ZERO         WDA0TM                         Load Door 2
     C                   Z-ADD     *ZERO         WDZBVA                         Load Actual Fre
     C                   Z-ADD     *ZERO         WDPYDT                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WDCKTM                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WDPZDT                         LH Last Combo P
     C                   Z-ADD     *ZERO         WDCLTM                         LH Last Combo P
     C                   Z-ADD     *ZERO         WDP0DT                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WDCMTM                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WDP1DT                         TPM Planned Shi
     C                   Z-ADD     *ZERO         WDCNTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WDP2DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WDCOTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WDP3DT                         LH Unused Date
     C                   Z-ADD     *ZERO         WDCQTM                         LH Unused Time
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEC4NB                         Order Number
     C                   Z-ADD     *ZERO         WEANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WEB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WEA0DT                         Order Date
     C                   Z-ADD     *ZERO         WEA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WEGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WEACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WEAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WECXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WEJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WEA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WEEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WEAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WERMNB                         Load ID
     C                   Z-ADD     *ZERO         WETBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WER1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WERNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WEATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WERSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WET3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WECONB                         Invoice Number
     C                   Z-ADD     *ZERO         WEAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WEVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WEB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WENODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WENPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WENQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WENRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WENSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WEBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WEBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WEBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WEBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WEBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WEH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WEH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WEH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WEH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WEH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WEC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFAIC3                         Company Number
     C                   Z-ADD     *ZERO         WFC4NB                         Order Number
     C                   Z-ADD     *ZERO         WFRMNB                         Load ID
     C                   Z-ADD     *ZERO         WFRUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WFQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WFQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WFQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WFGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WFHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WFHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WFQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WFQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WFQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WFQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WFITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WFQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WFQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WFQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WFP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WFQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WFQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WFQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WFQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WFQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WFQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WFQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WFQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WFQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WFW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WFW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WFAATM                         Job Time
     C                   Z-ADD     *ZERO         WFAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WIMJDT                         Create Date
     C                   Z-ADD     *ZERO         WIBETM                         Create Time
     C                   Z-ADD     *ZERO         WIMKDT                         Change Date
     C                   Z-ADD     *ZERO         WIBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WKHRNZ                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WKNQNY                         OTI08-Org Grp C
     C                   Z-ADD     *ZERO         WKNRNY                         OTI09-Org Tran
     C                   Z-ADD     *ZERO         WKNSNY                         OTI10-Org Trans
     C                   Z-ADD     *ZERO         WKVPDT                         DTM02-DATE
     C                   Z-ADD     *ZERO         WKMIVL                         AMT02-Extended
     C                   Z-ADD     *ZERO         WKMZVL                         QTY02-Quantity
     C                   Z-ADD     *ZERO         WKHGNZ                         EDI AAD Unused
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WLTSCN                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WLHDNZ                         BA105-Shipment
     C                   Z-ADD     *ZERO         WLB7DX                         DTM02-Sail Date
     C                   Z-ADD     *ZERO         WLCADX                         Create Date D8#
     C                   Z-ADD     *ZERO         WLBETM                         Create Time
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SGRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   EVAL      WL0002 = ' '
      * Define local variables for subroutine SHCHRC.
     C                   Z-ADD     *ZERO         WL0003
     C                   EVAL      WL0004 = ' '
      * Define local variables for subroutine SLRVGN.
     C                   Z-ADD     *ZERO         WL0005
     C                   EVAL      WL0006 = ' '
     C                   EVAL      WL0007 = ' '
      * Define local variables for subroutine SQCHRC.
     C                   Z-ADD     *ZERO         WL0008
     C                   EVAL      WL0009 = ' '
     C                   EVAL      WL0010 = ' '
      * Define local variables for subroutine SRCHRC.
     C                   Z-ADD     *ZERO         WL0011
     C                   EVAL      WL0012 = ' '
      * Define local work field Email Address
     C                   EVAL      YL0001 = ' '
      * Define local work field Library List Code
     C                   EVAL      YL0002 = ' '
      * Define null work field @Library List Code
     C                   EVAL      YN0001 = ' '
      * Define local work field Cancelled Flag USR
     C                   EVAL      YL0003 = ' '
      * Define local work field Process EDI 824 USR
     C                   EVAL      YL0004 = ' '
      * Define local work field Order Number
     C                   Z-ADD     *ZERO         YL0005
      * Define local work field Customer Purchase Order #
     C                   EVAL      YL0006 = ' '
      * Define local work field Load ID Alpha USR
     C                   EVAL      YL0007 = ' '
      * Define local work field Order Number Alpha
     C                   EVAL      YL0008 = ' '
      * Define local work field OHE Booking Number
     C                   EVAL      YL0009 = ' '
      * Define local work field Email Address USR
     C                   EVAL      YL0010 = ' '
      * Define local work field Email Subject 2 USR
     C                   EVAL      YL0011 = ' '
      * Define local work field Email Message 2 USR
     C                   EVAL      YL0012 = ' '
      * Define local work field Record Status
     C                   EVAL      YL0013 = ' '
      * Define local work field EDI-Record Processed
     C                   EVAL      YL0014 = ' '
      * Define local work field Send Email USR
     C                   EVAL      YL0015 = ' '
      * Define local work field Shipment Cancelled USR
     C                   EVAL      YL0016 = ' '
      * Define local work field First Time Through USR
     C                   EVAL      YL0017 = ' '
      * Define local work field OHE EDI 824 AES ITN #
     C                   EVAL      YL0018 = ' '
      * Define local work field TED01-Applic Err Cond Cde
     C                   EVAL      YL0019 = ' '
      * Define local work field TED01-Err Description
     C                   EVAL      YL0020 = ' '
      * Define local work field EDI 824 Err Disposition U
     C                   EVAL      YL0021 = ' '
      * Define local work field Count Records        USR
     C                   Z-ADD     *ZERO         YL0022
      * Define local work field Error Description USR
     C                   EVAL      YL0023 = ' '
      * Define local work field Email Subject 2 USR
     C                   EVAL      YL0024 = ' '
      * Define local work field Email Message 2 USR
     C                   EVAL      YL0025 = ' '
      * Define local work field System Date *USA USR
     C                   EVAL      YL0026 = ' '
      * Define local work field System Time *HMS USR
     C                   EVAL      YL0027 = ' '
      * Define local work field EDI 824 Error Type U
     C                   EVAL      YL0028 = ' '
      * Define local work field EDI 824 Error Type Code U
     C                   EVAL      YL0029 = ' '
      * Define local work field EDI 824 Error Desc USR
     C                   EVAL      YL0030 = ' '
      * Define local work field OHE EDI 824 AES ITN #
     C                   EVAL      YL0031 = ' '
      * Define local work field Upd BA102-Action Code USR
     C                   EVAL      YL0032 = ' '
      * Define local work field Load ID USR
     C                   Z-ADD     *ZERO         YL0033
      * Define local work field New LID added to order
     C                   EVAL      YL0034 = ' '
      * Define local work field First Time Through USR
     C                   EVAL      YL0035 = ' '
      * Define local work field OHE Booking Number
     C                   EVAL      YL0036 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 EDI824EXP
00002 DTALIB
00003 HISLIB
00004 edi_824_alert_IT_EDI
00005 EDI 824 Error-Load/Order/
00006 EDI 824 Application Advic
00007 e Error - Load ID is inva
00008 lid in ECP036 HDR record.
00009 PRKFLIB
00010 - TEST
00011 edi_824_alert_IT_EDI_Test
00012 Y2U0005
00013 edi_824_alert_IT_IBM
00014 e Error - EDI Interchange
00015 'APPADV' code not active.
00016   A SHIPMENT CANCELLED
00017 AES Direct Filing -
00018 We have received your cre
00019 ated filing submitted at
00020 Your request to the follo
00021 wing filing has been
00022 ACCEPTED.
00023 REJECTED.
00024 Shipment Reference Number
00025 AES ITN:
00026 -------------------------
00027 Attention:
00028 VERIFY
00029 COMPLIANCE
00030 NOTIFICATION
