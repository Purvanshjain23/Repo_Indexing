// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKK8XFR
// ?Date: 14.08.2025 Time: 02:52:02
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Number
//?Read the Tattoo header and create a record to the
//?tattoo defect file.
//?Then blank out the Tattoo header
EXECUTE FUNCTION(HPE106 Conversion RT) TYPE(RTVOBJ) FILE(PKA1CPP)               AB1200164;
{
 //?USER: Process Data record

 CASE;

 // IF DB1.DF Defect Code NE WRK.Blank Usr 1 fld Usr
 IF DB1.DF_Defect_Code <> WRK.Blank_Usr_1_fld_Usr;

 EXECUTE FUNCTION(Crt Tattoo Defect     CR) TYPE(CRTOBJ) FILE(PKDZREP)           AB1197898;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(DB1.DF_Defect_Code);
 PARAMETER(*ZERO);
 PARAMETER(DB1.HC_Class_Code);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Hog Defect Class  RT) TYPE(RTVOBJ) FILE(PKA7REP)           AB1286918;
  PARAMETER(DB1.DF_Defect_Code);
  PARAMETER(DB1.TDF_Classification_Defs);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

 EXECUTE FUNCTION(HPE106 Conversion Def  CH) TYPE(CHGOBJ) FILE(PKA1CPP)          AB1200215;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(*BLANK);
 ENDIF;

}


