// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POAJXFR
// ?Date: 14.08.2025 Time: 03:36:36
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Prc GAF Ship Order Dtl RT) TYPE(RTVOBJ) FILE(PONOCPP)          AC1579484;
{
 //?USER: Initialize routine

 // PAR.First Time Flag = CND.Yes
 PAR.First_Time_Flag = 'Y';

 //?USER: Process Data record

 //?Setup order break on first time flag
 CASE;

 // IF PAR.First Time Flag is Yes
 IF PAR.First_Time_Flag = 'Y';

 // PAR.GAF Order Number Numeric = DB1.GAF Order Number Numeric
 PAR.GAF_Order_Number_Numeric = DB1.GAF_Order_Number_Numeric;

 // PAR.GAF Error Code = CND.Blank
 PAR.GAF_Error_Code = *BLANK;

 // PAR.First Time Flag = CND.NO
 PAR.First_Time_Flag = 'N';

 ENDIF;

 //?Change history file on order break
 CASE;

 // IF PAR.GAF Order Number Numeric NE DB1.GAF Order Number Numeric
 IF PAR.GAF_Order_Number_Numeric <> DB1.GAF_Order_Number_Numeric;

 EXECUTE FUNCTION(Rtv Chg Error/Process  RT) TYPE(RTVOBJ) FILE(POACCPP)          AC1579517;
 PARAMETER(DB1.GAF_Customer_Number);
 PARAMETER(PAR.GAF_Order_Number_Numeric);
 PARAMETER('N');
 PARAMETER(PAR.GAF_Error_Code);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg Process/Error Cds  CH) TYPE(CHGOBJ) FILE(POACCPP)          AC1579519;
  PARAMETER(DB1.GAF_Customer_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.GAF_Ticket_Number);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.Production_Date);
  PARAMETER(PAR.GAF_Process_Code);
  PARAMETER(PAR.GAF_Error_Code);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

 }

 // PAR.GAF Order Number Numeric = DB1.GAF Order Number Numeric
 PAR.GAF_Order_Number_Numeric = DB1.GAF_Order_Number_Numeric;

 // PAR.GAF Error Code = CND.Blank
 PAR.GAF_Error_Code = *BLANK;

 ENDIF;

 EXECUTE FUNCTION(Val Cust Exists        RT) TYPE(RTVOBJ) FILE(POAEREP)          AC1579497;
 PARAMETER(PAR.Company_Number);
 PARAMETER(NLL.Warehouse_Code);
 PARAMETER(DB1.GAF_Customer_Number);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  CASE;

  // IF DB1.GAF Customer Number EQ PAR.GAF Customer Number
  IF DB1.GAF_Customer_Number = PAR.GAF_Customer_Number;

  MOVE *ALL (To: PAR From: DB1);

  ENDIF;

  QUIT;

 }

 //?If not a valid GAF Cust then Error
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // PAR.GAF Error Code = CND.Error
 PAR.GAF_Error_Code = 'E';

 ENDIF;

 EXECUTE FUNCTION(RTV Header Status      RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1231329;
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.GAF_Order_Number_Numeric);
 PARAMETER(PAR.Header_Status);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?If order is canceled, shipped, complete or not found then error
 CASE;

 // IF PAR.Header Status is Conf/Comp/Canc
 IF PAR.Header_Status = 'X'/'C'/'R';

 // OR PGM.*Return code is *Record does not exist
 OR PGM.*Return_code = 'Y2U0005';

 // PAR.GAF Error Code = CND.Error
 PAR.GAF_Error_Code = 'E';

 ENDIF;

 EXECUTE FUNCTION(Val Comp/Item Exists   RT) TYPE(RTVOBJ) FILE(CABZREP)          AC1563428;
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.GAF_Item_Code);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

 }

 //?If item does not exists then error
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // PAR.GAF Error Code = CND.Error
 PAR.GAF_Error_Code = 'E';

 ENDIF;

 //?Validate production date
 CASE;

 // IF DB1.GAF Production Date is Entered
 IF DB1.GAF_Production_Date <> *ZERO;

 EXECUTE FUNCTION(VAL Date               RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1418516;
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.GAF_Production_Date);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

 }

 //?If production date is invalid then error
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // PAR.GAF Error Code = CND.Error
 PAR.GAF_Error_Code = 'E';

 ENDIF;

 ENDIF;

 //?Validate actual ship date
 CASE;

 // IF DB1.GAF Actual Ship Date is Entered
 IF DB1.GAF_Actual_Ship_Date <> *ZERO;

 EXECUTE FUNCTION(VAL Date               RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1418516;
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.GAF_Actual_Ship_Date);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

 }

 //?If actual ship date is invalid then error
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // PAR.GAF Error Code = CND.Error
 PAR.GAF_Error_Code = 'E';

 ENDIF;

 //?Validate actual ship date
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.GAF Error Code = CND.Error
 PAR.GAF_Error_Code = 'E';

 ENDIF;

 EXECUTE FUNCTION(Val GAF Ship Order Dtl RT) TYPE(RTVOBJ) FILE(POACCPP)          AC1579516;
 PARAMETER(DB1.GAF_Customer_Number);
 PARAMETER(DB1.GAF_Order_Number_Numeric);
 PARAMETER(DB1.GAF_Ticket_Number);
 PARAMETER(DB1.GAF_Item_Code);
 PARAMETER(DB1.GAF_Production_Date);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

 }

 //?If order not already in history file create history record.
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 EXECUTE FUNCTION(Crt GAF Ship Order Dtl CR) TYPE(CRTOBJ) FILE(POACCPP)          AC1579513;
 PARAMETER(DB1.GAF_Customer_Number);
 PARAMETER(DB1.GAF_Order_Number_Numeric);
 PARAMETER(DB1.GAF_Ticket_Number);
 PARAMETER(DB1.GAF_Item_Code);
 PARAMETER(DB1.GAF_Production_Date);
 PARAMETER(DB1.GAF_Actual_Ship_Date);
 PARAMETER(DB1.GAF_Quantity_Shipped_Tot);
 PARAMETER(DB1.GAF_Weight_Shipped_Total);
 PARAMETER('N');
 PARAMETER(*BLANK);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 ENDIF;

 //?USER: Exit processing

 EXECUTE FUNCTION(Rtv Chg Error/Process  RT) TYPE(RTVOBJ) FILE(POACCPP)          AC1579517;
 PARAMETER(DB1.GAF_Customer_Number);
 PARAMETER(PAR.GAF_Order_Number_Numeric);
 PARAMETER('N');
 PARAMETER(PAR.GAF_Error_Code);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg Process/Error Cds  CH) TYPE(CHGOBJ) FILE(POACCPP)          AC1579519;
  PARAMETER(DB1.GAF_Customer_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.GAF_Ticket_Number);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.Production_Date);
  PARAMETER(PAR.GAF_Process_Code);
  PARAMETER(PAR.GAF_Error_Code);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

 }

}


