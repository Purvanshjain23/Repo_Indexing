     H/TITLE WW Cutout Matrix      DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 09/03/10  Time  : 11:06:17
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDA2DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Cutout Matrix      DF  Display file
      *
     FPDI0REL3IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : PS Cutout Matrix          Co/Desc/Mtx/MoDy
      *
     FPDI1REL1IF  E           K        DISK
      * RTV : PS Cutout Weight Range    Retrieval index
      *
     FPDIZREL1IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Retrieval index
      *
     FPDI4REL1IF  E           K        DISK
      * RTV : PS Cutout Item            Retrieval index
      *
     FPDJ0REL1IF  E           K        DISK
      * RTV : PS Cutout Dist Backfat    Retrieval index
      *
     FPDJ1REL1IF  E           K        DISK
      * RTV : PS Cutout Dist Loin-Eye   Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDI0REL0UF  E           K        DISK
      * UPD : PS Cutout Matrix          Update index
      *
     FPDI4REL0UF  E           K        DISK
      * UPD : PS Cutout Item            Update index
      *
     FPDIZREL0UF  E           K        DISK
      * UPD : PS Cutout Dist Lean %     Update index
      *
     FPDJ0REL0UF  E           K        DISK
      * UPD : PS Cutout Dist Backfat    Update index
      *
     FPDJ1REL0UF  E           K        DISK
      * UPD : PS Cutout Dist Loin-Eye   Update index
      *
     FPDI1REL0UF  E           K        DISK
      * UPD : PS Cutout Weight Range    Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 018  5 0A
     E                    W0END   7 018  5 0A
     E                    W0NAM   7 018 10
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@I0RES2
      * PS Cutout Matrix          Update index
      * Renamed input format fields
     I              I0AIC3                          WAAIC3
     I              I0RXCD                          WARXCD
     I              I0GHDT                          WAGHDT
     I              I0MXNA                          WAMXNA
     I              I0VTST                          WAVTST
     I              I0VUST                          WAVUST
     I              I0UVST                          WAUVST
     I              I0UWST                          WAUWST
     I              I0UXST                          WAUXST
     I              I0VSST                          WAVSST
     I              I0AATM                          WAAATM
     I              I0AYNA                          WAAYNA
     I              I0A0NA                          WAA0NA
     I              I0AXDT                          WAAXDT
      *
     I@I4RETW
      * PS Cutout Item            Update index
      * Renamed input format fields
     I              I4AIC3                          WBAIC3
     I              I4RXCD                          WBRXCD
     I              I4GHDT                          WBGHDT
     I              I4UPNB                          WBUPNB
     I              I4UQNB                          WBUQNB
     I              I4ULNB                          WBULNB
     I              I4HGCD                          WBHGCD
     I              I4UTNB                          WBUTNB
     I              I4XRCD                          WBXRCD
     I              I4UVST                          WBUVST
     I              I4UWST                          WBUWST
     I              I4UXST                          WBUXST
     I              I4VSST                          WBVSST
     I              I4AATM                          WBAATM
     I              I4AYNA                          WBAYNA
     I              I4A0NA                          WBA0NA
     I              I4AXDT                          WBAXDT
      *
     I@IZRETB
      * PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WCAIC3
     I              IZRXCD                          WCRXCD
     I              IZGHDT                          WCGHDT
     I              IZUPNB                          WCUPNB
     I              IZUQNB                          WCUQNB
     I              IZULNB                          WCULNB
     I              IZUNNB                          WCUNNB
     I              IZUONB                          WCUONB
     I              IZDIPC                          WCDIPC
     I              IZZ0NB                          WCZ0NB
     I              IZAVLE                          WCAVLE
     I              IZQPNX                          WCQPNX
     I              IZUVST                          WCUVST
     I              IZUWST                          WCUWST
     I              IZUXST                          WCUXST
     I              IZVSST                          WCVSST
     I              IZAATM                          WCAATM
     I              IZAYNA                          WCAYNA
     I              IZA0NA                          WCA0NA
     I              IZAXDT                          WCAXDT
      *
     I@J0RECG
      * PS Cutout Dist Backfat    Update index
      * Renamed input format fields
     I              J0AIC3                          WDAIC3
     I              J0RXCD                          WDRXCD
     I              J0GHDT                          WDGHDT
     I              J0UPNB                          WDUPNB
     I              J0UQNB                          WDUQNB
     I              J0BFIN                          WDBFIN
     I              J0UNNB                          WDUNNB
     I              J0UONB                          WDUONB
     I              J0DIPC                          WDDIPC
     I              J0Z0NB                          WDZ0NB
     I              J0AVLE                          WDAVLE
     I              J0QPNX                          WDQPNX
     I              J0UVST                          WDUVST
     I              J0UWST                          WDUWST
     I              J0UXST                          WDUXST
     I              J0VSST                          WDVSST
     I              J0AATM                          WDAATM
     I              J0AYNA                          WDAYNA
     I              J0A0NA                          WDA0NA
     I              J0AXDT                          WDAXDT
      *
     I@J1RECJ
      * PS Cutout Dist Loin-Eye   Update index
      * Renamed input format fields
     I              J1AIC3                          WEAIC3
     I              J1RXCD                          WERXCD
     I              J1GHDT                          WEGHDT
     I              J1UPNB                          WEUPNB
     I              J1UQNB                          WEUQNB
     I              J1LEDP                          WELEDP
     I              J1UVST                          WEUVST
     I              J1UWST                          WEUWST
     I              J1UXST                          WEUXST
     I              J1VSST                          WEVSST
     I              J1AATM                          WEAATM
     I              J1AYNA                          WEAYNA
     I              J1A0NA                          WEA0NA
     I              J1AXDT                          WEAXDT
      *
     I@I1RES5
      * PS Cutout Weight Range    Update index
      * Renamed input format fields
     I              I1AIC3                          WFAIC3
     I              I1RXCD                          WFRXCD
     I              I1GHDT                          WFGHDT
     I              I1UPNB                          WFUPNB
     I              I1UQNB                          WFUQNB
     I              I1VSNB                          WFVSNB
     I              I1VVNB                          WFVVNB
     I              I1DGPC                          WFDGPC
     I              I1V0NB                          WFV0NB
     I              I1UVST                          WFUVST
     I              I1UWST                          WFUWST
     I              I1UXST                          WFUXST
     I              I1VSST                          WFVSST
     I              I1AATM                          WFAATM
     I              I1AYNA                          WFAYNA
     I              I1A0NA                          WFA0NA
     I              I1AXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      * Outward parameters
     IPARC        DS                             11
      * KEY : PS Cutout Matrix          Retrieval index
      * I : MAP Company Number
     I                                    P   1   20PAAIC3
      * I : MAP Cutout Matrix Code
     I                                        3   8 PARXCD
      * I : MAP Effective Month/Day
     I                                    P   9  110PAGHDT
      *
      * Outward parameters
     IPBRC        DS                             19
      * KEY : PS Cutout Yield           Co/Mtx/Seq/Prml
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Cutout Matrix Code
     I                                        3   8 PBRXCD
      * I : RST Effective Month/Day
     I                                    P   9  110PBGHDT
      *
      * Outward parameters
     IPCRC        DS                             20
      * KEY : PS Cutout Blend           Retrieval index
      * I : RST Company Number
     I                                    P   1   20PCAIC3
      * I : RST Cutout Matrix Code
     I                                        3   8 PCRXCD
      * I : RST Effective Month/Day
     I                                    P   9  110PCGHDT
      *
     IQPDI01    E DSPDI0REL0
      * UPD : PS Cutout Matrix          Update index
      * Renamed input format fields
     I              I0AIC3                          WAAIC3
     I              I0RXCD                          WARXCD
     I              I0GHDT                          WAGHDT
     I              I0MXNA                          WAMXNA
     I              I0VTST                          WAVTST
     I              I0VUST                          WAVUST
     I              I0UVST                          WAUVST
     I              I0UWST                          WAUWST
     I              I0UXST                          WAUXST
     I              I0VSST                          WAVSST
     I              I0AATM                          WAAATM
     I              I0AYNA                          WAAYNA
     I              I0A0NA                          WAA0NA
     I              I0AXDT                          WAAXDT
      *
     IQPDI41    E DSPDI4REL0
      * UPD : PS Cutout Item            Update index
      * Renamed input format fields
     I              I4AIC3                          WBAIC3
     I              I4RXCD                          WBRXCD
     I              I4GHDT                          WBGHDT
     I              I4UPNB                          WBUPNB
     I              I4UQNB                          WBUQNB
     I              I4ULNB                          WBULNB
     I              I4HGCD                          WBHGCD
     I              I4UTNB                          WBUTNB
     I              I4XRCD                          WBXRCD
     I              I4UVST                          WBUVST
     I              I4UWST                          WBUWST
     I              I4UXST                          WBUXST
     I              I4VSST                          WBVSST
     I              I4AATM                          WBAATM
     I              I4AYNA                          WBAYNA
     I              I4A0NA                          WBA0NA
     I              I4AXDT                          WBAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDIZ1    E DSPDIZREL0
      * UPD : PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WCAIC3
     I              IZRXCD                          WCRXCD
     I              IZGHDT                          WCGHDT
     I              IZUPNB                          WCUPNB
     I              IZUQNB                          WCUQNB
     I              IZULNB                          WCULNB
     I              IZUNNB                          WCUNNB
     I              IZUONB                          WCUONB
     I              IZDIPC                          WCDIPC
     I              IZZ0NB                          WCZ0NB
     I              IZAVLE                          WCAVLE
     I              IZQPNX                          WCQPNX
     I              IZUVST                          WCUVST
     I              IZUWST                          WCUWST
     I              IZUXST                          WCUXST
     I              IZVSST                          WCVSST
     I              IZAATM                          WCAATM
     I              IZAYNA                          WCAYNA
     I              IZA0NA                          WCA0NA
     I              IZAXDT                          WCAXDT
      *
     IQPDJ01    E DSPDJ0REL0
      * UPD : PS Cutout Dist Backfat    Update index
      * Renamed input format fields
     I              J0AIC3                          WDAIC3
     I              J0RXCD                          WDRXCD
     I              J0GHDT                          WDGHDT
     I              J0UPNB                          WDUPNB
     I              J0UQNB                          WDUQNB
     I              J0BFIN                          WDBFIN
     I              J0UNNB                          WDUNNB
     I              J0UONB                          WDUONB
     I              J0DIPC                          WDDIPC
     I              J0Z0NB                          WDZ0NB
     I              J0AVLE                          WDAVLE
     I              J0QPNX                          WDQPNX
     I              J0UVST                          WDUVST
     I              J0UWST                          WDUWST
     I              J0UXST                          WDUXST
     I              J0VSST                          WDVSST
     I              J0AATM                          WDAATM
     I              J0AYNA                          WDAYNA
     I              J0A0NA                          WDA0NA
     I              J0AXDT                          WDAXDT
      *
     IQPDJ11    E DSPDJ1REL0
      * UPD : PS Cutout Dist Loin-Eye   Update index
      * Renamed input format fields
     I              J1AIC3                          WEAIC3
     I              J1RXCD                          WERXCD
     I              J1GHDT                          WEGHDT
     I              J1UPNB                          WEUPNB
     I              J1UQNB                          WEUQNB
     I              J1LEDP                          WELEDP
     I              J1UVST                          WEUVST
     I              J1UWST                          WEUWST
     I              J1UXST                          WEUXST
     I              J1VSST                          WEVSST
     I              J1AATM                          WEAATM
     I              J1AYNA                          WEAYNA
     I              J1A0NA                          WEA0NA
     I              J1AXDT                          WEAXDT
      *
     IQPDI11    E DSPDI1REL0
      * UPD : PS Cutout Weight Range    Update index
      * Renamed input format fields
     I              I1AIC3                          WFAIC3
     I              I1RXCD                          WFRXCD
     I              I1GHDT                          WFGHDT
     I              I1UPNB                          WFUPNB
     I              I1UQNB                          WFUQNB
     I              I1VSNB                          WFVSNB
     I              I1VVNB                          WFVVNB
     I              I1DGPC                          WFDGPC
     I              I1V0NB                          WFV0NB
     I              I1UVST                          WFUVST
     I              I1UWST                          WFUWST
     I              I1UXST                          WFUXST
     I              I1VSST                          WFVSST
     I              I1AATM                          WFAATM
     I              I1AYNA                          WFAYNA
     I              I1A0NA                          WFA0NA
     I              I1AXDT                          WFAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Record Found -PS CWR USR
     I                                        1   1 P1VXST
      * N :  Record Found -PS CD USR
     I                                        2   2 P1VYST
      * N :  Record Found -PS CI USR
     I                                        3   3 P1VZST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Company Number
     I                                    P   4   50P2AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P2DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P2DRCD
      * N :  Salesperson Code
     I                                       22  24 P2BCCD
      * N :  System Date Format
     I                                       25  27 P2B8NA
      * N :  User Profile Name
     I                                       28  37 P2AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P2I6ST
      * N :  Default Printer
     I                                       39  48 P2MPNA
      * N :  First Time Flag
     I                                       49  49 P2TAST
     IP3PARM      DS
      * FLD: Print Options
      * N :  PRT Description
     I                                        1  25 P3G3TX
      * N :  PRT Printer Device
     I                                       26  35 P3WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P3WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P3WTST
      * N :  PRT Number of Copies
     I                                       44  450P3DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P3WUST
      * N :  PRT Night Queue
     I                                       47  56 P3BVVN
     IP4PARM      DS
      * N :  Display Prt Opt Pmt USR
     I                                        1   4 P4XFST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'PS Prt Cutout Dist/Items'
      * PRT Printer Device
     I                                        1  10 ZA0001
      * PRT Hold Output Sts
     I                                       11  14 ZA0002
      * PRT Save Output Sts
     I                                       15  18 ZA0003
      * PRT Number of Copies
     I                                    P  19  200ZA0004
      * PRT Night Queue
     I                                       21  30 ZA0005
      * Program name USR
     I                                       31  40 ZA0006
      * Program Name$ USR
     I                                       41  50 ZA0007
      * Application Code
     I                                       51  56 ZA0008
      * Company Number
     I                                       57  59 ZA0009
      * Cutout Matrix Code
     I                                       60  65 ZA0010
      * Effective Month/Day
     I                                    P  66  680ZA0011
      * Job Name
     I                                       69  78 ZA0012
      * Message data for 'PS Prt Cutout Dist/Items'
      * PRT Printer Device
     I                                        1  10 ZA0013
      * PRT Hold Output Sts
     I                                       11  14 ZA0014
      * PRT Save Output Sts
     I                                       15  18 ZA0015
      * PRT Number of Copies
     I                                    P  19  200ZA0016
      * PRT Night Queue
     I                                       21  30 ZA0017
      * Program name USR
     I                                       31  40 ZA0018
      * Program Name$ USR
     I                                       41  50 ZA0019
      * Application Code
     I                                       51  56 ZA0020
      * Company Number
     I                                       57  59 ZA0021
      * Cutout Matrix Code
     I                                       60  65 ZA0022
      * Effective Month/Day
     I                                    P  66  680ZA0023
      * Job Name
     I                                       69  78 ZA0024
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0025
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0026
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0027
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0028
      * Application Code
     I                                       11  16 ZA0029
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0030
      * Application Code
     I                                       11  16 ZA0031
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: PAR.First Time Flag EQ WRK.BLANK
     C           P2TAST    IFEQ WUGSTX                     *IF
     C                     Z-ADDP2AIC3    #2AIC3           Company Number
     C                     MOVEL'N'       P2TAST           First Time Flag
     C                     MOVEL'A'       #2VSST           Record Status
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           I0AIC3           Company Number
     C                     KFLD           I0MXNA           Cutout Matrix D
     C                     KFLD           I0RXCD           Cutout Matrix C
     C                     KFLD           I0GHDT           Effective Month
      * Setup key
     C                     Z-ADD#2AIC3    I0AIC3
     C                     MOVEL#2MXNA    I0MXNA
     C                     MOVEL#2RXCD    I0RXCD
     C                     Z-ADD#2GHDT    I0GHDT
     C           KPOS      SETLL@I0RENO
     C                     READ @I0RENO                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2MXNA    WZMXNA
     C                     MOVEL#2MXNA    WZMXNA           Cutout Matrix D
     C           *LIKE     DEFN #2RXCD    WZRXCD
     C                     MOVEL#2RXCD    WZRXCD           Cutout Matrix C
     C           *LIKE     DEFN #2GHDT    WZGHDT
     C                     MOVEL#2GHDT    WZGHDT           Effective Month
     C           *LIKE     DEFN #2VTST    WZVTST
     C                     MOVEL#2VTST    WZVTST           Cutout Matrix T
     C           *LIKE     DEFN #2VUST    WZVUST
     C                     MOVEL#2VUST    WZVUST           Cutout Matrix D
     C           *LIKE     DEFN #2VSST    WZVSST
     C                     MOVEL#2VSST    WZVSST           Record Status
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2MXNA    WQMXNA           Cutout Matrix D
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 30        WQA5N   50
     C                     PARM #2MXNA    WQMXNA           Cutout Matrix D
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@I0RENO                  90*
     C  N82                READ @I0RENO                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,38
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2MXNA    IFNE *BLANK                     Cutout Matrix D
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           I0MXNA           Cutout Matrix D
      * Length
     C                     PARM 30        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQMXNA
      * Length
     C                     PARM 30        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2MXNA    OREQ *BLANK                     Cutout Matrix D
     C           #2RXCD    IFNE *BLANK                     Cutout Matrix C
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           I0RXCD           Cutout Matrix C
      * Length
     C                     PARM 6         WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           #2RXCD
      * Length
     C                     PARM 6         WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2MXNA    OREQ *BLANK                     Cutout Matrix D
     C           #2RXCD    OREQ *BLANK                     Cutout Matrix C
     C           #2GHDT    IFNE *ZERO                      Effective Month
     C           I0GHDT    CABNE#2GHDT    BB020            Effective Month
     C                     END
     C                     END
     C           #2VTST    IFNE *BLANK                     Cutout Matrix T
     C           I0VTST    CABNE#2VTST    BB020            Cutout Matrix T
     C                     END
     C           #2VUST    IFNE *BLANK                     Cutout Matrix D
     C           I0VUST    CABNE#2VUST    BB020            Cutout Matrix D
     C                     END
     C           #2VSST    IFNE *BLANK                     Record Status
     C           I0VSST    CABNE#2VSST    BB020            Record Status
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * If allow multi-company is no then select CTL Company only
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Allow Multi-Company is no
      *   |- c2    : DB1.Accounting Company Number NE CTL.Accounting Comp
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2I6ST    IFEQ 'N'                        *IF
     C           I0AIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Company Select
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Accounting Company Number is greater than zero
      *   |- c2    : DB1.Accounting Company Number NE CTL.Accounting Comp
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFGT *ZERO                      *IF
     C           I0AIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Cutout Matrix Code Select
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Cutout Matrix Code NE WRK.BLANK
      *   |- c2    : DB1.Cutout Matrix Code NE CTL.Cutout Matrix Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2RXCD    IFNE WUGSTX                     *IF
     C           I0RXCD    IFNE #2RXCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * RCD.Description = Condition name of RCD.Cutout Matrix Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255678   Y2LSNO  70       List number
     C                     PARM #1VTST    W0INVL 25        Cutout Matrix T
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RAUNA    PARM           W0CNNM 25        Description
      *
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @I0RENO                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Cutout Matrix Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2VTST'  IFEQ YPMTFD
      * Cutout Matrix Type
     C                     MOVEL#2VTST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFVTST
     C                     SELEC
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD1         ZFVTST
     C           W0INVL    WHEQ 'G'                        G
     C                     Z-ADD2         ZFVTST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD3         ZFVTST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD4         ZFVTST
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD5         ZFVTST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD6         ZFVTST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD7         ZFVTST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD8         ZFVTST
     C                     ENDSL
     C                     EXFMTZEVTST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFVTST    WHEQ 1
     C                     MOVEL'S'       W0INVL           S
     C           ZFVTST    WHEQ 2
     C                     MOVEL'G'       W0INVL           G
     C           ZFVTST    WHEQ 3
     C                     MOVEL'P'       W0INVL           P
     C           ZFVTST    WHEQ 4
     C                     MOVEL'T'       W0INVL           T
     C           ZFVTST    WHEQ 5
     C                     MOVEL'B'       W0INVL           B
     C           ZFVTST    WHEQ 6
     C                     MOVEL'F'       W0INVL           F
     C           ZFVTST    WHEQ 7
     C                     MOVEL'A'       W0INVL           A
     C           ZFVTST    WHEQ 8
     C                     MOVEL'C'       W0INVL           C
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2VTST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Cutout Matrix Default
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2VUST'  IFEQ YPMTFD
      * Cutout Matrix Default
     C                     MOVEL#2VUST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFVUST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZFVUST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFVUST
     C                     ENDSL
     C                     EXFMTZEVUST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFVUST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZFVUST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2VUST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Record Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2VSST'  IFEQ YPMTFD
      * Record Status
     C                     MOVEL#2VSST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFVSST
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZFVSST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD2         ZFVSST
     C                     ENDSL
     C                     EXFMTZEVSST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFVSST    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZFVSST    WHEQ 2
     C                     MOVEL'I'       W0INVL           I
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2VSST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZMXNA    CASNE#2MXNA    FBRQRL
     C           WZRXCD    CASNE#2RXCD    FBRQRL
     C           WZGHDT    CASNE#2GHDT    FBRQRL
     C           WZVTST    CASNE#2VTST    FBRQRL
     C           WZVUST    CASNE#2VUST    FBRQRL
     C           WZVSST    CASNE#2VSST    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Company Prompt
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Accounting Company Number
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
      * SEL Company by Number  SR - Company Name and Address  * 
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0001  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * Create Cutout Matrix
      * CASE: CTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * Edt Cutout Matrix     E1 - PS Cutout Matrix  * 
     C                     CLEARPARC
     C                     Z-ADD#2AIC3    PAAIC3           Company Number
     C                     MOVEL#2RXCD    PARXCD    P      Cutout Matrix C
     C                     Z-ADD#2GHDT    PAGHDT           Effective Month
      *
     C                     CALL 'PDA3E1R'              90  Edt Cutout Matr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: PS Cutout
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDA3E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     SETON                     34    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,38
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * 2=Edit Cutout Matrix
      * CASE: RCD.*SFLSEL is *Revise request
     C           #1SEL     IFEQ '2'                        *IF
      * Edt Cutout Matrix     E1 - PS Cutout Matrix  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     MOVEL#1RXCD    PARXCD    P      Cutout Matrix C
     C                     Z-ADD#1GHDT    PAGHDT           Effective Month
      *
     C                     CALL 'PDA3E1R'              90  Edt Cutout Matr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: PS Cutout
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDA3E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 3=Copy Cutout Matrix
      * CASE: RCD.*SFLSEL is *Copy request
     C           #1SEL     IFEQ '3'                        *IF
     C           #1SEL     OREQ ' 3'
      * Cpy Cutout Matrix     PV - PS Cutout Matrix  * 
     C                     CALL 'PDBSPVR'              90  Cpy Cutout Matr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0002  30       Company Number
     C                     PARM #1RXCD    WQ0003  6        Cutout Matrix C
     C                     PARM #1GHDT    WQ0004  40       Effective Month
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBSPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 4=Delete Cutout Matrix
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Send message 'PS CWR,CD,CI Will Be Dltd'
     C                     MOVEL'USR1734' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * 6/9=Print Options Prompt
      * CASE: Option 6 or 9
      *  - c1 OR c2
      *   |- c1    : RCD.*SFLSEL is *6
      *   |- c2    : RCD.*SFLSEL is 9
      *   '-
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ '9'                        *OR
      * CASE: PAR.Display Prt Opt Pmt USR is *YES
     C           P4XFST    IFEQ '*YES'                     *IF
      * PMT Print Option  SHR  PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,002   WQ0005 25        PRT Description
     C           P3WRST    PARM P3WRST    WQ0006 10        PRT Printer Dev
     C           P3WSST    PARM P3WSST    WQ0007  4        PRT Hold Output
     C           P3WTST    PARM P3WTST    WQ0008  4        PRT Save Output
     C           P3DYNB    PARM P3DYNB    WQ0009  20       PRT Number of C
     C           P3WUST    PARM P3WUST    WQ0010  1        PRT Night Queue
     C           P3BVVN    PARM P3BVVN    WQ0011 10        PRT Night Queue
     C                     PARM 'P/S'     WQ0012  6        Application Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL*BLANK    P4XFST           Display Prt Opt
     C                     MOVEL'*NO'     P4XFST           Display Prt Opt
     C                     END                             *FI
     C                     END                             *FI
      * 6=Print Distribution
      * CASE: RCD.*SFLSEL is *6
     C           #1SEL     IFEQ '6'                        *IF
      * Setup message data for message
     C                     MOVELP3WRST    ZA0001           PRT Printer Dev
     C                     MOVELP3WSST    ZA0002           PRT Hold Output
     C                     MOVELP3WTST    ZA0003           PRT Save Output
     C                     Z-ADDP3DYNB    ZA0004           PRT Number of C
     C                     MOVELP3BVVN    ZA0005           PRT Night Queue
     C                     MOVEL@CN,004   ZA0006           Program name US
     C                     MOVEL@CN,005   ZA0007           Program Name$ U
     C                     MOVEL'P/S'     ZA0008           Application Cod
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0009           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1RXCD    ZA0010           Cutout Matrix C
     C                     Z-ADD#1GHDT    ZA0011           Effective Month
     C                     MOVEL@CN,006   ZA0012           Job Name
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR1840' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     98    *
     C                     END
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 7=Edit Weight Ranges
      * CASE: RCD.*SFLSEL is Edit Opt7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * WW Cutout Wgt Ranges EF - PS Cutout Weight Range  * 
     C                     CALL 'PDBTEFR'              90  WW Cutout Wgt R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0013  30       Company Number
     C                     PARM #1RXCD    WQ0014  6        Cutout Matrix C
     C                     PARM #1GHDT    WQ0015  40       Effective Month
     C                     PARM #1MXNA    WQ0016 30        Cutout Matrix D
     C                     PARM #1VTST    WQ0017  1        Cutout Matrix T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBTEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 9=Print Matrix Items
      * CASE: RCD.*SFLSEL is 9
     C           #1SEL     IFEQ '9'                        *IF
      * Setup message data for message
     C                     MOVELP3WRST    ZA0013           PRT Printer Dev
     C                     MOVELP3WSST    ZA0014           PRT Hold Output
     C                     MOVELP3WTST    ZA0015           PRT Save Output
     C                     Z-ADDP3DYNB    ZA0016           PRT Number of C
     C                     MOVELP3BVVN    ZA0017           PRT Night Queue
     C                     MOVEL@CN,007   ZA0018           Program name US
     C                     MOVEL@CN,008   ZA0019           Program Name$ U
     C                     MOVEL'P/S'     ZA0020           Application Cod
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0021           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0021           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1RXCD    ZA0022           Cutout Matrix C
     C                     Z-ADD#1GHDT    ZA0023           Effective Month
     C                     MOVEL@CN,009   ZA0024           Job Name
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR1840' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     98    *
     C                     END
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 10=Edit Yields
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : RCD.Cutout Matrix Type is Formula (Lean %)
      *   |- c2    : RCD.Cutout Matrix Type is Blend
      *   |- c3    : RCD.Cutout Matrix Type is Formula (Backfat)
      *   |- c4    : RCD.Cutout Matrix Type is Blend (Backfat)
      *   '-
     C           #1VTST    IFEQ 'F'                        *IF
     C           #1VTST    OREQ 'B'                        *OR
     C           #1VTST    OREQ 'A'                        *OR
     C           #1VTST    OREQ 'C'                        *OR
      * Edt Cutout Yield      EF - PS Cutout Yield  * 
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     MOVEL#1RXCD    PBRXCD    P      Cutout Matrix C
     C                     Z-ADD#1GHDT    PBGHDT           Effective Month
      *
     C                     CALL 'POQ6EFR'              90  Edt Cutout Yiel
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: PS Cutout
     C                     PARM #1VTST    WQ0018  1        Cutout Matrix T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQ6EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0025           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 11=Edit Blend
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Cutout Matrix Type is Blend
      *   |- c2    : RCD.Cutout Matrix Type is Blend (Backfat)
      *   '-
     C           #1VTST    IFEQ 'B'                        *IF
     C           #1VTST    OREQ 'C'                        *OR
      * Edt Cutout Blend      EF - PS Cutout Blend  * 
     C                     CLEARPCRC
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     MOVEL#1RXCD    PCRXCD    P      Cutout Matrix C
     C                     Z-ADD#1GHDT    PCGHDT           Effective Month
      *
     C                     CALL 'PORDEFR'              90  Edt Cutout Blen
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: PS Cutout
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PORDEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0026           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 12=Build Cutout
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : RCD.Cutout Matrix Type is Formula (Lean %)
      *   |- c2    : RCD.Cutout Matrix Type is Blend (Lean %)
      *   |- c3    : RCD.Cutout Matrix Type is Blend (Backfat)
      *   |- c4    : RCD.Cutout Matrix Type is Formula (Backfat)
      *   '-
     C           #1VTST    IFEQ 'F'                        *IF
     C           #1VTST    OREQ 'B'                        *OR
     C           #1VTST    OREQ 'C'                        *OR
     C           #1VTST    OREQ 'A'                        *OR
      * Crt Cutout Items Ln%  PV - PS Cutout Yield  * 
     C                     CALL 'POQ7PVR'              90  Crt Cutout Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0019  30       Company Number
     C                     PARM #1RXCD    WQ0020  6        Cutout Matrix C
     C                     PARM #1GHDT    WQ0021  40       Effective Month
     C                     PARM #1VTST    WQ0022  1        Cutout Matrix T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQ7PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0027           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,38
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Del Cutout Matrix     DL - PS Cutout Matrix  * 
     C                     EXSR SADLRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P2I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @I0RENO fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELI0UVST    #1UVST           EDI Status 1
     C                     MOVELI0UWST    #1UWST           EDI Status 2
     C                     MOVELI0UXST    #1UXST           EDI Status 3
     C                     Z-ADDI0AATM    #1AATM           Job Time
     C                     MOVELI0AYNA    #1AYNA           User Id
     C                     MOVELI0A0NA    #1A0NA           Job Name
     C                     Z-ADDI0AXDT    #1AXDT           Job Date
     C                     Z-ADDI0AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELI0MXNA    #1MXNA           Cutout Matrix D
     C                     MOVELI0RXCD    #1RXCD           Cutout Matrix C
     C                     Z-ADDI0GHDT    #1GHDT           Effective Month
     C                     MOVELI0VTST    #1VTST           Cutout Matrix T
     C                     MOVELI0VUST    #1VUST           Cutout Matrix D
     C                     MOVELI0VSST    #1VSST           Record Status
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RAUNA           Description
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #2MXNA           Cutout Matrix D
     C                     MOVEL*BLANK    #2RXCD           Cutout Matrix C
     C                     Z-ADD*ZERO     #2GHDT           Effective Month
     C                     MOVEL*BLANK    #2VTST           Cutout Matrix T
     C                     MOVEL*BLANK    #2VUST           Cutout Matrix D
     C                     MOVEL*BLANK    #2VSST           Record Status
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SADLRC    BEGSR
      *================================================================
      * Del Cutout Matrix     DL - PS Cutout Matrix  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data update
      * *Delete Cutout Weight Range, Distribution, and Items
      * Del Weight Range      RT - PS Cutout Weight Range  * 
     C                     EXSR SBRVGN
      * Move key fields to @I0RES2
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     MOVEL#1RXCD    WARXCD           Cutout Matrix C
     C                     Z-ADD#1GHDT    WAGHDT           Effective Month
      *
     C           KLDLSA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WARXCD           Cutout Matrix C
     C                     KFLD           WAGHDT           Effective Month
     C           KLDLSA    CHAIN@I0RES2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI0REL0'MDACP
     C                     MOVEL'@I0RES2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I0RES2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Del Weight Range      RT - PS Cutout Weight Range  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I1AIC3    WQSB01           Company Number
     C           *LIKE     DEFN I1RXCD    WQSB02           Cutout Matrix C
     C           *LIKE     DEFN I1GHDT    WQSB03           Effective Month
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Cutout Matrix C
     C                     KFLD           WQSB03           Effective Month
      * Setup key
     C                     Z-ADD#1AIC3    WQSB01           Company Number
     C                     MOVEL#1RXCD    WQSB02           Cutout Matrix C
     C                     Z-ADD#1GHDT    WQSB03           Effective Month
      * Establish starting position
     C           KRSSB     SETLL@I1RES6                    *
     C           KRSSB     READE@I1RES6                  90*
      * Data record not found
     C   90                MOVEL'USR1724' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *Delete Weight Range, Distribution, and Items.
      * Del Weight Range      IF
      * *Delete Distribution and Items
      * Del Distribution      RT - PS Cutout Dist Lean %  * 
     C                     EXSR SCRVGN
      * Del Dist Backfat      RT - PS Cutout Dist Backfat  * 
     C                     EXSR SGRVGN
      * Del Dist Loin-Eye     RT - PS Cutout Dist Loin-Eye  * 
     C                     EXSR SIRVGN
      * *Delete Weight Range
      * Del Weight Range      DL - PS Cutout Weight Range  * 
     C                     EXSR SKDLRC
     C           KRSSB     READE@I1RES6                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Del Distribution      RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IZAIC3    WQSC01           Company Number
     C           *LIKE     DEFN IZRXCD    WQSC02           Cutout Matrix C
     C           *LIKE     DEFN IZGHDT    WQSC03           Effective Month
     C           *LIKE     DEFN IZUPNB    WQSC04           Min Carcass Wei
     C           *LIKE     DEFN IZUQNB    WQSC05           Max Carcass Wei
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Cutout Matrix C
     C                     KFLD           WQSC03           Effective Month
     C                     KFLD           WQSC04           Min Carcass Wei
     C                     KFLD           WQSC05           Max Carcass Wei
      * Setup key
     C                     Z-ADDI1AIC3    WQSC01           Company Number
     C                     MOVELI1RXCD    WQSC02           Cutout Matrix C
     C                     Z-ADDI1GHDT    WQSC03           Effective Month
     C                     Z-ADDI1UPNB    WQSC04           Min Carcass Wei
     C                     Z-ADDI1UQNB    WQSC05           Max Carcass Wei
      * Establish starting position
     C           KRSSC     SETLL@IZRETC                    *
     C           KRSSC     READE@IZRETC                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *Delete Distribution and Items
      * Del Distribution      IF
      * *Delete Items
      * Del Cutout Item       RT - PS Cutout Item  * 
     C                     EXSR SDRVGN
      * *Delete Distribution
      * DLT Distribution       DL - PS Cutout Dist Lean %  * 
     C                     EXSR SFDLRC
     C           KRSSC     READE@IZRETC                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Del Cutout Item       RT - PS Cutout Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I4AIC3    WQSD01           Company Number
     C           *LIKE     DEFN I4RXCD    WQSD02           Cutout Matrix C
     C           *LIKE     DEFN I4GHDT    WQSD03           Effective Month
     C           *LIKE     DEFN I4UPNB    WQSD04           Min Carcass Wei
     C           *LIKE     DEFN I4UQNB    WQSD05           Max Carcass Wei
     C           *LIKE     DEFN I4ULNB    WQSD06           Lean Percent
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Cutout Matrix C
     C                     KFLD           WQSD03           Effective Month
     C                     KFLD           WQSD04           Min Carcass Wei
     C                     KFLD           WQSD05           Max Carcass Wei
     C                     KFLD           WQSD06           Lean Percent
      * Setup key
     C                     Z-ADDIZAIC3    WQSD01           Company Number
     C                     MOVELIZRXCD    WQSD02           Cutout Matrix C
     C                     Z-ADDIZGHDT    WQSD03           Effective Month
     C                     Z-ADDIZUPNB    WQSD04           Min Carcass Wei
     C                     Z-ADDIZUQNB    WQSD05           Max Carcass Wei
     C                     Z-ADDIZULNB    WQSD06           Lean Percent
      * Establish starting position
     C           KRSSD     SETLL@I4RETX                    *
     C           KRSSD     READE@I4RETX                  90*
      * Data record not found
     C   90                MOVEL'USR1731' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *Delete Item
      * DLT Cutout Item        DL - PS Cutout Item  * 
     C                     EXSR SEDLRC
     C           KRSSD     READE@I4RETX                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DLT Cutout Item        DL - PS Cutout Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I4RETW
     C                     Z-ADDI4AIC3    WBAIC3           Company Number
     C                     MOVELI4RXCD    WBRXCD           Cutout Matrix C
     C                     Z-ADDI4GHDT    WBGHDT           Effective Month
     C                     Z-ADDI4UPNB    WBUPNB           Min Carcass Wei
     C                     Z-ADDI4UQNB    WBUQNB           Max Carcass Wei
     C                     Z-ADDI4ULNB    WBULNB           Lean Percent
     C                     Z-ADDI4HGCD    WBHGCD           Item Code
      *
     C           KLDLSE    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBRXCD           Cutout Matrix C
     C                     KFLD           WBGHDT           Effective Month
     C                     KFLD           WBUPNB           Min Carcass Wei
     C                     KFLD           WBUQNB           Max Carcass Wei
     C                     KFLD           WBULNB           Lean Percent
     C                     KFLD           WBHGCD           Item Code
     C           KLDLSE    CHAIN@I4RETW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI4REL0'MDACP
     C                     MOVEL'@I4RETW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I4RETW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT Distribution       DL - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @IZRETB
     C                     Z-ADDIZAIC3    WCAIC3           Company Number
     C                     MOVELIZRXCD    WCRXCD           Cutout Matrix C
     C                     Z-ADDIZGHDT    WCGHDT           Effective Month
     C                     Z-ADDIZUPNB    WCUPNB           Min Carcass Wei
     C                     Z-ADDIZUQNB    WCUQNB           Max Carcass Wei
     C                     Z-ADDIZULNB    WCULNB           Lean Percent
      *
     C           KLDLSF    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRXCD           Cutout Matrix C
     C                     KFLD           WCGHDT           Effective Month
     C                     KFLD           WCUPNB           Min Carcass Wei
     C                     KFLD           WCUQNB           Max Carcass Wei
     C                     KFLD           WCULNB           Lean Percent
     C           KLDLSF    CHAIN@IZRETB              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIZREL0'MDACP
     C                     MOVEL'@IZRETB' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@IZRETB                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del Dist Backfat      RT - PS Cutout Dist Backfat  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN J0AIC3    WQSG01           Company Number
     C           *LIKE     DEFN J0RXCD    WQSG02           Cutout Matrix C
     C           *LIKE     DEFN J0GHDT    WQSG03           Effective Month
     C           *LIKE     DEFN J0UPNB    WQSG04           Min Carcass Wei
     C           *LIKE     DEFN J0UQNB    WQSG05           Max Carcass Wei
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Cutout Matrix C
     C                     KFLD           WQSG03           Effective Month
     C                     KFLD           WQSG04           Min Carcass Wei
     C                     KFLD           WQSG05           Max Carcass Wei
      * Setup key
     C                     Z-ADDI1AIC3    WQSG01           Company Number
     C                     MOVELI1RXCD    WQSG02           Cutout Matrix C
     C                     Z-ADDI1GHDT    WQSG03           Effective Month
     C                     Z-ADDI1UPNB    WQSG04           Min Carcass Wei
     C                     Z-ADDI1UQNB    WQSG05           Max Carcass Wei
      * Establish starting position
     C           KRSSG     SETLL@J0RECH                    *
     C           KRSSG     READE@J0RECH                  90*
      * Data record not found
     C   90                MOVEL'USR2035' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Distribution      IF
      * *Delete Distribution
      * DLT Dist Backfat       DL - PS Cutout Dist Backfat  * 
     C                     EXSR SHDLRC
     C           KRSSG     READE@J0RECH                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * DLT Dist Backfat       DL - PS Cutout Dist Backfat  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @J0RECG
     C                     Z-ADDJ0AIC3    WDAIC3           Company Number
     C                     MOVELJ0RXCD    WDRXCD           Cutout Matrix C
     C                     Z-ADDJ0GHDT    WDGHDT           Effective Month
     C                     Z-ADDJ0UPNB    WDUPNB           Min Carcass Wei
     C                     Z-ADDJ0UQNB    WDUQNB           Max Carcass Wei
     C                     Z-ADDJ0BFIN    WDBFIN           Backfat Inches
      *
     C           KLDLSH    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDRXCD           Cutout Matrix C
     C                     KFLD           WDGHDT           Effective Month
     C                     KFLD           WDUPNB           Min Carcass Wei
     C                     KFLD           WDUQNB           Max Carcass Wei
     C                     KFLD           WDBFIN           Backfat Inches
     C           KLDLSH    CHAIN@J0RECG              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJ0REL0'MDACP
     C                     MOVEL'@J0RECG' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@J0RECG                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Del Dist Loin-Eye     RT - PS Cutout Dist Loin-Eye  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN J1AIC3    WQSI01           Company Number
     C           *LIKE     DEFN J1RXCD    WQSI02           Cutout Matrix C
     C           *LIKE     DEFN J1GHDT    WQSI03           Effective Month
     C           *LIKE     DEFN J1UPNB    WQSI04           Min Carcass Wei
     C           *LIKE     DEFN J1UQNB    WQSI05           Max Carcass Wei
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Cutout Matrix C
     C                     KFLD           WQSI03           Effective Month
     C                     KFLD           WQSI04           Min Carcass Wei
     C                     KFLD           WQSI05           Max Carcass Wei
      * Setup key
     C                     Z-ADDI1AIC3    WQSI01           Company Number
     C                     MOVELI1RXCD    WQSI02           Cutout Matrix C
     C                     Z-ADDI1GHDT    WQSI03           Effective Month
     C                     Z-ADDI1UPNB    WQSI04           Min Carcass Wei
     C                     Z-ADDI1UQNB    WQSI05           Max Carcass Wei
      * Establish starting position
     C           KRSSI     SETLL@J1RECK                    *
     C           KRSSI     READE@J1RECK                  90*
      * Data record not found
     C   90                MOVEL'USR2037' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Dist Loin-Eye     DL - PS Cutout Dist Loin-Eye  * 
     C                     EXSR SJDLRC
     C           KRSSI     READE@J1RECK                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Del Dist Loin-Eye     DL - PS Cutout Dist Loin-Eye  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @J1RECJ
     C                     Z-ADDJ1AIC3    WEAIC3           Company Number
     C                     MOVELJ1RXCD    WERXCD           Cutout Matrix C
     C                     Z-ADDJ1GHDT    WEGHDT           Effective Month
     C                     Z-ADDJ1UPNB    WEUPNB           Min Carcass Wei
     C                     Z-ADDJ1UQNB    WEUQNB           Max Carcass Wei
     C                     Z-ADDJ1LEDP    WELEDP           Loin-Eye Depth
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WERXCD           Cutout Matrix C
     C                     KFLD           WEGHDT           Effective Month
     C                     KFLD           WEUPNB           Min Carcass Wei
     C                     KFLD           WEUQNB           Max Carcass Wei
     C                     KFLD           WELEDP           Loin-Eye Depth
     C           KLDLSJ    CHAIN@J1RECJ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJ1REL0'MDACP
     C                     MOVEL'@J1RECJ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@J1RECJ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * Del Weight Range      DL - PS Cutout Weight Range  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I1RES5
     C                     Z-ADDI1AIC3    WFAIC3           Company Number
     C                     MOVELI1RXCD    WFRXCD           Cutout Matrix C
     C                     Z-ADDI1GHDT    WFGHDT           Effective Month
     C                     Z-ADDI1UPNB    WFUPNB           Min Carcass Wei
     C                     Z-ADDI1UQNB    WFUQNB           Max Carcass Wei
      *
     C           KLDLSK    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFRXCD           Cutout Matrix C
     C                     KFLD           WFGHDT           Effective Month
     C                     KFLD           WFUPNB           Min Carcass Wei
     C                     KFLD           WFUQNB           Max Carcass Wei
     C           KLDLSK    CHAIN@I1RES5              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI1REL0'MDACP
     C                     MOVEL'@I1RES5' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I1RES5                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSL     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,010   W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0001           Company Number
     C                     MOVELDRBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    DTAJVN           User Profile Na
     C                     MOVELWL0002    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSM     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0003           Company Number
     C                     MOVELDTAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSN01           Application Cod
     C                     MOVEL'P/S'     WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSO01           Application Cod
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSO01           Application Cod
      * Establish starting position
     C           KRSSO     SETLL@DNRESF                    *
     C           KRSSO     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,010   W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02560
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  10        W0CSRR  50
     C           02560     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ054
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2VTST'  YPMTFD           Cutout Matrix T
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ068
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2VUST'  YPMTFD           Cutout Matrix D
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ073
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2VSST'  YPMTFD           Record Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              92    *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PDA2DFRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1VXST           Record Found -P
     C                     MOVEL*BLANK    P1VYST           Record Found -P
     C                     MOVEL*BLANK    P1VZST           Record Found -P
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P2AIC3           Company Number
     C                     MOVEL*BLANK    P2DQCD           Enterprise Code
     C                     MOVEL*BLANK    P2DRCD           Enterprise Code
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P3G3TX           PRT Description
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P3WSST           PRT Hold Output
     C                     MOVEL*BLANK    P3WTST           PRT Save Output
     C                     Z-ADD*ZERO     P3DYNB           PRT Number of C
     C                     MOVEL*BLANK    P3WUST           PRT Night Queue
     C                     MOVEL*BLANK    P3BVVN           PRT Night Queue
     C                     MOVEL*BLANK    P4XFST           Display Prt Opt
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAGHDT           Effective Month
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBGHDT           Effective Month
     C                     Z-ADD*ZERO     WBUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WBUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WBULNB           Lean Percent
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBUTNB           Percent of Carc
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCGHDT           Effective Month
     C                     Z-ADD*ZERO     WCUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WCUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WCULNB           Lean Percent
     C                     Z-ADD*ZERO     WCUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WCUONB           Population Perc
     C                     Z-ADD*ZERO     WCDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WCZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WCAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WCQPNX           Population Head
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDGHDT           Effective Month
     C                     Z-ADD*ZERO     WDUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WDUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WDBFIN           Backfat Inches
     C                     Z-ADD*ZERO     WDUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WDUONB           Population Perc
     C                     Z-ADD*ZERO     WDDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WDZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WDAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WDQPNX           Population Head
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEGHDT           Effective Month
     C                     Z-ADD*ZERO     WEUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WEUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WELEDP           Loin-Eye Depth
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFGHDT           Effective Month
     C                     Z-ADD*ZERO     WFUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WFUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WFVSNB           Min Live Weight
     C                     Z-ADD*ZERO     WFVVNB           Max Live Weight
     C                     Z-ADD*ZERO     WFDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WFV0NB           Std Dressing Yi
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0002  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD12        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SLRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0028           User Profile Na
     C                     MOVEL'P/S'     ZA0029           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL@CN,003   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    P2AIC3           Company Number
     C                     MOVELWL0004    YL0002    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    P2AIC3           Company Number
     C                     MOVELWL0004    YL0002    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0002    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0030           User Profile Na
     C                     MOVEL'P/S'     ZA0031           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL@CN,003   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0001    IFNE *ZERO                      *IF
     C                     Z-ADDYL0001    P2AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0002    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0023  3        Warehouse Code
     C                     PARM YL0001    WQ0024  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SNRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'*YES'    P4XFST           Display Prt Opt
     C                     MOVEL'N'       P3WUST           PRT Night Queue
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01026012820230902313023440235102358
02372023770256202565025690260002607
02614026160262802633
** W0END
01103013590231102342023490235502358
02372023770256302567025980260502611
02614026250262802633
** W0NAM
**SPT     #2ST1     V2AIC3    #2MXNA    #2RXCD    #2GHDT    #2VTST
#2VUST    #2VSST    #1SEL     V1AIC3    #1MXNA    #1RXCD    #1GHDT
#1VTST    #RAUNA    #1VUST    #1VSST
** @CN
00001 USR0752
00002 Cutout Items
00003 Y2U9999
00004 PDH0PFR
00005 PDH0PFR$
00006 PRTCUTDST
00007 PDB7PFR
00008 PDB7PFR$
00009 PRTCUTITM
00010 Y2U0005
