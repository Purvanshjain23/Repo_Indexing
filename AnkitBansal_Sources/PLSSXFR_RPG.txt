     H/TITLE Exc Post from Mtech   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 03/19/14  Time  : 10:07:14
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLADCPL0IF  E           K        DISK
      * RTV : Delivery Sched Header     Retrieval index
      *
     FPKAWCPL3IF  E           K        DISK
      * RSQ : Buy Order Header          Co/Kill Dte /Prdcr/Loc
      *
     FPLAECPL4IF  E           K        DISK
      * RSQ : Delivery Sched Detail       Co/Kill,HPE Post n=P,I
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPLAGCPL1IF  E           K        DISK
      * RTV : Delivery Sched Split      Retrieval index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPLAGCPL0UF  E           K        DISK
      * UPD : Delivery Sched Split      Update index
      *
     FPLAECPL1UF  E           K        DISK
      * UPD : Delivery Sched Detail     Update index
      *
      * Long constants
     E                    @CN#    1  17  6   @CN    25
     I@ADCPID
      * Delivery Sched Header     Retrieval index
      * Renamed input format fields
     I              ADHONB                          WAHONB
     I              ADE0DT                          WAE0DT
     I              ADHYA1                          WAHYA1
     I              ADINA1                          WAINA1
     I              ADWXST                          WAWXST
     I              ADE1DT                          WAE1DT
     I              ADBLTM                          WABLTM
     I              ADE2DT                          WAE2DT
     I              ADBMTM                          WABMTM
     I              ADE3DT                          WAE3DT
     I              ADBNTM                          WABNTM
     I              ADXDST                          WAXDST
     I              ADE4DT                          WAE4DT
     I              ADBOTM                          WABOTM
     I              ADXEST                          WAXEST
     I              ADE5DT                          WAE5DT
     I              ADBPTM                          WABPTM
     I              ADAAVN                          WAAAVN
     I              ADAADT                          WAAADT
     I              ADAMTM                          WAAMTM
     I              ADAJST                          WAAJST
     I              ADAHVN                          WAAHVN
     I              ADAGVN                          WAAGVN
     I              ADABVN                          WAABVN
     I              ADABDT                          WAABDT
     I              ADABTM                          WAABTM
      *
     I@AWCPB5
      * Buy Order Header          Co/Kill Dte /Prdcr/Loc
      * Renamed input format fields
     I              AWHMNB                          WBHMNB
     I              AWBNNB                          WBBNNB
     I              AWARDT                          WBARDT
     I              AWASDT                          WBASDT
     I              AWA4ST                          WBA4ST
     I              AWA5ST                          WBA5ST
     I              AWAAPR                          WBAAPR
     I              AWA6ST                          WBA6ST
     I              AWA7ST                          WBA7ST
     I              AWB3ST                          WBB3ST
     I              AWALPR                          WBALPR
     I              AWETCD                          WBETCD
     I              AWEUCD                          WBEUCD
     I              AWJ5TX                          WBJ5TX
     I              AWD5DT                          WBD5DT
     I              AWD6DT                          WBD6DT
     I              AWD7DT                          WBD7DT
     I              AWD8DT                          WBD8DT
     I              AWD9DT                          WBD9DT
     I              AWJOEJ                          WBJOEJ
     I              AWKOFF                          WBKOFF
     I              AWKWPE                          WBKWPE
     I              AWIMBF                          WBIMBF
     I              AWOPTR                          WBOPTR
     I              AWOEJD                          WBOEJD
     I              AWIRMF                          WBIRMF
     I              AWJIRM                          WBJIRM
     I              AWJRKF                          WBJRKF
     I              AWKFIR                          WBKFIR
     I              AWUZST                          WBUZST
     I              AWU0ST                          WBU0ST
     I              AWU1ST                          WBU1ST
     I              AWU2ST                          WBU2ST
     I              AWU3ST                          WBU3ST
     I              AWHXNB                          WBHXNB
     I              AWGANB                          WBGANB
     I              AWGBNB                          WBGBNB
     I              AWABCD                          WBABCD
     I              AWAECD                          WBAECD
     I              AWAKCD                          WBAKCD
     I              AWALCD                          WBALCD
     I              AWAGCD                          WBAGCD
     I              AWAICD                          WBAICD
     I              AWAMCD                          WBAMCD
     I              AWACCD                          WBACCD
     I              AWAAVN                          WBAAVN
     I              AWAADT                          WBAADT
     I              AWAMTM                          WBAMTM
     I              AWAJST                          WBAJST
     I              AWAHVN                          WBAHVN
     I              AWAGVN                          WBAGVN
     I              AWABVN                          WBABVN
     I              AWABDT                          WBABDT
     I              AWABTM                          WBABTM
      *
     I@AECPJE
      * Delivery Sched Detail       Co/Kill,HPE Post n=P,I
      * Renamed input format fields
     I              AEHONB                          WCHONB
     I              AEE0DT                          WCE0DT
     I              AEE6DT                          WCE6DT
     I              AEAGTH                          WCAGTH
     I              AEHZA1                          WCHZA1
     I              AEH0A1                          WCH0A1
     I              AEH1A1                          WCH1A1
     I              AEJ4CD                          WCJ4CD
     I              AEJ5CD                          WCJ5CD
     I              AELBCD                          WCLBCD
     I              AELCCD                          WCLCCD
     I              AEIOA1                          WCIOA1
     I              AEH2A1                          WCH2A1
     I              AEIJA1                          WCIJA1
     I              AEK9CD                          WCK9CD
     I              AEK8CD                          WCK8CD
     I              AEJ6CD                          WCJ6CD
     I              AEJ7CD                          WCJ7CD
     I              AEMGCD                          WCMGCD
     I              AEW1ST                          WCW1ST
     I              AEW2ST                          WCW2ST
     I              AEH3A1                          WCH3A1
     I              AEMECD                          WCMECD
     I              AEMFCD                          WCMFCD
     I              AEW4ST                          WCW4ST
     I              AEXWST                          WCXWST
     I              AEFRDT                          WCFRDT
     I              AEBOTH                          WCBOTH
     I              AEE7DT                          WCE7DT
     I              AEAHTH                          WCAHTH
     I              AEE8DT                          WCE8DT
     I              AEAITH                          WCAITH
     I              AEXBST                          WCXBST
     I              AEXGST                          WCXGST
     I              AEXPST                          WCXPST
     I              AEXNST                          WCXNST
     I              AEXTST                          WCXTST
     I              AEXLST                          WCXLST
     I              AEW0ST                          WCW0ST
     I              AEYEST                          WCYEST
     I              AEFZDT                          WCFZDT
     I              AEB1TH                          WCB1TH
     I              AEAACD                          WCAACD
     I              AEABCD                          WCABCD
     I              AEAECD                          WCAECD
     I              AEHMNB                          WCHMNB
     I              AEBNNB                          WCBNNB
     I              AEBONB                          WCBONB
     I              AEAAVN                          WCAAVN
     I              AEAADT                          WCAADT
     I              AEAMTM                          WCAMTM
     I              AEAJST                          WCAJST
     I              AEAHVN                          WCAHVN
     I              AEAGVN                          WCAGVN
     I              AEABVN                          WCABVN
     I              AEABDT                          WCABDT
     I              AEABTM                          WCABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WDHMNB
     I              AXBNNB                          WDBNNB
     I              AXBONB                          WDBONB
     I              AXCQDT                          WDCQDT
     I              AXABTH                          WDABTH
     I              AXACTH                          WDACTH
     I              AXBPNB                          WDBPNB
     I              AXCSNB                          WDCSNB
     I              AXAUDT                          WDAUDT
     I              AXCMST                          WDCMST
     I              AXAGPR                          WDAGPR
     I              AXATVA                          WDATVA
     I              AXI1ST                          WDI1ST
     I              AXDHNB                          WDDHNB
     I              AXDINB                          WDDINB
     I              AXCNST                          WDCNST
     I              AXGINB                          WDGINB
     I              AXBZDT                          WDBZDT
     I              AXLSNB                          WDLSNB
     I              AXF3TX                          WDF3TX
     I              AXO8ST                          WDO8ST
     I              AXO9ST                          WDO9ST
     I              AXPAST                          WDPAST
     I              AXLDSH                          WDLDSH
     I              AXPBST                          WDPBST
     I              AXPCST                          WDPCST
     I              AXPDST                          WDPDST
     I              AXUWST                          WDUWST
     I              AXUXST                          WDUXST
     I              AXUYST                          WDUYST
     I              AXJKRU                          WDJKRU
     I              AXKEOR                          WDKEOR
     I              AXIOEW                          WDIOEW
     I              AXKJIO                          WDKJIO
     I              AXIOJR                          WDIOJR
     I              AXEIRR                          WDEIRR
     I              AXITMF                          WDITMF
     I              AXODJE                          WDODJE
     I              AXRJIF                          WDRJIF
     I              AXOEJF                          WDOEJF
     I              AXD0DT                          WDD0DT
     I              AXD1DT                          WDD1DT
     I              AXD2DT                          WDD2DT
     I              AXD3DT                          WDD3DT
     I              AXD4DT                          WDD4DT
     I              AXBNCD                          WDBNCD
     I              AXABCD                          WDABCD
     I              AXAECD                          WDAECD
     I              AXAAVN                          WDAAVN
     I              AXAADT                          WDAADT
     I              AXAMTM                          WDAMTM
     I              AXAJST                          WDAJST
     I              AXAHVN                          WDAHVN
     I              AXAGVN                          WDAGVN
     I              AXABVN                          WDABVN
     I              AXABDT                          WDABDT
     I              AXABTM                          WDABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WEHMNB
     I              AXBNNB                          WEBNNB
     I              AXBONB                          WEBONB
     I              AXCQDT                          WECQDT
     I              AXABTH                          WEABTH
     I              AXACTH                          WEACTH
     I              AXBPNB                          WEBPNB
     I              AXCSNB                          WECSNB
     I              AXAUDT                          WEAUDT
     I              AXCMST                          WECMST
     I              AXAGPR                          WEAGPR
     I              AXATVA                          WEATVA
     I              AXI1ST                          WEI1ST
     I              AXDHNB                          WEDHNB
     I              AXDINB                          WEDINB
     I              AXCNST                          WECNST
     I              AXGINB                          WEGINB
     I              AXBZDT                          WEBZDT
     I              AXLSNB                          WELSNB
     I              AXF3TX                          WEF3TX
     I              AXO8ST                          WEO8ST
     I              AXO9ST                          WEO9ST
     I              AXPAST                          WEPAST
     I              AXLDSH                          WELDSH
     I              AXPBST                          WEPBST
     I              AXPCST                          WEPCST
     I              AXPDST                          WEPDST
     I              AXUWST                          WEUWST
     I              AXUXST                          WEUXST
     I              AXUYST                          WEUYST
     I              AXJKRU                          WEJKRU
     I              AXKEOR                          WEKEOR
     I              AXIOEW                          WEIOEW
     I              AXKJIO                          WEKJIO
     I              AXIOJR                          WEIOJR
     I              AXEIRR                          WEEIRR
     I              AXITMF                          WEITMF
     I              AXODJE                          WEODJE
     I              AXRJIF                          WERJIF
     I              AXOEJF                          WEOEJF
     I              AXD0DT                          WED0DT
     I              AXD1DT                          WED1DT
     I              AXD2DT                          WED2DT
     I              AXD3DT                          WED3DT
     I              AXD4DT                          WED4DT
     I              AXBNCD                          WEBNCD
     I              AXABCD                          WEABCD
     I              AXAECD                          WEAECD
     I              AXAAVN                          WEAAVN
     I              AXAADT                          WEAADT
     I              AXAMTM                          WEAMTM
     I              AXAJST                          WEAJST
     I              AXAHVN                          WEAHVN
     I              AXAGVN                          WEAGVN
     I              AXABVN                          WEABVN
     I              AXABDT                          WEABDT
     I              AXABTM                          WEABTM
      *
     I@AGCPIM
      * Delivery Sched Split      Retrieval index
      * Renamed input format fields
     I              AGHONB                          WFHONB
     I              AGE0DT                          WFE0DT
     I              AGE6DT                          WFE6DT
     I              AGAGTH                          WFAGTH
     I              AGHZA1                          WFHZA1
     I              AGH5A1                          WFH5A1
     I              AGKNCD                          WFKNCD
     I              AGKOCD                          WFKOCD
     I              AGLDCD                          WFLDCD
     I              AGLECD                          WFLECD
     I              AGH6A1                          WFH6A1
     I              AGAAVN                          WFAAVN
     I              AGAADT                          WFAADT
     I              AGAMTM                          WFAMTM
     I              AGAJST                          WFAJST
     I              AGAHVN                          WFAHVN
     I              AGAGVN                          WFAGVN
     I              AGABVN                          WFABVN
     I              AGABDT                          WFABDT
     I              AGABTM                          WFABTM
      *
     I@AGCPIL
      * Delivery Sched Split      Update index
      * Renamed input format fields
     I              AGHONB                          WGHONB
     I              AGE0DT                          WGE0DT
     I              AGE6DT                          WGE6DT
     I              AGAGTH                          WGAGTH
     I              AGHZA1                          WGHZA1
     I              AGH5A1                          WGH5A1
     I              AGKNCD                          WGKNCD
     I              AGKOCD                          WGKOCD
     I              AGLDCD                          WGLDCD
     I              AGLECD                          WGLECD
     I              AGH6A1                          WGH6A1
     I              AGAAVN                          WGAAVN
     I              AGAADT                          WGAADT
     I              AGAMTM                          WGAMTM
     I              AGAJST                          WGAJST
     I              AGAHVN                          WGAHVN
     I              AGAGVN                          WGAGVN
     I              AGABVN                          WGABVN
     I              AGABDT                          WGABDT
     I              AGABTM                          WGABTM
      *
     I@AECPIH
      * Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WHHONB
     I              AEE0DT                          WHE0DT
     I              AEE6DT                          WHE6DT
     I              AEAGTH                          WHAGTH
     I              AEHZA1                          WHHZA1
     I              AEH0A1                          WHH0A1
     I              AEH1A1                          WHH1A1
     I              AEJ4CD                          WHJ4CD
     I              AEJ5CD                          WHJ5CD
     I              AELBCD                          WHLBCD
     I              AELCCD                          WHLCCD
     I              AEIOA1                          WHIOA1
     I              AEH2A1                          WHH2A1
     I              AEIJA1                          WHIJA1
     I              AEK9CD                          WHK9CD
     I              AEK8CD                          WHK8CD
     I              AEJ6CD                          WHJ6CD
     I              AEJ7CD                          WHJ7CD
     I              AEMGCD                          WHMGCD
     I              AEW1ST                          WHW1ST
     I              AEW2ST                          WHW2ST
     I              AEH3A1                          WHH3A1
     I              AEMECD                          WHMECD
     I              AEMFCD                          WHMFCD
     I              AEW4ST                          WHW4ST
     I              AEXWST                          WHXWST
     I              AEFRDT                          WHFRDT
     I              AEBOTH                          WHBOTH
     I              AEE7DT                          WHE7DT
     I              AEAHTH                          WHAHTH
     I              AEE8DT                          WHE8DT
     I              AEAITH                          WHAITH
     I              AEXBST                          WHXBST
     I              AEXGST                          WHXGST
     I              AEXPST                          WHXPST
     I              AEXNST                          WHXNST
     I              AEXTST                          WHXTST
     I              AEXLST                          WHXLST
     I              AEW0ST                          WHW0ST
     I              AEYEST                          WHYEST
     I              AEFZDT                          WHFZDT
     I              AEB1TH                          WHB1TH
     I              AEAACD                          WHAACD
     I              AEABCD                          WHABCD
     I              AEAECD                          WHAECD
     I              AEHMNB                          WHHMNB
     I              AEBNNB                          WHBNNB
     I              AEBONB                          WHBONB
     I              AEAAVN                          WHAAVN
     I              AEAADT                          WHAADT
     I              AEAMTM                          WHAMTM
     I              AEAJST                          WHAJST
     I              AEAHVN                          WHAHVN
     I              AEAGVN                          WHAGVN
     I              AEABVN                          WHABVN
     I              AEABDT                          WHABDT
     I              AEABTM                          WHABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WEHMNB
     I              AXBNNB                          WEBNNB
     I              AXBONB                          WEBONB
     I              AXCQDT                          WECQDT
     I              AXABTH                          WEABTH
     I              AXACTH                          WEACTH
     I              AXBPNB                          WEBPNB
     I              AXCSNB                          WECSNB
     I              AXAUDT                          WEAUDT
     I              AXCMST                          WECMST
     I              AXAGPR                          WEAGPR
     I              AXATVA                          WEATVA
     I              AXI1ST                          WEI1ST
     I              AXDHNB                          WEDHNB
     I              AXDINB                          WEDINB
     I              AXCNST                          WECNST
     I              AXGINB                          WEGINB
     I              AXBZDT                          WEBZDT
     I              AXLSNB                          WELSNB
     I              AXF3TX                          WEF3TX
     I              AXO8ST                          WEO8ST
     I              AXO9ST                          WEO9ST
     I              AXPAST                          WEPAST
     I              AXLDSH                          WELDSH
     I              AXPBST                          WEPBST
     I              AXPCST                          WEPCST
     I              AXPDST                          WEPDST
     I              AXUWST                          WEUWST
     I              AXUXST                          WEUXST
     I              AXUYST                          WEUYST
     I              AXJKRU                          WEJKRU
     I              AXKEOR                          WEKEOR
     I              AXIOEW                          WEIOEW
     I              AXKJIO                          WEKJIO
     I              AXIOJR                          WEIOJR
     I              AXEIRR                          WEEIRR
     I              AXITMF                          WEITMF
     I              AXODJE                          WEODJE
     I              AXRJIF                          WERJIF
     I              AXOEJF                          WEOEJF
     I              AXD0DT                          WED0DT
     I              AXD1DT                          WED1DT
     I              AXD2DT                          WED2DT
     I              AXD3DT                          WED3DT
     I              AXD4DT                          WED4DT
     I              AXBNCD                          WEBNCD
     I              AXABCD                          WEABCD
     I              AXAECD                          WEAECD
     I              AXAAVN                          WEAAVN
     I              AXAADT                          WEAADT
     I              AXAMTM                          WEAMTM
     I              AXAJST                          WEAJST
     I              AXAHVN                          WEAHVN
     I              AXAGVN                          WEAGVN
     I              AXABVN                          WEABVN
     I              AXABDT                          WEABDT
     I              AXABTM                          WEABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPLAG1    E DSPLAGCPL0
      * UPD : Delivery Sched Split      Update index
      * Renamed input format fields
     I              AGHONB                          WGHONB
     I              AGE0DT                          WGE0DT
     I              AGE6DT                          WGE6DT
     I              AGAGTH                          WGAGTH
     I              AGHZA1                          WGHZA1
     I              AGH5A1                          WGH5A1
     I              AGKNCD                          WGKNCD
     I              AGKOCD                          WGKOCD
     I              AGLDCD                          WGLDCD
     I              AGLECD                          WGLECD
     I              AGH6A1                          WGH6A1
     I              AGAAVN                          WGAAVN
     I              AGAADT                          WGAADT
     I              AGAMTM                          WGAMTM
     I              AGAJST                          WGAJST
     I              AGAHVN                          WGAHVN
     I              AGAGVN                          WGAGVN
     I              AGABVN                          WGABVN
     I              AGABDT                          WGABDT
     I              AGABTM                          WGABTM
      *
     IQPLAE1    E DSPLAECPL1
      * UPD : Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WHHONB
     I              AEE0DT                          WHE0DT
     I              AEE6DT                          WHE6DT
     I              AEAGTH                          WHAGTH
     I              AEHZA1                          WHHZA1
     I              AEH0A1                          WHH0A1
     I              AEH1A1                          WHH1A1
     I              AEJ4CD                          WHJ4CD
     I              AEJ5CD                          WHJ5CD
     I              AELBCD                          WHLBCD
     I              AELCCD                          WHLCCD
     I              AEIOA1                          WHIOA1
     I              AEH2A1                          WHH2A1
     I              AEIJA1                          WHIJA1
     I              AEK9CD                          WHK9CD
     I              AEK8CD                          WHK8CD
     I              AEJ6CD                          WHJ6CD
     I              AEJ7CD                          WHJ7CD
     I              AEMGCD                          WHMGCD
     I              AEW1ST                          WHW1ST
     I              AEW2ST                          WHW2ST
     I              AEH3A1                          WHH3A1
     I              AEMECD                          WHMECD
     I              AEMFCD                          WHMFCD
     I              AEW4ST                          WHW4ST
     I              AEXWST                          WHXWST
     I              AEFRDT                          WHFRDT
     I              AEBOTH                          WHBOTH
     I              AEE7DT                          WHE7DT
     I              AEAHTH                          WHAHTH
     I              AEE8DT                          WHE8DT
     I              AEAITH                          WHAITH
     I              AEXBST                          WHXBST
     I              AEXGST                          WHXGST
     I              AEXPST                          WHXPST
     I              AEXNST                          WHXNST
     I              AEXTST                          WHXTST
     I              AEXLST                          WHXLST
     I              AEW0ST                          WHW0ST
     I              AEYEST                          WHYEST
     I              AEFZDT                          WHFZDT
     I              AEB1TH                          WHB1TH
     I              AEAACD                          WHAACD
     I              AEABCD                          WHABCD
     I              AEAECD                          WHAECD
     I              AEHMNB                          WHHMNB
     I              AEBNNB                          WHBNNB
     I              AEBONB                          WHBONB
     I              AEAAVN                          WHAAVN
     I              AEAADT                          WHAADT
     I              AEAMTM                          WHAMTM
     I              AEAJST                          WHAJST
     I              AEAHVN                          WHAHVN
     I              AEAGVN                          WHAGVN
     I              AEABVN                          WHABVN
     I              AEABDT                          WHABDT
     I              AEABTM                          WHABTM
      *
     IYARDCS      DS                            232
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Delivery Sched Header
      * I :  CC Company Number
     I                                    P   1   20P1HONB
      * N :  DSH Status
     I                                        3   4 P1WXST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Post from Mtech   XF
      * E2423 Mtech Live = This is the process for the Mtech Upload
      * make sure that the data from the delivery schedule is
      * updated to lower level files
      * Get the MTech Live Yes or No
     C                     EXSR UASUBR                     Get the MTech L
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0001    IFEQ 'Y'                        *IF
      * For testing only    -- when testing with all find out if we
      * are in arrears or ahead
     C                     Z-ADD##JDT     WUGHDT           Previous Kill D
      * For production
      * Rtv DSH Status  Mtech RT - Delivery Sched Header  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv DSH Status  Mtech RT - Delivery Sched Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHONB    WQSA01           CC Company Numb
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
     C                     KFLD           WAE0DT           DSH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WQSA01           CC Company Numb
     C                     Z-ADDWUGHDT    WAE0DT           DSH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@ADCPID                    *
     C           KRSSA     READE@ADCPID                  90*
      * Data record not found
     C   90                MOVEL'PRK1026' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * -----------------------------------------------------------------
      * Information on this new process for MTechLive
     C                     EXSR UBSUBR                     Information on
      * Read Next if the Schedule is closed/or continue if not closed
      * CASE: DB1.DSH Status is 10=Schedule Closed
     C           WAWXST    IFEQ '10'                       *IF
      * Read the next delivery schedule header
     C                     ELSE
      * CASE: *OTHERWISE
      * Seaboard Producer and Sb01 Producer
      * Get the first buy order number for this kill date
      * Rtv BohBol For KillDte RT - Buy Order Header  * 
     C                     EXSR SBRVGN
      * Rtv Exc post fromMtechRT - Delivery Sched Detail  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
     C           KRSSA     READE@ADCPID                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv BohBol For KillDte RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBASDT    WQSB02           BOH Kill Date
     C           *LIKE     DEFN WBABCD    WQSB03           PD Producer Cod
     C           *LIKE     DEFN WBAECD    WQSB04           PL Location Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Kill Date
     C                     KFLD           WQSB03           PD Producer Cod
     C                     KFLD           WQSB04           PL Location Cod
      * Setup key
     C                     Z-ADDWAHONB    WQSB01           BOH Company Num
     C                     Z-ADDWAE0DT    WQSB02           BOH Kill Date
     C                     MOVEL@CN,002   WQSB03           PD Producer Cod
     C                     MOVE *BLANK    WQSB04           PL Location Cod
     C                     MOVEL'SB01'    WQSB04           PL Location Cod
      * Establish starting position
     C           KRSSB     SETLL@AWCPB5                    *
     C           KRSSB     READE@AWCPB5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUTYA1           BOH Buy Order N
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBNNB    WUTYA1           BOH Buy Order N
     C           KRSSB     READE@AWCPB5                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Exc post fromMtechRT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUFXSS           First Time Usr
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHONB    WQSC01           CC Company Numb
     C           *LIKE     DEFN WCE0DT    WQSC02           DSH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CC Company Numb
     C                     KFLD           WQSC02           DSH Kill Date
      * Setup key
     C                     Z-ADDWAHONB    WQSC01           CC Company Numb
     C                     Z-ADDWAE0DT    WQSC02           DSH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@AECPJE                    *
     C           KRSSC     READE@AECPJE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUH7ST           Record Found US
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * This rtv is only for the Mtech Live - Yes,
      * and Internal delivery schedule detail records
      * that are not posted yet
      * D=Clear Slot  | N=Not Posted Yet  |  R=Repost Slot
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.DSD HPE Post Status is Deleted
      *   |- c2    : JOB.*USER is PorkISTesting
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCXTST    IFEQ 'D'                        *IF
     C           ##USR     IFEQ @CN,003                    *IF
     C           ##USR     OREQ @CN,004
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 0424/2013 At this time there is no plans on sending in any
      * delete records, but will leave here in case we want to at a
      * later time.
      * DELETE SLOT
      * Delete buy order data
      * CASE: DB1.BOH Buy Order Number is NE Zero
     C           WCBNNB    IFNE *ZERO                      *IF
      * Rtv/Dlt BOL f/DSD     RT - Buy Order Load  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Delete split
      * CASE: DB1.DSD Full/Split Load is Split
     C           WCW2ST    IFEQ 'S'                        *IF
      * Rtv Del DSS           RT - Delivery Sched Split  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * instead of change or clear slot -- delete
      * Del Delv Sched Dtl    DL - Delivery Sched Detail  * 
     C                     EXSR SHDLRC
     C                     ELSE
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : DB1.DSD HPE Post Status is Not Posted
      *   |- c2    : DB1.DSD HPE Post Status is Repost
      *   |- c3    : DB1.BOH Buy Order Number is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCXTST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WCXTST    IFEQ 'R'                        *IF
     C           WCBNNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Create BOL, Chg HPE Post Sts
      * CASE: DB1.DSD Movement Number NE WRK.Zero USR
     C           WCH3A1    IFNE WUE9NB                     *IF
      * Pass in the movement number
      * Pass in the buy order for this kill date
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Buy Order Number Mtech is NE Zero
      *   |- c2    : WRK.First Time Usr is Yes
      *   '-
     C           WUTYA1    IFNE *ZERO                      *IF
     C           WUFXSS    OREQ 'Y'                        *OR
     C                     Z-ADDWUTYA1    YL0002           BOH Buy Order N
     C                     MOVEL'N'       WUFXSS           First Time Usr
     C                     END                             *FI
      * Crt BOH/BOL f/DSchMTechXF - Buy Order Header  * 
     C                     CALL 'PLSQXFR'              90  Crt BOH/BOL f/D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCHONB    WQ0004  30       CC Company Numb
     C                     PARM WCE0DT    WQ0005  70       DSH Kill Date
     C                     PARM WCE6DT    WQ0006  70       DSD Delivery Da
     C                     PARM WCAGTH    WQ0007  40       DSD Delivery Ti
     C                     PARM WCH2A1    WQ0008  30       DSD Scheduled D
     C                     PARM WCH3A1    WQ0009  70       DSD Movement Nu
     C                     PARM WCABCD    WQ0010  6        PD Producer Cod
     C                     PARM WCAECD    WQ0011  6        PL Location Cod
     C           YL0003    PARM YL0003    WQ0012  30       BOH Company Num
     C           YL0002    PARM YL0002    WQ0013  50       BOH Buy Order N
     C           YL0004    PARM YL0004    WQ0014  50       BOL Load Number
     C                     PARM 'N'       WQ0015  1        Status 3
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLSQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Delv Sched Dtl    CH - Delivery Sched Detail  * 
     C                     EXSR SICHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@AECPJE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Dlt BOL f/DSD     RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
      * Setup key
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
      * Establish starting position
     C           KRSSD     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Dlt Buy Order Detail  DL - Buy Order Load  * 
     C                     EXSR SEDLRC
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * Dlt Buy Order Detail  DL - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AXCPBY
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C           KLDLSE    CHAIN@AXCPBY              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AXCPBY                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Del DSS           RT - Delivery Sched Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHONB    WQSF01           CC Company Numb
     C           *LIKE     DEFN WFE0DT    WQSF02           DSH Kill Date
     C           *LIKE     DEFN WFE6DT    WQSF03           DSD Delivery Da
     C           *LIKE     DEFN WFAGTH    WQSF04           DSD Delivery Ti
     C           *LIKE     DEFN WFHZA1    WQSF05           DSD Delivery Ti
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           CC Company Numb
     C                     KFLD           WQSF02           DSH Kill Date
     C                     KFLD           WQSF03           DSD Delivery Da
     C                     KFLD           WQSF04           DSD Delivery Ti
     C                     KFLD           WQSF05           DSD Delivery Ti
      * Setup key
     C                     Z-ADDWCHONB    WQSF01           CC Company Numb
     C                     Z-ADDWCE0DT    WQSF02           DSH Kill Date
     C                     Z-ADDWCE6DT    WQSF03           DSD Delivery Da
     C                     Z-ADDWCAGTH    WQSF04           DSD Delivery Ti
     C                     Z-ADDWCHZA1    WQSF05           DSD Delivery Ti
      * Establish starting position
     C           KRSSF     SETLL@AGCPIM                    *
     C           KRSSF     READE@AGCPIM                  90*
      * Data record not found
     C   90                MOVEL'PRK1032' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Delv Sched Split  DL - Delivery Sched Split  * 
     C                     EXSR SGDLRC
     C           KRSSF     READE@AGCPIM                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Del Delv Sched Split  DL - Delivery Sched Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AGCPIL
     C                     Z-ADDWFHONB    WGHONB           CC Company Numb
     C                     Z-ADDWFE0DT    WGE0DT           DSH Kill Date
     C                     Z-ADDWFE6DT    WGE6DT           DSD Delivery Da
     C                     Z-ADDWFAGTH    WGAGTH           DSD Delivery Ti
     C                     Z-ADDWFHZA1    WGHZA1           DSD Delivery Ti
     C                     Z-ADDWFH5A1    WGH5A1           DSS Split Seque
      *
     C           KLDLSG    KLIST
     C                     KFLD           WGHONB           CC Company Numb
     C                     KFLD           WGE0DT           DSH Kill Date
     C                     KFLD           WGE6DT           DSD Delivery Da
     C                     KFLD           WGAGTH           DSD Delivery Ti
     C                     KFLD           WGHZA1           DSD Delivery Ti
     C                     KFLD           WGH5A1           DSS Split Seque
     C           KLDLSG    CHAIN@AGCPIL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAGCPL0'MDACP
     C                     MOVEL'@AGCPIL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AGCPIL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del Delv Sched Dtl    DL - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AECPIH
     C                     Z-ADDWCHONB    WHHONB           CC Company Numb
     C                     Z-ADDWCE0DT    WHE0DT           DSH Kill Date
     C                     Z-ADDWCE6DT    WHE6DT           DSD Delivery Da
     C                     Z-ADDWCAGTH    WHAGTH           DSD Delivery Ti
     C                     Z-ADDWCHZA1    WHHZA1           DSD Delivery Ti
      *
     C           KLDLSH    KLIST
     C                     KFLD           WHHONB           CC Company Numb
     C                     KFLD           WHE0DT           DSH Kill Date
     C                     KFLD           WHE6DT           DSD Delivery Da
     C                     KFLD           WHAGTH           DSD Delivery Ti
     C                     KFLD           WHHZA1           DSD Delivery Ti
     C           KLDLSH    CHAIN@AECPIH              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AECPIH                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Delv Sched Dtl    CH - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AECPIH
     C                     Z-ADDWCHONB    WHHONB           CC Company Numb
     C                     Z-ADDWCE0DT    WHE0DT           DSH Kill Date
     C                     Z-ADDWCE6DT    WHE6DT           DSD Delivery Da
     C                     Z-ADDWCAGTH    WHAGTH           DSD Delivery Ti
     C                     Z-ADDWCHZA1    WHHZA1           DSD Delivery Ti
      *
     C           KLCHSI    KLIST
     C                     KFLD           WHHONB           CC Company Numb
     C                     KFLD           WHE0DT           DSH Kill Date
     C                     KFLD           WHE6DT           DSD Delivery Da
     C                     KFLD           WHAGTH           DSD Delivery Ti
     C                     KFLD           WHHZA1           DSD Delivery Ti
     C           KLCHSI    CHAIN@AECPIH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAE1    YARDCS
      * Move non-key fields to @AECPIH
     C                     Z-ADDWCH0A1    WHH0A1           DSD Scheduled H
     C                     Z-ADDWCH1A1    WHH1A1           DSD Farm Site C
     C                     MOVELWCJ4CD    WHJ4CD    P      DSD Building
     C                     MOVELWCJ5CD    WHJ5CD    P      DSD Room
     C                     MOVELWCLBCD    WHLBCD    P      DSD Sire Line C
     C                     MOVELWCLCCD    WHLCCD    P      DSD Hog Group C
     C                     Z-ADDWCIOA1    WHIOA1           DSD Unused Head
     C                     Z-ADDWCH2A1    WHH2A1           DSD Scheduled D
     C                     Z-ADDWCIJA1    WHIJA1           DSD Scheduled K
     C                     MOVELWCK9CD    WHK9CD    P      DSD Transportat
     C                     MOVELWCK8CD    WHK8CD    P      DSD Trucker Cod
     C                     MOVELWCJ6CD    WHJ6CD    P      DSD Driver
     C                     MOVELWCJ7CD    WHJ7CD    P      DSD Loading Cre
     C                     MOVELWCMGCD    WHMGCD    P      CHR Code
     C                     MOVELWCW1ST    WHW1ST    P      DSD Load Type
     C                     MOVELWCW2ST    WHW2ST    P      DSD Full/Split
     C                     Z-ADDWCH3A1    WHH3A1           DSD Movement Nu
     C                     MOVELWCMECD    WHMECD    P      DSD Truck ID
     C                     MOVELWCMFCD    WHMFCD    P      DSD Trailer ID
     C                     MOVELWCW4ST    WHW4ST    P      DSD Movement Pr
     C                     MOVELWCXWST    WHXWST    P      DSD Sched Route
     C                     Z-ADDWCFRDT    WHFRDT           DSD Sched Route
     C                     Z-ADDWCBOTH    WHBOTH           DSD Sched Route
     C                     Z-ADDWCE7DT    WHE7DT           DSD Sch Farm Ar
     C                     Z-ADDWCAHTH    WHAHTH           DSD Sch Farm Ar
     C                     Z-ADDWCE8DT    WHE8DT           DSD Sch Start L
     C                     Z-ADDWCAITH    WHAITH           DSD Sch Start L
     C                     MOVELWCXBST    WHXBST    P      DSD Receiving S
     C                     MOVELWCXGST    WHXGST    P      DSD Kill Shift
     C                     MOVELWCXPST    WHXPST    P      DSD BOL Kill Sh
     C                     MOVELWCXNST    WHXNST    P      DSD HPS Post St
     C                     MOVEL'P'       WHXTST    P      DSD HPE Post St
     C                     MOVELWCXLST    WHXLST    P      DSD Lock Status
     C                     MOVELWCW0ST    WHW0ST    P      DSD Source Type
     C                     MOVELWCYEST    WHYEST    P      DSD Transfer St
     C                     Z-ADDWCFZDT    WHFZDT           DSD Unused Date
     C                     Z-ADDWCB1TH    WHB1TH           DSD Unused Time
     C                     MOVELWCAACD    WHAACD    P      SR Source Code
     C                     MOVELWCABCD    WHABCD    P      PD Producer Cod
     C                     MOVELWCAECD    WHAECD    P      PL Location Cod
     C                     Z-ADDYL0003    WHHMNB           BOH Company Num
     C                     Z-ADDYL0002    WHBNNB           BOH Buy Order N
     C                     Z-ADDYL0004    WHBONB           BOL Load Number
     C                     MOVELWCAAVN    WHAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WHAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WHAMTM           RS Time Changed
     C                     MOVELWCAJST    WHAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WHAHVN    P      RS Job
     C                     MOVELWCAGVN    WHAGVN    P      RS Program
     C                     MOVELWCABVN    WHABVN    P      RS User Added
     C                     Z-ADDWCABDT    WHABDT           RS Date Added
     C                     Z-ADDWCABTM    WHABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WHAAVN           RS User Changed
     C                     Z-ADD##JDT     WHAADT           RS Date Changed
     C                     Z-ADD##JTM     WHAMTM           RS Time Changed
     C                     MOVEL##JOB     WHAHVN           RS Job
     C                     MOVEL##PGM     WHAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AECPIH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAECPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0003 40        System Value Al
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0001           MTech Live Yes
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Information on this new process for MTechLive
      *================================================================
      * This is the processfor Mtech Live
      * Which the Delivery Schedule Detail Upl was processed
      * to only add records to the
      * Delivery Sched Detail
      * Delivery Sched split will not be used in this processed
      * will come back and update this information after review
      * FILES:
      * Delivery Sched Detail
      * Buy Order Header
      * Buy Order Load
      * Tattoo Header
      * Tracking  ??
      * without any HP272CL OR HP272 being processed.
      * -----------------------------------------------------------------
      * Read DS Detail by Kill date, Select internal, HPE Post Sts n=P
      *  1) If HPE Post Status = N,R        (Not posted or Repost)
      *      If Not Posted or (Repost and BOL = 0): Crt BOL
      *      If Repost: Update BOL Pln Head Delv= Sched Delv Head
      *      Both: Set HPE Post Sts to "P" if no errors, or "E" if errors
      *  2) If HPE Post Status = D           (Delete=Clear Slot)
      *   Delv Sched Dtl:  Zero-out BO/Load, farm site, building, room,si
      *   group, sched delv head,tranp office,trucker,driver,load crew
      *   load type,full/split,movement, mv prnt,schd route start pt/dt/t
      *   farm arrvl dt/tm, farm deprt dt/tm,prod,loc,bo,bol,srces
      *   If Split, then Delete Delv Schedule Splits
      *      Delete Buy Order Load from HPE Buy Order Load
      *      Set HPS Post Sts to "N" for not posted
      *      Set HPE Post Sts to "N" for not posted
      * -----------------------------------------------------------------
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1WXST           DSH Status
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Previous Kill Date
     C                     Z-ADD*ZERO     WUGHDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WAE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WAHYA1           DSH Planned Kil
     C                     Z-ADD*ZERO     WAINA1           DSH Requested D
     C                     Z-ADD*ZERO     WAE1DT           DSH Ext Sch Cre
     C                     Z-ADD*ZERO     WABLTM           DSH Ext Sch Cre
     C                     Z-ADD*ZERO     WAE2DT           DSH Opened to L
     C                     Z-ADD*ZERO     WABMTM           DSH Opened to L
     C                     Z-ADD*ZERO     WAE3DT           DSH Posted to H
     C                     Z-ADD*ZERO     WABNTM           DSH Posted to H
     C                     Z-ADD*ZERO     WAE4DT           DSH Sched Close
     C                     Z-ADD*ZERO     WABOTM           DSH Sched Close
     C                     Z-ADD*ZERO     WAE5DT           DSH BOL Printed
     C                     Z-ADD*ZERO     WABPTM           DSH BOL Printed
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Buy Order Number Mtech
     C                     Z-ADD*ZERO     WUTYA1  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WBASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WBAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WBALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WBD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WBD6DT           BOH Unused Date
     C                     Z-ADD*ZERO     WBD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WBD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WBD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WBJOEJ           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBKOFF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBKWPE           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WBHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WBGANB           CW Year
     C                     Z-ADD*ZERO     WBGBNB           CW Week Number
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUH7ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WCE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WCAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WCHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WCH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WCH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WCIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WCH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WCIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WCH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WCFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WCBOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WCE7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WCAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WCE8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WCAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WCFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WCB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field First Time Usr
     C                     MOVEL*BLANK    WUFXSS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WDABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WDACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WDBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WDCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WDAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WDAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WDATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WDDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WDDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WDGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WDBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WDLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WDLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WDJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WDKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WDIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WDKJIO           BOL Unused Nbr
     C                     Z-ADD*ZERO     WDIOJR           BOL Unused Nbr
     C                     Z-ADD*ZERO     WDEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WDD0DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WFE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WFAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WFHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WFH5A1           DSS Split Seque
     C                     Z-ADD*ZERO     WFH6A1           DSS Scheduled H
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field BOH Buy Order Number
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field BOH Company Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field BOL Load Number
     C                     Z-ADD*ZERO     YL0004  50
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MTECHLIVE
00002 SEABOA
00003 PRKTEST
00004 ISPPATE
00005 ISSMASO
00006 ALICEB
00007 ISRCENT
00008 ISLBUSE
00009 ISPURVAP
00010 ISALICEB
00011 ISSUSANM
00012 ISROSEM
00013 ISLARAB
00014 ISLEANNER
00015 ISLRAMS
00016 ISSHARONZ
00017 ISSZURN
