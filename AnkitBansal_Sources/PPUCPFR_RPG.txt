     H/TITLE Prt Inter-Co Price/UpdPF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/11/22  Time  : 15:21:34
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPMUIF  E           K        DISK
      * RSQ : Order Header TRG          ASD(d)/Co/Ord Confirmed
      *
     FPDKMREL2IF  E           K        DISK
      * RSQ : Company Values            By Values/Co
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBGWKNAIF  E           K        DISK
      * RSQ : Order Detail              Item/ASD(d) Confirmed
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPMDNREL2IF  E           K        DISK
      * RSQ : Item Groups for TP Sales  Active Items Only
      *
     FPNF4REL1IF  E           K        DISK
      * RTV : IP Cust Pricing Dtl       Retrieval index
      *
     FOMHSTPO6IF  E           K        DISK
      * RSQ : Sales History             Itm/ASD-d/Co/Ord RegSls
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPPUCPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Inter-Co Price/UpdPF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     I@BGWKG7
      * Order Detail              Item/ASD(d) Confirmed
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@EOREU0
      * Company Customer          Customer/Company
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WCAIC3
     I              KMV8CD                          WCV8CD
     I              KMAUNA                          WCAUNA
     I              KMI5ST                          WCI5ST
     I              KMBXTX                          WCBXTX
     I              KMM8NB                          WCM8NB
     I              KMUVST                          WCUVST
     I              KMUWST                          WCUWST
     I              KMUXST                          WCUXST
     I              KMVSST                          WCVSST
     I              KMAATM                          WCAATM
     I              KMAYNA                          WCAYNA
     I              KMA0NA                          WCA0NA
     I              KMAXDT                          WCAXDT
      *
     I@DNRERW
      * Item Groups for TP Sales  Active Items Only
      * Renamed input format fields
     I              DNHGCD                          WDHGCD
     I              DNERC7                          WDERC7
     I              DNGQPC                          WDGQPC
     I              DNAVGA                          WDAVGA
     I              DNSLSA                          WDSLSA
     I              DNKFNY                          WDKFNY
     I              DNKGNY                          WDKGNY
     I              DNRNDT                          WDRNDT
     I              DNJUAA                          WDJUAA
     I              DNJVAA                          WDJVAA
     I              DNUVST                          WDUVST
     I              DNUWST                          WDUWST
     I              DNUXST                          WDUXST
     I              DNVSST                          WDVSST
     I              DNAATM                          WDAATM
     I              DNAYNA                          WDAYNA
     I              DNA0NA                          WDA0NA
     I              DNAXDT                          WDAXDT
      *
     I@HSTPEW
      * Sales History             Itm/ASD-d/Co/Ord RegSls
      * Renamed input format fields
     I              F4AIC3                          WEAIC3
     I              F4C4NB                          WEC4NB
     I              F4DPNB                          WEDPNB
     I              F4UENB                          WEUENB
     I              F4MONA                          WEMONA
     I              F4RJCD                          WERJCD
     I              F4RKCD                          WERKCD
     I              F4GPTX                          WEGPTX
     I              F4ABTX                          WEABTX
     I              F4KXCD                          WEKXCD
     I              F4BOCD                          WEBOCD
     I              F4BTC7                          WEBTC7
     I              F4ANC7                          WEANC7
     I              F4AQTX                          WEAQTX
     I              F4BKC7                          WEBKC7
     I              F4BRTX                          WEBRTX
     I              F4HNNA                          WEHNNA
     I              F4DBCD                          WEDBCD
     I              F4CKTX                          WECKTX
     I              F4BCNA                          WEBCNA
     I              F4A0DT                          WEA0DT
     I              F4ACDT                          WEACDT
     I              F4R4CD                          WER4CD
     I              F4R5CD                          WER5CD
     I              F4BFCD                          WEBFCD
     I              F4Q4CD                          WEQ4CD
     I              F4AQCD                          WEAQCD
     I              F4TBNB                          WETBNB
     I              F4BZNA                          WEBZNA
     I              F4RLCD                          WERLCD
     I              F4JNCD                          WEJNCD
     I              F4Q2CD                          WEQ2CD
     I              F4U2ST                          WEU2ST
     I              F4ATIN                          WEATIN
     I              F4T3NB                          WET3NB
     I              F4RSRN                          WERSRN
     I              F4ORIT                          WEORIT
     I              F4AJCD                          WEAJCD
     I              F4AVQT                          WEAVQT
     I              F4D0WG                          WED0WG
     I              F4CCQT                          WECCQT
     I              F4AUWG                          WEAUWG
     I              F4AGCD                          WEAGCD
     I              F4AKPR                          WEAKPR
     I              F4AUPR                          WEAUPR
     I              F4CRCD                          WECRCD
     I              F4A5DT                          WEA5DT
     I              F4AWDT                          WEAWDT
     I              F4HDDT                          WEHDDT
     I              F4AGCS                          WEAGCS
     I              F4AQCS                          WEAQCS
     I              F4AVWG                          WEAVWG
     I              F4AYVA                          WEAYVA
     I              F4AMST                          WEAMST
     I              F4ANST                          WEANST
     I              F4VAST                          WEVAST
     I              F4L6NB                          WEL6NB
     I              F4UMCD                          WEUMCD
     I              F4HCDT                          WEHCDT
     I              F4ESNB                          WEESNB
     I              F4ETNB                          WEETNB
     I              F4BZNB                          WEBZNB
     I              F4EXQT                          WEEXQT
     I              F4BYWG                          WEBYWG
     I              F4S5NB                          WES5NB
     I              F4MAVA                          WEMAVA
     I              F4KDVA                          WEKDVA
     I              F4USVA                          WEUSVA
     I              F4UTVA                          WEUTVA
     I              F4A4WG                          WEA4WG
     I              F4CKNB                          WECKNB
     I              F4BMST                          WEBMST
     I              F4R8NB                          WER8NB
     I              F4RMCD                          WERMCD
     I              F4BZPR                          WEBZPR
     I              F4RDCD                          WERDCD
     I              F4Q7CD                          WEQ7CD
     I              F4EXDT                          WEEXDT
     I              F4LQCD                          WELQCD
     I              F4HICD                          WEHICD
     I              F4RBCD                          WERBCD
     I              F4RGNB                          WERGNB
     I              F4RHNB                          WERHNB
     I              F4RINB                          WERINB
     I              F4R1NB                          WER1NB
     I              F4CONB                          WECONB
     I              F4CEST                          WECEST
     I              F4GNDT                          WEGNDT
     I              F4RMNB                          WERMNB
     I              F4AODT                          WEAODT
     I              F4LLCD                          WELLCD
     I              F4LMCD                          WELMCD
     I              F4SKNB                          WESKNB
     I              F4SLNB                          WESLNB
     I              F4SMNB                          WESMNB
     I              F4G7NA                          WEG7NA
     I              F4ONVA                          WEONVA
     I              F4N0CD                          WEN0CD
     I              F4B4NB                          WEB4NB
     I              F4B5NB                          WEB5NB
     I              F4N1CD                          WEN1CD
     I              F4GIDT                          WEGIDT
     I              F4Z1ST                          WEZ1ST
     I              F4ULVA                          WEULVA
     I              F4UNVA                          WEUNVA
     I              F4UOVA                          WEUOVA
     I              F4UPVA                          WEUPVA
     I              F4UQVA                          WEUQVA
     I              F4SDCD                          WESDCD
     I              F4QZCD                          WEQZCD
     I              F4XWST                          WEXWST
     I              F4T9CD                          WET9CD
     I              F4UBCD                          WEUBCD
     I              F4CFC7                          WECFC7
     I              F4X1CD                          WEX1CD
     I              F4GASX                          WEGASX
     I              F4DUPR                          WEDUPR
     I              F4B6VL                          WEB6VL
     I              F4IANX                          WEIANX
     I              F4IBNX                          WEIBNX
     I              F4RPCD                          WERPCD
     I              F4NYDT                          WENYDT
     I              F4BZTM                          WEBZTM
     I              F4Z4NB                          WEZ4NB
     I              F4XACD                          WEXACD
     I              F4OANA                          WEOANA
     I              F4OKTX                          WEOKTX
     I              F4K4TX                          WEK4TX
     I              F4NBBO                          WENBBO
     I              F4OCFR                          WEOCFR
     I              F4C0C7                          WEC0C7
     I              F4A1AA                          WEA1AA
     I              F4VEST                          WEVEST
     I              F4A5PR                          WEA5PR
     I              F4CDPR                          WECDPR
     I              F4D0PR                          WED0PR
     I              F4D0VL                          WED0VL
     I              F4IRSX                          WEIRSX
     I              F4CEVL                          WECEVL
     I              F4ISSX                          WEISSX
     I              F4ITSX                          WEITSX
     I              F4IUSX                          WEIUSX
     I              F4OHDT                          WEOHDT
     I              F4D9PR                          WED9PR
     I              F4CFVL                          WECFVL
     I              F4UVST                          WEUVST
     I              F4UWST                          WEUWST
     I              F4UXST                          WEUXST
     I              F4AATM                          WEAATM
     I              F4AYNA                          WEAYNA
     I              F4A0NA                          WEA0NA
     I              F4AXDT                          WEAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
     IYBRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             10
      * KEY: Order Header TRG          ASD(d)/Co/Ord Confirmed
      * I : POS Actual Shipped Date
     I                                    P   1   40P1GNDT
     IP2PARM      DS
      * I :  From Date             USR
     I                                    P   1   40P2L9DT
     IP3PARM      DS
      * I :  To Date               USR
     I                                    P   1   40P3MADT
     IP4PARM      DS
      * B :  Error Report 2 Status Usr
     I                                        1   1 P4YTSX
     IP5PARM      DS
      * I :  Type of Run - TF Prc Usr
     I                                        1   1 P5YVSX
     IP6PARM      DS
      * I :  Inter Company Group USR
     I                                        1   1 P6GKU1
     IP7PARM      DS
      * N :  Invoice/Pre-Invoice
     I                                        1   1 P7IPTS
     IP8PARM      DS
      * FLD: Order Types
      * N :  Billing Activity Type
     I                                        1   1 P8OBST
     IP9PARM      DS
      * N :  USR Display field
     I                                        1   1 P9GGST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Fmt Price Override'
      * Price Overage Override
     I                                    P   1   64ZA0001
      * Message data for 'Fmt Price Override'
      * Price Overage Override
     I                                    P   1   64ZA0002
      * Message data for 'Inter-Co Pricing & PostER'
      * Inter Company Grp Dsc USR
     I                                        1  30 ZA0003
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Order Head
     C           P2L9DT    PARM           WP0001  70       From Date
     C           P3MADT    PARM           WP0002  70       To Date
     C           P4YTSX    PARM P4YTSX    WP0003  1        Error Report 2
     C           P5YVSX    PARM           WP0004  1        Type of Run - T
     C           P6GKU1    PARM           WP0005  1        Inter Company G
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Inter-Co Price/UpdPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$GENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Inter-Co Price/UpdPF: Mainline
      *================================================================
      * Define keylist
     C           KPSA      KLIST
     C                     KFLD           BEGNDT           Actual Shipped
      * Setup key
     C                     Z-ADDP1GNDT    BEGNDT           Actual Shipped
      * Establish starting position
     C           KPSA      SETLL@BFCPV2                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Actual Shipped
     C                     MOVEL'Y'       W0AL01  1        Company Number
     C                     MOVEL'Y'       W0AL02  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEGNDT    $CGNDT           Actual Shipped
     C                     Z-ADDBEAIC3    $CAIC3           Company Number
     C                     Z-ADDBEBKC7    $CBKC7           Ship To Custome
     C                     MOVELBEBRTX    $CBRTX           Ship To Name
     C                     Z-ADDBEC4NB    $CC4NB           Order Number
     C                     Z-ADDBERMNB    $CRMNB           Load ID
     C                     MOVELBEVDST    $CVDST           Load Type
     C                     MOVELBEQ2CD    $CQ2CD           Shipping Method
     C                     MOVEL*BLANK    $CBOCD           Type Code
     C                     MOVELBEJNCD    $CJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $CANC7           A/R Customer Nu
     C                     MOVELBEHMNA    $CHMNA           Ship To Address
     C                     MOVELBEHONA    $CHONA           Ship To Address
     C                     MOVELBEHPNA    $CHPNA           Ship To Address
     C                     MOVELBEHNNA    $CHNNA           Ship To City
     C                     MOVELBEDBCD    $CDBCD           Ship To State C
     C                     MOVELBECKTX    $CCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $CB0C7           Bill to Custome
     C                     MOVELBEAETX    $CAETX           Bill to Name
     C                     MOVELBEB1NA    $CB1NA           Bill to Address
     C                     MOVELBEB3NA    $CB3NA           Bill to Address
     C                     MOVELBEB4NA    $CB4NA           Bill to Address
     C                     MOVELBEB2NA    $CB2NA           Bill to City
     C                     MOVELBEBHCD    $CBHCD           Bill to State C
     C                     MOVELBEC8TX    $CC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $CBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $CA0DT           Order Date
     C                     Z-ADDBEA5DT    $CA5DT           Requested Ship
     C                     Z-ADDBEACDT    $CACDT           Cancel Date
     C                     MOVELBEAQCD    $CAQCD           Terms Code
     C                     MOVELBEB6NA    $CB6NA           Special Instruc
     C                     MOVELBEBYNA    $CBYNA           Special Instruc
     C                     MOVELBEBZNA    $CBZNA           Carrier Code
     C                     MOVELBEGTST    $CGTST           Comment Print A
     C                     MOVELBEGVST    $CGVST           Comment Print I
     C                     MOVELBEGUST    $CGUST           Comment Print P
     C                     MOVELBEQFST    $CQFST           Comment Print S
     C                     MOVELBECQCD    $CCQCD           Reason Code
     C                     MOVELBEGJST    $CGJST           Order in Use
     C                     MOVELBEGWST    $CGWST           Header Status
     C                     MOVELBEGXST    $CGXST           Header Status L
     C                     MOVELBEGYST    $CGYST           Order Type Prin
     C                     Z-ADDBEAODT    $CAODT           Scheduled Ship
     C                     MOVELBEAIVN    $CAIVN           User Original E
     C                     Z-ADDBECXDT    $CCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $CJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $CA1WG           Order Weight To
     C                     MOVELBEXIST    $CXIST           Credit Hold
     C                     MOVELBEXJST    $CXJST           Production Hold
     C                     MOVELBEXKST    $CXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $CEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $CAFTM           Requested Deliv
     C                     MOVELBEE8CD    $CE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $CE9CD           Accounts Receiv
     C                     Z-ADDBETBNB    $CTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $CR1NB           Rated Freight
     C                     MOVELBEPJST    $CPJST           LTL Flag
     C                     MOVELBEU0ST    $CU0ST           Price Audit
     C                     MOVELBEU1ST    $CU1ST           Price Status
     C                     MOVELBEU2ST    $CU2ST           Export Status
     C                     MOVELBEVEST    $CVEST           Palletize
     C                     MOVELBEVFST    $CVFST           Shrink Wrap
     C                     MOVELBEVGST    $CVGST           Slip Sheet
     C                     MOVELBERPCD    $CRPCD           Age Code
     C                     Z-ADDBERNNB    $CRNNB           Reefer Temperat
     C                     Z-ADDBEATIN    $CATIN           Attach to Invoi
     C                     MOVELBEU4ST    $CU4ST           Load Plan Order
     C                     MOVELBEU5ST    $CU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $CRSRN           Resell Referenc
     C                     MOVELBEMHNA    $CMHNA           Special Comment
     C                     MOVELBEMINA    $CMINA           Special Comment
     C                     MOVELBEWBST    $CWBST           Affect Auto Acc
     C                     MOVELBER4CD    $CR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $CBFCD           Manager Level C
     C                     MOVELBEQ4CD    $CQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $CT3NB           Attach to Order
     C                     MOVELBESICD    $CSICD           Reason for Pric
     C                     Z-ADDBECONB    $CCONB           Invoice Number
     C                     MOVELBECEST    $CCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $CAWDT           Invoice Date
     C                     MOVELBEJPCD    $CJPCD           Event Code
     C                     MOVELBEXUST    $CXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $CZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $CVRVA           A/R order Value
     C                     MOVELBEOBST    $COBST           Billing Activit
     C                     MOVELBEBCST    $CBCST           Block Order Fla
     C                     MOVELBEBDST    $CBDST           Order Certifica
     C                     Z-ADDBEB7VL    $CB7VL           Invoice Order V
     C                     MOVELBEGASX    $CGASX           Process Sts for
     C                     MOVELBEGBSX    $CGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $CGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $CGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $CFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $CFOSX           Email Cust On O
     C                     MOVELBEFPSX    $CFPSX           Order Emailed
     C                     MOVELBEFQSX    $CFQSX           Export Docs Go
     C                     MOVELBEFRSX    $CFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $CFSSX           Broker Order St
     C                     MOVELBEFTSX    $CFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $CFUSX           Order Requires
     C                     MOVELBEFVSX    $CFVSX           OH Load Plan Re
     C                     MOVELBEFWSX    $CFWSX           Export USDA App
     C                     MOVELBEFXSX    $CFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $CFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $CNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    $CNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    $CNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    $CNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    $CNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    $CBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $CBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $CBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    $CBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    $CBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    $CH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $CH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $CH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $CH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $CH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $CC0C7           Claim Number
     C                     MOVELBEUVST    $CUVST           EDI Status 1
     C                     MOVELBEUWST    $CUWST           EDI Status 2
     C                     MOVELBEUXST    $CUXST           EDI Status 3
     C                     Z-ADDBEAATM    $CAATM           Job Time
     C                     MOVELBEAYNA    $CAYNA           User Id
     C                     MOVELBEA0NA    $CA0NA           Job Name
     C                     Z-ADDBEAXDT    $CAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Inter-Co Pricing  PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEGNDT    WZA001           Actual Shipped
     C                     Z-ADDBEGNDT    WZA001
     C           *LIKE     DEFN BEAIC3    WZA002           Company Number
     C                     Z-ADDBEAIC3    WZA002
     C           *LIKE     DEFN BEC4NB    WZA003           Order Number
     C                     Z-ADDBEC4NB    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @BFCPV2                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Rtv Customer Type     RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEBKC7    WL0005           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0017    P      Type Code
      * CASE: DB1.Actual Shipped Date LT PAR.From Date             USR
     C           BEGNDT    IFLT P2L9DT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: LCL.Type Code is Inter Company
     C           YL0017    IFEQ 'IC'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * 03/27/17 DN R9700-Match by Inter Company Group.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Alpha Value 2     RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0007           Company Number
     C                     MOVEL@CN,001   WL0008    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0018    P      System Value Al
      * CASE: PAR.Inter Company Group USR NE LCL.Inter Company Group USR
     C           P6GKU1    IFNE YL0018                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Actual Shipped
     C                     MOVEL*BLANK    W0AL01  1        Company Number
     C                     MOVEL*BLANK    W0AL02  1        Order Number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Actual Shipped
     C                     MOVEL'Y'       W0AL01  1        Company Number
     C                     MOVEL'Y'       W0AL02  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           BEGNDT    IFNE WZA001                     Actual Shipped
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BEAIC3    IFNE WZA002                     Company Number
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           BEC4NB    IFNE WZA003                     Order Number
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * CASE: WRK.Record Processed Usr is Yes
     C           WUSOSX    IFEQ 'Y'                        *IF
      * CASE: PAR.Error Report 2 Status Usr is yes
     C           P4YTSX    IFEQ 'Y'                        *IF
      * 04/04/17 DN R9700-Added Inter Company Group as input parm.
      * Setup message data for message
     C                     MOVELYL0001    ZA0003           Inter Company G
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3605' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Inter-Co Pricing  PO: Mainline
      *================================================================
      * Prt Inter-Co Pricing  PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQKB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQKB02           Order Number
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADD$CAIC3    WQKB01           Company Number
     C                     Z-ADD$CC4NB    WQKB02           Order Number
      * Establish starting position
     C           KRSB      SETLL@BGWKL1                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDOMAIC3    $EAIC3           Company Number
     C                     Z-ADDOMC4NB    $EC4NB           Order Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDOMAIC3    $DAIC3           Company Number
     C                     Z-ADDOMC4NB    $DC4NB           Order Number
     C                     Z-ADDOMDPNB    $DDPNB           Order Sequence
     C                     Z-ADDOMUENB    $DUENB           Order Secondary
     C                     MOVEL*BLANK    $DPFTX           Text 1 Length U
     C                     Z-ADDOMHGCD    $DHGCD           Item Code
     C                     MOVELOMG7NA    $DG7NA           Order Desc. Lin
     C                     MOVELOMAJCD    $DAJCD           Warehouse Code
     C                     Z-ADD*ZERO     $DBYWG           Weight Billed
     C                     Z-ADD*ZERO     $DUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     $DF7PR           Transfer Price
     C                     Z-ADD*ZERO     $DF6PR           Freight Rate US
     C                     Z-ADDOMBZPR    $DBZPR           Price Overage O
     C                     Z-ADDOMR1NB    $DR1NB           Rated Freight
     C                     Z-ADDOMATWG    $DATWG           Weight Shipped
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL*BLANK    $DA9NA           Message Line 2
     C                     Z-ADDOMBKC7    $DBKC7           Ship To Custome
     C                     Z-ADDOMCFC7    $DCFC7           Order Group Cod
     C                     MOVELOMGMST    $DGMST           Detail Line Sta
     C                     MOVELOMGNST    $DGNST           Detail Line Sta
     C                     Z-ADDOMMAVA    $DMAVA           Billing Detail
     C                     Z-ADDOMKDVA    $DKDVA           Billing Detail
     C                     Z-ADDOML8VA    $DL8VA           Billing Detail
     C                     Z-ADDOML9VA    $DL9VA           Quantity to Sub
     C                     MOVELOMGTST    $DGTST           Comment Print A
     C                     MOVELOMGVST    $DGVST           Comment Print I
     C                     MOVELOMGUST    $DGUST           Comment Print P
     C                     MOVELOMQFST    $DQFST           Comment Print S
     C                     Z-ADDOMEXDT    $DEXDT           Market Pricing
     C                     MOVELOMLQCD    $DLQCD           Commodity Marke
     C                     MOVELOMRDCD    $DRDCD           Date Method Cod
     C                     MOVELOMQ7CD    $DQ7CD           Price Method Co
     C                     Z-ADDOML6NB    $DL6NB           Contract Number
     C                     MOVELOMU1ST    $DU1ST           Price Status
     C                     Z-ADDOMGIDT    $DGIDT           Pricing Date Us
     C                     MOVELOMCRCD    $DCRCD           U/M - Base Pric
     C                     MOVELOMAGCD    $DAGCD           U/M - Ordered
     C                     MOVELOMRZST    $DRZST           Work Confirm St
     C                     MOVELOMR0ST    $DR0ST           Work Over/Short
     C                     MOVELOMR1ST    $DR1ST           OD Production P
     C                     MOVELOMG8NA    $DG8NA           Order Desc. Lin
     C                     MOVELOMRPCD    $DRPCD           Age Code
     C                     MOVELOMVEST    $DVEST           Palletize
     C                     MOVELOMVGST    $DVGST           Slip Sheet
     C                     MOVELOMAVST    $DAVST           Catch Weight St
     C                     MOVELOMU0ST    $DU0ST           Price Audit
     C                     MOVELOMRFCD    $DRFCD           Price Audit Rea
     C                     MOVELOMFZST    $DFZST           Production Date
     C                     Z-ADDOMAVQT    $DAVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    $DD0WG           Weight Ordered
     C                     Z-ADDOMCCQT    $DCCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    $DAUWG           Weight Schedule
     C                     Z-ADDOMCBQT    $DCBQT           Quantity Shippe
     C                     Z-ADDOMAYVA    $DAYVA           Extended Amount
     C                     Z-ADDOMAQCS    $DAQCS           Unit Cost Prici
     C                     Z-ADDOMAGCS    $DAGCS           Unit Cost Per P
     C                     Z-ADDOMAKPR    $DAKPR           Unit Price
     C                     Z-ADDOMALPR    $DALPR           Unit Price - Cr
     C                     Z-ADDOMAUPR    $DAUPR           Unit Price Orde
     C                     Z-ADDOMAVWG    $DAVWG           Unit Weight Ord
     C                     Z-ADDOMA4WG    $DA4WG           Tare Weight Tot
     C                     Z-ADDOMA5DT    $DA5DT           Requested Ship
     C                     Z-ADDOMAODT    $DAODT           Scheduled Ship
     C                     Z-ADDOMGNDT    $DGNDT           Actual Shipped
     C                     MOVELOMAMST    $DAMST           Affect Inventor
     C                     MOVELOMANST    $DANST           Affect Sales Do
     C                     MOVELOMVAST    $DVAST           Affect Sales Pn
     C                     Z-ADDOMRGNB    $DRGNB           Item Structure
     C                     Z-ADDOMRHNB    $DRHNB           Item Structure
     C                     Z-ADDOMRINB    $DRINB           Item Structure
     C                     MOVELOMRBCD    $DRBCD           Item Level
     C                     MOVELOMHICD    $DHICD           Quality Level
     C                     MOVELOMRNCD    $DRNCD           Pricing Product
     C                     MOVELOMROCD    $DROCD           Season Product
     C                     Z-ADDOMCXDT    $DCXDT           Date of Origina
     C                     MOVELOMAJVN    $DAJVN           User Profile Na
     C                     MOVELOMKXCD    $DKXCD           Country Code
     C                     MOVELOMJPCD    $DJPCD           Event Code
     C                     MOVELOMCQCD    $DCQCD           Reason Code
     C                     MOVELOMR4CD    $DR4CD           Sales Route Cod
     C                     MOVELOMZ1ST    $DZ1ST           Modified Flag
     C                     MOVELOMZ3ST    $DZ3ST           Substituted Fla
     C                     MOVELOMZ4ST    $DZ4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    $DDUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    $DB6VL           Invoice Extende
     C                     Z-ADDOMA1AA    $DA1AA           Ham Group Numbe
     C                     MOVELOMFZSX    $DFZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    $DF0SX           Affect Trade Fu
     C                     MOVELOMF1SX    $DF1SX           Affect Commissi
     C                     MOVELOMF2SX    $DF2SX           Affect Pricing
     C                     MOVELOMF3SX    $DF3SX           Released by Use
     C                     MOVELOMF4SX    $DF4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    $DF5SX           OD Pallet Type
     C                     MOVELOMF6SX    $DF6SX           Production Ware
     C                     MOVELOMF7SX    $DF7SX           OD Price Type
     C                     Z-ADDOMNTDT    $DNTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    $DNUDT           Consumed Item C
     C                     Z-ADDOMNVDT    $DNVDT           Deadline Depart
     C                     Z-ADDOMNWDT    $DNWDT           OD Price Type R
     C                     Z-ADDOMNXDT    $DNXDT           OD Firm Date
     C                     Z-ADDOMBUTM    $DBUTM           Deadline Depart
     C                     Z-ADDOMBVTM    $DBVTM           Price Code
     C                     Z-ADDOMBWTM    $DBWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    $DBXTM           Substitution Li
     C                     Z-ADDOMBYTM    $DBYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    $DH5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    $DH6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    $DH7NX           OD Item Target
     C                     Z-ADDOMH8NX    $DH8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    $DH9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    $DDVPR           Order Gate/Fina
     C                     Z-ADDOMDWPR    $DDWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    $DDXPR           OD Gate/Final P
     C                     Z-ADDOMDYPR    $DDYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    $DDZPR           OD Original Ord
     C                     Z-ADDOMGSPR    $DGSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    $DGTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    $DGUPR           OD Unused Prc 8
     C                     MOVELOMHOST    $DHOST           OD MPR Sent to
     C                     MOVELOMHPST    $DHPST           OD MPR Prc Read
     C                     MOVELOMIOST    $DIOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    $DPEWG           Weight Amount E
     C                     Z-ADDOMRINY    $DRINY           Item Age Days
     C                     Z-ADDOMTIDT    $DTIDT           Production Ovr
     C                     Z-ADDOMTJDT    $DTJDT           Production Ovr
     C                     MOVELOMH2ST    $DH2ST           OD Spot Buy
     C                     MOVELOMH0ST    $DH0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    $DH1ST           Order Line Erro
     C                     Z-ADDOMTKDT    $DTKDT           OD Market Begin
     C                     Z-ADDOMTLDT    $DTLDT           OD Market Endin
     C                     Z-ADDOMTMDT    $DTMDT           OD Atch to Ord
     C                     MOVELOMUVST    $DUVST           EDI Status 1
     C                     MOVELOMUWST    $DUWST           EDI Status 2
     C                     MOVELOMUXST    $DUXST           EDI Status 3
     C                     Z-ADDOMAATM    $DAATM           Job Time
     C                     MOVELOMAYNA    $DAYNA           User Id
     C                     MOVELOMA0NA    $DA0NA           Job Name
     C                     Z-ADDOMAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN OMAIC3    WZB001           Company Number
     C                     Z-ADDOMAIC3    WZB001
     C           *LIKE     DEFN OMC4NB    WZB002           Order Number
     C                     Z-ADDOMC4NB    WZB002
     C           *LIKE     DEFN OMDPNB    WZB003           Order Sequence
     C                     Z-ADDOMDPNB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BGWKL1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * EXC: Cancelled Items
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Order Sequence
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     ELSE
      * Next record - Detect level breaks
     C           OMAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           OMC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           OMDPNB    IFNE WZB003                     Order Sequence
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * S00687 For CWG that use JLC change OH to NEED price audit   2/18/
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0016    IFEQ 'Y'                        *IF
      * CHG Price Audit        CH - Order Header TRG  * 
     C                     EXSR SRCHRC
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$EKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Inter-Co Price/UpdPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Inter-Co Price/UpdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Actual Shipped Date of Prt Inter-Co Price/UpdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Company Number of Prt Inter-Co Price/UpdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Order Number of Prt Inter-Co Price/UpdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of Prt Inter-Co Price/UpdPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'N'       WUTAST           First Time Flag
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SERVGN
      * 05/08/18 DN R12926-At Order level, use Absorbed Freight Rate from
      *    Commented out case below to no longer update the AFR in OH.
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAIC3    WL0001           Company Number
     C                     Z-ADD$CBKC7    WL0002           Ship To Custome
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    $CBOCD    P      Type Code
     C                     Z-ADDWL0004    YN0003           Absorbed Freigh
     C                     MOVEL'Y'       WUSOSX           Record Processe
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $CGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCGNDT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Inter-Co Pricing  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of Prt Inter-Co Pricing  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of Prt Inter-Co Pricing  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Sequence Number of Prt Inter-Co Pricing  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of Prt Inter-Co Pricing  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * 03/28/17 DN R9700-Added Inter Company Group Flag as Input Parm.
      * Rtv 3rd Party Cnfrmd  RT - Order Detail  * 
     C                     EXSR SGRVGN
     C                     Z-ADD*ZERO     $DF7PR           Transfer Price
     C           $CTBNB    DIV  100       $DF6PR    H      Freight Rate US
     C                     Z-ADDP3MADT    YL0005           Actual Shipped
      * S00687 - 2/17/09 RMC Use JLC Price always, dont use 3rd party sal
      * FP1110 - 3/18/08 RMC Read Item Groups for TP Sales to see if
      *   the item's sales should be group with other item(s). if group r
      *  are found, then accum the sales for the date range for all the g
      * items, then calc the % of sales that were to 3rd party customers.
      *  if the % sales to 3rd party < the % in the item group file,
      *  then get the Jacobsen Letter Chicago from the commod price file
      *  the SATURDAY following the act ship date. if not found force pri
      *  If act ship is Saturday, use that date for the comm mkt price da
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SJRVGN
      * 04/03/17 DN R9700-Created Array PAR to add Inter Company Group Fl
      * Rtv to CLC TP Sales   RT - Item Groups for TP Sales  * 
     C                     EXSR SKRVGN
     C                     Z-ADDYL0008    $DBYWG           Weight Billed
     C                     Z-ADDYL0009    $DUSVA           FOB Gross Amoun
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL*BLANK    $DA9NA           Message Line 2
      * CASE: CUR.Weight Shipped Total is Greater than zero
     C           $DATWG    IFGT *ZERO                      *IF
      * CASE: CUR.Price Method Code is Not Manual
     C           $DQ7CD    IFNE 'MAN'                      *IF
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL@CN,002   $DA8NA           Message Line 1
     C                     Z-ADD1         ZQ      50
     C           $DA8NA    CAT  @CN,003:ZQ$DA8NA    P      Message Line 1
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,005:ZQ$DA9NA    P      Message Line 2
     C                     MOVEL'Y'       P4YTSX           Error Report 2
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate CUR.Transfer Price USR and Update the Order Detail
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : LCL.Weight Billed is Greater than zero
      *   |- c2    : PAR.Use Calcd Avg price Y/N is Yes
      *   |- c3    : PAR.Use Calcd Avg price Y/N is Jacobsen Letter Chica
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFGT *ZERO                      *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WN0001    IFEQ 'Y'                        *IF
     C           WN0001    OREQ 'J'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Use Calc'd Avg Price or Jacobsen Letter Charge   4/23/08
      * CASE: PAR.Use Calcd Avg price Y/N is Yes
     C           WN0001    IFEQ 'Y'                        *IF
     C           YL0009    DIV  YL0008    $DF7PR    H      Transfer Price
      * Add freight if not Collect to get Price Overage Override
      * CASE: PAR.Shipping Method is Collect Truck
     C           $CQ2CD    IFEQ 'CT'                       *IF
     C                     Z-ADD$DF7PR    $DBZPR           Price Overage O
     C                     ELSE
      * CASE: *OTHERWISE
     C           $DF7PR    ADD  $DF6PR    $DBZPR           Price Overage O
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Use Calcd Avg price Y/N is Jacobsen Letter Chicago
     C           WN0001    IFEQ 'J'                        *IF
      * (freight is already considered in this price)
     C                     Z-ADDYL0007    $DF7PR           Transfer Price
     C                     Z-ADD$DF7PR    $DBZPR           Price Overage O
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL@CN,006   $DA8NA           Message Line 1
      * W97198 DN 04/11/22-If Company is 440, Change Msg Line1 to Jacobse
      * CASE: CUR.Company Number is Seaboard Triumph Foods
     C           $DAIC3    IFEQ 440                        *IF
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL@CN,007   $DA8NA           Message Line 1
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Determine ...
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Price Overage Override is Not Zeros
      *   |- c2    : CUR.Price Overage Override NE DB1.Price Overage Over
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMBZPR    IFNE *ZERO                      *IF
     C           $DBZPR    IFNE OMBZPR                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADDOMBZPR    ZA0001           Price Overage O
      * Retrieve message Fmt Price Override
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3604' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           $DA8NA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * ***** UPDATE ORDER DETAIL WITH PRICE OVERAGE OVERRIDE ******
      * CASE: PAR.Type of Run - TF Prc Usr is Update Run
     C           P5YVSX    IFEQ 'U'                        *IF
      * CHG Price Override     CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DC4NB    WL0019           Order Number
     C                     Z-ADD$DDPNB    WL0020           Order Sequence
     C                     Z-ADD$DUENB    WL0021           Order Secondary
     C                     Z-ADD$DBZPR    WL0022           Price Overage O
     C                     EXSR SQCHRC
      * CLC Price Information XF - Order Detail  * 
     C                     CALL 'PPUUXFR'              90  CLC Price Infor
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DAIC3    WQ0011  30       Company Number
     C                     PARM $DC4NB    WQ0012  70       Order Number
     C                     PARM $DDPNB    WQ0013  30       Order Sequence
     C                     PARM $DUENB    WQ0014  30       Order Secondary
     C                     PARM $DHGCD    WQ0015  70       Item Code
     C                     PARM $DAJCD    WQ0016  3        Warehouse Code
     C                     PARM $DBKC7    WQ0017  70       Ship To Custome
     C                     PARM $DCFC7    WQ0018  70       Order Group Cod
     C                     PARM $DGMST    WQ0019  1        Detail Line Sta
     C                     PARM $DGNST    WQ0020  1        Detail Line Sta
     C                     PARM $DMAVA    WQ0021 112       Billing Detail
     C                     PARM $DKDVA    WQ0022 112       Billing Detail
     C                     PARM $DL8VA    WQ0023 112       Billing Detail
     C                     PARM $DL9VA    WQ0024 112       Quantity to Sub
     C                     PARM $DGTST    WQ0025  1        Comment Print A
     C                     PARM $DGVST    WQ0026  1        Comment Print I
     C                     PARM $DGUST    WQ0027  1        Comment Print P
     C                     PARM $DQFST    WQ0028  1        Comment Print S
     C           $DAYVA    PARM $DAYVA    WQ0029 112       Extended Amount
     C                     PARM $DEXDT    WQ0030  70       Market Pricing
     C                     PARM $DLQCD    WQ0031  3        Commodity Marke
     C                     PARM $DRDCD    WQ0032  3        Date Method Cod
     C                     PARM $DQ7CD    WQ0033  3        Price Method Co
     C                     PARM $DBZPR    WQ0034 114       Price Overage O
     C                     PARM $DL6NB    WQ0035  70       Contract Number
     C                     PARM $DU1ST    WQ0036  1        Price Status
     C                     PARM $DGIDT    WQ0037  70       Pricing Date Us
     C                     PARM $DCRCD    WQ0038  2        U/M - Base Pric
     C                     PARM $DAGCD    WQ0039  2        U/M - Ordered
     C                     PARM $DRZST    WQ0040  1        Work Confirm St
     C                     PARM $DR0ST    WQ0041  1        Work Over/Short
     C                     PARM $DR1ST    WQ0042  1        OD Production P
     C                     PARM $DG7NA    WQ0043 30        Order Desc. Lin
     C                     PARM $DG8NA    WQ0044 30        Order Desc. Lin
     C                     PARM $DRPCD    WQ0045  1        Age Code
     C                     PARM $DVEST    WQ0046  1        Palletize
     C                     PARM $DVGST    WQ0047  1        Slip Sheet
     C                     PARM $DAVST    WQ0048  1        Catch Weight St
     C                     PARM $DU0ST    WQ0049  1        Price Audit
     C                     PARM $DRFCD    WQ0050  3        Price Audit Rea
     C                     PARM $DFZST    WQ0051  1        Production Date
     C                     PARM $DR1NB    WQ0052 112       Rated Freight
     C                     PARM $DAVQT    WQ0053 112       Quantity Ordere
     C                     PARM $DD0WG    WQ0054 112       Weight Ordered
     C                     PARM $DCCQT    WQ0055 112       Quantity Schedu
     C                     PARM $DAUWG    WQ0056 112       Weight Schedule
     C                     PARM $DCBQT    WQ0057 112       Quantity Shippe
     C                     PARM $DATWG    WQ0058 112       Weight Shipped
     C                     PARM $DAQCS    WQ0059 114       Unit Cost Prici
     C                     PARM $DAGCS    WQ0060 114       Unit Cost Per P
     C           $DAKPR    PARM $DAKPR    WQ0061 114       Unit Price
     C           $DALPR    PARM $DALPR    WQ0062 114       Unit Price - Cr
     C           $DAUPR    PARM $DAUPR    WQ0063 114       Unit Price Orde
     C                     PARM $DAVWG    WQ0064 112       Unit Weight Ord
     C                     PARM $DA4WG    WQ0065 112       Tare Weight Tot
     C                     PARM $DA5DT    WQ0066  70       Requested Ship
     C                     PARM $DAODT    WQ0067  70       Scheduled Ship
     C                     PARM $DGNDT    WQ0068  70       Actual Shipped
     C                     PARM $DAMST    WQ0069  1        Affect Inventor
     C                     PARM $DANST    WQ0070  1        Affect Sales Do
     C                     PARM $DVAST    WQ0071  1        Affect Sales Pn
     C                     PARM $DRGNB    WQ0072  30       Item Structure
     C                     PARM $DRHNB    WQ0073  30       Item Structure
     C                     PARM $DRINB    WQ0074  30       Item Structure
     C                     PARM $DRBCD    WQ0075  2        Item Level
     C                     PARM $DHICD    WQ0076  2        Quality Level
     C                     PARM $DRNCD    WQ0077  2        Pricing Product
     C                     PARM $DROCD    WQ0078  2        Season Product
     C                     PARM $DCXDT    WQ0079  70       Date of Origina
     C                     PARM $DAJVN    WQ0080 10        User Profile Na
     C                     PARM $DKXCD    WQ0081  6        Country Code
     C                     PARM $DJPCD    WQ0082  2        Event Code
     C                     PARM $DCQCD    WQ0083  3        Reason Code
     C                     PARM $DR4CD    WQ0084  3        Sales Route Cod
     C                     PARM $DZ1ST    WQ0085  1        Modified Flag
     C                     PARM $DZ3ST    WQ0086  1        Substituted Fla
     C                     PARM $DZ4ST    WQ0087  1        OD Schedule Ove
     C                     PARM $DDUPR    WQ0088 114       Invoice Unit Pr
     C                     PARM $DB6VL    WQ0089 112       Invoice Extende
     C                     PARM $DA1AA    WQ0090  30       Ham Group Numbe
     C                     PARM $DFZSX    WQ0091  1        OD Adj Type Ove
     C                     PARM $DF0SX    WQ0092  1        Affect Trade Fu
     C                     PARM $DF1SX    WQ0093  1        Affect Commissi
     C                     PARM $DF2SX    WQ0094  1        Affect Pricing
     C                     PARM $DF3SX    WQ0095  1        Released by Use
     C                     PARM $DF4SX    WQ0096  2        Ord TF Exempt C
     C                     PARM $DF5SX    WQ0097  2        OD Pallet Type
     C                     PARM $DF6SX    WQ0098  3        Production Ware
     C                     PARM $DF7SX    WQ0099  3        OD Price Type
     C                     PARM $DNTDT    WQ0100  70       Warehouse Palle
     C                     PARM $DNUDT    WQ0101  70       Consumed Item C
     C                     PARM $DNVDT    WQ0102  70       Deadline Depart
     C                     PARM $DNWDT    WQ0103  70       OD Price Type R
     C                     PARM $DNXDT    WQ0104  70       OD Firm Date
     C                     PARM $DBUTM    WQ0105  60       Deadline Depart
     C                     PARM $DBVTM    WQ0106  60       Price Code
     C                     PARM $DBWTM    WQ0107  60       Maximum Net Wei
     C                     PARM $DBXTM    WQ0108  60       Substitution Li
     C                     PARM $DBYTM    WQ0109  60       Max Qty to sche
     C                     PARM $DH5NX    WQ0110 112       Warehouse Palle
     C                     PARM $DH6NX    WQ0111 112       Warehouse Avg P
     C                     PARM $CBOCD    WQ0112  2        Type Code
     C                     PARM YL0002    WQ0113  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPUUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $DBZPR           Price Overage O
      * CASE:
      *  - (c1 AND c2 AND c3) OR (c4 AND c5)
      *   |- c1    : DB1.Price Overage Override is Not Zeros
      *   |- c2    : PAR.Use Calcd Avg price Y/N is Jacobsen Letter Chica
      *   |- c3    : DB1.Price Overage Override NE LCL.Commodity Market P
      *   |- c4    : DB1.Price Overage Override is Not Zeros
      *   |- c5    : PAR.Use Calcd Avg price Y/N is Not Jacobsen
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMBZPR    IFNE *ZERO                      *IF
     C           WN0001    IFEQ 'J'                        *IF
     C           OMBZPR    IFNE YL0007                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           OMBZPR    IFNE *ZERO                      *IF
     C           WN0001    IFEQ 'N'                        *IF
     C           WN0001    OREQ 'Y'
     C           WN0001    OREQ 'M'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * **override price in the price audit. because no 3rd party sales
      * Setup message data for message
     C                     Z-ADDOMBZPR    ZA0002           Price Overage O
      * Retrieve message Fmt Price Override
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3604' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           $DA8NA    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * Use Jacobsen Letter Charge if "J" else **Unable to price **  4/23
      * CASE: PAR.Use Calcd Avg price Y/N is Jacobsen Letter Chicago
     C           WN0001    IFEQ 'J'                        *IF
     C                     Z-ADDYL0007    $DF7PR           Transfer Price
     C                     Z-ADD$DF7PR    $DBZPR           Price Overage O
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL@CN,006   $DA8NA           Message Line 1
      * W97198 DN 04/11/22-If Company is 440, Change Msg Line1 to Jacobse
      * CASE: CUR.Company Number is Seaboard Triumph Foods
     C           $DAIC3    IFEQ 440                        *IF
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL@CN,007   $DA8NA           Message Line 1
     C                     END                             *FI
      * ***** UPDATE ORDER DETAIL WITH PRICE OVERAGE OVERRIDE ******
      * CASE: PAR.Type of Run - TF Prc Usr is Update Run
     C           P5YVSX    IFEQ 'U'                        *IF
      * CHG Price Override     CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DC4NB    WL0019           Order Number
     C                     Z-ADD$DDPNB    WL0020           Order Sequence
     C                     Z-ADD$DUENB    WL0021           Order Secondary
     C                     Z-ADD$DBZPR    WL0022           Price Overage O
     C                     EXSR SQCHRC
      * CLC Price Information XF - Order Detail  * 
     C                     CALL 'PPUUXFR'              90  CLC Price Infor
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DAIC3    WQ0114  30       Company Number
     C                     PARM $DC4NB    WQ0115  70       Order Number
     C                     PARM $DDPNB    WQ0116  30       Order Sequence
     C                     PARM $DUENB    WQ0117  30       Order Secondary
     C                     PARM $DHGCD    WQ0118  70       Item Code
     C                     PARM $DAJCD    WQ0119  3        Warehouse Code
     C                     PARM $DBKC7    WQ0120  70       Ship To Custome
     C                     PARM $DCFC7    WQ0121  70       Order Group Cod
     C                     PARM $DGMST    WQ0122  1        Detail Line Sta
     C                     PARM $DGNST    WQ0123  1        Detail Line Sta
     C                     PARM $DMAVA    WQ0124 112       Billing Detail
     C                     PARM $DKDVA    WQ0125 112       Billing Detail
     C                     PARM $DL8VA    WQ0126 112       Billing Detail
     C                     PARM $DL9VA    WQ0127 112       Quantity to Sub
     C                     PARM $DGTST    WQ0128  1        Comment Print A
     C                     PARM $DGVST    WQ0129  1        Comment Print I
     C                     PARM $DGUST    WQ0130  1        Comment Print P
     C                     PARM $DQFST    WQ0131  1        Comment Print S
     C           $DAYVA    PARM $DAYVA    WQ0132 112       Extended Amount
     C                     PARM $DEXDT    WQ0133  70       Market Pricing
     C                     PARM $DLQCD    WQ0134  3        Commodity Marke
     C                     PARM $DRDCD    WQ0135  3        Date Method Cod
     C                     PARM $DQ7CD    WQ0136  3        Price Method Co
     C                     PARM $DBZPR    WQ0137 114       Price Overage O
     C                     PARM $DL6NB    WQ0138  70       Contract Number
     C                     PARM $DU1ST    WQ0139  1        Price Status
     C                     PARM $DGIDT    WQ0140  70       Pricing Date Us
     C                     PARM $DCRCD    WQ0141  2        U/M - Base Pric
     C                     PARM $DAGCD    WQ0142  2        U/M - Ordered
     C                     PARM $DRZST    WQ0143  1        Work Confirm St
     C                     PARM $DR0ST    WQ0144  1        Work Over/Short
     C                     PARM $DR1ST    WQ0145  1        OD Production P
     C                     PARM $DG7NA    WQ0146 30        Order Desc. Lin
     C                     PARM $DG8NA    WQ0147 30        Order Desc. Lin
     C                     PARM $DRPCD    WQ0148  1        Age Code
     C                     PARM $DVEST    WQ0149  1        Palletize
     C                     PARM $DVGST    WQ0150  1        Slip Sheet
     C                     PARM $DAVST    WQ0151  1        Catch Weight St
     C                     PARM $DU0ST    WQ0152  1        Price Audit
     C                     PARM $DRFCD    WQ0153  3        Price Audit Rea
     C                     PARM $DFZST    WQ0154  1        Production Date
     C                     PARM $DR1NB    WQ0155 112       Rated Freight
     C                     PARM $DAVQT    WQ0156 112       Quantity Ordere
     C                     PARM $DD0WG    WQ0157 112       Weight Ordered
     C                     PARM $DCCQT    WQ0158 112       Quantity Schedu
     C                     PARM $DAUWG    WQ0159 112       Weight Schedule
     C                     PARM $DCBQT    WQ0160 112       Quantity Shippe
     C                     PARM $DATWG    WQ0161 112       Weight Shipped
     C                     PARM $DAQCS    WQ0162 114       Unit Cost Prici
     C                     PARM $DAGCS    WQ0163 114       Unit Cost Per P
     C           $DAKPR    PARM $DAKPR    WQ0164 114       Unit Price
     C           $DALPR    PARM $DALPR    WQ0165 114       Unit Price - Cr
     C           $DAUPR    PARM $DAUPR    WQ0166 114       Unit Price Orde
     C                     PARM $DAVWG    WQ0167 112       Unit Weight Ord
     C                     PARM $DA4WG    WQ0168 112       Tare Weight Tot
     C                     PARM $DA5DT    WQ0169  70       Requested Ship
     C                     PARM $DAODT    WQ0170  70       Scheduled Ship
     C                     PARM $DGNDT    WQ0171  70       Actual Shipped
     C                     PARM $DAMST    WQ0172  1        Affect Inventor
     C                     PARM $DANST    WQ0173  1        Affect Sales Do
     C                     PARM $DVAST    WQ0174  1        Affect Sales Pn
     C                     PARM $DRGNB    WQ0175  30       Item Structure
     C                     PARM $DRHNB    WQ0176  30       Item Structure
     C                     PARM $DRINB    WQ0177  30       Item Structure
     C                     PARM $DRBCD    WQ0178  2        Item Level
     C                     PARM $DHICD    WQ0179  2        Quality Level
     C                     PARM $DRNCD    WQ0180  2        Pricing Product
     C                     PARM $DROCD    WQ0181  2        Season Product
     C                     PARM $DCXDT    WQ0182  70       Date of Origina
     C                     PARM $DAJVN    WQ0183 10        User Profile Na
     C                     PARM $DKXCD    WQ0184  6        Country Code
     C                     PARM $DJPCD    WQ0185  2        Event Code
     C                     PARM $DCQCD    WQ0186  3        Reason Code
     C                     PARM $DR4CD    WQ0187  3        Sales Route Cod
     C                     PARM $DZ1ST    WQ0188  1        Modified Flag
     C                     PARM $DZ3ST    WQ0189  1        Substituted Fla
     C                     PARM $DZ4ST    WQ0190  1        OD Schedule Ove
     C                     PARM $DDUPR    WQ0191 114       Invoice Unit Pr
     C                     PARM $DB6VL    WQ0192 112       Invoice Extende
     C                     PARM $DA1AA    WQ0193  30       Ham Group Numbe
     C                     PARM $DFZSX    WQ0194  1        OD Adj Type Ove
     C                     PARM $DF0SX    WQ0195  1        Affect Trade Fu
     C                     PARM $DF1SX    WQ0196  1        Affect Commissi
     C                     PARM $DF2SX    WQ0197  1        Affect Pricing
     C                     PARM $DF3SX    WQ0198  1        Released by Use
     C                     PARM $DF4SX    WQ0199  2        Ord TF Exempt C
     C                     PARM $DF5SX    WQ0200  2        OD Pallet Type
     C                     PARM $DF6SX    WQ0201  3        Production Ware
     C                     PARM $DF7SX    WQ0202  3        OD Price Type
     C                     PARM $DNTDT    WQ0203  70       Warehouse Palle
     C                     PARM $DNUDT    WQ0204  70       Consumed Item C
     C                     PARM $DNVDT    WQ0205  70       Deadline Depart
     C                     PARM $DNWDT    WQ0206  70       OD Price Type R
     C                     PARM $DNXDT    WQ0207  70       OD Firm Date
     C                     PARM $DBUTM    WQ0208  60       Deadline Depart
     C                     PARM $DBVTM    WQ0209  60       Price Code
     C                     PARM $DBWTM    WQ0210  60       Maximum Net Wei
     C                     PARM $DBXTM    WQ0211  60       Substitution Li
     C                     PARM $DBYTM    WQ0212  60       Max Qty to sche
     C                     PARM $DH5NX    WQ0213 112       Warehouse Palle
     C                     PARM $DH6NX    WQ0214 112       Warehouse Avg P
     C                     PARM $CBOCD    WQ0215  2        Type Code
     C                     PARM YL0002    WQ0216  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPUUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $DA8NA           Message Line 1
     C                     MOVEL@CN,008   $DA8NA           Message Line 1
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,005:ZQ$DA9NA    P      Message Line 2
     C                     MOVEL'Y'       P4YTSX           Error Report 2
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD.0001     $DBZPR           Price Overage O
      * Update Run    - chg for S00687 2/18/09
      * CASE: PAR.Type of Run - TF Prc Usr is Update Run
     C           P5YVSX    IFEQ 'U'                        *IF
      * CHG Price Override     CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0018           Company Number
     C                     Z-ADD$DC4NB    WL0019           Order Number
     C                     Z-ADD$DDPNB    WL0020           Order Sequence
     C                     Z-ADD$DUENB    WL0021           Order Secondary
     C                     Z-ADD$DBZPR    WL0022           Price Overage O
     C                     EXSR SQCHRC
      * CLC Price Information XF - Order Detail  * 
     C                     CALL 'PPUUXFR'              90  CLC Price Infor
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DAIC3    WQ0217  30       Company Number
     C                     PARM $DC4NB    WQ0218  70       Order Number
     C                     PARM $DDPNB    WQ0219  30       Order Sequence
     C                     PARM $DUENB    WQ0220  30       Order Secondary
     C                     PARM $DHGCD    WQ0221  70       Item Code
     C                     PARM $DAJCD    WQ0222  3        Warehouse Code
     C                     PARM $DBKC7    WQ0223  70       Ship To Custome
     C                     PARM $DCFC7    WQ0224  70       Order Group Cod
     C                     PARM $DGMST    WQ0225  1        Detail Line Sta
     C                     PARM $DGNST    WQ0226  1        Detail Line Sta
     C                     PARM $DMAVA    WQ0227 112       Billing Detail
     C                     PARM $DKDVA    WQ0228 112       Billing Detail
     C                     PARM $DL8VA    WQ0229 112       Billing Detail
     C                     PARM $DL9VA    WQ0230 112       Quantity to Sub
     C                     PARM $DGTST    WQ0231  1        Comment Print A
     C                     PARM $DGVST    WQ0232  1        Comment Print I
     C                     PARM $DGUST    WQ0233  1        Comment Print P
     C                     PARM $DQFST    WQ0234  1        Comment Print S
     C           $DAYVA    PARM $DAYVA    WQ0235 112       Extended Amount
     C                     PARM $DEXDT    WQ0236  70       Market Pricing
     C                     PARM $DLQCD    WQ0237  3        Commodity Marke
     C                     PARM $DRDCD    WQ0238  3        Date Method Cod
     C                     PARM $DQ7CD    WQ0239  3        Price Method Co
     C                     PARM $DBZPR    WQ0240 114       Price Overage O
     C                     PARM $DL6NB    WQ0241  70       Contract Number
     C                     PARM $DU1ST    WQ0242  1        Price Status
     C                     PARM $DGIDT    WQ0243  70       Pricing Date Us
     C                     PARM $DCRCD    WQ0244  2        U/M - Base Pric
     C                     PARM $DAGCD    WQ0245  2        U/M - Ordered
     C                     PARM $DRZST    WQ0246  1        Work Confirm St
     C                     PARM $DR0ST    WQ0247  1        Work Over/Short
     C                     PARM $DR1ST    WQ0248  1        OD Production P
     C                     PARM $DG7NA    WQ0249 30        Order Desc. Lin
     C                     PARM $DG8NA    WQ0250 30        Order Desc. Lin
     C                     PARM $DRPCD    WQ0251  1        Age Code
     C                     PARM $DVEST    WQ0252  1        Palletize
     C                     PARM $DVGST    WQ0253  1        Slip Sheet
     C                     PARM $DAVST    WQ0254  1        Catch Weight St
     C                     PARM $DU0ST    WQ0255  1        Price Audit
     C                     PARM $DRFCD    WQ0256  3        Price Audit Rea
     C                     PARM $DFZST    WQ0257  1        Production Date
     C                     PARM $DR1NB    WQ0258 112       Rated Freight
     C                     PARM $DAVQT    WQ0259 112       Quantity Ordere
     C                     PARM $DD0WG    WQ0260 112       Weight Ordered
     C                     PARM $DCCQT    WQ0261 112       Quantity Schedu
     C                     PARM $DAUWG    WQ0262 112       Weight Schedule
     C                     PARM $DCBQT    WQ0263 112       Quantity Shippe
     C                     PARM $DATWG    WQ0264 112       Weight Shipped
     C                     PARM $DAQCS    WQ0265 114       Unit Cost Prici
     C                     PARM $DAGCS    WQ0266 114       Unit Cost Per P
     C           $DAKPR    PARM $DAKPR    WQ0267 114       Unit Price
     C           $DALPR    PARM $DALPR    WQ0268 114       Unit Price - Cr
     C           $DAUPR    PARM $DAUPR    WQ0269 114       Unit Price Orde
     C                     PARM $DAVWG    WQ0270 112       Unit Weight Ord
     C                     PARM $DA4WG    WQ0271 112       Tare Weight Tot
     C                     PARM $DA5DT    WQ0272  70       Requested Ship
     C                     PARM $DAODT    WQ0273  70       Scheduled Ship
     C                     PARM $DGNDT    WQ0274  70       Actual Shipped
     C                     PARM $DAMST    WQ0275  1        Affect Inventor
     C                     PARM $DANST    WQ0276  1        Affect Sales Do
     C                     PARM $DVAST    WQ0277  1        Affect Sales Pn
     C                     PARM $DRGNB    WQ0278  30       Item Structure
     C                     PARM $DRHNB    WQ0279  30       Item Structure
     C                     PARM $DRINB    WQ0280  30       Item Structure
     C                     PARM $DRBCD    WQ0281  2        Item Level
     C                     PARM $DHICD    WQ0282  2        Quality Level
     C                     PARM $DRNCD    WQ0283  2        Pricing Product
     C                     PARM $DROCD    WQ0284  2        Season Product
     C                     PARM $DCXDT    WQ0285  70       Date of Origina
     C                     PARM $DAJVN    WQ0286 10        User Profile Na
     C                     PARM $DKXCD    WQ0287  6        Country Code
     C                     PARM $DJPCD    WQ0288  2        Event Code
     C                     PARM $DCQCD    WQ0289  3        Reason Code
     C                     PARM $DR4CD    WQ0290  3        Sales Route Cod
     C                     PARM $DZ1ST    WQ0291  1        Modified Flag
     C                     PARM $DZ3ST    WQ0292  1        Substituted Fla
     C                     PARM $DZ4ST    WQ0293  1        OD Schedule Ove
     C                     PARM $DDUPR    WQ0294 114       Invoice Unit Pr
     C                     PARM $DB6VL    WQ0295 112       Invoice Extende
     C                     PARM $DA1AA    WQ0296  30       Ham Group Numbe
     C                     PARM $DFZSX    WQ0297  1        OD Adj Type Ove
     C                     PARM $DF0SX    WQ0298  1        Affect Trade Fu
     C                     PARM $DF1SX    WQ0299  1        Affect Commissi
     C                     PARM $DF2SX    WQ0300  1        Affect Pricing
     C                     PARM $DF3SX    WQ0301  1        Released by Use
     C                     PARM $DF4SX    WQ0302  2        Ord TF Exempt C
     C                     PARM $DF5SX    WQ0303  2        OD Pallet Type
     C                     PARM $DF6SX    WQ0304  3        Production Ware
     C                     PARM $DF7SX    WQ0305  3        OD Price Type
     C                     PARM $DNTDT    WQ0306  70       Warehouse Palle
     C                     PARM $DNUDT    WQ0307  70       Consumed Item C
     C                     PARM $DNVDT    WQ0308  70       Deadline Depart
     C                     PARM $DNWDT    WQ0309  70       OD Price Type R
     C                     PARM $DNXDT    WQ0310  70       OD Firm Date
     C                     PARM $DBUTM    WQ0311  60       Deadline Depart
     C                     PARM $DBVTM    WQ0312  60       Price Code
     C                     PARM $DBWTM    WQ0313  60       Maximum Net Wei
     C                     PARM $DBXTM    WQ0314  60       Substitution Li
     C                     PARM $DBYTM    WQ0315  60       Max Qty to sche
     C                     PARM $DH5NX    WQ0316 112       Warehouse Palle
     C                     PARM $DH6NX    WQ0317 112       Warehouse Avg P
     C                     PARM $CBOCD    WQ0318  2        Type Code
     C                     PARM YL0002    WQ0319  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPUUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * S00687 For CWG that use JLC set flag to change OH to NEED price a
      * CASE: PAR.Use Calcd Avg price Y/N is Jacobsen Letter Chicago
     C           WN0001    IFEQ 'J'                        *IF
     C                     MOVEL'Y'       YL0016           Status Flag 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0016           Status Flag 1
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Inter-Co Price/UpdPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Actual Shipped Date of Prt Inter-Co Price/UpdPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Inter-Co Price/UpdPF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Inter-Co Price/UpdPF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Inter-Co Price/UpdPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Inter-Co Pricing  PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Inter-Co Pricing  PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Inter-Co Pricing  PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of Prt Inter-Co Pricing  PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Inter-Co Pricing  PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * 04/04/17 DN R9700-Commented out & moved/changed below.
      * 04/04/17 DN R9700-Get Inter Company Group Desc & Company Name.
      * CASE: *OTHERWISE
      * RTV Cmp/Dsc by Val/SysVRT - Company Values  * 
     C                     EXSR SCRVGN
     C                     MOVEL$BGLU1    YL0001           Inter Company G
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
     C                     Z-ADDP2L9DT    $BL9DT           From Date
     C                     Z-ADDP3MADT    $BMADT           To Date
      * Convert fields to external form
      * Convert From Date             USR to display format
      * Convert date
     C           1000000   ADD  $BL9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBL9DT
      * Convert To Date               USR to display format
      * Convert date
     C           1000000   ADD  $BMADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBMADT
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  $BF9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBF9DT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUTAST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P5YVSX    IFEQ 'U'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Cmp/Dsc by Val/SysVRT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    $BGLU1           Description
      * Declare restrictor key work fields
     C           *LIKE     DEFN KMV8CD    WQSC01           Company Value C
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Value C
      * Setup key
     C                     MOVEL@CN,001   WQSC01           Company Value C
      * Establish starting position
     C           KRSSC     SETLL@KMREEL                    *
     C           KRSSC     READE@KMREEL                  90*
      * Data record not found
     C   90                MOVEL'USR2221' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.System Value Alpha EQ DB1.System Value Alpha
     C           P6GKU1    IFEQ KMBXTX                     *IF
      * PAR = DB1 By name
     C                     MOVELKMAUNA    $BGLU1           Description
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@KMREEL                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAPTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSE     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Company Organiz
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYJSX    YL0002           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    EOAIC3           Company Number
     C                     Z-ADDWL0002    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Type Code
     C                     Z-ADD*ZERO     WL0004           Absorbed Freigh
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WL0003           Type Code
     C                     Z-ADDEOTBNB    WL0004           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv 3rd Party Cnfrmd  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHGCD    WQSG01           Item Code
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Item Code
     C                     KFLD           WAGNDT           Actual Shipped
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Item Code
      * Setup key
     C                     Z-ADD$DHGCD    WQSG01           Item Code
     C                     Z-ADDP3MADT    WAGNDT           Actual Shipped
      * Establish starting position
     C           KPSSG     SETLL@BGWKG7                    *
     C           KRSSG     READE@BGWKG7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    $DPFTX           Text 1 Length U
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Customer Type     RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABKC7    WL0005           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0003    P      Type Code
      * CASE: LCL.Type Code is 3rd Party Customer
     C           YL0003    IFNE 'IC'                       *IF
      * 03/28/17 DN R9700-Commented out & moved below.
      * 03/28/17 DN R9700-Match by Inter Company Group.
      * CASE: *OTHERWISE
      * RTV Alpha Value 2     RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0007           Company Number
     C                     MOVEL@CN,001   WL0008    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0004    P      System Value Al
      * CASE: PAR.Inter Company Group USR EQ LCL.Inter Company Group USR
     C           P6GKU1    IFEQ YL0004                     *IF
     C                     MOVEL'*'       $DPFTX           Text 1 Length U
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@BGWKG7                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Customer Type     RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSH01           Ship To Custome
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0005    WQSH01           Ship To Custome
      * Establish starting position
     C           KRSSH     SETLL@EOREU0                    *
     C           KRSSH     READE@EOREU0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Type Code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBOCD    WL0006           Type Code
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Alpha Value 2     RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           System Value Al
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0007    WCAIC3           Company Number
     C                     MOVELWL0008    WCV8CD           Company Value C
      * Establish starting position
     C           KRSSI     CHAIN@KMREHC              90    *
      * Data record not found
     C   90                MOVEL'USR2221' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBXTX    WL0009           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           Accounting Comp
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    YL0006           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv to CLC TP Sales   RT - Item Groups for TP Sales  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  52       IGTS Min Sales
     C                     MOVEL*BLANK    WN0003  1        IGTS 3rd Party
     C                     MOVEL*BLANK    WN0004  3        IGTS Commodity
     C                     MOVEL*BLANK    WN0005  7        IGTS Commodity
     C                     Z-ADD*ZERO     WN0006 132       Weight Total 13
     C                     Z-ADD*ZERO     WN0007  30       TP Sales Compan
     C                     MOVEL*BLANK    WN0008  1        TP Sales Compan
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S00687  RMC 2/18/09 use JLC price always, dont use 3rd party sale
     C                     Z-ADD*ZERO     YL0008           Weight Billed
     C                     Z-ADD*ZERO     YL0009           FOB Gross Amoun
      * Weight of all sales for the orig order's COMPANY/items grouped to
      *  * note: IC sales arent invoiced yet, so accum from order dtl wit
     C                     Z-ADD*ZERO     WN0006           Weight Total 13
      * Will be yes if % of 3rd party sales >= % in this file for the ite
      *   Will be "J" if Jacobson Letter Chicago price is to be used
      * & Will be Yes if Item is NOT grouped with other items (ie. not fo
      *    in this file)
     C                     MOVEL'N'       WN0001           Use Calcd Avg p
      * Rtv TP Sales Comp Sel RT - IP Cust Pricing Dtl  * 
     C                     EXSR SLRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHGCD    WQSK01           Item Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Item Code
      * Setup key
     C                     Z-ADD$DHGCD    WQSK01           Item Code
      * Establish starting position
     C           KRSSK     SETLL@DNRERW                    *
     C           KRSSK     READE@DNRERW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3906' W0RTN   7
      * USER: Processing if Data record not found
      * If Item not grouped with others, read hist for that item only
      *  DONT CARE ABOUT COMPANY HERE - READ ALL SALES FOR THE ITEM
      * 04/03/17 DN R9700-Added Inter Company Group Flag as Input Parm.
      * Clc Transfer Price    XF - Sales History  * 
     C                     CALL 'PNKOXFR'              90  Clc Transfer Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DHGCD    WQ0001  70       Shipped Item Co
     C                     PARM YL0005    WQ0002  70       Actual Shipped
     C                     PARM YL0006    WQ0003  30       Company Number
     C           YL0008    PARM YL0008    WQ0004 112       Weight Billed
     C           YL0009    PARM YL0009    WQ0005 112       FOB Gross Amoun
     C                     PARM $DAIC3    WQ0006  30       Shipping Compan
     C                     PARM P2L9DT    WQ0007  70       Date From
     C                     PARM P3MADT    WQ0008  70       Date To
     C                     PARM $DBKC7    WQ0009  70       Ship To Custome
     C                     PARM P6GKU1    WQ0010  1        Inter Company G
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WN0001           Use Calcd Avg p
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Accum Sales History records from all items grouped with the input
      *  DO CARE ABOUT COMPANY HERE - READ ALL SALES FOR THE ORDER'S COMP
      * Skip InterCompany Sales Agreement records (IS)    FP1314
      * 04/04/17 DN R9700-Added Inter Company Group Flag as Input Parm.
      * Clc Transfer Prc-grps RT - Sales History  * 
     C                     EXSR SMRVGN
      * Get Inter-company sales for the week that arent invoiced yet, but
      * RTV IC by Itm cnfrmd  RT - Order Detail  * 
     C                     EXSR SNRVGN
     C                     ADD  YL0011    WN0006           Weight Total 13
     C                     Z-ADDWDGQPC    WN0002           IGTS Min Sales
     C                     MOVELWDAVGA    WN0003           IGTS 3rd Party
     C                     MOVELWDJUAA    WN0004           IGTS Commodity
     C                     MOVELWDJVAA    WN0005           IGTS Commodity
     C           KRSSK     READE@DNRERW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Weight Total 13.2     USR is Not Equal to Zero
     C           WN0006    IFNE 0                          *IF
      * CASE: PAR.IGTS 3rd Party Price Type is Average
     C           WN0003    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       WN0001           Use Calcd Avg p
     C                     ELSE
      * CASE: PAR.IGTS 3rd Party Price Type is Avg/Mkt w/Min Volume
     C           WN0003    IFEQ 'V'                        *IF
      * Compute:% 3rd party sales
      * LCL.Percent 7.4 USR =
      *    *COMPUTE (x1 / x2 *x3)
      * x1    : PAR.Weight Billed
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Weight Total 13.2     USR
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  WN0006    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           Percent 7.4 USR
      * 3rd Party Average or Commodity Market Price
      * CASE: PAR.IGTS Min Sales Volume Pct is Greater than zero
     C           WN0002    IFGT 0                          *IF
      * CASE: LCL.Percent 7.4 USR GE PAR.IGTS Min Sales Volume Pct
     C           YL0012    IFGE WN0002                     *IF
     C                     MOVEL'Y'       WN0001           Use Calcd Avg p
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.IGTS Commodity Market is Jacobsen Letter Chicago
     C           WN0004    IFEQ 'JLC'                      *IF
     C                     MOVEL'J'       WN0001           Use Calcd Avg p
      * RTV Next Saturday      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0010           Company Number
     C                     Z-ADDYL0005    WL0011           Post to G/L Dat
     C                     Z-ADDYL0013    WL0012           Scheduled Ship
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    YL0013           Scheduled Ship
      * W97198 DN 04/11/22-Moved 'RTV Market Price       RT' Below.
      * W97198 DN 04/11/22-If Co 440, Use 'JLX' to Get Market Price for S
      * CASE: PAR.Company Number is Seaboard Triumph Foods
     C           $DAIC3    IFEQ 440                        *IF
     C                     MOVEL'JLX'     YL0014           IGTS Commodity
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'JLC'     YL0014           IGTS Commodity
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0014    WL0013    P      Commodity Marke
     C                     MOVELWN0005    WL0014    P      Commodity Price
     C                     Z-ADDYL0013    WL0015           Market Price Da
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    YL0007           Commodity Marke
     C                     Z-ADDWL0017    YL0015           USR Date Priced
      * Cannot price if saturday market price not found
      * CASE: LCL.Market Price Date NE LCL.USR Date Priced
     C           YL0013    IFNE YL0015                     *IF
     C                     MOVEL'N'       WN0001           Use Calcd Avg p
     C                     Z-ADD*ZERO     YL0007           Commodity Marke
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0001           Use Calcd Avg p
     C                     Z-ADD*ZERO     YL0007           Commodity Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.IGTS 3rd Party Price Type is Market Price
     C           WN0003    IFEQ 'M'                        *IF
      * Commodity Market Price
      * CASE: PAR.IGTS Commodity Market is Jacobsen Letter Chicago
     C           WN0004    IFEQ 'JLC'                      *IF
     C                     MOVEL'J'       WN0001           Use Calcd Avg p
      * RTV Next Saturday      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0010           Company Number
     C                     Z-ADDYL0005    WL0011           Post to G/L Dat
     C                     Z-ADDYL0013    WL0012           Scheduled Ship
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    YL0013           Scheduled Ship
      * W97198 DN 04/11/22-Moved 'RTV Market Price       RT' Below.
      * W97198 DN 04/11/22-If Co 440, Use 'JLX' to Get Market Price for S
      * CASE: PAR.Company Number is Seaboard Triumph Foods
     C           $DAIC3    IFEQ 440                        *IF
     C                     MOVEL'JLX'     YL0014           IGTS Commodity
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'JLC'     YL0014           IGTS Commodity
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0014    WL0013    P      Commodity Marke
     C                     MOVELWN0005    WL0014    P      Commodity Price
     C                     Z-ADDYL0013    WL0015           Market Price Da
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    YL0007           Commodity Marke
     C                     Z-ADDWL0017    YL0015           USR Date Priced
      * Cannot price if saturday market price not found
      * CASE: LCL.Market Price Date NE LCL.USR Date Priced
     C           YL0013    IFNE YL0015                     *IF
     C                     MOVEL'N'       WN0001           Use Calcd Avg p
     C                     Z-ADD*ZERO     YL0007           Commodity Marke
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0001           Use Calcd Avg p
     C                     Z-ADD*ZERO     YL0007           Commodity Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv TP Sales Comp Sel RT - IP Cust Pricing Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           F4BKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DBKC7    F4BKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@F4REFS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4283' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0007           TP Sales Compan
     C                     MOVEL*BLANK    WN0008           TP Sales Compan
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDF4CXC3    WN0007           TP Sales Compan
     C                     MOVELF4LQST    WN0008           TP Sales Compan
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Clc Transfer Prc-grps RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WES5NB    WQSM01           Shipped Item Co
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Shipped Item Co
     C                     KFLD           WEGNDT           Actual Shipped
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Shipped Item Co
      * Setup key
     C                     Z-ADDWDERC7    WQSM01           Shipped Item Co
     C                     Z-ADDYL0005    WEGNDT           Actual Shipped
      * Establish starting position
     C           KPSSM     SETLL@HSTPEW                    *
     C           KRSSM     READE@HSTPEW                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * EOF:  Actual Ship Date LT "FROM DATE"
      * CASE: DB1.Actual Shipped Date LT PAR.Date From             USR
     C           WEGNDT    IFLT P2L9DT                     *IF
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
      * OMT:  Exempt Items
      * CASE: DB1.Order TF Exempt Code is Exempt Items
     C           WEIUSX    IFEQ 'EC'                       *IF
     C           WEIUSX    OREQ 'EP'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Accumulating the volume with IC and without IC later
      *      See PRC:  Record Selected
      * OMT:  IC Group S (440) If IC Group G (360/960) or vice-versa.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Alpha Value 2     RT - Company Values  * Get Company IC Group
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0007           Company Number
     C                     MOVEL@CN,001   WL0008    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0010    P      System Value Al
      * CASE: PAR.Inter Company Group USR NE LCL.Inter Company Group USR
     C           P6GKU1    IFNE YL0010                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Accounting Company
      * CASE: PAR.TP Sales Company is Select Company
     C           WN0008    IFEQ 'S'                        *IF
      * CASE: PAR.TP Sales Company Select is greater than zero
     C           WN0007    IFGT 0                          *IF
      * CASE: DB1.Company Number NE PAR.TP Sales Company Select
     C           WEAIC3    IFNE WN0007                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.TP Sales Company is Order Accounting Company
     C           WN0008    IFEQ 'O'                        *IF
      * CASE: DB1.Company Number NE PAR.Company Number
     C           WEAIC3    IFNE YL0006                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * OMT:  Type Code = InterCo Sales Agreement   FP1314
      * CASE: DB1.Type Code is Inter-Comp Sales Agreemnt
     C           WEBOCD    IFEQ 'IS'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * PRC:  Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * If IGTS Combine Sls all itms is yes- accum weight for ALL sales
      * CASE: PAR.IGTS Combine Sls all itms is yes
     C           WDSLSA    IFEQ 'Y'                        *IF
     C                     ADD  WEBYWG    WN0006           Weight Total 13
     C                     END                             *FI
      * Accum: Type Code = Third Party separately
      * CASE: DB1.Type Code is 3rd Party Customer
     C           WEBOCD    IFNE 'IC'                       *IF
     C                     ADD  WEBYWG    YL0008           Weight Billed
     C                     ADD  WEUSVA    YL0009           FOB Gross Amoun
      * If IGTS Combine Sls all itms is no, accum TP sales only
      * CASE: PAR.IGTS Combine Sls all itms is no
     C           WDSLSA    IFEQ 'N'                        *IF
     C                     ADD  WEBYWG    WN0006           Weight Total 13
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@HSTPEW                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV IC by Itm cnfrmd  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 4/09/08 Read original order's company sales only! per matt jo
     C                     Z-ADD*ZERO     YL0011           USR Weight Bill
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHGCD    WQSN01           Item Code
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Item Code
     C                     KFLD           WAGNDT           Actual Shipped
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Item Code
      * Setup key
     C                     Z-ADDWDERC7    WQSN01           Item Code
     C                     Z-ADDYL0005    WAGNDT           Actual Shipped
      * Establish starting position
     C           KPSSN     SETLL@BGWKG7                    *
     C           KRSSN     READE@BGWKG7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SNEXIT                     *QUIT
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Customer Type     RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABKC7    WL0005           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WUBOCD    P      Type Code
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Type Code is Inter Company
      *   |- c2    : DB1.Company Number EQ PAR.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBOCD    IFEQ 'IC'                       *IF
     C           WAAIC3    IFEQ $DAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Actual Shipped Date GE PAR.Date From
      *   |- c2    : DB1.Actual Shipped Date LE PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGNDT    IFGE P2L9DT                     *IF
     C           WAGNDT    IFLE P3MADT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WAATWG    YL0011           USR Weight Bill
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@BGWKG7                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Next Saturday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSO01           Company Number
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
      * Setup key
     C                     Z-ADDWL0010    WQSO01           Company Number
     C                     Z-ADDWL0011    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSO     SETLL@AFREBE                    *
     C           KRSSO     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0012           Scheduled Ship
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Saturday
     C           AFA9ST    IFEQ '7'                        *IF
     C                     Z-ADDAFBCDT    WL0012           Scheduled Ship
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F0LQCD    WQSP01           Commodity Marke
     C           *LIKE     DEFN F0LRCD    WQSP02           Commodity Price
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Commodity Marke
     C                     KFLD           WQSP02           Commodity Price
     C                     KFLD           F0EQDT           Market Price Da
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Commodity Marke
     C                     KFLD           WQSP02           Commodity Price
      * Setup key
     C                     MOVELWL0013    WQSP01           Commodity Marke
     C                     MOVELWL0014    WQSP02           Commodity Price
     C                     Z-ADDWL0015    F0EQDT           Market Price Da
      * Establish starting position
     C           KPSSP     SETLL@F0CPEP                    *
     C           KRSSP     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0016           Commodity Marke
     C                     Z-ADD*ZERO     WL0017           USR Date Priced
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDF0A5PR    WL0016           Commodity Marke
     C                     Z-ADDF0EQDT    WL0017           USR Date Priced
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Price Override     CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0009  70       Item Code
     C                     MOVEL*BLANK    WN0010  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0011  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0012  70       Order Group Cod
     C                     MOVEL*BLANK    WN0013  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0014  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0015 112       Billing Detail
     C                     Z-ADD*ZERO     WN0016 112       Billing Detail
     C                     Z-ADD*ZERO     WN0017 112       Billing Detail
     C                     Z-ADD*ZERO     WN0018 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0019  1        Comment Print A
     C                     MOVEL*BLANK    WN0020  1        Comment Print I
     C                     MOVEL*BLANK    WN0021  1        Comment Print P
     C                     MOVEL*BLANK    WN0022  1        Comment Print S
     C                     Z-ADD*ZERO     WN0023 112       Extended Amount
     C                     Z-ADD*ZERO     WN0024  70       Market Pricing
     C                     MOVEL*BLANK    WN0025  3        Commodity Marke
     C                     MOVEL*BLANK    WN0026  3        Date Method Cod
     C                     MOVEL*BLANK    WN0027  3        Price Method Co
     C                     Z-ADD*ZERO     WN0028  70       Contract Number
     C                     MOVEL*BLANK    WN0029  1        Price Status
     C                     Z-ADD*ZERO     WN0030  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0031  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0032  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0033  1        Work Confirm St
     C                     MOVEL*BLANK    WN0034  1        Work Over/Short
     C                     MOVEL*BLANK    WN0035  1        OD Production P
     C                     MOVEL*BLANK    WN0036 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0037 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0038  1        Age Code
     C                     MOVEL*BLANK    WN0039  1        Palletize
     C                     MOVEL*BLANK    WN0040  1        Slip Sheet
     C                     MOVEL*BLANK    WN0041  1        Catch Weight St
     C                     MOVEL*BLANK    WN0042  1        Price Audit
     C                     MOVEL*BLANK    WN0043  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0044  1        Production Date
     C                     Z-ADD*ZERO     WN0045 112       Rated Freight
     C                     Z-ADD*ZERO     WN0046 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0047 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0048 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0049 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0050 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0051 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0052 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0053 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0054 114       Unit Price
     C                     Z-ADD*ZERO     WN0055 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0056 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0057 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0058 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0059  70       Requested Ship
     C                     Z-ADD*ZERO     WN0060  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0061  70       Actual Shipped
     C                     MOVEL*BLANK    WN0062  1        Affect Inventor
     C                     MOVEL*BLANK    WN0063  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0064  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0065  30       Item Structure
     C                     Z-ADD*ZERO     WN0066  30       Item Structure
     C                     Z-ADD*ZERO     WN0067  30       Item Structure
     C                     MOVEL*BLANK    WN0068  2        Item Level
     C                     MOVEL*BLANK    WN0069  2        Quality Level
     C                     MOVEL*BLANK    WN0070  2        Pricing Product
     C                     MOVEL*BLANK    WN0071  2        Season Product
     C                     Z-ADD*ZERO     WN0072  70       Date of Origina
     C                     MOVEL*BLANK    WN0073 10        User Profile Na
     C                     MOVEL*BLANK    WN0074  6        Country Code
     C                     MOVEL*BLANK    WN0075  2        Event Code
     C                     MOVEL*BLANK    WN0076  3        Reason Code
     C                     MOVEL*BLANK    WN0077  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0078  1        Modified Flag
     C                     MOVEL*BLANK    WN0079  1        Substituted Fla
     C                     MOVEL*BLANK    WN0080  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0081 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0082 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0083  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0084  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0085  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0086  1        Affect Commissi
     C                     MOVEL*BLANK    WN0087  1        Affect Pricing
     C                     MOVEL*BLANK    WN0088  1        Released by Use
     C                     MOVEL*BLANK    WN0089  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0090  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0091  3        Production Ware
     C                     MOVEL*BLANK    WN0092  3        OD Price Type
     C                     Z-ADD*ZERO     WN0093  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0094  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0095  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0096  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0097  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0098  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0099  60       Price Code
     C                     Z-ADD*ZERO     WN0100  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0101  60       Substitution Li
     C                     Z-ADD*ZERO     WN0102  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0103 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0104 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0105 112       OD Item Target
     C                     Z-ADD*ZERO     WN0106 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0107 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0108 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0109 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0110 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0111 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0112 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0113 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0114 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0115 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0116  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0117  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0118  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0119 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0120  40       Item Age Days
     C                     Z-ADD*ZERO     WN0121  70       Production Ovr
     C                     Z-ADD*ZERO     WN0122  70       Production Ovr
     C                     MOVEL*BLANK    WN0123  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0124  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0125  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0126  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0127  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0128  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0129  1        EDI Status 1
     C                     MOVEL*BLANK    WN0130  1        EDI Status 2
     C                     MOVEL*BLANK    WN0131  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0132  60       Job Time
     C                     MOVEL*BLANK    WN0133 10        User Id
     C                     MOVEL*BLANK    WN0134 10        Job Name
     C                     Z-ADD*ZERO     WN0135  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0018    WFAIC3           Company Number
     C                     Z-ADDWL0019    WFC4NB           Order Number
     C                     Z-ADDWL0020    WFDPNB           Order Sequence
     C                     Z-ADDWL0021    WFUENB           Order Secondary
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSQ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0022    WFBZPR           Price Overage O
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * CHG Price Audit        CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0136  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0137  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0138  70       Ship To Custome
     C                     MOVEL*BLANK    WN0139 30        Ship To Name
     C                     MOVEL*BLANK    WN0140 30        Ship To Address
     C                     MOVEL*BLANK    WN0141 30        Ship To Address
     C                     MOVEL*BLANK    WN0142 30        Ship To Address
     C                     MOVEL*BLANK    WN0143 20        Ship To City
     C                     MOVEL*BLANK    WN0144  2        Ship To State C
     C                     MOVEL*BLANK    WN0145 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0146  70       Bill to Custome
     C                     MOVEL*BLANK    WN0147 30        Bill to Name
     C                     MOVEL*BLANK    WN0148 30        Bill to Address
     C                     MOVEL*BLANK    WN0149 30        Bill to Address
     C                     MOVEL*BLANK    WN0150 30        Bill to Address
     C                     MOVEL*BLANK    WN0151 20        Bill to City
     C                     MOVEL*BLANK    WN0152  2        Bill to State C
     C                     MOVEL*BLANK    WN0153 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0154 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0155  70       Order Date
     C                     Z-ADD*ZERO     WN0156  70       Requested Ship
     C                     Z-ADD*ZERO     WN0157  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0158  70       Cancel Date
     C                     MOVEL*BLANK    WN0159  2        Terms Code
     C                     MOVEL*BLANK    WN0160 40        Special Instruc
     C                     MOVEL*BLANK    WN0161 40        Special Instruc
     C                     MOVEL*BLANK    WN0162  3        Carrier Code
     C                     MOVEL*BLANK    WN0163  1        Comment Print A
     C                     MOVEL*BLANK    WN0164  1        Comment Print I
     C                     MOVEL*BLANK    WN0165  1        Comment Print P
     C                     MOVEL*BLANK    WN0166  1        Comment Print S
     C                     MOVEL*BLANK    WN0167  3        Reason Code
     C                     MOVEL*BLANK    WN0168  1        Order in Use
     C                     MOVEL*BLANK    WN0169  1        Header Status
     C                     MOVEL*BLANK    WN0170  1        Header Status L
     C                     MOVEL*BLANK    WN0171  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0172  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0173 10        User Original E
     C                     Z-ADD*ZERO     WN0174  70       Date of Origina
     C                     Z-ADD*ZERO     WN0175 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0176 112       Order Weight To
     C                     MOVEL*BLANK    WN0177  1        Credit Hold
     C                     MOVEL*BLANK    WN0178  1        Production Hold
     C                     MOVEL*BLANK    WN0179  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0180  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0181  40       Requested Deliv
     C                     MOVEL*BLANK    WN0182  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0183 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0184  70       Load ID
     C                     Z-ADD*ZERO     WN0185  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0186 112       Rated Freight
     C                     MOVEL*BLANK    WN0187  1        LTL Flag
     C                     MOVEL*BLANK    WN0188  1        Price Status
     C                     MOVEL*BLANK    WN0189  2        Shipping Method
     C                     MOVEL*BLANK    WN0190  1        Export Status
     C                     MOVEL*BLANK    WN0191  1        Palletize
     C                     MOVEL*BLANK    WN0192  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0193  1        Slip Sheet
     C                     MOVEL*BLANK    WN0194  1        Age Code
     C                     Z-ADD*ZERO     WN0195  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0196  1        Load Type
     C                     Z-ADD*ZERO     WN0197  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0198  1        Load Plan Order
     C                     MOVEL*BLANK    WN0199  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0200  70       Resell Referenc
     C                     MOVEL*BLANK    WN0201 30        Special Comment
     C                     MOVEL*BLANK    WN0202 30        Special Comment
     C                     MOVEL*BLANK    WN0203  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0204  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0205  2        Manager Level C
     C                     MOVEL*BLANK    WN0206  3        VP Level Code
     C                     Z-ADD*ZERO     WN0207  70       Attach to Order
     C                     MOVEL*BLANK    WN0208  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0209  70       Invoice Number
     C                     MOVEL*BLANK    WN0210  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0211  70       Invoice Date
     C                     MOVEL*BLANK    WN0212  2        Event Code
     C                     MOVEL*BLANK    WN0213  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0214  1        Modified Flag
     C                     Z-ADD*ZERO     WN0215 112       A/R order Value
     C                     MOVEL*BLANK    WN0216  1        Billing Activit
     C                     MOVEL*BLANK    WN0217  1        Block Order Fla
     C                     MOVEL*BLANK    WN0218  1        Order Certifica
     C                     Z-ADD*ZERO     WN0219 112       Invoice Order V
     C                     MOVEL*BLANK    WN0220  1        Process Sts for
     C                     MOVEL*BLANK    WN0221  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0222  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0223  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0224  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0225  1        Email Cust On O
     C                     MOVEL*BLANK    WN0226  1        Order Emailed
     C                     MOVEL*BLANK    WN0227  1        Export Docs Go
     C                     MOVEL*BLANK    WN0228  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0229  1        Broker Order St
     C                     MOVEL*BLANK    WN0230  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0231  2        Order Requires
     C                     MOVEL*BLANK    WN0232  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0233  2        Export USDA App
     C                     MOVEL*BLANK    WN0234  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0235  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0236  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0237  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0238  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0239  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0240  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0241  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0242  60       Time of Origina
     C                     Z-ADD*ZERO     WN0243  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0244  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0245  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0246 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0247 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0248 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0249 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0250 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0251  70       Claim Number
     C                     MOVEL*BLANK    WN0252  1        EDI Status 1
     C                     MOVEL*BLANK    WN0253  1        EDI Status 2
     C                     MOVEL*BLANK    WN0254  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0255  60       Job Time
     C                     MOVEL*BLANK    WN0256 10        User Id
     C                     MOVEL*BLANK    WN0257 10        Job Name
     C                     Z-ADD*ZERO     WN0258  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD$EAIC3    WGAIC3           Company Number
     C                     Z-ADD$EC4NB    WGC4NB           Order Number
      *
     C           KLCHSR    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C           KLCHSR    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       WGU0ST    P      Price Audit
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWGAIC3    PAAIC3           Company Number
     C                     Z-ADDWGC4NB    PAC4NB           Order Number
     C                     MOVELWGJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWGANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWGBKC7    PABKC7           Ship To Custome
     C                     MOVELWGBRTX    PABRTX    P      Ship To Name
     C                     MOVELWGHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWGHONA    PAHONA    P      Ship To Address
     C                     MOVELWGHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWGHNNA    PAHNNA    P      Ship To City
     C                     MOVELWGDBCD    PADBCD    P      Ship To State C
     C                     MOVELWGCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWGB0C7    PAB0C7           Bill to Custome
     C                     MOVELWGAETX    PAAETX    P      Bill to Name
     C                     MOVELWGB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWGB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWGB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWGB2NA    PAB2NA    P      Bill to City
     C                     MOVELWGBHCD    PABHCD    P      Bill to State C
     C                     MOVELWGC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWGBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWGA0DT    PAA0DT           Order Date
     C                     Z-ADDWGA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWGGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWGACDT    PAACDT           Cancel Date
     C                     MOVELWGAQCD    PAAQCD    P      Terms Code
     C                     MOVELWGB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWGBYNA    PABYNA    P      Special Instruc
     C                     MOVELWGBZNA    PABZNA    P      Carrier Code
     C                     MOVELWGGTST    PAGTST    P      Comment Print A
     C                     MOVELWGGVST    PAGVST    P      Comment Print I
     C                     MOVELWGGUST    PAGUST    P      Comment Print P
     C                     MOVELWGQFST    PAQFST    P      Comment Print S
     C                     MOVELWGCQCD    PACQCD    P      Reason Code
     C                     MOVELWGGJST    PAGJST    P      Order in Use
     C                     MOVELWGGWST    PAGWST    P      Header Status
     C                     MOVELWGGXST    PAGXST    P      Header Status L
     C                     MOVELWGGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWGAODT    PAAODT           Scheduled Ship
     C                     MOVELWGAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWGCXDT    PACXDT           Date of Origina
     C                     Z-ADDWGJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWGA1WG    PAA1WG           Order Weight To
     C                     MOVELWGXIST    PAXIST    P      Credit Hold
     C                     MOVELWGXJST    PAXJST    P      Production Hold
     C                     MOVELWGXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWGEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWGAFTM    PAAFTM           Requested Deliv
     C                     MOVELWGE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWGE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWGRMNB    PARMNB           Load ID
     C                     Z-ADDWGTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWGR1NB    PAR1NB           Rated Freight
     C                     MOVELWGPJST    PAPJST    P      LTL Flag
     C                     MOVELWGU0ST    PAU0ST    P      Price Audit
     C                     MOVELWGU1ST    PAU1ST    P      Price Status
     C                     MOVELWGQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWGU2ST    PAU2ST    P      Export Status
     C                     MOVELWGVEST    PAVEST    P      Palletize
     C                     MOVELWGVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWGVGST    PAVGST    P      Slip Sheet
     C                     MOVELWGRPCD    PARPCD    P      Age Code
     C                     Z-ADDWGRNNB    PARNNB           Reefer Temperat
     C                     MOVELWGVDST    PAVDST    P      Load Type
     C                     Z-ADDWGATIN    PAATIN           Attach to Invoi
     C                     MOVELWGU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWGU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWGRSRN    PARSRN           Resell Referenc
     C                     MOVELWGMHNA    PAMHNA    P      Special Comment
     C                     MOVELWGMINA    PAMINA    P      Special Comment
     C                     MOVELWGWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWGR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWGBFCD    PABFCD    P      Manager Level C
     C                     MOVELWGQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWGT3NB    PAT3NB           Attach to Order
     C                     MOVELWGSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWGCONB    PACONB           Invoice Number
     C                     MOVELWGCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWGAWDT    PAAWDT           Invoice Date
     C                     MOVELWGJPCD    PAJPCD    P      Event Code
     C                     MOVELWGXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWGZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWGVRVA    PAVRVA           A/R order Value
     C                     MOVELWGOBST    PAOBST    P      Billing Activit
     C                     MOVELWGBCST    PABCST    P      Block Order Fla
     C                     MOVELWGBDST    PABDST    P      Order Certifica
     C                     Z-ADDWGB7VL    PAB7VL           Invoice Order V
     C                     MOVELWGGASX    PAGASX    P      Process Sts for
     C                     MOVELWGGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWGGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWGGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWGFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWGFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWGFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWGFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWGFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWGFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWGFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWGFUSX    PAFUSX    P      Order Requires
     C                     MOVELWGFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWGFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWGFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWGFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWGNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWGNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWGNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWGNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWGNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWGBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWGBQTM    PABQTM           Time of Origina
     C                     Z-ADDWGBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWGBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWGBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWGH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWGH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWGH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWGH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWGH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWGC0C7    PAC0C7           Claim Number
     C                     MOVELWGUVST    PAUVST    P      EDI Status 1
     C                     MOVELWGUWST    PAUWST    P      EDI Status 2
     C                     MOVELWGUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWGAATM    PAAATM           Job Time
     C                     MOVELWGAYNA    PAAYNA    P      User Id
     C                     MOVELWGA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWGAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Inter-Co Pricing  PO
      *================================================================
      * 03/28/17 DN R9700-Created Array PAR to add Inter Company Group Fl
      *
     C                     MOVEL*BLANK    WN0001  1        Use Calcd Avg p
      *
      * Prt Inter-Co Pricing  PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 07/06/2009 LJB FP1314  Omit InterCompany Sales Agreement recor
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt Inter-Co Pricing  PO: Initialise
      *================================================================
      * USER: Initialize program
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7IPTS           Invoice/Pre-Inv
     C                     MOVEL*BLANK    P8OBST           Billing Activit
     C                     MOVEL*BLANK    P9GGST           USR Display fie
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Record Processed Usr
     C                     MOVEL*BLANK    WUSOSX  1
      * Initialize KEY fields.
     C                     MOVEL*HIVAL    BEGNDT           Actual Shipped
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BEC4NB           Order Number
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    OMAIC3           Company Number
     C                     MOVEL*LOVAL    OMC4NB           Order Number
     C                     MOVEL*LOVAL    OMDPNB           Order Sequence
     C                     MOVEL*LOVAL    OMUENB           Order Secondary
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCM8NB           System Value Nu
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDERC7           Group with Item
     C                     Z-ADD*ZERO     WDGQPC           IGTS Min Sales
     C                     Z-ADD*ZERO     WDKFNY           IGTS Unused Nbr
     C                     Z-ADD*ZERO     WDKGNY           IGTS Unused Nbr
     C                     Z-ADD*ZERO     WDRNDT           IGTS Unused Dat
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WEORIT           Original Item
     C                     Z-ADD*ZERO     WEAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WED0WG           Weight Ordered
     C                     Z-ADD*ZERO     WECCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WEAKPR           Unit Price
     C                     Z-ADD*ZERO     WEAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WEAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WEESNB           Accounting Year
     C                     Z-ADD*ZERO     WEETNB           Accounting Peri
     C                     Z-ADD*ZERO     WEBZNB           OM Week
     C                     Z-ADD*ZERO     WEEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WEBYWG           Weight Billed
     C                     Z-ADD*ZERO     WES5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WEMAVA           Billing Detail
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WEUTVA           Standard Overag
     C                     Z-ADD*ZERO     WEA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WER8NB           Shipping Compan
     C                     Z-ADD*ZERO     WEBZPR           Price Overage O
     C                     Z-ADD*ZERO     WEEXDT           Market Pricing
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WEONVA           Actual Freight
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WEULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WEUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WEUOVA           Commission Amou
     C                     Z-ADD*ZERO     WEUPVA           Financials Amou
     C                     Z-ADD*ZERO     WEUQVA           Financials Amou
     C                     Z-ADD*ZERO     WECFC7           Order Group Cod
     C                     Z-ADD*ZERO     WEDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WEB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WEIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WEIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WENYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WEBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WEZ4NB           MPC Number
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WECDPR           Market Value
     C                     Z-ADD*ZERO     WED0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WED0VL           Raw Material Co
     C                     Z-ADD*ZERO     WECEVL           Sales Expense T
     C                     Z-ADD*ZERO     WEOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WED9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WECFVL           HST Item Target
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WGA0DT           Order Date
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGACDT           Cancel Date
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WGA1WG           Order Weight To
     C                     Z-ADD*ZERO     WGEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WGAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WGATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WGRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WGT3NB           Attach to Order
     C                     Z-ADD*ZERO     WGCONB           Invoice Number
     C                     Z-ADD*ZERO     WGAWDT           Invoice Date
     C                     Z-ADD*ZERO     WGVRVA           A/R order Value
     C                     Z-ADD*ZERO     WGB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WGNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WGNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WGNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WGNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WGNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WGBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WGBQTM           Time of Origina
     C                     Z-ADD*ZERO     WGBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WGBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WGBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WGH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WGH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WGH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WGH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WGH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WGC0C7           Claim Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  52
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  2
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     MOVEL*BLANK    WL0008 10
     C                     MOVEL*BLANK    WL0009 40
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  70
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0013  3
     C                     MOVEL*BLANK    WL0014  7
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016 114
     C                     Z-ADD*ZERO     WL0017  70
      * Define local variables for subroutine SQCHRC.
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022 114
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Inter Company Grp Dsc USR
     C                     MOVEL*BLANK    YL0001 30
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0003  52
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Inter Company Group USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Commodity Market Price
     C                     Z-ADD*ZERO     YL0007 114
      * Define local work field Weight Billed
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field FOB Gross Amount
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field Inter Company Group USR
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field USR Weight Billed 11.2  7
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field Percent 7.4 USR
     C                     Z-ADD*ZERO     YL0012  74
      * Define local work field Market Price Date
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field IGTS Commodity Market
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field USR Date Priced
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Inter Company Group USR
     C                     MOVEL*BLANK    YL0018  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL*BLANK    P4YTSX           Error Report 2
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       WUSOSX           Record Processe
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ICPRGROUP
00002 ** ERROR-Price Method
00003 Not MAN
00004 ** ACTION-Price
00005 Maintenance
00006 ** Price w/ Jacobsen **
00007 ** Price w/ Jacobsen STF
00008 ** ERROR-Unable to Price
