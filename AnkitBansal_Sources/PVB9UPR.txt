/********************************************************************/
/*  SYSTEM:     ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM:    PVB9UPR                                             */
/*  TITLE:      CREATE  LOAD PLAN WORK FILE IN QTEMP                */
/*  PROGRAMMER: JAGDISH MISTRY                                      */
/*  DATE:       12/14/23                                            */
/*                                                                  */
/*  SYNOPSIS:                                                       */
/*              EXECUTE LOAD PLAN EMAIL REPORT TO GET CUSTOMER NAME */
/*                                                                  */
/*  NOTE:                                                           */
/********************************************************************/
             PGM        PARM(&MODE)

             DCL        VAR(&MODE) TYPE(*CHAR) LEN(1)

             IF         COND(&MODE *EQ 'S') THEN(DO)
             DLTF       FILE(QTEMP/PVAHCPL0)
             MONMSG     MSGID(CPF0000)
             DLTF       FILE(QTEMP/PVAHCPL1)
             MONMSG     MSGID(CPF0000)
             DLTF       FILE(QTEMP/PVAHCPP)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(PVAHCPP) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) CST(*NO) TRG(*NO)
             CRTDUPOBJ  OBJ(PVAHCPL0) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) CST(*NO) TRG(*NO)
             CRTDUPOBJ  OBJ(PVAHCPL1) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) CST(*NO) TRG(*NO)
             OVRDBF     FILE(PVAHCPP) TOFILE(QTEMP/PVAHCPP) +
                          OVRSCOPE(*JOB)
             OVRDBF     FILE(PVAHCPL0) TOFILE(QTEMP/PVAHCPL0) +
                          OVRSCOPE(*JOB)
             OVRDBF     FILE(PVAHCPL1) TOFILE(QTEMP/PVAHCPL1) +
                          OVRSCOPE(*JOB)
             ENDDO

             IF         COND(&MODE *EQ 'E') THEN(DO)
             DLTOVR     FILE(PVAHCPP) LVL(*)
             MONMSG     MSGID(CPF0000)
             DLTOVR     FILE(PVAHCPL0) LVL(*)
             MONMSG     MSGID(CPF0000)
             DLTOVR     FILE(PVAHCPL1) LVL(*)
             MONMSG     MSGID(CPF0000)

             DLTF       FILE(QTEMP/PVAHCPL0)
             MONMSG     MSGID(CPF0000)
             DLTF       FILE(QTEMP/PVAHCPL1)
             MONMSG     MSGID(CPF0000)
             DLTF       FILE(QTEMP/PVAHCPP)
             MONMSG     MSGID(CPF0000)
             ENDDO

             ENDPGM
