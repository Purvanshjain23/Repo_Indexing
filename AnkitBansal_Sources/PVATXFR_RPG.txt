     H/TITLE Crt Block Ord Automatn XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/28/25  Time  : 03:14:13
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUC2CPL4  IF   E           K DISK
      * RSQ : WF Block Order Upload Hdr RSQ By Order_Number
      *
     FPUC4CPL1  IF   E           K DISK
      * RTV : WF Block Order Trans      Retrieval index
      *
     FPDJYREL3  IF   E           K DISK
      * RTV : Company Defaults Internal Plant Companies Only CO
      *
     FCABBREL9  IF   E           K DISK
      * RSQ : Customer Master           Rsq Ship #, Active
      *
     FPDNEREL1  IF   E           K DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCABBREL1  IF   E           K DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPUAAREL1  IF   E           K DISK
      * RTV : Customer EXT2             Retrieval index
      *
     FOME5REL1  IF   E           K DISK
      * RTV : Country Master            Retrieval index
      *
     FCAADREL3  IF   E           K DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCAADREL1  IF   E           K DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDKMREL1  IF   E           K DISK
      * RTV : Company Values            Retrieval index
      *
     FCAAFREL1  IF   E           K DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FPUC3CPL1  IF   E           K DISK
      * RTV : WF Block Order Upload Dtl Retrieval index
      *
     FCABZREL1  IF   E           K DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDM1REL4  IF   E           K DISK
      * RTV : Ham Group Item            HamGrp/Item RS=A
      *
     FCAEOREL1  IF   E           K DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDIHREL0  IF   E           K DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCAASREL3  IF   E           K DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2  IF   E           K DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDIPREL2  IF   E           K DISK
      * RSQ : Market Date Method        System/Co/Date Method
      *
     FOMF0CPL3  IF   E           K DISK
      * RTV : Commodity Mrkt Price      Active Only
      *
     FPUC5CPL1  IF   E           K DISK
      * RTV : WF Block Order Errors     Retrieval index
      *
     FOPBFCPL1  IF   E           K DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDMSREL2  IF   E           K DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FOPBGWKM3  IF   E           K DISK
      * RSQ : Order Detail              Co/Ord/Dtl Line Sts Last
      *
     FPUC2CPL3  IF   E           K DISK
      * RSQ : WF Block Order Upload Hdr Rcd Proc SEL Eml Not Sen
      *
     FCADPREL1  IF   E           K DISK
      * RTV : System Values             Retrieval index       NV
      *
     FPUC2CPL0  UF   E           K DISK
      * UPD : WF Block Order Upload Hdr Update index
      *
     FPUC4CPL0  IF A E           K DISK
      * UPD : WF Block Order Trans      Update index
      *
     FPUC3CPL0  UF   E           K DISK
      * UPD : WF Block Order Upload Dtl Update index
      *
     FOPBGWKL0  UF   E           K DISK
      * UPD : Order Detail              Update index
      *
     FPDMSREL0  UF   E           K DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FOPBFCPL0  UF   E           K DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBFCPW0  UF   E           K DISK
      * UPD : Order Header TRG          Update Index WORK
      *
     FOMFJCPL1  UF   E           K DISK
      * UPD : Load Header               Update index
      *
      * Long constants
     D @CN#            S              6    DIM(241)CTDATA PERRCD(1)
     D @CN             S             25    DIM(241) ALT(@CN#)
     D YDOW            S              1     DIM(7)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * Outward parameters
     D PARC            DS           779
      * RCD : Order Header TRG          Update index
      * I :  Company Number
     D  PAAIC3                 1      2P 0
      * I :  Order Number
     D  PAC4NB                 3      6P 0
      * I :  Order Type_Sales
     D  PAJNCD                 7      8
      * I :  AR Customer Number
     D  PAANC7                 9     12P 0
      * I :  Ship To Customer
     D  PABKC7                13     16P 0
      * I :  Ship To Name
     D  PABRTX                17     46
      * I :  Ship To Address Line 1
     D  PAHMNA                47     76
      * I :  Ship To Address Line 2
     D  PAHONA                77    106
      * I :  Ship To Address Line 3
     D  PAHPNA               107    136
      * I :  Ship To City
     D  PAHNNA               137    156
      * I :  Ship To State Code
     D  PADBCD               157    158
      * I :  Ship To Zip_Postal Code
     D  PACKTX               159    169
      * I :  Bill to Customer
     D  PAB0C7               170    173P 0
      * I :  Bill to Name
     D  PAAETX               174    203
      * I :  Bill to Address Line 1
     D  PAB1NA               204    233
      * I :  Bill to Address Line 2
     D  PAB3NA               234    263
      * I :  Bill to Address Line 3
     D  PAB4NA               264    293
      * I :  Bill to City
     D  PAB2NA               294    313
      * I :  Bill to State Code
     D  PABHCD               314    315
      * I :  Bill to Zip_Postal Code
     D  PAC8TX               316    326
      * I :  Customer Purchase Order #
     D  PABCNA               327    341
      * I :  Order Date
     D  PAA0DT               342    345P 0
      * I :  Requested Ship Date
     D  PAA5DT               346    349P 0
      * I :  Actual Shipped Date
     D  PAGNDT               350    353P 0
      * I :  Cancel Date
     D  PAACDT               354    357P 0
      * I :  Terms Code
     D  PAAQCD               358    359
      * I :  Special Instructions
     D  PAB6NA               360    399
      * I :  Special Instructions 2
     D  PABYNA               400    439
      * I :  Carrier Code
     D  PABZNA               440    442
      * I :  Comment Print Acknowledge
     D  PAGTST               443    443
      * I :  Comment Print Inv_Cr_Memo
     D  PAGVST               444    444
      * I :  Comment Print Pick Slip
     D  PAGUST               445    445
      * I :  Comment Print Ship Doc
     D  PAQFST               446    446
      * I :  Reason Code
     D  PACQCD               447    449
      * I :  Order in Use
     D  PAGJST               450    450
      * I :  Header Status
     D  PAGWST               451    451
      * I :  Header Status Last
     D  PAGXST               452    452
      * I :  Order Type Print Status
     D  PAGYST               453    453
      * I :  Scheduled Ship Date
     D  PAAODT               454    457P 0
      * I :  User Original Entry
     D  PAAIVN               458    467
      * I :  Date of Original Entry
     D  PACXDT               468    471P 0
      * I :  Order Value Total
     D  PAJZVA               472    477P 2
      * I :  Order Weight Total
     D  PAA1WG               478    483P 2
      * I :  Credit Hold
     D  PAXIST               484    484
      * I :  Production Hold
     D  PAXJST               485    485
      * I :  New Customer Hold
     D  PAXKST               486    486
      * I :  Requested Delivery Date
     D  PAEIDT               487    490P 0
      * I :  Requested Delivery Time
     D  PAAFTM               491    493P 0
      * I :  Accounts Receiv_Ent 1
     D  PAE8CD               494    497
      * I :  Accounts Receiv_Ent 2
     D  PAE9CD               498    509
      * I :  Load ID
     D  PARMNB               510    513P 0
      * I :  Absorbed Freight Rate CWT
     D  PATBNB               514    516P 2
      * I :  Rated Freight
     D  PAR1NB               517    522P 2
      * I :  LTL Flag
     D  PAPJST               523    523
      * I :  Price Audit
     D  PAU0ST               524    524
      * I :  Price Status
     D  PAU1ST               525    525
      * I :  Shipping Method
     D  PAQ2CD               526    527
      * I :  Export Status
     D  PAU2ST               528    528
      * I :  Palletize
     D  PAVEST               529    529
      * I :  Shrink Wrap
     D  PAVFST               530    530
      * I :  Slip Sheet
     D  PAVGST               531    531
      * I :  Age Code
     D  PARPCD               532    532
      * I :  Reefer Temperature
     D  PARNNB               533    535P 2
      * I :  Load Type
     D  PAVDST               536    536
      * I :  Attach to Invoice Number
     D  PAATIN               537    540P 0
      * I :  Load Plan Order
     D  PAU4ST               541    541
      * I :  Print Pick Slip
     D  PAU5ST               542    542
      * I :  Resell Reference Number
     D  PARSRN               543    546P 0
      * I :  Special Comment 1
     D  PAMHNA               547    576
      * I :  Special Comment 2
     D  PAMINA               577    606
      * I :  Affect Auto Accruals
     D  PAWBST               607    607
      * I :  Sales Route Code
     D  PAR4CD               608    610
      * I :  Manager Level Code
     D  PABFCD               611    612
      * I :  VP Level Code
     D  PAQ4CD               613    615
      * I :  Attach to Order Number
     D  PAT3NB               616    619P 0
      * I :  Reason for Price Audit
     D  PASICD               620    622
      * I :  Invoice Number
     D  PACONB               623    626P 0
      * I :  Invoice Suffix
     D  PACEST               627    628
      * I :  Invoice Date
     D  PAAWDT               629    632P 0
      * I :  Event Code
     D  PAJPCD               633    634
      * I :  Trans Contol AS400_Plant
     D  PAXUST               635    635
      * I :  Modified Flag
     D  PAZ1ST               636    636
      * I :  A_R order Value Total
     D  PAVRVA               637    642P 2
      * I :  Billing Activity Type
     D  PAOBST               643    643
      * I :  Block Order Flag
     D  PABCST               644    644
      * I :  Order Certification Flag
     D  PABDST               645    645
      * I :  Invoice Order Value Tot
     D  PAB7VL               646    651P 2
      * I :  Process Sts for 3C
     D  PAGASX               652    652
      * I :  Order Conf Fax Sts
     D  PAGBSX               653    653
      * I :  Manifest Fax Sts
     D  PAGCSX               654    654
      * I :  Invoice Fax Sts
     D  PAGDSX               655    655
      * I :  Transfer in Storage Ind
     D  PAFNSX               656    656
      * I :  Email Cust On Order Ship
     D  PAFOSX               657    657
      * I :  Order Emailed
     D  PAFPSX               658    658
      * I :  Export Docs Go w_Driver
     D  PAFQSX               659    659
      * I :  Shipping Temp Code C_F
     D  PAFRSX               660    660
      * I :  Broker Order Status
     D  PAFSSX               661    661
      * I :  Air Freight Order
     D  PAFTSX               662    662
      * I :  Order Requires Review
     D  PAFUSX               663    664
      * I :  OH Load Plan Ready
     D  PAFVSX               665    666
      * I :  Export USDA Approved
     D  PAFWSX               667    668
      * I :  HPB Ship to Warehouse
     D  PAFXSX               669    671
      * I :  OH TF Exempt Code
     D  PAFYSX               672    674
      * I :  OH Appt Confirmation Dt
     D  PANODT               675    678P 0
      * I :  JPN Invoice Issuance Date
     D  PANPDT               679    682P 0
      * I :  Load Actual Shipped Date
     D  PANQDT               683    686P 0
      * I :  Load BOL Complete Date
     D  PANRDT               687    690P 0
      * I :  Load Truck Departure Date
     D  PANSDT               691    694P 0
      * I :  Maximum Gross Weight
     D  PABPTM               695    698P 0
      * I :  Time of Original Entry
     D  PABQTM               699    702P 0
      * I :  OH Appt Confirmation Tm
     D  PABRTM               703    706P 0
      * I :  Load BOL Complete Time
     D  PABSTM               707    710P 0
      * I :  Load Truck Departure Time
     D  PABTTM               711    714P 0
      * I :  Act Frt Reference Amount
     D  PAH0NX               715    720P 2
      * I :  Act Non_Ref Frt Amount
     D  PAH1NX               721    726P 2
      * I :  OH Fuel Surcharge Amount
     D  PAH2NX               727    732P 2
      * I :  OH Total Non_Ref Frt Amt
     D  PAH3NX               733    738P 2
      * I :  OH Total Ref Frt Amt
     D  PAH4NX               739    744P 2
      * I :  Claim Number
     D  PAC0C7               745    748P 0
      * I :  EDI Status 1
     D  PAUVST               749    749
      * I :  EDI Status 2
     D  PAUWST               750    750
      * I :  EDI Status 3
     D  PAUXST               751    751
      *
      * Outward parameters
     D PBRC            DS             2
      * KEY : Item Level Codes          Active Only
      * I : RST Item Level
     D  PBRBCD                 1      2
      *
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XD1T            DS
      * Internal date
     D  XDINT1                 1      7  0
     D  XDINY1                 1      3  0
     D  XDINM1                 4      5  0
     D  XDIND1                 6      7  0
      /EJECT
     D XD2T            DS
      * Internal date
     D  XDINT2                 1      7  0
     D  XDINY2                 1      3  0
     D  XDINM2                 4      5  0
     D  XDIND2                 6      7  0
      /EJECT
     D XDMT            DS
      * Duration mask
     D  XDIMDT                 1      7  0
     D  XDIMYY                 1      3  0
     D  XDIMMM                 4      5  0
     D  XDIMDD                 6      7  0
      * Outward parameters
     D PCRC            DS           525
      * RCD : Order Detail              Update index
      * I :  Company Number
     D  PCAIC3                 1      2P 0
      * I :  Order Number
     D  PCC4NB                 3      6P 0
      * I :  Order Sequence Number
     D  PCDPNB                 7      8P 0
      * I :  Order Secondary Line Seq
     D  PCUENB                 9     10P 0
      * I :  Item Code
     D  PCHGCD                11     14P 0
      * I :  Warehouse Code
     D  PCAJCD                15     17
      * I :  Ship To Customer
     D  PCBKC7                18     21P 0
      * I :  Order Group Code
     D  PCCFC7                22     25P 0
      * I :  Detail Line Status
     D  PCGMST                26     26
      * I :  Detail Line Status Last
     D  PCGNST                27     27
      * I :  Billing Detail Cost Dol
     D  PCMAVA                28     33P 2
      * I :  Billing Detail Gross Dol
     D  PCKDVA                34     39P 2
      * I :  Billing Detail Net Dol
     D  PCL8VA                40     45P 2
      * I :  Quantity to Substitute
     D  PCL9VA                46     51P 2
      * I :  Comment Print Acknowledge
     D  PCGTST                52     52
      * I :  Comment Print Inv_Cr_Memo
     D  PCGVST                53     53
      * I :  Comment Print Pick Slip
     D  PCGUST                54     54
      * I :  Comment Print Ship Doc
     D  PCQFST                55     55
      * I :  Extended Amount
     D  PCAYVA                56     61P 2
      * I :  Market Pricing Date
     D  PCEXDT                62     65P 0
      * I :  Commodity Market Code
     D  PCLQCD                66     68
      * I :  Date Method Code
     D  PCRDCD                69     71
      * I :  Price Method Code
     D  PCQ7CD                72     74
      * I :  Price Overage Override
     D  PCBZPR                75     80P 4
      * I :  Contract Number
     D  PCL6NB                81     84P 0
      * I :  Price Status
     D  PCU1ST                85     85
      * I :  Pricing Date Used
     D  PCGIDT                86     89P 0
      * I :  U_M_Base Price
     D  PCCRCD                90     91
      * I :  U_M_Ordered
     D  PCAGCD                92     93
      * I :  Work Confirm Status
     D  PCRZST                94     94
      * I :  Work Over_Short Status
     D  PCR0ST                95     95
      * I :  OD Production Plan Sts
     D  PCR1ST                96     96
      * I :  Order Desc_Line One
     D  PCG7NA                97    126
      * I :  Order Desc_Line Two
     D  PCG8NA               127    156
      * I :  Age Code
     D  PCRPCD               157    157
      * I :  Palletize
     D  PCVEST               158    158
      * I :  Slip Sheet
     D  PCVGST               159    159
      * I :  Catch Weight Status
     D  PCAVST               160    160
      * I :  Price Audit
     D  PCU0ST               161    161
      * I :  Price Audit Reason Code
     D  PCRFCD               162    164
      * I :  Production Date Control
     D  PCFZST               165    165
      * I :  Rated Freight
     D  PCR1NB               166    171P 2
      * I :  Quantity Ordered
     D  PCAVQT               172    177P 2
      * I :  Weight Ordered
     D  PCD0WG               178    183P 2
      * I :  Quantity Scheduled
     D  PCCCQT               184    189P 2
      * I :  Weight Scheduled
     D  PCAUWG               190    195P 2
      * I :  Quantity Shipped Total
     D  PCCBQT               196    201P 2
      * I :  Weight Shipped Total
     D  PCATWG               202    207P 2
      * I :  Unit Cost Pricing U_M
     D  PCAQCS               208    213P 4
      * I :  Unit Cost Per Pound
     D  PCAGCS               214    219P 4
      * I :  Unit Price
     D  PCAKPR               220    225P 4
      * I :  Unit Price_Credit
     D  PCALPR               226    231P 4
      * I :  Unit Price Ordered U_M
     D  PCAUPR               232    237P 4
      * I :  Unit Weight Ordered U_M
     D  PCAVWG               238    243P 2
      * I :  Tare Weight Total
     D  PCA4WG               244    249P 2
      * I :  Requested Ship Date
     D  PCA5DT               250    253P 0
      * I :  Scheduled Ship Date
     D  PCAODT               254    257P 0
      * I :  Actual Shipped Date
     D  PCGNDT               258    261P 0
      * I :  Affect Inventory Status
     D  PCAMST               262    262
      * I :  Affect Sales Doll Status
     D  PCANST               263    263
      * I :  Affect Sales Pnds Status
     D  PCVAST               264    264
      * I :  Item Structure Type Code
     D  PCRGNB               265    266P 0
      * I :  Item Structure Group Code
     D  PCRHNB               267    268P 0
      * I :  Item Structure Class Code
     D  PCRINB               269    270P 0
      * I :  Item Level
     D  PCRBCD               271    272
      * I :  Quality Level
     D  PCHICD               273    274
      * I :  Pricing Product Class Rep
     D  PCRNCD               275    276
      * I :  Season Product Class Repo
     D  PCROCD               277    278
      * I :  Date of Original Entry
     D  PCCXDT               279    282P 0
      * I :  User Profile Name
     D  PCAJVN               283    292
      * I :  Country Code
     D  PCKXCD               293    298
      * I :  Event Code
     D  PCJPCD               299    300
      * I :  Reason Code
     D  PCCQCD               301    303
      * I :  Sales Route Code
     D  PCR4CD               304    306
      * I :  Modified Flag
     D  PCZ1ST               307    307
      * I :  Substituted Flag
     D  PCZ3ST               308    308
      * I :  OD Schedule Override Sts
     D  PCZ4ST               309    309
      * I :  Invoice Unit Price
     D  PCDUPR               310    315P 4
      * I :  Invoice Extended Amt
     D  PCB6VL               316    321P 2
      * I :  Ham Group Number
     D  PCA1AA               322    323P 0
      * I :  OD Adj Type Override
     D  PCFZSX               324    324
      * I :  Affect Trade Fund
     D  PCF0SX               325    325
      * I :  Affect Commission
     D  PCF1SX               326    326
      * I :  Affect Pricing
     D  PCF2SX               327    327
      * I :  Released by User Sts Y_N
     D  PCF3SX               328    328
      * I :  Ord TF Exempt Code
     D  PCF4SX               329    330
      * I :  OD Pallet Type
     D  PCF5SX               331    332
      * I :  Production Warehouse
     D  PCF6SX               333    335
      * I :  OD Price Type
     D  PCF7SX               336    338
      * I :  Warehouse Pallets Loaded
     D  PCNTDT               339    342P 0
      * I :  Consumed Item Code
     D  PCNUDT               343    346P 0
      * I :  Deadline Depart Date LH
     D  PCNVDT               347    350P 0
      * I :  OD Price Type Ref Num
     D  PCNWDT               351    354P 0
      * I :  OD Firm Date
     D  PCNXDT               355    358P 0
      * I :  Deadline Depart Time LH
     D  PCBUTM               359    362P 0
      * I :  Price Code
     D  PCBVTM               363    366P 0
      * I :  Maximum Net Weight
     D  PCBWTM               367    370P 0
      * I :  Substitution Line Number
     D  PCBXTM               371    374P 0
      * I :  Max Qty to sched per day
     D  PCBYTM               375    378P 0
      * I :  Warehouse Pallet Tare
     D  PCH5NX               379    384P 2
      * I :  Warehouse Avg Pallet Tare
     D  PCH6NX               385    390P 2
      * I :  OD Item Target Price
     D  PCH7NX               391    396P 2
      * I :  OD Estimated Gross Weight
     D  PCH8NX               397    402P 2
      * I :  OD Maximum Unit Weight
     D  PCH9NX               403    408P 2
      * I :  Order Gate_Final Price
     D  PCDVPR               409    414P 4
      * I :  OD Ceiling Price
     D  PCDWPR               415    420P 4
      * I :  OD Gate_Final Price Adj
     D  PCDXPR               421    426P 4
      * I :  OD Weighted Avg Price
     D  PCDYPR               427    432P 4
      * I :  OD Original Ordered Qty
     D  PCDZPR               433    438P 4
      * I :  OD Cancel Date
     D  PCGSPR               439    444P 4
      * I :  OD Unused Prc 7
     D  PCGTPR               445    450P 4
      * I :  OD Unused Prc 8
     D  PCGUPR               451    456P 4
      * I :  OD MPR Sent to USDA Sts
     D  PCHOST               457    457
      * I :  OD MPR Prc Ready to Send
     D  PCHPST               458    458
      * I :  OD UnUsed Price Sts 3
     D  PCIOST               459    459
      * I :  Weight Amount Entered
     D  PCPEWG               460    465P 2
      * I :  Item Age Days
     D  PCRINY               466    468P 0
      * I :  Production Ovr AgeDte Fr
     D  PCTIDT               469    472P 0
      * I :  Production Ovr AgeDte To
     D  PCTJDT               473    476P 0
      * I :  OD Spot Buy
     D  PCH2ST               477    477
      * I :  OD Clm Full Return to Plt
     D  PCH0ST               478    479
      * I :  Order Line Error Type
     D  PCH1ST               480    482
      * I :  OD Market Begin Date
     D  PCTKDT               483    486P 0
      * I :  OD Market Ending Date
     D  PCTLDT               487    490P 0
      * I :  OD Atch to Ord ActShpDte
     D  PCTMDT               491    494P 0
      * I :  EDI Status 1
     D  PCUVST               495    495
      * I :  EDI Status 2
     D  PCUWST               496    496
      * I :  EDI Status 3
     D  PCUXST               497    497
      *
      * Outward parameters
     D PDRC            DS             7
      * KEY : IP Item Market Details    Retrieval index
      * I :  Item Code
     D  PDHGCD                 1      4P 0
      * I :  Commodity Market Code
     D  PDLQCD                 5      7
      *
      * Outward parameters
     D PERC            DS            12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     D  PEBKC7                 1      4P 0
      * I :  Price Code
     D  PEBVTM                 5      8P 0
      * I :  Item Code
     D  PEHGCD                 9     12P 0
      *
      * Outward parameters
     D PFRC            DS             6
      * KEY : Order Header TRG          Retrieval index       NV
      * I : RST Company Number
     D  PFAIC3                 1      2P 0
      * I : RST Order Number
     D  PFC4NB                 3      6P 0
      *
     D QPUC21        E DS                  EXTNAME(PUC2CPL0)
      * UPD : WF Block Order Upload Hdr Update index
      * Renamed input format fields
     D  TAHQNZ       E                     EXTFLD(C2HQNZ)
     D  TAAIC3       E                     EXTFLD(C2AIC3)
     D  TAC4NB       E                     EXTFLD(C2C4NB)
     D  TAGWST       E                     EXTFLD(C2GWST)
     D  TABKC7       E                     EXTFLD(C2BKC7)
     D  TAAJCD       E                     EXTFLD(C2AJCD)
     D  TAA5DT       E                     EXTFLD(C2A5DT)
     D  TAACDT       E                     EXTFLD(C2ACDT)
     D  TAC3TX       E                     EXTFLD(C2C3TX)
     D  TABCNA       E                     EXTFLD(C2BCNA)
     D  TAU2ST       E                     EXTFLD(C2U2ST)
     D  TAKXCD       E                     EXTFLD(C2KXCD)
     D  TALWAA       E                     EXTFLD(C2LWAA)
     D  TAFQSX       E                     EXTFLD(C2FQSX)
     D  TAVEST       E                     EXTFLD(C2VEST)
     D  TAVGST       E                     EXTFLD(C2VGST)
     D  TAQ2CD       E                     EXTFLD(C2Q2CD)
     D  TARNNB       E                     EXTFLD(C2RNNB)
     D  TAN6SC       E                     EXTFLD(C2N6SC)
     D  TAOOSC       E                     EXTFLD(C2OOSC)
     D  TAEIDT       E                     EXTFLD(C2EIDT)
     D  TAVFST       E                     EXTFLD(C2VFST)
     D  TAVSST       E                     EXTFLD(C2VSST)
     D  TAMJDT       E                     EXTFLD(C2MJDT)
     D  TABETM       E                     EXTFLD(C2BETM)
     D  TACCVN       E                     EXTFLD(C2CCVN)
     D  TACDVN       E                     EXTFLD(C2CDVN)
     D  TAMKDT       E                     EXTFLD(C2MKDT)
     D  TABFTM       E                     EXTFLD(C2BFTM)
     D  TACEVN       E                     EXTFLD(C2CEVN)
     D  TACFVN       E                     EXTFLD(C2CFVN)
      *
     D YARDCS          DS           131
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      * Outward parameters
     D PGRC            DS             6
      * KEY : Order Header TRG          Update index
      * I :  Company Number
     D  PGAIC3                 1      2P 0
      * I :  Order Number
     D  PGC4NB                 3      6P 0
      *
      * Outward parameters
     D PHRC            DS            10
      * KEY : Order Detail              Update index
      * I :  Company Number
     D  PHAIC3                 1      2P 0
      * I :  Order Number
     D  PHC4NB                 3      6P 0
      *
     D QPUC41        E DS                  EXTNAME(PUC4CPL0)
      * UPD : WF Block Order Trans      Update index
      * Renamed input format fields
     D  TCHQNZ       E                     EXTFLD(C4HQNZ)
     D  TCAIC3       E                     EXTFLD(C4AIC3)
     D  TCC4NB       E                     EXTFLD(C4C4NB)
     D  TCN6SC       E                     EXTFLD(C4N6SC)
     D  TCVSST       E                     EXTFLD(C4VSST)
     D  TCMJDT       E                     EXTFLD(C4MJDT)
     D  TCBETM       E                     EXTFLD(C4BETM)
     D  TCCCVN       E                     EXTFLD(C4CCVN)
     D  TCCDVN       E                     EXTFLD(C4CDVN)
     D  TCMKDT       E                     EXTFLD(C4MKDT)
     D  TCBFTM       E                     EXTFLD(C4BFTM)
     D  TCCEVN       E                     EXTFLD(C4CEVN)
     D  TCCFVN       E                     EXTFLD(C4CFVN)
      *
     D QPUC31        E DS                  EXTNAME(PUC3CPL0)
      * UPD : WF Block Order Upload Dtl Update index
      * Renamed input format fields
     D  TFHQNZ       E                     EXTFLD(C3HQNZ)
     D  TFDXNB       E                     EXTFLD(C3DXNB)
     D  TFC4NB       E                     EXTFLD(C3C4NB)
     D  TFHGCD       E                     EXTFLD(C3HGCD)
     D  TFGMST       E                     EXTFLD(C3GMST)
     D  TFACDT       E                     EXTFLD(C3ACDT)
     D  TFAVQT       E                     EXTFLD(C3AVQT)
     D  TFQ7CD       E                     EXTFLD(C3Q7CD)
     D  TFRINY       E                     EXTFLD(C3RINY)
     D  TFF7SX       E                     EXTFLD(C3F7SX)
     D  TFEXDT       E                     EXTFLD(C3EXDT)
     D  TFHPST       E                     EXTFLD(C3HPST)
     D  TFBZPR       E                     EXTFLD(C3BZPR)
     D  TFA1AA       E                     EXTFLD(C3A1AA)
     D  TFVEST       E                     EXTFLD(C3VEST)
     D  TFF5SX       E                     EXTFLD(C3F5SX)
     D  TFVGST       E                     EXTFLD(C3VGST)
     D  TFVSST       E                     EXTFLD(C3VSST)
     D  TFBGTS       E                     EXTFLD(C3BGTS)
     D  TFRUU1       E                     EXTFLD(C3RUU1)
     D  TFRVU1       E                     EXTFLD(C3RVU1)
     D  TFBHTS       E                     EXTFLD(C3BHTS)
     D  TFRWU1       E                     EXTFLD(C3RWU1)
     D  TFRXU1       E                     EXTFLD(C3RXU1)
      *
     D YBRDCS          DS           235
     D QOPBG1        E DS                  EXTNAME(OPBGWKL0)
      * UPD : Order Detail              Update index
      * Renamed input format fields
     D  TGAIC3       E                     EXTFLD(OMAIC3)
     D  TGC4NB       E                     EXTFLD(OMC4NB)
     D  TGDPNB       E                     EXTFLD(OMDPNB)
     D  TGUENB       E                     EXTFLD(OMUENB)
     D  TGHGCD       E                     EXTFLD(OMHGCD)
     D  TGAJCD       E                     EXTFLD(OMAJCD)
     D  TGBKC7       E                     EXTFLD(OMBKC7)
     D  TGCFC7       E                     EXTFLD(OMCFC7)
     D  TGGMST       E                     EXTFLD(OMGMST)
     D  TGGNST       E                     EXTFLD(OMGNST)
     D  TGMAVA       E                     EXTFLD(OMMAVA)
     D  TGKDVA       E                     EXTFLD(OMKDVA)
     D  TGL8VA       E                     EXTFLD(OML8VA)
     D  TGL9VA       E                     EXTFLD(OML9VA)
     D  TGGTST       E                     EXTFLD(OMGTST)
     D  TGGVST       E                     EXTFLD(OMGVST)
     D  TGGUST       E                     EXTFLD(OMGUST)
     D  TGQFST       E                     EXTFLD(OMQFST)
     D  TGAYVA       E                     EXTFLD(OMAYVA)
     D  TGEXDT       E                     EXTFLD(OMEXDT)
     D  TGLQCD       E                     EXTFLD(OMLQCD)
     D  TGRDCD       E                     EXTFLD(OMRDCD)
     D  TGQ7CD       E                     EXTFLD(OMQ7CD)
     D  TGBZPR       E                     EXTFLD(OMBZPR)
     D  TGL6NB       E                     EXTFLD(OML6NB)
     D  TGU1ST       E                     EXTFLD(OMU1ST)
     D  TGGIDT       E                     EXTFLD(OMGIDT)
     D  TGCRCD       E                     EXTFLD(OMCRCD)
     D  TGAGCD       E                     EXTFLD(OMAGCD)
     D  TGRZST       E                     EXTFLD(OMRZST)
     D  TGR0ST       E                     EXTFLD(OMR0ST)
     D  TGR1ST       E                     EXTFLD(OMR1ST)
     D  TGG7NA       E                     EXTFLD(OMG7NA)
     D  TGG8NA       E                     EXTFLD(OMG8NA)
     D  TGRPCD       E                     EXTFLD(OMRPCD)
     D  TGVEST       E                     EXTFLD(OMVEST)
     D  TGVGST       E                     EXTFLD(OMVGST)
     D  TGAVST       E                     EXTFLD(OMAVST)
     D  TGU0ST       E                     EXTFLD(OMU0ST)
     D  TGRFCD       E                     EXTFLD(OMRFCD)
     D  TGFZST       E                     EXTFLD(OMFZST)
     D  TGR1NB       E                     EXTFLD(OMR1NB)
     D  TGAVQT       E                     EXTFLD(OMAVQT)
     D  TGD0WG       E                     EXTFLD(OMD0WG)
     D  TGCCQT       E                     EXTFLD(OMCCQT)
     D  TGAUWG       E                     EXTFLD(OMAUWG)
     D  TGCBQT       E                     EXTFLD(OMCBQT)
     D  TGATWG       E                     EXTFLD(OMATWG)
     D  TGAQCS       E                     EXTFLD(OMAQCS)
     D  TGAGCS       E                     EXTFLD(OMAGCS)
     D  TGAKPR       E                     EXTFLD(OMAKPR)
     D  TGALPR       E                     EXTFLD(OMALPR)
     D  TGAUPR       E                     EXTFLD(OMAUPR)
     D  TGAVWG       E                     EXTFLD(OMAVWG)
     D  TGA4WG       E                     EXTFLD(OMA4WG)
     D  TGA5DT       E                     EXTFLD(OMA5DT)
     D  TGAODT       E                     EXTFLD(OMAODT)
     D  TGGNDT       E                     EXTFLD(OMGNDT)
     D  TGAMST       E                     EXTFLD(OMAMST)
     D  TGANST       E                     EXTFLD(OMANST)
     D  TGVAST       E                     EXTFLD(OMVAST)
     D  TGRGNB       E                     EXTFLD(OMRGNB)
     D  TGRHNB       E                     EXTFLD(OMRHNB)
     D  TGRINB       E                     EXTFLD(OMRINB)
     D  TGRBCD       E                     EXTFLD(OMRBCD)
     D  TGHICD       E                     EXTFLD(OMHICD)
     D  TGRNCD       E                     EXTFLD(OMRNCD)
     D  TGROCD       E                     EXTFLD(OMROCD)
     D  TGCXDT       E                     EXTFLD(OMCXDT)
     D  TGAJVN       E                     EXTFLD(OMAJVN)
     D  TGKXCD       E                     EXTFLD(OMKXCD)
     D  TGJPCD       E                     EXTFLD(OMJPCD)
     D  TGCQCD       E                     EXTFLD(OMCQCD)
     D  TGR4CD       E                     EXTFLD(OMR4CD)
     D  TGZ1ST       E                     EXTFLD(OMZ1ST)
     D  TGZ3ST       E                     EXTFLD(OMZ3ST)
     D  TGZ4ST       E                     EXTFLD(OMZ4ST)
     D  TGDUPR       E                     EXTFLD(OMDUPR)
     D  TGB6VL       E                     EXTFLD(OMB6VL)
     D  TGA1AA       E                     EXTFLD(OMA1AA)
     D  TGFZSX       E                     EXTFLD(OMFZSX)
     D  TGF0SX       E                     EXTFLD(OMF0SX)
     D  TGF1SX       E                     EXTFLD(OMF1SX)
     D  TGF2SX       E                     EXTFLD(OMF2SX)
     D  TGF3SX       E                     EXTFLD(OMF3SX)
     D  TGF4SX       E                     EXTFLD(OMF4SX)
     D  TGF5SX       E                     EXTFLD(OMF5SX)
     D  TGF6SX       E                     EXTFLD(OMF6SX)
     D  TGF7SX       E                     EXTFLD(OMF7SX)
     D  TGNTDT       E                     EXTFLD(OMNTDT)
     D  TGNUDT       E                     EXTFLD(OMNUDT)
     D  TGNVDT       E                     EXTFLD(OMNVDT)
     D  TGNWDT       E                     EXTFLD(OMNWDT)
     D  TGNXDT       E                     EXTFLD(OMNXDT)
     D  TGBUTM       E                     EXTFLD(OMBUTM)
     D  TGBVTM       E                     EXTFLD(OMBVTM)
     D  TGBWTM       E                     EXTFLD(OMBWTM)
     D  TGBXTM       E                     EXTFLD(OMBXTM)
     D  TGBYTM       E                     EXTFLD(OMBYTM)
     D  TGH5NX       E                     EXTFLD(OMH5NX)
     D  TGH6NX       E                     EXTFLD(OMH6NX)
     D  TGH7NX       E                     EXTFLD(OMH7NX)
     D  TGH8NX       E                     EXTFLD(OMH8NX)
     D  TGH9NX       E                     EXTFLD(OMH9NX)
     D  TGDVPR       E                     EXTFLD(OMDVPR)
     D  TGDWPR       E                     EXTFLD(OMDWPR)
     D  TGDXPR       E                     EXTFLD(OMDXPR)
     D  TGDYPR       E                     EXTFLD(OMDYPR)
     D  TGDZPR       E                     EXTFLD(OMDZPR)
     D  TGGSPR       E                     EXTFLD(OMGSPR)
     D  TGGTPR       E                     EXTFLD(OMGTPR)
     D  TGGUPR       E                     EXTFLD(OMGUPR)
     D  TGHOST       E                     EXTFLD(OMHOST)
     D  TGHPST       E                     EXTFLD(OMHPST)
     D  TGIOST       E                     EXTFLD(OMIOST)
     D  TGPEWG       E                     EXTFLD(OMPEWG)
     D  TGRINY       E                     EXTFLD(OMRINY)
     D  TGTIDT       E                     EXTFLD(OMTIDT)
     D  TGTJDT       E                     EXTFLD(OMTJDT)
     D  TGH2ST       E                     EXTFLD(OMH2ST)
     D  TGH0ST       E                     EXTFLD(OMH0ST)
     D  TGH1ST       E                     EXTFLD(OMH1ST)
     D  TGTKDT       E                     EXTFLD(OMTKDT)
     D  TGTLDT       E                     EXTFLD(OMTLDT)
     D  TGTMDT       E                     EXTFLD(OMTMDT)
     D  TGUVST       E                     EXTFLD(OMUVST)
     D  TGUWST       E                     EXTFLD(OMUWST)
     D  TGUXST       E                     EXTFLD(OMUXST)
     D  TGAATM       E                     EXTFLD(OMAATM)
     D  TGAYNA       E                     EXTFLD(OMAYNA)
     D  TGA0NA       E                     EXTFLD(OMA0NA)
     D  TGAXDT       E                     EXTFLD(OMAXDT)
      *
     D YCRDCS          DS           525
     D YDRDCS          DS           525
     D QPDMS1        E DS                  EXTNAME(PDMSREL0)
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     D  TIAIC3       E                     EXTFLD(MSAIC3)
     D  TIC4NB       E                     EXTFLD(MSC4NB)
     D  TIDGSX       E                     EXTFLD(MSDGSX)
     D  TIKXCD       E                     EXTFLD(MSKXCD)
     D  TIDPNB       E                     EXTFLD(MSDPNB)
     D  TIUENB       E                     EXTFLD(MSUENB)
     D  TIDIC7       E                     EXTFLD(MSDIC7)
     D  TIO3NA       E                     EXTFLD(MSO3NA)
     D  TIO4NA       E                     EXTFLD(MSO4NA)
     D  TIRMTX       E                     EXTFLD(MSRMTX)
     D  TIPTTX       E                     EXTFLD(MSPTTX)
     D  TIHJWG       E                     EXTFLD(MSHJWG)
     D  TIHKWG       E                     EXTFLD(MSHKWG)
     D  TIRNTX       E                     EXTFLD(MSRNTX)
     D  TIAONX       E                     EXTFLD(MSAONX)
     D  TIROTX       E                     EXTFLD(MSROTX)
     D  TIORNA       E                     EXTFLD(MSORNA)
     D  TIAMNX       E                     EXTFLD(MSAMNX)
     D  TIANNX       E                     EXTFLD(MSANNX)
     D  TIAPNX       E                     EXTFLD(MSAPNX)
     D  TIDKPR       E                     EXTFLD(MSDKPR)
     D  TIA9VL       E                     EXTFLD(MSA9VL)
     D  TIC8SX       E                     EXTFLD(MSC8SX)
     D  TIRATX       E                     EXTFLD(MSRATX)
     D  TIRBTX       E                     EXTFLD(MSRBTX)
     D  TIAJNX       E                     EXTFLD(MSAJNX)
     D  TIZWTX       E                     EXTFLD(MSZWTX)
     D  TIZXTX       E                     EXTFLD(MSZXTX)
     D  TIZYTX       E                     EXTFLD(MSZYTX)
     D  TIZZTX       E                     EXTFLD(MSZZTX)
     D  TIK0U1       E                     EXTFLD(MSK0U1)
     D  TIK1U1       E                     EXTFLD(MSK1U1)
     D  TIIJSC       E                     EXTFLD(MSIJSC)
     D  TIIKSC       E                     EXTFLD(MSIKSC)
     D  TIK2U1       E                     EXTFLD(MSK2U1)
     D  TIW0DT       E                     EXTFLD(MSW0DT)
     D  TIUVST       E                     EXTFLD(MSUVST)
     D  TIUWST       E                     EXTFLD(MSUWST)
     D  TIUXST       E                     EXTFLD(MSUXST)
     D  TIVSST       E                     EXTFLD(MSVSST)
     D  TIAATM       E                     EXTFLD(MSAATM)
     D  TIAYNA       E                     EXTFLD(MSAYNA)
     D  TIA0NA       E                     EXTFLD(MSA0NA)
     D  TIAXDT       E                     EXTFLD(MSAXDT)
      *
     D QOPBF1        E DS                  EXTNAME(OPBFCPL0)
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     D  TKAIC3       E                     EXTFLD(BEAIC3)
     D  TKC4NB       E                     EXTFLD(BEC4NB)
     D  TKJNCD       E                     EXTFLD(BEJNCD)
     D  TKANC7       E                     EXTFLD(BEANC7)
     D  TKBKC7       E                     EXTFLD(BEBKC7)
     D  TKBRTX       E                     EXTFLD(BEBRTX)
     D  TKHMNA       E                     EXTFLD(BEHMNA)
     D  TKHONA       E                     EXTFLD(BEHONA)
     D  TKHPNA       E                     EXTFLD(BEHPNA)
     D  TKHNNA       E                     EXTFLD(BEHNNA)
     D  TKDBCD       E                     EXTFLD(BEDBCD)
     D  TKCKTX       E                     EXTFLD(BECKTX)
     D  TKB0C7       E                     EXTFLD(BEB0C7)
     D  TKAETX       E                     EXTFLD(BEAETX)
     D  TKB1NA       E                     EXTFLD(BEB1NA)
     D  TKB3NA       E                     EXTFLD(BEB3NA)
     D  TKB4NA       E                     EXTFLD(BEB4NA)
     D  TKB2NA       E                     EXTFLD(BEB2NA)
     D  TKBHCD       E                     EXTFLD(BEBHCD)
     D  TKC8TX       E                     EXTFLD(BEC8TX)
     D  TKBCNA       E                     EXTFLD(BEBCNA)
     D  TKA0DT       E                     EXTFLD(BEA0DT)
     D  TKA5DT       E                     EXTFLD(BEA5DT)
     D  TKGNDT       E                     EXTFLD(BEGNDT)
     D  TKACDT       E                     EXTFLD(BEACDT)
     D  TKAQCD       E                     EXTFLD(BEAQCD)
     D  TKB6NA       E                     EXTFLD(BEB6NA)
     D  TKBYNA       E                     EXTFLD(BEBYNA)
     D  TKBZNA       E                     EXTFLD(BEBZNA)
     D  TKGTST       E                     EXTFLD(BEGTST)
     D  TKGVST       E                     EXTFLD(BEGVST)
     D  TKGUST       E                     EXTFLD(BEGUST)
     D  TKQFST       E                     EXTFLD(BEQFST)
     D  TKCQCD       E                     EXTFLD(BECQCD)
     D  TKGJST       E                     EXTFLD(BEGJST)
     D  TKGWST       E                     EXTFLD(BEGWST)
     D  TKGXST       E                     EXTFLD(BEGXST)
     D  TKGYST       E                     EXTFLD(BEGYST)
     D  TKAODT       E                     EXTFLD(BEAODT)
     D  TKAIVN       E                     EXTFLD(BEAIVN)
     D  TKCXDT       E                     EXTFLD(BECXDT)
     D  TKJZVA       E                     EXTFLD(BEJZVA)
     D  TKA1WG       E                     EXTFLD(BEA1WG)
     D  TKXIST       E                     EXTFLD(BEXIST)
     D  TKXJST       E                     EXTFLD(BEXJST)
     D  TKXKST       E                     EXTFLD(BEXKST)
     D  TKEIDT       E                     EXTFLD(BEEIDT)
     D  TKAFTM       E                     EXTFLD(BEAFTM)
     D  TKE8CD       E                     EXTFLD(BEE8CD)
     D  TKE9CD       E                     EXTFLD(BEE9CD)
     D  TKRMNB       E                     EXTFLD(BERMNB)
     D  TKTBNB       E                     EXTFLD(BETBNB)
     D  TKR1NB       E                     EXTFLD(BER1NB)
     D  TKPJST       E                     EXTFLD(BEPJST)
     D  TKU0ST       E                     EXTFLD(BEU0ST)
     D  TKU1ST       E                     EXTFLD(BEU1ST)
     D  TKQ2CD       E                     EXTFLD(BEQ2CD)
     D  TKU2ST       E                     EXTFLD(BEU2ST)
     D  TKVEST       E                     EXTFLD(BEVEST)
     D  TKVFST       E                     EXTFLD(BEVFST)
     D  TKVGST       E                     EXTFLD(BEVGST)
     D  TKRPCD       E                     EXTFLD(BERPCD)
     D  TKRNNB       E                     EXTFLD(BERNNB)
     D  TKVDST       E                     EXTFLD(BEVDST)
     D  TKATIN       E                     EXTFLD(BEATIN)
     D  TKU4ST       E                     EXTFLD(BEU4ST)
     D  TKU5ST       E                     EXTFLD(BEU5ST)
     D  TKRSRN       E                     EXTFLD(BERSRN)
     D  TKMHNA       E                     EXTFLD(BEMHNA)
     D  TKMINA       E                     EXTFLD(BEMINA)
     D  TKWBST       E                     EXTFLD(BEWBST)
     D  TKR4CD       E                     EXTFLD(BER4CD)
     D  TKBFCD       E                     EXTFLD(BEBFCD)
     D  TKQ4CD       E                     EXTFLD(BEQ4CD)
     D  TKT3NB       E                     EXTFLD(BET3NB)
     D  TKSICD       E                     EXTFLD(BESICD)
     D  TKCONB       E                     EXTFLD(BECONB)
     D  TKCEST       E                     EXTFLD(BECEST)
     D  TKAWDT       E                     EXTFLD(BEAWDT)
     D  TKJPCD       E                     EXTFLD(BEJPCD)
     D  TKXUST       E                     EXTFLD(BEXUST)
     D  TKZ1ST       E                     EXTFLD(BEZ1ST)
     D  TKVRVA       E                     EXTFLD(BEVRVA)
     D  TKOBST       E                     EXTFLD(BEOBST)
     D  TKBCST       E                     EXTFLD(BEBCST)
     D  TKBDST       E                     EXTFLD(BEBDST)
     D  TKB7VL       E                     EXTFLD(BEB7VL)
     D  TKGASX       E                     EXTFLD(BEGASX)
     D  TKGBSX       E                     EXTFLD(BEGBSX)
     D  TKGCSX       E                     EXTFLD(BEGCSX)
     D  TKGDSX       E                     EXTFLD(BEGDSX)
     D  TKFNSX       E                     EXTFLD(BEFNSX)
     D  TKFOSX       E                     EXTFLD(BEFOSX)
     D  TKFPSX       E                     EXTFLD(BEFPSX)
     D  TKFQSX       E                     EXTFLD(BEFQSX)
     D  TKFRSX       E                     EXTFLD(BEFRSX)
     D  TKFSSX       E                     EXTFLD(BEFSSX)
     D  TKFTSX       E                     EXTFLD(BEFTSX)
     D  TKFUSX       E                     EXTFLD(BEFUSX)
     D  TKFVSX       E                     EXTFLD(BEFVSX)
     D  TKFWSX       E                     EXTFLD(BEFWSX)
     D  TKFXSX       E                     EXTFLD(BEFXSX)
     D  TKFYSX       E                     EXTFLD(BEFYSX)
     D  TKNODT       E                     EXTFLD(BENODT)
     D  TKNPDT       E                     EXTFLD(BENPDT)
     D  TKNQDT       E                     EXTFLD(BENQDT)
     D  TKNRDT       E                     EXTFLD(BENRDT)
     D  TKNSDT       E                     EXTFLD(BENSDT)
     D  TKBPTM       E                     EXTFLD(BEBPTM)
     D  TKBQTM       E                     EXTFLD(BEBQTM)
     D  TKBRTM       E                     EXTFLD(BEBRTM)
     D  TKBSTM       E                     EXTFLD(BEBSTM)
     D  TKBTTM       E                     EXTFLD(BEBTTM)
     D  TKH0NX       E                     EXTFLD(BEH0NX)
     D  TKH1NX       E                     EXTFLD(BEH1NX)
     D  TKH2NX       E                     EXTFLD(BEH2NX)
     D  TKH3NX       E                     EXTFLD(BEH3NX)
     D  TKH4NX       E                     EXTFLD(BEH4NX)
     D  TKC0C7       E                     EXTFLD(BEC0C7)
     D  TKUVST       E                     EXTFLD(BEUVST)
     D  TKUWST       E                     EXTFLD(BEUWST)
     D  TKUXST       E                     EXTFLD(BEUXST)
     D  TKAATM       E                     EXTFLD(BEAATM)
     D  TKAYNA       E                     EXTFLD(BEAYNA)
     D  TKA0NA       E                     EXTFLD(BEA0NA)
     D  TKAXDT       E                     EXTFLD(BEAXDT)
      *
     D YERDCS          DS           779
      * Outward parameters
     D PIRC            DS           779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     D  PIAIC3                 1      2P 0
      * I :  Order Number
     D  PIC4NB                 3      6P 0
      * I :  Order Type_Sales
     D  PIJNCD                 7      8
      * I :  AR Customer Number
     D  PIANC7                 9     12P 0
      * I :  Ship To Customer
     D  PIBKC7                13     16P 0
      * I :  Ship To Name
     D  PIBRTX                17     46
      * I :  Ship To Address Line 1
     D  PIHMNA                47     76
      * I :  Ship To Address Line 2
     D  PIHONA                77    106
      * I :  Ship To Address Line 3
     D  PIHPNA               107    136
      * I :  Ship To City
     D  PIHNNA               137    156
      * I :  Ship To State Code
     D  PIDBCD               157    158
      * I :  Ship To Zip_Postal Code
     D  PICKTX               159    169
      * I :  Bill to Customer
     D  PIB0C7               170    173P 0
      * I :  Bill to Name
     D  PIAETX               174    203
      * I :  Bill to Address Line 1
     D  PIB1NA               204    233
      * I :  Bill to Address Line 2
     D  PIB3NA               234    263
      * I :  Bill to Address Line 3
     D  PIB4NA               264    293
      * I :  Bill to City
     D  PIB2NA               294    313
      * I :  Bill to State Code
     D  PIBHCD               314    315
      * I :  Bill to Zip_Postal Code
     D  PIC8TX               316    326
      * I :  Customer Purchase Order #
     D  PIBCNA               327    341
      * I :  Order Date
     D  PIA0DT               342    345P 0
      * I :  Requested Ship Date
     D  PIA5DT               346    349P 0
      * I :  Actual Shipped Date
     D  PIGNDT               350    353P 0
      * I :  Cancel Date
     D  PIACDT               354    357P 0
      * I :  Terms Code
     D  PIAQCD               358    359
      * I :  Special Instructions
     D  PIB6NA               360    399
      * I :  Special Instructions 2
     D  PIBYNA               400    439
      * I :  Carrier Code
     D  PIBZNA               440    442
      * I :  Comment Print Acknowledge
     D  PIGTST               443    443
      * I :  Comment Print Inv_Cr_Memo
     D  PIGVST               444    444
      * I :  Comment Print Pick Slip
     D  PIGUST               445    445
      * I :  Comment Print Ship Doc
     D  PIQFST               446    446
      * I :  Reason Code
     D  PICQCD               447    449
      * I :  Order in Use
     D  PIGJST               450    450
      * I :  Header Status
     D  PIGWST               451    451
      * I :  Header Status Last
     D  PIGXST               452    452
      * I :  Order Type Print Status
     D  PIGYST               453    453
      * I :  Scheduled Ship Date
     D  PIAODT               454    457P 0
      * I :  User Original Entry
     D  PIAIVN               458    467
      * I :  Date of Original Entry
     D  PICXDT               468    471P 0
      * I :  Order Value Total
     D  PIJZVA               472    477P 2
      * I :  Order Weight Total
     D  PIA1WG               478    483P 2
      * I :  Credit Hold
     D  PIXIST               484    484
      * I :  Production Hold
     D  PIXJST               485    485
      * I :  New Customer Hold
     D  PIXKST               486    486
      * I :  Requested Delivery Date
     D  PIEIDT               487    490P 0
      * I :  Requested Delivery Time
     D  PIAFTM               491    493P 0
      * I :  Accounts Receiv_Ent 1
     D  PIE8CD               494    497
      * I :  Accounts Receiv_Ent 2
     D  PIE9CD               498    509
      * I :  Load ID
     D  PIRMNB               510    513P 0
      * I :  Absorbed Freight Rate CWT
     D  PITBNB               514    516P 2
      * I :  Rated Freight
     D  PIR1NB               517    522P 2
      * I :  LTL Flag
     D  PIPJST               523    523
      * I :  Price Audit
     D  PIU0ST               524    524
      * I :  Price Status
     D  PIU1ST               525    525
      * I :  Shipping Method
     D  PIQ2CD               526    527
      * I :  Export Status
     D  PIU2ST               528    528
      * I :  Palletize
     D  PIVEST               529    529
      * I :  Shrink Wrap
     D  PIVFST               530    530
      * I :  Slip Sheet
     D  PIVGST               531    531
      * I :  Age Code
     D  PIRPCD               532    532
      * I :  Reefer Temperature
     D  PIRNNB               533    535P 2
      * I :  Load Type
     D  PIVDST               536    536
      * I :  Attach to Invoice Number
     D  PIATIN               537    540P 0
      * I :  Load Plan Order
     D  PIU4ST               541    541
      * I :  Print Pick Slip
     D  PIU5ST               542    542
      * I :  Resell Reference Number
     D  PIRSRN               543    546P 0
      * I :  Special Comment 1
     D  PIMHNA               547    576
      * I :  Special Comment 2
     D  PIMINA               577    606
      * I :  Affect Auto Accruals
     D  PIWBST               607    607
      * I :  Sales Route Code
     D  PIR4CD               608    610
      * I :  Manager Level Code
     D  PIBFCD               611    612
      * I :  VP Level Code
     D  PIQ4CD               613    615
      * I :  Attach to Order Number
     D  PIT3NB               616    619P 0
      * I :  Reason for Price Audit
     D  PISICD               620    622
      * I :  Invoice Number
     D  PICONB               623    626P 0
      * I :  Invoice Suffix
     D  PICEST               627    628
      * I :  Invoice Date
     D  PIAWDT               629    632P 0
      * I :  Event Code
     D  PIJPCD               633    634
      * I :  Trans Contol AS400_Plant
     D  PIXUST               635    635
      * I :  Modified Flag
     D  PIZ1ST               636    636
      * I :  A_R order Value Total
     D  PIVRVA               637    642P 2
      * I :  Billing Activity Type
     D  PIOBST               643    643
      * I :  Block Order Flag
     D  PIBCST               644    644
      * I :  Order Certification Flag
     D  PIBDST               645    645
      * I :  Invoice Order Value Tot
     D  PIB7VL               646    651P 2
      * I :  Process Sts for 3C
     D  PIGASX               652    652
      * I :  Order Conf Fax Sts
     D  PIGBSX               653    653
      * I :  Manifest Fax Sts
     D  PIGCSX               654    654
      * I :  Invoice Fax Sts
     D  PIGDSX               655    655
      * I :  Transfer in Storage Ind
     D  PIFNSX               656    656
      * I :  Email Cust On Order Ship
     D  PIFOSX               657    657
      * I :  Order Emailed
     D  PIFPSX               658    658
      * I :  Export Docs Go w_Driver
     D  PIFQSX               659    659
      * I :  Shipping Temp Code C_F
     D  PIFRSX               660    660
      * I :  Broker Order Status
     D  PIFSSX               661    661
      * I :  Air Freight Order
     D  PIFTSX               662    662
      * I :  Order Requires Review
     D  PIFUSX               663    664
      * I :  OH Load Plan Ready
     D  PIFVSX               665    666
      * I :  Export USDA Approved
     D  PIFWSX               667    668
      * I :  HPB Ship to Warehouse
     D  PIFXSX               669    671
      * I :  OH TF Exempt Code
     D  PIFYSX               672    674
      * I :  OH Appt Confirmation Dt
     D  PINODT               675    678P 0
      * I :  JPN Invoice Issuance Date
     D  PINPDT               679    682P 0
      * I :  Load Actual Shipped Date
     D  PINQDT               683    686P 0
      * I :  Load BOL Complete Date
     D  PINRDT               687    690P 0
      * I :  Load Truck Departure Date
     D  PINSDT               691    694P 0
      * I :  Maximum Gross Weight
     D  PIBPTM               695    698P 0
      * I :  Time of Original Entry
     D  PIBQTM               699    702P 0
      * I :  OH Appt Confirmation Tm
     D  PIBRTM               703    706P 0
      * I :  Load BOL Complete Time
     D  PIBSTM               707    710P 0
      * I :  Load Truck Departure Time
     D  PIBTTM               711    714P 0
      * I :  Act Frt Reference Amount
     D  PIH0NX               715    720P 2
      * I :  Act Non_Ref Frt Amount
     D  PIH1NX               721    726P 2
      * I :  OH Fuel Surcharge Amount
     D  PIH2NX               727    732P 2
      * I :  OH Total Non_Ref Frt Amt
     D  PIH3NX               733    738P 2
      * I :  OH Total Ref Frt Amt
     D  PIH4NX               739    744P 2
      * I :  Claim Number
     D  PIC0C7               745    748P 0
      * I :  EDI Status 1
     D  PIUVST               749    749
      * I :  EDI Status 2
     D  PIUWST               750    750
      * I :  EDI Status 3
     D  PIUXST               751    751
      * I :  Job Time
     D  PIAATM               752    755P 0
      * I :  User Id
     D  PIAYNA               756    765
      * I :  Job Name
     D  PIA0NA               766    775
      * I :  Job Date
     D  PIAXDT               776    779P 0
      *
     D YFRDCS          DS           525
     D QOPBF2        E DS                  EXTNAME(OPBFCPW0)
      * UPD : Order Header TRG          Update Index WORK
      * Renamed input format fields
     D  TLAIC3       E                     EXTFLD(BEAIC3)
     D  TLC4NB       E                     EXTFLD(BEC4NB)
     D  TLJNCD       E                     EXTFLD(BEJNCD)
     D  TLANC7       E                     EXTFLD(BEANC7)
     D  TLBKC7       E                     EXTFLD(BEBKC7)
     D  TLBRTX       E                     EXTFLD(BEBRTX)
     D  TLHMNA       E                     EXTFLD(BEHMNA)
     D  TLHONA       E                     EXTFLD(BEHONA)
     D  TLHPNA       E                     EXTFLD(BEHPNA)
     D  TLHNNA       E                     EXTFLD(BEHNNA)
     D  TLDBCD       E                     EXTFLD(BEDBCD)
     D  TLCKTX       E                     EXTFLD(BECKTX)
     D  TLB0C7       E                     EXTFLD(BEB0C7)
     D  TLAETX       E                     EXTFLD(BEAETX)
     D  TLB1NA       E                     EXTFLD(BEB1NA)
     D  TLB3NA       E                     EXTFLD(BEB3NA)
     D  TLB4NA       E                     EXTFLD(BEB4NA)
     D  TLB2NA       E                     EXTFLD(BEB2NA)
     D  TLBHCD       E                     EXTFLD(BEBHCD)
     D  TLC8TX       E                     EXTFLD(BEC8TX)
     D  TLBCNA       E                     EXTFLD(BEBCNA)
     D  TLA0DT       E                     EXTFLD(BEA0DT)
     D  TLA5DT       E                     EXTFLD(BEA5DT)
     D  TLGNDT       E                     EXTFLD(BEGNDT)
     D  TLACDT       E                     EXTFLD(BEACDT)
     D  TLAQCD       E                     EXTFLD(BEAQCD)
     D  TLB6NA       E                     EXTFLD(BEB6NA)
     D  TLBYNA       E                     EXTFLD(BEBYNA)
     D  TLBZNA       E                     EXTFLD(BEBZNA)
     D  TLGTST       E                     EXTFLD(BEGTST)
     D  TLGVST       E                     EXTFLD(BEGVST)
     D  TLGUST       E                     EXTFLD(BEGUST)
     D  TLQFST       E                     EXTFLD(BEQFST)
     D  TLCQCD       E                     EXTFLD(BECQCD)
     D  TLGJST       E                     EXTFLD(BEGJST)
     D  TLGWST       E                     EXTFLD(BEGWST)
     D  TLGXST       E                     EXTFLD(BEGXST)
     D  TLGYST       E                     EXTFLD(BEGYST)
     D  TLAODT       E                     EXTFLD(BEAODT)
     D  TLAIVN       E                     EXTFLD(BEAIVN)
     D  TLCXDT       E                     EXTFLD(BECXDT)
     D  TLJZVA       E                     EXTFLD(BEJZVA)
     D  TLA1WG       E                     EXTFLD(BEA1WG)
     D  TLXIST       E                     EXTFLD(BEXIST)
     D  TLXJST       E                     EXTFLD(BEXJST)
     D  TLXKST       E                     EXTFLD(BEXKST)
     D  TLEIDT       E                     EXTFLD(BEEIDT)
     D  TLAFTM       E                     EXTFLD(BEAFTM)
     D  TLE8CD       E                     EXTFLD(BEE8CD)
     D  TLE9CD       E                     EXTFLD(BEE9CD)
     D  TLRMNB       E                     EXTFLD(BERMNB)
     D  TLTBNB       E                     EXTFLD(BETBNB)
     D  TLR1NB       E                     EXTFLD(BER1NB)
     D  TLPJST       E                     EXTFLD(BEPJST)
     D  TLU0ST       E                     EXTFLD(BEU0ST)
     D  TLU1ST       E                     EXTFLD(BEU1ST)
     D  TLQ2CD       E                     EXTFLD(BEQ2CD)
     D  TLU2ST       E                     EXTFLD(BEU2ST)
     D  TLVEST       E                     EXTFLD(BEVEST)
     D  TLVFST       E                     EXTFLD(BEVFST)
     D  TLVGST       E                     EXTFLD(BEVGST)
     D  TLRPCD       E                     EXTFLD(BERPCD)
     D  TLRNNB       E                     EXTFLD(BERNNB)
     D  TLVDST       E                     EXTFLD(BEVDST)
     D  TLATIN       E                     EXTFLD(BEATIN)
     D  TLU4ST       E                     EXTFLD(BEU4ST)
     D  TLU5ST       E                     EXTFLD(BEU5ST)
     D  TLRSRN       E                     EXTFLD(BERSRN)
     D  TLMHNA       E                     EXTFLD(BEMHNA)
     D  TLMINA       E                     EXTFLD(BEMINA)
     D  TLWBST       E                     EXTFLD(BEWBST)
     D  TLR4CD       E                     EXTFLD(BER4CD)
     D  TLBFCD       E                     EXTFLD(BEBFCD)
     D  TLQ4CD       E                     EXTFLD(BEQ4CD)
     D  TLT3NB       E                     EXTFLD(BET3NB)
     D  TLSICD       E                     EXTFLD(BESICD)
     D  TLCONB       E                     EXTFLD(BECONB)
     D  TLCEST       E                     EXTFLD(BECEST)
     D  TLAWDT       E                     EXTFLD(BEAWDT)
     D  TLJPCD       E                     EXTFLD(BEJPCD)
     D  TLXUST       E                     EXTFLD(BEXUST)
     D  TLZ1ST       E                     EXTFLD(BEZ1ST)
     D  TLVRVA       E                     EXTFLD(BEVRVA)
     D  TLOBST       E                     EXTFLD(BEOBST)
     D  TLBCST       E                     EXTFLD(BEBCST)
     D  TLBDST       E                     EXTFLD(BEBDST)
     D  TLB7VL       E                     EXTFLD(BEB7VL)
     D  TLGASX       E                     EXTFLD(BEGASX)
     D  TLGBSX       E                     EXTFLD(BEGBSX)
     D  TLGCSX       E                     EXTFLD(BEGCSX)
     D  TLGDSX       E                     EXTFLD(BEGDSX)
     D  TLFNSX       E                     EXTFLD(BEFNSX)
     D  TLFOSX       E                     EXTFLD(BEFOSX)
     D  TLFPSX       E                     EXTFLD(BEFPSX)
     D  TLFQSX       E                     EXTFLD(BEFQSX)
     D  TLFRSX       E                     EXTFLD(BEFRSX)
     D  TLFSSX       E                     EXTFLD(BEFSSX)
     D  TLFTSX       E                     EXTFLD(BEFTSX)
     D  TLFUSX       E                     EXTFLD(BEFUSX)
     D  TLFVSX       E                     EXTFLD(BEFVSX)
     D  TLFWSX       E                     EXTFLD(BEFWSX)
     D  TLFXSX       E                     EXTFLD(BEFXSX)
     D  TLFYSX       E                     EXTFLD(BEFYSX)
     D  TLNODT       E                     EXTFLD(BENODT)
     D  TLNPDT       E                     EXTFLD(BENPDT)
     D  TLNQDT       E                     EXTFLD(BENQDT)
     D  TLNRDT       E                     EXTFLD(BENRDT)
     D  TLNSDT       E                     EXTFLD(BENSDT)
     D  TLBPTM       E                     EXTFLD(BEBPTM)
     D  TLBQTM       E                     EXTFLD(BEBQTM)
     D  TLBRTM       E                     EXTFLD(BEBRTM)
     D  TLBSTM       E                     EXTFLD(BEBSTM)
     D  TLBTTM       E                     EXTFLD(BEBTTM)
     D  TLH0NX       E                     EXTFLD(BEH0NX)
     D  TLH1NX       E                     EXTFLD(BEH1NX)
     D  TLH2NX       E                     EXTFLD(BEH2NX)
     D  TLH3NX       E                     EXTFLD(BEH3NX)
     D  TLH4NX       E                     EXTFLD(BEH4NX)
     D  TLC0C7       E                     EXTFLD(BEC0C7)
     D  TLUVST       E                     EXTFLD(BEUVST)
     D  TLUWST       E                     EXTFLD(BEUWST)
     D  TLUXST       E                     EXTFLD(BEUXST)
     D  TLAATM       E                     EXTFLD(BEAATM)
     D  TLAYNA       E                     EXTFLD(BEAYNA)
     D  TLA0NA       E                     EXTFLD(BEA0NA)
     D  TLAXDT       E                     EXTFLD(BEAXDT)
      *
     D YGRDCS          DS           779
     D QOMFJ1        E DS                  EXTNAME(OMFJCPL1)
      * UPD : Load Header               Update index
      * Renamed input format fields
     D  TMRMNB       E                     EXTFLD(FJRMNB)
     D  TMAIC3       E                     EXTFLD(FJAIC3)
     D  TMAODT       E                     EXTFLD(FJAODT)
     D  TMPJST       E                     EXTFLD(FJPJST)
     D  TMPKST       E                     EXTFLD(FJPKST)
     D  TMRNNB       E                     EXTFLD(FJRNNB)
     D  TMDMTX       E                     EXTFLD(FJDMTX)
     D  TMDNTX       E                     EXTFLD(FJDNTX)
     D  TMDOTX       E                     EXTFLD(FJDOTX)
     D  TMWTTX       E                     EXTFLD(FJWTTX)
     D  TMWUTX       E                     EXTFLD(FJWUTX)
     D  TMRPNB       E                     EXTFLD(FJRPNB)
     D  TMFLAM       E                     EXTFLD(FJFLAM)
     D  TMXQST       E                     EXTFLD(FJXQST)
     D  TMRRNB       E                     EXTFLD(FJRRNB)
     D  TMDXTX       E                     EXTFLD(FJDXTX)
     D  TMDYTX       E                     EXTFLD(FJDYTX)
     D  TMSBNB       E                     EXTFLD(FJSBNB)
     D  TMBZNA       E                     EXTFLD(FJBZNA)
     D  TMRONB       E                     EXTFLD(FJRONB)
     D  TMSQNB       E                     EXTFLD(FJSQNB)
     D  TMR1NB       E                     EXTFLD(FJR1NB)
     D  TMVCST       E                     EXTFLD(FJVCST)
     D  TMVDST       E                     EXTFLD(FJVDST)
     D  TMSDNB       E                     EXTFLD(FJSDNB)
     D  TMPAOU       E                     EXTFLD(FJPAOU)
     D  TMDGWG       E                     EXTFLD(FJDGWG)
     D  TMSXNB       E                     EXTFLD(FJSXNB)
     D  TMHADT       E                     EXTFLD(FJHADT)
     D  TMAART       E                     EXTFLD(FJAART)
     D  TMDHWG       E                     EXTFLD(FJDHWG)
     D  TMDIWG       E                     EXTFLD(FJDIWG)
     D  TMAQDT       E                     EXTFLD(FJAQDT)
     D  TMS6NB       E                     EXTFLD(FJS6NB)
     D  TMT4NB       E                     EXTFLD(FJT4NB)
     D  TMPRTM       E                     EXTFLD(FJPRTM)
     D  TMNPSV       E                     EXTFLD(FJNPSV)
     D  TMJ8TX       E                     EXTFLD(FJJ8TX)
     D  TMTLMI       E                     EXTFLD(FJTLMI)
     D  TMJ9TX       E                     EXTFLD(FJJ9TX)
     D  TMQ2CD       E                     EXTFLD(FJQ2CD)
     D  TMVPCD       E                     EXTFLD(FJVPCD)
     D  TMDBCD       E                     EXTFLD(FJDBCD)
     D  TMGRWE       E                     EXTFLD(FJGRWE)
     D  TMXCCD       E                     EXTFLD(FJXCCD)
     D  TMU2ST       E                     EXTFLD(FJU2ST)
     D  TMF9DT       E                     EXTFLD(FJF9DT)
     D  TMONTM       E                     EXTFLD(FJONTM)
     D  TMJ4DT       E                     EXTFLD(FJJ4DT)
     D  TMTRTM       E                     EXTFLD(FJTRTM)
     D  TMJ5DT       E                     EXTFLD(FJJ5DT)
     D  TMSPTM       E                     EXTFLD(FJSPTM)
     D  TMJ6DT       E                     EXTFLD(FJJ6DT)
     D  TMLFTM       E                     EXTFLD(FJLFTM)
     D  TMJ7DT       E                     EXTFLD(FJJ7DT)
     D  TMBOTM       E                     EXTFLD(FJBOTM)
     D  TMJ8DT       E                     EXTFLD(FJJ8DT)
     D  TMBLTM       E                     EXTFLD(FJBLTM)
     D  TMKIDT       E                     EXTFLD(FJKIDT)
     D  TMASTM       E                     EXTFLD(FJASTM)
     D  TMKADT       E                     EXTFLD(FJKADT)
     D  TMAJCM       E                     EXTFLD(FJAJCM)
     D  TMXACD       E                     EXTFLD(FJXACD)
     D  TMOANA       E                     EXTFLD(FJOANA)
     D  TMK4TX       E                     EXTFLD(FJK4TX)
     D  TMVOAG       E                     EXTFLD(FJVOAG)
     D  TMKBDT       E                     EXTFLD(FJKBDT)
     D  TMNBBO       E                     EXTFLD(FJNBBO)
     D  TMW4CD       E                     EXTFLD(FJW4CD)
     D  TMEFDT       E                     EXTFLD(FJEFDT)
     D  TMCNTN       E                     EXTFLD(FJCNTN)
     D  TMKCDT       E                     EXTFLD(FJKCDT)
     D  TMTMIN       E                     EXTFLD(FJTMIN)
     D  TMKDDT       E                     EXTFLD(FJKDDT)
     D  TMVMNB       E                     EXTFLD(FJVMNB)
     D  TMOCFR       E                     EXTFLD(FJOCFR)
     D  TMKJDT       E                     EXTFLD(FJKJDT)
     D  TMATTM       E                     EXTFLD(FJATTM)
     D  TMOTRS       E                     EXTFLD(FJOTRS)
     D  TMRNST       E                     EXTFLD(FJRNST)
     D  TMBRBK       E                     EXTFLD(FJBRBK)
     D  TMEIDT       E                     EXTFLD(FJEIDT)
     D  TMRMST       E                     EXTFLD(FJRMST)
     D  TMAJCD       E                     EXTFLD(FJAJCD)
     D  TMKKDT       E                     EXTFLD(FJKKDT)
     D  TMAVTM       E                     EXTFLD(FJAVTM)
     D  TMKZDT       E                     EXTFLD(FJKZDT)
     D  TMAXTM       E                     EXTFLD(FJAXTM)
     D  TMLHOS       E                     EXTFLD(FJLHOS)
     D  TMLHOR       E                     EXTFLD(FJLHOR)
     D  TMWNTX       E                     EXTFLD(FJWNTX)
     D  TMOITX       E                     EXTFLD(FJOITX)
     D  TMOJTX       E                     EXTFLD(FJOJTX)
     D  TMLLDT       E                     EXTFLD(FJLLDT)
     D  TMLSHG       E                     EXTFLD(FJLSHG)
     D  TMYPST       E                     EXTFLD(FJYPST)
     D  TMK0DT       E                     EXTFLD(FJK0DT)
     D  TMAYTM       E                     EXTFLD(FJAYTM)
     D  TMKNNX       E                     EXTFLD(FJKNNX)
     D  TMICWG       E                     EXTFLD(FJICWG)
     D  TMIDWG       E                     EXTFLD(FJIDWG)
     D  TMH9SX       E                     EXTFLD(FJH9SX)
     D  TMWOTX       E                     EXTFLD(FJWOTX)
     D  TMK1DT       E                     EXTFLD(FJK1DT)
     D  TMAZTM       E                     EXTFLD(FJAZTM)
     D  TMK2DT       E                     EXTFLD(FJK2DT)
     D  TMA0TM       E                     EXTFLD(FJA0TM)
     D  TMROST       E                     EXTFLD(FJROST)
     D  TMRPST       E                     EXTFLD(FJRPST)
     D  TMRQST       E                     EXTFLD(FJRQST)
     D  TMRRST       E                     EXTFLD(FJRRST)
     D  TMZBVA       E                     EXTFLD(FJZBVA)
     D  TMWPTX       E                     EXTFLD(FJWPTX)
     D  TMWQTX       E                     EXTFLD(FJWQTX)
     D  TMWRTX       E                     EXTFLD(FJWRTX)
     D  TMWSTX       E                     EXTFLD(FJWSTX)
     D  TMRVSX       E                     EXTFLD(FJRVSX)
     D  TMRUSX       E                     EXTFLD(FJRUSX)
     D  TMRWSX       E                     EXTFLD(FJRWSX)
     D  TMRXSX       E                     EXTFLD(FJRXSX)
     D  TMRYSX       E                     EXTFLD(FJRYSX)
     D  TMRZSX       E                     EXTFLD(FJRZSX)
     D  TMR0SX       E                     EXTFLD(FJR0SX)
     D  TMR1SX       E                     EXTFLD(FJR1SX)
     D  TMR2SX       E                     EXTFLD(FJR2SX)
     D  TMR3SX       E                     EXTFLD(FJR3SX)
     D  TMR4SX       E                     EXTFLD(FJR4SX)
     D  TMPYDT       E                     EXTFLD(FJPYDT)
     D  TMCKTM       E                     EXTFLD(FJCKTM)
     D  TMPZDT       E                     EXTFLD(FJPZDT)
     D  TMCLTM       E                     EXTFLD(FJCLTM)
     D  TMP0DT       E                     EXTFLD(FJP0DT)
     D  TMCMTM       E                     EXTFLD(FJCMTM)
     D  TMP1DT       E                     EXTFLD(FJP1DT)
     D  TMCNTM       E                     EXTFLD(FJCNTM)
     D  TMP2DT       E                     EXTFLD(FJP2DT)
     D  TMCOTM       E                     EXTFLD(FJCOTM)
     D  TMP3DT       E                     EXTFLD(FJP3DT)
     D  TMCQTM       E                     EXTFLD(FJCQTM)
     D  TMUVST       E                     EXTFLD(FJUVST)
     D  TMUWST       E                     EXTFLD(FJUWST)
     D  TMUXST       E                     EXTFLD(FJUXST)
     D  TMAATM       E                     EXTFLD(FJAATM)
     D  TMAYNA       E                     EXTFLD(FJAYNA)
     D  TMA0NA       E                     EXTFLD(FJA0NA)
     D  TMAXDT       E                     EXTFLD(FJAXDT)
      *
     D YHRDCS          DS           793
     D YIRDCS          DS           779
     D YL0492          DS           500
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WN0001         S              1
     D  WQ0001         S              1
     D  W0CLPG         S             10
     D  YL0001         S              1
     D  YL0002         S              1
     D  YN0001         S              3  0
     D  YN0002         S              7  0
     D  YN0003         S              1
     D  YN0004         S              1
     D  YL0003         S              9
     D  YL0004         S             65
     D  ZQ             S              5  0
     D  WQ0002         S              9  0
     D  WQ0003         S              7  0
     D  WQ0004         S              6
     D  WQ0005         S             65
     D  WQ0006         S              9  0
     D  WQ0007         S              7  0
     D  WQ0008         S              6
     D  WQ0009         S             65
     D  YL0005         S             30
     D  YL0006         S             30
     D  YL0007         S             30
     D  YL0008         S             30
     D  YL0009         S             20
     D  YL0010         S              2
     D  YN0005         S              6
     D  YL0011         S             11
     D  YN0006         S             25
     D  YN0007         S             25
     D  YN0008         S             25
     D  YN0009         S             20
     D  YN0010         S              1
     D  YN0011         S              8
     D  YN0012         S              9  0
     D  YN0013         S              5
     D  YN0014         S              7  0
     D  YN0015         S              7  0
     D  YL0012         S              7  0
     D  YN0016         S              7  0
     D  YN0017         S              1
     D  YN0018         S              1
     D  YN0019         S              6
     D  YN0020         S              1
     D  YN0021         S              1
     D  YN0022         S             11  2
     D  YN0023         S             11  2
     D  YN0024         S              7  0
     D  YN0025         S              1
     D  YN0026         S              1
     D  YL0013         S              1
     D  YN0027         S              1
     D  YN0028         S              1
     D  YN0029         S              1
     D  YN0030         S              1
     D  YN0031         S              1
     D  YN0032         S              1
     D  YN0033         S              6  0
     D  YN0034         S             10
     D  YN0035         S             10
     D  YN0036         S              7  0
     D  WQSD01         S                   LIKE(WDBKC7)
     D  YL0014         S              1
     D  YL0015         S             30
     D  YL0016         S             30
     D  YL0017         S             30
     D  YL0018         S             30
     D  YL0019         S             20
     D  YL0020         S              2
     D  YL0021         S             11
     D  WQ0010         S              9  0
     D  WQ0011         S              7  0
     D  WQ0012         S              6
     D  WQ0013         S             65
     D  WQ0014         S              9  0
     D  WQ0015         S              7  0
     D  WQ0016         S              6
     D  WQ0017         S             65
     D  YL0022         S              1
     D  YL0023         S              1
     D  WQ0018         S              7  0
     D  WQ0019         S              1
     D  WQ0020         S              1
     D  WQ0021         S              9  0
     D  WQ0022         S              7  0
     D  WQ0023         S              6
     D  WQ0024         S             65
     D  WQ0025         S              9  0
     D  WQ0026         S              7  0
     D  WQ0027         S              6
     D  WQ0028         S             65
     D  YL0024         S              2
     D  YL0025         S              3
     D  YL0026         S             40
     D  YL0027         S             40
     D  YN0037         S              3
     D  YN0038         S              1
     D  YL0028         S              4  0
     D  YL0029         S              2
     D  YL0030         S              5  2
     D  YN0039         S              9  2
     D  YN0040         S              3
     D  YL0031         S              1
     D  YN0041         S              3
     D  YN0042         S              3
     D  YN0043         S              1
     D  YL0032         S              1
     D  WQ0029         S              3  0
     D  WQ0030         S              7  0
     D  WQ0031         S              2
     D  WQ0032         S              3
     D  WQ0033         S             40
     D  WQ0034         S             40
     D  WQ0035         S              3
     D  WQ0036         S              1
     D  WQ0037         S              4  0
     D  WQ0038         S              2
     D  WQ0039         S              5  2
     D  WQ0040         S              9  2
     D  WQ0041         S              3
     D  WQ0042         S              1
     D  WQ0043         S              3
     D  WQ0044         S              3
     D  WQ0045         S              1
     D  WQ0046         S              1
     D  Y0CX01         S              1
     D  WQ0047         S              9  0
     D  WQ0048         S              7  0
     D  WQ0049         S              6
     D  WQ0050         S             65
     D  WQ0051         S              9  0
     D  WQ0052         S              7  0
     D  WQ0053         S              6
     D  WQ0054         S             65
     D  YL0033         S              3
     D  WQ0055         S              3
     D  WQ0056         S              3
     D  WQ0057         S              9  0
     D  WQ0058         S              7  0
     D  WQ0059         S              6
     D  WQ0060         S             65
     D  WQ0061         S              3
     D  WQ0062         S              2
     D  WQ0063         S              9  0
     D  WQ0064         S              7  0
     D  WQ0065         S              6
     D  WQ0066         S             65
     D  YL0034         S              2
     D  YL0035         S              3
     D  WQ0067         S              3
     D  WQ0068         S              3
     D  WQ0069         S              2
     D  WQ0070         S              3
     D  WQ0071         S              9  0
     D  WQ0072         S              7  0
     D  WQ0073         S              6
     D  WQ0074         S             65
     D  YL0036         S             30
     D  WQ0075         S              2
     D  WQ0076         S             30
     D  WQ0077         S              3
     D  YN0044         S             10
     D  YN0045         S              2
     D  YN0046         S             10
     D  YN0047         S              1
     D  YN0048         S             25
     D  YN0049         S              2
     D  YN0050         S              3
     D  YN0051         S              5  0
     D  YL0037         S              6  0
     D  WL0001         S              7  0
     D  WL0002         S             10
     D  WL0003         S              2
     D  WL0004         S             10
     D  WL0005         S              1
     D  WL0006         S             25
     D  WL0007         S              2
     D  WL0008         S              3
     D  WL0009         S              5  0
     D  WL0010         S              6  0
     D  YL0038         S              6
     D  YL0039         S              4
     D  YN0052         S              2
     D  YL0040         S              1
     D  YL0041         S              1
     D  YN0053         S              1
     D  YL0042         S              1
     D  YN0054         S              4  0
     D  YN0055         S              6
     D  YN0056         S              1
     D  YN0057         S              1
     D  YL0043         S              1
     D  YL0044         S              1
     D  YL0045         S              1
     D  WQ0078         S              3  0
     D  WQ0079         S              2
     D  WQ0080         S              1
     D  WQ0081         S              1
     D  WQ0082         S              1
     D  WQ0083         S              1
     D  WQ0084         S              4  0
     D  WQ0085         S              6
     D  WQ0086         S              1
     D  WQ0087         S              1
     D  WQ0088         S              1
     D  WQ0089         S              1
     D  WQ0090         S              1
     D  YL0046         S              1
     D  YL0047         S              2
     D  WQ0091         S              9  0
     D  WQ0092         S              7  0
     D  WQ0093         S              6
     D  WQ0094         S             65
     D  WQ0095         S              9  0
     D  WQ0096         S              7  0
     D  WQ0097         S              6
     D  WQ0098         S             65
     D  Y0CX02         S              1
     D  WQ0099         S              9  0
     D  WQ0100         S              7  0
     D  WQ0101         S              6
     D  WQ0102         S             65
     D  YL0048         S              1
     D  WL0011         S              6
     D  WL0012         S              1
     D  WQ0103         S              9  0
     D  WQ0104         S              7  0
     D  WQ0105         S              6
     D  WQ0106         S             65
     D  WQ0107         S              9  0
     D  WQ0108         S              7  0
     D  WQ0109         S              6
     D  WQ0110         S             65
     D  WQ0111         S              9  0
     D  WQ0112         S              7  0
     D  WQ0113         S              6
     D  WQ0114         S             65
     D  YL0049         S              2
     D  YN0058         S             15
     D  WQ0115         S              7  0
     D  WQ0116         S              2
     D  WQ0117         S             15
     D  WQ0118         S              1
     D  WQ0119         S              9  0
     D  WQ0120         S              7  0
     D  WQ0121         S              6
     D  WQ0122         S             65
     D  YN0059         S             30
     D  YN0060         S              1
     D  YL0050         S              1
     D  YL0051         S              1
     D  YL0052         S              1
     D  YL0053         S              1
     D  WQ0123         S              2
     D  WQ0124         S             30
     D  WQ0125         S              1
     D  WQ0126         S              1
     D  WQ0127         S              1
     D  WQ0128         S              1
     D  WQ0129         S              1
     D  WQ0130         S              9  0
     D  WQ0131         S              7  0
     D  WQ0132         S              6
     D  WQ0133         S             65
     D  WQ0134         S              9  0
     D  WQ0135         S              7  0
     D  WQ0136         S              6
     D  WQ0137         S             65
     D  YN0061         S             30
     D  YN0062         S             30
     D  YN0063         S             30
     D  YN0064         S             30
     D  YN0065         S             20
     D  YN0066         S             11
     D  YL0054         S              3
     D  YN0067         S              2
     D  YN0068         S              1
     D  YN0069         S             10
     D  YL0055         S              2
     D  YL0056         S              1
     D  YN0070         S              1
     D  YN0071         S              1
     D  YN0072         S              5  2
     D  YN0073         S              1
     D  YN0074         S              1
     D  YN0075         S              1
     D  YN0076         S              1
     D  YN0077         S              3  0
     D  YN0078         S              3  0
     D  YN0079         S              3  0
     D  YN0080         S              3  0
     D  YN0081         S              3
     D  YN0082         S              1
     D  YN0083         S              1
     D  YN0084         S              1
     D  YN0085         S              1
     D  YN0086         S              2
     D  YN0087         S              2
     D  YN0088         S              3
     D  YN0089         S              3
     D  YN0090         S              3
     D  WL0013         S              3
     D  WL0014         S             30
     D  WL0015         S             30
     D  WL0016         S             30
     D  WL0017         S             30
     D  WL0018         S             20
     D  WL0019         S             11
     D  WL0020         S              3
     D  WL0021         S              2
     D  WL0022         S              1
     D  WL0023         S             10
     D  WL0024         S              2
     D  WL0025         S              1
     D  WL0026         S              1
     D  WL0027         S              1
     D  WL0028         S              5  2
     D  WL0029         S              1
     D  WL0030         S              1
     D  WL0031         S              1
     D  WL0032         S              1
     D  WL0033         S              3  0
     D  WL0034         S              3  0
     D  WL0035         S              3  0
     D  WL0036         S              3  0
     D  WL0037         S              3
     D  WL0038         S              1
     D  WL0039         S              1
     D  WL0040         S              1
     D  WL0041         S              1
     D  WL0042         S              2
     D  WL0043         S              2
     D  WL0044         S              3
     D  WL0045         S              3
     D  WL0046         S              3
     D  WL0047         S              1
     D  WL0048         S              1
     D  WL0049         S              1
     D  WL0050         S              1
     D  YN0091         S              5  2
     D  YL0057         S              1
     D  WQ0138         S              2
     D  WQ0139         S              5  2
     D  WQ0140         S              1
     D  YL0058         S              5  2
     D  WN0002         S             15  5
     D  YL0059         S              3
     D  YL0060         S              7  0
     D  WL0051         S              3  0
     D  WL0052         S              7  0
     D  WQ0141         S              9  0
     D  WQ0142         S              7  0
     D  WQ0143         S              6
     D  WQ0144         S             65
     D  YL0061         S             10
     D  YL0062         S             11
     D  WQ0145         S             10
     D  WQ0146         S             11
     D  WQ0147         S              8
     D  WQ0148         S              8
     D  WQ0149         S              7
     D  WQ0150         S              9  0
     D  WQ0151         S              7  0
     D  WQ0152         S              6
     D  WQ0153         S             65
     D  WQ0154         S              9  0
     D  WQ0155         S              7  0
     D  WQ0156         S              6
     D  WQ0157         S             65
     D  YL0063         S              1
     D  WQ0158         S              9  0
     D  WQ0159         S              7  0
     D  WQ0160         S              6
     D  WQ0161         S             65
     D  WQ0162         S              9  0
     D  WQ0163         S              7  0
     D  WQ0164         S              6
     D  WQ0165         S             65
     D  WQ0166         S              9  0
     D  WQ0167         S              7  0
     D  WQ0168         S              6
     D  WQ0169         S             65
     D  YL0064         S              1
     D  WQ0170         S              9  0
     D  WQ0171         S              7  0
     D  WQ0172         S              6
     D  WQ0173         S             65
     D  WQ0174         S              9  0
     D  WQ0175         S              7  0
     D  WQ0176         S              6
     D  WQ0177         S             65
     D  WQ0178         S              9  0
     D  WQ0179         S              7  0
     D  WQ0180         S              6
     D  WQ0181         S             65
     D  WQ0182         S             10
     D  WQ0183         S             11
     D  WQ0184         S              8
     D  WQ0185         S              8
     D  WQ0186         S              7
     D  WQ0187         S              9  0
     D  WQ0188         S              7  0
     D  WQ0189         S              6
     D  WQ0190         S             65
     D  WQ0191         S              9  0
     D  WQ0192         S              7  0
     D  WQ0193         S              6
     D  WQ0194         S             65
     D  WQ0195         S              9  0
     D  WQ0196         S              7  0
     D  WQ0197         S              6
     D  WQ0198         S             65
     D  YL0065         S              3
     D  YL0066         S              3
     D  YL0067         S              7  0
     D  YL0068         S              6  0
     D  WQ0199         S              3
     D  WQ0200         S              7  0
     D  WQ0201         S              7  0
     D  WQ0202         S             20
     D  WQ0203         S              2
     D  WQ0204         S              3  0
     D  WQ0205         S              4  0
     D  WQ0206         S              7  0
     D  WQ0207         S              7  0
     D  WQ0208         S              3
     D  WQ0209         S              7  0
     D  WQ0210         S              6  0
     D  WQ0211         S              7  0
     D  YL0069         S             40
     D  Y2LSNO         S              7  0
     D  W0INVL         S             25
     D  W0VLMP         S              1
     D  W0CNNM         S             25
     D  YL0070         S              7
     D  YL0071         S              6
     D  WQ0212         S              9  0
     D  WQ0213         S              7  0
     D  WQ0214         S              6
     D  WQ0215         S             65
     D  XDTSDL         S             26
     D  WN0003         S             30
     D  WN0004         S             30
     D  WN0005         S             30
     D  WN0006         S             30
     D  WN0007         S             30
     D  WN0008         S             30
     D  WN0009         S             37
     D  WQSN01         S                   LIKE(WMHQNZ)
     D  YL0072         S             30
     D  YL0073         S             30
     D  YL0074         S              2
     D  YL0075         S              2
     D  YL0076         S             11  2
     D  YL0077         S              2
     D  YL0078         S              1
     D  YL0079         S              1
     D  YL0080         S              3  0
     D  YL0081         S              3  0
     D  YL0082         S              3  0
     D  YN0092         S              3
     D  YN0093         S              3  0
     D  YL0083         S              3
     D  YN0094         S              7
     D  YN0095         S              3
     D  YN0096         S              3
     D  YN0097         S              5  2
     D  YL0084         S              1
     D  YL0085         S             11  2
     D  YL0086         S              1
     D  YL0087         S              1
     D  WQ0216         S              3  0
     D  WQ0217         S              7  0
     D  WQ0218         S             30
     D  WQ0219         S             30
     D  WQ0220         S              2
     D  WQ0221         S              2
     D  WQ0222         S             11  2
     D  WQ0223         S              2
     D  WQ0224         S              1
     D  WQ0225         S              1
     D  WQ0226         S              3  0
     D  WQ0227         S              3  0
     D  WQ0228         S              3  0
     D  WQ0229         S              3
     D  WQ0230         S              3  0
     D  WQ0231         S              3
     D  WQ0232         S              7
     D  WQ0233         S              3
     D  WQ0234         S              3
     D  WQ0235         S              5  2
     D  WQ0236         S              1
     D  WQ0237         S             11  2
     D  WQ0238         S              1
     D  WQ0239         S              1
     D  YL0088         S             65
     D  WQ0240         S              9  0
     D  WQ0241         S              7  0
     D  WQ0242         S              6
     D  WQ0243         S             65
     D  YL0089         S              1
     D  YL0090         S              2
     D  WQ0244         S              7  0
     D  WQ0245         S              1
     D  WQ0246         S              2
     D  YL0091         S              7  0
     D  WQ0247         S              3  0
     D  WQ0248         S              7  0
     D  WQ0249         S              7  0
     D  YN0098         S             30
     D  YL0092         S              3
     D  YL0093         S             11  4
     D  YN0099         S             11  4
     D  YL0094         S              7
     D  YN0100         S             11  2
     D  YL0095         S              6
     D  WQ0250         S              3  0
     D  WQ0251         S              7  0
     D  WQ0252         S             30
     D  WQ0253         S              3
     D  WQ0254         S             11  4
     D  WQ0255         S             11  4
     D  WQ0256         S              7
     D  WQ0257         S             11  2
     D  WQ0258         S              6
     D  YL0096         S              2
     D  WQ0259         S              7  0
     D  WQ0260         S              2
     D  YL0097         S              3
     D  YL0098         S              7  0
     D  YL0099         S              6
     D  WQ0261         S              9  0
     D  WQ0262         S              7  0
     D  WQ0263         S              6
     D  WQ0264         S             65
     D  WQ0265         S              9  0
     D  WQ0266         S              7  0
     D  WQ0267         S              6
     D  WQ0268         S             65
     D  WQ0269         S              9  0
     D  WQ0270         S              7  0
     D  WQ0271         S              6
     D  WQ0272         S             65
     D  WQ0273         S              9  0
     D  WQ0274         S              7  0
     D  WQ0275         S              6
     D  WQ0276         S             65
     D  YL0100         S              2
     D  WQ0277         S              9  0
     D  WQ0278         S              7  0
     D  WQ0279         S              6
     D  WQ0280         S             65
     D  YL0101         S              1
     D  WQ0281         S              9  0
     D  WQ0282         S              7  0
     D  WQ0283         S              6
     D  WQ0284         S             65
     D  WQ0285         S              9  0
     D  WQ0286         S              7  0
     D  WQ0287         S              6
     D  WQ0288         S             65
     D  YL0102         S              1
     D  WQ0289         S              3  0
     D  WQ0290         S              7  0
     D  WQ0291         S              1
     D  YL0103         S             11  4
     D  WQ0292         S              3  0
     D  WQ0293         S              7  0
     D  WQ0294         S              3
     D  WQ0295         S             11  4
     D  WQ0296         S              1
     D  WQ0297         S              9  0
     D  WQ0298         S              7  0
     D  WQ0299         S              6
     D  WQ0300         S             65
     D  WQ0301         S              9  0
     D  WQ0302         S              7  0
     D  WQ0303         S              6
     D  WQ0304         S             65
     D  YL0104         S              7  0
     D  YL0105         S              7  0
     D  YL0106         S              1
     D  WUB8SX         S              1
     D  WUKWTX         S             30
     D  WUKXTX         S             30
     D  WUKYTX         S             30
     D  WUKZTX         S             30
     D  WUTITX         S             30
     D  WQ0305         S              7  0
     D  WQ0306         S              3
     D  WQ0307         S              1
     D  WQ0308         S             30
     D  WQ0309         S             30
     D  WQ0310         S             30
     D  WQ0311         S             30
     D  WQ0312         S             30
     D  WQ0313         S              3  0
     D  WQ0314         S              7  0
     D  WQ0315         S              7  0
     D  WQ0316         S              4  0
     D  WQ0317         S              7  0
     D  WQ0318         S              7  0
     D  WQ0319         S              7  0
     D  WQ0320         S              7  0
     D  WUW4TX         S             30
     D  WQ0321         S              9  0
     D  WQ0322         S              7  0
     D  WQ0323         S              6
     D  WQ0324         S             65
     D  WQ0325         S              9  0
     D  WQ0326         S              7  0
     D  WQ0327         S              6
     D  WQ0328         S             65
     D  WQ0329         S              9  0
     D  WQ0330         S              7  0
     D  WQ0331         S              6
     D  WQ0332         S             65
     D  WQ0333         S              9  0
     D  WQ0334         S              7  0
     D  WQ0335         S              6
     D  WQ0336         S             65
     D  WQ0337         S              9  0
     D  WQ0338         S              7  0
     D  WQ0339         S              6
     D  WQ0340         S             65
     D  WQ0341         S              9  0
     D  WQ0342         S              7  0
     D  WQ0343         S              6
     D  WQ0344         S             65
     D  YN0101         S             30
     D  YN0102         S              2
     D  YN0103         S             11  2
     D  YN0104         S              2
     D  YN0105         S              1
     D  YN0106         S              1
     D  YN0107         S              3  0
     D  YN0108         S              3  0
     D  YN0109         S              3  0
     D  YN0110         S              3
     D  YN0111         S              1
     D  YN0112         S             11  2
     D  YN0113         S              1
     D  WQ0345         S              3  0
     D  WQ0346         S              7  0
     D  WQ0347         S             30
     D  WQ0348         S             30
     D  WQ0349         S              2
     D  WQ0350         S              2
     D  WQ0351         S             11  2
     D  WQ0352         S              2
     D  WQ0353         S              1
     D  WQ0354         S              1
     D  WQ0355         S              3  0
     D  WQ0356         S              3  0
     D  WQ0357         S              3  0
     D  WQ0358         S              3
     D  WQ0359         S              3  0
     D  WQ0360         S              3
     D  WQ0361         S              7
     D  WQ0362         S              3
     D  WQ0363         S              3
     D  WQ0364         S              5  2
     D  WQ0365         S              1
     D  WQ0366         S             11  2
     D  WQ0367         S              1
     D  YL0107         S              1
     D  WQ0368         S              7  0
     D  WQ0369         S              1
     D  WQ0370         S              9  0
     D  WQ0371         S              7  0
     D  WQ0372         S              6
     D  WQ0373         S             65
     D  YL0108         S              1
     D  WL0053         S              3  0
     D  WL0054         S              7  0
     D  WL0055         S              1
     D  WL0056         S              3  0
     D  WL0057         S              7  0
     D  WQ0374         S              9  0
     D  WQ0375         S              7  0
     D  WQ0376         S              6
     D  WQ0377         S             65
     D  WQ0378         S              9  0
     D  WQ0379         S              7  0
     D  WQ0380         S              6
     D  WQ0381         S             65
     D  YL0109         S              1
     D  YN0114         S              1
     D  WQ0382         S              3  0
     D  WQ0383         S              3
     D  WQ0384         S              1
     D  WQ0385         S              1
     D  YL0110         S              3
     D  YL0111         S              3
     D  WQ0386         S              9  0
     D  WQ0387         S              7  0
     D  WQ0388         S              6
     D  WQ0389         S             65
     D  WQ0390         S              9  0
     D  WQ0391         S              7  0
     D  WQ0392         S              6
     D  WQ0393         S             65
     D  WQ0394         S              9  0
     D  WQ0395         S              7  0
     D  WQ0396         S              6
     D  WQ0397         S             65
     D  YL0112         S              7  0
     D  XDURR          S              8  0
     D  XDWK1          S              8  0
     D  XDWK2          S              6  0
     D  YL0113         S              7  0
     D  YL0114         S             11
     D  YL0115         S             10
     D  WQ0398         S             10
     D  WQ0399         S             11
     D  WQ0400         S              8
     D  WQ0401         S              8
     D  WQ0402         S              7
     D  WQ0403         S              9  0
     D  WQ0404         S              7  0
     D  WQ0405         S              6
     D  WQ0406         S             65
     D  YL0116         S              1
     D  WQ0407         S              9  0
     D  WQ0408         S              7  0
     D  WQ0409         S              6
     D  WQ0410         S             65
     D  WQ0411         S              9  0
     D  WQ0412         S              7  0
     D  WQ0413         S              6
     D  WQ0414         S             65
     D  YL0117         S              1
     D  YL0118         S              2
     D  YN0115         S             10
     D  YN0116         S              2
     D  YN0117         S             10
     D  YN0118         S              1
     D  YN0119         S             25
     D  YN0120         S              3
     D  YN0121         S              5  0
     D  YN0122         S              6  0
     D  YL0119         S              1
     D  YN0123         S              2
     D  YN0124         S              3
     D  YN0125         S             40
     D  YN0126         S             40
     D  YN0127         S              3
     D  YN0128         S              1
     D  YN0129         S              1
     D  YN0130         S              4  0
     D  YN0131         S              4  0
     D  YN0132         S              1
     D  YN0133         S              2
     D  YN0134         S              5  2
     D  YN0135         S              9  2
     D  YN0136         S             11  2
     D  YN0137         S              1
     D  YN0138         S              3
     D  YN0139         S              1
     D  YN0140         S              3
     D  YN0141         S              3
     D  YN0142         S              8
     D  YL0120         S              3
     D  YN0143         S             30
     D  YN0144         S             25
     D  YN0145         S             30
     D  YN0146         S             25
     D  YN0147         S              1
     D  YN0148         S              1
     D  YN0149         S             25
     D  YN0150         S             30
     D  YN0151         S              1
     D  YN0152         S              1
     D  YN0153         S              1
     D  YN0154         S              1
     D  YN0155         S              1
     D  YN0156         S              1
     D  YN0157         S              1
     D  YN0158         S              1
     D  YN0159         S              6  0
     D  YN0160         S             10
     D  YN0161         S             10
     D  YN0162         S              7  0
     D  WL0058         S              3  0
     D  WL0059         S              7  0
     D  WL0060         S              2
     D  WL0061         S              3
     D  WL0062         S             40
     D  WL0063         S             40
     D  WL0064         S              3
     D  WL0065         S              1
     D  WL0066         S              1
     D  WL0067         S              4  0
     D  WL0068         S              4  0
     D  WL0069         S              1
     D  WL0070         S              2
     D  WL0071         S              5  2
     D  WL0072         S              9  2
     D  WL0073         S             11  2
     D  WL0074         S              1
     D  WL0075         S              3
     D  WL0076         S              1
     D  WL0077         S              3
     D  WL0078         S              3
     D  WL0079         S              8
     D  WL0080         S              3
     D  WL0081         S             30
     D  WL0082         S             25
     D  WL0083         S             30
     D  WL0084         S             25
     D  WL0085         S              1
     D  WL0086         S              1
     D  WL0087         S             25
     D  WL0088         S             30
     D  WL0089         S              1
     D  WL0090         S              1
     D  WL0091         S              1
     D  WL0092         S              1
     D  WL0093         S              1
     D  WL0094         S              1
     D  WL0095         S              1
     D  WL0096         S              1
     D  WL0097         S              6  0
     D  WL0098         S             10
     D  WL0099         S             10
     D  WL0100         S              7  0
     D  YL0121         S              1
     D  YL0122         S              3
     D  YL0123         S              3
     D  YL0124         S              1
     D  YL0125         S              7  0
     D  YL0126         S              3
     D  YL0127         S             11  4
     D  YL0128         S             11  4
     D  YL0129         S             11  4
     D  YL0130         S              7  0
     D  YL0131         S              7  0
     D  YL0132         S              2
     D  YL0133         S              5  2
     D  YL0134         S              1
     D  YL0135         S              6
     D  YL0136         S              1
     D  YL0137         S              1
     D  WQ0415         S              3  0
     D  WQ0416         S              3
     D  WQ0417         S              1
     D  WQ0418         S              1
     D  YL0138         S              7
     D  YL0139         S              9  4
     D  YL0140         S              1
     D  WQ0419         S              7
     D  WQ0420         S              9  4
     D  WQ0421         S              1
     D  YL0141         S             11  4
     D  ZADFMF         S             10
     D  YL0142         S              7  0
     D  YL0143         S              7  0
     D  WQ0422         S              7  0
     D  WQ0423         S              6  0
     D  WQ0424         S              7  0
     D  WQ0425         S              7  0
     D  YL0144         S             11  2
     D  YL0145         S             11  4
     D  YL0146         S              3
     D  YL0147         S              3
     D  YL0148         S              3
     D  YL0149         S              1
     D  WQ0426         S              7
     D  WQ0427         S              7  0
     D  WQ0428         S              6  0
     D  WQ0429         S              7  0
     D  WQ0430         S             11  2
     D  WQ0431         S             11  4
     D  WQ0432         S              3
     D  WQ0433         S              3
     D  WQ0434         S              3
     D  WQ0435         S              1
     D  YL0150         S              6
     D  WN0010         S             11  2
     D  WN0011         S             11  2
     D  WN0012         S             11  2
     D  WN0013         S             11  4
     D  WN0014         S              1
     D  YL0151         S             11  2
     D  WQ0436         S             11  2
     D  WQ0437         S              7  0
     D  WQ0438         S             11  2
     D  WUPLDT         S              7  0
     D  WUPMDT         S              7  0
     D  YL0152         S              3
     D  WQ0439         S              7  0
     D  WQ0440         S              6  0
     D  WQ0441         S              7  0
     D  WQ0442         S              7  0
     D  WQ0443         S              7  0
     D  WQ0444         S             11  2
     D  WQ0445         S             11  4
     D  WQ0446         S              3
     D  WQ0447         S              3
     D  WQ0448         S              3
     D  WQ0449         S              1
     D  WL0101         S              3  0
     D  WL0102         S              3
     D  WL0103         S              1
     D  WL0104         S              1
     D  YL0153         S              9  2
     D  YL0154         S             65
     D  YL0155         S              9  0
     D  WQ0450         S              9  0
     D  WQ0451         S              7  0
     D  WQ0452         S              6
     D  WQ0453         S             65
     D  YL0156         S              1
     D  YL0157         S             11  4
     D  YL0158         S              1
     D  YL0159         S             11  4
     D  YL0160         S             11  4
     D  WN0015         S              5  2
     D  WN0016         S              5  2
     D  WN0017         S              7  4
     D  WN0018         S             11  4
     D  WL0105         S              3  0
     D  WL0106         S              5  2
     D  WL0107         S              5  2
     D  WUE7DT         S              7  0
     D  WL0108         S              3
     D  WL0109         S              7
     D  WL0110         S              7  0
     D  WL0111         S             11  4
     D  WL0112         S              7  0
     D  WQST01         S                   LIKE(WWLQCD)
     D  WQST02         S                   LIKE(WWLRCD)
     D  YN0163         S             30
     D  WL0113         S              3  0
     D  WL0114         S              3
     D  WL0115         S             30
     D  WL0116         S              1
     D  WQSU01         S                   LIKE(WXBXST)
     D  WQSU02         S                   LIKE(WXAIC3)
     D  WQSU03         S                   LIKE(WXRDCD)
     D  WL0117         S              3
     D  WL0118         S              7
     D  WQSV01         S                   LIKE(WYLQCD)
     D  WQSV02         S                   LIKE(WYLRCD)
     D  WQ0454         S              9  0
     D  WQ0455         S              7  0
     D  WQ0456         S              6
     D  WQ0457         S             65
     D  WQ0458         S              9  0
     D  WQ0459         S              7  0
     D  WQ0460         S              6
     D  WQ0461         S             65
     D  WQ0462         S              9  0
     D  WQ0463         S              7  0
     D  WQ0464         S              6
     D  WQ0465         S             65
     D  WQ0466         S              9  0
     D  WQ0467         S              7  0
     D  WQ0468         S              6
     D  WQ0469         S             65
     D  WQ0470         S              9  0
     D  WQ0471         S              7  0
     D  WQ0472         S              6
     D  WQ0473         S             65
     D  WQ0474         S              9  0
     D  WQ0475         S              7  0
     D  WQ0476         S              6
     D  WQ0477         S             65
     D  WQ0478         S              9  0
     D  WQ0479         S              7  0
     D  WQ0480         S              6
     D  WQ0481         S             65
     D  WQ0482         S              9  0
     D  WQ0483         S              7  0
     D  WQ0484         S              6
     D  WQ0485         S             65
     D  WQ0486         S              9  0
     D  WQ0487         S              7  0
     D  WQ0488         S              6
     D  WQ0489         S             65
     D  WQ0490         S              9  0
     D  WQ0491         S              7  0
     D  WQ0492         S              6
     D  WQ0493         S             65
     D  WQ0494         S              9  0
     D  WQ0495         S              7  0
     D  WQ0496         S              6
     D  WQ0497         S             65
     D  WQ0498         S              9  0
     D  WQ0499         S              7  0
     D  WQ0500         S              6
     D  WQ0501         S             65
     D  WQ0502         S              9  0
     D  WQ0503         S              7  0
     D  WQ0504         S              6
     D  WQ0505         S             65
     D  WQ0506         S              9  0
     D  WQ0507         S              7  0
     D  WQ0508         S              6
     D  WQ0509         S             65
     D  WQ0510         S              9  0
     D  WQ0511         S              7  0
     D  WQ0512         S              6
     D  WQ0513         S             65
     D  WQ0514         S              9  0
     D  WQ0515         S              7  0
     D  WQ0516         S              6
     D  WQ0517         S             65
     D  WQ0518         S              9  0
     D  WQ0519         S              7  0
     D  WQ0520         S              6
     D  WQ0521         S             65
     D  WQ0522         S              9  0
     D  WQ0523         S              7  0
     D  WQ0524         S              6
     D  WQ0525         S             65
     D  WQ0526         S              9  0
     D  WQ0527         S              7  0
     D  WQ0528         S              6
     D  WQ0529         S             65
     D  WQ0530         S              9  0
     D  WQ0531         S              7  0
     D  WQ0532         S              6
     D  WQ0533         S             65
     D  WQ0534         S              9  0
     D  WQ0535         S              7  0
     D  WQ0536         S              6
     D  WQ0537         S             65
     D  WQ0538         S              9  0
     D  WQ0539         S              7  0
     D  WQ0540         S              6
     D  WQ0541         S             65
     D  WQ0542         S              9  0
     D  WQ0543         S              7  0
     D  WQ0544         S              6
     D  WQ0545         S             65
     D  WQ0546         S              9  0
     D  WQ0547         S              7  0
     D  WQ0548         S              6
     D  WQ0549         S             65
     D  WQ0550         S              9  0
     D  WQ0551         S              7  0
     D  WQ0552         S              6
     D  WQ0553         S             65
     D  WQ0554         S              9  0
     D  WQ0555         S              7  0
     D  WQ0556         S              6
     D  WQ0557         S             65
     D  WQ0558         S              9  0
     D  WQ0559         S              7  0
     D  WQ0560         S              6
     D  WQ0561         S             65
     D  WQ0562         S              9  0
     D  WQ0563         S              7  0
     D  WQ0564         S              6
     D  WQ0565         S             65
     D  YL0161         S             11  2
     D  YL0162         S              1
     D  WQ0566         S              3  0
     D  WQ0567         S              7  0
     D  WQ0568         S              7  0
     D  WQ0569         S              3
     D  WQ0570         S              1
     D  WQ0571         S              1
     D  WQ0572         S              9  0
     D  WQ0573         S              7  0
     D  WQ0574         S              6
     D  WQ0575         S             65
     D  YL0163         S              1
     D  WQ0576         S              3  0
     D  WQ0577         S              7  0
     D  WQ0578         S              3
     D  WQ0579         S              3  0
     D  WQ0580         S              7  0
     D  WQ0581         S              3  0
     D  WQ0582         S              3  0
     D  WQ0583         S              7  0
     D  WQ0584         S              3
     D  WQ0585         S              3
     D  WQ0586         S              3
     D  WQ0587         S             11  4
     D  WQ0588         S             11  2
     D  WQ0589         S             11  4
     D  WQ0590         S             11  4
     D  WQ0591         S              7  0
     D  WQ0592         S              7  0
     D  WL0119         S              9  0
     D  WL0120         S              3  0
     D  WL0121         S              7  0
     D  WL0122         S              1
     D  WL0123         S              7  0
     D  WL0124         S              3
     D  WL0125         S              7  0
     D  WL0126         S              7  0
     D  WL0127         S              4
     D  WL0128         S             15
     D  WL0129         S              1
     D  WL0130         S              6
     D  WL0131         S              6
     D  WL0132         S              1
     D  WL0133         S              1
     D  WL0134         S              1
     D  WL0135         S              2
     D  WL0136         S              5  2
     D  WL0137         S              1
     D  WL0138         S              1
     D  WL0139         S              7  0
     D  WL0140         S              1
     D  WL0141         S              1
     D  WL0142         S              7  0
     D  WL0143         S              6  0
     D  WL0144         S             10
     D  WL0145         S             10
     D  WL0146         S              7  0
     D  WL0147         S              6  0
     D  WL0148         S             10
     D  WL0149         S             10
     D  YARDC          S              1
     D  WQSX01         S                   LIKE(TBHQNZ)
     D  YL0164         S              7  0
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  WQ0593         S             10
     D  WQ0594         S             10
     D  WQ0595         S             10
     D  WQ0596         S             10
     D  WQ0597         S              3  0
     D  WQ0598         S              7  0
     D  WQ0599         S              2
     D  WQ0600         S              7  0
     D  WQ0601         S              6
     D  WQ0602         S              2
     D  WQ0603         S              4
     D  WN0019         S              7  0
     D  WN0020         S              6  0
     D  WN0021         S             10
     D  WN0022         S             10
     D  WN0023         S              7  0
     D  WN0024         S              6  0
     D  WN0025         S             10
     D  WN0026         S             10
     D  WQ0604         S             10
     D  WQ0605         S             10
     D  WQ0606         S             10
     D  WQ0607         S             10
     D  WQ0608         S             10
     D  WQ0609         S             10
     D  WQ0610         S             10
     D  WQ0611         S             10
     D  WQ0612         S             10
     D  WQ0613         S             10
     D  WQ0614         S             10
     D  WQ0615         S             10
     D  WQ0616         S             10
     D  WQ0617         S             10
     D  WQ0618         S             10
     D  WQ0619         S             10
     D  WQ0620         S             10
     D  WQ0621         S             10
     D  WQ0622         S             10
     D  WQ0623         S             10
     D  WQ0624         S             10
     D  WQ0625         S             10
     D  WQ0626         S             10
     D  WQ0627         S             10
     D  WQ0628         S             10
     D  WQ0629         S             10
     D  WQ0630         S             10
     D  WQ0631         S             10
     D  WQ0632         S             10
     D  WQ0633         S             10
     D  WQ0634         S             10
     D  WQ0635         S             10
     D  WQ0636         S             10
     D  WQ0637         S             10
     D  WQ0638         S             10
     D  WQ0639         S             10
     D  WQ0640         S             10
     D  WQ0641         S             10
     D  WQ0642         S             10
     D  WQ0643         S             10
     D  WQ0644         S             10
     D  WQ0645         S             10
     D  WQ0646         S             10
     D  WQ0647         S             10
     D  YL0165         S              2
     D  YL0166         S              7  0
     D  YL0167         S              7  0
     D  YL0168         S             15
     D  YL0169         S              7  0
     D  YL0170         S              7  0
     D  YL0171         S              7  0
     D  YL0172         S              3
     D  YL0173         S              1
     D  YL0174         S              1
     D  YL0175         S              1
     D  YL0176         S              1
     D  YL0177         S              3
     D  YL0178         S              1
     D  YL0179         S              1
     D  YL0180         S              1
     D  YL0181         S              1
     D  YL0182         S              7  0
     D  YL0183         S             10
     D  YL0184         S              7  0
     D  YL0185         S             11  2
     D  YL0186         S             11  2
     D  YL0187         S              1
     D  YL0188         S              1
     D  YL0189         S              1
     D  YL0190         S              7  0
     D  YL0191         S              4
     D  YL0192         S             12
     D  YL0193         S              7  0
     D  YL0194         S             11  2
     D  YL0195         S              1
     D  YL0196         S              1
     D  YL0197         S              1
     D  YL0198         S              1
     D  YL0199         S              5  2
     D  YL0200         S              1
     D  YL0201         S              7  0
     D  YL0202         S              1
     D  YL0203         S              1
     D  YL0204         S              7  0
     D  YL0205         S             30
     D  YL0206         S             30
     D  YL0207         S              1
     D  YL0208         S              7  0
     D  YL0209         S              3
     D  YL0210         S              7  0
     D  YL0211         S              2
     D  YL0212         S              7  0
     D  YL0213         S              2
     D  YL0214         S              1
     D  YL0215         S             11  2
     D  YL0216         S              1
     D  YL0217         S              1
     D  YL0218         S             11  2
     D  YL0219         S              1
     D  YL0220         S              1
     D  YL0221         S              1
     D  YL0222         S              1
     D  YL0223         S              1
     D  YL0224         S              1
     D  YL0225         S              1
     D  YL0226         S              1
     D  YL0227         S              1
     D  YL0228         S              2
     D  YL0229         S              2
     D  YL0230         S              2
     D  YL0231         S              3
     D  YL0232         S              7  0
     D  YL0233         S              7  0
     D  YL0234         S              7  0
     D  YL0235         S              7  0
     D  YL0236         S              7  0
     D  YL0237         S              6  0
     D  YL0238         S              6  0
     D  YL0239         S              6  0
     D  YL0240         S              6  0
     D  YL0241         S              6  0
     D  YL0242         S             11  2
     D  YL0243         S             11  2
     D  YL0244         S             11  2
     D  YL0245         S             11  2
     D  YL0246         S             11  2
     D  YL0247         S              7  0
     D  YL0248         S              1
     D  YL0249         S              1
     D  YL0250         S              1
     D  YL0251         S              6  0
     D  YL0252         S             10
     D  YL0253         S             10
     D  YL0254         S              7  0
     D  WL0150         S              3  0
     D  WL0151         S              7  0
     D  WL0152         S              2
     D  WL0153         S              7  0
     D  WL0154         S              7  0
     D  WL0155         S             30
     D  WL0156         S             30
     D  WL0157         S             30
     D  WL0158         S             30
     D  WL0159         S             20
     D  WL0160         S              2
     D  WL0161         S             11
     D  WL0162         S              7  0
     D  WL0163         S             30
     D  WL0164         S             30
     D  WL0165         S             30
     D  WL0166         S             30
     D  WL0167         S             20
     D  WL0168         S              2
     D  WL0169         S             11
     D  WL0170         S             15
     D  WL0171         S              7  0
     D  WL0172         S              7  0
     D  WL0173         S              7  0
     D  WL0174         S              7  0
     D  WL0175         S              2
     D  WL0176         S             40
     D  WL0177         S             40
     D  WL0178         S              3
     D  WL0179         S              1
     D  WL0180         S              1
     D  WL0181         S              1
     D  WL0182         S              1
     D  WL0183         S              3
     D  WL0184         S              1
     D  WL0185         S              1
     D  WL0186         S              1
     D  WL0187         S              1
     D  WL0188         S              7  0
     D  WL0189         S             10
     D  WL0190         S              7  0
     D  WL0191         S             11  2
     D  WL0192         S             11  2
     D  WL0193         S              1
     D  WL0194         S              1
     D  WL0195         S              1
     D  WL0196         S              7  0
     D  WL0197         S              4  0
     D  WL0198         S              4
     D  WL0199         S             12
     D  WL0200         S              7  0
     D  WL0201         S              5  2
     D  WL0202         S             11  2
     D  WL0203         S              1
     D  WL0204         S              1
     D  WL0205         S              1
     D  WL0206         S              2
     D  WL0207         S              1
     D  WL0208         S              1
     D  WL0209         S              1
     D  WL0210         S              1
     D  WL0211         S              1
     D  WL0212         S              5  2
     D  WL0213         S              1
     D  WL0214         S              7  0
     D  WL0215         S              1
     D  WL0216         S              1
     D  WL0217         S              7  0
     D  WL0218         S             30
     D  WL0219         S             30
     D  WL0220         S              1
     D  WL0221         S              3
     D  WL0222         S              2
     D  WL0223         S              3
     D  WL0224         S              7  0
     D  WL0225         S              3
     D  WL0226         S              7  0
     D  WL0227         S              2
     D  WL0228         S              7  0
     D  WL0229         S              2
     D  WL0230         S              1
     D  WL0231         S              1
     D  WL0232         S             11  2
     D  WL0233         S              1
     D  WL0234         S              1
     D  WL0235         S              1
     D  WL0236         S             11  2
     D  WL0237         S              1
     D  WL0238         S              1
     D  WL0239         S              1
     D  WL0240         S              1
     D  WL0241         S              1
     D  WL0242         S              1
     D  WL0243         S              1
     D  WL0244         S              1
     D  WL0245         S              1
     D  WL0246         S              1
     D  WL0247         S              1
     D  WL0248         S              2
     D  WL0249         S              2
     D  WL0250         S              2
     D  WL0251         S              3
     D  WL0252         S              3
     D  WL0253         S              7  0
     D  WL0254         S              7  0
     D  WL0255         S              7  0
     D  WL0256         S              7  0
     D  WL0257         S              7  0
     D  WL0258         S              6  0
     D  WL0259         S              6  0
     D  WL0260         S              6  0
     D  WL0261         S              6  0
     D  WL0262         S              6  0
     D  WL0263         S             11  2
     D  WL0264         S             11  2
     D  WL0265         S             11  2
     D  WL0266         S             11  2
     D  WL0267         S             11  2
     D  WL0268         S              7  0
     D  WL0269         S              1
     D  WL0270         S              1
     D  WL0271         S              1
     D  WL0272         S              6  0
     D  WL0273         S             10
     D  WL0274         S             10
     D  WL0275         S              7  0
     D  WQ0648         S              9  0
     D  WQ0649         S              7  0
     D  WQ0650         S              6
     D  WQ0651         S             65
     D  WQ0652         S              9  0
     D  WQ0653         S              7  0
     D  WQ0654         S              6
     D  WQ0655         S             65
     D  WQ0656         S              9  0
     D  WQ0657         S              7  0
     D  WQ0658         S              6
     D  WQ0659         S             65
     D  WQ0660         S              9  0
     D  WQ0661         S              7  0
     D  WQ0662         S              6
     D  WQ0663         S             65
     D  YL0255         S              1
     D  WQTB01         S                   LIKE(TEAIC3)
     D  WQTB02         S                   LIKE(TEC4NB)
     D  WQ0664         S              9  0
     D  WQ0665         S              7  0
     D  WQ0666         S              6
     D  WQ0667         S             65
     D  YL0256         S              7  0
     D  WQ0668         S              9  0
     D  WQ0669         S              7  0
     D  WQ0670         S              6
     D  WQ0671         S             65
     D  WQ0672         S              9  0
     D  WQ0673         S              7  0
     D  WQ0674         S              6
     D  WQ0675         S             65
     D  WQ0676         S             10
     D  WQ0677         S             11
     D  WQ0678         S              8
     D  WQ0679         S              8
     D  WQ0680         S              7
     D  WQ0681         S              9  0
     D  WQ0682         S              7  0
     D  WQ0683         S              6
     D  WQ0684         S             65
     D  WQ0685         S             10
     D  WQ0686         S             11
     D  WQ0687         S              8
     D  WQ0688         S              8
     D  WQ0689         S              7
     D  WQ0690         S              9  0
     D  WQ0691         S              7  0
     D  WQ0692         S              6
     D  WQ0693         S             65
     D  WQ0694         S              3
     D  WQ0695         S              7  0
     D  WQ0696         S              7  0
     D  WQ0697         S             20
     D  WQ0698         S              2
     D  WQ0699         S              3  0
     D  WQ0700         S              4  0
     D  WQ0701         S              7  0
     D  WQ0702         S              7  0
     D  WQ0703         S              3
     D  WQ0704         S              7  0
     D  WQ0705         S              6  0
     D  WQ0706         S              7  0
     D  WQ0707         S              9  0
     D  WQ0708         S              7  0
     D  WQ0709         S              6
     D  WQ0710         S             65
     D  YL0257         S              1
     D  YL0258         S             11
     D  YL0259         S             10
     D  WQ0711         S             10
     D  WQ0712         S             11
     D  WQ0713         S              8
     D  WQ0714         S              8
     D  WQ0715         S              7
     D  YL0260         S             65
     D  WQ0716         S              9  0
     D  WQ0717         S              7  0
     D  WQ0718         S              6
     D  WQ0719         S             65
     D  YL0261         S              1
     D  YL0262         S              7  0
     D  WQ0720         S              9  0
     D  WQ0721         S              7  0
     D  WQ0722         S              6
     D  WQ0723         S             65
     D  WQ0724         S             10
     D  WQ0725         S             11
     D  WQ0726         S              8
     D  WQ0727         S              8
     D  WQ0728         S              7
     D  WQ0729         S              9  0
     D  WQ0730         S              7  0
     D  WQ0731         S              6
     D  WQ0732         S             65
     D  YL0263         S              7  0
     D  WQ0733         S              9  0
     D  WQ0734         S              7  0
     D  WQ0735         S              6
     D  WQ0736         S             65
     D  WQ0737         S              9  0
     D  WQ0738         S              7  0
     D  WQ0739         S              6
     D  WQ0740         S             65
     D  YN0164         S             10
     D  YN0165         S              2
     D  YN0166         S             10
     D  YN0167         S              1
     D  YN0168         S             25
     D  YN0169         S              2
     D  YN0170         S              3
     D  YN0171         S              5  0
     D  YL0264         S              4  0
     D  YL0265         S              2
     D  WQ0741         S              9  0
     D  WQ0742         S              7  0
     D  WQ0743         S              6
     D  WQ0744         S             65
     D  YN0172         S             30
     D  YN0173         S             30
     D  YN0174         S             30
     D  YN0175         S             30
     D  YN0176         S             20
     D  YN0177         S             11
     D  YL0266         S              3
     D  YN0178         S              2
     D  YN0179         S              1
     D  YN0180         S             10
     D  YL0267         S              2
     D  YL0268         S              1
     D  YN0181         S              1
     D  YN0182         S              1
     D  YN0183         S              5  2
     D  YN0184         S              1
     D  YN0185         S              1
     D  YN0186         S              1
     D  YN0187         S              1
     D  YN0188         S              3  0
     D  YN0189         S              3  0
     D  YN0190         S              3  0
     D  YN0191         S              3  0
     D  YN0192         S              3
     D  YN0193         S              1
     D  YN0194         S              1
     D  YN0195         S              1
     D  YN0196         S              1
     D  YN0197         S              2
     D  YN0198         S              2
     D  YN0199         S              3
     D  YN0200         S              3
     D  YN0201         S              3
     D  YN0202         S              1
     D  YN0203         S              1
     D  YN0204         S              1
     D  YN0205         S              1
     D  YN0206         S              5  2
     D  YL0269         S              1
     D  WQ0745         S              2
     D  WQ0746         S              5  2
     D  WQ0747         S              1
     D  YL0270         S              5  2
     D  YL0271         S              1
     D  YL0272         S              1
     D  YL0273         S              1
     D  WL0276         S              9  0
     D  WL0277         S              3  0
     D  WL0278         S              7  0
     D  WL0279         S              7  0
     D  WL0280         S              3
     D  WL0281         S              7  0
     D  WL0282         S              4
     D  WL0283         S              6
     D  WL0284         S              7  0
     D  WL0285         S              1
     D  YL0274         S              1
     D  WQTE01         S                   LIKE(WMHQNZ)
     D  YBRDC          S              1
     D  ##TMS          S             26
     D  YL0275         S              7  0
     D  YL0276         S              3
     D  YL0277         S              7  0
     D  YL0278         S              7  0
     D  YL0279         S              1
     D  YL0280         S              1
     D  YL0281         S             11  2
     D  YL0282         S             11  2
     D  YL0283         S             11  2
     D  YL0284         S             11  2
     D  YL0285         S              1
     D  YL0286         S              1
     D  YL0287         S              1
     D  YL0288         S              1
     D  YL0289         S             11  2
     D  YL0290         S              7  0
     D  YL0291         S              3
     D  YL0292         S              3
     D  YL0293         S              3
     D  YL0294         S             11  4
     D  YL0295         S              7  0
     D  YL0296         S              1
     D  YL0297         S              7  0
     D  YL0298         S              2
     D  YL0299         S              2
     D  YL0300         S              1
     D  YL0301         S              1
     D  YL0302         S              1
     D  YL0303         S             30
     D  YL0304         S             30
     D  YL0305         S              1
     D  YL0306         S              1
     D  YL0307         S              1
     D  YL0308         S              1
     D  YL0309         S              1
     D  YL0310         S              3
     D  YL0311         S              1
     D  YL0312         S             11  2
     D  YL0313         S             11  2
     D  YL0314         S             11  2
     D  YL0315         S             11  2
     D  YL0316         S             11  2
     D  YL0317         S             11  2
     D  YL0318         S             11  2
     D  YL0319         S             11  4
     D  YL0320         S             11  4
     D  YL0321         S             11  4
     D  YL0322         S             11  4
     D  YL0323         S             11  4
     D  YL0324         S             11  2
     D  YL0325         S             11  2
     D  YL0326         S              7  0
     D  YL0327         S              7  0
     D  YL0328         S              7  0
     D  YL0329         S              1
     D  YL0330         S              1
     D  YL0331         S              1
     D  YL0332         S              3  0
     D  YL0333         S              3  0
     D  YL0334         S              3  0
     D  YL0335         S              2
     D  YL0336         S              2
     D  YL0337         S              2
     D  YL0338         S              2
     D  YL0339         S              7  0
     D  YL0340         S             10
     D  YL0341         S              6
     D  YL0342         S              2
     D  YL0343         S              3
     D  YL0344         S              3
     D  YL0345         S              1
     D  YL0346         S              1
     D  YL0347         S              1
     D  YL0348         S             11  4
     D  YL0349         S             11  2
     D  YL0350         S              3  0
     D  YL0351         S              1
     D  YL0352         S              1
     D  YL0353         S              1
     D  YL0354         S              1
     D  YL0355         S              1
     D  YL0356         S              2
     D  YL0357         S              2
     D  YL0358         S              3
     D  YL0359         S              3
     D  YL0360         S              7  0
     D  YL0361         S              7  0
     D  YL0362         S              7  0
     D  YL0363         S              7  0
     D  YL0364         S              7  0
     D  YL0365         S              6  0
     D  YL0366         S              6  0
     D  YL0367         S              6  0
     D  YL0368         S              6  0
     D  YL0369         S              6  0
     D  YL0370         S             11  2
     D  YL0371         S             11  2
     D  YL0372         S             11  2
     D  YL0373         S             11  2
     D  YL0374         S             11  2
     D  YL0375         S             11  4
     D  YL0376         S             11  4
     D  YL0377         S             11  4
     D  YL0378         S             11  4
     D  YL0379         S             11  4
     D  YL0380         S             11  4
     D  YL0381         S             11  4
     D  YL0382         S             11  4
     D  YL0383         S              1
     D  YL0384         S              1
     D  YL0385         S              1
     D  YL0386         S             11  2
     D  YL0387         S              4  0
     D  YL0388         S              7  0
     D  YL0389         S              7  0
     D  YL0390         S              1
     D  YL0391         S              2
     D  YL0392         S              3
     D  YL0393         S              7  0
     D  YL0394         S              7  0
     D  YL0395         S              7  0
     D  YL0396         S              1
     D  YL0397         S              1
     D  YL0398         S              1
     D  YL0399         S              6  0
     D  YL0400         S             10
     D  YL0401         S             10
     D  YL0402         S              7  0
     D  WL0286         S              3  0
     D  WL0287         S              7  0
     D  WL0288         S              3  0
     D  WL0289         S              3  0
     D  WL0290         S              7  0
     D  WL0291         S              3
     D  WL0292         S              7  0
     D  WL0293         S              7  0
     D  WL0294         S              1
     D  WL0295         S              1
     D  WL0296         S             11  2
     D  WL0297         S             11  2
     D  WL0298         S             11  2
     D  WL0299         S             11  2
     D  WL0300         S              1
     D  WL0301         S              1
     D  WL0302         S              1
     D  WL0303         S              1
     D  WL0304         S             11  2
     D  WL0305         S              7  0
     D  WL0306         S              3
     D  WL0307         S              3
     D  WL0308         S              3
     D  WL0309         S             11  4
     D  WL0310         S              7  0
     D  WL0311         S              1
     D  WL0312         S              7  0
     D  WL0313         S              2
     D  WL0314         S              2
     D  WL0315         S              1
     D  WL0316         S              1
     D  WL0317         S              1
     D  WL0318         S             30
     D  WL0319         S             30
     D  WL0320         S              1
     D  WL0321         S              1
     D  WL0322         S              1
     D  WL0323         S              1
     D  WL0324         S              1
     D  WL0325         S              3
     D  WL0326         S              1
     D  WL0327         S             11  2
     D  WL0328         S             11  2
     D  WL0329         S             11  2
     D  WL0330         S             11  2
     D  WL0331         S             11  2
     D  WL0332         S             11  2
     D  WL0333         S             11  2
     D  WL0334         S             11  4
     D  WL0335         S             11  4
     D  WL0336         S             11  4
     D  WL0337         S             11  4
     D  WL0338         S             11  4
     D  WL0339         S             11  2
     D  WL0340         S             11  2
     D  WL0341         S              7  0
     D  WL0342         S              7  0
     D  WL0343         S              7  0
     D  WL0344         S              1
     D  WL0345         S              1
     D  WL0346         S              1
     D  WL0347         S              3  0
     D  WL0348         S              3  0
     D  WL0349         S              3  0
     D  WL0350         S              2
     D  WL0351         S              2
     D  WL0352         S              2
     D  WL0353         S              2
     D  WL0354         S              7  0
     D  WL0355         S             10
     D  WL0356         S              6
     D  WL0357         S              2
     D  WL0358         S              3
     D  WL0359         S              3
     D  WL0360         S              1
     D  WL0361         S              1
     D  WL0362         S              1
     D  WL0363         S             11  4
     D  WL0364         S             11  2
     D  WL0365         S              3  0
     D  WL0366         S              1
     D  WL0367         S              1
     D  WL0368         S              1
     D  WL0369         S              1
     D  WL0370         S              1
     D  WL0371         S              2
     D  WL0372         S              2
     D  WL0373         S              3
     D  WL0374         S              3
     D  WL0375         S              7  0
     D  WL0376         S              7  0
     D  WL0377         S              7  0
     D  WL0378         S              7  0
     D  WL0379         S              7  0
     D  WL0380         S              6  0
     D  WL0381         S              6  0
     D  WL0382         S              6  0
     D  WL0383         S              6  0
     D  WL0384         S              6  0
     D  WL0385         S             11  2
     D  WL0386         S             11  2
     D  WL0387         S             11  2
     D  WL0388         S             11  2
     D  WL0389         S             11  2
     D  WL0390         S             11  4
     D  WL0391         S             11  4
     D  WL0392         S             11  4
     D  WL0393         S             11  4
     D  WL0394         S             11  4
     D  WL0395         S             11  4
     D  WL0396         S             11  4
     D  WL0397         S             11  4
     D  WL0398         S              1
     D  WL0399         S              1
     D  WL0400         S              1
     D  WL0401         S             11  2
     D  WL0402         S              4  0
     D  WL0403         S              7  0
     D  WL0404         S              7  0
     D  WL0405         S              1
     D  WL0406         S              2
     D  WL0407         S              3
     D  WL0408         S              7  0
     D  WL0409         S              7  0
     D  WL0410         S              7  0
     D  WL0411         S              1
     D  WL0412         S              1
     D  WL0413         S              1
     D  WL0414         S              6  0
     D  WL0415         S             10
     D  WL0416         S             10
     D  WL0417         S              7  0
     D  YN0207         S             10
     D  YN0208         S              2
     D  YN0209         S             10
     D  YN0210         S              1
     D  YN0211         S             25
     D  YN0212         S              3
     D  YN0213         S              5  0
     D  YN0214         S              6  0
     D  YL0403         S             11
     D  YL0404         S             10
     D  WQ0748         S             10
     D  WQ0749         S             11
     D  WQ0750         S              8
     D  WQ0751         S              8
     D  WQ0752         S              7
     D  YL0405         S             65
     D  WQ0753         S              9  0
     D  WQ0754         S              7  0
     D  WQ0755         S              6
     D  WQ0756         S             65
     D  WQ0757         S              9  0
     D  WQ0758         S              7  0
     D  WQ0759         S              6
     D  WQ0760         S             65
     D  YL0406         S              7  0
     D  XDAY1          S              6  0
     D  XDAY2          S              6  0
     D  XDSEL          S              1
     D  XDCDW          S              7
     D  XDWSL          S              1  0
     D  XDSTP          S              1  0
     D  XDWNB          S              6  0
     D  XDLSW          S              1  0
     D  YY             S              6  0
     D  XDWK3          S              7  1
     D  YL0407         S              7  0
     D  YL0408         S              7
     D  WQ0761         S              9  0
     D  WQ0762         S              7  0
     D  WQ0763         S              6
     D  WQ0764         S             65
     D  WL0418         S              3  0
     D  WL0419         S              7  0
     D  WL0420         S              3  0
     D  WL0421         S              3  0
     D  WL0422         S             11  4
     D  WQTH01         S                   LIKE(TEAIC3)
     D  WQTH02         S                   LIKE(TEC4NB)
     D  WQTH03         S                   LIKE(TEDPNB)
     D  YL0409         S             11  2
     D  YL0410         S             11  2
     D  WQ0765         S              3  0
     D  WQ0766         S              7  0
     D  WQ0767         S              3  0
     D  WQ0768         S              3  0
     D  WQ0769         S              7  0
     D  WQ0770         S              3
     D  WQ0771         S              7  0
     D  WQ0772         S             11  2
     D  WQ0773         S             11  2
     D  WQ0774         S             11  2
     D  WQ0775         S             11  2
     D  WQ0776         S              2
     D  WQ0777         S             10
     D  WQ0778         S              4  0
     D  WQ0779         S              7  0
     D  WQ0780         S              7  0
     D  WL0423         S              3  0
     D  WL0424         S              7  0
     D  WL0425         S              3  0
     D  WL0426         S              3  0
     D  WL0427         S             11  2
     D  WL0428         S             11  2
     D  WN0027         S              7  0
     D  WN0028         S              3
     D  WN0029         S              7  0
     D  WN0030         S              7  0
     D  WN0031         S              1
     D  WN0032         S              1
     D  WN0033         S             11  2
     D  WN0034         S             11  2
     D  WN0035         S             11  2
     D  WN0036         S             11  2
     D  WN0037         S              1
     D  WN0038         S              1
     D  WN0039         S              1
     D  WN0040         S              1
     D  WN0041         S             11  2
     D  WN0042         S              7  0
     D  WN0043         S              3
     D  WN0044         S              3
     D  WN0045         S              3
     D  WN0046         S             11  4
     D  WN0047         S              7  0
     D  WN0048         S              1
     D  WN0049         S              7  0
     D  WN0050         S              2
     D  WN0051         S              2
     D  WN0052         S              1
     D  WN0053         S              1
     D  WN0054         S              1
     D  WN0055         S             30
     D  WN0056         S             30
     D  WN0057         S              1
     D  WN0058         S              1
     D  WN0059         S              1
     D  WN0060         S              1
     D  WN0061         S              1
     D  WN0062         S              3
     D  WN0063         S              1
     D  WN0064         S             11  2
     D  WN0065         S             11  2
     D  WN0066         S             11  2
     D  WN0067         S             11  2
     D  WN0068         S             11  2
     D  WN0069         S             11  4
     D  WN0070         S             11  4
     D  WN0071         S             11  4
     D  WN0072         S             11  4
     D  WN0073         S             11  4
     D  WN0074         S             11  2
     D  WN0075         S             11  2
     D  WN0076         S              7  0
     D  WN0077         S              7  0
     D  WN0078         S              7  0
     D  WN0079         S              1
     D  WN0080         S              1
     D  WN0081         S              1
     D  WN0082         S              3  0
     D  WN0083         S              3  0
     D  WN0084         S              3  0
     D  WN0085         S              2
     D  WN0086         S              2
     D  WN0087         S              2
     D  WN0088         S              2
     D  WN0089         S              7  0
     D  WN0090         S             10
     D  WN0091         S              6
     D  WN0092         S              2
     D  WN0093         S              3
     D  WN0094         S              3
     D  WN0095         S              1
     D  WN0096         S              1
     D  WN0097         S              1
     D  WN0098         S             11  4
     D  WN0099         S             11  2
     D  WN0100         S              3  0
     D  WN0101         S              1
     D  WN0102         S              1
     D  WN0103         S              1
     D  WN0104         S              1
     D  WN0105         S              1
     D  WN0106         S              2
     D  WN0107         S              2
     D  WN0108         S              3
     D  WN0109         S              3
     D  WN0110         S              7  0
     D  WN0111         S              7  0
     D  WN0112         S              7  0
     D  WN0113         S              7  0
     D  WN0114         S              7  0
     D  WN0115         S              6  0
     D  WN0116         S              6  0
     D  WN0117         S              6  0
     D  WN0118         S              6  0
     D  WN0119         S              6  0
     D  WN0120         S             11  2
     D  WN0121         S             11  2
     D  WN0122         S             11  2
     D  WN0123         S             11  2
     D  WN0124         S             11  2
     D  WN0125         S             11  4
     D  WN0126         S             11  4
     D  WN0127         S             11  4
     D  WN0128         S             11  4
     D  WN0129         S             11  4
     D  WN0130         S             11  4
     D  WN0131         S             11  4
     D  WN0132         S             11  4
     D  WN0133         S              1
     D  WN0134         S              1
     D  WN0135         S              1
     D  WN0136         S             11  2
     D  WN0137         S              4  0
     D  WN0138         S              7  0
     D  WN0139         S              7  0
     D  WN0140         S              1
     D  WN0141         S              2
     D  WN0142         S              3
     D  WN0143         S              7  0
     D  WN0144         S              7  0
     D  WN0145         S              7  0
     D  WN0146         S              1
     D  WN0147         S              1
     D  WN0148         S              1
     D  WN0149         S              6  0
     D  WN0150         S             10
     D  WN0151         S             10
     D  WN0152         S              7  0
     D  YCRDC          S              1
     D  WL0429         S              3  0
     D  WL0430         S              7  0
     D  WL0431         S              3  0
     D  WL0432         S              3  0
     D  WQ0781         S              3  0
     D  WQ0782         S              7  0
     D  WQ0783         S              3  0
     D  WQ0784         S              3  0
     D  YL0411         S              1
     D  YL0412         S              1
     D  WL0433         S              3  0
     D  WL0434         S              7  0
     D  WL0435         S              3  0
     D  WL0436         S              3  0
     D  WL0437         S              1
     D  WL0438         S              1
     D  WL0439         S             11  2
     D  WL0440         S             11  2
     D  WN0153         S              7  0
     D  WN0154         S              3
     D  WN0155         S              7  0
     D  WN0156         S              7  0
     D  WN0157         S             11  2
     D  WN0158         S             11  2
     D  WN0159         S             11  2
     D  WN0160         S             11  2
     D  WN0161         S              1
     D  WN0162         S              1
     D  WN0163         S              1
     D  WN0164         S              1
     D  WN0165         S             11  2
     D  WN0166         S              7  0
     D  WN0167         S              3
     D  WN0168         S              3
     D  WN0169         S              3
     D  WN0170         S             11  4
     D  WN0171         S              7  0
     D  WN0172         S              1
     D  WN0173         S              7  0
     D  WN0174         S              2
     D  WN0175         S              2
     D  WN0176         S              1
     D  WN0177         S              1
     D  WN0178         S              1
     D  WN0179         S             30
     D  WN0180         S             30
     D  WN0181         S              1
     D  WN0182         S              1
     D  WN0183         S              1
     D  WN0184         S              1
     D  WN0185         S              1
     D  WN0186         S              3
     D  WN0187         S              1
     D  WN0188         S             11  2
     D  WN0189         S             11  2
     D  WN0190         S             11  2
     D  WN0191         S             11  2
     D  WN0192         S             11  2
     D  WN0193         S             11  4
     D  WN0194         S             11  4
     D  WN0195         S             11  4
     D  WN0196         S             11  4
     D  WN0197         S             11  4
     D  WN0198         S             11  2
     D  WN0199         S             11  2
     D  WN0200         S              7  0
     D  WN0201         S              7  0
     D  WN0202         S              7  0
     D  WN0203         S              1
     D  WN0204         S              1
     D  WN0205         S              1
     D  WN0206         S              3  0
     D  WN0207         S              3  0
     D  WN0208         S              3  0
     D  WN0209         S              2
     D  WN0210         S              2
     D  WN0211         S              2
     D  WN0212         S              2
     D  WN0213         S              7  0
     D  WN0214         S             10
     D  WN0215         S              6
     D  WN0216         S              2
     D  WN0217         S              3
     D  WN0218         S              3
     D  WN0219         S              1
     D  WN0220         S              1
     D  WN0221         S              1
     D  WN0222         S             11  4
     D  WN0223         S             11  2
     D  WN0224         S              3  0
     D  WN0225         S              1
     D  WN0226         S              1
     D  WN0227         S              1
     D  WN0228         S              1
     D  WN0229         S              1
     D  WN0230         S              2
     D  WN0231         S              2
     D  WN0232         S              3
     D  WN0233         S              3
     D  WN0234         S              7  0
     D  WN0235         S              7  0
     D  WN0236         S              7  0
     D  WN0237         S              7  0
     D  WN0238         S              7  0
     D  WN0239         S              6  0
     D  WN0240         S              6  0
     D  WN0241         S              6  0
     D  WN0242         S              6  0
     D  WN0243         S              6  0
     D  WN0244         S             11  2
     D  WN0245         S             11  2
     D  WN0246         S             11  2
     D  WN0247         S             11  2
     D  WN0248         S             11  2
     D  WN0249         S             11  4
     D  WN0250         S             11  4
     D  WN0251         S             11  4
     D  WN0252         S             11  4
     D  WN0253         S             11  4
     D  WN0254         S             11  4
     D  WN0255         S             11  4
     D  WN0256         S             11  4
     D  WN0257         S              1
     D  WN0258         S              1
     D  WN0259         S              1
     D  WN0260         S             11  2
     D  WN0261         S              4  0
     D  WN0262         S              7  0
     D  WN0263         S              7  0
     D  WN0264         S              1
     D  WN0265         S              2
     D  WN0266         S              3
     D  WN0267         S              7  0
     D  WN0268         S              7  0
     D  WN0269         S              7  0
     D  WN0270         S              1
     D  WN0271         S              1
     D  WN0272         S              1
     D  WN0273         S              6  0
     D  WN0274         S             10
     D  WN0275         S             10
     D  WN0276         S              7  0
     D  YDRDC          S              1
     D  YL0413         S              3
     D  YL0414         S              7  0
     D  YL0415         S              7
     D  YL0416         S             12
     D  YL0417         S             12
     D  WQ0785         S              7  0
     D  WQ0786         S              6
     D  WQ0787         S              3
     D  WQ0788         S             12
     D  WQ0789         S             12
     D  WQ0790         S              3  0
     D  WQ0791         S              7  0
     D  WQ0792         S              7  0
     D  WQ0793         S              6
     D  WQ0794         S              3
     D  WQ0795         S             12
     D  WQ0796         S             12
     D  WQ0797         S              3  0
     D  WQ0798         S              7  0
     D  WL0441         S              3  0
     D  WL0442         S              7  0
     D  WL0443         S              3  0
     D  WL0444         S              3  0
     D  WQTL01         S                   LIKE(THAIC3)
     D  WQTL02         S                   LIKE(THC4NB)
     D  WQTL03         S                   LIKE(THDPNB)
     D  WQTL04         S                   LIKE(THUENB)
     D  YL0418         S              1
     D  WL0445         S              3  0
     D  WL0446         S              7  0
     D  WL0447         S              1
     D  WQTN01         S                   LIKE(TJAIC3)
     D  WQTN02         S                   LIKE(TJC4NB)
     D  YL0419         S              1
     D  WL0448         S              3  0
     D  WL0449         S              7  0
     D  WL0450         S              7  0
     D  WL0451         S              1
     D  WL0452         S              1
     D  WL0453         S             11  2
     D  WL0454         S             11  2
     D  WL0455         S              1
     D  WL0456         S              1
     D  WL0457         S              5  2
     D  WL0458         S             11  2
     D  WL0459         S              7  0
     D  WL0460         S              1
     D  WL0461         S              3
     D  WL0462         S              7  0
     D  WL0463         S              3
     D  WL0464         S             11  2
     D  WN0277         S              2
     D  WN0278         S              7  0
     D  WN0279         S              7  0
     D  WN0280         S             30
     D  WN0281         S             30
     D  WN0282         S             30
     D  WN0283         S             30
     D  WN0284         S             20
     D  WN0285         S              2
     D  WN0286         S             11
     D  WN0287         S              7  0
     D  WN0288         S             30
     D  WN0289         S             30
     D  WN0290         S             30
     D  WN0291         S             30
     D  WN0292         S             20
     D  WN0293         S              2
     D  WN0294         S             11
     D  WN0295         S             15
     D  WN0296         S              7  0
     D  WN0297         S              7  0
     D  WN0298         S              7  0
     D  WN0299         S              2
     D  WN0300         S             40
     D  WN0301         S             40
     D  WN0302         S              3
     D  WN0303         S              1
     D  WN0304         S              1
     D  WN0305         S              1
     D  WN0306         S              1
     D  WN0307         S              3
     D  WN0308         S              1
     D  WN0309         S              1
     D  WN0310         S              7  0
     D  WN0311         S             10
     D  WN0312         S              7  0
     D  WN0313         S              1
     D  WN0314         S              7  0
     D  WN0315         S              4  0
     D  WN0316         S              4
     D  WN0317         S             12
     D  WN0318         S              7  0
     D  WN0319         S              1
     D  WN0320         S              1
     D  WN0321         S              1
     D  WN0322         S              2
     D  WN0323         S              1
     D  WN0324         S              1
     D  WN0325         S              1
     D  WN0326         S              1
     D  WN0327         S              1
     D  WN0328         S              5  2
     D  WN0329         S              1
     D  WN0330         S              1
     D  WN0331         S              1
     D  WN0332         S              7  0
     D  WN0333         S             30
     D  WN0334         S             30
     D  WN0335         S              2
     D  WN0336         S              3
     D  WN0337         S              7  0
     D  WN0338         S              2
     D  WN0339         S              7  0
     D  WN0340         S              2
     D  WN0341         S              1
     D  WN0342         S              1
     D  WN0343         S              1
     D  WN0344         S              1
     D  WN0345         S              1
     D  WN0346         S             11  2
     D  WN0347         S              1
     D  WN0348         S              1
     D  WN0349         S              1
     D  WN0350         S              1
     D  WN0351         S              1
     D  WN0352         S              1
     D  WN0353         S              1
     D  WN0354         S              1
     D  WN0355         S              1
     D  WN0356         S              1
     D  WN0357         S              1
     D  WN0358         S              2
     D  WN0359         S              2
     D  WN0360         S              2
     D  WN0361         S              3
     D  WN0362         S              3
     D  WN0363         S              7  0
     D  WN0364         S              7  0
     D  WN0365         S              7  0
     D  WN0366         S              7  0
     D  WN0367         S              7  0
     D  WN0368         S              6  0
     D  WN0369         S              6  0
     D  WN0370         S              6  0
     D  WN0371         S              6  0
     D  WN0372         S              6  0
     D  WN0373         S             11  2
     D  WN0374         S             11  2
     D  WN0375         S             11  2
     D  WN0376         S             11  2
     D  WN0377         S             11  2
     D  WN0378         S              7  0
     D  WN0379         S              1
     D  WN0380         S              1
     D  WN0381         S              1
     D  WN0382         S              6  0
     D  WN0383         S             10
     D  WN0384         S             10
     D  WN0385         S              7  0
     D  YERDC          S              1
     D  WL0465         S              3  0
     D  WL0466         S              7  0
     D  WL0467         S              3  0
     D  WL0468         S              3  0
     D  WL0469         S              7  0
     D  WL0470         S              3
     D  WL0471         S              7  0
     D  WL0472         S              7  0
     D  WL0473         S              1
     D  WL0474         S              1
     D  WL0475         S             11  2
     D  WL0476         S             11  2
     D  WL0477         S             11  2
     D  WL0478         S             11  2
     D  WL0479         S              1
     D  WL0480         S              1
     D  WL0481         S              1
     D  WL0482         S              1
     D  WL0483         S             11  2
     D  WL0484         S              7  0
     D  WL0485         S              3
     D  WL0486         S              3
     D  WL0487         S              3
     D  WL0488         S             11  4
     D  WL0489         S              7  0
     D  WL0490         S              1
     D  WL0491         S              7  0
     D  WL0492         S              2
     D  WL0493         S              2
     D  WL0494         S              1
     D  WL0495         S              1
     D  WL0496         S              1
     D  WL0497         S             30
     D  WL0498         S             30
     D  WL0499         S              1
     D  WL0500         S              1
     D  WL0501         S              1
     D  WL0502         S              1
     D  WL0503         S              1
     D  WL0504         S              3
     D  WL0505         S              1
     D  WL0506         S             11  2
     D  WL0507         S             11  2
     D  WL0508         S             11  2
     D  WL0509         S             11  2
     D  WL0510         S             11  2
     D  WL0511         S             11  2
     D  WL0512         S             11  2
     D  WL0513         S             11  4
     D  WL0514         S             11  4
     D  WL0515         S             11  4
     D  WL0516         S             11  4
     D  WL0517         S             11  4
     D  WL0518         S             11  2
     D  WL0519         S             11  2
     D  WL0520         S              7  0
     D  WL0521         S              7  0
     D  WL0522         S              7  0
     D  WL0523         S              1
     D  WL0524         S              1
     D  WL0525         S              1
     D  WL0526         S              3  0
     D  WL0527         S              3  0
     D  WL0528         S              3  0
     D  WL0529         S              2
     D  WL0530         S              2
     D  WL0531         S              2
     D  WL0532         S              2
     D  WL0533         S              7  0
     D  WL0534         S             10
     D  WL0535         S              6
     D  WL0536         S              2
     D  WL0537         S              3
     D  WL0538         S              3
     D  WL0539         S              1
     D  WL0540         S              1
     D  WL0541         S              1
     D  WL0542         S             11  4
     D  WL0543         S             11  2
     D  WL0544         S              3  0
     D  WL0545         S              1
     D  WL0546         S              1
     D  WL0547         S              1
     D  WL0548         S              1
     D  WL0549         S              1
     D  WL0550         S              2
     D  WL0551         S              2
     D  WL0552         S              3
     D  WL0553         S              3
     D  WL0554         S              7  0
     D  WL0555         S              7  0
     D  WL0556         S              7  0
     D  WL0557         S              7  0
     D  WL0558         S              7  0
     D  WL0559         S              6  0
     D  WL0560         S              6  0
     D  WL0561         S              6  0
     D  WL0562         S              6  0
     D  WL0563         S              6  0
     D  WL0564         S             11  2
     D  WL0565         S             11  2
     D  WL0566         S             11  2
     D  WL0567         S             11  2
     D  WL0568         S             11  2
     D  WL0569         S             11  4
     D  WL0570         S             11  4
     D  WL0571         S             11  4
     D  WL0572         S             11  4
     D  WL0573         S             11  4
     D  WL0574         S             11  4
     D  WL0575         S             11  4
     D  WL0576         S             11  4
     D  WL0577         S              1
     D  WL0578         S              1
     D  WL0579         S              1
     D  WL0580         S             11  2
     D  WL0581         S              4  0
     D  WL0582         S              7  0
     D  WL0583         S              7  0
     D  WL0584         S              1
     D  WL0585         S              2
     D  WL0586         S              3
     D  WL0587         S              7  0
     D  WL0588         S              7  0
     D  WL0589         S              7  0
     D  WL0590         S              1
     D  WL0591         S              1
     D  WL0592         S              1
     D  WN0386         S              6  0
     D  WN0387         S             10
     D  WN0388         S             10
     D  WN0389         S              7  0
     D  YFRDC          S              1
     D  YL0420         S              3
     D  YL0421         S             12
     D  YL0422         S             12
     D  WQ0799         S              7  0
     D  WQ0800         S              6
     D  WQ0801         S              3
     D  WQ0802         S             12
     D  WQ0803         S             12
     D  WQ0804         S              3  0
     D  WQ0805         S              7  0
     D  YL0423         S              7  0
     D  YL0424         S              7
     D  WQ0806         S              7  0
     D  WQ0807         S              6
     D  WQ0808         S              3
     D  WQ0809         S             12
     D  WQ0810         S             12
     D  WQ0811         S              3  0
     D  WQ0812         S              7  0
     D  WQ0813         S              7  0
     D  WQ0814         S              6
     D  WQ0815         S              3
     D  WQ0816         S             12
     D  WQ0817         S             12
     D  WQ0818         S              3  0
     D  WQ0819         S              7  0
     D  WL0593         S              3  0
     D  WL0594         S              7  0
     D  WL0595         S              3  0
     D  WL0596         S              3  0
     D  WL0597         S              3  0
     D  YN0215         S              3  0
     D  WL0598         S              3
     D  WL0599         S              3
     D  WL0600         S              3  0
     D  YL0425         S              5  2
     D  WQ0820         S              3  0
     D  WQ0821         S              7  0
     D  WQ0822         S              5  2
     D  YL0426         S              5  2
     D  YL0427         S              5  0
     D  YL0428         S              5  2
     D  YL0429         S              7  0
     D  WQ0823         S              3  0
     D  WQ0824         S              7  0
     D  WQ0825         S              5  2
     D  WQ0826         S              5  0
     D  WQ0827         S              5  2
     D  WQ0828         S              7  0
     D  WQ0829         S              2
     D  YL0430         S              5  2
     D  YL0431         S              9  2
     D  YL0432         S              9  2
     D  YL0433         S              7  0
     D  YN0216         S              3
     D  YN0217         S              3  0
     D  YL0434         S              3
     D  YN0218         S              7
     D  YN0219         S              3
     D  YN0220         S              3
     D  YN0221         S              5  2
     D  YL0435         S              1
     D  YL0436         S              1
     D  YL0437         S              1
     D  WQ0830         S              3  0
     D  WQ0831         S              7  0
     D  WQ0832         S             30
     D  WQ0833         S             30
     D  WQ0834         S              2
     D  WQ0835         S              2
     D  WQ0836         S             11  2
     D  WQ0837         S              2
     D  WQ0838         S              1
     D  WQ0839         S              1
     D  WQ0840         S              3  0
     D  WQ0841         S              3  0
     D  WQ0842         S              3  0
     D  WQ0843         S              3
     D  WQ0844         S              3  0
     D  WQ0845         S              3
     D  WQ0846         S              7
     D  WQ0847         S              3
     D  WQ0848         S              3
     D  WQ0849         S              5  2
     D  WQ0850         S              1
     D  WQ0851         S             11  2
     D  WQ0852         S              1
     D  WQ0853         S              1
     D  WQ0854         S              9  0
     D  WQ0855         S              7  0
     D  WQ0856         S              6
     D  WQ0857         S             65
     D  YL0438         S              1
     D  WQ0858         S              7  0
     D  WQ0859         S              1
     D  WQ0860         S              2
     D  WQ0861         S              3  0
     D  WQ0862         S              7  0
     D  WQ0863         S              7  0
     D  YN0222         S             30
     D  YL0439         S              3
     D  YL0440         S             11  4
     D  YN0223         S             11  4
     D  YL0441         S              7
     D  YN0224         S             11  2
     D  YL0442         S              6
     D  WQ0864         S              3  0
     D  WQ0865         S              7  0
     D  WQ0866         S             30
     D  WQ0867         S              3
     D  WQ0868         S             11  4
     D  WQ0869         S             11  4
     D  WQ0870         S              7
     D  WQ0871         S             11  2
     D  WQ0872         S              6
     D  YL0443         S              2
     D  WQ0873         S              7  0
     D  WQ0874         S              2
     D  YL0444         S              3
     D  YL0445         S              6
     D  WQ0875         S              9  0
     D  WQ0876         S              7  0
     D  WQ0877         S              6
     D  WQ0878         S             65
     D  WQ0879         S              9  0
     D  WQ0880         S              7  0
     D  WQ0881         S              6
     D  WQ0882         S             65
     D  WQ0883         S              9  0
     D  WQ0884         S              7  0
     D  WQ0885         S              6
     D  WQ0886         S             65
     D  WQ0887         S              9  0
     D  WQ0888         S              7  0
     D  WQ0889         S              6
     D  WQ0890         S             65
     D  YL0446         S              2
     D  WQ0891         S              9  0
     D  WQ0892         S              7  0
     D  WQ0893         S              6
     D  WQ0894         S             65
     D  YL0447         S              1
     D  WQ0895         S              9  0
     D  WQ0896         S              7  0
     D  WQ0897         S              6
     D  WQ0898         S             65
     D  WQ0899         S              9  0
     D  WQ0900         S              7  0
     D  WQ0901         S              6
     D  WQ0902         S             65
     D  YL0448         S              1
     D  WQ0903         S              3  0
     D  WQ0904         S              7  0
     D  WQ0905         S              1
     D  WQ0906         S              3  0
     D  WQ0907         S              7  0
     D  WQ0908         S              3
     D  WQ0909         S             11  4
     D  WQ0910         S              1
     D  WQ0911         S              9  0
     D  WQ0912         S              7  0
     D  WQ0913         S              6
     D  WQ0914         S             65
     D  WQ0915         S              9  0
     D  WQ0916         S              7  0
     D  WQ0917         S              6
     D  WQ0918         S             65
     D  YL0449         S              7  0
     D  YL0450         S              7  0
     D  YL0451         S              1
     D  YL0452         S             30
     D  YL0453         S             30
     D  YL0454         S             30
     D  YL0455         S             30
     D  YL0456         S             30
     D  YL0457         S             30
     D  YL0458         S             37
     D  WQ0919         S              7  0
     D  WQ0920         S              3
     D  WQ0921         S              1
     D  WQ0922         S             30
     D  WQ0923         S             30
     D  WQ0924         S             30
     D  WQ0925         S             30
     D  WQ0926         S             30
     D  WQ0927         S              3  0
     D  WQ0928         S              7  0
     D  WQ0929         S              7  0
     D  WQ0930         S              4  0
     D  WQ0931         S              7  0
     D  WQ0932         S              7  0
     D  WQ0933         S              7  0
     D  WQ0934         S              7  0
     D  WQ0935         S              9  0
     D  WQ0936         S              7  0
     D  WQ0937         S              6
     D  WQ0938         S             65
     D  WQ0939         S              9  0
     D  WQ0940         S              7  0
     D  WQ0941         S              6
     D  WQ0942         S             65
     D  WQ0943         S              9  0
     D  WQ0944         S              7  0
     D  WQ0945         S              6
     D  WQ0946         S             65
     D  WQ0947         S              9  0
     D  WQ0948         S              7  0
     D  WQ0949         S              6
     D  WQ0950         S             65
     D  WQ0951         S              9  0
     D  WQ0952         S              7  0
     D  WQ0953         S              6
     D  WQ0954         S             65
     D  WQ0955         S              9  0
     D  WQ0956         S              7  0
     D  WQ0957         S              6
     D  WQ0958         S             65
     D  YL0459         S              1
     D  WQ0959         S              7  0
     D  WQ0960         S              1
     D  WQ0961         S              9  0
     D  WQ0962         S              7  0
     D  WQ0963         S              6
     D  WQ0964         S             65
     D  YL0460         S              1
     D  WQ0965         S              9  0
     D  WQ0966         S              7  0
     D  WQ0967         S              6
     D  WQ0968         S             65
     D  WQ0969         S              9  0
     D  WQ0970         S              7  0
     D  WQ0971         S              6
     D  WQ0972         S             65
     D  YL0461         S              1
     D  YN0225         S              1
     D  WQ0973         S              3  0
     D  WQ0974         S              3
     D  WQ0975         S              1
     D  WQ0976         S              1
     D  WQ0977         S              9  0
     D  WQ0978         S              7  0
     D  WQ0979         S              6
     D  WQ0980         S             65
     D  WQ0981         S              9  0
     D  WQ0982         S              7  0
     D  WQ0983         S              6
     D  WQ0984         S             65
     D  WQ0985         S              9  0
     D  WQ0986         S              7  0
     D  WQ0987         S              6
     D  WQ0988         S             65
     D  YL0462         S              7  0
     D  WQ0989         S             10
     D  WQ0990         S             11
     D  WQ0991         S              8
     D  WQ0992         S              8
     D  WQ0993         S              7
     D  WQ0994         S              9  0
     D  WQ0995         S              7  0
     D  WQ0996         S              6
     D  WQ0997         S             65
     D  WQ0998         S              9  0
     D  WQ0999         S              7  0
     D  WQ1000         S              6
     D  WQ1001         S             65
     D  WQ1002         S              9  0
     D  WQ1003         S              7  0
     D  WQ1004         S              6
     D  WQ1005         S             65
     D  YN0226         S              2
     D  YN0227         S              3
     D  YN0228         S             40
     D  YN0229         S             40
     D  YN0230         S              3
     D  YN0231         S              1
     D  YN0232         S              1
     D  YN0233         S              4  0
     D  YN0234         S              4  0
     D  YN0235         S              1
     D  YN0236         S              2
     D  YN0237         S              5  2
     D  YN0238         S              9  2
     D  YN0239         S             11  2
     D  YN0240         S              1
     D  YN0241         S              3
     D  YN0242         S              1
     D  YN0243         S              3
     D  YN0244         S              3
     D  YN0245         S              8
     D  YN0246         S             30
     D  YN0247         S             25
     D  YN0248         S             30
     D  YN0249         S             25
     D  YN0250         S              1
     D  YN0251         S              1
     D  YN0252         S             25
     D  YN0253         S             30
     D  YN0254         S              1
     D  YN0255         S              1
     D  YN0256         S              1
     D  YN0257         S              1
     D  YN0258         S              1
     D  YN0259         S              1
     D  YN0260         S              1
     D  YN0261         S              1
     D  YN0262         S              6  0
     D  YN0263         S             10
     D  YN0264         S             10
     D  YN0265         S              7  0
     D  YL0463         S              2
     D  YL0464         S              5  2
     D  YL0465         S              1
     D  YL0466         S              1
     D  YL0467         S              6
     D  WQ1006         S              3  0
     D  WQ1007         S              3
     D  WQ1008         S              1
     D  WQ1009         S              1
     D  WQ1010         S              7
     D  WQ1011         S              9  4
     D  WQ1012         S              1
     D  WQ1013         S              7  0
     D  WQ1014         S              6  0
     D  WQ1015         S              7  0
     D  WQ1016         S              7  0
     D  WQ1017         S              7
     D  WQ1018         S              7  0
     D  WQ1019         S              6  0
     D  WQ1020         S              7  0
     D  WQ1021         S             11  2
     D  WQ1022         S             11  4
     D  WQ1023         S              3
     D  WQ1024         S              3
     D  WQ1025         S              3
     D  WQ1026         S              1
     D  WN0390         S             11  2
     D  WN0391         S             11  2
     D  WN0392         S             11  2
     D  WN0393         S             11  4
     D  WN0394         S              1
     D  WQ1027         S             11  2
     D  WQ1028         S              7  0
     D  WQ1029         S             11  2
     D  WQ1030         S              7  0
     D  WQ1031         S              6  0
     D  WQ1032         S              7  0
     D  WQ1033         S              7  0
     D  WQ1034         S              7  0
     D  WQ1035         S             11  2
     D  WQ1036         S             11  4
     D  WQ1037         S              3
     D  WQ1038         S              3
     D  WQ1039         S              3
     D  WQ1040         S              1
     D  WQ1041         S              9  0
     D  WQ1042         S              7  0
     D  WQ1043         S              6
     D  WQ1044         S             65
     D  WN0395         S              5  2
     D  WN0396         S              5  2
     D  WN0397         S              7  4
     D  WN0398         S             11  4
     D  WQ1045         S              9  0
     D  WQ1046         S              7  0
     D  WQ1047         S              6
     D  WQ1048         S             65
     D  WQ1049         S              9  0
     D  WQ1050         S              7  0
     D  WQ1051         S              6
     D  WQ1052         S             65
     D  WQ1053         S              9  0
     D  WQ1054         S              7  0
     D  WQ1055         S              6
     D  WQ1056         S             65
     D  WQ1057         S              9  0
     D  WQ1058         S              7  0
     D  WQ1059         S              6
     D  WQ1060         S             65
     D  WQ1061         S              9  0
     D  WQ1062         S              7  0
     D  WQ1063         S              6
     D  WQ1064         S             65
     D  WQ1065         S              9  0
     D  WQ1066         S              7  0
     D  WQ1067         S              6
     D  WQ1068         S             65
     D  WQ1069         S              9  0
     D  WQ1070         S              7  0
     D  WQ1071         S              6
     D  WQ1072         S             65
     D  WQ1073         S              9  0
     D  WQ1074         S              7  0
     D  WQ1075         S              6
     D  WQ1076         S             65
     D  WQ1077         S              9  0
     D  WQ1078         S              7  0
     D  WQ1079         S              6
     D  WQ1080         S             65
     D  WQ1081         S              9  0
     D  WQ1082         S              7  0
     D  WQ1083         S              6
     D  WQ1084         S             65
     D  WQ1085         S              9  0
     D  WQ1086         S              7  0
     D  WQ1087         S              6
     D  WQ1088         S             65
     D  WQ1089         S              9  0
     D  WQ1090         S              7  0
     D  WQ1091         S              6
     D  WQ1092         S             65
     D  WQ1093         S              9  0
     D  WQ1094         S              7  0
     D  WQ1095         S              6
     D  WQ1096         S             65
     D  WQ1097         S              9  0
     D  WQ1098         S              7  0
     D  WQ1099         S              6
     D  WQ1100         S             65
     D  WQ1101         S              9  0
     D  WQ1102         S              7  0
     D  WQ1103         S              6
     D  WQ1104         S             65
     D  WQ1105         S              9  0
     D  WQ1106         S              7  0
     D  WQ1107         S              6
     D  WQ1108         S             65
     D  WQ1109         S              9  0
     D  WQ1110         S              7  0
     D  WQ1111         S              6
     D  WQ1112         S             65
     D  WQ1113         S              9  0
     D  WQ1114         S              7  0
     D  WQ1115         S              6
     D  WQ1116         S             65
     D  WQ1117         S              9  0
     D  WQ1118         S              7  0
     D  WQ1119         S              6
     D  WQ1120         S             65
     D  WQ1121         S              9  0
     D  WQ1122         S              7  0
     D  WQ1123         S              6
     D  WQ1124         S             65
     D  WQ1125         S              9  0
     D  WQ1126         S              7  0
     D  WQ1127         S              6
     D  WQ1128         S             65
     D  WQ1129         S              9  0
     D  WQ1130         S              7  0
     D  WQ1131         S              6
     D  WQ1132         S             65
     D  WQ1133         S              9  0
     D  WQ1134         S              7  0
     D  WQ1135         S              6
     D  WQ1136         S             65
     D  WQ1137         S              9  0
     D  WQ1138         S              7  0
     D  WQ1139         S              6
     D  WQ1140         S             65
     D  WQ1141         S              9  0
     D  WQ1142         S              7  0
     D  WQ1143         S              6
     D  WQ1144         S             65
     D  WQ1145         S              9  0
     D  WQ1146         S              7  0
     D  WQ1147         S              6
     D  WQ1148         S             65
     D  WQ1149         S              9  0
     D  WQ1150         S              7  0
     D  WQ1151         S              6
     D  WQ1152         S             65
     D  WQ1153         S              9  0
     D  WQ1154         S              7  0
     D  WQ1155         S              6
     D  WQ1156         S             65
     D  YL0468         S              1
     D  WQ1157         S              3  0
     D  WQ1158         S              7  0
     D  WQ1159         S              7  0
     D  WQ1160         S              3
     D  WQ1161         S              1
     D  WQ1162         S              1
     D  WQ1163         S              9  0
     D  WQ1164         S              7  0
     D  WQ1165         S              6
     D  WQ1166         S             65
     D  YL0469         S              1
     D  WQ1167         S              3  0
     D  WQ1168         S              7  0
     D  WQ1169         S              3
     D  WQ1170         S              3  0
     D  WQ1171         S              7  0
     D  WQ1172         S              3  0
     D  WQ1173         S              3  0
     D  WQ1174         S              7  0
     D  WQ1175         S              3
     D  WQ1176         S              3
     D  WQ1177         S              3
     D  WQ1178         S             11  4
     D  WQ1179         S             11  2
     D  WQ1180         S             11  4
     D  WQ1181         S             11  4
     D  WQ1182         S              7  0
     D  WQ1183         S              7  0
     D  YL0470         S              1
     D  WN0399         S              7  0
     D  WN0400         S              1
     D  WN0401         S              1
     D  WN0402         S             11  2
     D  WN0403         S              6  0
     D  WN0404         S             10
     D  WN0405         S             10
     D  WN0406         S              7  0
     D  YGRDC          S              1
     D  WL0601         S              7  0
     D  WL0602         S              1
     D  WN0407         S              3  0
     D  WN0408         S              7  0
     D  WN0409         S              1
     D  WN0410         S              1
     D  WN0411         S              5  2
     D  WN0412         S             15
     D  WN0413         S             15
     D  WN0414         S             15
     D  WN0415         S             15
     D  WN0416         S             15
     D  WN0417         S              7  0
     D  WN0418         S             11  2
     D  WN0419         S              1
     D  WN0420         S              5  0
     D  WN0421         S             20
     D  WN0422         S              3
     D  WN0423         S              4  0
     D  WN0424         S              3
     D  WN0425         S              7
     D  WN0426         S              7  0
     D  WN0427         S             11  2
     D  WN0428         S              1
     D  WN0429         S              1
     D  WN0430         S              5  0
     D  WN0431         S              5  0
     D  WN0432         S             11  2
     D  WN0433         S              6  0
     D  WN0434         S              7  0
     D  WN0435         S              4  0
     D  WN0436         S             11  2
     D  WN0437         S             11  2
     D  WN0438         S              7  0
     D  WN0439         S              4  0
     D  WN0440         S              5  0
     D  WN0441         S              5  2
     D  WN0442         S              5  0
     D  WN0443         S             12
     D  WN0444         S              7  0
     D  WN0445         S             12
     D  WN0446         S              2
     D  WN0447         S              3
     D  WN0448         S              2
     D  WN0449         S              7  0
     D  WN0450         S              3
     D  WN0451         S              7  0
     D  WN0452         S              1
     D  WN0453         S              7  0
     D  WN0454         S              6  0
     D  WN0455         S              7  0
     D  WN0456         S              6  0
     D  WN0457         S              7  0
     D  WN0458         S              6  0
     D  WN0459         S              7  0
     D  WN0460         S              6  0
     D  WN0461         S              7  0
     D  WN0462         S              6  0
     D  WN0463         S              7  0
     D  WN0464         S              6  0
     D  WN0465         S              7  0
     D  WN0466         S              6  0
     D  WN0467         S              3
     D  WN0468         S             20
     D  WN0469         S             30
     D  WN0470         S              5  0
     D  WN0471         S              7  0
     D  WN0472         S             12
     D  WN0473         S             20
     D  WN0474         S              7  0
     D  WN0475         S             12
     D  WN0476         S              7  0
     D  WN0477         S              6  0
     D  WN0478         S              7  0
     D  WN0479         S              6  0
     D  WN0480         S             11  2
     D  WN0481         S              7  0
     D  WN0482         S              6  0
     D  WN0483         S              1
     D  WN0484         S              1
     D  WN0485         S              7  0
     D  WN0486         S              7  0
     D  WN0487         S              1
     D  WN0488         S              3
     D  WN0489         S              7  0
     D  WN0490         S              6  0
     D  WN0491         S              7  0
     D  WN0492         S              6  0
     D  WN0493         S              1
     D  WN0494         S              1
     D  WN0495         S             15
     D  WN0496         S             25
     D  WN0497         S             20
     D  WN0498         S              7  0
     D  WN0499         S              1
     D  WN0500         S              1
     D  WN0501         S              7  0
     D  WN0502         S              6  0
     D  WN0503         S              5  0
     D  WN0504         S              9  2
     D  WN0505         S              9  2
     D  WN0506         S              1
     D  WN0507         S             25
     D  WN0508         S              7  0
     D  WN0509         S              6  0
     D  WN0510         S              7  0
     D  WN0511         S              6  0
     D  WN0512         S              1
     D  WN0513         S              1
     D  WN0514         S              1
     D  WN0515         S              1
     D  WN0516         S             11  2
     D  WN0517         S             15
     D  WN0518         S             15
     D  WN0519         S             25
     D  WN0520         S             25
     D  WN0521         S              1
     D  WN0522         S              1
     D  WN0523         S              1
     D  WN0524         S              1
     D  WN0525         S              1
     D  WN0526         S              1
     D  WN0527         S              2
     D  WN0528         S              2
     D  WN0529         S              2
     D  WN0530         S              3
     D  WN0531         S              3
     D  WN0532         S              7  0
     D  WN0533         S              6  0
     D  WN0534         S              7  0
     D  WN0535         S              6  0
     D  WN0536         S              7  0
     D  WN0537         S              6  0
     D  WN0538         S              7  0
     D  WN0539         S              6  0
     D  WN0540         S              7  0
     D  WN0541         S              6  0
     D  WN0542         S              7  0
     D  WN0543         S              6  0
     D  WN0544         S              1
     D  WN0545         S              1
     D  WN0546         S              1
     D  WN0547         S              6  0
     D  WN0548         S             10
     D  WN0549         S             10
     D  WN0550         S              7  0
     D  YHRDC          S              1
     D  YL0471         S              1
     D  WQ1184         S              3  0
     D  WQ1185         S              7  0
     D  WQ1186         S              3
     D  WN0551         S             11  2
     D  WN0552         S              6  0
     D  WN0553         S             10
     D  WN0554         S             10
     D  WN0555         S              7  0
     D  YIRDC          S              1
     D  YL0472         S              1
     D  WQ1187         S              3  0
     D  WQ1188         S              7  0
     D  WQ1189         S              3
     D  YN0266         S              2
     D  YN0267         S              7  0
     D  YN0268         S              7  0
     D  YN0269         S             30
     D  YN0270         S             30
     D  YN0271         S             30
     D  YN0272         S             30
     D  YN0273         S             20
     D  YN0274         S              2
     D  YN0275         S             11
     D  YN0276         S              7  0
     D  YN0277         S             30
     D  YN0278         S             30
     D  YN0279         S             30
     D  YN0280         S             30
     D  YN0281         S             20
     D  YN0282         S              2
     D  YN0283         S             11
     D  YN0284         S             15
     D  YN0285         S              7  0
     D  YN0286         S              7  0
     D  YN0287         S              7  0
     D  YN0288         S              7  0
     D  YN0289         S              2
     D  YN0290         S             40
     D  YN0291         S             40
     D  YN0292         S              1
     D  YN0293         S              1
     D  YN0294         S              1
     D  YN0295         S              1
     D  YN0296         S              3
     D  YN0297         S              1
     D  YN0298         S              1
     D  YN0299         S              7  0
     D  YN0300         S             10
     D  YN0301         S              7  0
     D  YN0302         S             11  2
     D  YN0303         S             11  2
     D  YN0304         S              1
     D  YN0305         S              1
     D  YN0306         S              1
     D  YN0307         S              7  0
     D  YN0308         S              4  0
     D  YN0309         S              4
     D  YN0310         S             12
     D  YN0311         S              7  0
     D  YN0312         S              5  2
     D  YN0313         S             11  2
     D  YN0314         S              1
     D  YN0315         S              1
     D  YN0316         S              1
     D  YN0317         S              2
     D  YN0318         S              1
     D  YN0319         S              1
     D  YN0320         S              1
     D  YN0321         S              1
     D  YN0322         S              1
     D  YN0323         S              5  2
     D  YN0324         S              1
     D  YN0325         S              7  0
     D  YN0326         S              1
     D  YN0327         S              1
     D  YN0328         S              7  0
     D  YN0329         S             30
     D  YN0330         S             30
     D  YN0331         S              1
     D  YN0332         S              3
     D  YN0333         S              2
     D  YN0334         S              3
     D  YN0335         S              7  0
     D  YN0336         S              3
     D  YN0337         S              7  0
     D  YN0338         S              2
     D  YN0339         S              7  0
     D  YN0340         S              2
     D  YN0341         S              1
     D  YN0342         S              1
     D  YN0343         S             11  2
     D  YN0344         S              1
     D  YN0345         S              1
     D  YN0346         S             11  2
     D  YN0347         S              1
     D  YN0348         S              1
     D  YN0349         S              1
     D  YN0350         S              1
     D  YN0351         S              1
     D  YN0352         S              1
     D  YN0353         S              1
     D  YN0354         S              1
     D  YN0355         S              1
     D  YN0356         S              1
     D  YN0357         S              1
     D  YN0358         S              2
     D  YN0359         S              2
     D  YN0360         S              2
     D  YN0361         S              3
     D  YN0362         S              3
     D  YN0363         S              7  0
     D  YN0364         S              7  0
     D  YN0365         S              7  0
     D  YN0366         S              7  0
     D  YN0367         S              7  0
     D  YN0368         S              6  0
     D  YN0369         S              6  0
     D  YN0370         S              6  0
     D  YN0371         S              6  0
     D  YN0372         S              6  0
     D  YN0373         S             11  2
     D  YN0374         S             11  2
     D  YN0375         S             11  2
     D  YN0376         S             11  2
     D  YN0377         S             11  2
     D  YN0378         S              7  0
     D  WQ1190         S              9  0
     D  WQ1191         S              7  0
     D  WQ1192         S              6
     D  WQ1193         S             65
     D  YL0473         S              7  0
     D  YL0474         S              7  0
     D  YL0475         S              7
     D  WQ1194         S              9  0
     D  WQ1195         S              7  0
     D  WQ1196         S              6
     D  WQ1197         S             65
     D  WQ1198         S             10
     D  WQ1199         S             11
     D  WQ1200         S              8
     D  WQ1201         S              8
     D  WQ1202         S              7
     D  WQ1203         S              9  0
     D  WQ1204         S              7  0
     D  WQ1205         S              6
     D  WQ1206         S             65
     D  WQ1207         S              9  0
     D  WQ1208         S              7  0
     D  WQ1209         S              6
     D  WQ1210         S             65
     D  WQ1211         S              9  0
     D  WQ1212         S              7  0
     D  WQ1213         S              6
     D  WQ1214         S             65
     D  YL0476         S              1
     D  WQTX01         S                   LIKE(TEAIC3)
     D  WQTX02         S                   LIKE(TEC4NB)
     D  YL0477         S             11  2
     D  YL0478         S             11  2
     D  WQ1215         S              3  0
     D  WQ1216         S              7  0
     D  WQ1217         S              3  0
     D  WQ1218         S              3  0
     D  WQ1219         S              7  0
     D  WQ1220         S              3
     D  WQ1221         S              7  0
     D  WQ1222         S             11  2
     D  WQ1223         S             11  2
     D  WQ1224         S             11  2
     D  WQ1225         S             11  2
     D  WQ1226         S              2
     D  WQ1227         S             10
     D  WQ1228         S              4  0
     D  WQ1229         S              7  0
     D  WQ1230         S              7  0
     D  WQ1231         S              3  0
     D  WQ1232         S              7  0
     D  WQ1233         S              3  0
     D  WQ1234         S              3  0
     D  YL0479         S              1
     D  YL0480         S              1
     D  YL0481         S              1
     D  YL0482         S              1
     D  YL0483         S             10
     D  YN0379         S             10
     D  YL0484         S             50
     D  WL0603         S             10
     D  WL0604         S             40
     D  WQTY01         S                   LIKE(TON6SC)
     D  YL0485         S              1
     D  YL0486         S              1
     D  YL0487         S              1
     D  YL0488         S              5  0
     D  YL0489         S              5  0
     D  WQNC01         S                   LIKE(TBHQNZ)
     D  WQNB01         S                   LIKE(TBHQNZ)
     D  YL0490         S             80
     D  YL0491         S              9
     D  WQ1235         S             50
     D  WQ1236         S             80
     D  WQ1237         S            500
     D  WQ1238         S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0WB01         S             15  5
     D  W0WB02         S             15  5
     D  W0WB00         S             15  5
     D  W0WD02         S             17  7
     D  W0WD01         S             17  7
     D  W0WD00         S             17  7
     D  W0WA01         S             15  2
     D  W0WA00         S             15  2
     D  W0PMT          S              1
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     D  ZA0001                 1     25
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     D  ZA0002                 1      6P 4
      * Message data for 'Manual price within Prcnt'
      * Price Overage Override
     D  ZA0003                 1      6P 4
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     D  ZA0004                 1      6P 4
      * Message data for 'No Price Mkt/Group Deflt'
      * Commodity Market Code
     D  ZA0005                 1      3
      * Commodity Price Group
     D  ZA0006                 4     10
      * Default Commod Mark basis
     D  ZA0007                11     13
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     D  ZA0008                 1     25
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     D  ZA0009                 1      6P 4
      * Message data for 'Manual price within Prcnt'
      * Price Overage Override
     D  ZA0010                 1      6P 4
      * Message data for 'Ceiling Price Invalid'
      * OD Ceiling Price
     D  ZA0011                 1      6P 4
      * Message data for 'No Price Mkt/Group Deflt'
      * Commodity Market Code
     D  ZA0012                 1      3
      * Commodity Price Group
     D  ZA0013                 4     10
      * Default Commod Mark basis
     D  ZA0014                11     13
     I@C2CPUM
      * WF Block Order Upload Hdr RSQ By Order_Number
      * Renamed input format fields
     I              C2HQNZ                      WAHQNZ
     I              C2AIC3                      WAAIC3
     I              C2C4NB                      WAC4NB
     I              C2GWST                      WAGWST
     I              C2BKC7                      WABKC7
     I              C2AJCD                      WAAJCD
     I              C2A5DT                      WAA5DT
     I              C2ACDT                      WAACDT
     I              C2C3TX                      WAC3TX
     I              C2BCNA                      WABCNA
     I              C2U2ST                      WAU2ST
     I              C2KXCD                      WAKXCD
     I              C2LWAA                      WALWAA
     I              C2FQSX                      WAFQSX
     I              C2VEST                      WAVEST
     I              C2VGST                      WAVGST
     I              C2Q2CD                      WAQ2CD
     I              C2RNNB                      WARNNB
     I              C2N6SC                      WAN6SC
     I              C2OOSC                      WAOOSC
     I              C2EIDT                      WAEIDT
     I              C2VFST                      WAVFST
     I              C2VSST                      WAVSST
     I              C2MJDT                      WAMJDT
     I              C2BETM                      WABETM
     I              C2CCVN                      WACCVN
     I              C2CDVN                      WACDVN
     I              C2MKDT                      WAMKDT
     I              C2BFTM                      WABFTM
     I              C2CEVN                      WACEVN
     I              C2CFVN                      WACFVN
      *
     I@C4CPMC
      * WF Block Order Trans      Retrieval index
      * Renamed input format fields
     I              C4HQNZ                      WBHQNZ
     I              C4AIC3                      WBAIC3
     I              C4C4NB                      WBC4NB
     I              C4N6SC                      WBN6SC
     I              C4VSST                      WBVSST
     I              C4MJDT                      WBMJDT
     I              C4BETM                      WBBETM
     I              C4CCVN                      WBCCVN
     I              C4CDVN                      WBCDVN
     I              C4MKDT                      WBMKDT
     I              C4BFTM                      WBBFTM
     I              C4CEVN                      WBCEVN
     I              C4CFVN                      WBCFVN
      *
     I@JYREEY
      * Company Defaults Internal Plant Companies Only CO
      * Renamed input format fields
     I              JYAIC3                      WCAIC3
     I              JYZ9ST                      WCZ9ST
     I              JYCSST                      WCCSST
     I              JYZ8ST                      WCZ8ST
     I              JYCXST                      WCCXST
     I              JYSWST                      WCSWST
     I              JYXXTM                      WCXXTM
     I              JYUECD                      WCUECD
     I              JYHSST                      WCHSST
     I              JYAMEO                      WCAMEO
     I              JYSSDF                      WCSSDF
     I              JYPDFT                      WCPDFT
     I              JYYISX                      WCYISX
     I              JYYJSX                      WCYJSX
     I              JYYKSX                      WCYKSX
     I              JYYLSX                      WCYLSX
     I              JYYMSX                      WCYMSX
     I              JYYNSX                      WCYNSX
     I              JYUVST                      WCUVST
     I              JYUWST                      WCUWST
     I              JYUXST                      WCUXST
     I              JYVSST                      WCVSST
     I              JYAATM                      WCAATM
     I              JYAYNA                      WCAYNA
     I              JYA0NA                      WCA0NA
     I              JYAXDT                      WCAXDT
      *
     I@BBREU3
      * Customer Master           Rsq Ship #, Active
      * Renamed input format fields
     I              BBBKC7                      WDBKC7
     I              BBAYTX                      WDAYTX
     I              BBACNA                      WDACNA
     I              BBADNA                      WDADNA
     I              BBAENA                      WDAENA
     I              BBAJNA                      WDAJNA
     I              BBBGCD                      WDBGCD
     I              BBG5CD                      WDG5CD
     I              BBBTTX                      WDBTTX
     I              BBBVTX                      WDBVTX
     I              BBBWTX                      WDBWTX
     I              BBABTX                      WDABTX
     I              BBA2NA                      WDA2NA
     I              BBCBST                      WDCBST
     I              BBB0NA                      WDB0NA
     I              BBP3NB                      WDP3NB
     I              BBAXNA                      WDAXNA
     I              BBI6DT                      WDI6DT
     I              BBAYDT                      WDAYDT
     I              BBANC7                      WDANC7
     I              BBBTC7                      WDBTC7
     I              BBK6ST                      WDK6ST
     I              BBUZST                      WDUZST
     I              BBKXCD                      WDKXCD
     I              BBLTCD                      WDLTCD
     I              BBQNST                      WDQNST
     I              BBS2NB                      WDS2NB
     I              BBVHVA                      WDVHVA
     I              BBI7DT                      WDI7DT
     I              BBRJST                      WDRJST
     I              BBRKST                      WDRKST
     I              BBQWST                      WDQWST
     I              BBQXST                      WDQXST
     I              BBQYST                      WDQYST
     I              BBUNCS                      WDUNCS
     I              BBUVST                      WDUVST
     I              BBUWST                      WDUWST
     I              BBUXST                      WDUXST
     I              BBVSST                      WDVSST
     I              BBAATM                      WDAATM
     I              BBAYNA                      WDAYNA
     I              BBA0NA                      WDA0NA
     I              BBAXDT                      WDAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                      WEBKC7
     I              NEUFTX                      WEUFTX
     I              NEUGTX                      WEUGTX
     I              NEPFNA                      WEPFNA
     I              NEJ5NX                      WEJ5NX
     I              NEU5TX                      WEU5TX
     I              NEU6TX                      WEU6TX
     I              NEW0TX                      WEW0TX
     I              NEHSSX                      WEHSSX
     I              NEHUSX                      WEHUSX
     I              NEHVSX                      WEHVSX
     I              NEAAC8                      WEAAC8
     I              NEP0SX                      WEP0SX
     I              NEP1SX                      WEP1SX
     I              NEP2SX                      WEP2SX
     I              NEP3SX                      WEP3SX
     I              NEP4SX                      WEP4SX
     I              NEP5SX                      WEP5SX
     I              NEP6SX                      WEP6SX
     I              NEUVST                      WEUVST
     I              NEUWST                      WEUWST
     I              NEUXST                      WEUXST
     I              NEVSST                      WEVSST
     I              NEAATM                      WEAATM
     I              NEAYNA                      WEAYNA
     I              NEA0NA                      WEA0NA
     I              NEAXDT                      WEAXDT
      *
     I@BBREE9
      * Customer Master           Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                      WFBKC7
     I              BBAYTX                      WFAYTX
     I              BBACNA                      WFACNA
     I              BBADNA                      WFADNA
     I              BBAENA                      WFAENA
     I              BBAJNA                      WFAJNA
     I              BBBGCD                      WFBGCD
     I              BBG5CD                      WFG5CD
     I              BBBTTX                      WFBTTX
     I              BBBVTX                      WFBVTX
     I              BBBWTX                      WFBWTX
     I              BBABTX                      WFABTX
     I              BBA2NA                      WFA2NA
     I              BBCBST                      WFCBST
     I              BBB0NA                      WFB0NA
     I              BBP3NB                      WFP3NB
     I              BBAXNA                      WFAXNA
     I              BBI6DT                      WFI6DT
     I              BBAYDT                      WFAYDT
     I              BBANC7                      WFANC7
     I              BBBTC7                      WFBTC7
     I              BBK6ST                      WFK6ST
     I              BBUZST                      WFUZST
     I              BBKXCD                      WFKXCD
     I              BBLTCD                      WFLTCD
     I              BBQNST                      WFQNST
     I              BBS2NB                      WFS2NB
     I              BBVHVA                      WFVHVA
     I              BBI7DT                      WFI7DT
     I              BBRJST                      WFRJST
     I              BBRKST                      WFRKST
     I              BBQWST                      WFQWST
     I              BBQXST                      WFQXST
     I              BBQYST                      WFQYST
     I              BBUNCS                      WFUNCS
     I              BBUVST                      WFUVST
     I              BBUWST                      WFUWST
     I              BBUXST                      WFUXST
     I              BBVSST                      WFVSST
     I              BBAATM                      WFAATM
     I              BBAYNA                      WFAYNA
     I              BBA0NA                      WFA0NA
     I              BBAXDT                      WFAXDT
      *
     I@AAREY9
      * Customer EXT2             Retrieval index
      * Renamed input format fields
     I              AABKC7                      WGBKC7
     I              AAVEAA                      WGVEAA
     I              AAD9SC                      WGD9SC
     I              AAZZAA                      WGZZAA
     I              AAK8SC                      WGK8SC
     I              AAK5SC                      WGK5SC
     I              AAK6SC                      WGK6SC
     I              AAK7SC                      WGK7SC
     I              AAZ3AA                      WGZ3AA
     I              AAZ4AA                      WGZ4AA
     I              AAZ5AA                      WGZ5AA
     I              AAGBNZ                      WGGBNZ
     I              AAFCNZ                      WGFCNZ
     I              AAXKDT                      WGXKDT
     I              AAEPTM                      WGEPTM
     I              AAO1U1                      WGO1U1
     I              AALWSC                      WGLWSC
     I              AAAKAB                      WGAKAB
     I              AAGANZ                      WGGANZ
     I              AAEOTM                      WGEOTM
     I              AAVSST                      WGVSST
     I              AAMJDT                      WGMJDT
     I              AABETM                      WGBETM
     I              AACCVN                      WGCCVN
     I              AACDVN                      WGCDVN
     I              AAMKDT                      WGMKDT
     I              AABFTM                      WGBFTM
     I              AACEVN                      WGCEVN
     I              AACFVN                      WGCFVN
      *
     I@E5REB8
      * Country Master            Retrieval index
      * Renamed input format fields
     I              E5KXCD                      WHKXCD
     I              E5DATX                      WHDATX
     I              E5UVST                      WHUVST
     I              E5UWST                      WHUWST
     I              E5UXST                      WHUXST
     I              E5VSST                      WHVSST
     I              E5AATM                      WHAATM
     I              E5AYNA                      WHAYNA
     I              E5A0NA                      WHA0NA
     I              E5AXDT                      WHAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                      WIAJCD
     I              ADF8NA                      WIF8NA
     I              ADACNA                      WIACNA
     I              ADADNA                      WIADNA
     I              ADAENA                      WIAENA
     I              ADAJNA                      WIAJNA
     I              ADBTTX                      WIBTTX
     I              ADAOCD                      WIAOCD
     I              ADBGCD                      WIBGCD
     I              ADVHST                      WIVHST
     I              ADMPNA                      WIMPNA
     I              ADWPST                      WIWPST
     I              ADXUST                      WIXUST
     I              ADT0ST                      WIT0ST
     I              ADT1ST                      WIT1ST
     I              ADDBNB                      WIDBNB
     I              ADT2ST                      WIT2ST
     I              ADT3ST                      WIT3ST
     I              ADT4ST                      WIT4ST
     I              ADT6ST                      WIT6ST
     I              ADBWC3                      WIBWC3
     I              ADBTC3                      WIBTC3
     I              ADBUC3                      WIBUC3
     I              ADBVC3                      WIBVC3
     I              ADFCAA                      WIFCAA
     I              ADRQSX                      WIRQSX
     I              ADRRSX                      WIRRSX
     I              ADRSSX                      WIRSSX
     I              ADRTSX                      WIRTSX
     I              ADT7ST                      WIT7ST
     I              ADT8ST                      WIT8ST
     I              ADRNSX                      WIRNSX
     I              ADROSX                      WIROSX
     I              ADRPSX                      WIRPSX
     I              ADUVST                      WIUVST
     I              ADUWST                      WIUWST
     I              ADUXST                      WIUXST
     I              ADVSST                      WIVSST
     I              ADAATM                      WIAATM
     I              ADAYNA                      WIAYNA
     I              ADA0NA                      WIA0NA
     I              ADAXDT                      WIAXDT
     I              ADQDSC                      WIQDSC
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                      WJAJCD
     I              ADF8NA                      WJF8NA
     I              ADACNA                      WJACNA
     I              ADADNA                      WJADNA
     I              ADAENA                      WJAENA
     I              ADAJNA                      WJAJNA
     I              ADBTTX                      WJBTTX
     I              ADAOCD                      WJAOCD
     I              ADBGCD                      WJBGCD
     I              ADVHST                      WJVHST
     I              ADMPNA                      WJMPNA
     I              ADWPST                      WJWPST
     I              ADXUST                      WJXUST
     I              ADT0ST                      WJT0ST
     I              ADT1ST                      WJT1ST
     I              ADDBNB                      WJDBNB
     I              ADT2ST                      WJT2ST
     I              ADT3ST                      WJT3ST
     I              ADT4ST                      WJT4ST
     I              ADT6ST                      WJT6ST
     I              ADBWC3                      WJBWC3
     I              ADBTC3                      WJBTC3
     I              ADBUC3                      WJBUC3
     I              ADBVC3                      WJBVC3
     I              ADFCAA                      WJFCAA
     I              ADRQSX                      WJRQSX
     I              ADRRSX                      WJRRSX
     I              ADRSSX                      WJRSSX
     I              ADRTSX                      WJRTSX
     I              ADT7ST                      WJT7ST
     I              ADT8ST                      WJT8ST
     I              ADRNSX                      WJRNSX
     I              ADROSX                      WJROSX
     I              ADRPSX                      WJRPSX
     I              ADUVST                      WJUVST
     I              ADUWST                      WJUWST
     I              ADUXST                      WJUXST
     I              ADVSST                      WJVSST
     I              ADAATM                      WJAATM
     I              ADAYNA                      WJAYNA
     I              ADA0NA                      WJA0NA
     I              ADAXDT                      WJAXDT
     I              ADQDSC                      WJQDSC
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                      WKAIC3
     I              KMV8CD                      WKV8CD
     I              KMAUNA                      WKAUNA
     I              KMI5ST                      WKI5ST
     I              KMBXTX                      WKBXTX
     I              KMM8NB                      WKM8NB
     I              KMUVST                      WKUVST
     I              KMUWST                      WKUWST
     I              KMUXST                      WKUXST
     I              KMVSST                      WKVSST
     I              KMAATM                      WKAATM
     I              KMAYNA                      WKAYNA
     I              KMA0NA                      WKA0NA
     I              KMAXDT                      WKAXDT
      *
     I@AFREBE
      * Calendar Master           Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                      WLAIC3
     I              AFBCDT                      WLBCDT
     I              AFCQNB                      WLCQNB
     I              AFESNB                      WLESNB
     I              AFETNB                      WLETNB
     I              AFBZNB                      WLBZNB
     I              AFA9ST                      WLA9ST
     I              AFEINB                      WLEINB
     I              AFC5ST                      WLC5ST
     I              AFAQNB                      WLAQNB
     I              AFCMST                      WLCMST
     I              AFV9ST                      WLV9ST
     I              AFWAST                      WLWAST
     I              AFX2ST                      WLX2ST
     I              AFOJDT                      WLOJDT
     I              AFNQNX                      WLNQNX
     I              AFNRNX                      WLNRNX
     I              AFI9SX                      WLI9SX
     I              AFJASX                      WLJASX
     I              AFOKDT                      WLOKDT
     I              AFOLDT                      WLOLDT
     I              AFUVST                      WLUVST
     I              AFUWST                      WLUWST
     I              AFUXST                      WLUXST
     I              AFAATM                      WLAATM
     I              AFAYNA                      WLAYNA
     I              AFA0NA                      WLA0NA
     I              AFAXDT                      WLAXDT
      *
     I@C3CPL9
      * WF Block Order Upload Dtl Retrieval index
      * Renamed input format fields
     I              C3HQNZ                      WMHQNZ
     I              C3DXNB                      WMDXNB
     I              C3C4NB                      WMC4NB
     I              C3HGCD                      WMHGCD
     I              C3GMST                      WMGMST
     I              C3ACDT                      WMACDT
     I              C3AVQT                      WMAVQT
     I              C3Q7CD                      WMQ7CD
     I              C3RINY                      WMRINY
     I              C3F7SX                      WMF7SX
     I              C3EXDT                      WMEXDT
     I              C3HPST                      WMHPST
     I              C3BZPR                      WMBZPR
     I              C3A1AA                      WMA1AA
     I              C3VEST                      WMVEST
     I              C3F5SX                      WMF5SX
     I              C3VGST                      WMVGST
     I              C3VSST                      WMVSST
     I              C3BGTS                      WMBGTS
     I              C3RUU1                      WMRUU1
     I              C3RVU1                      WMRVU1
     I              C3BHTS                      WMBHTS
     I              C3RWU1                      WMRWU1
     I              C3RXU1                      WMRXU1
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                      WOAIC3
     I              BZHGCD                      WOHGCD
     I              BZAVNA                      WOAVNA
     I              BZAWNA                      WOAWNA
     I              BZL7NA                      WOL7NA
     I              BZL8NA                      WOL8NA
     I              BZL6NA                      WOL6NA
     I              BZMFNA                      WOMFNA
     I              BZADCD                      WOADCD
     I              BZAWPC                      WOAWPC
     I              BZLXST                      WOLXST
     I              BZAECD                      WOAECD
     I              BZAXPC                      WOAXPC
     I              BZLYST                      WOLYST
     I              BZAFCD                      WOAFCD
     I              BZAICD                      WOAICD
     I              BZAIWG                      WOAIWG
     I              BZHICD                      WOHICD
     I              BZRBCD                      WORBCD
     I              BZFZST                      WOFZST
     I              BZAVST                      WOAVST
     I              BZCZWG                      WOCZWG
     I              BZC0WG                      WOC0WG
     I              BZURTN                      WOURTN
     I              BZAJC8                      WOAJC8
     I              BZRINB                      WORINB
     I              BZRHNB                      WORHNB
     I              BZRGNB                      WORGNB
     I              BZLNCD                      WOLNCD
     I              BZTFNB                      WOTFNB
     I              BZN0CD                      WON0CD
     I              BZX4ST                      WOX4ST
     I              BZTMVA                      WOTMVA
     I              BZTNVA                      WOTNVA
     I              BZBLPR                      WOBLPR
     I              BZBMPR                      WOBMPR
     I              BZLRCD                      WOLRCD
     I              BZU9ST                      WOU9ST
     I              BZCMCO                      WOCMCO
     I              BZQ1CD                      WOQ1CD
     I              BZQ8CD                      WOQ8CD
     I              BZCHTM                      WOCHTM
     I              BZQZCD                      WOQZCD
     I              BZXWST                      WOXWST
     I              BZXXST                      WOXXST
     I              BZVMST                      WOVMST
     I              BZSWGH                      WOSWGH
     I              BZPPHE                      WOPPHE
     I              BZR3CD                      WOR3CD
     I              BZSDCD                      WOSDCD
     I              BZICN1                      WOICN1
     I              BZSVCD                      WOSVCD
     I              BZICN2                      WOICN2
     I              BZSWCD                      WOSWCD
     I              BZV2NB                      WOV2NB
     I              BZSXCD                      WOSXCD
     I              BZITCN                      WOITCN
     I              BZSYCD                      WOSYCD
     I              BZITC5                      WOITC5
     I              BZSZCD                      WOSZCD
     I              BZICN6                      WOICN6
     I              BZS0CD                      WOS0CD
     I              BZICN7                      WOICN7
     I              BZS1CD                      WOS1CD
     I              BZICN8                      WOICN8
     I              BZS2CD                      WOS2CD
     I              BZICN9                      WOICN9
     I              BZS3CD                      WOS3CD
     I              BZICN0                      WOICN0
     I              BZS4CD                      WOS4CD
     I              BZSFNB                      WOSFNB
     I              BZA3WG                      WOA3WG
     I              BZSJNB                      WOSJNB
     I              BZLLCD                      WOLLCD
     I              BZLMCD                      WOLMCD
     I              BZP3ST                      WOP3ST
     I              BZSKNB                      WOSKNB
     I              BZSLNB                      WOSLNB
     I              BZSMNB                      WOSMNB
     I              BZP4ST                      WOP4ST
     I              BZCFNB                      WOCFNB
     I              BZCGNB                      WOCGNB
     I              BZILNB                      WOILNB
     I              BZCHNB                      WOCHNB
     I              BZCINB                      WOCINB
     I              BZCJNB                      WOCJNB
     I              BZCMNB                      WOCMNB
     I              BZCNNB                      WOCNNB
     I              BZCRNB                      WOCRNB
     I              BZCSNB                      WOCSNB
     I              BZCVNB                      WOCVNB
     I              BZCWNB                      WOCWNB
     I              BZCXNB                      WOCXNB
     I              BZCZNB                      WOCZNB
     I              BZC0NB                      WOC0NB
     I              BZN1CD                      WON1CD
     I              BZB4NB                      WOB4NB
     I              BZB5NB                      WOB5NB
     I              BZX5ST                      WOX5ST
     I              BZX6ST                      WOX6ST
     I              BZX7ST                      WOX7ST
     I              BZPCCT                      WOPCCT
     I              BZBDNB                      WOBDNB
     I              BZBJNB                      WOBJNB
     I              BZSUST                      WOSUST
     I              BZSVST                      WOSVST
     I              BZSYST                      WOSYST
     I              BZSZST                      WOSZST
     I              BZS1ST                      WOS1ST
     I              BZXRCD                      WOXRCD
     I              BZXTCD                      WOXTCD
     I              BZXUCD                      WOXUCD
     I              BZF5WG                      WOF5WG
     I              BZF6WG                      WOF6WG
     I              BZF7WG                      WOF7WG
     I              BZBLNB                      WOBLNB
     I              BZBNNB                      WOBNNB
     I              BZS2ST                      WOS2ST
     I              BZS4ST                      WOS4ST
     I              BZS5ST                      WOS5ST
     I              BZS6ST                      WOS6ST
     I              BZS8ST                      WOS8ST
     I              BZS9ST                      WOS9ST
     I              BZTCST                      WOTCST
     I              BZTDST                      WOTDST
     I              BZUVST                      WOUVST
     I              BZUWST                      WOUWST
     I              BZUXST                      WOUXST
     I              BZVSST                      WOVSST
     I              BZAATM                      WOAATM
     I              BZAYNA                      WOAYNA
     I              BZA0NA                      WOA0NA
     I              BZAXDT                      WOAXDT
      *
     I@M1REJ2
      * Ham Group Item            HamGrp/Item RS=A
      * Renamed input format fields
     I              M1A1AA                      WRA1AA
     I              M1DPC7                      WRDPC7
     I              M1JJNX                      WRJJNX
     I              M1UVST                      WRUVST
     I              M1UWST                      WRUWST
     I              M1UXST                      WRUXST
     I              M1VSST                      WRVSST
     I              M1AATM                      WRAATM
     I              M1AYNA                      WRAYNA
     I              M1A0NA                      WRA0NA
     I              M1AXDT                      WRAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                      WSAIC3
     I              EOBKC7                      WSBKC7
     I              EOAQCD                      WSAQCD
     I              EOR4CD                      WSR4CD
     I              EOBYNA                      WSBYNA
     I              EOB6NA                      WSB6NA
     I              EOBZNA                      WSBZNA
     I              EOLLST                      WSLLST
     I              EOPPST                      WSPPST
     I              EOR5NB                      WSR5NB
     I              EOR6NB                      WSR6NB
     I              EOQGST                      WSQGST
     I              EOBOCD                      WSBOCD
     I              EOTBNB                      WSTBNB
     I              EOMTCU                      WSMTCU
     I              EOW2NB                      WSW2NB
     I              EORPCD                      WSRPCD
     I              EOAJCD                      WSAJCD
     I              EOX9ST                      WSX9ST
     I              EOT9CD                      WST9CD
     I              EOUBCD                      WSUBCD
     I              EOISTX                      WSISTX
     I              EOLQCD                      WSLQCD
     I              EONJNA                      WSNJNA
     I              EOI0TX                      WSI0TX
     I              EONKNA                      WSNKNA
     I              EOI1TX                      WSI1TX
     I              EOVLST                      WSVLST
     I              EORLST                      WSRLST
     I              EOMMTX                      WSMMTX
     I              EOOHNA                      WSOHNA
     I              EOQ6ST                      WSQ6ST
     I              EOQ8ST                      WSQ8ST
     I              EORBST                      WSRBST
     I              EOREST                      WSREST
     I              EOUVST                      WSUVST
     I              EOUWST                      WSUWST
     I              EOUXST                      WSUXST
     I              EOVSST                      WSVSST
     I              EOAATM                      WSAATM
     I              EOAYNA                      WSAYNA
     I              EOA0NA                      WSA0NA
     I              EOAXDT                      WSAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                      WTAIC3
     I              IHQ7CD                      WTQ7CD
     I              IHMLNA                      WTMLNA
     I              IHU0ST                      WTU0ST
     I              IHV8ST                      WTV8ST
     I              IHBYST                      WTBYST
     I              IHRMNY                      WTRMNY
     I              IHH3ST                      WTH3ST
     I              IHH5ST                      WTH5ST
     I              IHH6ST                      WTH6ST
     I              IHH7ST                      WTH7ST
     I              IHUVST                      WTUVST
     I              IHUWST                      WTUWST
     I              IHUXST                      WTUXST
     I              IHAATM                      WTAATM
     I              IHAYNA                      WTAYNA
     I              IHA0NA                      WTA0NA
     I              IHAXDT                      WTAXDT
      *
     I@ASREVL
      * Company Control           Retrieval Active Only
      * Renamed input format fields
     I              ASAIC3                      WVAIC3
     I              ASAXNB                      WVAXNB
     I              ASNGNB                      WVNGNB
     I              ASBZNB                      WVBZNB
     I              ASC5NB                      WVC5NB
     I              ASC3NB                      WVC3NB
     I              ASCYNB                      WVCYNB
     I              ASIONB                      WVIONB
     I              ASI6NB                      WVI6NB
     I              ASDCNB                      WVDCNB
     I              ASC7NB                      WVC7NB
     I              ASC2NB                      WVC2NB
     I              ASC1NB                      WVC1NB
     I              ASL8NB                      WVL8NB
     I              ASBANB                      WVBANB
     I              ASCHST                      WVCHST
     I              ASCKST                      WVCKST
     I              ASCIST                      WVCIST
     I              ASCGST                      WVCGST
     I              ASAIPC                      WVAIPC
     I              ASASPC                      WVASPC
     I              ASA2VA                      WVA2VA
     I              ASC2ST                      WVC2ST
     I              ASD8ST                      WVD8ST
     I              ASD7ST                      WVD7ST
     I              ASA8NA                      WVA8NA
     I              ASA9NA                      WVA9NA
     I              ASBANA                      WVBANA
     I              ASBBNA                      WVBBNA
     I              ASEUST                      WVEUST
     I              ASAADY                      WVAADY
     I              ASABDY                      WVABDY
     I              ASACDY                      WVACDY
     I              ASADDY                      WVADDY
     I              ASAEDY                      WVAEDY
     I              ASAFDY                      WVAFDY
     I              ASAGDY                      WVAGDY
     I              ASAHDY                      WVAHDY
     I              ASAENB                      WVAENB
     I              ASALNB                      WVALNB
     I              ASEVNB                      WVEVNB
     I              ASRPOP                      WVRPOP
     I              ASDWNB                      WVDWNB
     I              ASR3NB                      WVR3NB
     I              ASPNST                      WVPNST
     I              ASR4NB                      WVR4NB
     I              ASPOST                      WVPOST
     I              ASSCNB                      WVSCNB
     I              ASVIST                      WVVIST
     I              ASVJST                      WVVJST
     I              ASBVVN                      WVBVVN
     I              ASUVST                      WVUVST
     I              ASUWST                      WVUWST
     I              ASUXST                      WVUXST
     I              ASVSST                      WVVSST
     I              ASAATM                      WVAATM
     I              ASAYNA                      WVAYNA
     I              ASA0NA                      WVA0NA
     I              ASAXDT                      WVAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                      WWLQCD
     I              F0LRCD                      WWLRCD
     I              F0EQDT                      WWEQDT
     I              F0A5PR                      WWA5PR
     I              F0B8PR                      WWB8PR
     I              F0UVST                      WWUVST
     I              F0UWST                      WWUWST
     I              F0UXST                      WWUXST
     I              F0VSST                      WWVSST
     I              F0AATM                      WWAATM
     I              F0AYNA                      WWAYNA
     I              F0A0NA                      WWA0NA
     I              F0AXDT                      WWAXDT
      *
     I@IPREFJ
      * Market Date Method        System/Co/Date Method
      * Renamed input format fields
     I              IPAIC3                      WXAIC3
     I              IPRDCD                      WXRDCD
     I              IPMNNA                      WXMNNA
     I              IPRECD                      WXRECD
     I              IPCPRD                      WXCPRD
     I              IPQMNB                      WXQMNB
     I              IPU7ST                      WXU7ST
     I              IPCNOT                      WXCNOT
     I              IPU8ST                      WXU8ST
     I              IPCDOW                      WXCDOW
     I              IPBXST                      WXBXST
     I              IPUVST                      WXUVST
     I              IPUWST                      WXUWST
     I              IPUXST                      WXUXST
     I              IPAATM                      WXAATM
     I              IPAYNA                      WXAYNA
     I              IPA0NA                      WXA0NA
     I              IPAXDT                      WXAXDT
      *
     I@F0CPVR
      * Commodity Mrkt Price      Active Only
      * Renamed input format fields
     I              F0LQCD                      WYLQCD
     I              F0LRCD                      WYLRCD
     I              F0EQDT                      WYEQDT
     I              F0A5PR                      WYA5PR
     I              F0B8PR                      WYB8PR
     I              F0UVST                      WYUVST
     I              F0UWST                      WYUWST
     I              F0UXST                      WYUXST
     I              F0VSST                      WYVSST
     I              F0AATM                      WYAATM
     I              F0AYNA                      WYAYNA
     I              F0A0NA                      WYA0NA
     I              F0AXDT                      WYAXDT
      *
     I@C2CPL5
      * WF Block Order Upload Hdr Update index
      * Renamed input format fields
     I              C2HQNZ                      TAHQNZ
     I              C2AIC3                      TAAIC3
     I              C2C4NB                      TAC4NB
     I              C2GWST                      TAGWST
     I              C2BKC7                      TABKC7
     I              C2AJCD                      TAAJCD
     I              C2A5DT                      TAA5DT
     I              C2ACDT                      TAACDT
     I              C2C3TX                      TAC3TX
     I              C2BCNA                      TABCNA
     I              C2U2ST                      TAU2ST
     I              C2KXCD                      TAKXCD
     I              C2LWAA                      TALWAA
     I              C2FQSX                      TAFQSX
     I              C2VEST                      TAVEST
     I              C2VGST                      TAVGST
     I              C2Q2CD                      TAQ2CD
     I              C2RNNB                      TARNNB
     I              C2N6SC                      TAN6SC
     I              C2OOSC                      TAOOSC
     I              C2EIDT                      TAEIDT
     I              C2VFST                      TAVFST
     I              C2VSST                      TAVSST
     I              C2MJDT                      TAMJDT
     I              C2BETM                      TABETM
     I              C2CCVN                      TACCVN
     I              C2CDVN                      TACDVN
     I              C2MKDT                      TAMKDT
     I              C2BFTM                      TABFTM
     I              C2CEVN                      TACEVN
     I              C2CFVN                      TACFVN
      *
     I@C5CPMF
      * WF Block Order Errors     Retrieval index
      * Renamed input format fields
     I              C5HQNZ                      TBHQNZ
     I              C5DXNB                      TBDXNB
     I              C5C4NB                      TBC4NB
     I              C5N7SC                      TBN7SC
     I              C5VUNA                      TBVUNA
      *
     I@C4CPMB
      * WF Block Order Trans      Update index
      * Renamed input format fields
     I              C4HQNZ                      TCHQNZ
     I              C4AIC3                      TCAIC3
     I              C4C4NB                      TCC4NB
     I              C4N6SC                      TCN6SC
     I              C4VSST                      TCVSST
     I              C4MJDT                      TCMJDT
     I              C4BETM                      TCBETM
     I              C4CCVN                      TCCCVN
     I              C4CDVN                      TCCDVN
     I              C4MKDT                      TCMKDT
     I              C4BFTM                      TCBFTM
     I              C4CEVN                      TCCEVN
     I              C4CFVN                      TCCFVN
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                      TDAIC3
     I              BEC4NB                      TDC4NB
     I              BEJNCD                      TDJNCD
     I              BEANC7                      TDANC7
     I              BEBKC7                      TDBKC7
     I              BEBRTX                      TDBRTX
     I              BEHMNA                      TDHMNA
     I              BEHONA                      TDHONA
     I              BEHPNA                      TDHPNA
     I              BEHNNA                      TDHNNA
     I              BEDBCD                      TDDBCD
     I              BECKTX                      TDCKTX
     I              BEB0C7                      TDB0C7
     I              BEAETX                      TDAETX
     I              BEB1NA                      TDB1NA
     I              BEB3NA                      TDB3NA
     I              BEB4NA                      TDB4NA
     I              BEB2NA                      TDB2NA
     I              BEBHCD                      TDBHCD
     I              BEC8TX                      TDC8TX
     I              BEBCNA                      TDBCNA
     I              BEA0DT                      TDA0DT
     I              BEA5DT                      TDA5DT
     I              BEGNDT                      TDGNDT
     I              BEACDT                      TDACDT
     I              BEAQCD                      TDAQCD
     I              BEB6NA                      TDB6NA
     I              BEBYNA                      TDBYNA
     I              BEBZNA                      TDBZNA
     I              BEGTST                      TDGTST
     I              BEGVST                      TDGVST
     I              BEGUST                      TDGUST
     I              BEQFST                      TDQFST
     I              BECQCD                      TDCQCD
     I              BEGJST                      TDGJST
     I              BEGWST                      TDGWST
     I              BEGXST                      TDGXST
     I              BEGYST                      TDGYST
     I              BEAODT                      TDAODT
     I              BEAIVN                      TDAIVN
     I              BECXDT                      TDCXDT
     I              BEJZVA                      TDJZVA
     I              BEA1WG                      TDA1WG
     I              BEXIST                      TDXIST
     I              BEXJST                      TDXJST
     I              BEXKST                      TDXKST
     I              BEEIDT                      TDEIDT
     I              BEAFTM                      TDAFTM
     I              BEE8CD                      TDE8CD
     I              BEE9CD                      TDE9CD
     I              BERMNB                      TDRMNB
     I              BETBNB                      TDTBNB
     I              BER1NB                      TDR1NB
     I              BEPJST                      TDPJST
     I              BEU0ST                      TDU0ST
     I              BEU1ST                      TDU1ST
     I              BEQ2CD                      TDQ2CD
     I              BEU2ST                      TDU2ST
     I              BEVEST                      TDVEST
     I              BEVFST                      TDVFST
     I              BEVGST                      TDVGST
     I              BERPCD                      TDRPCD
     I              BERNNB                      TDRNNB
     I              BEVDST                      TDVDST
     I              BEATIN                      TDATIN
     I              BEU4ST                      TDU4ST
     I              BEU5ST                      TDU5ST
     I              BERSRN                      TDRSRN
     I              BEMHNA                      TDMHNA
     I              BEMINA                      TDMINA
     I              BEWBST                      TDWBST
     I              BER4CD                      TDR4CD
     I              BEBFCD                      TDBFCD
     I              BEQ4CD                      TDQ4CD
     I              BET3NB                      TDT3NB
     I              BESICD                      TDSICD
     I              BECONB                      TDCONB
     I              BECEST                      TDCEST
     I              BEAWDT                      TDAWDT
     I              BEJPCD                      TDJPCD
     I              BEXUST                      TDXUST
     I              BEZ1ST                      TDZ1ST
     I              BEVRVA                      TDVRVA
     I              BEOBST                      TDOBST
     I              BEBCST                      TDBCST
     I              BEBDST                      TDBDST
     I              BEB7VL                      TDB7VL
     I              BEGASX                      TDGASX
     I              BEGBSX                      TDGBSX
     I              BEGCSX                      TDGCSX
     I              BEGDSX                      TDGDSX
     I              BEFNSX                      TDFNSX
     I              BEFOSX                      TDFOSX
     I              BEFPSX                      TDFPSX
     I              BEFQSX                      TDFQSX
     I              BEFRSX                      TDFRSX
     I              BEFSSX                      TDFSSX
     I              BEFTSX                      TDFTSX
     I              BEFUSX                      TDFUSX
     I              BEFVSX                      TDFVSX
     I              BEFWSX                      TDFWSX
     I              BEFXSX                      TDFXSX
     I              BEFYSX                      TDFYSX
     I              BENODT                      TDNODT
     I              BENPDT                      TDNPDT
     I              BENQDT                      TDNQDT
     I              BENRDT                      TDNRDT
     I              BENSDT                      TDNSDT
     I              BEBPTM                      TDBPTM
     I              BEBQTM                      TDBQTM
     I              BEBRTM                      TDBRTM
     I              BEBSTM                      TDBSTM
     I              BEBTTM                      TDBTTM
     I              BEH0NX                      TDH0NX
     I              BEH1NX                      TDH1NX
     I              BEH2NX                      TDH2NX
     I              BEH3NX                      TDH3NX
     I              BEH4NX                      TDH4NX
     I              BEC0C7                      TDC0C7
     I              BEUVST                      TDUVST
     I              BEUWST                      TDUWST
     I              BEUXST                      TDUXST
     I              BEAATM                      TDAATM
     I              BEAYNA                      TDAYNA
     I              BEA0NA                      TDA0NA
     I              BEAXDT                      TDAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      TEAIC3
     I              OMC4NB                      TEC4NB
     I              OMDPNB                      TEDPNB
     I              OMUENB                      TEUENB
     I              OMHGCD                      TEHGCD
     I              OMAJCD                      TEAJCD
     I              OMBKC7                      TEBKC7
     I              OMCFC7                      TECFC7
     I              OMGMST                      TEGMST
     I              OMGNST                      TEGNST
     I              OMMAVA                      TEMAVA
     I              OMKDVA                      TEKDVA
     I              OML8VA                      TEL8VA
     I              OML9VA                      TEL9VA
     I              OMGTST                      TEGTST
     I              OMGVST                      TEGVST
     I              OMGUST                      TEGUST
     I              OMQFST                      TEQFST
     I              OMAYVA                      TEAYVA
     I              OMEXDT                      TEEXDT
     I              OMLQCD                      TELQCD
     I              OMRDCD                      TERDCD
     I              OMQ7CD                      TEQ7CD
     I              OMBZPR                      TEBZPR
     I              OML6NB                      TEL6NB
     I              OMU1ST                      TEU1ST
     I              OMGIDT                      TEGIDT
     I              OMCRCD                      TECRCD
     I              OMAGCD                      TEAGCD
     I              OMRZST                      TERZST
     I              OMR0ST                      TER0ST
     I              OMR1ST                      TER1ST
     I              OMG7NA                      TEG7NA
     I              OMG8NA                      TEG8NA
     I              OMRPCD                      TERPCD
     I              OMVEST                      TEVEST
     I              OMVGST                      TEVGST
     I              OMAVST                      TEAVST
     I              OMU0ST                      TEU0ST
     I              OMRFCD                      TERFCD
     I              OMFZST                      TEFZST
     I              OMR1NB                      TER1NB
     I              OMAVQT                      TEAVQT
     I              OMD0WG                      TED0WG
     I              OMCCQT                      TECCQT
     I              OMAUWG                      TEAUWG
     I              OMCBQT                      TECBQT
     I              OMATWG                      TEATWG
     I              OMAQCS                      TEAQCS
     I              OMAGCS                      TEAGCS
     I              OMAKPR                      TEAKPR
     I              OMALPR                      TEALPR
     I              OMAUPR                      TEAUPR
     I              OMAVWG                      TEAVWG
     I              OMA4WG                      TEA4WG
     I              OMA5DT                      TEA5DT
     I              OMAODT                      TEAODT
     I              OMGNDT                      TEGNDT
     I              OMAMST                      TEAMST
     I              OMANST                      TEANST
     I              OMVAST                      TEVAST
     I              OMRGNB                      TERGNB
     I              OMRHNB                      TERHNB
     I              OMRINB                      TERINB
     I              OMRBCD                      TERBCD
     I              OMHICD                      TEHICD
     I              OMRNCD                      TERNCD
     I              OMROCD                      TEROCD
     I              OMCXDT                      TECXDT
     I              OMAJVN                      TEAJVN
     I              OMKXCD                      TEKXCD
     I              OMJPCD                      TEJPCD
     I              OMCQCD                      TECQCD
     I              OMR4CD                      TER4CD
     I              OMZ1ST                      TEZ1ST
     I              OMZ3ST                      TEZ3ST
     I              OMZ4ST                      TEZ4ST
     I              OMDUPR                      TEDUPR
     I              OMB6VL                      TEB6VL
     I              OMA1AA                      TEA1AA
     I              OMFZSX                      TEFZSX
     I              OMF0SX                      TEF0SX
     I              OMF1SX                      TEF1SX
     I              OMF2SX                      TEF2SX
     I              OMF3SX                      TEF3SX
     I              OMF4SX                      TEF4SX
     I              OMF5SX                      TEF5SX
     I              OMF6SX                      TEF6SX
     I              OMF7SX                      TEF7SX
     I              OMNTDT                      TENTDT
     I              OMNUDT                      TENUDT
     I              OMNVDT                      TENVDT
     I              OMNWDT                      TENWDT
     I              OMNXDT                      TENXDT
     I              OMBUTM                      TEBUTM
     I              OMBVTM                      TEBVTM
     I              OMBWTM                      TEBWTM
     I              OMBXTM                      TEBXTM
     I              OMBYTM                      TEBYTM
     I              OMH5NX                      TEH5NX
     I              OMH6NX                      TEH6NX
     I              OMH7NX                      TEH7NX
     I              OMH8NX                      TEH8NX
     I              OMH9NX                      TEH9NX
     I              OMDVPR                      TEDVPR
     I              OMDWPR                      TEDWPR
     I              OMDXPR                      TEDXPR
     I              OMDYPR                      TEDYPR
     I              OMDZPR                      TEDZPR
     I              OMGSPR                      TEGSPR
     I              OMGTPR                      TEGTPR
     I              OMGUPR                      TEGUPR
     I              OMHOST                      TEHOST
     I              OMHPST                      TEHPST
     I              OMIOST                      TEIOST
     I              OMPEWG                      TEPEWG
     I              OMRINY                      TERINY
     I              OMTIDT                      TETIDT
     I              OMTJDT                      TETJDT
     I              OMH2ST                      TEH2ST
     I              OMH0ST                      TEH0ST
     I              OMH1ST                      TEH1ST
     I              OMTKDT                      TETKDT
     I              OMTLDT                      TETLDT
     I              OMTMDT                      TETMDT
     I              OMUVST                      TEUVST
     I              OMUWST                      TEUWST
     I              OMUXST                      TEUXST
     I              OMAATM                      TEAATM
     I              OMAYNA                      TEAYNA
     I              OMA0NA                      TEA0NA
     I              OMAXDT                      TEAXDT
      *
     I@C3CPL8
      * WF Block Order Upload Dtl Update index
      * Renamed input format fields
     I              C3HQNZ                      TFHQNZ
     I              C3DXNB                      TFDXNB
     I              C3C4NB                      TFC4NB
     I              C3HGCD                      TFHGCD
     I              C3GMST                      TFGMST
     I              C3ACDT                      TFACDT
     I              C3AVQT                      TFAVQT
     I              C3Q7CD                      TFQ7CD
     I              C3RINY                      TFRINY
     I              C3F7SX                      TFF7SX
     I              C3EXDT                      TFEXDT
     I              C3HPST                      TFHPST
     I              C3BZPR                      TFBZPR
     I              C3A1AA                      TFA1AA
     I              C3VEST                      TFVEST
     I              C3F5SX                      TFF5SX
     I              C3VGST                      TFVGST
     I              C3VSST                      TFVSST
     I              C3BGTS                      TFBGTS
     I              C3RUU1                      TFRUU1
     I              C3RVU1                      TFRVU1
     I              C3BHTS                      TFBHTS
     I              C3RWU1                      TFRWU1
     I              C3RXU1                      TFRXU1
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                      TGAIC3
     I              OMC4NB                      TGC4NB
     I              OMDPNB                      TGDPNB
     I              OMUENB                      TGUENB
     I              OMHGCD                      TGHGCD
     I              OMAJCD                      TGAJCD
     I              OMBKC7                      TGBKC7
     I              OMCFC7                      TGCFC7
     I              OMGMST                      TGGMST
     I              OMGNST                      TGGNST
     I              OMMAVA                      TGMAVA
     I              OMKDVA                      TGKDVA
     I              OML8VA                      TGL8VA
     I              OML9VA                      TGL9VA
     I              OMGTST                      TGGTST
     I              OMGVST                      TGGVST
     I              OMGUST                      TGGUST
     I              OMQFST                      TGQFST
     I              OMAYVA                      TGAYVA
     I              OMEXDT                      TGEXDT
     I              OMLQCD                      TGLQCD
     I              OMRDCD                      TGRDCD
     I              OMQ7CD                      TGQ7CD
     I              OMBZPR                      TGBZPR
     I              OML6NB                      TGL6NB
     I              OMU1ST                      TGU1ST
     I              OMGIDT                      TGGIDT
     I              OMCRCD                      TGCRCD
     I              OMAGCD                      TGAGCD
     I              OMRZST                      TGRZST
     I              OMR0ST                      TGR0ST
     I              OMR1ST                      TGR1ST
     I              OMG7NA                      TGG7NA
     I              OMG8NA                      TGG8NA
     I              OMRPCD                      TGRPCD
     I              OMVEST                      TGVEST
     I              OMVGST                      TGVGST
     I              OMAVST                      TGAVST
     I              OMU0ST                      TGU0ST
     I              OMRFCD                      TGRFCD
     I              OMFZST                      TGFZST
     I              OMR1NB                      TGR1NB
     I              OMAVQT                      TGAVQT
     I              OMD0WG                      TGD0WG
     I              OMCCQT                      TGCCQT
     I              OMAUWG                      TGAUWG
     I              OMCBQT                      TGCBQT
     I              OMATWG                      TGATWG
     I              OMAQCS                      TGAQCS
     I              OMAGCS                      TGAGCS
     I              OMAKPR                      TGAKPR
     I              OMALPR                      TGALPR
     I              OMAUPR                      TGAUPR
     I              OMAVWG                      TGAVWG
     I              OMA4WG                      TGA4WG
     I              OMA5DT                      TGA5DT
     I              OMAODT                      TGAODT
     I              OMGNDT                      TGGNDT
     I              OMAMST                      TGAMST
     I              OMANST                      TGANST
     I              OMVAST                      TGVAST
     I              OMRGNB                      TGRGNB
     I              OMRHNB                      TGRHNB
     I              OMRINB                      TGRINB
     I              OMRBCD                      TGRBCD
     I              OMHICD                      TGHICD
     I              OMRNCD                      TGRNCD
     I              OMROCD                      TGROCD
     I              OMCXDT                      TGCXDT
     I              OMAJVN                      TGAJVN
     I              OMKXCD                      TGKXCD
     I              OMJPCD                      TGJPCD
     I              OMCQCD                      TGCQCD
     I              OMR4CD                      TGR4CD
     I              OMZ1ST                      TGZ1ST
     I              OMZ3ST                      TGZ3ST
     I              OMZ4ST                      TGZ4ST
     I              OMDUPR                      TGDUPR
     I              OMB6VL                      TGB6VL
     I              OMA1AA                      TGA1AA
     I              OMFZSX                      TGFZSX
     I              OMF0SX                      TGF0SX
     I              OMF1SX                      TGF1SX
     I              OMF2SX                      TGF2SX
     I              OMF3SX                      TGF3SX
     I              OMF4SX                      TGF4SX
     I              OMF5SX                      TGF5SX
     I              OMF6SX                      TGF6SX
     I              OMF7SX                      TGF7SX
     I              OMNTDT                      TGNTDT
     I              OMNUDT                      TGNUDT
     I              OMNVDT                      TGNVDT
     I              OMNWDT                      TGNWDT
     I              OMNXDT                      TGNXDT
     I              OMBUTM                      TGBUTM
     I              OMBVTM                      TGBVTM
     I              OMBWTM                      TGBWTM
     I              OMBXTM                      TGBXTM
     I              OMBYTM                      TGBYTM
     I              OMH5NX                      TGH5NX
     I              OMH6NX                      TGH6NX
     I              OMH7NX                      TGH7NX
     I              OMH8NX                      TGH8NX
     I              OMH9NX                      TGH9NX
     I              OMDVPR                      TGDVPR
     I              OMDWPR                      TGDWPR
     I              OMDXPR                      TGDXPR
     I              OMDYPR                      TGDYPR
     I              OMDZPR                      TGDZPR
     I              OMGSPR                      TGGSPR
     I              OMGTPR                      TGGTPR
     I              OMGUPR                      TGGUPR
     I              OMHOST                      TGHOST
     I              OMHPST                      TGHPST
     I              OMIOST                      TGIOST
     I              OMPEWG                      TGPEWG
     I              OMRINY                      TGRINY
     I              OMTIDT                      TGTIDT
     I              OMTJDT                      TGTJDT
     I              OMH2ST                      TGH2ST
     I              OMH0ST                      TGH0ST
     I              OMH1ST                      TGH1ST
     I              OMTKDT                      TGTKDT
     I              OMTLDT                      TGTLDT
     I              OMTMDT                      TGTMDT
     I              OMUVST                      TGUVST
     I              OMUWST                      TGUWST
     I              OMUXST                      TGUXST
     I              OMAATM                      TGAATM
     I              OMAYNA                      TGAYNA
     I              OMA0NA                      TGA0NA
     I              OMAXDT                      TGAXDT
      *
     I@MSREX2
      * Export Doc Order Dtl      Co/Order/Seq
      * Renamed input format fields
     I              MSAIC3                      THAIC3
     I              MSC4NB                      THC4NB
     I              MSDGSX                      THDGSX
     I              MSKXCD                      THKXCD
     I              MSDPNB                      THDPNB
     I              MSUENB                      THUENB
     I              MSDIC7                      THDIC7
     I              MSO3NA                      THO3NA
     I              MSO4NA                      THO4NA
     I              MSRMTX                      THRMTX
     I              MSPTTX                      THPTTX
     I              MSHJWG                      THHJWG
     I              MSHKWG                      THHKWG
     I              MSRNTX                      THRNTX
     I              MSAONX                      THAONX
     I              MSROTX                      THROTX
     I              MSORNA                      THORNA
     I              MSAMNX                      THAMNX
     I              MSANNX                      THANNX
     I              MSAPNX                      THAPNX
     I              MSDKPR                      THDKPR
     I              MSA9VL                      THA9VL
     I              MSC8SX                      THC8SX
     I              MSRATX                      THRATX
     I              MSRBTX                      THRBTX
     I              MSAJNX                      THAJNX
     I              MSZWTX                      THZWTX
     I              MSZXTX                      THZXTX
     I              MSZYTX                      THZYTX
     I              MSZZTX                      THZZTX
     I              MSK0U1                      THK0U1
     I              MSK1U1                      THK1U1
     I              MSIJSC                      THIJSC
     I              MSIKSC                      THIKSC
     I              MSK2U1                      THK2U1
     I              MSW0DT                      THW0DT
     I              MSUVST                      THUVST
     I              MSUWST                      THUWST
     I              MSUXST                      THUXST
     I              MSVSST                      THVSST
     I              MSAATM                      THAATM
     I              MSAYNA                      THAYNA
     I              MSA0NA                      THA0NA
     I              MSAXDT                      THAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                      TIAIC3
     I              MSC4NB                      TIC4NB
     I              MSDGSX                      TIDGSX
     I              MSKXCD                      TIKXCD
     I              MSDPNB                      TIDPNB
     I              MSUENB                      TIUENB
     I              MSDIC7                      TIDIC7
     I              MSO3NA                      TIO3NA
     I              MSO4NA                      TIO4NA
     I              MSRMTX                      TIRMTX
     I              MSPTTX                      TIPTTX
     I              MSHJWG                      TIHJWG
     I              MSHKWG                      TIHKWG
     I              MSRNTX                      TIRNTX
     I              MSAONX                      TIAONX
     I              MSROTX                      TIROTX
     I              MSORNA                      TIORNA
     I              MSAMNX                      TIAMNX
     I              MSANNX                      TIANNX
     I              MSAPNX                      TIAPNX
     I              MSDKPR                      TIDKPR
     I              MSA9VL                      TIA9VL
     I              MSC8SX                      TIC8SX
     I              MSRATX                      TIRATX
     I              MSRBTX                      TIRBTX
     I              MSAJNX                      TIAJNX
     I              MSZWTX                      TIZWTX
     I              MSZXTX                      TIZXTX
     I              MSZYTX                      TIZYTX
     I              MSZZTX                      TIZZTX
     I              MSK0U1                      TIK0U1
     I              MSK1U1                      TIK1U1
     I              MSIJSC                      TIIJSC
     I              MSIKSC                      TIIKSC
     I              MSK2U1                      TIK2U1
     I              MSW0DT                      TIW0DT
     I              MSUVST                      TIUVST
     I              MSUWST                      TIUWST
     I              MSUXST                      TIUXST
     I              MSVSST                      TIVSST
     I              MSAATM                      TIAATM
     I              MSAYNA                      TIAYNA
     I              MSA0NA                      TIA0NA
     I              MSAXDT                      TIAXDT
      *
     I@BGWKIG
      * Order Detail              Co/Ord/Dtl Line Sts Last
      * Renamed input format fields
     I              OMAIC3                      TJAIC3
     I              OMC4NB                      TJC4NB
     I              OMDPNB                      TJDPNB
     I              OMUENB                      TJUENB
     I              OMHGCD                      TJHGCD
     I              OMAJCD                      TJAJCD
     I              OMBKC7                      TJBKC7
     I              OMCFC7                      TJCFC7
     I              OMGMST                      TJGMST
     I              OMGNST                      TJGNST
     I              OMMAVA                      TJMAVA
     I              OMKDVA                      TJKDVA
     I              OML8VA                      TJL8VA
     I              OML9VA                      TJL9VA
     I              OMGTST                      TJGTST
     I              OMGVST                      TJGVST
     I              OMGUST                      TJGUST
     I              OMQFST                      TJQFST
     I              OMAYVA                      TJAYVA
     I              OMEXDT                      TJEXDT
     I              OMLQCD                      TJLQCD
     I              OMRDCD                      TJRDCD
     I              OMQ7CD                      TJQ7CD
     I              OMBZPR                      TJBZPR
     I              OML6NB                      TJL6NB
     I              OMU1ST                      TJU1ST
     I              OMGIDT                      TJGIDT
     I              OMCRCD                      TJCRCD
     I              OMAGCD                      TJAGCD
     I              OMRZST                      TJRZST
     I              OMR0ST                      TJR0ST
     I              OMR1ST                      TJR1ST
     I              OMG7NA                      TJG7NA
     I              OMG8NA                      TJG8NA
     I              OMRPCD                      TJRPCD
     I              OMVEST                      TJVEST
     I              OMVGST                      TJVGST
     I              OMAVST                      TJAVST
     I              OMU0ST                      TJU0ST
     I              OMRFCD                      TJRFCD
     I              OMFZST                      TJFZST
     I              OMR1NB                      TJR1NB
     I              OMAVQT                      TJAVQT
     I              OMD0WG                      TJD0WG
     I              OMCCQT                      TJCCQT
     I              OMAUWG                      TJAUWG
     I              OMCBQT                      TJCBQT
     I              OMATWG                      TJATWG
     I              OMAQCS                      TJAQCS
     I              OMAGCS                      TJAGCS
     I              OMAKPR                      TJAKPR
     I              OMALPR                      TJALPR
     I              OMAUPR                      TJAUPR
     I              OMAVWG                      TJAVWG
     I              OMA4WG                      TJA4WG
     I              OMA5DT                      TJA5DT
     I              OMAODT                      TJAODT
     I              OMGNDT                      TJGNDT
     I              OMAMST                      TJAMST
     I              OMANST                      TJANST
     I              OMVAST                      TJVAST
     I              OMRGNB                      TJRGNB
     I              OMRHNB                      TJRHNB
     I              OMRINB                      TJRINB
     I              OMRBCD                      TJRBCD
     I              OMHICD                      TJHICD
     I              OMRNCD                      TJRNCD
     I              OMROCD                      TJROCD
     I              OMCXDT                      TJCXDT
     I              OMAJVN                      TJAJVN
     I              OMKXCD                      TJKXCD
     I              OMJPCD                      TJJPCD
     I              OMCQCD                      TJCQCD
     I              OMR4CD                      TJR4CD
     I              OMZ1ST                      TJZ1ST
     I              OMZ3ST                      TJZ3ST
     I              OMZ4ST                      TJZ4ST
     I              OMDUPR                      TJDUPR
     I              OMB6VL                      TJB6VL
     I              OMA1AA                      TJA1AA
     I              OMFZSX                      TJFZSX
     I              OMF0SX                      TJF0SX
     I              OMF1SX                      TJF1SX
     I              OMF2SX                      TJF2SX
     I              OMF3SX                      TJF3SX
     I              OMF4SX                      TJF4SX
     I              OMF5SX                      TJF5SX
     I              OMF6SX                      TJF6SX
     I              OMF7SX                      TJF7SX
     I              OMNTDT                      TJNTDT
     I              OMNUDT                      TJNUDT
     I              OMNVDT                      TJNVDT
     I              OMNWDT                      TJNWDT
     I              OMNXDT                      TJNXDT
     I              OMBUTM                      TJBUTM
     I              OMBVTM                      TJBVTM
     I              OMBWTM                      TJBWTM
     I              OMBXTM                      TJBXTM
     I              OMBYTM                      TJBYTM
     I              OMH5NX                      TJH5NX
     I              OMH6NX                      TJH6NX
     I              OMH7NX                      TJH7NX
     I              OMH8NX                      TJH8NX
     I              OMH9NX                      TJH9NX
     I              OMDVPR                      TJDVPR
     I              OMDWPR                      TJDWPR
     I              OMDXPR                      TJDXPR
     I              OMDYPR                      TJDYPR
     I              OMDZPR                      TJDZPR
     I              OMGSPR                      TJGSPR
     I              OMGTPR                      TJGTPR
     I              OMGUPR                      TJGUPR
     I              OMHOST                      TJHOST
     I              OMHPST                      TJHPST
     I              OMIOST                      TJIOST
     I              OMPEWG                      TJPEWG
     I              OMRINY                      TJRINY
     I              OMTIDT                      TJTIDT
     I              OMTJDT                      TJTJDT
     I              OMH2ST                      TJH2ST
     I              OMH0ST                      TJH0ST
     I              OMH1ST                      TJH1ST
     I              OMTKDT                      TJTKDT
     I              OMTLDT                      TJTLDT
     I              OMTMDT                      TJTMDT
     I              OMUVST                      TJUVST
     I              OMUWST                      TJUWST
     I              OMUXST                      TJUXST
     I              OMAATM                      TJAATM
     I              OMAYNA                      TJAYNA
     I              OMA0NA                      TJA0NA
     I              OMAXDT                      TJAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                      TKAIC3
     I              BEC4NB                      TKC4NB
     I              BEJNCD                      TKJNCD
     I              BEANC7                      TKANC7
     I              BEBKC7                      TKBKC7
     I              BEBRTX                      TKBRTX
     I              BEHMNA                      TKHMNA
     I              BEHONA                      TKHONA
     I              BEHPNA                      TKHPNA
     I              BEHNNA                      TKHNNA
     I              BEDBCD                      TKDBCD
     I              BECKTX                      TKCKTX
     I              BEB0C7                      TKB0C7
     I              BEAETX                      TKAETX
     I              BEB1NA                      TKB1NA
     I              BEB3NA                      TKB3NA
     I              BEB4NA                      TKB4NA
     I              BEB2NA                      TKB2NA
     I              BEBHCD                      TKBHCD
     I              BEC8TX                      TKC8TX
     I              BEBCNA                      TKBCNA
     I              BEA0DT                      TKA0DT
     I              BEA5DT                      TKA5DT
     I              BEGNDT                      TKGNDT
     I              BEACDT                      TKACDT
     I              BEAQCD                      TKAQCD
     I              BEB6NA                      TKB6NA
     I              BEBYNA                      TKBYNA
     I              BEBZNA                      TKBZNA
     I              BEGTST                      TKGTST
     I              BEGVST                      TKGVST
     I              BEGUST                      TKGUST
     I              BEQFST                      TKQFST
     I              BECQCD                      TKCQCD
     I              BEGJST                      TKGJST
     I              BEGWST                      TKGWST
     I              BEGXST                      TKGXST
     I              BEGYST                      TKGYST
     I              BEAODT                      TKAODT
     I              BEAIVN                      TKAIVN
     I              BECXDT                      TKCXDT
     I              BEJZVA                      TKJZVA
     I              BEA1WG                      TKA1WG
     I              BEXIST                      TKXIST
     I              BEXJST                      TKXJST
     I              BEXKST                      TKXKST
     I              BEEIDT                      TKEIDT
     I              BEAFTM                      TKAFTM
     I              BEE8CD                      TKE8CD
     I              BEE9CD                      TKE9CD
     I              BERMNB                      TKRMNB
     I              BETBNB                      TKTBNB
     I              BER1NB                      TKR1NB
     I              BEPJST                      TKPJST
     I              BEU0ST                      TKU0ST
     I              BEU1ST                      TKU1ST
     I              BEQ2CD                      TKQ2CD
     I              BEU2ST                      TKU2ST
     I              BEVEST                      TKVEST
     I              BEVFST                      TKVFST
     I              BEVGST                      TKVGST
     I              BERPCD                      TKRPCD
     I              BERNNB                      TKRNNB
     I              BEVDST                      TKVDST
     I              BEATIN                      TKATIN
     I              BEU4ST                      TKU4ST
     I              BEU5ST                      TKU5ST
     I              BERSRN                      TKRSRN
     I              BEMHNA                      TKMHNA
     I              BEMINA                      TKMINA
     I              BEWBST                      TKWBST
     I              BER4CD                      TKR4CD
     I              BEBFCD                      TKBFCD
     I              BEQ4CD                      TKQ4CD
     I              BET3NB                      TKT3NB
     I              BESICD                      TKSICD
     I              BECONB                      TKCONB
     I              BECEST                      TKCEST
     I              BEAWDT                      TKAWDT
     I              BEJPCD                      TKJPCD
     I              BEXUST                      TKXUST
     I              BEZ1ST                      TKZ1ST
     I              BEVRVA                      TKVRVA
     I              BEOBST                      TKOBST
     I              BEBCST                      TKBCST
     I              BEBDST                      TKBDST
     I              BEB7VL                      TKB7VL
     I              BEGASX                      TKGASX
     I              BEGBSX                      TKGBSX
     I              BEGCSX                      TKGCSX
     I              BEGDSX                      TKGDSX
     I              BEFNSX                      TKFNSX
     I              BEFOSX                      TKFOSX
     I              BEFPSX                      TKFPSX
     I              BEFQSX                      TKFQSX
     I              BEFRSX                      TKFRSX
     I              BEFSSX                      TKFSSX
     I              BEFTSX                      TKFTSX
     I              BEFUSX                      TKFUSX
     I              BEFVSX                      TKFVSX
     I              BEFWSX                      TKFWSX
     I              BEFXSX                      TKFXSX
     I              BEFYSX                      TKFYSX
     I              BENODT                      TKNODT
     I              BENPDT                      TKNPDT
     I              BENQDT                      TKNQDT
     I              BENRDT                      TKNRDT
     I              BENSDT                      TKNSDT
     I              BEBPTM                      TKBPTM
     I              BEBQTM                      TKBQTM
     I              BEBRTM                      TKBRTM
     I              BEBSTM                      TKBSTM
     I              BEBTTM                      TKBTTM
     I              BEH0NX                      TKH0NX
     I              BEH1NX                      TKH1NX
     I              BEH2NX                      TKH2NX
     I              BEH3NX                      TKH3NX
     I              BEH4NX                      TKH4NX
     I              BEC0C7                      TKC0C7
     I              BEUVST                      TKUVST
     I              BEUWST                      TKUWST
     I              BEUXST                      TKUXST
     I              BEAATM                      TKAATM
     I              BEAYNA                      TKAYNA
     I              BEA0NA                      TKA0NA
     I              BEAXDT                      TKAXDT
      *
     I@BFCPMD
      * Order Header TRG          Update Index WORK
      * Renamed input format fields
     I              BEAIC3                      TLAIC3
     I              BEC4NB                      TLC4NB
     I              BEJNCD                      TLJNCD
     I              BEANC7                      TLANC7
     I              BEBKC7                      TLBKC7
     I              BEBRTX                      TLBRTX
     I              BEHMNA                      TLHMNA
     I              BEHONA                      TLHONA
     I              BEHPNA                      TLHPNA
     I              BEHNNA                      TLHNNA
     I              BEDBCD                      TLDBCD
     I              BECKTX                      TLCKTX
     I              BEB0C7                      TLB0C7
     I              BEAETX                      TLAETX
     I              BEB1NA                      TLB1NA
     I              BEB3NA                      TLB3NA
     I              BEB4NA                      TLB4NA
     I              BEB2NA                      TLB2NA
     I              BEBHCD                      TLBHCD
     I              BEC8TX                      TLC8TX
     I              BEBCNA                      TLBCNA
     I              BEA0DT                      TLA0DT
     I              BEA5DT                      TLA5DT
     I              BEGNDT                      TLGNDT
     I              BEACDT                      TLACDT
     I              BEAQCD                      TLAQCD
     I              BEB6NA                      TLB6NA
     I              BEBYNA                      TLBYNA
     I              BEBZNA                      TLBZNA
     I              BEGTST                      TLGTST
     I              BEGVST                      TLGVST
     I              BEGUST                      TLGUST
     I              BEQFST                      TLQFST
     I              BECQCD                      TLCQCD
     I              BEGJST                      TLGJST
     I              BEGWST                      TLGWST
     I              BEGXST                      TLGXST
     I              BEGYST                      TLGYST
     I              BEAODT                      TLAODT
     I              BEAIVN                      TLAIVN
     I              BECXDT                      TLCXDT
     I              BEJZVA                      TLJZVA
     I              BEA1WG                      TLA1WG
     I              BEXIST                      TLXIST
     I              BEXJST                      TLXJST
     I              BEXKST                      TLXKST
     I              BEEIDT                      TLEIDT
     I              BEAFTM                      TLAFTM
     I              BEE8CD                      TLE8CD
     I              BEE9CD                      TLE9CD
     I              BERMNB                      TLRMNB
     I              BETBNB                      TLTBNB
     I              BER1NB                      TLR1NB
     I              BEPJST                      TLPJST
     I              BEU0ST                      TLU0ST
     I              BEU1ST                      TLU1ST
     I              BEQ2CD                      TLQ2CD
     I              BEU2ST                      TLU2ST
     I              BEVEST                      TLVEST
     I              BEVFST                      TLVFST
     I              BEVGST                      TLVGST
     I              BERPCD                      TLRPCD
     I              BERNNB                      TLRNNB
     I              BEVDST                      TLVDST
     I              BEATIN                      TLATIN
     I              BEU4ST                      TLU4ST
     I              BEU5ST                      TLU5ST
     I              BERSRN                      TLRSRN
     I              BEMHNA                      TLMHNA
     I              BEMINA                      TLMINA
     I              BEWBST                      TLWBST
     I              BER4CD                      TLR4CD
     I              BEBFCD                      TLBFCD
     I              BEQ4CD                      TLQ4CD
     I              BET3NB                      TLT3NB
     I              BESICD                      TLSICD
     I              BECONB                      TLCONB
     I              BECEST                      TLCEST
     I              BEAWDT                      TLAWDT
     I              BEJPCD                      TLJPCD
     I              BEXUST                      TLXUST
     I              BEZ1ST                      TLZ1ST
     I              BEVRVA                      TLVRVA
     I              BEOBST                      TLOBST
     I              BEBCST                      TLBCST
     I              BEBDST                      TLBDST
     I              BEB7VL                      TLB7VL
     I              BEGASX                      TLGASX
     I              BEGBSX                      TLGBSX
     I              BEGCSX                      TLGCSX
     I              BEGDSX                      TLGDSX
     I              BEFNSX                      TLFNSX
     I              BEFOSX                      TLFOSX
     I              BEFPSX                      TLFPSX
     I              BEFQSX                      TLFQSX
     I              BEFRSX                      TLFRSX
     I              BEFSSX                      TLFSSX
     I              BEFTSX                      TLFTSX
     I              BEFUSX                      TLFUSX
     I              BEFVSX                      TLFVSX
     I              BEFWSX                      TLFWSX
     I              BEFXSX                      TLFXSX
     I              BEFYSX                      TLFYSX
     I              BENODT                      TLNODT
     I              BENPDT                      TLNPDT
     I              BENQDT                      TLNQDT
     I              BENRDT                      TLNRDT
     I              BENSDT                      TLNSDT
     I              BEBPTM                      TLBPTM
     I              BEBQTM                      TLBQTM
     I              BEBRTM                      TLBRTM
     I              BEBSTM                      TLBSTM
     I              BEBTTM                      TLBTTM
     I              BEH0NX                      TLH0NX
     I              BEH1NX                      TLH1NX
     I              BEH2NX                      TLH2NX
     I              BEH3NX                      TLH3NX
     I              BEH4NX                      TLH4NX
     I              BEC0C7                      TLC0C7
     I              BEUVST                      TLUVST
     I              BEUWST                      TLUWST
     I              BEUXST                      TLUXST
     I              BEAATM                      TLAATM
     I              BEAYNA                      TLAYNA
     I              BEA0NA                      TLA0NA
     I              BEAXDT                      TLAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                      TMRMNB
     I              FJAIC3                      TMAIC3
     I              FJAODT                      TMAODT
     I              FJPJST                      TMPJST
     I              FJPKST                      TMPKST
     I              FJRNNB                      TMRNNB
     I              FJDMTX                      TMDMTX
     I              FJDNTX                      TMDNTX
     I              FJDOTX                      TMDOTX
     I              FJWTTX                      TMWTTX
     I              FJWUTX                      TMWUTX
     I              FJRPNB                      TMRPNB
     I              FJFLAM                      TMFLAM
     I              FJXQST                      TMXQST
     I              FJRRNB                      TMRRNB
     I              FJDXTX                      TMDXTX
     I              FJDYTX                      TMDYTX
     I              FJSBNB                      TMSBNB
     I              FJBZNA                      TMBZNA
     I              FJRONB                      TMRONB
     I              FJSQNB                      TMSQNB
     I              FJR1NB                      TMR1NB
     I              FJVCST                      TMVCST
     I              FJVDST                      TMVDST
     I              FJSDNB                      TMSDNB
     I              FJPAOU                      TMPAOU
     I              FJDGWG                      TMDGWG
     I              FJSXNB                      TMSXNB
     I              FJHADT                      TMHADT
     I              FJAART                      TMAART
     I              FJDHWG                      TMDHWG
     I              FJDIWG                      TMDIWG
     I              FJAQDT                      TMAQDT
     I              FJS6NB                      TMS6NB
     I              FJT4NB                      TMT4NB
     I              FJPRTM                      TMPRTM
     I              FJNPSV                      TMNPSV
     I              FJJ8TX                      TMJ8TX
     I              FJTLMI                      TMTLMI
     I              FJJ9TX                      TMJ9TX
     I              FJQ2CD                      TMQ2CD
     I              FJVPCD                      TMVPCD
     I              FJDBCD                      TMDBCD
     I              FJGRWE                      TMGRWE
     I              FJXCCD                      TMXCCD
     I              FJU2ST                      TMU2ST
     I              FJF9DT                      TMF9DT
     I              FJONTM                      TMONTM
     I              FJJ4DT                      TMJ4DT
     I              FJTRTM                      TMTRTM
     I              FJJ5DT                      TMJ5DT
     I              FJSPTM                      TMSPTM
     I              FJJ6DT                      TMJ6DT
     I              FJLFTM                      TMLFTM
     I              FJJ7DT                      TMJ7DT
     I              FJBOTM                      TMBOTM
     I              FJJ8DT                      TMJ8DT
     I              FJBLTM                      TMBLTM
     I              FJKIDT                      TMKIDT
     I              FJASTM                      TMASTM
     I              FJKADT                      TMKADT
     I              FJAJCM                      TMAJCM
     I              FJXACD                      TMXACD
     I              FJOANA                      TMOANA
     I              FJK4TX                      TMK4TX
     I              FJVOAG                      TMVOAG
     I              FJKBDT                      TMKBDT
     I              FJNBBO                      TMNBBO
     I              FJW4CD                      TMW4CD
     I              FJEFDT                      TMEFDT
     I              FJCNTN                      TMCNTN
     I              FJKCDT                      TMKCDT
     I              FJTMIN                      TMTMIN
     I              FJKDDT                      TMKDDT
     I              FJVMNB                      TMVMNB
     I              FJOCFR                      TMOCFR
     I              FJKJDT                      TMKJDT
     I              FJATTM                      TMATTM
     I              FJOTRS                      TMOTRS
     I              FJRNST                      TMRNST
     I              FJBRBK                      TMBRBK
     I              FJEIDT                      TMEIDT
     I              FJRMST                      TMRMST
     I              FJAJCD                      TMAJCD
     I              FJKKDT                      TMKKDT
     I              FJAVTM                      TMAVTM
     I              FJKZDT                      TMKZDT
     I              FJAXTM                      TMAXTM
     I              FJLHOS                      TMLHOS
     I              FJLHOR                      TMLHOR
     I              FJWNTX                      TMWNTX
     I              FJOITX                      TMOITX
     I              FJOJTX                      TMOJTX
     I              FJLLDT                      TMLLDT
     I              FJLSHG                      TMLSHG
     I              FJYPST                      TMYPST
     I              FJK0DT                      TMK0DT
     I              FJAYTM                      TMAYTM
     I              FJKNNX                      TMKNNX
     I              FJICWG                      TMICWG
     I              FJIDWG                      TMIDWG
     I              FJH9SX                      TMH9SX
     I              FJWOTX                      TMWOTX
     I              FJK1DT                      TMK1DT
     I              FJAZTM                      TMAZTM
     I              FJK2DT                      TMK2DT
     I              FJA0TM                      TMA0TM
     I              FJROST                      TMROST
     I              FJRPST                      TMRPST
     I              FJRQST                      TMRQST
     I              FJRRST                      TMRRST
     I              FJZBVA                      TMZBVA
     I              FJWPTX                      TMWPTX
     I              FJWQTX                      TMWQTX
     I              FJWRTX                      TMWRTX
     I              FJWSTX                      TMWSTX
     I              FJRVSX                      TMRVSX
     I              FJRUSX                      TMRUSX
     I              FJRWSX                      TMRWSX
     I              FJRXSX                      TMRXSX
     I              FJRYSX                      TMRYSX
     I              FJRZSX                      TMRZSX
     I              FJR0SX                      TMR0SX
     I              FJR1SX                      TMR1SX
     I              FJR2SX                      TMR2SX
     I              FJR3SX                      TMR3SX
     I              FJR4SX                      TMR4SX
     I              FJPYDT                      TMPYDT
     I              FJCKTM                      TMCKTM
     I              FJPZDT                      TMPZDT
     I              FJCLTM                      TMCLTM
     I              FJP0DT                      TMP0DT
     I              FJCMTM                      TMCMTM
     I              FJP1DT                      TMP1DT
     I              FJCNTM                      TMCNTM
     I              FJP2DT                      TMP2DT
     I              FJCOTM                      TMCOTM
     I              FJP3DT                      TMP3DT
     I              FJCQTM                      TMCQTM
     I              FJUVST                      TMUVST
     I              FJUWST                      TMUWST
     I              FJUXST                      TMUXST
     I              FJAATM                      TMAATM
     I              FJAYNA                      TMAYNA
     I              FJA0NA                      TMA0NA
     I              FJAXDT                      TMAXDT
      *
     I@C2CPM5
      * WF Block Order Upload Hdr Rcd Proc SEL Eml Not Sen
      * Renamed input format fields
     I              C2HQNZ                      TOHQNZ
     I              C2AIC3                      TOAIC3
     I              C2C4NB                      TOC4NB
     I              C2GWST                      TOGWST
     I              C2BKC7                      TOBKC7
     I              C2AJCD                      TOAJCD
     I              C2A5DT                      TOA5DT
     I              C2ACDT                      TOACDT
     I              C2C3TX                      TOC3TX
     I              C2BCNA                      TOBCNA
     I              C2U2ST                      TOU2ST
     I              C2KXCD                      TOKXCD
     I              C2LWAA                      TOLWAA
     I              C2FQSX                      TOFQSX
     I              C2VEST                      TOVEST
     I              C2VGST                      TOVGST
     I              C2Q2CD                      TOQ2CD
     I              C2RNNB                      TORNNB
     I              C2N6SC                      TON6SC
     I              C2OOSC                      TOOOSC
     I              C2EIDT                      TOEIDT
     I              C2VFST                      TOVFST
     I              C2VSST                      TOVSST
     I              C2MJDT                      TOMJDT
     I              C2BETM                      TOBETM
     I              C2CCVN                      TOCCVN
     I              C2CDVN                      TOCDVN
     I              C2MKDT                      TOMKDT
     I              C2BFTM                      TOBFTM
     I              C2CEVN                      TOCEVN
     I              C2CFVN                      TOCFVN
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                      TRDOCD
     I              DPAUNA                      TRAUNA
     I              DPI5ST                      TRI5ST
     I              DPBXTX                      TRBXTX
     I              DPM8NB                      TRM8NB
     I              DPUVST                      TRUVST
     I              DPUWST                      TRUWST
     I              DPUXST                      TRUXST
     I              DPVSST                      TRVSST
     I              DPAATM                      TRAATM
     I              DPAYNA                      TRAYNA
     I              DPA0NA                      TRA0NA
     I              DPAXDT                      TRAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Crt Block Ord Automatn XF
      * Program Comments.
     C                   EXSR      UASUBR                                       Program Comment
      * Must Read - Trigger Information
     C                   EXSR      UBSUBR                                       Must Read - Tri
      * RTV Sequence by Ordr Num - WF Block Order Upload Hdr  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   NARVGN        BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * Get Blck Ord Email
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSNA         KLIST
     C                   KFLD                    TRDOCD                         System Value Co
      * Setup key
     C                   MOVEL     WL0603        TRDOCD                         System Value Co
      * Establish starting position
     C     KRSNA         CHAIN     @DPRETD                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0759'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0604 = ' '                                 System Value Al
     C                   GOTO      NAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     TRBXTX        WL0604                         System Value Al
     C                   ENDIF
      *================================================================
     CSR   NAEXIT        ENDSR
      /EJECT
     CSR   NBRVGN        BEGSR
      *================================================================
      * RTV Send Email for Err RT - WF Block Order Errors  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0486                         Email Sent
     C                   MOVEL     'Y'           YL0487                         First Time Thro
     C                   MOVEL     'N'           YL0485                         Send Email USR
      * RTV Count Errors       RT - WF Block Order Errors  * 
     C                   EXSR      NCRVGN
      * Declare restrictor key work fields
      * Define keylist
     C     KRSNB         KLIST
     C                   KFLD                    WQNB01                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     TOHQNZ        WQNB01                         Surrogate Numbe
      * Establish starting position
     C     KRSNB         SETLL     @C5CPMF                                      *
     C     KRSNB         READE     @C5CPMF                                90    *
      * Data record not found
     C   90              MOVEL     'USR5305'     W0RTN
      * USER: Process Data record
      * Processing for Only 1 Record Exist.
      * CASE: LCL.Count Records        USR is EQ 1
     C                   DOW       NOT *IN90
      * Format Email Data.
      * CASE: LCL.First Time Through USR is Yes
     C                   IF        YL0488 = 1
     C                   IF        YL0487 = 'Y'
     C                   MOVEL     'N'           YL0487                         First Time Thro
     C                   MOVEL     'Y'           YL0485                         Send Email USR
      * Format Email Subject Line.
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(239)      CAT(P)    'rors':ZQ     YL0490                         Email Subject 2
     C                   MOVEL     TBHQNZ        YL0491                         Text USR 9
     C                   Z-ADD     1             ZQ
     C     YL0490        CAT(P)    @CN(240):ZQ   YL0490                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0490        CAT(P)    YL0491:ZQ     YL0490                         Email Subject 2
      * If Not PROD Then Append 'TEST' to Email Subject Line.
      * CASE: PAR.Library List Code is Not PRKFLIB
     C                   IF        YL0483 <> @CN(236)
     C                   Z-ADD     1             ZQ
     C     YL0490        CAT(P)    @CN(241):ZQ   YL0490                         Email Subject 2
     C                   END                                                    *FI
      * Format Email Message 'Surrogate Number' Line.
      * CASE: *OTHERWISE
      * ** Force New Line
     C                   EVAL      YL0492 = ' '                                 Email Message 2
     C                   MOVEL     TBVUNA        YL0492                         Email Message 2
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Processing for Multiple Records Exist.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Count Records        USR is GT 1
      *   |- c2    : LCL.First Time Through USR is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0488 > 1
     C                   IF        YL0487 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Format Email Data.
      * CASE: LCL.First Time Through USR is Yes
     C                   IF        Y0CX01 = '1'
     C                   IF        YL0487 = 'Y'
     C                   MOVEL     'N'           YL0487                         First Time Thro
     C                   MOVEL     'Y'           YL0485                         Send Email USR
      * Format Email Subject Line.
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(239)      CAT(P)    'rors':ZQ     YL0490                         Email Subject 2
     C                   MOVEL     TBHQNZ        YL0491                         Text USR 9
     C                   Z-ADD     1             ZQ
     C     YL0490        CAT(P)    @CN(240):ZQ   YL0490                         Email Subject 2
     C                   Z-ADD     1             ZQ
     C     YL0490        CAT(P)    YL0491:ZQ     YL0490                         Email Subject 2
      * If Not PROD Then Append 'TEST' to Email Subject Line.
      * CASE: PAR.Library List Code is Not PRKFLIB
     C                   IF        YL0483 <> @CN(236)
     C                   Z-ADD     1             ZQ
     C     YL0490        CAT(P)    @CN(241):ZQ   YL0490                         Email Subject 2
     C                   END                                                    *FI
      * Format Email Message 'Surrogate Number' Line.
      * CASE: *OTHERWISE
      * ** Force New Line
     C                   Z-ADD     1             ZQ
     C     YL0492        CAT(P)    '&N':ZQ       YL0492                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0492        CAT(P)    TBVUNA:ZQ     YL0492                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0492        CAT(P)    '.':ZQ        YL0492                         Email Message 2
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Format Email Message Additional 'Attention' Lines if Exist.
      * CASE: LCL.Count Records        USR is NE 1
      * Force New Line.
     C                   IF        YL0488 <> 1
     C                   Z-ADD     1             ZQ
     C     YL0492        CAT(P)    '&N':ZQ       YL0492                         Email Message 2
     C                   Z-ADD     1             ZQ
     C     YL0492        CAT(P)    TBVUNA:ZQ     YL0492                         Email Message 2
     C                   Z-ADD     *ZERO         ZQ
     C     YL0492        CAT(P)    '.':ZQ        YL0492                         Email Message 2
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSNB         READE     @C5CPMF                                90    *
     C                   ENDDO
      * USER: Exit processing
      * OK to Send Email?
      * CASE: PAR.Send Email USR is Yes
     C                   IF        YL0485 = 'Y'
     C                   MOVEL     'Y'           YL0486                         Email Sent
      * Exc ESNDMAIL Generic2 CL - /UT User Programs  * 
     C                   CALL      'PUX2UPC'                            90      Exc ESNDMAIL Ge
     C                   PARM      YL0484        WQ1235                         Email Address
     C                   PARM      YL0490        WQ1236                         Email Subject 2
     C                   PARM      YL0492        WQ1237                         Email Message 2
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUX2UPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      *================================================================
     CSR   NBEXIT        ENDSR
      /EJECT
     CSR   NCRVGN        BEGSR
      *================================================================
      * RTV Count Errors       RT - WF Block Order Errors  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   Z-ADD     *ZERO         YL0489                         Count Records
      * Declare restrictor key work fields
      * Define keylist
     C     KRSNC         KLIST
     C                   KFLD                    WQNC01                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     TOHQNZ        WQNC01                         Surrogate Numbe
      * Establish starting position
     C     KRSNC         SETLL     @C5CPMF                                      *
     C     KRSNC         READE     @C5CPMF                                90    *
      * Data record not found
     C   90              MOVEL     'USR5305'     W0RTN
      * USER: Process Data record
      * ** Count the number of errors for a surrogate.
     C                   DOW       NOT *IN90
     C                   ADD       1             YL0489                         Count Records
     C     KRSNC         READE     @C5CPMF                                90    *
     C                   ENDDO
      * USER: Exit processing
     C                   Z-ADD     YL0489        YL0488                         Count Records
      *================================================================
     CSR   NCEXIT        ENDSR
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * RTV Sequence by Ordr Num - WF Block Order Upload Hdr  * 
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 Hdr/Dtl Validat
      *
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * Comments
     C                   EXSR      UCSUBR                                       Comments
      * Initialization.
      * CASE: *OTHERWISE
      * LCL = CON By name
      * UPD Copy Order Templt2UP - /UT User Programs  * 
     C                   CALL      'PVAUUPC'                            90      UPD Copy Order
     C                   PARM      'C'           WQ0001                         Update Status T
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAUUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * *** Setting first time flag for when we process the first Change.
     C                   MOVEL     'Y'           YL0001                         First Time Flag
      * Define keylist
     C     KPSSA         KLIST
     C                   KFLD                    WAC4NB                         Order Number
      * Setup key
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
      * Establish starting position
     C     KPSSA         SETLL     @C2CPUM                                      *
     C                   READ      @C2CPUM                                90    *
      * Data record not found
     C   90              MOVEL     'USR5299'     W0RTN
      * USER: Process Data record
      * Comments
     C                   DOW       NOT *IN90
     C                   EXSR      UDSUBR                                       Comments
      * Process through all the Header and Detail Records.
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0002                         Hdr/Dtl Validat
     C                   MOVEL     'Y'           WN0001                         Hdr/Dtl Validat
      * CASE: DB1.Order Number is Equal to zeros
      * RTV Surogate is Present - WF Block Order Trans  * 
     C                   IF        WAC4NB = 0
     C                   EXSR      SBRVGN
      * ** Mark as an error if surrogate is already present
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   EVAL      YL0003 = ' '                                 @Text 9
     C                   MOVEL     WAHQNZ        YL0003                         @Text 9
     C                   EVAL      YL0004 = ' '                                 BOE Error Comme
     C                   MOVEL     @CN(001)      YL0004                         BOE Error Comme
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(001)      CAT(P)    YL0003:ZQ     YL0004                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    @CN(002):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0002                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0003                         Order Number
     C                   PARM      'DUPSUR'      WQ0004                         BOE Error Reaso
     C                   PARM      YL0004        WQ0005                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** 0 Order number is a new order.
      * ** 1 Company Number
      * Val Company Exist     RT - Company Defaults Internal  * Check exi
     C                   EXSR      SCRVGN
      * ** Mark as an error if we don't find the Company.
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   EVAL      YL0004 = ' '                                 BOE Error Comme
     C                   MOVEL     @CN(004)      YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0006                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0007                         Order Number
     C                   PARM      'INVCMP'      WQ0008                         BOE Error Reaso
     C                   PARM      YL0004        WQ0009                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 2 Ship to Customer
      * RTV Com Market        RT - Customer Master  * Chk Exist & RTV Par
     C                   EXSR      SDRVGN
      * ** Mark as an error if we don't find the Ship to.
      * CASE: PGM.*Return code is *Normal
      * Rtv Customer Air Frt  RT - Customer EXT  * 
     C                   IF        W0RTN = ' '
     C                   EXSR      SERVGN
      * RTV Cust Name/Addr     RT - Customer  * Bill To
     C                   EXSR      SFRVGN
      * ** Mark as an error if we don't find the Bill to.
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0010                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0011                         Order Number
     C                   PARM      'INVBLT'      WQ0012                         BOE Error Reaso
     C                   PARM      @CN(005)      WQ0013                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     1             ZQ
     C     @CN(006)      CAT(P)    @CN(007):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0014                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0015                         Order Number
     C                   PARM      'INVSTC'      WQ0016                         BOE Error Reaso
     C                   PARM      YL0004        WQ0017                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 2 Ship to Customer
      * CASE: *OTHERWISE
      * RTV OE Hold/ShipTo FlagXF - Customer  * 
     C                   CALL      'PDNEXFR'                            90      RTV OE Hold/Shi
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WABKC7        WQ0018                         Ship To Custome
     C     YL0022        PARM      *BLANK        WQ0019                         Order Entry Hol
     C     YL0023        PARM      *BLANK        WQ0020                         Ship To Custome
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDNEXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Ship To Customer Flag is No Use as Ship to Cust
     C                   IF        YL0023 = 'N'
     C                   Z-ADD     1             ZQ
     C     @CN(008)      CAT(P)    @CN(009):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0021                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0022                         Order Number
     C                   PARM      'CSTFLG'      WQ0023                         BOE Error Reaso
     C                   PARM      YL0004        WQ0024                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * CASE: LCL.Order Entry Hold is New Order Hold
     C                   IF        YL0022 = 'Y'
     C                   Z-ADD     1             ZQ
     C     @CN(010)      CAT(P)    @CN(011):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0025                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0026                         Order Number
     C                   PARM      'OEHOLD'      WQ0027                         BOE Error Reaso
     C                   PARM      YL0004        WQ0028                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 3  Company/Ship to Customer
      * CASE: *OTHERWISE
      * RTV Cust Ordering Dflt2XF - Company Customer  * 
     C                   CALL      'PNS9XFR'                            90      RTV Cust Orderi
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0029                         Company Number
     C                   PARM      WABKC7        WQ0030                         Ship To Custome
     C     YL0024        PARM      *BLANK        WQ0031                         Terms Code
     C     YL0025        PARM      *BLANK        WQ0032                         Sales Route Cod
     C     YL0026        PARM      *BLANK        WQ0033                         Special Instruc
     C     YL0027        PARM      *BLANK        WQ0034                         Special Instruc
     C                   PARM      *BLANK        WQ0035                         Carrier Code
     C                   PARM      *BLANK        WQ0036                         P_O Required Fl
     C     YL0028        PARM      *ZERO         WQ0037                         Deliver after t
     C     YL0029        PARM      *BLANK        WQ0038                         Type Code
     C     YL0030        PARM      *ZERO         WQ0039                         Absorbed Freigh
     C                   PARM      *ZERO         WQ0040                         Mileage To Cust
     C                   PARM      *BLANK        WQ0041                         Warehouse Code
     C     YL0031        PARM      *BLANK        WQ0042                         Outside Warehou
     C                   PARM      *BLANK        WQ0043                         Customer Group
     C                   PARM      *BLANK        WQ0044                         Customer Group
     C                   PARM      *BLANK        WQ0045                         Ord Ent Default
     C     YL0032        PARM      *BLANK        WQ0046                         Record Found US
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNS9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Return code processing
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Record Found USR is Record Found
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0032 = 'Y'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     1             ZQ
     C     @CN(012)      CAT(P)    'Found':ZQ    YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0047                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0048                         Order Number
     C                   PARM      'CMPCST'      WQ0049                         BOE Error Reaso
     C                   PARM      YL0004        WQ0050                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
      * ** Validate Sales Route Code
      * CASE: LCL.Sales Route Code is not entered
     C                   IF        YL0025 = ' '
     C                   Z-ADD     1             ZQ
     C     @CN(013)      CAT(P)    @CN(014):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0051                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0052                         Order Number
     C                   PARM      'SLSRTE'      WQ0053                         BOE Error Reaso
     C                   PARM      YL0004        WQ0054                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV Salesman Code      XF - Sales Route  * 
     C                   CALL      'PNIAXFR'                            90      RTV Salesman Co
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0025        WQ0055                         Sales Route Cod
     C     YL0033        PARM      *BLANK        WQ0056                         Salesperson Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNIAXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Validate Salesperson Code
      * CASE: LCL.Salesperson Code is not entered
     C                   IF        YL0033 = ' '
     C                   Z-ADD     1             ZQ
     C     @CN(015)      CAT(P)    @CN(016):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0057                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0058                         Order Number
     C                   PARM      'SLSPER'      WQ0059                         BOE Error Reaso
     C                   PARM      YL0004        WQ0060                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv Dft Sales Channel  XF - Salesperson Electronic CM  * 
     C                   CALL      'PBHPXFR'                            90      Rtv Dft Sales C
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0033        WQ0061                         Salesperson Cod
     C     YL0029        PARM      *BLANK        WQ0062                         SEC Default Sal
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBHPXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Validate Type Code
      * CASE: LCL.Type Code is EQ Blank
     C                   IF        YL0029 = ' '
     C                   Z-ADD     1             ZQ
     C     @CN(017)      CAT(P)    @CN(018):ZQ   YL0004                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    @CN(019):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0063                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0064                         Order Number
     C                   PARM      'TYPCDE'      WQ0065                         BOE Error Reaso
     C                   PARM      YL0004        WQ0066                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Sls Route by Slsp  XF - Sales Route  * 
     C                   CALL      'PNH6XFR'                            90      RTV Sls Route b
     C                   PARM      *BLANK        W0RTN
     C     YL0025        PARM      *BLANK        WQ0067                         Sales Route Cod
     C                   PARM      YL0033        WQ0068                         Salesperson Cod
     C     YL0034        PARM      *BLANK        WQ0069                         Manager Level C
     C     YL0035        PARM      *BLANK        WQ0070                         VP Level Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNH6XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Get Sales Route Code
      * CASE: LCL.Sales Route Code is not entered
     C                   IF        YL0025 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(020)      CAT(P)    @CN(021):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0071                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0072                         Order Number
     C                   PARM      'SLSPER'      WQ0073                         BOE Error Reaso
     C                   PARM      YL0004        WQ0074                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Get VP Level Code
      * CASE: LCL.VP Level Code is Not Entered
      * RTV Mgr Desc,VP Level  XF - Manager Level  * 
     C                   IF        YL0035 = ' '
     C                   CALL      'PNIBXFR'                            90      RTV Mgr Desc,VP
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0034        WQ0075                         Manager Level C
     C     YL0036        PARM      *BLANK        WQ0076                         Description
     C     YL0035        PARM      *BLANK        WQ0077                         VP Level Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNIBXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Validate Requested Delivery Time
      * CASE: LCL.Requested Delivery Time is Entered
     C                   IF        YL0028 <> 0
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv All - Customer EXT2  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WABKC7        WL0001                         Ship To Custome
     C                   EXSR      SGRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        YN0044                         M3 Supplier ID
     C                   MOVEL(P)  WL0003        YN0045                         Dft Mode of Tra
     C                   MOVEL(P)  WL0004        YN0046                         Buying Group
     C                   MOVEL(P)  WL0005        YN0047                         Buying Group Op
     C                   MOVEL(P)  WL0006        YN0048                         Ship To Establi
     C                   MOVEL(P)  WL0007        YN0049                         PM Pallet Type
     C                   MOVEL(P)  WL0008        YN0050                         Cust Dft Price
     C                   Z-ADD     WL0009        YN0051                         Cust Dft Age Da
     C                   Z-ADD     WL0010        YL0037                         Cust Dft Delive
      * Convert 6,0 HHMMSS format to 4,0 HHMM time format.
      * CASE: *OTHERWISE
     C                   EVAL      YL0038 = ' '                                 Time Alpha usr
     C                   MOVEL     YL0037        YL0038                         Time Alpha usr
     C                   Z-ADD     4             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00006 OR
     C                             ZQ > 00006
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0038:ZQ     YL0039                 90      Time HHMM Alpha
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   MOVE      YL0039        YL0028                         Requested Deliv
      * CASE: LCL.Requested Delivery Time is Zero
      * ** Defaulting to 06:00 per Joe Kellerman.
     C                   IF        YL0028 = 0
     C                   Z-ADD     0600          YL0028                         Requested Deliv
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                   CALL      'PMRMXFR'                            90      RTV Co. Dflt In
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0078                         Company Number
     C                   PARM      *BLANK        WQ0079                         Shipping Method
     C     YL0040        PARM      *BLANK        WQ0080                         Load Type Dft
     C     YL0041        PARM      *BLANK        WQ0081                         LTL Flag Dft
     C                   PARM      *BLANK        WQ0082                         Export Status D
     C     YL0042        PARM      *BLANK        WQ0083                         Shrink Wrap Dft
     C                   PARM      *ZERO         WQ0084                         Departure Time
     C                   PARM      *BLANK        WQ0085                         Export Code Dft
     C                   PARM      *BLANK        WQ0086                         Allow Mult Whse
     C                   PARM      *BLANK        WQ0087                         Allow Multi Exp
     C     YL0043        PARM      *BLANK        WQ0088                         Slip Sheet Dft
     C     YL0044        PARM      *BLANK        WQ0089                         Palletize Dft
     C     YL0045        PARM      *BLANK        WQ0090                         Company Organiz
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PMRMXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Consider Palletize from WF Header
      * CASE: DB1.Palletize is Not Blank
     C                   IF        WAVEST = 'N' OR
     C                             WAVEST = 'Y'
     C                   MOVEL     WAVEST        YL0044                         Palletize
     C                   END                                                    *FI
      * ** Test for Slip Sheet
      * CASE: DB1.Slip Sheet is Y/N/' ' Values
     C                   IF        WAVGST = ' ' OR
     C                             WAVGST = 'N' OR
     C                             WAVGST = 'Y'
     C                   MOVEL     WAVGST        YL0046                         Slip Sheet
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0046 = ' '                                 Slip Sheet
      * CASE: DB1.Shipping Method is Not Entered
     C                   IF        WAQ2CD = ' '
     C                   MOVEL     YL0043        YL0046                         Slip Sheet
     C                   END                                                    *FI
     C                   END                                                    *FI
      * WI546_2 02/22/24
      * Shipping Method
      * CASE: DB1.Shipping Method is Not Entered
     C                   IF        WAQ2CD = ' '
     C                   MOVEL     'PT'          YL0047                         Shipping Method
     C                   ELSE
      * CASE: *OTHERWISE
      * ** Validate Shipping Method
      * CASE: DB1.Shipping Method is Valid Values
      * We B OK.
     C                   IF        WAQ2CD = 'CR' OR
     C                             WAQ2CD = 'CT' OR
     C                             WAQ2CD = 'PR' OR
     C                             WAQ2CD = 'PT'
     C                   MOVEL     WAQ2CD        YL0047                         Shipping Method
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     1             ZQ
     C     @CN(022)      CAT(P)    @CN(023):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0091                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0092                         Order Number
     C                   PARM      'SHPMTH'      WQ0093                         BOE Error Reaso
     C                   PARM      YL0004        WQ0094                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Validate Intended for Export
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Type Code is Export
      *   |- c2    : DB1.OHE Intended for ExportCC is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0029 = 'EX'
     C                   IF        WALWAA <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(024)      CAT(P)    @CN(025):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0095                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0096                         Order Number
     C                   PARM      'INTEXP'      WQ0097                         BOE Error Reaso
     C                   PARM      YL0004        WQ0098                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Validate Export status
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : LCL.Type Code is Not Export
      *   |- c2    : DB1.Country Code is Entered
      *   |- c3    : DB1.Export Status is yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0029 <> 'EX'
     C                   MOVEL     '0'           Y0CX02
     C                   IF        WAKXCD <> ' ' OR
     C                             WAU2ST = 'Y'
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(026)      CAT(P)    @CN(027):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0099                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0100                         Order Number
     C                   PARM      'INVEXS'      WQ0101                         BOE Error Reaso
     C                   PARM      YL0004        WQ0102                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Type Code is Export
      *   |- c2    : DB1.Country Code is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0029 = 'EX'
     C                   IF        WAKXCD <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Val Country & Active   RT - Country Master  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   MOVEL(P)  WAKXCD        WL0011                         Country Code
     C                   EXSR      SHRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0012        YL0048                         Record Status
      * CASE: LCL.USR Record Status is Active
     C                   IF        YL0048 = 'A'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(028)      CAT(P)    @CN(029):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0103                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0104                         Order Number
     C                   PARM      'INVEXS'      WQ0105                         BOE Error Reaso
     C                   PARM      YL0004        WQ0106                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Validate Load Type Dft
      * CASE: LCL.Load Type Dft is Blank
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   IF        YL0040 = ' '
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0107                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0108                         Order Number
     C                   PARM      'LDTYPE'      WQ0109                         BOE Error Reaso
     C                   PARM      @CN(030)      WQ0110                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Validate Palletize
      * CASE: DB1.Palletize is Y/N Values
     C                   IF        WAVEST = 'N' OR
     C                             WAVEST = 'Y'
     C                   ELSE
      * CASE: LCL.Palletize is blank
     C                   IF        YL0044 = ' '
     C                   Z-ADD     1             ZQ
     C     @CN(031)      CAT(P)    @CN(032):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0111                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0112                         Order Number
     C                   PARM      'PALTZE'      WQ0113                         BOE Error Reaso
     C                   PARM      YL0004        WQ0114                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Palletize is yes
      * Rtv Pallet Type/Desc  XF - Customer EXT2  * 
     C                   IF        YL0044 = 'Y'
     C                   CALL      'PUTPXFR'                            90      Rtv Pallet Type
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WABKC7        WQ0115                         Ship To Custome
     C     YL0049        PARM      *BLANK        WQ0116                         PM Pallet Type
     C                   PARM      *BLANK        WQ0117                         PM Description
     C     YL0032        PARM      *BLANK        WQ0118                         Record Found US
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUTPXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.OD Pallet Type is None
     C                   IF        YL0049 = ' '
     C                   MOVEL     '02'          YL0049                         OD Pallet Type
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0049 = ' '                                 OD Pallet Type
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Validate Slip Sheet Dft
      * CASE: LCL.Slip Sheet Dft is blank
     C                   IF        YL0043 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(033)      CAT(P)    @CN(034):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0119                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0120                         Order Number
     C                   PARM      'SLPSHT'      WQ0121                         BOE Error Reaso
     C                   PARM      YL0004        WQ0122                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * RTV Order Types        XF - Order Types  * 
     C                   CALL      'PNH9XFR'                            90      RTV Order Types
     C                   PARM      *BLANK        W0RTN
     C                   PARM      'OR'          WQ0123                         Order Type_Sale
     C                   PARM      *BLANK        WQ0124                         Order Type Desc
     C                   PARM      *BLANK        WQ0125                         Processing Cycl
     C     YL0050        PARM      *BLANK        WQ0126                         Billing Activit
     C     YL0051        PARM      *BLANK        WQ0127                         Affect Inventor
     C     YL0052        PARM      *BLANK        WQ0128                         Affect Sales Do
     C     YL0053        PARM      *BLANK        WQ0129                         Affect Sales Pn
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNH9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Validate Cust & Order Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Billing Activity Type is Invoice
      *   |- c2    : LCL.Outside Warehouse Flag is yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0050 = '1'
     C                   IF        YL0031 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(035)      CAT(P)    @CN(036):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0130                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0131                         Order Number
     C                   PARM      'OUTWHS'      WQ0132                         BOE Error Reaso
     C                   PARM      YL0004        WQ0133                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 4 Warehouse Code
      * Val Warehouse Exist   RT - Warehouse Codes  * 
     C                   EXSR      SIRVGN
      * ** Warehouse Code
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(037)      CAT(P)    @CN(038):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0134                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0135                         Order Number
     C                   PARM      'WHSCDE'      WQ0136                         BOE Error Reaso
     C                   PARM      YL0004        WQ0137                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV All               RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  WAAJCD        WL0013                         Warehouse Code
     C                   EXSR      SJRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0014        YN0061                         Warehouse Descr
     C                   MOVEL(P)  WL0015        YN0062                         Address Line 1
     C                   MOVEL(P)  WL0016        YN0063                         Address Line 2
     C                   MOVEL(P)  WL0017        YN0064                         Address Line 3
     C                   MOVEL(P)  WL0018        YN0065                         City
     C                   MOVEL(P)  WL0019        YN0066                         Zip Postal Code
     C                   MOVEL(P)  WL0020        YL0054                         Production Ware
     C                   MOVEL(P)  WL0021        YN0067                         State Code
     C                   MOVEL(P)  WL0022        YN0068                         Lot Tracking Fl
     C                   MOVEL(P)  WL0023        YN0069                         Default Printer
     C                   MOVEL(P)  WL0024        YL0055                         Warehouse Type
     C                   MOVEL(P)  WL0025        YL0056                         Trans Contol AS
     C                   MOVEL(P)  WL0026        YN0070                         Warehouse Locat
     C                   MOVEL(P)  WL0027        YN0071                         Warehouse Std C
     C                   Z-ADD     WL0028        YN0072                         Warehouse Chill
     C                   MOVEL(P)  WL0029        YN0073                         Include in Auto
     C                   MOVEL(P)  WL0030        YN0074                         Default Manifes
     C                   MOVEL(P)  WL0031        YN0075                         Default Load Se
     C                   MOVEL(P)  WL0032        YN0076                         WHS Slotting Li
     C                   Z-ADD     WL0033        YN0077                         Shipping Compan
     C                   Z-ADD     WL0034        YN0078                         Accounting Comp
     C                   Z-ADD     WL0035        YN0079                         WHS Sched Prod
     C                   Z-ADD     WL0036        YN0080                         WHS Inventory C
     C                   MOVEL(P)  WL0037        YN0081                         Parent Warehous
     C                   MOVEL(P)  WL0038        YN0082                         Default Shippin
     C                   MOVEL(P)  WL0039        YN0083                         WHS Live with C
     C                   MOVEL(P)  WL0040        YN0084                         WHS PFS Interfa
     C                   MOVEL(P)  WL0041        YN0085                         WHS Req Meter R
     C                   MOVEL(P)  WL0042        YN0086                         WHS Default Loa
     C                   MOVEL(P)  WL0043        YN0087                         WHS TMS Plannin
     C                   MOVEL(P)  WL0044        YN0088                         Default Carrier
     C                   MOVEL(P)  WL0045        YN0089                         Inventory Logic
     C                   MOVEL(P)  WL0046        YN0090                         WHS Auto Inv Re
     C                   MOVEL(P)  WL0047        YN0030                         EDI Status 1
     C                   MOVEL(P)  WL0048        YN0031                         EDI Status 2
     C                   MOVEL(P)  WL0049        YN0032                         EDI Status 3
     C                   MOVEL(P)  WL0050        YN0004                         Record Status
      * RTV Shipping Temp      XF - Warehouse Type-Internal  * 
     C                   CALL      'PDSSXFR'                            90      RTV Shipping Te
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0055        WQ0138                         Warehouse Type
     C                   PARM      *ZERO         WQ0139                         Reefer Temperat
     C     YL0057        PARM      *BLANK        WQ0140                         Temperature Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDSSXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      *
     C                   Z-ADD     *ZERO         WN0002                         System Value Nu
      *
      * Rtv Whs Typ/FZNCHLTME IF
      * RTV Warehouse Type     RT - Warehouse  * 
     C                   EXSR      SKRVGN
      * CASE: PAR.Warehouse Type is Frozen
      * RTV Numeric Value      RT - Company Values  * 
     C                   IF        YL0055 = 'FZ'
     C                   EXSR      SLRVGN
     C                   Z-ADD     WN0002        YL0058                         Fresh Chilling
     C                   END                                                    *FI
      * CASE: DB1.Warehouse Code NE LCL.HPB Ship to Warehouse
     C                   IF        WAAJCD <> YL0059
     C                   MOVEL     WAAJCD        YL0059                         HPB Ship to War
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 5 Requested Ship Date
      * CASE: DB1.Requested Ship Date is entered
      * ** Saving the date to pass into the Detail validation.
     C                   IF        WAA5DT <> 0
     C                   Z-ADD     WAA5DT        YL0060                         Requested Ship
      * RTV Calendar           RT - Calendar  * See if date exists
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0051                         Company Number
     C                   Z-ADD     WAA5DT        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * ** Error if Requested Ship Date is not in Calendar
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(040)      CAT(P)    @CN(041):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0141                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0142                         Order Number
     C                   PARM      'INVRSD'      WQ0143                         BOE Error Reaso
     C                   PARM      YL0004        WQ0144                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
      * ** If the date is not in the Calendar, default to today's
      * **  date so that the Detail validations will not get hung in a lo
     C                   Z-ADD     ##ED7         YL0060                         Requested Ship
     C                   END                                                    *FI
      * ** WI546_2-Validate Date format is CYMD for Requested Ship Date
      * CASE: *OTHERWISE
     C                   EVAL      YL0061 = ' '                                 Date From Conve
     C                   MOVEL     WAA5DT        YL0061                         Date From Conve
     C                   EVAL      YL0062 = ' '                                 Text usr 11
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0061        WQ0145                         Date From Conve
     C     YL0062        PARM      *BLANK        WQ0146                         Date To Convert
     C                   PARM      '*CYMD'       WQ0147                         Date From Forma
     C                   PARM      '*YYMD'       WQ0148                         Date To Format
     C                   PARM      '*NONE'       WQ0149                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0062 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(042)      CAT(P)    @CN(043):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0150                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0151                         Order Number
     C                   PARM      'INVRSD'      WQ0152                         BOE Error Reaso
     C                   PARM      YL0004        WQ0153                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(042)      CAT(P)    'te':ZQ       YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0154                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0155                         Order Number
     C                   PARM      'INVRSD'      WQ0156                         BOE Error Reaso
     C                   PARM      YL0004        WQ0157                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 6 Spot Buy
      * CASE: DB1.OHE Spot Buy is Valid Values
     C                   IF        WAC3TX = 'P' OR
     C                             WAC3TX = 'S' OR
     C                             WAC3TX = 'T'
     C                   MOVEL     WAC3TX        YL0063                         OD Spot Buy
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(044)      CAT(P)    ' ':ZQ        YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0158                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0159                         Order Number
     C                   PARM      'SPTBUY'      WQ0160                         BOE Error Reaso
     C                   PARM      YL0004        WQ0161                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 7 Customer Purchase Order#
      * CASE: DB1.Customer Purchase Order # is Blank
     C                   IF        WABCNA = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(045)      CAT(P)    'mber':ZQ     YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0162                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0163                         Order Number
     C                   PARM      'INVPO#'      WQ0164                         BOE Error Reaso
     C                   PARM      YL0004        WQ0165                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 8 Export Status
      * CASE: DB1.Export Status is Y/N Values
     C                   IF        WAU2ST = 'N' OR
     C                             WAU2ST = 'Y'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(046)      CAT(P)    'ered':ZQ     YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0166                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0167                         Order Number
     C                   PARM      'EXPSTS'      WQ0168                         BOE Error Reaso
     C                   PARM      YL0004        WQ0169                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 9 Country Code
      * CASE: DB1.Country Code is Blank
     C                   IF        WAKXCD = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Val Country & Active   RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  WAKXCD        WL0011                         Country Code
     C                   EXSR      SHRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0012        YL0064                         Record Status
      * CASE: Country exists and Active
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Record Status is Active
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        W0RTN = ' '
     C                   IF        YL0064 = 'A'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(047)      CAT(P)    @CN(048):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0170                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0171                         Order Number
     C                   PARM      'CNTCDE'      WQ0172                         BOE Error Reaso
     C                   PARM      YL0004        WQ0173                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 10 OHE Intended for ExportCC
      * ** Only validate if Entered.
      * CASE: DB1.OHE Intended for ExportCC is Entered
      * Val Country & Active   RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WALWAA <> ' '
     C                   MOVEL(P)  WALWAA        WL0011                         Country Code
     C                   EXSR      SHRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0012        YL0064                         Record Status
      * ** Country Exists and Active
      * CASE: Country exists and Active
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Record Status is Active
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        W0RTN = ' '
     C                   IF        YL0064 = 'A'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(049)      CAT(P)    @CN(050):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0174                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0175                         Order Number
     C                   PARM      'INVIFE'      WQ0176                         BOE Error Reaso
     C                   PARM      YL0004        WQ0177                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Country & Intend for Export Can't both be entered.
      * CASE: Country and Intend for Export can't both b enterd
      *  - c1 AND c2
      *   |- c1    : DB1.Country Code is Entered
      *   |- c2    : DB1.OHE Intended for ExportCC is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WAKXCD <> ' '
     C                   IF        WALWAA <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     1             ZQ
     C     @CN(051)      CAT(P)    @CN(052):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0178                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0179                         Order Number
     C                   PARM      'INTCNT'      WQ0180                         BOE Error Reaso
     C                   PARM      YL0004        WQ0181                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** WI546_2   Shrink Wrap
      * CASE: DB1.Shrink Wrap is Y/N Values
     C                   IF        WAVFST = 'N' OR
     C                             WAVFST = 'Y'
     C                   MOVEL     WAVFST        YL0042                         Shrink Wrap
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           YL0042                         Shrink Wrap
     C                   END                                                    *FI
      * *** WI546_2   Requested Delivery Date
      * CASE: DB1.Requested Delivery Date is entered
      * ** WI546_2-Validate Date format is CYMD for Requested Delivery Da
      * CASE: *OTHERWISE
     C                   IF        WAEIDT <> 0
     C                   EVAL      YL0062 = ' '                                 Text usr 11
     C                   EVAL      YL0061 = ' '                                 Date From Conve
     C                   MOVEL     WAEIDT        YL0061                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0061        WQ0182                         Date From Conve
     C     YL0062        PARM      *BLANK        WQ0183                         Date To Convert
     C                   PARM      '*CYMD'       WQ0184                         Date From Forma
     C                   PARM      '*YYMD'       WQ0185                         Date To Format
     C                   PARM      '*NONE'       WQ0186                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0062 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(053)      CAT(P)    @CN(054):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0187                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0188                         Order Number
     C                   PARM      'INVDEL'      WQ0189                         BOE Error Reaso
     C                   PARM      YL0004        WQ0190                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 1019801 JM - WI546_2 Make sure RDD is present in Calendar.
      * CASE: *OTHERWISE
      * RTV Calendar           RT - Calendar Master  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0051                         Company Number
     C                   Z-ADD     WAEIDT        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * CASE: PGM.*Return code is Calendar not found
     C                   IF        W0RTN = @CN(055)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(056)      CAT(P)    @CN(057):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0191                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0192                         Order Number
     C                   PARM      'INVDEL'      WQ0193                         BOE Error Reaso
     C                   PARM      YL0004        WQ0194                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     0             ZQ
     C     @CN(053)      CAT(P)    @CN(058):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0195                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0196                         Order Number
     C                   PARM      'INVDAT'      WQ0197                         BOE Error Reaso
     C                   PARM      YL0004        WQ0198                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** WI546_2 Validate shipping date
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Requested Ship Date is entered
      *   |- c2    : DB1.Requested Delivery Date is entered
      *   |- c3    : LCL.Shipping Method is Prepaid
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WAA5DT <> 0
     C                   IF        WAEIDT <> 0
     C                   IF        YL0047 = 'PR' OR
     C                             YL0047 = 'PT'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     WAAJCD        YL0065                         Warehouse Code
      * CLC Must Ship 4 Req DlvXF - Order Header TRG  * 
     C                   CALL      'PMUSXFR'                            90      CLC Must Ship 4
     C                   PARM      *BLANK        W0RTN
     C     YL0066        PARM      *BLANK        WQ0199                         Must Ship Error
     C                   PARM      9999999       WQ0200                         Order Number
     C                   PARM      WAA5DT        WQ0201                         Requested Ship
     C                   PARM      YL0009        WQ0202                         Ship To City
     C                   PARM      YL0010        WQ0203                         Ship To State C
     C                   PARM      WAAIC3        WQ0204                         Company Number
     C                   PARM      YL0028        WQ0205                         Requested Deliv
     C                   PARM      WAA5DT        WQ0206                         Scheduled Ship
     C                   PARM      WAEIDT        WQ0207                         Requested Deliv
     C     YL0065        PARM      YL0065        WQ0208                         Warehouse Code
     C     YL0067        PARM      YL0067        WQ0209                         Must Ship Date
     C     YL0068        PARM      YL0068        WQ0210                         Must Ship Time
     C                   PARM      *ZERO         WQ0211                         USR Order Numbe
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PMUSXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Must Ship Error is Miles to Next=Zeros
     C                   IF        YL0066 = 'MTN'
     C                   EVAL      YL0066 = ' '                                 Must Ship Error
     C                   ELSE
      * CASE: *OTHERWISE
      * PMT Must Ship Err Msg  IF
     C                   EVAL      YL0069 = ' '                                 Explaination Te
      * CASE: PAR.Must Ship Error is No Error
     C                   IF        YL0066 = ' '
     C                   ELSE
      * CASE: PAR.Must Ship Error is Must Ship before NOW
     C                   IF        YL0066 = 'NOW'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(059)      YL0069                         Explaination Te
     C                   Z-ADD     *ZERO         ZQ
     C     YL0069        CAT(P)    @CN(060):ZQ   YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Deadline not bef Delivery
     C                   IF        YL0066 = 'DDD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(061)      YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Must Shp not bef Deadline
     C                   IF        YL0066 = 'MSD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(062)      YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Schd Shp not bef Must Shp
     C                   IF        YL0066 = 'SSD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(063)      YL0069                         Explaination Te
     C                   Z-ADD     *ZERO         ZQ
     C     YL0069        CAT(P)    ' Ship':ZQ    YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Miles to Next=Zeros
     C                   IF        YL0066 = 'MTN'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(064)      YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Req Ship should =Must Shp
     C                   IF        YL0066 = 'RSD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(065)      YL0069                         Explaination Te
     C                   Z-ADD     *ZERO         ZQ
     C     YL0069        CAT(P)    @CN(066):ZQ   YL0069                         Explaination Te
     C                   ELSE
      * CASE: *OTHERWISE
      * --- unexpected error ---
      * PAR.Explaination Text 1 = Condition name of PAR.Must Ship Error
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1519963       Y2LSNO                         List number
     C                   PARM      YL0066        W0INVL                         Must Ship Error
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     YL0069        PARM                    W0CNNM                         Explaination Te
      *
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: LCL.Must Ship Error is Error List
      * Populate error message text
      * CASE: *OTHERWISE
      * Convert 6,0 HHMMSS format to 4,0 HHMM time format.
      * CASE: *OTHERWISE
     C                   IF        YL0066 = 'DDD' OR
     C                             YL0066 = 'MTN' OR
     C                             YL0066 = 'NOW' OR
     C                             YL0066 = 'MSD' OR
     C                             YL0066 = 'RSD' OR
     C                             YL0066 = 'SSD'
     C                   EVAL      YL0038 = ' '                                 Time Alpha usr
     C                   MOVEL     YL0068        YL0038                         Time Alpha usr
     C                   Z-ADD     4             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00006 OR
     C                             ZQ > 00006
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0038:ZQ     YL0039                 90      Time HHMM Alpha
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   EVAL      YL0070 = ' '                                 USR Work Field
     C                   MOVEL     YL0067        YL0070                         USR Work Field
     C                   Z-ADD     6             YRSW00
     C                   Z-ADD     2             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0070:ZQ     YL0071                 90      USR Date Alpha
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     1             ZQ
     C     @CN(067)      CAT(P)    @CN(068):ZQ   YL0004                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    YL0071:ZQ     YL0004                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    YL0039:ZQ     YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0212                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0213                         Order Number
     C                   PARM      'INVDAT'      WQ0214                         BOE Error Reaso
     C                   PARM      YL0004        WQ0215                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Process each valid record.
      * CASE: LCL.Hdr/Dtl Validation Pass U is Yes
      * ** Write Header records to Qtemp.
      * Crt Block Order Qtemp XF - Order Header TRG  * 
     C                   IF        YL0002 = 'Y'
     C                   CLEAR                   PARC
     C                   Z-ADD     WAAIC3        PAAIC3                         Company Number
     C                   Z-ADD     9999999       PAC4NB                         Order Number
     C                   MOVEL(P)  'OR'          PAJNCD                         Order Type_Sale
     C                   Z-ADD     YL0012        PAANC7                         AR Customer Num
     C                   Z-ADD     WABKC7        PABKC7                         Ship To Custome
     C                   MOVEL(P)  YL0005        PABRTX                         Ship To Name
     C                   MOVEL(P)  YL0006        PAHMNA                         Ship To Address
     C                   MOVEL(P)  YL0007        PAHONA                         Ship To Address
     C                   MOVEL(P)  YL0008        PAHPNA                         Ship To Address
     C                   MOVEL(P)  YL0009        PAHNNA                         Ship To City
     C                   MOVEL(P)  YL0010        PADBCD                         Ship To State C
     C                   MOVEL(P)  YL0011        PACKTX                         Ship To Zip_Pos
     C                   Z-ADD     YL0012        PAB0C7                         Bill to Custome
     C                   MOVEL(P)  YL0015        PAAETX                         Bill to Name
     C                   MOVEL(P)  YL0016        PAB1NA                         Bill to Address
     C                   MOVEL(P)  YL0017        PAB3NA                         Bill to Address
     C                   MOVEL(P)  YL0018        PAB4NA                         Bill to Address
     C                   MOVEL(P)  YL0019        PAB2NA                         Bill to City
     C                   MOVEL(P)  YL0020        PABHCD                         Bill to State C
     C                   MOVEL(P)  YL0021        PAC8TX                         Bill to Zip_Pos
     C                   MOVEL(P)  WABCNA        PABCNA                         Customer Purcha
     C                   Z-ADD     ##JDT         PAA0DT                         Order Date
     C                   Z-ADD     WAA5DT        PAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         PAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         PAACDT                         Cancel Date
     C                   MOVEL(P)  YL0024        PAAQCD                         Terms Code
     C                   MOVEL(P)  YL0027        PAB6NA                         Special Instruc
     C                   MOVEL(P)  YL0026        PABYNA                         Special Instruc
     C                   EVAL      PABZNA = ' '                                 Carrier Code
     C                   EVAL      PAGTST = ' '                                 Comment Print A
     C                   EVAL      PAGVST = ' '                                 Comment Print I
     C                   EVAL      PAGUST = ' '                                 Comment Print P
     C                   MOVEL(P)  'N'           PAQFST                         Comment Print S
     C                   EVAL      PACQCD = ' '                                 Reason Code
     C                   MOVEL(P)  'N'           PAGJST                         Order in Use
     C                   MOVEL(P)  'E'           PAGWST                         Header Status
     C                   EVAL      PAGXST = ' '                                 Header Status L
     C                   MOVEL(P)  'N'           PAGYST                         Order Type Prin
     C                   Z-ADD     WAA5DT        PAAODT                         Scheduled Ship
     C                   MOVEL(P)  @CN(069)      PAAIVN                         User Original E
     C                   Z-ADD     ##JDT         PACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         PAJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         PAA1WG                         Order Weight To
     C                   MOVEL(P)  'N'           PAXIST                         Credit Hold
     C                   MOVEL(P)  'N'           PAXJST                         Production Hold
     C                   MOVEL(P)  'N'           PAXKST                         New Customer Ho
     C                   Z-ADD     WAEIDT        PAEIDT                         Requested Deliv
     C                   Z-ADD     YL0028        PAAFTM                         Requested Deliv
     C                   EVAL      PAE8CD = ' '                                 Accounts Receiv
     C                   EVAL      PAE9CD = ' '                                 Accounts Receiv
     C                   Z-ADD     *ZERO         PARMNB                         Load ID
     C                   Z-ADD     YL0030        PATBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         PAR1NB                         Rated Freight
     C                   MOVEL(P)  YL0041        PAPJST                         LTL Flag
     C                   EVAL      PAU0ST = ' '                                 Price Audit
     C                   MOVEL(P)  'U'           PAU1ST                         Price Status
     C                   MOVEL(P)  YL0047        PAQ2CD                         Shipping Method
     C                   MOVEL(P)  WAU2ST        PAU2ST                         Export Status
     C                   MOVEL(P)  YL0044        PAVEST                         Palletize
     C                   MOVEL(P)  YL0042        PAVFST                         Shrink Wrap
     C                   MOVEL(P)  YL0046        PAVGST                         Slip Sheet
     C                   EVAL      PARPCD = ' '                                 Age Code
     C                   Z-ADD     WARNNB        PARNNB                         Reefer Temperat
     C                   MOVEL(P)  YL0040        PAVDST                         Load Type
     C                   Z-ADD     *ZERO         PAATIN                         Attach to Invoi
     C                   MOVEL(P)  'Y'           PAU4ST                         Load Plan Order
     C                   MOVEL(P)  'Y'           PAU5ST                         Print Pick Slip
     C                   Z-ADD     *ZERO         PARSRN                         Resell Referenc
     C                   EVAL      PAMHNA = ' '                                 Special Comment
     C                   EVAL      PAMINA = ' '                                 Special Comment
     C                   MOVEL(P)  'Y'           PAWBST                         Affect Auto Acc
     C                   MOVEL(P)  YL0025        PAR4CD                         Sales Route Cod
     C                   MOVEL(P)  YL0034        PABFCD                         Manager Level C
     C                   MOVEL(P)  YL0035        PAQ4CD                         VP Level Code
     C                   Z-ADD     *ZERO         PAT3NB                         Attach to Order
     C                   EVAL      PASICD = ' '                                 Reason for Pric
     C                   Z-ADD     *ZERO         PACONB                         Invoice Number
     C                   EVAL      PACEST = ' '                                 Invoice Suffix
     C                   Z-ADD     *ZERO         PAAWDT                         Invoice Date
     C                   MOVEL(P)  '01'          PAJPCD                         Event Code
     C                   MOVEL(P)  YL0056        PAXUST                         Trans Contol AS
     C                   EVAL      PAZ1ST = ' '                                 Modified Flag
     C                   Z-ADD     *ZERO         PAVRVA                         A_R order Value
     C                   MOVEL(P)  YL0050        PAOBST                         Billing Activit
     C                   MOVEL(P)  'B'           PABCST                         Block Order Fla
     C                   EVAL      PABDST = ' '                                 Order Certifica
     C                   Z-ADD     *ZERO         PAB7VL                         Invoice Order V
     C                   EVAL      PAGASX = ' '                                 Process Sts for
     C                   EVAL      PAGBSX = ' '                                 Order Conf Fax
     C                   EVAL      PAGCSX = ' '                                 Manifest Fax St
     C                   EVAL      PAGDSX = ' '                                 Invoice Fax Sts
     C                   MOVEL(P)  'N'           PAFNSX                         Transfer in Sto
     C                   MOVEL(P)  YL0013        PAFOSX                         Email Cust On O
     C                   EVAL      PAFPSX = ' '                                 Order Emailed
     C                   MOVEL(P)  WAFQSX        PAFQSX                         Export Docs Go
     C                   MOVEL(P)  YL0057        PAFRSX                         Shipping Temp C
     C                   EVAL      PAFSSX = ' '                                 Broker Order St
     C                   MOVEL(P)  YL0014        PAFTSX                         Air Freight Ord
     C                   EVAL      PAFUSX = ' '                                 Order Requires
     C                   EVAL      PAFVSX = ' '                                 OH Load Plan Re
     C                   EVAL      PAFWSX = ' '                                 Export USDA App
     C                   EVAL      PAFXSX = ' '                                 HPB Ship to War
     C                   EVAL      PAFYSX = ' '                                 OH TF Exempt Co
     C                   Z-ADD     *ZERO         PANODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         PANPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         PANQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         PANRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         PANSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         PABPTM                         Maximum Gross W
     C                   Z-ADD     ##ETM         PABQTM                         Time of Origina
     C                   Z-ADD     *ZERO         PABRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         PABSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         PABTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         PAH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         PAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         PAH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         PAH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         PAH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         PAC0C7                         Claim Number
     C                   EVAL      PAUVST = ' '                                 EDI Status 1
     C                   EVAL      PAUWST = ' '                                 EDI Status 2
     C                   EVAL      PAUXST = ' '                                 EDI Status 3
      *
     C                   CALL      'PUZ6XFR'                            90      Crt Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PARC                           RCD: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUZ6XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'Y'           WN0001                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           WN0001                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * RTV Validate Blck Or Dtl - WF Block Order Upload Dtl  * Validate
     C                   EXSR      SNRVGN
      * ** If Header passed, but Dtl didn't, Override Par to No.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Hdr/Dtl Validation Pass U is Yes
      *   |- c2    : LCL.Hdr/Dtl Validation Pass U is No
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WN0001 = 'Y'
     C                   IF        YL0002 = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'N'           WN0001                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Update Error Code in the Header.
      * CASE: PAR.Hdr/Dtl Validation Pass U is No
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * Update E
      * Move input parameters to subroutine local variables.
     C                   IF        WN0001 = 'N'
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     WAC4NB        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'E'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   END                                                    *FI
      * ** Check the error file for any errors.  If none, write records.
      * RTV Chk Existence      RT - WF Block Order Errors  * 
     C                   EXSR      SXRVGN
      * ** If no Error, Write from Qtemp to Permanent files.
      * CASE: PGM.*Return code is *Normal
      * DLT Block Order Qtemp XF - Order Header TRG  * 
     C                   IF        W0RTN = ' '
     C                   CLEAR                   PGRC
     C                   Z-ADD     WAAIC3        PGAIC3                         Company Number
     C                   Z-ADD     9999999       PGC4NB                         Order Number
      *
     C                   CALL      'PVBMXFR'                            90      DLT Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PGRC                           KEY: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVBMXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * DLT Block Order Qtemp XF - Order Detail  * 
     C                   CLEAR                   PHRC
     C                   Z-ADD     WAAIC3        PHAIC3                         Company Number
     C                   Z-ADD     9999999       PHC4NB                         Order Number
      *
     C                   CALL      'PVBNXFR'                            90      DLT Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PHRC                           KEY: Order Deta
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVBNXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     YL0164        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'Y'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Execute message
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   CALL      'Y2EXMCC'                            90      *
     C                   PARM      *BLANK        W0RTN                          Return code
     C                   PARM      'USR2787'     ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSGF = ' '
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   END
      *
      * Error detected during execution
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      *
      * EXC Command DLTF       UP - /UT User Programs  * 
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0593                         Library
     C                   PARM      @CN(187)      WQ0594                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * 
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0595                         Library
     C                   PARM      @CN(188)      WQ0596                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CPY Copy Order Temp Block - Order Header TRG  * Copy to Perm File
     C                   CALL      'PVEZXFR'                            90      CPY Copy Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0597                         Company Number
     C                   PARM      9999999       WQ0598                         Order Number
     C                   PARM      'OR'          WQ0599                         Order Type_Sale
     C     YL0164        PARM      YL0164        WQ0600                         Next Order Numb
     C                   PARM      WALWAA        WQ0601                         OHE Intended fo
     C                   PARM      YL0029        WQ0602                         Type Code
     C                   PARM      WAC3TX        WQ0603                         OHE Spot Buy
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVEZXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * RTV Crt Blck Ord Trns RT - WF Block Order Trans  * 
     C                   EXSR      SYRVGN
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     YL0164        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'Y'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
      * ** Delete records in Qtemp to prepare for the next record.
      * DLT Block Order Qtemp XF - Order Header TRG  * 
     C                   CLEAR                   PGRC
     C                   Z-ADD     WAAIC3        PGAIC3                         Company Number
     C                   Z-ADD     YL0164        PGC4NB                         Order Number
      *
     C                   CALL      'PVBMXFR'                            90      DLT Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PGRC                           KEY: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVBMXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * DLT Block Order Qtemp XF - Order Detail  * 
     C                   CLEAR                   PHRC
     C                   Z-ADD     WAAIC3        PHAIC3                         Company Number
     C                   Z-ADD     YL0164        PHC4NB                         Order Number
      *
     C                   CALL      'PVBNXFR'                            90      DLT Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PHRC                           KEY: Order Deta
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVBNXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     *ZERO         YL0164                         Next Order Numb
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * *** Order Number is Present so this is a change.
      * ** Remove files from QTEMP now that Adds have finished.
      * CASE: LCL.First Time Flag is Yes
      * Execute message
     C                   IF        YL0001 = 'Y'
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   CALL      'Y2EXMCC'                            90      *
     C                   PARM      *BLANK        W0RTN                          Return code
     C                   PARM      'USR2787'     ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSGF = ' '
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   END
      *
      * Error detected during execution
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      *
      * EXC Command DLTF       UP - /UT User Programs  * OPBFCPL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0604                         Library
     C                   PARM      @CN(189)      WQ0605                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPBFCPN*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0606                         Library
     C                   PARM      @CN(190)      WQ0607                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPBFCPN*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0608                         Library
     C                   PARM      @CN(191)      WQ0609                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPBFCPP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0610                         Library
     C                   PARM      @CN(192)      WQ0611                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPBGWKN*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0612                         Library
     C                   PARM      @CN(193)      WQ0613                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPBGWKL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0614                         Library
     C                   PARM      @CN(194)      WQ0615                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPBGWKL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0616                         Library
     C                   PARM      @CN(195)      WQ0617                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPBGWKP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0618                         Library
     C                   PARM      @CN(196)      WQ0619                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OMCRWKL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0620                         Library
     C                   PARM      @CN(197)      WQ0621                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OMCRWKP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0622                         Library
     C                   PARM      @CN(198)      WQ0623                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPCPCPL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0624                         Library
     C                   PARM      @CN(199)      WQ0625                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * OPCPCPP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0626                         Library
     C                   PARM      @CN(200)      WQ0627                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PDIECPL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0628                         Library
     C                   PARM      @CN(201)      WQ0629                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PDIECPP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0630                         Library
     C                   PARM      @CN(202)      WQ0631                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PDMRREL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0632                         Library
     C                   PARM      @CN(203)      WQ0633                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PDMRREP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0634                         Library
     C                   PARM      @CN(204)      WQ0635                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PNGTCPL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0636                         Library
     C                   PARM      @CN(205)      WQ0637                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PNGTCPP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0638                         Library
     C                   PARM      @CN(206)      WQ0639                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PDMSREL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0640                         Library
     C                   PARM      @CN(207)      WQ0641                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PDMSREP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0642                         Library
     C                   PARM      @CN(208)      WQ0643                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PUA6CPL*
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0644                         Library
     C                   PARM      @CN(209)      WQ0645                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * EXC Command DLTF       UP - /UT User Programs  * PUA6CPP
     C                   CALL      'PDUHUPR'                            90      EXC Command DLT
     C                   PARM      'QTEMP'       WQ0646                         Library
     C                   PARM      @CN(210)      WQ0647                         File
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDUHUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0001                         First Time Flag
     C                   END                                                    *FI
      * CASE: DB1.Header Status is Change Record
      * RTV All Fields         RT - Order Header TRG  * Check Order Statu
      * Move input parameters to subroutine local variables.
     C                   IF        WAGWST = 'N'
     C                   Z-ADD     WAAIC3        WL0150                         Company Number
     C                   Z-ADD     WAC4NB        WL0151                         Order Number
     C                   EXSR      TARVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0152        YL0165                         Order Type_Sale
     C                   Z-ADD     WL0153        YL0012                         AR Customer Num
     C                   Z-ADD     WL0154        YL0166                         Ship To Custome
     C                   MOVEL(P)  WL0155        YL0005                         Ship To Name
     C                   MOVEL(P)  WL0156        YL0006                         Ship To Address
     C                   MOVEL(P)  WL0157        YL0007                         Ship To Address
     C                   MOVEL(P)  WL0158        YL0008                         Ship To Address
     C                   MOVEL(P)  WL0159        YL0009                         Ship To City
     C                   MOVEL(P)  WL0160        YL0010                         Ship To State C
     C                   MOVEL(P)  WL0161        YL0011                         Ship To Zip_Pos
     C                   Z-ADD     WL0162        YL0167                         Bill to Custome
     C                   MOVEL(P)  WL0163        YL0015                         Bill to Name
     C                   MOVEL(P)  WL0164        YL0016                         Bill to Address
     C                   MOVEL(P)  WL0165        YL0017                         Bill to Address
     C                   MOVEL(P)  WL0166        YL0018                         Bill to Address
     C                   MOVEL(P)  WL0167        YL0019                         Bill to City
     C                   MOVEL(P)  WL0168        YL0020                         Bill to State C
     C                   MOVEL(P)  WL0169        YL0021                         Bill to Zip_Pos
     C                   MOVEL(P)  WL0170        YL0168                         Customer Purcha
     C                   Z-ADD     WL0171        YL0169                         Order Date
     C                   Z-ADD     WL0172        YL0060                         Requested Ship
     C                   Z-ADD     WL0173        YL0170                         Actual Shipped
     C                   Z-ADD     WL0174        YL0171                         Cancel Date
     C                   MOVEL(P)  WL0175        YL0024                         Terms Code
     C                   MOVEL(P)  WL0176        YL0027                         Special Instruc
     C                   MOVEL(P)  WL0177        YL0026                         Special Instruc
     C                   MOVEL(P)  WL0178        YL0172                         Carrier Code
     C                   MOVEL(P)  WL0179        YL0173                         Comment Print A
     C                   MOVEL(P)  WL0180        YL0174                         Comment Print I
     C                   MOVEL(P)  WL0181        YL0175                         Comment Print P
     C                   MOVEL(P)  WL0182        YL0176                         Comment Print S
     C                   MOVEL(P)  WL0183        YL0177                         Reason Code
     C                   MOVEL(P)  WL0184        YL0178                         Order in Use
     C                   MOVEL(P)  WL0185        YL0179                         Header Status
     C                   MOVEL(P)  WL0186        YL0180                         Header Status L
     C                   MOVEL(P)  WL0187        YL0181                         Order Type Prin
     C                   Z-ADD     WL0188        YL0182                         Scheduled Ship
     C                   MOVEL(P)  WL0189        YL0183                         User Original E
     C                   Z-ADD     WL0190        YL0184                         Date of Origina
     C                   Z-ADD     WL0191        YL0185                         Order Value Tot
     C                   Z-ADD     WL0192        YL0186                         Order Weight To
     C                   MOVEL(P)  WL0193        YL0187                         Credit Hold
     C                   MOVEL(P)  WL0194        YL0188                         Production Hold
     C                   MOVEL(P)  WL0195        YL0189                         New Customer Ho
     C                   Z-ADD     WL0196        YL0190                         Requested Deliv
     C                   Z-ADD     WL0197        YL0028                         Requested Deliv
     C                   MOVEL(P)  WL0198        YL0191                         Accounts Receiv
     C                   MOVEL(P)  WL0199        YL0192                         Accounts Receiv
     C                   Z-ADD     WL0200        YL0193                         Load ID
     C                   Z-ADD     WL0201        YL0030                         Absorbed Freigh
     C                   Z-ADD     WL0202        YL0194                         Rated Freight
     C                   MOVEL(P)  WL0203        YL0041                         LTL Flag
     C                   MOVEL(P)  WL0204        YL0195                         Price Audit
     C                   MOVEL(P)  WL0205        YL0196                         Price Status
     C                   MOVEL(P)  WL0206        YL0047                         Shipping Method
     C                   MOVEL(P)  WL0207        YL0197                         Export Status
     C                   MOVEL(P)  WL0208        YL0044                         Palletize
     C                   MOVEL(P)  WL0209        YL0042                         Shrink Wrap
     C                   MOVEL(P)  WL0210        YL0046                         Slip Sheet
     C                   MOVEL(P)  WL0211        YL0198                         Age Code
     C                   Z-ADD     WL0212        YL0199                         Reefer Temperat
     C                   MOVEL(P)  WL0213        YL0200                         Load Type
     C                   Z-ADD     WL0214        YL0201                         Attach to Invoi
     C                   MOVEL(P)  WL0215        YL0202                         Load Plan Order
     C                   MOVEL(P)  WL0216        YL0203                         Print Pick Slip
     C                   Z-ADD     WL0217        YL0204                         Resell Referenc
     C                   MOVEL(P)  WL0218        YL0205                         Special Comment
     C                   MOVEL(P)  WL0219        YL0206                         Special Comment
     C                   MOVEL(P)  WL0220        YL0207                         Affect Auto Acc
     C                   MOVEL(P)  WL0221        YL0025                         Sales Route Cod
     C                   MOVEL(P)  WL0222        YL0034                         Manager Level C
     C                   MOVEL(P)  WL0223        YL0035                         VP Level Code
     C                   Z-ADD     WL0224        YL0208                         Attach to Order
     C                   MOVEL(P)  WL0225        YL0209                         Reason for Pric
     C                   Z-ADD     WL0226        YL0210                         Invoice Number
     C                   MOVEL(P)  WL0227        YL0211                         Invoice Suffix
     C                   Z-ADD     WL0228        YL0212                         Invoice Date
     C                   MOVEL(P)  WL0229        YL0213                         Event Code
     C                   MOVEL(P)  WL0230        YL0056                         Trans Contol AS
     C                   MOVEL(P)  WL0231        YL0214                         Modified Flag
     C                   Z-ADD     WL0232        YL0215                         A_R order Value
     C                   MOVEL(P)  WL0233        YL0050                         Billing Activit
     C                   MOVEL(P)  WL0234        YL0216                         Block Order Fla
     C                   MOVEL(P)  WL0235        YL0217                         Order Certifica
     C                   Z-ADD     WL0236        YL0218                         Invoice Order V
     C                   MOVEL(P)  WL0237        YL0219                         Process Sts for
     C                   MOVEL(P)  WL0238        YL0220                         Order Conf Fax
     C                   MOVEL(P)  WL0239        YL0221                         Manifest Fax St
     C                   MOVEL(P)  WL0240        YL0222                         Invoice Fax Sts
     C                   MOVEL(P)  WL0241        YL0223                         Transfer in Sto
     C                   MOVEL(P)  WL0242        YL0013                         Email Cust On O
     C                   MOVEL(P)  WL0243        YL0224                         Order Emailed
     C                   MOVEL(P)  WL0244        YL0225                         Export Docs Go
     C                   MOVEL(P)  WL0245        YL0226                         Shipping Temp C
     C                   MOVEL(P)  WL0246        YL0227                         Broker Order St
     C                   MOVEL(P)  WL0247        YL0014                         Air Freight Ord
     C                   MOVEL(P)  WL0248        YL0228                         Order Requires
     C                   MOVEL(P)  WL0249        YL0229                         OH Load Plan Re
     C                   MOVEL(P)  WL0250        YL0230                         Export USDA App
     C                   MOVEL(P)  WL0251        YL0059                         HPB Ship to War
     C                   MOVEL(P)  WL0252        YL0231                         OH TF Exempt Co
     C                   Z-ADD     WL0253        YL0232                         OH Appt Confirm
     C                   Z-ADD     WL0254        YL0233                         JPN Invoice Iss
     C                   Z-ADD     WL0255        YL0234                         Load Actual Shi
     C                   Z-ADD     WL0256        YL0235                         Load BOL Comple
     C                   Z-ADD     WL0257        YL0236                         Load Truck Depa
     C                   Z-ADD     WL0258        YL0237                         Maximum Gross W
     C                   Z-ADD     WL0259        YL0238                         Time of Origina
     C                   Z-ADD     WL0260        YL0239                         OH Appt Confirm
     C                   Z-ADD     WL0261        YL0240                         Load BOL Comple
     C                   Z-ADD     WL0262        YL0241                         Load Truck Depa
     C                   Z-ADD     WL0263        YL0242                         Act Frt Referen
     C                   Z-ADD     WL0264        YL0243                         Act Non_Ref Frt
     C                   Z-ADD     WL0265        YL0244                         OH Fuel Surchar
     C                   Z-ADD     WL0266        YL0245                         OH Total Non_Re
     C                   Z-ADD     WL0267        YL0246                         OH Total Ref Fr
     C                   Z-ADD     WL0268        YL0247                         Claim Number
     C                   MOVEL(P)  WL0269        YL0248                         EDI Status 1
     C                   MOVEL(P)  WL0270        YL0249                         EDI Status 2
     C                   MOVEL(P)  WL0271        YL0250                         EDI Status 3
     C                   Z-ADD     WL0272        YL0251                         Job Time
     C                   MOVEL(P)  WL0273        YL0252                         User Id
     C                   MOVEL(P)  WL0274        YL0253                         Job Name
     C                   Z-ADD     WL0275        YL0254                         Job Date
      * *** Order must still be a Block Order
      * CASE: LCL.Block Order Flag is Not Block Order
     C                   IF        YL0216 = ' ' OR
     C                             YL0216 = 'F' OR
     C                             YL0216 = 'N' OR
     C                             YL0216 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(211)      CAT(P)    @CN(212):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0648                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0649                         Order Number
     C                   PARM      'ORDFRM'      WQ0650                         BOE Error Reaso
     C                   PARM      YL0004        WQ0651                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** Order can't be Firmed or Complete.
      * CASE: LCL.Header Status is Confirmed & Complete
     C                   IF        YL0179 = 'C' OR
     C                             YL0179 = 'R'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(213)      CAT(P)    @CN(214):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0652                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0653                         Order Number
     C                   PARM      'ORDCOM'      WQ0654                         BOE Error Reaso
     C                   PARM      YL0004        WQ0655                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** Order can't be in use.
      * CASE: LCL.Order in Use is yes
     C                   IF        YL0178 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(215)      CAT(P)    @CN(216):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0656                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0657                         Order Number
     C                   PARM      'INUSE'       WQ0658                         BOE Error Reaso
     C                   PARM      YL0004        WQ0659                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** Order cannot have been updated after the upload.
      * CASE: *OTHERWISE
      * CASE: LCL.Job Date GT DB1.Create Date
     C                   IF        YL0254 > WAMJDT
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(217)      CAT(P)    @CN(218):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0660                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0661                         Order Number
     C                   PARM      'ORDUPD'      WQ0662                         BOE Error Reaso
     C                   PARM      YL0004        WQ0663                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     YL0002        YL0255                         Hdr/Dtl Validat
      * *** Test Header chg date against all Dtl lines
      * VAL Block Ord Dates - Order Detail  * 
     C                   EXSR      TBRVGN
      * CASE: LCL.Hdr/Dtl Validation Pass U is No
     C                   IF        YL0002 = 'N'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(219)      CAT(P)    @CN(220):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0664                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0665                         Order Number
     C                   PARM      'ORDUPD'      WQ0666                         BOE Error Reaso
     C                   PARM      YL0004        WQ0667                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Hdr/Dtl Validation PassSv is No
     C                   IF        YL0255 = 'N'
     C                   MOVEL     YL0255        YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV All Blk Ord Trns  RT - WF Block Order Trans  * Get Order for
     C                   EXSR      TCRVGN
      * *** Surrogate must be the same as the original
      * CASE:
      *  - (NOT c1) OR c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : LCL.Order Number NE DB1.Order Number
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        W0RTN = ' '
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   IF        Y0CX01 <> '1'
     C                   IF        YL0256 <> WAC4NB
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(221)      CAT(P)    ' ':ZQ        YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0668                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0669                         Order Number
     C                   PARM      'MISMAT'      WQ0670                         BOE Error Reaso
     C                   PARM      YL0004        WQ0671                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** Validate Spot Buy
      * CASE: DB1.OHE Spot Buy is Valid Values
     C                   IF        WAC3TX = 'P' OR
     C                             WAC3TX = 'S' OR
     C                             WAC3TX = 'T'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(044)      CAT(P)    ' ':ZQ        YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0672                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0673                         Order Number
     C                   PARM      'SPTBUY'      WQ0674                         BOE Error Reaso
     C                   PARM      YL0004        WQ0675                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** WI546_2 Validate shipping date
      * CASE:
      *  - c1 AND c2 AND (c3 OR c4)
      *   |- c1    : DB1.Requested Ship Date is entered
      *   |- c2    : DB1.Requested Delivery Date is entered
      *   |- c3    : DB1.Shipping Method is Prepaid
      *   |- c4    : LCL.Shipping Method is Prepaid
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WAA5DT <> 0
     C                   IF        WAEIDT <> 0
     C                   MOVEL     '0'           Y0CX02
     C                   IF        WAQ2CD = 'PR' OR
     C                             WAQ2CD = 'PT' OR
     C                             YL0047 = 'PR' OR
     C                             YL0047 = 'PT'
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * *** WI546_2 Validate Requested Ship Date
      * CASE: DB1.Requested Ship Date is entered
     C                   IF        Y0CX01 = '1'
      * ** Saving the date to pass into the Detail validation.
     C                   IF        WAA5DT <> 0
     C                   Z-ADD     WAA5DT        YL0060                         Requested Ship
      * RTV Calendar           RT - Calendar  * See if date exists
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0051                         Company Number
     C                   Z-ADD     WAA5DT        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * ** if Requested Ship Date is in Calendar
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   EVAL      YL0061 = ' '                                 Date From Conve
     C                   MOVEL     WAA5DT        YL0061                         Date From Conve
     C                   EVAL      YL0062 = ' '                                 Text usr 11
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0061        WQ0676                         Date From Conve
     C     YL0062        PARM      *BLANK        WQ0677                         Date To Convert
     C                   PARM      '*CYMD'       WQ0678                         Date From Forma
     C                   PARM      '*YYMD'       WQ0679                         Date To Format
     C                   PARM      '*NONE'       WQ0680                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0062 = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     WAA5DT        YL0060                         Requested Ship
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PGM.*Return code is Calendar not found
      * ** 1019801 JM - WI546_2 Make sure RSD is present in Calendar.
      * CASE: PGM.*Return code is Calendar not found
     C                   IF        W0RTN = @CN(055)
     C                   IF        W0RTN = @CN(055)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(222)      CAT(P)    @CN(057):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0681                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0682                         Order Number
     C                   PARM      'INVDAT'      WQ0683                         BOE Error Reaso
     C                   PARM      YL0004        WQ0684                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * *** WI546_2 Validate Requested Delivery Date
      * CASE: DB1.Requested Delivery Date is entered
     C                   IF        WAEIDT <> 0
     C                   EVAL      YL0062 = ' '                                 Text usr 11
     C                   EVAL      YL0061 = ' '                                 Date From Conve
     C                   MOVEL     WAEIDT        YL0061                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0061        WQ0685                         Date From Conve
     C     YL0062        PARM      *BLANK        WQ0686                         Date To Convert
     C                   PARM      '*CYMD'       WQ0687                         Date From Forma
     C                   PARM      '*YYMD'       WQ0688                         Date To Format
     C                   PARM      '*NONE'       WQ0689                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0062 = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     WAEIDT        YL0190                         Requested Deliv
     C                   END                                                    *FI
      * ** 1019801 JM - WI546_2 Make sure RDD is present in Calendar.
      * CASE: *OTHERWISE
      * RTV Calendar           RT - Calendar Master  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0051                         Company Number
     C                   Z-ADD     WAEIDT        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * CASE: PGM.*Return code is Calendar not found
     C                   IF        W0RTN = @CN(055)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(056)      CAT(P)    @CN(057):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0690                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0691                         Order Number
     C                   PARM      'INVDEL'      WQ0692                         BOE Error Reaso
     C                   PARM      YL0004        WQ0693                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   MOVEL     WAAJCD        YL0065                         Warehouse Code
      * CLC Must Ship 4 Req DlvXF - Order Header TRG  * 
     C                   CALL      'PMUSXFR'                            90      CLC Must Ship 4
     C                   PARM      *BLANK        W0RTN
     C     YL0066        PARM      *BLANK        WQ0694                         Must Ship Error
     C                   PARM      WAC4NB        WQ0695                         Order Number
     C                   PARM      YL0060        WQ0696                         Requested Ship
     C                   PARM      YL0009        WQ0697                         Ship To City
     C                   PARM      YL0010        WQ0698                         Ship To State C
     C                   PARM      WAAIC3        WQ0699                         Company Number
     C                   PARM      YL0028        WQ0700                         Requested Deliv
     C                   PARM      YL0060        WQ0701                         Scheduled Ship
     C                   PARM      YL0190        WQ0702                         Requested Deliv
     C     YL0065        PARM      YL0065        WQ0703                         Warehouse Code
     C     YL0067        PARM      YL0067        WQ0704                         Must Ship Date
     C     YL0068        PARM      YL0068        WQ0705                         Must Ship Time
     C                   PARM      *ZERO         WQ0706                         USR Order Numbe
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PMUSXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Must Ship Error is Miles to Next=Zeros
     C                   IF        YL0066 = 'MTN'
     C                   EVAL      YL0066 = ' '                                 Must Ship Error
     C                   ELSE
      * CASE: *OTHERWISE
      * PMT Must Ship Err Msg  IF
     C                   EVAL      YL0069 = ' '                                 Explaination Te
      * CASE: PAR.Must Ship Error is No Error
     C                   IF        YL0066 = ' '
     C                   ELSE
      * CASE: PAR.Must Ship Error is Must Ship before NOW
     C                   IF        YL0066 = 'NOW'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(059)      YL0069                         Explaination Te
     C                   Z-ADD     *ZERO         ZQ
     C     YL0069        CAT(P)    @CN(060):ZQ   YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Deadline not bef Delivery
     C                   IF        YL0066 = 'DDD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(061)      YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Must Shp not bef Deadline
     C                   IF        YL0066 = 'MSD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(062)      YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Schd Shp not bef Must Shp
     C                   IF        YL0066 = 'SSD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(063)      YL0069                         Explaination Te
     C                   Z-ADD     *ZERO         ZQ
     C     YL0069        CAT(P)    ' Ship':ZQ    YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Miles to Next=Zeros
     C                   IF        YL0066 = 'MTN'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(064)      YL0069                         Explaination Te
     C                   ELSE
      * CASE: PAR.Must Ship Error is Req Ship should =Must Shp
     C                   IF        YL0066 = 'RSD'
     C                   EVAL      YL0069 = ' '                                 Explaination Te
     C                   MOVEL     @CN(065)      YL0069                         Explaination Te
     C                   Z-ADD     *ZERO         ZQ
     C     YL0069        CAT(P)    @CN(066):ZQ   YL0069                         Explaination Te
     C                   ELSE
      * CASE: *OTHERWISE
      * --- unexpected error ---
      * PAR.Explaination Text 1 = Condition name of PAR.Must Ship Error
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1519963       Y2LSNO                         List number
     C                   PARM      YL0066        W0INVL                         Must Ship Error
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     YL0069        PARM                    W0CNNM                         Explaination Te
      *
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: LCL.Must Ship Error is Error List
      * Populate error message text
      * CASE: *OTHERWISE
      * Convert 6,0 HHMMSS format to 4,0 HHMM time format.
      * CASE: *OTHERWISE
     C                   IF        YL0066 = 'DDD' OR
     C                             YL0066 = 'MTN' OR
     C                             YL0066 = 'NOW' OR
     C                             YL0066 = 'MSD' OR
     C                             YL0066 = 'RSD' OR
     C                             YL0066 = 'SSD'
     C                   EVAL      YL0038 = ' '                                 Time Alpha usr
     C                   MOVEL     YL0068        YL0038                         Time Alpha usr
     C                   Z-ADD     4             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00006 OR
     C                             ZQ > 00006
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0038:ZQ     YL0039                 90      Time HHMM Alpha
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   EVAL      YL0070 = ' '                                 USR Work Field
     C                   MOVEL     YL0067        YL0070                         USR Work Field
     C                   Z-ADD     6             YRSW00
     C                   Z-ADD     2             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00007 OR
     C                             ZQ > 00007
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0070:ZQ     YL0071                 90      USR Date Alpha
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     1             ZQ
     C     @CN(067)      CAT(P)    @CN(068):ZQ   YL0004                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    YL0071:ZQ     YL0004                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    YL0039:ZQ     YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0707                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ0708                         Order Number
     C                   PARM      'INVDAT'      WQ0709                         BOE Error Reaso
     C                   PARM      YL0004        WQ0710                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * *** If no errors so far, continue validating Header & Details
      * CASE: LCL.Hdr/Dtl Validation Pass U is Yes
     C                   IF        YL0002 = 'Y'
     C                   Z-ADD     WAA5DT        YL0060                         Requested Ship
      * ** Keep scheduled & requested ship date in sync.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Requested Ship Date is entered
      *   |- c2    : LCL.Requested Ship Date NE LCL.Scheduled Ship Date
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0060 <> 0
     C                   IF        YL0060 <> YL0182
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     YL0060        YL0182                         Scheduled Ship
     C                   END                                                    *FI
     C                   MOVEL     WAVEST        YL0044                         Palletize
     C                   MOVEL     WAVGST        YL0046                         Slip Sheet
     C                   MOVEL     WAQ2CD        YL0047                         Shipping Method
     C                   Z-ADD     WARNNB        YL0199                         Reefer Temperat
     C                   Z-ADD     WAEIDT        YL0190                         Requested Deliv
     C                   MOVEL     WAVFST        YL0042                         Shrink Wrap
      * VAL Block Header chgs RT - Order Header TRG  * Validate Changes
     C                   EXSR      TDRVGN
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     WAC4NB        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'Y'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   MOVEL     YL0002        WN0001                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** If all error testing is passed, update the record(s).
      * CASE: Update Header if no errors and a change detected.
      *  - c1 AND c2
      *   |- c1    : LCL.Hdr/Dtl Validation Pass U is Yes
      *   |- c2    : LCL.Change Flag USR is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0002 = 'Y'
     C                   IF        YL0257 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV If Item Not Cancelled - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WAAIC3        WL0445                         Company Number
     C                   Z-ADD     WAC4NB        WL0446                         Order Number
     C                   EXSR      TNRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0447        YL0470                         USR Return Code
      * CASE: LCL.USR Return Code is Does Not Exist
      * Chg Order Header WRK  CH1 - Order Header TRG  * 
     C                   IF        YL0470 = 'N'
     C                   EXSR      TSCHRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Chg Order Header WRK  CH - Order Header TRG  * 
     C                   EXSR      TUCHRC
     C                   END                                                    *FI
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     WAC4NB        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'Y'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   MOVEL     YL0002        WN0001                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Hdr/Dtl Validation Pass U is No
     C                   IF        YL0002 = 'N'
     C                   MOVEL     YL0002        WN0001                         Hdr/Dtl Validat
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     WAC4NB        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'Y'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: DB1.Header Status is Cancelled
      * RTV All Fields         RT - Order Header TRG  * Check Order Statu
      * Move input parameters to subroutine local variables.
     C                   IF        WAGWST = 'X'
     C                   Z-ADD     WAAIC3        WL0150                         Company Number
     C                   Z-ADD     WAC4NB        WL0151                         Order Number
     C                   EXSR      TARVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0152        YN0266                         Order Type_Sale
     C                   Z-ADD     WL0153        YN0267                         AR Customer Num
     C                   Z-ADD     WL0154        YN0268                         Ship To Custome
     C                   MOVEL(P)  WL0155        YN0269                         Ship To Name
     C                   MOVEL(P)  WL0156        YN0270                         Ship To Address
     C                   MOVEL(P)  WL0157        YN0271                         Ship To Address
     C                   MOVEL(P)  WL0158        YN0272                         Ship To Address
     C                   MOVEL(P)  WL0159        YN0273                         Ship To City
     C                   MOVEL(P)  WL0160        YN0274                         Ship To State C
     C                   MOVEL(P)  WL0161        YN0275                         Ship To Zip_Pos
     C                   Z-ADD     WL0162        YN0276                         Bill to Custome
     C                   MOVEL(P)  WL0163        YN0277                         Bill to Name
     C                   MOVEL(P)  WL0164        YN0278                         Bill to Address
     C                   MOVEL(P)  WL0165        YN0279                         Bill to Address
     C                   MOVEL(P)  WL0166        YN0280                         Bill to Address
     C                   MOVEL(P)  WL0167        YN0281                         Bill to City
     C                   MOVEL(P)  WL0168        YN0282                         Bill to State C
     C                   MOVEL(P)  WL0169        YN0283                         Bill to Zip_Pos
     C                   MOVEL(P)  WL0170        YN0284                         Customer Purcha
     C                   Z-ADD     WL0171        YN0285                         Order Date
     C                   Z-ADD     WL0172        YN0286                         Requested Ship
     C                   Z-ADD     WL0173        YN0287                         Actual Shipped
     C                   Z-ADD     WL0174        YN0288                         Cancel Date
     C                   MOVEL(P)  WL0175        YN0289                         Terms Code
     C                   MOVEL(P)  WL0176        YN0290                         Special Instruc
     C                   MOVEL(P)  WL0177        YN0291                         Special Instruc
     C                   MOVEL(P)  WL0178        YN0037                         Carrier Code
     C                   MOVEL(P)  WL0179        YN0292                         Comment Print A
     C                   MOVEL(P)  WL0180        YN0293                         Comment Print I
     C                   MOVEL(P)  WL0181        YN0294                         Comment Print P
     C                   MOVEL(P)  WL0182        YN0295                         Comment Print S
     C                   MOVEL(P)  WL0183        YN0296                         Reason Code
     C                   MOVEL(P)  WL0184        YL0178                         Order in Use
     C                   MOVEL(P)  WL0185        YL0179                         Header Status
     C                   MOVEL(P)  WL0186        YN0297                         Header Status L
     C                   MOVEL(P)  WL0187        YN0298                         Order Type Prin
     C                   Z-ADD     WL0188        YN0299                         Scheduled Ship
     C                   MOVEL(P)  WL0189        YN0300                         User Original E
     C                   Z-ADD     WL0190        YN0301                         Date of Origina
     C                   Z-ADD     WL0191        YN0302                         Order Value Tot
     C                   Z-ADD     WL0192        YN0303                         Order Weight To
     C                   MOVEL(P)  WL0193        YN0304                         Credit Hold
     C                   MOVEL(P)  WL0194        YN0305                         Production Hold
     C                   MOVEL(P)  WL0195        YN0306                         New Customer Ho
     C                   Z-ADD     WL0196        YN0307                         Requested Deliv
     C                   Z-ADD     WL0197        YN0308                         Requested Deliv
     C                   MOVEL(P)  WL0198        YN0309                         Accounts Receiv
     C                   MOVEL(P)  WL0199        YN0310                         Accounts Receiv
     C                   Z-ADD     WL0200        YN0311                         Load ID
     C                   Z-ADD     WL0201        YN0312                         Absorbed Freigh
     C                   Z-ADD     WL0202        YN0313                         Rated Freight
     C                   MOVEL(P)  WL0203        YN0314                         LTL Flag
     C                   MOVEL(P)  WL0204        YN0315                         Price Audit
     C                   MOVEL(P)  WL0205        YN0316                         Price Status
     C                   MOVEL(P)  WL0206        YN0317                         Shipping Method
     C                   MOVEL(P)  WL0207        YN0318                         Export Status
     C                   MOVEL(P)  WL0208        YN0319                         Palletize
     C                   MOVEL(P)  WL0209        YN0320                         Shrink Wrap
     C                   MOVEL(P)  WL0210        YN0321                         Slip Sheet
     C                   MOVEL(P)  WL0211        YN0322                         Age Code
     C                   Z-ADD     WL0212        YN0323                         Reefer Temperat
     C                   MOVEL(P)  WL0213        YN0324                         Load Type
     C                   Z-ADD     WL0214        YN0325                         Attach to Invoi
     C                   MOVEL(P)  WL0215        YN0326                         Load Plan Order
     C                   MOVEL(P)  WL0216        YN0327                         Print Pick Slip
     C                   Z-ADD     WL0217        YN0328                         Resell Referenc
     C                   MOVEL(P)  WL0218        YN0329                         Special Comment
     C                   MOVEL(P)  WL0219        YN0330                         Special Comment
     C                   MOVEL(P)  WL0220        YN0331                         Affect Auto Acc
     C                   MOVEL(P)  WL0221        YN0332                         Sales Route Cod
     C                   MOVEL(P)  WL0222        YN0333                         Manager Level C
     C                   MOVEL(P)  WL0223        YN0334                         VP Level Code
     C                   Z-ADD     WL0224        YN0335                         Attach to Order
     C                   MOVEL(P)  WL0225        YN0336                         Reason for Pric
     C                   Z-ADD     WL0226        YN0337                         Invoice Number
     C                   MOVEL(P)  WL0227        YN0338                         Invoice Suffix
     C                   Z-ADD     WL0228        YN0339                         Invoice Date
     C                   MOVEL(P)  WL0229        YN0340                         Event Code
     C                   MOVEL(P)  WL0230        YN0341                         Trans Contol AS
     C                   MOVEL(P)  WL0231        YN0342                         Modified Flag
     C                   Z-ADD     WL0232        YN0343                         A_R order Value
     C                   MOVEL(P)  WL0233        YN0344                         Billing Activit
     C                   MOVEL(P)  WL0234        YL0216                         Block Order Fla
     C                   MOVEL(P)  WL0235        YN0345                         Order Certifica
     C                   Z-ADD     WL0236        YN0346                         Invoice Order V
     C                   MOVEL(P)  WL0237        YN0347                         Process Sts for
     C                   MOVEL(P)  WL0238        YN0348                         Order Conf Fax
     C                   MOVEL(P)  WL0239        YN0349                         Manifest Fax St
     C                   MOVEL(P)  WL0240        YN0350                         Invoice Fax Sts
     C                   MOVEL(P)  WL0241        YN0351                         Transfer in Sto
     C                   MOVEL(P)  WL0242        YN0352                         Email Cust On O
     C                   MOVEL(P)  WL0243        YN0353                         Order Emailed
     C                   MOVEL(P)  WL0244        YN0354                         Export Docs Go
     C                   MOVEL(P)  WL0245        YN0355                         Shipping Temp C
     C                   MOVEL(P)  WL0246        YN0356                         Broker Order St
     C                   MOVEL(P)  WL0247        YN0357                         Air Freight Ord
     C                   MOVEL(P)  WL0248        YN0358                         Order Requires
     C                   MOVEL(P)  WL0249        YN0359                         OH Load Plan Re
     C                   MOVEL(P)  WL0250        YN0360                         Export USDA App
     C                   MOVEL(P)  WL0251        YN0361                         HPB Ship to War
     C                   MOVEL(P)  WL0252        YN0362                         OH TF Exempt Co
     C                   Z-ADD     WL0253        YN0363                         OH Appt Confirm
     C                   Z-ADD     WL0254        YN0364                         JPN Invoice Iss
     C                   Z-ADD     WL0255        YN0365                         Load Actual Shi
     C                   Z-ADD     WL0256        YN0366                         Load BOL Comple
     C                   Z-ADD     WL0257        YN0367                         Load Truck Depa
     C                   Z-ADD     WL0258        YN0368                         Maximum Gross W
     C                   Z-ADD     WL0259        YN0369                         Time of Origina
     C                   Z-ADD     WL0260        YN0370                         OH Appt Confirm
     C                   Z-ADD     WL0261        YN0371                         Load BOL Comple
     C                   Z-ADD     WL0262        YN0372                         Load Truck Depa
     C                   Z-ADD     WL0263        YN0373                         Act Frt Referen
     C                   Z-ADD     WL0264        YN0374                         Act Non_Ref Frt
     C                   Z-ADD     WL0265        YN0375                         OH Fuel Surchar
     C                   Z-ADD     WL0266        YN0376                         OH Total Non_Re
     C                   Z-ADD     WL0267        YN0377                         OH Total Ref Fr
     C                   Z-ADD     WL0268        YN0378                         Claim Number
     C                   MOVEL(P)  WL0269        YN0030                         EDI Status 1
     C                   MOVEL(P)  WL0270        YN0031                         EDI Status 2
     C                   MOVEL(P)  WL0271        YN0032                         EDI Status 3
     C                   Z-ADD     WL0272        YN0033                         Job Time
     C                   MOVEL(P)  WL0273        YN0034                         User Id
     C                   MOVEL(P)  WL0274        YN0035                         Job Name
     C                   Z-ADD     WL0275        YN0036                         Job Date
      * *** Order can't be Firmed or Complete.
      * CASE: LCL.Header Status is Confirmed & Complete
     C                   IF        YL0179 = 'C' OR
     C                             YL0179 = 'R'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(213)      CAT(P)    @CN(214):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ1190                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ1191                         Order Number
     C                   PARM      'ORDCOM'      WQ1192                         BOE Error Reaso
     C                   PARM      YL0004        WQ1193                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
     C                   END                                                    *FI
      * LCL.From Date             USR = JOB.*Job exec start date + CON.-7
     C     ##ED7         ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     -7            XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0473
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0473
     C                   END
      * LCL.To Date               USR = JOB.*Job exec start date + CON.7
     C     ##ED7         ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     7             XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0474
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0474
     C                   END
      * *** Validate Cancel Date within 7 days.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Cancel Date LT LCL.From Date             USR
      *   |- c2    : DB1.Cancel Date GT LCL.To Date               USR
      *   '-
     C                   IF        WAACDT < YL0473 OR
     C                             WAACDT > YL0474
     C                   EVAL      YL0475 = ' '                                 Date 7A
     C                   MOVEL     WAACDT        YL0475                         Date 7A
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(229)      CAT(P)    @CN(230):ZQ   YL0004                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    YL0475:ZQ     YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ1194                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ1195                         Order Number
     C                   PARM      'INVDAT'      WQ1196                         BOE Error Reaso
     C                   PARM      YL0004        WQ1197                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** WI546_2-Validate Date format is CYMD
      * CASE: DB1.Cancel Date is entered
     C                   IF        WAACDT <> 0
     C                   EVAL      YL0062 = ' '                                 Text usr 11
     C                   EVAL      YL0061 = ' '                                 Date From Conve
     C                   MOVEL     WAACDT        YL0061                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0061        WQ1198                         Date From Conve
     C     YL0062        PARM      *BLANK        WQ1199                         Date To Convert
     C                   PARM      '*CYMD'       WQ1200                         Date From Forma
     C                   PARM      '*YYMD'       WQ1201                         Date To Format
     C                   PARM      '*NONE'       WQ1202                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0062 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(226)      CAT(P)    't.':ZQ       YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ1203                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ1204                         Order Number
     C                   PARM      'INVCAN'      WQ1205                         BOE Error Reaso
     C                   PARM      YL0004        WQ1206                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 1019801 JM - WI546_2 Make sure Cancel Date is present in Calen
      * CASE: DB1.Cancel Date is entered
      * RTV Calendar           RT - Calendar Master  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WAACDT <> 0
     C                   Z-ADD     WAAIC3        WL0051                         Company Number
     C                   Z-ADD     WAACDT        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * CASE: PGM.*Return code is Calendar not found
     C                   IF        W0RTN = @CN(055)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(227)      CAT(P)    @CN(228):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ1207                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ1208                         Order Number
     C                   PARM      'INVCAN'      WQ1209                         BOE Error Reaso
     C                   PARM      YL0004        WQ1210                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * *** S028944-JM-09/09/24-Log error if it is firm order.
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
     C                   EXSR      TVRVGN
      * CASE: LCL.Block Order Flag is Not Block Order
     C                   IF        YL0216 = ' ' OR
     C                             YL0216 = 'F' OR
     C                             YL0216 = 'N' OR
     C                             YL0216 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(232)      CAT(P)    @CN(233):ZQ   YL0004                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ1211                         Surrogate Numbe
     C                   PARM      WAC4NB        WQ1212                         Order Number
     C                   PARM      'ORDLOD'      WQ1213                         BOE Error Reaso
     C                   PARM      YL0004        WQ1214                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** Cancel the Order if no errors.
      * CASE: LCL.Hdr/Dtl Validation Pass U is Yes
      * RTV Cancel Order       RT - Order Header TRG  * 
     C                   IF        YL0002 = 'Y'
     C                   EXSR      TWRVGN
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     WAC4NB        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'Y'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        WL0120                         Company Number
     C                   Z-ADD     WAC4NB        WL0121                         Order Number
     C                   MOVEL(P)  WAGWST        WL0122                         Header Status
     C                   Z-ADD     WABKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     WAA5DT        WL0125                         Requested Ship
     C                   Z-ADD     WAACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  WAC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  WABCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  WAU2ST        WL0129                         Export Status
     C                   MOVEL(P)  WAKXCD        WL0130                         Country Code
     C                   MOVEL(P)  WALWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  WAFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  WAVEST        WL0133                         Palletize
     C                   MOVEL(P)  WAVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  WAQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     WARNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  'Y'           WL0137                         Record Processe
     C                   MOVEL(P)  WAOOSC        WL0138                         Email Sent
     C                   Z-ADD     WAEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  WAVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  WAVSST        WL0141                         Record Status
     C                   Z-ADD     WAMJDT        WL0142                         Create Date
     C                   Z-ADD     WABETM        WL0143                         Create Time
     C                   MOVEL(P)  WACCVN        WL0144                         Create User
     C                   MOVEL(P)  WACDVN        WL0145                         Create Program
     C                   Z-ADD     WAMKDT        WL0146                         Change Date
     C                   Z-ADD     WABFTM        WL0147                         Change Time
     C                   MOVEL(P)  WACEVN        WL0148                         Change User
     C                   MOVEL(P)  WACFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Send Error Emails  RT - WF Block Order Upload Hdr  * 
     C                   EXSR      TYRVGN
     C                   READ      @C2CPUM                                90    *
     C                   ENDDO
      * USER: Exit processing
      * Clear Qtemp work files.
      * CASE: *OTHERWISE
      * UPD Copy Order Templt2UP - /UT User Programs  * 
     C                   CALL      'PVAUUPC'                            90      UPD Copy Order
     C                   PARM      'D'           WQ1238                         Update Status T
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAUUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV Surogate is Present - WF Block Order Trans  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBHQNZ                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     WAHQNZ        WBHQNZ                         Surrogate Numbe
      * Establish starting position
     C     KRSSB         CHAIN     @C4CPMC                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5303'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
      * PAR = DB1 By name
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Val Company Exist     RT - Company Defaults Internal  * Check ex
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WCAIC3                         Company Number
      * Setup key
     C                   Z-ADD     WAAIC3        WCAIC3                         Company Number
      * Establish starting position
     C     KRSSC         CHAIN     @JYREEY                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2025'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * RTV Com Market        RT - Customer Master  * Chk Exist & RTV Pa
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WQSD01                         Ship To Custome
      * Setup key
     C                   Z-ADD     WABKC7        WQSD01                         Ship To Custome
      * Establish starting position
     C     KRSSD         SETLL     @BBREU3                                      *
     C     KRSSD         READE     @BBREU3                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0170'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0005 = ' '                                 Customer Name
     C                   EVAL      YL0006 = ' '                                 Address Line 1
     C                   EVAL      YL0007 = ' '                                 Address Line 2
     C                   EVAL      YL0008 = ' '                                 Address Line 3
     C                   EVAL      YL0009 = ' '                                 City
     C                   EVAL      YL0010 = ' '                                 State Code
     C                   EVAL      YL0011 = ' '                                 Zip Postal Code
     C                   Z-ADD     *ZERO         YL0012                         AR Customer Num
     C                   EVAL      YL0013 = ' '                                 Email When Orde
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WDAYTX        YL0005                         Customer Name
     C                   MOVEL     WDACNA        YL0006                         Address Line 1
     C                   MOVEL     WDADNA        YL0007                         Address Line 2
     C                   MOVEL     WDAENA        YL0008                         Address Line 3
     C                   MOVEL     WDAJNA        YL0009                         City
     C                   MOVEL     WDBGCD        YL0010                         State Code
     C                   MOVEL     WDBTTX        YL0011                         Zip Postal Code
     C                   Z-ADD     WDANC7        YL0012                         AR Customer Num
     C                   MOVEL     WDQWST        YL0013                         Email When Orde
     C     KRSSD         READE     @BBREU3                                90    *
     C                   ENDDO
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * Rtv Customer Air Frt  RT - Customer EXT  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WEBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     WABKC7        WEBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSE         CHAIN     @NEREAT                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2880'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0014 = ' '                                 Air Freight Ord
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WEP0SX        YL0014                         Air Freight Ord
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * Bill To
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WFBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     YL0012        WFBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSF         CHAIN     @BBREE9                            90        *
      * Data record not found
     C   90              MOVEL     'USR0170'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WFAYTX        YL0015                         Customer Name
     C                   MOVEL     WFACNA        YL0016                         Address Line 1
     C                   MOVEL     WFADNA        YL0017                         Address Line 2
     C                   MOVEL     WFAENA        YL0018                         Address Line 3
     C                   MOVEL     WFAJNA        YL0019                         City
     C                   MOVEL     WFBGCD        YL0020                         State Code
     C                   MOVEL     WFBTTX        YL0021                         Zip Postal Code
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * Rtv All - Customer EXT2  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0002 = ' '                                 M3 Supplier ID
     C                   EVAL      WL0003 = ' '                                 Dft Mode of Tra
     C                   EVAL      WL0004 = ' '                                 Buying Group
     C                   EVAL      WL0005 = ' '                                 Buying Group Op
     C                   EVAL      WL0006 = ' '                                 Ship To Establi
     C                   EVAL      WL0007 = ' '                                 PM Pallet Type
     C                   EVAL      WL0008 = ' '                                 Cust Dft Price
     C                   Z-ADD     *ZERO         WL0009                         Cust Dft Age Da
     C                   Z-ADD     *ZERO         WL0010                         Cust Dft Delive
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WGBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     WL0001        WGBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSG         CHAIN     @AAREY9                            90        *
      * Data record not found
     C   90              MOVEL     'USR4969'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WGVEAA        WL0002                         M3 Supplier ID
     C                   MOVEL     WGD9SC        WL0003                         Dft Mode of Tra
     C                   MOVEL     WGZZAA        WL0004                         Buying Group
     C                   MOVEL     WGK8SC        WL0005                         Buying Group Op
     C                   MOVEL     WGO1U1        WL0006                         Ship To Establi
     C                   MOVEL     WGLWSC        WL0007                         PM Pallet Type
     C                   MOVEL     WGAKAB        WL0008                         Cust Dft Price
     C                   Z-ADD     WGGANZ        WL0009                         Cust Dft Age Da
     C                   Z-ADD     WGEOTM        WL0010                         Cust Dft Delive
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * Val Country & Active   RT - Country Master  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0012 = ' '                                 Record Status
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    WHKXCD                         Country Code
      * Setup key
     C                   MOVEL     WL0011        WHKXCD                         Country Code
      * Establish starting position
     C     KRSSH         CHAIN     @E5REB8                            90        *
      * Data record not found
     C   90              MOVEL     'USR1158'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C                   IF        NOT *IN90
     C                   IF        WHVSST = 'A'
     C                   MOVEL     WHVSST        WL0012                         Record Status
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'I'           WL0012                         Record Status
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * Val Warehouse Exist   RT - Warehouse Codes  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    WIAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WAAJCD        WIAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSI         CHAIN     @ADRET1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SIEXIT
     C                   ENDIF
      *
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * RTV All               RT - Warehouse Codes  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    WJAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WL0013        WJAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSJ         CHAIN     @ADREAO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0014 = ' '                                 Warehouse Descr
     C                   EVAL      WL0015 = ' '                                 Address Line 1
     C                   EVAL      WL0016 = ' '                                 Address Line 2
     C                   EVAL      WL0017 = ' '                                 Address Line 3
     C                   EVAL      WL0018 = ' '                                 City
     C                   EVAL      WL0019 = ' '                                 Zip Postal Code
     C                   EVAL      WL0020 = ' '                                 Production Ware
     C                   EVAL      WL0021 = ' '                                 State Code
     C                   EVAL      WL0022 = ' '                                 Lot Tracking Fl
     C                   EVAL      WL0023 = ' '                                 Default Printer
     C                   EVAL      WL0024 = ' '                                 Warehouse Type
     C                   EVAL      WL0025 = ' '                                 Trans Contol AS
     C                   EVAL      WL0026 = ' '                                 Warehouse Locat
     C                   EVAL      WL0027 = ' '                                 Warehouse Std C
     C                   Z-ADD     *ZERO         WL0028                         Warehouse Chill
     C                   EVAL      WL0029 = ' '                                 Include in Auto
     C                   EVAL      WL0030 = ' '                                 Default Manifes
     C                   EVAL      WL0031 = ' '                                 Default Load Se
     C                   EVAL      WL0032 = ' '                                 WHS Slotting Li
     C                   Z-ADD     *ZERO         WL0033                         Shipping Compan
     C                   Z-ADD     *ZERO         WL0034                         Accounting Comp
     C                   Z-ADD     *ZERO         WL0035                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WL0036                         WHS Inventory C
     C                   EVAL      WL0037 = ' '                                 Parent Warehous
     C                   EVAL      WL0038 = ' '                                 Default Shippin
     C                   EVAL      WL0039 = ' '                                 WHS Live with C
     C                   EVAL      WL0040 = ' '                                 WHS PFS Interfa
     C                   EVAL      WL0041 = ' '                                 WHS Req Meter R
     C                   EVAL      WL0042 = ' '                                 WHS Default Loa
     C                   EVAL      WL0043 = ' '                                 WHS TMS Plannin
     C                   EVAL      WL0044 = ' '                                 Default Carrier
     C                   EVAL      WL0045 = ' '                                 Inventory Logic
     C                   EVAL      WL0046 = ' '                                 WHS Auto Inv Re
     C                   EVAL      WL0047 = ' '                                 EDI Status 1
     C                   EVAL      WL0048 = ' '                                 EDI Status 2
     C                   EVAL      WL0049 = ' '                                 EDI Status 3
     C                   EVAL      WL0050 = ' '                                 Record Status
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WJF8NA        WL0014                         Warehouse Descr
     C                   MOVEL     WJACNA        WL0015                         Address Line 1
     C                   MOVEL     WJADNA        WL0016                         Address Line 2
     C                   MOVEL     WJAENA        WL0017                         Address Line 3
     C                   MOVEL     WJAJNA        WL0018                         City
     C                   MOVEL     WJBTTX        WL0019                         Zip Postal Code
     C                   MOVEL     WJAOCD        WL0020                         Production Ware
     C                   MOVEL     WJBGCD        WL0021                         State Code
     C                   MOVEL     WJVHST        WL0022                         Lot Tracking Fl
     C                   MOVEL     WJMPNA        WL0023                         Default Printer
     C                   MOVEL     WJWPST        WL0024                         Warehouse Type
     C                   MOVEL     WJXUST        WL0025                         Trans Contol AS
     C                   MOVEL     WJT0ST        WL0026                         Warehouse Locat
     C                   MOVEL     WJT1ST        WL0027                         Warehouse Std C
     C                   Z-ADD     WJDBNB        WL0028                         Warehouse Chill
     C                   MOVEL     WJT2ST        WL0029                         Include in Auto
     C                   MOVEL     WJT3ST        WL0030                         Default Manifes
     C                   MOVEL     WJT4ST        WL0031                         Default Load Se
     C                   MOVEL     WJT6ST        WL0032                         WHS Slotting Li
     C                   Z-ADD     WJBWC3        WL0033                         Shipping Compan
     C                   Z-ADD     WJBTC3        WL0034                         Accounting Comp
     C                   Z-ADD     WJBUC3        WL0035                         WHS Sched Prod
     C                   Z-ADD     WJBVC3        WL0036                         WHS Inventory C
     C                   MOVEL     WJFCAA        WL0037                         Parent Warehous
     C                   MOVEL     WJRQSX        WL0038                         Default Shippin
     C                   MOVEL     WJRRSX        WL0039                         WHS Live with C
     C                   MOVEL     WJRSSX        WL0040                         WHS PFS Interfa
     C                   MOVEL     WJRTSX        WL0041                         WHS Req Meter R
     C                   MOVEL     WJT7ST        WL0042                         WHS Default Loa
     C                   MOVEL     WJT8ST        WL0043                         WHS TMS Plannin
     C                   MOVEL     WJRNSX        WL0044                         Default Carrier
     C                   MOVEL     WJROSX        WL0045                         Inventory Logic
     C                   MOVEL     WJRPSX        WL0046                         WHS Auto Inv Re
     C                   MOVEL     WJUVST        WL0047                         EDI Status 1
     C                   MOVEL     WJUWST        WL0048                         EDI Status 2
     C                   MOVEL     WJUXST        WL0049                         EDI Status 3
     C                   MOVEL     WJVSST        WL0050                         Record Status
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WJAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WAAJCD        WJAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSK         CHAIN     @ADREAO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0055 = ' '                                 Warehouse Type
     C                   GOTO      SKEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WJWPST        YL0055                         Warehouse Type
     C                   ENDIF
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLRVGN        BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSL         KLIST
     C                   KFLD                    WKAIC3                         Company Number
     C                   KFLD                    WKV8CD                         Company Value C
      * Setup key
     C                   Z-ADD     WAAIC3        WKAIC3                         Company Number
     C                   MOVEL     @CN(039)      WKV8CD                         Company Value C
      * Establish starting position
     C     KRSSL         CHAIN     @KMREHC                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2221'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SLEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WKM8NB        WN0002                         System Value Nu
     C                   ENDIF
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   SMRVGN        BEGSR
      *================================================================
      * RTV Calendar           RT - Calendar  * See if date exists
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSM         KLIST
     C                   KFLD                    WLAIC3                         Company Number
     C                   KFLD                    WLBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     WL0051        WLAIC3                         Company Number
     C                   Z-ADD     WL0052        WLBCDT                         Post to G_L Dat
      * Establish starting position
     C     KRSSM         CHAIN     @AFREBE                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0018'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'USR0018'     W0RTN                          *Return code
     C                   GOTO      SMEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   ENDIF
      *================================================================
     CSR   SMEXIT        ENDSR
      /EJECT
     CSR   SNRVGN        BEGSR
      *================================================================
      * RTV Validate Blck Or Dtl - WF Block Order Upload Dtl  * Validate
      *================================================================
      *
     C                   EVAL      WN0003 = ' '                                 Error Reason De
     C                   EVAL      WN0004 = ' '                                 Error Reason De
     C                   EVAL      WN0005 = ' '                                 Error Reason De
     C                   EVAL      WN0006 = ' '                                 Error Reason De
     C                   EVAL      WN0007 = ' '                                 Error Reason De
     C                   EVAL      WN0008 = ' '                                 Error Reason De
     C                   EVAL      WN0009 = ' '                                 Error Reason De
      *
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * ** Comments
     C                   EXSR      UESUBR                                       ** Comments
     C                   MOVEL     'Y'           YL0002                         Hdr/Dtl Validat
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSN         KLIST
     C                   KFLD                    WQSN01                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     WAHQNZ        WQSN01                         Surrogate Numbe
      * Establish starting position
     C     KRSSN         SETLL     @C3CPL9                                      *
     C     KRSSN         READE     @C3CPL9                                90    *
      * Data record not found
     C   90              MOVEL     'USR5301'     W0RTN
      * USER: Process Data record
      * Rtv f/Copy Orders TemplXF - Company Item  * 
     C                   DOW       NOT *IN90
     C                   CALL      'PUX7XFR'                            90      Rtv f/Copy Orde
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0216                         Company Number
     C                   PARM      WMHGCD        WQ0217                         Item Code
     C     YL0072        PARM      *BLANK        WQ0218                         Description Lin
     C     YL0073        PARM      *BLANK        WQ0219                         Description Lin
     C     YL0074        PARM      *BLANK        WQ0220                         UOM Primary
     C     YL0075        PARM      *BLANK        WQ0221                         UOM Pricing
     C     YL0076        PARM      *ZERO         WQ0222                         Unit Weight
     C     YL0077        PARM      *BLANK        WQ0223                         Item Level
     C     YL0078        PARM      *BLANK        WQ0224                         Production Date
     C     YL0079        PARM      *BLANK        WQ0225                         Catch Weight St
     C     YL0080        PARM      *ZERO         WQ0226                         Item Structure
     C     YL0081        PARM      *ZERO         WQ0227                         Item Structure
     C     YL0082        PARM      *ZERO         WQ0228                         Item Structure
     C                   PARM      *BLANK        WQ0229                         Default Commod
     C                   PARM      *ZERO         WQ0230                         Transportation
     C     YL0083        PARM      *BLANK        WQ0231                         Item Type Code
     C                   PARM      *BLANK        WQ0232                         Commodity Price
     C                   PARM      *BLANK        WQ0233                         Default Warehou
     C                   PARM      *BLANK        WQ0234                         Price Method De
     C                   PARM      *ZERO         WQ0235                         Fresh Chilling
     C     YL0084        PARM      *BLANK        WQ0236                         Variety_Rendere
     C     YL0085        PARM      *ZERO         WQ0237                         Item Target Pri
     C     YL0086        PARM      *BLANK        WQ0238                         Sold 100 Percen
     C     YL0087        PARM      *BLANK        WQ0239                         Error Status
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUX7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Error Status is yes
     C                   IF        YL0087 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(071)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0240                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0241                         Order Number
     C                   PARM      'INVITM'      WQ0242                         BOE Error Reaso
     C                   PARM      YL0088        WQ0243                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv Item Def/TFExp/CO XF - Item Default  * 
     C                   CALL      'PNNCXFR'                            90      Rtv Item Def/TF
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHGCD        WQ0244                         Item Code
     C     YL0089        PARM      *BLANK        WQ0245                         TF Co_Ownership
     C     YL0090        PARM      *BLANK        WQ0246                         Item TF Exempt
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNNCXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                   CALL      'POP1XFR'                            90      Rtv First Consu
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0247                         Company Number
     C                   PARM      WMHGCD        WQ0248                         Item Code
     C     YL0091        PARM      *ZERO         WQ0249                         Component Item
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POP1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Val Manual Price      XF - Company Item  * 
     C                   CALL      'POA5XFR'                            90      Val Manual Pric
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0250                         Company Number
     C                   PARM      WMHGCD        WQ0251                         Item Code
     C                   PARM      *BLANK        WQ0252                         Description Lin
     C     YL0092        PARM      *BLANK        WQ0253                         Default Commod
     C     YL0093        PARM      *ZERO         WQ0254                         Market Overage
     C                   PARM      *ZERO         WQ0255                         Standard Overag
     C     YL0094        PARM      *BLANK        WQ0256                         Commodity Price
     C                   PARM      *ZERO         WQ0257                         Std Weight_Head
     C     YL0095        PARM      *BLANK        WQ0258                         Primal Group Co
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POA5XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Rtv Cust Tf Exempt    XF - Customer EXT  * 
     C                   CALL      'PPSMXFR'                            90      Rtv Cust Tf Exe
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WABKC7        WQ0259                         Ship To Custome
     C     YL0096        PARM      *BLANK        WQ0260                         Customer TF Exe
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPSMXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Set/Val OH TF Exempt2 IF
     C                   EVAL      YL0099 = ' '                                 OH TF Exempt Er
      * Set / Validate TF Exempt code values              RMC 8/24/05
      * CASE: PAR.OH TF Exempt Code is Blank
      * VAL: Customer Exempt Code  w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C                   IF        YL0097 = ' '
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Item Codes
     C                   IF        YL0096 = 'NE'
     C                   IF        YL0090 = 'EP' OR
     C                             YL0090 = 'NE'
     C                   EVAL      YL0097 = ' '                                 OH TF Exempt Co
     C                   MOVEL     YL0090        YL0097                         OH TF Exempt Co
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
     C                   IF        YL0096 = 'EC'
     C                   EVAL      YL0097 = ' '                                 OH TF Exempt Co
     C                   MOVEL     YL0096        YL0097                         OH TF Exempt Co
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C                   IF        YL0090 = 'NE'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
     C                   IF        YL0089 = 'S' OR
     C                             YL0089 = 'T'
     C                   MOVEL     'TFEXE1'      YL0099                         OH TF Exempt Er
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EC'          YL0090                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EP'          YL0090                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Validate after 1 line item has been entered
      * If not Pre-Commencement, set exempt code
      * CASE: PAR.OH TF Exempt Code is Not Pre-Commencement
      * VAL: Customer Exempt Code w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C                   IF        YL0097 = 'EC' OR
     C                             YL0097 = 'EP' OR
     C                             YL0097 = 'NE'
      * Line item must eq whats in the header, else Error
      * CASE: PAR.OH TF Exempt Code NE PAR.Ord TF Exempt Code
     C                   IF        YL0096 = 'NE'
     C                   IF        YL0097 <> YL0090
     C                   MOVEL     'TFEXE2'      YL0099                         OH TF Exempt Er
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
     C                   IF        YL0096 = 'EC'
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C                   IF        YL0090 = 'NE'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
     C                   IF        YL0089 = 'S' OR
     C                             YL0089 = 'T'
     C                   MOVEL     'TFEXE1'      YL0099                         OH TF Exempt Er
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EC'          YL0090                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EP'          YL0090                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'PC'          YL0090                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** WI546_2-Validate OH TF Exempt Code
      * CASE: LCL.OH TF Exempt Error Cde U is NE *Blank
      * CASE: LCL.OH TF Exempt Error Cde U is TF Exempt-Item & Cust
     C                   IF        YL0099 <> ' '
     C                   IF        YL0099 = @CN(072)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(073)      CAT(P)    @CN(074):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0261                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0262                         Order Number
     C                   PARM      'TFEXE1'      WQ0263                         BOE Error Reaso
     C                   PARM      YL0088        WQ0264                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.OH TF Exempt Error Cde U is Tf Exempt - mix error
     C                   IF        YL0099 = @CN(075)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(076)      CAT(P)    @CN(077):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0265                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0266                         Order Number
     C                   PARM      'TFEXE2'      WQ0267                         BOE Error Reaso
     C                   PARM      YL0088        WQ0268                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL Item Level Exists  XF - Item Level Codes  * 
     C                   CLEAR                   PBRC
     C                   MOVEL(P)  YL0077        PBRBCD                         Item Level
      *
     C                   CALL      'PNH3XFR'                            90      VAL Item Level
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PBRC                           KEY: Item Level
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNH3XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Item code not found
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(078)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0269                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0270                         Order Number
     C                   PARM      'ITMLVL'      WQ0271                         BOE Error Reaso
     C                   PARM      YL0088        WQ0272                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Not Finished Goods
      * CASE:
      *  - NOT c1
      *   |- c1    : LCL.Item Type Code is Finished Good
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0083 = 'FG'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(079)      CAT(P)    @CN(080):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0273                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0274                         Order Number
     C                   PARM      'ITMTYP'      WQ0275                         BOE Error Reaso
     C                   PARM      YL0088        WQ0276                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Warehouse type=Fresh & Sold 100%=Frozen
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Warehouse Type is Fresh
      *   |- c2    : LCL.Sold 100 Percent Frozen is yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0100 = 'FR'
     C                   IF        YL0086 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(081)      CAT(P)    'rozen':ZQ    YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0277                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0278                         Order Number
     C                   PARM      '100FRZ'      WQ0279                         BOE Error Reaso
     C                   PARM      YL0088        WQ0280                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Rendered & Regular Load Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Variety_Rendered_Cut is Rendered
      *   |- c2    : LCL.Load Type is Regular
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0084 = 'R'
     C                   IF        YL0101 = 'R'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(082)      CAT(P)    @CN(083):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0281                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0282                         Order Number
     C                   PARM      'BLKITM'      WQ0283                         BOE Error Reaso
     C                   PARM      YL0088        WQ0284                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Rendered & Bulk Load Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Variety_Rendered_Cut is Rendered
      *   |- c2    : LCL.Load Type is Bulk
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0084 = 'R'
     C                   IF        YL0101 = 'B'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(084)      CAT(P)    @CN(085):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0285                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0286                         Order Number
     C                   PARM      'BLKORD'      WQ0287                         BOE Error Reaso
     C                   PARM      YL0088        WQ0288                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * Rtv Plan Prod Sts     XF - Company Item Ext  * 
     C                   CALL      'PNHKXFR'                            90      Rtv Plan Prod S
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0289                         Company Number
     C                   PARM      WMHGCD        WQ0290                         Item Code
     C     YL0102        PARM      *BLANK        WQ0291                         Plan Production
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNHKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Val ItmBal.Unit Cst    XF - /UT Inv. Interface Funcs  * 
     C                   CALL      'PDMCXFR'                            90      Val ItmBal.Unit
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0292                         Company Number
     C                   PARM      WMHGCD        WQ0293                         Item Code
     C                   PARM      WAAJCD        WQ0294                         Warehouse Code
     C     YL0103        PARM      *ZERO         WQ0295                         Unit Cost Per P
     C     YL0087        PARM      *BLANK        WQ0296                         Error Status
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDMCXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Unit Cost for Warehouse
      * CASE: LCL.Unit Cost Per Pound is equal to zero
     C                   IF        YL0103 = 0
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(086)      CAT(P)    @CN(087):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0297                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0298                         Order Number
     C                   PARM      'UNTCST'      WQ0299                         BOE Error Reaso
     C                   PARM      YL0088        WQ0300                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Item Balance not found
      * CASE: LCL.Error Status is yes
     C                   IF        YL0087 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(088)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0301                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0302                         Order Number
     C                   PARM      'ITMBAL'      WQ0303                         BOE Error Reaso
     C                   PARM      YL0088        WQ0304                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * Val Age Information2  IF
     C                   EVAL      WN0003 = ' '                                 Error Reason De
     C                   EVAL      WN0004 = ' '                                 Error Reason De
     C                   EVAL      WN0005 = ' '                                 Error Reason De
     C                   EVAL      WN0006 = ' '                                 Error Reason De
     C                   EVAL      WN0007 = ' '                                 Error Reason De
     C                   EVAL      WUB8SX = ' '                                 Error Flag
     C                   EVAL      YL0087 = ' '                                 Error Status
     C                   EVAL      WUKWTX = ' '                                 Error Reason De
     C                   EVAL      WUKXTX = ' '                                 Error Reason De
     C                   EVAL      WUKYTX = ' '                                 Error Reason De
     C                   EVAL      WUKZTX = ' '                                 Error Reason De
     C                   EVAL      WUTITX = ' '                                 Error Reason De
      * CASE: PAR.Company Organization is Seaboard
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                   IF        YL0106 = 'S'
     C                   CALL      'PNQNXFR'                            90      Val Age informa
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHGCD        WQ0305                         Item Code
     C                   PARM      WAAJCD        WQ0306                         Warehouse Code
     C     WUB8SX        PARM      WUB8SX        WQ0307                         Error Flag
     C     WUKWTX        PARM      WUKWTX        WQ0308                         Error Reason De
     C     WUKXTX        PARM      WUKXTX        WQ0309                         Error Reason De
     C     WUKYTX        PARM      WUKYTX        WQ0310                         Error Reason De
     C     WUKZTX        PARM      WUKZTX        WQ0311                         Error Reason De
     C     WUTITX        PARM      WUTITX        WQ0312                         Error Reason De
     C                   PARM      WAAIC3        WQ0313                         Company Number
     C                   PARM      YL0060        WQ0314                         Scheduled Ship
     C                   PARM      YL0060        WQ0315                         Requested Deliv
     C                   PARM      WMRINY        WQ0316                         Item Age Days
     C                   PARM      *ZERO         WQ0317                         Production Ovr
     C                   PARM      *ZERO         WQ0318                         Production Ovr
     C     YL0104        PARM      YL0104        WQ0319                         Production AgeD
     C     YL0105        PARM      YL0105        WQ0320                         Production AgeD
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNQNXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WUB8SX = 'Y'
     C                   IF        'V' = 'V'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C                   IF        Y0CX01 = '1'
     C                   IF        WUKWTX <> WUW4TX
     C                   MOVEL     WUKWTX        WN0003                         Error Reason De
     C                   END                                                    *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C                   IF        WUKXTX <> WUW4TX
     C                   MOVEL     WUKXTX        WN0004                         Error Reason De
     C                   END                                                    *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C                   IF        WUKYTX <> WUW4TX
     C                   MOVEL     WUKYTX        WN0005                         Error Reason De
     C                   END                                                    *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C                   IF        WUKZTX <> WUW4TX
     C                   MOVEL     WUKZTX        WN0006                         Error Reason De
     C                   END                                                    *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C                   IF        WUTITX <> WUW4TX
     C                   MOVEL     WUTITX        WN0007                         Error Reason De
     C                   END                                                    *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
      * ** These are coming in as *ZERO in the parms. So no error.
     C                   IF        *ZERO = 0
     C                   MOVEL     'N'           WUB8SX                         Error Flag
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      WN0009 = ' '                                 Error Reason De
     C                   MOVEL     @CN(089)      WN0009                         Error Reason De
     C                   MOVEL     'N'           WUB8SX                         Error Flag
     C                   END                                                    *FI
      * CASE: WRK.Error Flag            USR is Yes
     C                   IF        WUB8SX = 'Y'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Error Reason Descr 1
      * CASE: PAR.Error Reason Descript 1 is Not Blank
     C                   IF        WN0003 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(090)      CAT(P)    @CN(091):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0321                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0322                         Order Number
     C                   PARM      'OVAGD1'      WQ0323                         BOE Error Reaso
     C                   PARM      YL0088        WQ0324                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 2
      * CASE: PAR.Error Reason Descript 2 is Not Blank
     C                   IF        WN0004 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(092)      CAT(P)    @CN(093):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0325                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0326                         Order Number
     C                   PARM      'OVAGD2'      WQ0327                         BOE Error Reaso
     C                   PARM      YL0088        WQ0328                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 3
      * CASE: PAR.Error Reason Descript 3 is Not Blank
     C                   IF        WN0005 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(094)      CAT(P)    @CN(095):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0329                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0330                         Order Number
     C                   PARM      'OVAGD3'      WQ0331                         BOE Error Reaso
     C                   PARM      YL0088        WQ0332                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 4
      * CASE: PAR.Error Reason Descript 4 is Not Blank
     C                   IF        WN0006 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(094)      CAT(P)    @CN(095):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0333                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0334                         Order Number
     C                   PARM      'OVAGD3'      WQ0335                         BOE Error Reaso
     C                   PARM      YL0088        WQ0336                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 5
      * CASE: PAR.Error Reason Descript 5 is Not Blank
     C                   IF        WN0007 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(094)      CAT(P)    @CN(095):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0337                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0338                         Order Number
     C                   PARM      'OVAGD3'      WQ0339                         BOE Error Reaso
     C                   PARM      YL0088        WQ0340                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 6
      * CASE: PAR.Error Reason Descript 6 is Not Blank
     C                   IF        WN0008 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(096)      CAT(P)    @CN(097):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0341                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0342                         Order Number
     C                   PARM      'OVAGD6'      WQ0343                         BOE Error Reaso
     C                   PARM      YL0088        WQ0344                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Validate Ham group
      * CASE: *OTHERWISE
      * RTV for Ord.Detail     XF - /UT Inv. Interface Funcs  * 
     C                   CALL      'PDC3XFR'                            90      RTV for Ord.Det
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0345                         Company Number
     C                   PARM      WMHGCD        WQ0346                         Item Code
     C                   PARM      *BLANK        WQ0347                         Description Lin
     C                   PARM      *BLANK        WQ0348                         Description Lin
     C     YL0074        PARM      *BLANK        WQ0349                         UOM Primary
     C                   PARM      *BLANK        WQ0350                         UOM Pricing
     C                   PARM      *ZERO         WQ0351                         Unit Weight
     C                   PARM      *BLANK        WQ0352                         Item Level
     C                   PARM      *BLANK        WQ0353                         Production Date
     C                   PARM      *BLANK        WQ0354                         Catch Weight St
     C                   PARM      *ZERO         WQ0355                         Item Structure
     C                   PARM      *ZERO         WQ0356                         Item Structure
     C                   PARM      *ZERO         WQ0357                         Item Structure
     C                   PARM      *BLANK        WQ0358                         Default Commod
     C                   PARM      *ZERO         WQ0359                         Transportation
     C                   PARM      *BLANK        WQ0360                         Item Type Code
     C                   PARM      *BLANK        WQ0361                         Commodity Price
     C                   PARM      *BLANK        WQ0362                         Default Warehou
     C                   PARM      *BLANK        WQ0363                         Price Method De
     C                   PARM      *ZERO         WQ0364                         Fresh Chilling
     C                   PARM      *BLANK        WQ0365                         Variety_Rendere
     C                   PARM      *ZERO         WQ0366                         Item Target Pri
     C                   PARM      *BLANK        WQ0367                         Error Status
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDC3XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.U_M_Ordered is Combos
      * Val Item              XF - Ham Group Item  * 
     C                   IF        YL0074 = 'CB'
     C                   CALL      'PMG1XFR'                            90      Val Item
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHGCD        WQ0368                         Ham Group Item
     C     YL0107        PARM      *BLANK        WQ0369                         Record Found US
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PMG1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Ham Group Reqd
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Found USR is Record Found
      *   |- c2    : DB1.Ham Group Number is Not Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0107 = 'Y'
     C                   IF        WMA1AA = 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(098)      CAT(P)    @CN(099):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0370                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0371                         Order Number
     C                   PARM      'HAMGRP'      WQ0372                         BOE Error Reaso
     C                   PARM      YL0088        WQ0373                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Found USR is Record Found
      *   |- c2    : DB1.Ham Group Number is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0107 = 'Y'
     C                   IF        WMA1AA <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Rtv Credit Item Sts   RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WAAIC3        WL0053                         Company Number
     C                   Z-ADD     WMHGCD        WL0054                         Item Code
     C                   EXSR      SORVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0055        YL0108                         Credit Item Sta
      * CASE: LCL.Credit Item Status is yes
     C                   IF        YL0108 = 'Y'
     C                   ELSE
      * CASE: LCL.U_M_Ordered is Not Combos
     C                   IF        YL0074 <> 'CB'
     C                   ELSE
      * CASE: *OTHERWISE
      * VAL Ham Group/Item     RT - Ham Group Item  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WMA1AA        WL0056                         Ham Group Numbe
     C                   Z-ADD     WMHGCD        WL0057                         Ham Group Item
     C                   EXSR      SPRVGN
      * ** Ham / Item error
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(100)      CAT(P)    'nd.':ZQ      YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0374                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0375                         Order Number
     C                   PARM      'HAMITM'      WQ0376                         BOE Error Reaso
     C                   PARM      YL0088        WQ0377                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 2 Quantity Ordered
      * CASE: DB1.Quantity Ordered is Equal to zero
     C                   IF        WMAVQT = 0
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(101)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0378                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0379                         Order Number
     C                   PARM      'QTYORD'      WQ0380                         BOE Error Reaso
     C                   PARM      YL0088        WQ0381                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                   CALL      'PNS7XFR'                            90      RTV PrcMthTyp/P
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0382                         Company Number
     C                   PARM      WMQ7CD        WQ0383                         Price Method Co
     C     YL0109        PARM      *BLANK        WQ0384                         Price Method Ty
     C                   PARM      *BLANK        WQ0385                         PMH Price Type
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNS7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** WI546_2 Use Price Method Code to calc unit price credit.
     C                   MOVEL     WMQ7CD        YL0110                         Price Method Co
      * ** WI546_2 populate Commodity Market Code USR
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : LCL.Price Method Code is Manual
      *   |- c2    : LCL.Price Method Code is Deviated Flat Duty Item
      *   |- c3    : LCL.Price Method Code is Deviated Gate Price
      *   '-
     C                   IF        YL0110 = 'MAN' OR
     C                             YL0110 = 'DVF' OR
     C                             YL0110 = 'DVG'
     C                   EVAL      YL0111 = ' '                                 Commodity Marke
     C                   END                                                    *FI
      * ** 3 Price Method Type
      * CASE: LCL.Price Method Type is *Blank
     C                   IF        YL0109 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(102)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0386                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0387                         Order Number
     C                   PARM      'PRCMTH'      WQ0388                         BOE Error Reaso
     C                   PARM      YL0088        WQ0389                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 4 Item Age Days
      * CASE: DB1.Item Age Days is Not Entered
     C                   IF        WMRINY = 0
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(103)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0390                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0391                         Order Number
     C                   PARM      'OVAGD6'      WQ0392                         BOE Error Reaso
     C                   PARM      YL0088        WQ0393                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 5 OD Price Type
      * CASE: DB1.OD Price Type is Valid Values
     C                   IF        WMF7SX = 'CON' OR
     C                             WMF7SX = 'FRM' OR
     C                             WMF7SX = 'NEG' OR
     C                             WMF7SX = 'HDG' OR
     C                             WMF7SX = 'DST' OR
     C                             WMF7SX = 'NHT' OR
     C                             WMF7SX = 'TNK' OR
     C                             WMF7SX = 'FLR'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(104)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0394                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0395                         Order Number
     C                   PARM      'PRCTYP'      WQ0396                         BOE Error Reaso
     C                   PARM      YL0088        WQ0397                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** Load From and Thru Date for 1 month prior and after today.
      * LCL.From Date             USR = JOB.*Job exec start date + CON.-1
     C     ##ED7         ADD       1000000       XDINDT
     C                   Z-ADD     -1            XDURR
     C                   EXSR      XDAMO
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0112
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0112
     C                   END
      * LCL.Thru Date             USR = JOB.*Job exec start date + CON.1
     C     ##ED7         ADD       1000000       XDINDT
     C                   Z-ADD     1             XDURR
     C                   EXSR      XDAMO
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0113
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0113
     C                   END
      * ** WI546_2-Validate Date format is CYMD for Market Pricing Date
      * CASE: DB1.Market Pricing Date is NE Zero
     C                   IF        WMEXDT <> 0
     C                   EVAL      YL0114 = ' '                                 Text usr 11
     C                   EVAL      YL0115 = ' '                                 Date From Conve
     C                   MOVEL     WMEXDT        YL0115                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0115        WQ0398                         Date From Conve
     C     YL0114        PARM      *BLANK        WQ0399                         Date To Convert
     C                   PARM      '*CYMD'       WQ0400                         Date From Forma
     C                   PARM      '*YYMD'       WQ0401                         Date To Format
     C                   PARM      '*NONE'       WQ0402                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0114 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(105)      CAT(P)    @CN(043):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0403                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0404                         Order Number
     C                   PARM      'MKTPDT'      WQ0405                         BOE Error Reaso
     C                   PARM      YL0088        WQ0406                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0116                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 7 OC MPR Prc Ready to Send
      * CASE: DB1.OD MPR Prc Ready to Send is MPR Ready Sts
     C                   IF        WMHPST = ' ' OR
     C                             WMHPST = 'X' OR
     C                             WMHPST = 'N' OR
     C                             WMHPST = 'Y'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(106)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0407                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0408                         Order Number
     C                   PARM      'MPRRDY'      WQ0409                         BOE Error Reaso
     C                   PARM      YL0088        WQ0410                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 8 Price Overage Override
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.OD MPR Prc Ready to Send is yes
      *   |- c2    : DB1.Price Overage Override is LE .0100
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WMHPST = 'Y'
     C                   IF        WMBZPR <= .0100
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(107)      CAT(P)    @CN(108):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0411                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0412                         Order Number
     C                   PARM      'PRCOVR'      WQ0413                         BOE Error Reaso
     C                   PARM      YL0088        WQ0414                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Consider Palletize from WF Detail or Header
      * CASE: DB1.Palletize is Y/N Values
     C                   IF        WMVEST = 'N' OR
     C                             WMVEST = 'Y'
     C                   MOVEL     WMVEST        YL0117                         Palletize
     C                   ELSE
      * CASE: LCL.Palletize is blank
     C                   IF        YL0117 = ' '
     C                   MOVEL     YL0044        YL0117                         Palletize
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** WI546_2 Populate OD Pallet Type Based on Palletize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.OD Pallet Type is Valid Values
      *   |- c2    : LCL.Palletize is yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WMF5SX = '01' OR
     C                             WMF5SX = '02' OR
     C                             WMF5SX = 'CH' OR
     C                             WMF5SX = 'HT' OR
     C                             WMF5SX = '04' OR
     C                             WMF5SX = '03'
     C                   IF        YL0117 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     WMF5SX        YL0118                         OD Pallet Type
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Palletize is yes
      * Rtv All - Customer EXT2  * OD Pallet Type
      * Move input parameters to subroutine local variables.
     C                   IF        YL0117 = 'Y'
     C                   Z-ADD     WABKC7        WL0001                         Ship To Custome
     C                   EXSR      SGRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        YN0115                         M3 Supplier ID
     C                   MOVEL(P)  WL0003        YN0116                         Dft Mode of Tra
     C                   MOVEL(P)  WL0004        YN0117                         Buying Group
     C                   MOVEL(P)  WL0005        YN0118                         Buying Group Op
     C                   MOVEL(P)  WL0006        YN0119                         Ship To Establi
     C                   MOVEL(P)  WL0007        YL0118                         PM Pallet Type
     C                   MOVEL(P)  WL0008        YN0120                         Cust Dft Price
     C                   Z-ADD     WL0009        YN0121                         Cust Dft Age Da
     C                   Z-ADD     WL0010        YN0122                         Cust Dft Delive
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0118 = ' '                                 OD Pallet Type
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Slip sheet
      * CASE: DB1.Slip Sheet is Not Blank
     C                   IF        WMVGST = 'N' OR
     C                             WMVGST = 'Y'
     C                   MOVEL     WMVGST        YL0119                         Slip Sheet
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     YL0046        YL0119                         Slip Sheet
     C                   END                                                    *FI
      * ** Write Detail to Ord Detail in Qtemp if validation passed.
      * CASE: PAR.Hdr/Dtl Validation Pass U is Yes
      * RTV All fields - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0002 = 'Y'
     C                   Z-ADD     WAAIC3        WL0058                         Company Number
     C                   Z-ADD     WABKC7        WL0059                         Ship To Custome
     C                   EXSR      SQRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0060        YN0123                         Terms Code
     C                   MOVEL(P)  WL0061        YN0124                         Sales Route Cod
     C                   MOVEL(P)  WL0062        YN0125                         Special Instruc
     C                   MOVEL(P)  WL0063        YN0126                         Special Instruc
     C                   MOVEL(P)  WL0064        YN0127                         Carrier Code
     C                   MOVEL(P)  WL0065        YN0128                         Broker
     C                   MOVEL(P)  WL0066        YN0129                         P_O Required Fl
     C                   Z-ADD     WL0067        YN0130                         Deliver after t
     C                   Z-ADD     WL0068        YN0131                         Deliver before
     C                   MOVEL(P)  WL0069        YN0132                         Alt Remittance
     C                   MOVEL(P)  WL0070        YN0133                         Type Code
     C                   Z-ADD     WL0071        YN0134                         Absorbed Freigh
     C                   Z-ADD     WL0072        YN0135                         Mileage To Cust
     C                   Z-ADD     WL0073        YN0136                         Co_Cust Overage
     C                   MOVEL(P)  WL0074        YN0137                         Age Code
     C                   MOVEL(P)  WL0075        YN0138                         Warehouse Code
     C                   MOVEL(P)  WL0076        YN0139                         Outside Warehou
     C                   MOVEL(P)  WL0077        YN0140                         Customer Group
     C                   MOVEL(P)  WL0078        YN0141                         Customer Group
     C                   MOVEL(P)  WL0079        YN0142                         G_L Code
     C                   MOVEL(P)  WL0080        YL0120                         Commodity Marke
     C                   MOVEL(P)  WL0081        YN0143                         Credit Contact
     C                   MOVEL(P)  WL0082        YN0144                         Credit Contact
     C                   MOVEL(P)  WL0083        YN0145                         Credit Contact
     C                   MOVEL(P)  WL0084        YN0146                         Credit Contact
     C                   MOVEL(P)  WL0085        YN0147                         Allow Man_Qt WO
     C                   MOVEL(P)  WL0086        YN0148                         Fax Invoice Fla
     C                   MOVEL(P)  WL0087        YN0149                         Fax Invoice Fax
     C                   MOVEL(P)  WL0088        YN0150                         Fax Invoice Con
     C                   MOVEL(P)  WL0089        YN0151                         Distributor
     C                   MOVEL(P)  WL0090        YN0152                         Default Shippin
     C                   MOVEL(P)  WL0091        YN0153                         Ord Ent Default
     C                   MOVEL(P)  WL0092        YN0154                         Bypass DDt_Dela
     C                   MOVEL(P)  WL0093        YN0155                         EDI Status 1
     C                   MOVEL(P)  WL0094        YN0156                         EDI Status 2
     C                   MOVEL(P)  WL0095        YN0157                         EDI Status 3
     C                   MOVEL(P)  WL0096        YN0158                         Record Status
     C                   Z-ADD     WL0097        YN0159                         Job Time
     C                   MOVEL(P)  WL0098        YN0160                         User Id
     C                   MOVEL(P)  WL0099        YN0161                         Job Name
     C                   Z-ADD     WL0100        YN0162                         Job Date
      * ** WI546_2 Overwrite Commodity Market Code
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : LCL.Price Method Code is Manual
      *   |- c2    : LCL.Price Method Code is Deviated Flat Duty Item
      *   |- c3    : LCL.Price Method Code is Deviated Gate Price
      *   '-
     C                   IF        YL0110 = 'MAN' OR
     C                             YL0110 = 'DVF' OR
     C                             YL0110 = 'DVG'
     C                   MOVEL     YL0111        YL0120                         Commodity Marke
     C                   END                                                    *FI
      * Crt Block Order Qtemp XF - Order Detail  * 
     C                   CLEAR                   PCRC
     C                   Z-ADD     WAAIC3        PCAIC3                         Company Number
     C                   Z-ADD     9999999       PCC4NB                         Order Number
     C                   Z-ADD     WMDXNB        PCDPNB                         Order Sequence
     C                   Z-ADD     1             PCUENB                         Order Secondary
     C                   Z-ADD     WMHGCD        PCHGCD                         Item Code
     C                   MOVEL(P)  WAAJCD        PCAJCD                         Warehouse Code
     C                   Z-ADD     WABKC7        PCBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         PCCFC7                         Order Group Cod
     C                   MOVEL(P)  'E'           PCGMST                         Detail Line Sta
     C                   EVAL      PCGNST = ' '                                 Detail Line Sta
     C                   Z-ADD     *ZERO         PCMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         PCKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         PCL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         PCL9VA                         Quantity to Sub
     C                   EVAL      PCGTST = ' '                                 Comment Print A
     C                   EVAL      PCGVST = ' '                                 Comment Print I
     C                   EVAL      PCGUST = ' '                                 Comment Print P
     C                   EVAL      PCQFST = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         PCAYVA                         Extended Amount
     C                   Z-ADD     WMEXDT        PCEXDT                         Market Pricing
     C                   MOVEL(P)  YL0120        PCLQCD                         Commodity Marke
     C                   EVAL      PCRDCD = ' '                                 Date Method Cod
     C                   MOVEL(P)  WMQ7CD        PCQ7CD                         Price Method Co
     C                   Z-ADD     WMBZPR        PCBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         PCL6NB                         Contract Number
     C                   MOVEL(P)  'U'           PCU1ST                         Price Status
     C                   Z-ADD     *ZERO         PCGIDT                         Pricing Date Us
     C                   MOVEL(P)  YL0075        PCCRCD                         U_M_Base Price
     C                   MOVEL(P)  YL0074        PCAGCD                         U_M_Ordered
     C                   EVAL      PCRZST = ' '                                 Work Confirm St
     C                   EVAL      PCR0ST = ' '                                 Work Over_Short
     C                   MOVEL(P)  YL0121        PCR1ST                         OD Production P
     C                   MOVEL(P)  YL0072        PCG7NA                         Order Desc_Line
     C                   MOVEL(P)  YL0073        PCG8NA                         Order Desc_Line
     C                   EVAL      PCRPCD = ' '                                 Age Code
     C                   MOVEL(P)  YL0117        PCVEST                         Palletize
     C                   MOVEL(P)  YL0119        PCVGST                         Slip Sheet
     C                   MOVEL(P)  YL0079        PCAVST                         Catch Weight St
     C                   EVAL      PCU0ST = ' '                                 Price Audit
     C                   EVAL      PCRFCD = ' '                                 Price Audit Rea
     C                   MOVEL(P)  YL0078        PCFZST                         Production Date
     C                   Z-ADD     *ZERO         PCR1NB                         Rated Freight
     C                   Z-ADD     WMAVQT        PCAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         PCD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         PCCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         PCAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         PCCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         PCATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         PCAQCS                         Unit Cost Prici
     C                   Z-ADD     YL0103        PCAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         PCAKPR                         Unit Price
     C                   Z-ADD     *ZERO         PCALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         PCAUPR                         Unit Price Orde
     C                   Z-ADD     YL0076        PCAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         PCA4WG                         Tare Weight Tot
     C                   Z-ADD     YL0060        PCA5DT                         Requested Ship
     C                   Z-ADD     YL0060        PCAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         PCGNDT                         Actual Shipped
     C                   MOVEL(P)  YL0051        PCAMST                         Affect Inventor
     C                   MOVEL(P)  YL0052        PCANST                         Affect Sales Do
     C                   MOVEL(P)  YL0053        PCVAST                         Affect Sales Pn
     C                   Z-ADD     YL0082        PCRGNB                         Item Structure
     C                   Z-ADD     YL0081        PCRHNB                         Item Structure
     C                   Z-ADD     YL0080        PCRINB                         Item Structure
     C                   MOVEL(P)  YL0077        PCRBCD                         Item Level
     C                   EVAL      PCHICD = ' '                                 Quality Level
     C                   EVAL      PCRNCD = ' '                                 Pricing Product
     C                   EVAL      PCROCD = ' '                                 Season Product
     C                   Z-ADD     ##ED7         PCCXDT                         Date of Origina
     C                   MOVEL(P)  @CN(069)      PCAJVN                         User Profile Na
     C                   MOVEL(P)  WAKXCD        PCKXCD                         Country Code
     C                   MOVEL(P)  '01'          PCJPCD                         Event Code
     C                   EVAL      PCCQCD = ' '                                 Reason Code
     C                   MOVEL(P)  YL0122        PCR4CD                         Sales Route Cod
     C                   EVAL      PCZ1ST = ' '                                 Modified Flag
     C                   EVAL      PCZ3ST = ' '                                 Substituted Fla
     C                   EVAL      PCZ4ST = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         PCDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         PCB6VL                         Invoice Extende
     C                   Z-ADD     WMA1AA        PCA1AA                         Ham Group Numbe
     C                   EVAL      PCFZSX = ' '                                 OD Adj Type Ove
     C                   MOVEL(P)  'Y'           PCF0SX                         Affect Trade Fu
     C                   MOVEL(P)  'Y'           PCF1SX                         Affect Commissi
     C                   MOVEL(P)  'Y'           PCF2SX                         Affect Pricing
     C                   EVAL      PCF3SX = ' '                                 Released by Use
     C                   MOVEL(P)  YL0090        PCF4SX                         Ord TF Exempt C
     C                   MOVEL(P)  YL0118        PCF5SX                         OD Pallet Type
     C                   MOVEL(P)  YL0123        PCF6SX                         Production Ware
     C                   MOVEL(P)  WMF7SX        PCF7SX                         OD Price Type
     C                   Z-ADD     *ZERO         PCNTDT                         Warehouse Palle
     C                   Z-ADD     YL0091        PCNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         PCNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         PCNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         PCNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         PCBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         PCBVTM                         Price Code
     C                   Z-ADD     *ZERO         PCBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         PCBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         PCBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         PCH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         PCH6NX                         Warehouse Avg P
     C                   Z-ADD     YL0085        PCH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         PCH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         PCH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         PCDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         PCDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         PCDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         PCDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         PCDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         PCGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         PCGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         PCGUPR                         OD Unused Prc 8
     C                   EVAL      PCHOST = ' '                                 OD MPR Sent to
     C                   MOVEL(P)  WMHPST        PCHPST                         OD MPR Prc Read
     C                   EVAL      PCIOST = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         PCPEWG                         Weight Amount E
     C                   Z-ADD     WMRINY        PCRINY                         Item Age Days
     C                   Z-ADD     *ZERO         PCTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         PCTJDT                         Production Ovr
     C                   MOVEL(P)  WAC3TX        PCH2ST                         OD Spot Buy
     C                   EVAL      PCH0ST = ' '                                 OD Clm Full Ret
     C                   EVAL      PCH1ST = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         PCTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         PCTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         PCTMDT                         OD Atch to Ord
     C                   EVAL      PCUVST = ' '                                 EDI Status 1
     C                   EVAL      PCUWST = ' '                                 EDI Status 2
     C                   EVAL      PCUXST = ' '                                 EDI Status 3
      *
     C                   CALL      'PUZ7XFR'                            90      Crt Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PCRC                           RCD: Order Deta
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUZ7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     '1'           YL0124                         Billing Activit
      * Edt OD Pricing Validt2 IF
     C                   EVAL      YL0135 = ' '                                 Pricing Valid E
     C                   Z-ADD     *ZERO         YL0128                         Unit Price_Cred
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                   CALL      'PNS7XFR'                            90      RTV PrcMthTyp/P
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0415                         Company Number
     C                   PARM      YL0110        WQ0416                         Price Method Co
     C     YL0136        PARM      *BLANK        WQ0417                         Price Method Ty
     C     YL0137        PARM      *BLANK        WQ0418                         PMH Price Type
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNS7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Rtv Market Dtls OrEnt XF - IP Item Market Details  * 
     C                   CLEAR                   PDRC
     C                   Z-ADD     WMHGCD        PDHGCD                         Item Code
     C                   MOVEL(P)  YL0120        PDLQCD                         Commodity Marke
      *
     C                   CALL      'PNS1XFR'                            90      Rtv Market Dtls
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PDRC                           KEY: IP Item Ma
     C     YL0138        PARM      *BLANK        WQ0419                         Commodity Price
     C     YL0139        PARM      *ZERO         WQ0420                         Market Prem/Ded
     C     YL0140        PARM      *BLANK        WQ0421                         Record Found US
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNS1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0134                         USR Display 4
      * LCL.Commodity Price Group & LCL.Market Overage
      * CASE: LCL.Record Found USR is Record Found
     C                   IF        YL0140 = 'Y'
     C                   Z-ADD     YL0139        YL0141                         Market Overage
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     YL0094        YL0138                         Commodity Price
     C                   Z-ADD     YL0093        YL0141                         Market Overage
     C                   END                                                    *FI
      * VAL: Price Method Code
      * CASE: PAR.Price Method Code is Blank
     C                   IF        YL0110 = ' '
     C                   MOVEL     'Y'           YL0087                         Error Status
      * Setup message data for message
     C                   MOVEL     YL0110        ZA0001                         Price Method Co
      * Send message 'Value Required (alpha)'
     C                   MOVEL     'USR2808'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
      * VAL: Price Code
      * CASE: PAR.Price Code is Entered
      * VAL: Price Code
      * CASE: LCL.Price Method Type is Not Contract
     C                   IF        *ZERO > 0
     C                   IF        YL0136 = 'X' OR
     C                             YL0136 = 'F' OR
     C                             YL0136 = 'M' OR
     C                             YL0136 = 'K'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER1'      YL0135                         Pricing Valid E
      * CASE: PAR.USR Display 4 is No
     C                   IF        YL0134 = 'N'
     C                   MOVEL     'Y'           YL0134                         USR Display 4
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv Cust Prc Str/End  XF - Customer Price Header  * 
     C                   CALL      'PNTAXFR'                            90      Rtv Cust Prc St
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WABKC7        WQ0422                         Ship To Custome
     C                   PARM      *ZERO         WQ0423                         Price Code
     C     YL0142        PARM      *ZERO         WQ0424                         Price Start Dat
     C     YL0143        PARM      *ZERO         WQ0425                         Price End Date
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNTAXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Price Start Date is Not Entered
     C                   IF        YL0142 = 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER2'      YL0135                         Pricing Valid E
     C                   ELSE
      * CASE: *OTHERWISE
      * VAL: Contract Start & End Date
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Scheduled Ship Date LT LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date GT LCL.Price End Date
      *   '-
     C                   IF        YL0060 < YL0142 OR
     C                             YL0060 > YL0143
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER3'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * Rtv Max Wt and price  XF - Customer Price Detail  * 
     C                   CALL      'PNTBXFR'                            90      Rtv Max Wt and
     C                   PARM      *BLANK        W0RTN
     C     W0RTN         PARM      *BLANK        WQ0426                         *Return code
     C                   PARM      WABKC7        WQ0427                         Ship To Custome
     C                   PARM      *ZERO         WQ0428                         Price Code
     C                   PARM      WMHGCD        WQ0429                         Item Code
     C     YL0144        PARM      *ZERO         WQ0430                         Maximum Contrac
     C     YL0145        PARM      *ZERO         WQ0431                         Customer Price_
     C     YL0146        PARM      *BLANK        WQ0432                         Commodity Marke
     C     YL0147        PARM      *BLANK        WQ0433                         Price Method Co
     C     YL0148        PARM      *BLANK        WQ0434                         Date Method Cod
     C     YL0149        PARM      *BLANK        WQ0435                         Contract Unit T
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNTBXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER4'      YL0135                         Pricing Valid E
     C                   ELSE
      * CASE: *OTHERWISE
      * Sum weights shipped/ordered for ship to /price code
      *
     C                   Z-ADD     *ZERO         WN0010                         Total Weight Or
     C                   Z-ADD     *ZERO         WN0011                         Total Quantity
     C                   Z-ADD     *ZERO         WN0012                         Maximum Contrac
     C                   Z-ADD     *ZERO         WN0013                         Customer Price_
     C                   EVAL      WN0014 = ' '                                 Contract Unit T
      *
      * Clc Sum Ship/Ord Unit2 IF
     C                   MOVEL     'N'           YL0087                         Error Status
     C     WMAVQT        MULT      YL0076        YL0151                         Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                   CLEAR                   PERC
     C                   Z-ADD     WABKC7        PEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         PEBVTM                         Price Code
     C                   Z-ADD     WMHGCD        PEHGCD                         Item Code
      *
     C                   CALL      'PPA6XFR'                            90      CLC Sum Ship/Or
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PERC                           KEY: Order Deta
     C     WN0010        PARM      WN0010        WQ0436                         Total Weight Or
     C                   PARM      9999999       WQ0437                         Order Number
     C     WN0011        PARM      WN0011        WQ0438                         Total Quantity
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPA6XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ADD       YL0151        WN0010                         Total Weight Or
     C                   ADD       WMAVQT        WN0011                         Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                   CALL      'PPA7XFR'                            90      Rtv Cust Prc hd
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WABKC7        WQ0439                         Ship To Custome
     C                   PARM      *ZERO         WQ0440                         Price Code
     C     WUPLDT        PARM      *ZERO         WQ0441                         Price Start Dat
     C     WUPMDT        PARM      *ZERO         WQ0442                         Price End Date
     C                   PARM      WMHGCD        WQ0443                         Item Code
     C     WN0012        PARM      *ZERO         WQ0444                         Maximum Contrac
     C     WN0013        PARM      *ZERO         WQ0445                         Customer Price_
     C     YL0120        PARM      *BLANK        WQ0446                         Commodity Marke
     C     YL0152        PARM      *BLANK        WQ0447                         Price Method Co
     C     YL0126        PARM      *BLANK        WQ0448                         Date Method Cod
     C     WN0014        PARM      *BLANK        WQ0449                         Contract Unit T
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPA7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     YL0152        YL0110                         Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0101                         Company Number
     C                   MOVEL(P)  YL0152        WL0102                         Price Method Co
     C                   EXSR      SRRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0103        YL0136                         Price Method Ty
     C                   MOVEL(P)  WL0104        YL0137                         PMH Price Type
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C                   IF        WN0014 = 'W'
     C                   IF        WN0010 > WN0012
     C                   MOVEL     'Y'           YL0087                         Error Status
     C     WN0010        SUB       WN0012        YL0153                         Weight Allocate
     C                   MOVEL     'PRCERT'      YL0150                         Pricing Valid E
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C                   IF        WN0011 > WN0012
     C                   MOVEL     'Y'           YL0087                         Error Status
     C     WN0011        SUB       WN0012        YL0153                         Weight Allocate
     C                   MOVEL     'PRCERT'      YL0150                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C                   IF        YL0087 = 'N'
     C                   Z-ADD     WN0013        YL0127                         Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C                   IF        YL0137 = 'I'
     C                   Z-ADD     WN0013        YL0127                         Price Overage O
     C                   Z-ADD     *ZERO         YL0129                         OD Ceiling Pric
     C                   ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C                   IF        YL0137 = 'C'
     C                   Z-ADD     *ZERO         YL0127                         Price Overage O
     C                   Z-ADD     WN0013        YL0129                         OD Ceiling Pric
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 1
     C                   IF        YL0150 = @CN(109)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(110)      CAT(P)    @CN(111):ZQ   YL0154                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) 9999999' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0155        WQ0450                         Surrogate Numbe
     C                   PARM      9999999       WQ0451                         Order Number
     C                   PARM      'PRCER1'      WQ0452                         BOE Error Reaso
     C                   PARM      YL0154        WQ0453                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0156                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 1
     C                   IF        YL0150 = @CN(109)
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * VAL: Price Code Required
      * CASE: LCL.Price Method Type is Contract Pricing
     C                   IF        YL0136 = 'Q'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER5'      YL0135                         Pricing Valid E
      * CASE: PAR.USR Display 4 is No
     C                   IF        YL0134 = 'N'
     C                   MOVEL     'Y'           YL0134                         USR Display 4
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Market Price Date/Range
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0125 <> 0
     C                   MOVEL     '0'           Y0CX02
     C                   IF        YL0130 <> 0 OR
     C                             YL0131 <> 0
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER6'      YL0135                         Pricing Valid E
     C                   ELSE
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
      * CASE: PAR.OD Market Ending Date is not entered
     C                   IF        YL0130 > YL0131
     C                   IF        YL0131 = 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER7'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Published
      * CASE: LCL.Price Method Type is Published Pricing
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C                   IF        YL0136 = 'P'
     C                   IF        YL0127 <> 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER8'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   MOVEL     'SBD'         YL0120                         Commodity Marke
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C                   IF        YL0126 <> ' '
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCER9'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C                   IF        YL0129 <> 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERA'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c2 OR c3
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   IF        YL0130 <> 0 OR
     C                             YL0131 <> 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERB'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Manual/Extended
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c3    : LCL.Price Method Type is Extended Pricing
      *   '-
      * VAL: Price Overage Override for Price Method Type=Extended
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override is Equal zero
      *   |- c2    : LCL.Price Method Type is Extended Pricing
      *   '-
     C                   IF        YL0136 = 'M' OR
     C                             YL0136 = 'X'
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0127 = 0
     C                   IF        YL0136 = 'X'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERC'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Entered
     C                   IF        YL0120 <> ' '
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERD'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C                   IF        YL0126 <> ' '
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERE'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
      * Setup message data for message
     C                   IF        YL0129 <> 0
     C                   Z-ADD     YL0129        ZA0002                         OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                   MOVEL     'USR4333'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   Z-ADD     *ZERO         YL0129                         OD Ceiling Pric
     C                   END                                                    *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   IF        YL0125 <> 0 OR
     C                             YL0130 <> 0 OR
     C                             YL0131 <> 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERF'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Manual Pricing
      * CASE: LCL.Price Method Type is Manual Pricing
      * VAL: Manual Price Range
      * CASE: PAR.Billing Activity Type is Not Warehouse Transfer
     C                   IF        YL0136 = 'M'
      * CASE: PAR.Primal Group Code is NE Samples or Cut Loss
     C                   IF        YL0124 = '2' OR
     C                             YL0124 = '3' OR
     C                             YL0124 = '1'
      * RMC S14013 remove chk for type n= Promo/Samples- we want them val
      *
     C                   IF        YL0095 <> 'UNID'
     C                   Z-ADD     *ZERO         WN0015                         Manual Price Ac
     C                   Z-ADD     *ZERO         WN0016                         CoPk_FdSrv ManP
     C                   Z-ADD     *ZERO         WN0017                         Percent 7.4 USR
     C                   Z-ADD     *ZERO         WN0018                         Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                   Z-ADD     *ZERO         YL0157                         Projected Marke
     C                   Z-ADD     *ZERO         YL0159                         Minimum Price
     C                   Z-ADD     *ZERO         YL0160                         Maximum Price
     C                   MOVEL     'Y'           YL0158                         Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0105                         Company Number
     C                   EXSR      SSRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0106        WN0015                         Manual Price Ac
     C                   Z-ADD     WL0107        WN0016                         CoPk_FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C                   IF        YL0092 = 'FSV' OR
     C                             YL0092 = 'CPK'
     C                   Z-ADD     WN0016        WN0015                         Manual Price Ac
     C                   END                                                    *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0120        WL0108                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0109                         Commodity Price
     C                   Z-ADD     9999999       WL0110                         Market Price Da
     C                   EXSR      STRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0111        YL0157                         Commodity Marke
     C                   Z-ADD     WL0112        WUE7DT                         USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C     YL0157        ADD       YL0141        W0WB01                         *Synon (15,5) w
     C     YL0133        DIV(H)    100           W0WB02                         *Synon (15,5) w
     C     W0WB01        ADD       W0WB02        W0WB00                         *Synon (15,5) w
     C                   Z-ADD     W0WB00        YL0157                         Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C                   IF        W0RTN = ' '
     C     WN0015        DIV(H)    100           W0WD02                         *Synon (17,7) w
     C     1             SUB       W0WD02        W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0159                         Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C     WN0015        DIV(H)    100           W0WD02                         *Synon (17,7) w
     C     W0WD02        ADD       1             W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0160                         Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0127 >= YL0159
     C                   IF        YL0127 <= YL0160
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'N'           YL0158                         Error Status  3
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0092        WL0108                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0109                         Commodity Price
     C                   Z-ADD     9999999       WL0110                         Market Price Da
     C                   EXSR      STRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0111        YL0157                         Commodity Marke
     C                   Z-ADD     WL0112        WUE7DT                         USR Date Priced
      * CASE: PGM.*Return code is *Normal
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C                   IF        W0RTN = ' '
     C     WN0015        DIV(H)    100           W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0159                         Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C     WN0015        DIV(H)    100           W0WD02                         *Synon (17,7) w
     C     W0WD02        ADD       1             W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0160                         Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0127 >= YL0159
     C                   IF        YL0127 <= YL0160
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'N'           YL0158                         Error Status  3
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0157                         Projected Marke
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     YL0157        YL0128                         Unit Price_Cred
     C                   END                                                    *FI
      * CASE: LCL.Error Status  3 is Yes
      * CASE: LCL.Projected Market Price is Not Zeros
     C                   IF        YL0158 = 'Y'
      * Setup message data for message
     C                   IF        YL0157 <> 0
     C                   Z-ADD     YL0127        ZA0003                         Price Overage O
      * Send message 'Manual price within Prcnt'
     C                   MOVEL     'USR2351'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERG'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Contract
      * CASE: LCL.Price Method Type is Contract Pricing
      * VAL: Commodity Market Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Commodity Market Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                   IF        YL0136 = 'Q'
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0120 <> ' '
     C                   IF        YL0137 = 'I'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERH'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Date Method Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0126 <> ' '
     C                   IF        YL0137 = 'I'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERI'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Ceiling Price
      * CASE: LCL.PMH Price Type is Invoice Price
      * ERR: Ceiling Price not allowed
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C                   IF        YL0137 = 'I'
      * Setup message data for message
     C                   IF        YL0129 <> 0
     C                   Z-ADD     YL0129        ZA0004                         OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                   MOVEL     'USR4333'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   Z-ADD     *ZERO         YL0129                         OD Ceiling Pric
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * ERR: Ceiling Price Required
      * CASE: PAR.OD Ceiling Price is Equal zero
     C                   IF        YL0129 = 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERJ'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   Z-ADD     YL0129        YL0128                         Unit Price_Cred
     C                   END                                                    *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   IF        YL0125 <> 0 OR
     C                             YL0130 <> 0 OR
     C                             YL0131 <> 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERK'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Market/Formula
      * CASE: LCL.Price Method Type is Market or Formula
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C                   IF        YL0136 = 'F' OR
     C                             YL0136 = 'K'
     C                   IF        YL0127 <> 0
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERL'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Not Entered
     C                   IF        YL0120 = ' '
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERM'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
      * VAL Date Method Exists RT - Market Date Method  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0126 <> ' '
     C                   Z-ADD     WAAIC3        WL0113                         Company Number
     C                   MOVEL(P)  YL0126        WL0114                         Date Method Cod
     C                   MOVEL(P)  'O'           WL0116                         System using Da
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0115        YN0163                         Date Method Des
      * ERR: Date Method Code Invalid
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERN'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ERR: Date Method Entered & Market Price Date/Range Entered
      * CASE:
      *  - (c1 AND c2) OR (c1 AND c3 AND c4)
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   |- c3    : PAR.OD Market Begin Date is Entered
      *   |- c4    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0126 <> ' '
     C                   IF        YL0125 <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 <> '1'
     C                   IF        YL0126 <> ' '
     C                   IF        YL0130 <> 0
     C                   IF        YL0131 <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERO'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * ERR: Date Method = Blank and Market Price Date/Rage = Zero
      * CASE: (No Market Dates Entered)
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : PAR.Date Method Code is Not Entered
      *   |- c2    : PAR.Market Pricing Date is EQ Zero
      *   |- c3    : PAR.OD Market Begin Date is not entered
      *   |- c4    : PAR.OD Market Ending Date is not entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0126 = ' '
     C                   IF        YL0125 = 0
     C                   IF        YL0130 = 0
     C                   IF        YL0131 = 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERP'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * ERR: Market Price Date & Market Price Date Range Entered
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0125 <> 0
     C                   MOVEL     '0'           Y0CX02
     C                   IF        YL0130 <> 0 OR
     C                             YL0131 <> 0
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERQ'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * ERR: Market Price Begin Date > Market Price Ending Date
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C                   IF        YL0130 > YL0131
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERR'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0120        WL0117                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0118                         Commodity Price
     C                   EXSR      SVRVGN
      * VAL: Commodity Market Price Exists
      * CASE: PGM.*Return code is *Record does not exist
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C                   IF        W0RTN = @CN(003)
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0120 <> YL0092
     C                   MOVEL(P)  YL0092        WL0117                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0118                         Commodity Price
     C                   EXSR      SVRVGN
      * Use Company Item
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERS'      YL0135                         Pricing Valid E
     C                   ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                   MOVEL     YL0120        ZA0005                         Commodity Marke
     C                   MOVEL     YL0138        ZA0006                         Commodity Price
     C                   MOVEL     YL0092        ZA0007                         Default Commod
      * Send message 'No Price Mkt/Group Deflt'
     C                   MOVEL     'USR2350'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0087                         Error Status
     C                   MOVEL     'PRCERS'      YL0135                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Error processing
      * CASE: LCL.Pricing Valid Error Cde U is NE *Blank
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 1
     C                   IF        YL0135 <> ' '
     C                   IF        YL0135 = @CN(109)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(112)      CAT(P)    @CN(111):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0454                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0455                         Order Number
     C                   PARM      'PRCER1'      WQ0456                         BOE Error Reaso
     C                   PARM      YL0088        WQ0457                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 2
     C                   IF        YL0135 = @CN(113)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(114)      CAT(P)    @CN(115):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0458                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0459                         Order Number
     C                   PARM      'PRCER2'      WQ0460                         BOE Error Reaso
     C                   PARM      YL0088        WQ0461                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 3
     C                   IF        YL0135 = @CN(116)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(117)      CAT(P)    @CN(118):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0462                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0463                         Order Number
     C                   PARM      'PRCER3'      WQ0464                         BOE Error Reaso
     C                   PARM      YL0088        WQ0465                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 4
     C                   IF        YL0135 = @CN(119)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(120)      CAT(P)    @CN(121):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0466                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0467                         Order Number
     C                   PARM      'PRCER4'      WQ0468                         BOE Error Reaso
     C                   PARM      YL0088        WQ0469                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 5
     C                   IF        YL0135 = @CN(122)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(123)      CAT(P)    @CN(124):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0470                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0471                         Order Number
     C                   PARM      'PRCER5'      WQ0472                         BOE Error Reaso
     C                   PARM      YL0088        WQ0473                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 6
     C                   IF        YL0135 = @CN(125)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(126)      CAT(P)    @CN(127):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0474                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0475                         Order Number
     C                   PARM      'PRCER6'      WQ0476                         BOE Error Reaso
     C                   PARM      YL0088        WQ0477                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 7
     C                   IF        YL0135 = @CN(128)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(129)      CAT(P)    @CN(130):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0478                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0479                         Order Number
     C                   PARM      'PRCER7'      WQ0480                         BOE Error Reaso
     C                   PARM      YL0088        WQ0481                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 8
     C                   IF        YL0135 = @CN(131)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(132)      CAT(P)    @CN(133):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0482                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0483                         Order Number
     C                   PARM      'PRCER8'      WQ0484                         BOE Error Reaso
     C                   PARM      YL0088        WQ0485                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 9
     C                   IF        YL0135 = @CN(134)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(135)      CAT(P)    @CN(136):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0486                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0487                         Order Number
     C                   PARM      'PRCER9'      WQ0488                         BOE Error Reaso
     C                   PARM      YL0088        WQ0489                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error B
     C                   IF        YL0135 = @CN(137)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(138)      CAT(P)    @CN(139):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0490                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0491                         Order Number
     C                   PARM      'PRCERB'      WQ0492                         BOE Error Reaso
     C                   PARM      YL0088        WQ0493                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error C
     C                   IF        YL0135 = @CN(140)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(141)      CAT(P)    @CN(142):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0494                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0495                         Order Number
     C                   PARM      'PRCERC'      WQ0496                         BOE Error Reaso
     C                   PARM      YL0088        WQ0497                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error D
     C                   IF        YL0135 = @CN(143)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(144)      CAT(P)    @CN(142):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0498                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0499                         Order Number
     C                   PARM      'PRCERD'      WQ0500                         BOE Error Reaso
     C                   PARM      YL0088        WQ0501                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error E
     C                   IF        YL0135 = @CN(145)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(146)      CAT(P)    @CN(136):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0502                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0503                         Order Number
     C                   PARM      'PRCERE'      WQ0504                         BOE Error Reaso
     C                   PARM      YL0088        WQ0505                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error F
     C                   IF        YL0135 = @CN(147)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(148)      CAT(P)    @CN(149):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0506                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0507                         Order Number
     C                   PARM      'PRCERF'      WQ0508                         BOE Error Reaso
     C                   PARM      YL0088        WQ0509                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error G
     C                   IF        YL0135 = @CN(150)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(151)      CAT(P)    @CN(152):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0510                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0511                         Order Number
     C                   PARM      'PRCERG'      WQ0512                         BOE Error Reaso
     C                   PARM      YL0088        WQ0513                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error H
     C                   IF        YL0135 = @CN(153)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(154)      CAT(P)    @CN(142):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0514                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0515                         Order Number
     C                   PARM      'PRCERH'      WQ0516                         BOE Error Reaso
     C                   PARM      YL0088        WQ0517                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error I
     C                   IF        YL0135 = @CN(155)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(146)      CAT(P)    @CN(136):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0518                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0519                         Order Number
     C                   PARM      'PRCERI'      WQ0520                         BOE Error Reaso
     C                   PARM      YL0088        WQ0521                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error J
     C                   IF        YL0135 = @CN(156)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(157)      CAT(P)    @CN(158):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0522                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0523                         Order Number
     C                   PARM      'PRCERJ'      WQ0524                         BOE Error Reaso
     C                   PARM      YL0088        WQ0525                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error K
     C                   IF        YL0135 = @CN(159)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(160)      CAT(P)    @CN(161):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0526                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0527                         Order Number
     C                   PARM      'PRCERK'      WQ0528                         BOE Error Reaso
     C                   PARM      YL0088        WQ0529                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error L
     C                   IF        YL0135 = @CN(162)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(163)      CAT(P)    @CN(164):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0530                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0531                         Order Number
     C                   PARM      'PRCERL'      WQ0532                         BOE Error Reaso
     C                   PARM      YL0088        WQ0533                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error M
     C                   IF        YL0135 = @CN(165)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(166)      CAT(P)    @CN(167):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0534                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0535                         Order Number
     C                   PARM      'PRCERM'      WQ0536                         BOE Error Reaso
     C                   PARM      YL0088        WQ0537                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error N
     C                   IF        YL0135 = @CN(168)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(169)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0538                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0539                         Order Number
     C                   PARM      'PRCERN'      WQ0540                         BOE Error Reaso
     C                   PARM      YL0088        WQ0541                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error O
     C                   IF        YL0135 = @CN(170)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(171)      CAT(P)    @CN(172):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0542                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0543                         Order Number
     C                   PARM      'PRCERO'      WQ0544                         BOE Error Reaso
     C                   PARM      YL0088        WQ0545                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error P
     C                   IF        YL0135 = @CN(173)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(174)      CAT(P)    ' ':ZQ        YL0088                         BOE Error Comme
      * **  Did not create PRCERP as is is a duplicate. Used PRCERN
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0546                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0547                         Order Number
     C                   PARM      'PRCERN'      WQ0548                         BOE Error Reaso
     C                   PARM      YL0088        WQ0549                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error Q
     C                   IF        YL0135 = @CN(175)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(176)      CAT(P)    @CN(177):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0550                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0551                         Order Number
     C                   PARM      'PRCERQ'      WQ0552                         BOE Error Reaso
     C                   PARM      YL0088        WQ0553                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error R
     C                   IF        YL0135 = @CN(178)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(129)      CAT(P)    @CN(130):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0554                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0555                         Order Number
     C                   PARM      'PRCERR'      WQ0556                         BOE Error Reaso
     C                   PARM      YL0088        WQ0557                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error S
     C                   IF        YL0135 = @CN(179)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(180)      CAT(P)    @CN(181):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0558                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0559                         Order Number
     C                   PARM      'PRCERS'      WQ0560                         BOE Error Reaso
     C                   PARM      YL0088        WQ0561                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error T
     C                   IF        YL0135 = @CN(182)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(183)      CAT(P)    @CN(184):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0562                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0563                         Order Number
     C                   PARM      'PRCERT'      WQ0564                         BOE Error Reaso
     C                   PARM      YL0088        WQ0565                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     WMAVQT        MULT      YL0076        YL0161                         Weight Ordered
      * Exc Calc Ord ExemptCd XF - Order Header TRG  * 
     C                   CALL      'PPSLXFR'                            90      Exc Calc Ord Ex
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0566                         Company Number
     C                   PARM      9999999       WQ0567                         Order Number
     C                   PARM      WABKC7        WQ0568                         Ship To Custome
     C     YL0097        PARM      YL0097        WQ0569                         OH TF Exempt Co
     C     YL0162        PARM      YL0162        WQ0570                         Error Flag
     C                   PARM      'Y'           WQ0571                         Error Status  2
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPSLXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Error checking...
      * CASE: LCL.Error Flag            USR is Yes
     C                   IF        YL0162 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(185)      CAT(P)    @CN(186):ZQ   YL0088                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0572                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0573                         Order Number
     C                   PARM      'TFEXMX'      WQ0574                         BOE Error Reaso
     C                   PARM      YL0088        WQ0575                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** If TF Exempt Code is not *Blank...
      * CASE: LCL.OH TF Exempt Code NE LCL.Blank 1 USR
      * Upd Block Order Qtemp XF - Order Header TRG  * 
     C                   IF        YL0097 <> YL0163
     C                   CALL      'PUZ8XFR'                            90      Upd Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0576                         Company Number
     C                   PARM      9999999       WQ0577                         Order Number
     C                   PARM      YL0097        WQ0578                         OH TF Exempt Co
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUZ8XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * ** Test to see if we need to update Detail record again.
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10
      *   |- c1    : LCL.Date Method Code is Entered
      *   |- c2    : LCL.Weight Ordered is Not equal zero
      *   |- c3    : LCL.Unit Price_Credit is Not Zeros
      *   |- c4    : LCL.Market Pricing Date is NE Zero
      *   |- c5    : LCL.Commodity Market Code is Entered
      *   |- c6    : LCL.Price Method Code is Not Blank
      *   |- c7    : LCL.Price Overage Override is Not Zeros
      *   |- c8    : LCL.OD Ceiling Price is Not Zeros
      *   |- c9    : LCL.OD Market Begin Date is Entered
      *   |- c10   : LCL.OD Market Ending Date is Entered
      *   '-
      * Upd Block Order Qtemp XF - Order Detail  * 
     C                   IF        YL0126 <> ' ' OR
     C                             YL0161 <> 0 OR
     C                             YL0128 <> 0 OR
     C                             YL0125 <> 0 OR
     C                             YL0120 <> ' ' OR
     C                             YL0110 <> ' ' OR
     C                             YL0127 <> 0 OR
     C                             YL0129 <> 0 OR
     C                             YL0130 <> 0 OR
     C                             YL0131 <> 0
     C                   CALL      'PUZ9XFR'                            90      Upd Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0579                         Company Number
     C                   PARM      9999999       WQ0580                         Order Number
     C                   PARM      WMDXNB        WQ0581                         Order Sequence
     C                   PARM      1             WQ0582                         Order Secondary
     C                   PARM      YL0125        WQ0583                         Market Pricing
     C                   PARM      YL0120        WQ0584                         Commodity Marke
     C                   PARM      YL0126        WQ0585                         Date Method Cod
     C                   PARM      WMQ7CD        WQ0586                         Price Method Co
     C                   PARM      WMBZPR        WQ0587                         Price Overage O
     C                   PARM      YL0161        WQ0588                         Weight Ordered
     C                   PARM      YL0128        WQ0589                         Unit Price_Cred
     C                   PARM      YL0129        WQ0590                         OD Ceiling Pric
     C                   PARM      YL0130        WQ0591                         OD Market Begin
     C                   PARM      YL0131        WQ0592                         OD Market Endin
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUZ9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * UPD Order Weight - Order Header TRG  * 
     C                   CLEAR                   PFRC
     C                   Z-ADD     WAAIC3        PFAIC3                         Company Number
     C                   Z-ADD     9999999       PFC4NB                         Order Number
      *
     C                   CALL      'PVFEXFR'                            90      UPD Order Weigh
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PFRC                           KEY: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVFEXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C     KRSSN         READE     @C3CPL9                                90    *
     C                   ENDDO
      *================================================================
     CSR   SNEXIT        ENDSR
      /EJECT
     CSR   SORVGN        BEGSR
      *================================================================
      * Rtv Credit Item Sts   RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSO         KLIST
     C                   KFLD                    WOAIC3                         Company Number
     C                   KFLD                    WOHGCD                         Item Code
      * Setup key
     C                   Z-ADD     WL0053        WOAIC3                         Company Number
     C                   Z-ADD     WL0054        WOHGCD                         Item Code
      * Establish starting position
     C     KRSSO         CHAIN     @BZREJU                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0326'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0055 = ' '                                 Credit Item Sta
     C                   GOTO      SOEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WOVMST        WL0055                         Credit Item Sta
     C                   ENDIF
      *================================================================
     CSR   SOEXIT        ENDSR
      /EJECT
     CSR   SPRVGN        BEGSR
      *================================================================
      * VAL Ham Group/Item     RT - Ham Group Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSP         KLIST
     C                   KFLD                    WRA1AA                         Ham Group Numbe
     C                   KFLD                    WRDPC7                         Ham Group Item
      * Setup key
     C                   Z-ADD     WL0056        WRA1AA                         Ham Group Numbe
     C                   Z-ADD     WL0057        WRDPC7                         Ham Group Item
      * Establish starting position
     C     KRSSP         CHAIN     @M1REJ2                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2839'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SPEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   ENDIF
      *================================================================
     CSR   SPEXIT        ENDSR
      /EJECT
     CSR   SQRVGN        BEGSR
      *================================================================
      * RTV All fields - Company Customer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSQ         KLIST
     C                   KFLD                    WSAIC3                         Company Number
     C                   KFLD                    WSBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     WL0058        WSAIC3                         Company Number
     C                   Z-ADD     WL0059        WSBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSQ         CHAIN     @EOREXM                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1007'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SQEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   MOVEL     'Y2U0003'     W0RTN                          *Return code
      * PAR = DB1 By name
     C                   MOVEL     WSAQCD        WL0060                         Terms Code
     C                   MOVEL     WSR4CD        WL0061                         Sales Route Cod
     C                   MOVEL     WSBYNA        WL0062                         Special Instruc
     C                   MOVEL     WSB6NA        WL0063                         Special Instruc
     C                   MOVEL     WSBZNA        WL0064                         Carrier Code
     C                   MOVEL     WSLLST        WL0065                         Broker
     C                   MOVEL     WSPPST        WL0066                         P_O Required Fl
     C                   Z-ADD     WSR5NB        WL0067                         Deliver after t
     C                   Z-ADD     WSR6NB        WL0068                         Deliver before
     C                   MOVEL     WSQGST        WL0069                         Alt Remittance
     C                   MOVEL     WSBOCD        WL0070                         Type Code
     C                   Z-ADD     WSTBNB        WL0071                         Absorbed Freigh
     C                   Z-ADD     WSMTCU        WL0072                         Mileage To Cust
     C                   Z-ADD     WSW2NB        WL0073                         Co_Cust Overage
     C                   MOVEL     WSRPCD        WL0074                         Age Code
     C                   MOVEL     WSAJCD        WL0075                         Warehouse Code
     C                   MOVEL     WSX9ST        WL0076                         Outside Warehou
     C                   MOVEL     WST9CD        WL0077                         Customer Group
     C                   MOVEL     WSUBCD        WL0078                         Customer Group
     C                   MOVEL     WSISTX        WL0079                         G_L Code
     C                   MOVEL     WSLQCD        WL0080                         Commodity Marke
     C                   MOVEL     WSNJNA        WL0081                         Credit Contact
     C                   MOVEL     WSI0TX        WL0082                         Credit Contact
     C                   MOVEL     WSNKNA        WL0083                         Credit Contact
     C                   MOVEL     WSI1TX        WL0084                         Credit Contact
     C                   MOVEL     WSVLST        WL0085                         Allow Man_Qt WO
     C                   MOVEL     WSRLST        WL0086                         Fax Invoice Fla
     C                   MOVEL     WSMMTX        WL0087                         Fax Invoice Fax
     C                   MOVEL     WSOHNA        WL0088                         Fax Invoice Con
     C                   MOVEL     WSQ6ST        WL0089                         Distributor
     C                   MOVEL     WSQ8ST        WL0090                         Default Shippin
     C                   MOVEL     WSRBST        WL0091                         Ord Ent Default
     C                   MOVEL     WSREST        WL0092                         Bypass DDt_Dela
     C                   MOVEL     WSUVST        WL0093                         EDI Status 1
     C                   MOVEL     WSUWST        WL0094                         EDI Status 2
     C                   MOVEL     WSUXST        WL0095                         EDI Status 3
     C                   MOVEL     WSVSST        WL0096                         Record Status
     C                   Z-ADD     WSAATM        WL0097                         Job Time
     C                   MOVEL     WSAYNA        WL0098                         User Id
     C                   MOVEL     WSA0NA        WL0099                         Job Name
     C                   Z-ADD     WSAXDT        WL0100                         Job Date
     C                   ENDIF
      *================================================================
     CSR   SQEXIT        ENDSR
      /EJECT
     CSR   SRRVGN        BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSR         KLIST
     C                   KFLD                    WTAIC3                         Company Number
     C                   KFLD                    WTQ7CD                         Price Method Co
      * Setup key
     C                   Z-ADD     WL0101        WTAIC3                         Company Number
     C                   MOVEL     WL0102        WTQ7CD                         Price Method Co
      * Establish starting position
     C     KRSSR         CHAIN     @IHRERN                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1665'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0103 = ' '                                 Price Method Ty
     C                   EVAL      WL0104 = ' '                                 PMH Price Type
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WTV8ST        WL0103                         Price Method Ty
     C                   MOVEL     WTH3ST        WL0104                         PMH Price Type
     C                   ENDIF
      *================================================================
     CSR   SREXIT        ENDSR
      /EJECT
     CSR   SSRVGN        BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSS         KLIST
     C                   KFLD                    WVAIC3                         Company Number
      * Setup key
     C                   Z-ADD     WL0105        WVAIC3                         Company Number
      * Establish starting position
     C     KRSSS         CHAIN     @ASREVL                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0049'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   Z-ADD     *ZERO         WL0106                         Manual Price Ac
     C                   Z-ADD     *ZERO         WL0107                         CoPk_FdSrv ManP
     C                   GOTO      SSEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WVAIPC        WL0106                         Manual Price Ac
     C                   Z-ADD     WVASPC        WL0107                         CoPk_FdSrv ManP
     C                   ENDIF
      *================================================================
     CSR   SSEXIT        ENDSR
      /EJECT
     CSR   STRVGN        BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSST         KLIST
     C                   KFLD                    WQST01                         Commodity Marke
     C                   KFLD                    WQST02                         Commodity Price
     C                   KFLD                    WWEQDT                         Market Price Da
      * Define keylist
     C     KRSST         KLIST
     C                   KFLD                    WQST01                         Commodity Marke
     C                   KFLD                    WQST02                         Commodity Price
      * Setup key
     C                   MOVEL     WL0108        WQST01                         Commodity Marke
     C                   MOVEL     WL0109        WQST02                         Commodity Price
     C                   Z-ADD     WL0110        WWEQDT                         Market Price Da
      * Establish starting position
     C     KPSST         SETLL     @F0CPEP                                      *
     C     KRSST         READE     @F0CPEP                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1222'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   Z-ADD     *ZERO         WL0111                         Commodity Marke
     C                   Z-ADD     *ZERO         WL0112                         USR Date Priced
     C                   GOTO      STEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   Z-ADD     WWA5PR        WL0111                         Commodity Marke
     C                   Z-ADD     WWEQDT        WL0112                         USR Date Priced
     C                   GOTO      STEXIT                                       *QUIT
     C     KRSST         READE     @F0CPEP                                90    *
     C                   ENDDO
      *================================================================
     CSR   STEXIT        ENDSR
      /EJECT
     CSR   SURVGN        BEGSR
      *================================================================
      * VAL Date Method Exists RT - Market Date Method  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSU         KLIST
     C                   KFLD                    WQSU01                         System using Da
     C                   KFLD                    WQSU02                         Company Number
     C                   KFLD                    WQSU03                         Date Method Cod
      * Setup key
     C                   MOVEL     WL0116        WQSU01                         System using Da
     C                   Z-ADD     WL0113        WQSU02                         Company Number
     C                   MOVEL     WL0114        WQSU03                         Date Method Cod
      * Establish starting position
     C     KRSSU         SETLL     @IPREFJ                                      *
     C     KRSSU         READE     @IPREFJ                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1681'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0115 = ' '                                 Date Method Des
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SUEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WXMNNA        WL0115                         Date Method Des
     C     KRSSU         READE     @IPREFJ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SUEXIT        ENDSR
      /EJECT
     CSR   SVRVGN        BEGSR
      *================================================================
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSV         KLIST
     C                   KFLD                    WQSV01                         Commodity Marke
     C                   KFLD                    WQSV02                         Commodity Price
      * Setup key
     C                   MOVEL     WL0117        WQSV01                         Commodity Marke
     C                   MOVEL     WL0118        WQSV02                         Commodity Price
      * Establish starting position
     C     KRSSV         SETLL     @F0CPVR                                      *
     C     KRSSV         READE     @F0CPVR                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1222'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SVEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   GOTO      SVEXIT                                       *QUIT
     C     KRSSV         READE     @F0CPVR                                90    *
     C                   ENDDO
      *================================================================
     CSR   SVEXIT        ENDSR
      /EJECT
     CSR   SWCHRC        BEGSR
      *================================================================
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * Update
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @C2CPL5
     C                   Z-ADD     WL0119        TAHQNZ                         Surrogate Numbe
      *
     C     KLCHSW        KLIST
     C                   KFLD                    TAHQNZ                         Surrogate Numbe
     C     KLCHSW        CHAIN     @C2CPL5                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PUC2CPL0'    MDACP
     C                   MOVEL     '@C2CPL5'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SWEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SWEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPUC21        YARDCS
      * Move non-key fields to @C2CPL5
     C                   Z-ADD     WL0120        TAAIC3                         Company Number
     C                   Z-ADD     WL0121        TAC4NB                         Order Number
     C                   MOVEL(P)  WL0122        TAGWST                         Header Status
     C                   Z-ADD     WL0123        TABKC7                         Ship To Custome
     C                   MOVEL(P)  WL0124        TAAJCD                         Warehouse Code
     C                   Z-ADD     WL0125        TAA5DT                         Requested Ship
     C                   Z-ADD     WL0126        TAACDT                         Cancel Date
     C                   MOVEL(P)  WL0127        TAC3TX                         OHE Spot Buy
     C                   MOVEL(P)  WL0128        TABCNA                         Customer Purcha
     C                   MOVEL(P)  WL0129        TAU2ST                         Export Status
     C                   MOVEL(P)  WL0130        TAKXCD                         Country Code
     C                   MOVEL(P)  WL0131        TALWAA                         OHE Intended fo
     C                   MOVEL(P)  WL0132        TAFQSX                         Export Docs Go
     C                   MOVEL(P)  WL0133        TAVEST                         Palletize
     C                   MOVEL(P)  WL0134        TAVGST                         Slip Sheet
     C                   MOVEL(P)  WL0135        TAQ2CD                         Shipping Method
     C                   Z-ADD     WL0136        TARNNB                         Reefer Temperat
     C                   MOVEL(P)  WL0137        TAN6SC                         Record Processe
     C                   MOVEL(P)  WL0138        TAOOSC                         Email Sent
     C                   Z-ADD     WL0139        TAEIDT                         Requested Deliv
     C                   MOVEL(P)  WL0140        TAVFST                         Shrink Wrap
     C                   MOVEL(P)  WL0141        TAVSST                         Record Status
     C                   Z-ADD     WL0142        TAMJDT                         Create Date
     C                   Z-ADD     WL0143        TABETM                         Create Time
     C                   MOVEL(P)  WL0144        TACCVN                         Create User
     C                   MOVEL(P)  WL0145        TACDVN                         Create Program
     C                   Z-ADD     WL0146        TAMKDT                         Change Date
     C                   Z-ADD     WL0147        TABFTM                         Change Time
     C                   MOVEL(P)  WL0148        TACEVN                         Change User
     C                   MOVEL(P)  WL0149        TACFVN                         Change Program
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUC21 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @C2CPL5                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PUC2CPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SWEXIT        ENDSR
      /EJECT
     CSR   SXRVGN        BEGSR
      *================================================================
      * RTV Chk Existence      RT - WF Block Order Errors  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSX         KLIST
     C                   KFLD                    WQSX01                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     WAHQNZ        WQSX01                         Surrogate Numbe
      * Establish starting position
     C     KRSSX         SETLL     @C5CPMF                                      *
     C     KRSSX         READE     @C5CPMF                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5305'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SXEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   GOTO      SXEXIT                                       *QUIT
     C     KRSSX         READE     @C5CPMF                                90    *
     C                   ENDDO
      *================================================================
     CSR   SXEXIT        ENDSR
      /EJECT
     CSR   SYRVGN        BEGSR
      *================================================================
      * RTV Crt Blck Ord Trns RT - WF Block Order Trans  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSY         KLIST
     C                   KFLD                    WBHQNZ                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     WAHQNZ        WBHQNZ                         Surrogate Numbe
      * Establish starting position
     C     KRSSY         CHAIN     @C4CPMC                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5303'     W0RTN
      * USER: Processing if Data record not found
      * Crt Block Order Trans CR - WF Block Order Trans  * 
     C                   EXSR      SZCRRC
     C                   GOTO      SYEXIT
     C                   ENDIF
      *
      *================================================================
     CSR   SYEXIT        ENDSR
      /EJECT
     CSR   SZCRRC        BEGSR
      *================================================================
      * Crt Block Order Trans CR - WF Block Order Trans  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0019                         Create Date
     C                   Z-ADD     *ZERO         WN0020                         Create Time
     C                   EVAL      WN0021 = ' '                                 Create User
     C                   EVAL      WN0022 = ' '                                 Create Program
     C                   Z-ADD     *ZERO         WN0023                         Change Date
     C                   Z-ADD     *ZERO         WN0024                         Change Time
     C                   EVAL      WN0025 = ' '                                 Change User
     C                   EVAL      WN0026 = ' '                                 Change Program
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @C4CPMB
     C                   Z-ADD     WAHQNZ        TCHQNZ                         Surrogate Numbe
     C                   Z-ADD     WAAIC3        TCAIC3                         Company Number
     C                   Z-ADD     YL0164        TCC4NB                         Order Number
     C                   MOVEL     'Y'           TCN6SC                         Record Processe
     C                   MOVEL     'A'           TCVSST                         Record Status
      *
      * USER: Processing before Data update
      * Set Crt Date/Time 2    IF
      * *** Set CREATE fields. ***
     C                   Z-ADD     ##JDT         TCMJDT                         Create Date
     C                   Z-ADD     ##JTM         TCBETM                         Create Time
     C                   MOVEL     ##USR         TCCCVN                         Create User
     C                   MOVEL     ##PGM         TCCDVN                         Create Program
      * *** Set CHANGE fields. ***
     C                   Z-ADD     *ZERO         TCMKDT                         Change Date
     C                   Z-ADD     *ZERO         TCBFTM                         Change Time
     C                   EVAL      TCCEVN = ' '                                 Change User
     C                   EVAL      TCCFVN = ' '                                 Change Program
     C     KLCRSZ        KLIST
     C                   KFLD                    TCHQNZ                         Surrogate Numbe
      * Check for duplicate primary key
     C     KLCRSZ        SETLL     @C4CPMB                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5304'     W0RTN
      * Send message 'WF Block Order Trans   EX'
     C                   MOVEL     'USR5304'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SZEXIT
     C                   ENDIF
      *
     C                   WRITE     @C4CPMB                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SZEXIT        ENDSR
      /EJECT
     CSR   TARVGN        BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * Check Order Stat
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTA         KLIST
     C                   KFLD                    TDAIC3                         Company Number
     C                   KFLD                    TDC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WL0150        TDAIC3                         Company Number
     C                   Z-ADD     WL0151        TDC4NB                         Order Number
      * Establish starting position
     C     KRSTA         CHAIN     @BECPFK                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0176'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0152 = ' '                                 Order Type_Sale
     C                   Z-ADD     *ZERO         WL0153                         AR Customer Num
     C                   Z-ADD     *ZERO         WL0154                         Ship To Custome
     C                   EVAL      WL0155 = ' '                                 Ship To Name
     C                   EVAL      WL0156 = ' '                                 Ship To Address
     C                   EVAL      WL0157 = ' '                                 Ship To Address
     C                   EVAL      WL0158 = ' '                                 Ship To Address
     C                   EVAL      WL0159 = ' '                                 Ship To City
     C                   EVAL      WL0160 = ' '                                 Ship To State C
     C                   EVAL      WL0161 = ' '                                 Ship To Zip_Pos
     C                   Z-ADD     *ZERO         WL0162                         Bill to Custome
     C                   EVAL      WL0163 = ' '                                 Bill to Name
     C                   EVAL      WL0164 = ' '                                 Bill to Address
     C                   EVAL      WL0165 = ' '                                 Bill to Address
     C                   EVAL      WL0166 = ' '                                 Bill to Address
     C                   EVAL      WL0167 = ' '                                 Bill to City
     C                   EVAL      WL0168 = ' '                                 Bill to State C
     C                   EVAL      WL0169 = ' '                                 Bill to Zip_Pos
     C                   EVAL      WL0170 = ' '                                 Customer Purcha
     C                   Z-ADD     *ZERO         WL0171                         Order Date
     C                   Z-ADD     *ZERO         WL0172                         Requested Ship
     C                   Z-ADD     *ZERO         WL0173                         Actual Shipped
     C                   Z-ADD     *ZERO         WL0174                         Cancel Date
     C                   EVAL      WL0175 = ' '                                 Terms Code
     C                   EVAL      WL0176 = ' '                                 Special Instruc
     C                   EVAL      WL0177 = ' '                                 Special Instruc
     C                   EVAL      WL0178 = ' '                                 Carrier Code
     C                   EVAL      WL0179 = ' '                                 Comment Print A
     C                   EVAL      WL0180 = ' '                                 Comment Print I
     C                   EVAL      WL0181 = ' '                                 Comment Print P
     C                   EVAL      WL0182 = ' '                                 Comment Print S
     C                   EVAL      WL0183 = ' '                                 Reason Code
     C                   EVAL      WL0184 = ' '                                 Order in Use
     C                   EVAL      WL0185 = ' '                                 Header Status
     C                   EVAL      WL0186 = ' '                                 Header Status L
     C                   EVAL      WL0187 = ' '                                 Order Type Prin
     C                   Z-ADD     *ZERO         WL0188                         Scheduled Ship
     C                   EVAL      WL0189 = ' '                                 User Original E
     C                   Z-ADD     *ZERO         WL0190                         Date of Origina
     C                   Z-ADD     *ZERO         WL0191                         Order Value Tot
     C                   Z-ADD     *ZERO         WL0192                         Order Weight To
     C                   EVAL      WL0193 = ' '                                 Credit Hold
     C                   EVAL      WL0194 = ' '                                 Production Hold
     C                   EVAL      WL0195 = ' '                                 New Customer Ho
     C                   Z-ADD     *ZERO         WL0196                         Requested Deliv
     C                   Z-ADD     *ZERO         WL0197                         Requested Deliv
     C                   EVAL      WL0198 = ' '                                 Accounts Receiv
     C                   EVAL      WL0199 = ' '                                 Accounts Receiv
     C                   Z-ADD     *ZERO         WL0200                         Load ID
     C                   Z-ADD     *ZERO         WL0201                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WL0202                         Rated Freight
     C                   EVAL      WL0203 = ' '                                 LTL Flag
     C                   EVAL      WL0204 = ' '                                 Price Audit
     C                   EVAL      WL0205 = ' '                                 Price Status
     C                   EVAL      WL0206 = ' '                                 Shipping Method
     C                   EVAL      WL0207 = ' '                                 Export Status
     C                   EVAL      WL0208 = ' '                                 Palletize
     C                   EVAL      WL0209 = ' '                                 Shrink Wrap
     C                   EVAL      WL0210 = ' '                                 Slip Sheet
     C                   EVAL      WL0211 = ' '                                 Age Code
     C                   Z-ADD     *ZERO         WL0212                         Reefer Temperat
     C                   EVAL      WL0213 = ' '                                 Load Type
     C                   Z-ADD     *ZERO         WL0214                         Attach to Invoi
     C                   EVAL      WL0215 = ' '                                 Load Plan Order
     C                   EVAL      WL0216 = ' '                                 Print Pick Slip
     C                   Z-ADD     *ZERO         WL0217                         Resell Referenc
     C                   EVAL      WL0218 = ' '                                 Special Comment
     C                   EVAL      WL0219 = ' '                                 Special Comment
     C                   EVAL      WL0220 = ' '                                 Affect Auto Acc
     C                   EVAL      WL0221 = ' '                                 Sales Route Cod
     C                   EVAL      WL0222 = ' '                                 Manager Level C
     C                   EVAL      WL0223 = ' '                                 VP Level Code
     C                   Z-ADD     *ZERO         WL0224                         Attach to Order
     C                   EVAL      WL0225 = ' '                                 Reason for Pric
     C                   Z-ADD     *ZERO         WL0226                         Invoice Number
     C                   EVAL      WL0227 = ' '                                 Invoice Suffix
     C                   Z-ADD     *ZERO         WL0228                         Invoice Date
     C                   EVAL      WL0229 = ' '                                 Event Code
     C                   EVAL      WL0230 = ' '                                 Trans Contol AS
     C                   EVAL      WL0231 = ' '                                 Modified Flag
     C                   Z-ADD     *ZERO         WL0232                         A_R order Value
     C                   EVAL      WL0233 = ' '                                 Billing Activit
     C                   EVAL      WL0234 = ' '                                 Block Order Fla
     C                   EVAL      WL0235 = ' '                                 Order Certifica
     C                   Z-ADD     *ZERO         WL0236                         Invoice Order V
     C                   EVAL      WL0237 = ' '                                 Process Sts for
     C                   EVAL      WL0238 = ' '                                 Order Conf Fax
     C                   EVAL      WL0239 = ' '                                 Manifest Fax St
     C                   EVAL      WL0240 = ' '                                 Invoice Fax Sts
     C                   EVAL      WL0241 = ' '                                 Transfer in Sto
     C                   EVAL      WL0242 = ' '                                 Email Cust On O
     C                   EVAL      WL0243 = ' '                                 Order Emailed
     C                   EVAL      WL0244 = ' '                                 Export Docs Go
     C                   EVAL      WL0245 = ' '                                 Shipping Temp C
     C                   EVAL      WL0246 = ' '                                 Broker Order St
     C                   EVAL      WL0247 = ' '                                 Air Freight Ord
     C                   EVAL      WL0248 = ' '                                 Order Requires
     C                   EVAL      WL0249 = ' '                                 OH Load Plan Re
     C                   EVAL      WL0250 = ' '                                 Export USDA App
     C                   EVAL      WL0251 = ' '                                 HPB Ship to War
     C                   EVAL      WL0252 = ' '                                 OH TF Exempt Co
     C                   Z-ADD     *ZERO         WL0253                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WL0254                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WL0255                         Load Actual Shi
     C                   Z-ADD     *ZERO         WL0256                         Load BOL Comple
     C                   Z-ADD     *ZERO         WL0257                         Load Truck Depa
     C                   Z-ADD     *ZERO         WL0258                         Maximum Gross W
     C                   Z-ADD     *ZERO         WL0259                         Time of Origina
     C                   Z-ADD     *ZERO         WL0260                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WL0261                         Load BOL Comple
     C                   Z-ADD     *ZERO         WL0262                         Load Truck Depa
     C                   Z-ADD     *ZERO         WL0263                         Act Frt Referen
     C                   Z-ADD     *ZERO         WL0264                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WL0265                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WL0266                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WL0267                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WL0268                         Claim Number
     C                   EVAL      WL0269 = ' '                                 EDI Status 1
     C                   EVAL      WL0270 = ' '                                 EDI Status 2
     C                   EVAL      WL0271 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WL0272                         Job Time
     C                   EVAL      WL0273 = ' '                                 User Id
     C                   EVAL      WL0274 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WL0275                         Job Date
     C                   GOTO      TAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     TDJNCD        WL0152                         Order Type_Sale
     C                   Z-ADD     TDANC7        WL0153                         AR Customer Num
     C                   Z-ADD     TDBKC7        WL0154                         Ship To Custome
     C                   MOVEL     TDBRTX        WL0155                         Ship To Name
     C                   MOVEL     TDHMNA        WL0156                         Ship To Address
     C                   MOVEL     TDHONA        WL0157                         Ship To Address
     C                   MOVEL     TDHPNA        WL0158                         Ship To Address
     C                   MOVEL     TDHNNA        WL0159                         Ship To City
     C                   MOVEL     TDDBCD        WL0160                         Ship To State C
     C                   MOVEL     TDCKTX        WL0161                         Ship To Zip_Pos
     C                   Z-ADD     TDB0C7        WL0162                         Bill to Custome
     C                   MOVEL     TDAETX        WL0163                         Bill to Name
     C                   MOVEL     TDB1NA        WL0164                         Bill to Address
     C                   MOVEL     TDB3NA        WL0165                         Bill to Address
     C                   MOVEL     TDB4NA        WL0166                         Bill to Address
     C                   MOVEL     TDB2NA        WL0167                         Bill to City
     C                   MOVEL     TDBHCD        WL0168                         Bill to State C
     C                   MOVEL     TDC8TX        WL0169                         Bill to Zip_Pos
     C                   MOVEL     TDBCNA        WL0170                         Customer Purcha
     C                   Z-ADD     TDA0DT        WL0171                         Order Date
     C                   Z-ADD     TDA5DT        WL0172                         Requested Ship
     C                   Z-ADD     TDGNDT        WL0173                         Actual Shipped
     C                   Z-ADD     TDACDT        WL0174                         Cancel Date
     C                   MOVEL     TDAQCD        WL0175                         Terms Code
     C                   MOVEL     TDB6NA        WL0176                         Special Instruc
     C                   MOVEL     TDBYNA        WL0177                         Special Instruc
     C                   MOVEL     TDBZNA        WL0178                         Carrier Code
     C                   MOVEL     TDGTST        WL0179                         Comment Print A
     C                   MOVEL     TDGVST        WL0180                         Comment Print I
     C                   MOVEL     TDGUST        WL0181                         Comment Print P
     C                   MOVEL     TDQFST        WL0182                         Comment Print S
     C                   MOVEL     TDCQCD        WL0183                         Reason Code
     C                   MOVEL     TDGJST        WL0184                         Order in Use
     C                   MOVEL     TDGWST        WL0185                         Header Status
     C                   MOVEL     TDGXST        WL0186                         Header Status L
     C                   MOVEL     TDGYST        WL0187                         Order Type Prin
     C                   Z-ADD     TDAODT        WL0188                         Scheduled Ship
     C                   MOVEL     TDAIVN        WL0189                         User Original E
     C                   Z-ADD     TDCXDT        WL0190                         Date of Origina
     C                   Z-ADD     TDJZVA        WL0191                         Order Value Tot
     C                   Z-ADD     TDA1WG        WL0192                         Order Weight To
     C                   MOVEL     TDXIST        WL0193                         Credit Hold
     C                   MOVEL     TDXJST        WL0194                         Production Hold
     C                   MOVEL     TDXKST        WL0195                         New Customer Ho
     C                   Z-ADD     TDEIDT        WL0196                         Requested Deliv
     C                   Z-ADD     TDAFTM        WL0197                         Requested Deliv
     C                   MOVEL     TDE8CD        WL0198                         Accounts Receiv
     C                   MOVEL     TDE9CD        WL0199                         Accounts Receiv
     C                   Z-ADD     TDRMNB        WL0200                         Load ID
     C                   Z-ADD     TDTBNB        WL0201                         Absorbed Freigh
     C                   Z-ADD     TDR1NB        WL0202                         Rated Freight
     C                   MOVEL     TDPJST        WL0203                         LTL Flag
     C                   MOVEL     TDU0ST        WL0204                         Price Audit
     C                   MOVEL     TDU1ST        WL0205                         Price Status
     C                   MOVEL     TDQ2CD        WL0206                         Shipping Method
     C                   MOVEL     TDU2ST        WL0207                         Export Status
     C                   MOVEL     TDVEST        WL0208                         Palletize
     C                   MOVEL     TDVFST        WL0209                         Shrink Wrap
     C                   MOVEL     TDVGST        WL0210                         Slip Sheet
     C                   MOVEL     TDRPCD        WL0211                         Age Code
     C                   Z-ADD     TDRNNB        WL0212                         Reefer Temperat
     C                   MOVEL     TDVDST        WL0213                         Load Type
     C                   Z-ADD     TDATIN        WL0214                         Attach to Invoi
     C                   MOVEL     TDU4ST        WL0215                         Load Plan Order
     C                   MOVEL     TDU5ST        WL0216                         Print Pick Slip
     C                   Z-ADD     TDRSRN        WL0217                         Resell Referenc
     C                   MOVEL     TDMHNA        WL0218                         Special Comment
     C                   MOVEL     TDMINA        WL0219                         Special Comment
     C                   MOVEL     TDWBST        WL0220                         Affect Auto Acc
     C                   MOVEL     TDR4CD        WL0221                         Sales Route Cod
     C                   MOVEL     TDBFCD        WL0222                         Manager Level C
     C                   MOVEL     TDQ4CD        WL0223                         VP Level Code
     C                   Z-ADD     TDT3NB        WL0224                         Attach to Order
     C                   MOVEL     TDSICD        WL0225                         Reason for Pric
     C                   Z-ADD     TDCONB        WL0226                         Invoice Number
     C                   MOVEL     TDCEST        WL0227                         Invoice Suffix
     C                   Z-ADD     TDAWDT        WL0228                         Invoice Date
     C                   MOVEL     TDJPCD        WL0229                         Event Code
     C                   MOVEL     TDXUST        WL0230                         Trans Contol AS
     C                   MOVEL     TDZ1ST        WL0231                         Modified Flag
     C                   Z-ADD     TDVRVA        WL0232                         A_R order Value
     C                   MOVEL     TDOBST        WL0233                         Billing Activit
     C                   MOVEL     TDBCST        WL0234                         Block Order Fla
     C                   MOVEL     TDBDST        WL0235                         Order Certifica
     C                   Z-ADD     TDB7VL        WL0236                         Invoice Order V
     C                   MOVEL     TDGASX        WL0237                         Process Sts for
     C                   MOVEL     TDGBSX        WL0238                         Order Conf Fax
     C                   MOVEL     TDGCSX        WL0239                         Manifest Fax St
     C                   MOVEL     TDGDSX        WL0240                         Invoice Fax Sts
     C                   MOVEL     TDFNSX        WL0241                         Transfer in Sto
     C                   MOVEL     TDFOSX        WL0242                         Email Cust On O
     C                   MOVEL     TDFPSX        WL0243                         Order Emailed
     C                   MOVEL     TDFQSX        WL0244                         Export Docs Go
     C                   MOVEL     TDFRSX        WL0245                         Shipping Temp C
     C                   MOVEL     TDFSSX        WL0246                         Broker Order St
     C                   MOVEL     TDFTSX        WL0247                         Air Freight Ord
     C                   MOVEL     TDFUSX        WL0248                         Order Requires
     C                   MOVEL     TDFVSX        WL0249                         OH Load Plan Re
     C                   MOVEL     TDFWSX        WL0250                         Export USDA App
     C                   MOVEL     TDFXSX        WL0251                         HPB Ship to War
     C                   MOVEL     TDFYSX        WL0252                         OH TF Exempt Co
     C                   Z-ADD     TDNODT        WL0253                         OH Appt Confirm
     C                   Z-ADD     TDNPDT        WL0254                         JPN Invoice Iss
     C                   Z-ADD     TDNQDT        WL0255                         Load Actual Shi
     C                   Z-ADD     TDNRDT        WL0256                         Load BOL Comple
     C                   Z-ADD     TDNSDT        WL0257                         Load Truck Depa
     C                   Z-ADD     TDBPTM        WL0258                         Maximum Gross W
     C                   Z-ADD     TDBQTM        WL0259                         Time of Origina
     C                   Z-ADD     TDBRTM        WL0260                         OH Appt Confirm
     C                   Z-ADD     TDBSTM        WL0261                         Load BOL Comple
     C                   Z-ADD     TDBTTM        WL0262                         Load Truck Depa
     C                   Z-ADD     TDH0NX        WL0263                         Act Frt Referen
     C                   Z-ADD     TDH1NX        WL0264                         Act Non_Ref Frt
     C                   Z-ADD     TDH2NX        WL0265                         OH Fuel Surchar
     C                   Z-ADD     TDH3NX        WL0266                         OH Total Non_Re
     C                   Z-ADD     TDH4NX        WL0267                         OH Total Ref Fr
     C                   Z-ADD     TDC0C7        WL0268                         Claim Number
     C                   MOVEL     TDUVST        WL0269                         EDI Status 1
     C                   MOVEL     TDUWST        WL0270                         EDI Status 2
     C                   MOVEL     TDUXST        WL0271                         EDI Status 3
     C                   Z-ADD     TDAATM        WL0272                         Job Time
     C                   MOVEL     TDAYNA        WL0273                         User Id
     C                   MOVEL     TDA0NA        WL0274                         Job Name
     C                   Z-ADD     TDAXDT        WL0275                         Job Date
     C                   ENDIF
      *================================================================
     CSR   TAEXIT        ENDSR
      /EJECT
     CSR   TBRVGN        BEGSR
      *================================================================
      * VAL Block Ord Dates - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'Y'           YL0002                         Hdr/Dtl Validat
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTB         KLIST
     C                   KFLD                    WQTB01                         Company Number
     C                   KFLD                    WQTB02                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WQTB01                         Company Number
     C                   Z-ADD     WAC4NB        WQTB02                         Order Number
      * Establish starting position
     C     KRSTB         SETLL     @BGWKL1                                      *
     C     KRSTB         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * *** Test to see if Ord has been updated since the Blk Ord was cre
      * CASE: PAR.Create Date LT DB1.Job Date
     C                   DOW       NOT *IN90
     C                   IF        WAMJDT < TEAXDT
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   GOTO      TBEXIT                                       *QUIT
     C                   ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Create Date EQ DB1.Job Date
      *   |- c2    : PAR.Create Time LE DB1.Job Time
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WAMJDT = TEAXDT
     C                   IF        WABETM <= TEAATM
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   GOTO      TBEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSTB         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   TBEXIT        ENDSR
      /EJECT
     CSR   TCRVGN        BEGSR
      *================================================================
      * RTV All Blk Ord Trns  RT - WF Block Order Trans  * Get Order for
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTC         KLIST
     C                   KFLD                    WBHQNZ                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     WAHQNZ        WBHQNZ                         Surrogate Numbe
      * Establish starting position
     C     KRSTC         CHAIN     @C4CPMC                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5303'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0256                         Order Number
     C                   GOTO      TCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WBC4NB        YL0256                         Order Number
     C                   ENDIF
      *================================================================
     CSR   TCEXIT        ENDSR
      /EJECT
     CSR   TDRVGN        BEGSR
      *================================================================
      * VAL Block Header chgs RT - Order Header TRG  * Validate Changes
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0257                         Change Flag USR
     C                   MOVEL     'Y'           YL0002                         Hdr/Dtl Validat
      * Define keylist
     C     KRSTD         KLIST
     C                   KFLD                    TDAIC3                         Company Number
     C                   KFLD                    TDC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        TDAIC3                         Company Number
     C                   Z-ADD     WAC4NB        TDC4NB                         Order Number
      * Establish starting position
     C     KRSTD         CHAIN     @BECPFK                            90        *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * ** 5 Requested Ship Date
      * CASE: PAR.Requested Ship Date is entered
     C                   IF        NOT *IN90
      * WI546_2-Validate Date format is CYMD for Requested Ship Date
      * CASE: *OTHERWISE
     C                   IF        YL0060 <> 0
     C                   EVAL      YL0258 = ' '                                 Text usr 11
     C                   EVAL      YL0259 = ' '                                 Date From Conve
     C                   MOVEL     YL0060        YL0259                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0259        WQ0711                         Date From Conve
     C     YL0258        PARM      *BLANK        WQ0712                         Date To Convert
     C                   PARM      '*CYMD'       WQ0713                         Date From Forma
     C                   PARM      '*YYMD'       WQ0714                         Date To Format
     C                   PARM      '*NONE'       WQ0715                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0258 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(042)      CAT(P)    @CN(043):ZQ   YL0260                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0716                         Surrogate Numbe
     C                   PARM      TDC4NB        WQ0717                         Order Number
     C                   PARM      'INVRSD'      WQ0718                         BOE Error Reaso
     C                   PARM      YL0260        WQ0719                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0261                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   END                                                    *FI
      * Validate Requested Ship Date in Calendar
      * CASE: PAR.Requested Ship Date NE DB1.Requested Ship Date
      * ** Saving the date to pass into the Detail validation.
     C                   IF        YL0060 <> TDA5DT
     C                   Z-ADD     YL0060        YL0262                         Requested Ship
      * RTV Calendar           RT - Calendar  * See if date exists
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0051                         Company Number
     C                   Z-ADD     YL0060        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * ** Error if Requested Ship Date is not in Calendar
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(040)      CAT(P)    @CN(041):ZQ   YL0260                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TDC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0720                         Surrogate Numbe
     C                   PARM      TDC4NB        WQ0721                         Order Number
     C                   PARM      'INVRSD'      WQ0722                         BOE Error Reaso
     C                   PARM      YL0260        WQ0723                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     TDA5DT        YL0262                         Requested Ship
     C                   END                                                    *FI
      * ** Requested Delivery Date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Requested Delivery Date is entered
      *   |- c2    : PAR.Requested Delivery Date NE DB1.Requested Deliver
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0190 <> 0
     C                   IF        YL0190 <> TDEIDT
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * WI546_2-Validate Date format is CYMD for Requested Delivery Date
      * CASE: *OTHERWISE
     C                   IF        Y0CX01 = '1'
     C                   EVAL      YL0258 = ' '                                 Text usr 11
     C                   EVAL      YL0259 = ' '                                 Date From Conve
     C                   MOVEL     YL0190        YL0259                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0259        WQ0724                         Date From Conve
     C     YL0258        PARM      *BLANK        WQ0725                         Date To Convert
     C                   PARM      '*CYMD'       WQ0726                         Date From Forma
     C                   PARM      '*YYMD'       WQ0727                         Date To Format
     C                   PARM      '*NONE'       WQ0728                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0258 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(053)      CAT(P)    @CN(054):ZQ   YL0260                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0729                         Surrogate Numbe
     C                   PARM      TDC4NB        WQ0730                         Order Number
     C                   PARM      'INVDEL'      WQ0731                         BOE Error Reaso
     C                   PARM      YL0260        WQ0732                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0261                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   END                                                    *FI
      * Validate Requested Delivery Date in Calendar
      * CASE: PAR.Requested Delivery Date NE DB1.Requested Delivery Date
      * ** Saving the date to pass into the Detail validation.
     C                   IF        YL0190 <> TDEIDT
     C                   Z-ADD     YL0190        YL0263                         Requested Deliv
      * RTV Calendar           RT - Calendar  * See if date exists
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0051                         Company Number
     C                   Z-ADD     YL0190        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * ** Error if Requested Ship Date is not in Calendar
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(223)      CAT(P)    @CN(224):ZQ   YL0260                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TDC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0733                         Surrogate Numbe
     C                   PARM      TDC4NB        WQ0734                         Order Number
     C                   PARM      'INVRSD'      WQ0735                         BOE Error Reaso
     C                   PARM      YL0260        WQ0736                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Requested Delivery Date is entered
      *   |- c2    : PAR.Requested Delivery Date EQ DB1.Requested Deliver
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0190 <> 0
     C                   IF        YL0190 = TDEIDT
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   ELSE
      * CASE: PAR.Requested Delivery Date is not entered
     C                   IF        YL0190 = 0
     C                   Z-ADD     TDEIDT        YL0263                         Requested Deliv
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(053)      CAT(P)    @CN(058):ZQ   YL0260                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TDC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0737                         Surrogate Numbe
     C                   PARM      TDC4NB        WQ0738                         Order Number
     C                   PARM      'INVDAT'      WQ0739                         BOE Error Reaso
     C                   PARM      YL0260        WQ0740                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Requested Delivery Time
      * CASE: PAR.Requested Delivery Date is entered
      * Rtv All - Customer EXT2  * Requested Delv Time
      * Move input parameters to subroutine local variables.
     C                   IF        YL0190 <> 0
     C                   Z-ADD     TDBKC7        WL0001                         Ship To Custome
     C                   EXSR      SGRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        YN0164                         M3 Supplier ID
     C                   MOVEL(P)  WL0003        YN0165                         Dft Mode of Tra
     C                   MOVEL(P)  WL0004        YN0166                         Buying Group
     C                   MOVEL(P)  WL0005        YN0167                         Buying Group Op
     C                   MOVEL(P)  WL0006        YN0168                         Ship To Establi
     C                   MOVEL(P)  WL0007        YN0169                         PM Pallet Type
     C                   MOVEL(P)  WL0008        YN0170                         Cust Dft Price
     C                   Z-ADD     WL0009        YN0171                         Cust Dft Age Da
     C                   Z-ADD     WL0010        YL0264                         Cust Dft Delive
      * ** Default if we don't find it.
      * CASE: LCL.Requested Delivery Time is Zero
     C                   IF        YL0264 = 0
     C                   Z-ADD     0600          YL0264                         Requested Deliv
     C                   END                                                    *FI
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   ELSE
      * CASE: *OTHERWISE
      * **  No change
     C                   Z-ADD     TDAFTM        YL0264                         Requested Deliv
     C                   END                                                    *FI
      * ** Shipping Method
      * CASE: PAR.Shipping Method is Not Entered
      * ** No change default to DB1
     C                   IF        YL0047 = ' '
     C                   MOVEL     TDQ2CD        YL0265                         Shipping Method
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Shipping Method is Valid Values
      * We B OK.
     C                   IF        YL0047 = 'CR' OR
     C                             YL0047 = 'CT' OR
     C                             YL0047 = 'PR' OR
     C                             YL0047 = 'PT'
     C                   MOVEL     YL0047        YL0265                         Shipping Method
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     1             ZQ
     C     @CN(022)      CAT(P)    @CN(023):ZQ   YL0260                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TDC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAHQNZ        WQ0741                         Surrogate Numbe
     C                   PARM      TDC4NB        WQ0742                         Order Number
     C                   PARM      'SHPMTH'      WQ0743                         BOE Error Reaso
     C                   PARM      YL0260        WQ0744                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Reefer Temperature (Shipping Temperature)
      * CASE: PAR.Reefer Temperature NE DB1.Reefer Temperature
      * ** Shipping Temp UOM (C or F)
      * CASE: *OTHERWISE
     C                   IF        YL0199 <> TDRNNB
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
      * RTV All               RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  WAAJCD        WL0013                         Warehouse Code
     C                   EXSR      SJRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0014        YN0172                         Warehouse Descr
     C                   MOVEL(P)  WL0015        YN0173                         Address Line 1
     C                   MOVEL(P)  WL0016        YN0174                         Address Line 2
     C                   MOVEL(P)  WL0017        YN0175                         Address Line 3
     C                   MOVEL(P)  WL0018        YN0176                         City
     C                   MOVEL(P)  WL0019        YN0177                         Zip Postal Code
     C                   MOVEL(P)  WL0020        YL0266                         Production Ware
     C                   MOVEL(P)  WL0021        YN0178                         State Code
     C                   MOVEL(P)  WL0022        YN0179                         Lot Tracking Fl
     C                   MOVEL(P)  WL0023        YN0180                         Default Printer
     C                   MOVEL(P)  WL0024        YL0267                         Warehouse Type
     C                   MOVEL(P)  WL0025        YL0268                         Trans Contol AS
     C                   MOVEL(P)  WL0026        YN0181                         Warehouse Locat
     C                   MOVEL(P)  WL0027        YN0182                         Warehouse Std C
     C                   Z-ADD     WL0028        YN0183                         Warehouse Chill
     C                   MOVEL(P)  WL0029        YN0184                         Include in Auto
     C                   MOVEL(P)  WL0030        YN0185                         Default Manifes
     C                   MOVEL(P)  WL0031        YN0186                         Default Load Se
     C                   MOVEL(P)  WL0032        YN0187                         WHS Slotting Li
     C                   Z-ADD     WL0033        YN0188                         Shipping Compan
     C                   Z-ADD     WL0034        YN0189                         Accounting Comp
     C                   Z-ADD     WL0035        YN0190                         WHS Sched Prod
     C                   Z-ADD     WL0036        YN0191                         WHS Inventory C
     C                   MOVEL(P)  WL0037        YN0192                         Parent Warehous
     C                   MOVEL(P)  WL0038        YN0193                         Default Shippin
     C                   MOVEL(P)  WL0039        YN0194                         WHS Live with C
     C                   MOVEL(P)  WL0040        YN0195                         WHS PFS Interfa
     C                   MOVEL(P)  WL0041        YN0196                         WHS Req Meter R
     C                   MOVEL(P)  WL0042        YN0197                         WHS Default Loa
     C                   MOVEL(P)  WL0043        YN0198                         WHS TMS Plannin
     C                   MOVEL(P)  WL0044        YN0199                         Default Carrier
     C                   MOVEL(P)  WL0045        YN0200                         Inventory Logic
     C                   MOVEL(P)  WL0046        YN0201                         WHS Auto Inv Re
     C                   MOVEL(P)  WL0047        YN0202                         EDI Status 1
     C                   MOVEL(P)  WL0048        YN0203                         EDI Status 2
     C                   MOVEL(P)  WL0049        YN0204                         EDI Status 3
     C                   MOVEL(P)  WL0050        YN0205                         Record Status
      * RTV Shipping Temp      XF - Warehouse Type-Internal  * 
     C                   CALL      'PDSSXFR'                            90      RTV Shipping Te
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0267        WQ0745                         Warehouse Type
     C                   PARM      *ZERO         WQ0746                         Reefer Temperat
     C     YL0269        PARM      *BLANK        WQ0747                         Temperature Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDSSXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     TDRNNB        YL0270                         Reefer Temperat
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     TDRNNB        YL0270                         Reefer Temperat
     C                   END                                                    *FI
      * ** Palletize
      * CASE: PAR.Palletize is blank
      * ** No change if blank
     C                   IF        YL0044 = ' '
     C                   MOVEL     TDVEST        YL0271                         Palletize
     C                   ELSE
      * CASE: PAR.Palletize is Y/N Values
     C                   IF        YL0044 = 'N' OR
     C                             YL0044 = 'Y'
     C                   MOVEL     YL0044        YL0271                         Palletize
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0271 = ' '                                 Palletize
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Shrink Wrap
      * CASE: PAR.Shrink Wrap is blank
      * ** No change if blank
     C                   IF        YL0042 = ' '
     C                   MOVEL     TDVFST        YL0272                         Shrink Wrap
     C                   ELSE
      * CASE: PAR.Shrink Wrap is Y/N Values
     C                   IF        YL0042 = 'N' OR
     C                             YL0042 = 'Y'
     C                   MOVEL     YL0042        YL0272                         Shrink Wrap
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           YL0272                         Shrink Wrap
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Slip Sheet
      * CASE: PAR.Slip Sheet is blank
      * ** No change if blank
     C                   IF        YL0046 = ' '
     C                   MOVEL     TDVGST        YL0273                         Slip Sheet
     C                   ELSE
      * CASE: PAR.Slip Sheet is Y/N Values
     C                   IF        YL0046 = 'N' OR
     C                             YL0046 = 'Y'
     C                   MOVEL     YL0046        YL0273                         Slip Sheet
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0273 = ' '                                 Slip Sheet
     C                   MOVEL     'Y'           YL0257                         Change Flag USR
     C                   END                                                    *FI
     C                   END                                                    *FI
      * **  If no errors, Validate details.
      * CASE: PAR.Hdr/Dtl Validation Pass U is Yes
      * Val Blck Ord Dtl Chgs RT - WF Block Order Upload Dtl  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0002 = 'Y'
     C                   Z-ADD     WAHQNZ        WL0276                         Surrogate Numbe
     C                   Z-ADD     TDAIC3        WL0277                         Company Number
     C                   Z-ADD     TDC4NB        WL0278                         Order Number
     C                   Z-ADD     TDBKC7        WL0279                         Ship To Custome
     C                   MOVEL(P)  WAAJCD        WL0280                         Warehouse Code
     C                   Z-ADD     YL0060        WL0281                         Requested Ship
     C                   MOVEL(P)  WAC3TX        WL0282                         OHE Spot Buy
     C                   MOVEL(P)  WAKXCD        WL0283                         Country Code
     C                   Z-ADD     YL0190        WL0284                         Requested Deliv
     C                   MOVEL(P)  YL0002        WL0285                         Hdr/Dtl Validat
     C                   EXSR      TERVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0285        YL0002                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     YL0261        YL0002                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   TDEXIT        ENDSR
      /EJECT
     CSR   TERVGN        BEGSR
      *================================================================
      * Val Blck Ord Dtl Chgs RT - WF Block Order Upload Dtl  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   EVAL      YL0274 = ' '                                 USR Update Flag
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTE         KLIST
     C                   KFLD                    WQTE01                         Surrogate Numbe
      * Setup key
     C                   Z-ADD     WL0276        WQTE01                         Surrogate Numbe
      * Establish starting position
     C     KRSTE         SETLL     @C3CPL9                                      *
     C     KRSTE         READE     @C3CPL9                                90    *
      * Data record not found
     C   90              MOVEL     'USR5301'     W0RTN
      * USER: Process Data record
      * S027442-JM-03/20/25-Fix zero order scenario in order detail
      * CASE: DB1.Order Number is Equal to zeros
     C                   DOW       NOT *IN90
      * Chg Block Order Upl DtlCH - WF Block Order Upload Dtl  * 
     C                   IF        WMC4NB = 0
     C                   EXSR      TFCHRC
     C                   END                                                    *FI
      * S027442-JM-03/20/25-Read with Non zero order number from Header.
      * RTV All (Really all)  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0277        WL0286                         Company Number
     C                   Z-ADD     WL0278        WL0287                         Order Number
     C                   Z-ADD     WMDXNB        WL0288                         Order Sequence
     C                   Z-ADD     1             WL0289                         Order Secondary
     C                   EXSR      TGRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0290        YL0275                         Item Code
     C                   MOVEL(P)  WL0291        YL0276                         Warehouse Code
     C                   Z-ADD     WL0292        YL0277                         Ship To Custome
     C                   Z-ADD     WL0293        YL0278                         Order Group Cod
     C                   MOVEL(P)  WL0294        YL0279                         Detail Line Sta
     C                   MOVEL(P)  WL0295        YL0280                         Detail Line Sta
     C                   Z-ADD     WL0296        YL0281                         Billing Detail
     C                   Z-ADD     WL0297        YL0282                         Billing Detail
     C                   Z-ADD     WL0298        YL0283                         Billing Detail
     C                   Z-ADD     WL0299        YL0284                         Quantity to Sub
     C                   MOVEL(P)  WL0300        YL0285                         Comment Print A
     C                   MOVEL(P)  WL0301        YL0286                         Comment Print I
     C                   MOVEL(P)  WL0302        YL0287                         Comment Print P
     C                   MOVEL(P)  WL0303        YL0288                         Comment Print S
     C                   Z-ADD     WL0304        YL0289                         Extended Amount
     C                   Z-ADD     WL0305        YL0290                         Market Pricing
     C                   MOVEL(P)  WL0306        YL0291                         Commodity Marke
     C                   MOVEL(P)  WL0307        YL0292                         Date Method Cod
     C                   MOVEL(P)  WL0308        YL0293                         Price Method Co
     C                   Z-ADD     WL0309        YL0294                         Price Overage O
     C                   Z-ADD     WL0310        YL0295                         Contract Number
     C                   MOVEL(P)  WL0311        YL0296                         Price Status
     C                   Z-ADD     WL0312        YL0297                         Pricing Date Us
     C                   MOVEL(P)  WL0313        YL0298                         U_M_Base Price
     C                   MOVEL(P)  WL0314        YL0299                         U_M_Ordered
     C                   MOVEL(P)  WL0315        YL0300                         Work Confirm St
     C                   MOVEL(P)  WL0316        YL0301                         Work Over_Short
     C                   MOVEL(P)  WL0317        YL0302                         OD Production P
     C                   MOVEL(P)  WL0318        YL0303                         Order Desc_Line
     C                   MOVEL(P)  WL0319        YL0304                         Order Desc_Line
     C                   MOVEL(P)  WL0320        YL0305                         Age Code
     C                   MOVEL(P)  WL0321        YL0306                         Palletize
     C                   MOVEL(P)  WL0322        YL0307                         Slip Sheet
     C                   MOVEL(P)  WL0323        YL0308                         Catch Weight St
     C                   MOVEL(P)  WL0324        YL0309                         Price Audit
     C                   MOVEL(P)  WL0325        YL0310                         Price Audit Rea
     C                   MOVEL(P)  WL0326        YL0311                         Production Date
     C                   Z-ADD     WL0327        YL0312                         Rated Freight
     C                   Z-ADD     WL0328        YL0313                         Quantity Ordere
     C                   Z-ADD     WL0329        YL0314                         Weight Ordered
     C                   Z-ADD     WL0330        YL0315                         Quantity Schedu
     C                   Z-ADD     WL0331        YL0316                         Weight Schedule
     C                   Z-ADD     WL0332        YL0317                         Quantity Shippe
     C                   Z-ADD     WL0333        YL0318                         Weight Shipped
     C                   Z-ADD     WL0334        YL0319                         Unit Cost Prici
     C                   Z-ADD     WL0335        YL0320                         Unit Cost Per P
     C                   Z-ADD     WL0336        YL0321                         Unit Price
     C                   Z-ADD     WL0337        YL0322                         Unit Price_Cred
     C                   Z-ADD     WL0338        YL0323                         Unit Price Orde
     C                   Z-ADD     WL0339        YL0324                         Unit Weight Ord
     C                   Z-ADD     WL0340        YL0325                         Tare Weight Tot
     C                   Z-ADD     WL0341        YL0326                         Requested Ship
     C                   Z-ADD     WL0342        YL0327                         Scheduled Ship
     C                   Z-ADD     WL0343        YL0328                         Actual Shipped
     C                   MOVEL(P)  WL0344        YL0329                         Affect Inventor
     C                   MOVEL(P)  WL0345        YL0330                         Affect Sales Do
     C                   MOVEL(P)  WL0346        YL0331                         Affect Sales Pn
     C                   Z-ADD     WL0347        YL0332                         Item Structure
     C                   Z-ADD     WL0348        YL0333                         Item Structure
     C                   Z-ADD     WL0349        YL0334                         Item Structure
     C                   MOVEL(P)  WL0350        YL0335                         Item Level
     C                   MOVEL(P)  WL0351        YL0336                         Quality Level
     C                   MOVEL(P)  WL0352        YL0337                         Pricing Product
     C                   MOVEL(P)  WL0353        YL0338                         Season Product
     C                   Z-ADD     WL0354        YL0339                         Date of Origina
     C                   MOVEL(P)  WL0355        YL0340                         User Profile Na
     C                   MOVEL(P)  WL0356        YL0341                         Country Code
     C                   MOVEL(P)  WL0357        YL0342                         Event Code
     C                   MOVEL(P)  WL0358        YL0343                         Reason Code
     C                   MOVEL(P)  WL0359        YL0344                         Sales Route Cod
     C                   MOVEL(P)  WL0360        YL0345                         Modified Flag
     C                   MOVEL(P)  WL0361        YL0346                         Substituted Fla
     C                   MOVEL(P)  WL0362        YL0347                         OD Schedule Ove
     C                   Z-ADD     WL0363        YL0348                         Invoice Unit Pr
     C                   Z-ADD     WL0364        YL0349                         Invoice Extende
     C                   Z-ADD     WL0365        YL0350                         Ham Group Numbe
     C                   MOVEL(P)  WL0366        YL0351                         OD Adj Type Ove
     C                   MOVEL(P)  WL0367        YL0352                         Affect Trade Fu
     C                   MOVEL(P)  WL0368        YL0353                         Affect Commissi
     C                   MOVEL(P)  WL0369        YL0354                         Affect Pricing
     C                   MOVEL(P)  WL0370        YL0355                         Released by Use
     C                   MOVEL(P)  WL0371        YL0356                         Ord TF Exempt C
     C                   MOVEL(P)  WL0372        YL0357                         OD Pallet Type
     C                   MOVEL(P)  WL0373        YL0358                         Production Ware
     C                   MOVEL(P)  WL0374        YL0359                         OD Price Type
     C                   Z-ADD     WL0375        YL0360                         Warehouse Palle
     C                   Z-ADD     WL0376        YL0361                         Consumed Item C
     C                   Z-ADD     WL0377        YL0362                         Deadline Depart
     C                   Z-ADD     WL0378        YL0363                         OD Price Type R
     C                   Z-ADD     WL0379        YL0364                         OD Firm Date
     C                   Z-ADD     WL0380        YL0365                         Deadline Depart
     C                   Z-ADD     WL0381        YL0366                         Price Code
     C                   Z-ADD     WL0382        YL0367                         Maximum Net Wei
     C                   Z-ADD     WL0383        YL0368                         Substitution Li
     C                   Z-ADD     WL0384        YL0369                         Max Qty to sche
     C                   Z-ADD     WL0385        YL0370                         Warehouse Palle
     C                   Z-ADD     WL0386        YL0371                         Warehouse Avg P
     C                   Z-ADD     WL0387        YL0372                         OD Item Target
     C                   Z-ADD     WL0388        YL0373                         OD Estimated Gr
     C                   Z-ADD     WL0389        YL0374                         OD Maximum Unit
     C                   Z-ADD     WL0390        YL0375                         Order Gate_Fina
     C                   Z-ADD     WL0391        YL0376                         OD Ceiling Pric
     C                   Z-ADD     WL0392        YL0377                         OD Gate_Final P
     C                   Z-ADD     WL0393        YL0378                         OD Weighted Avg
     C                   Z-ADD     WL0394        YL0379                         OD Original Ord
     C                   Z-ADD     WL0395        YL0380                         OD Cancel Date
     C                   Z-ADD     WL0396        YL0381                         OD Unused Prc 7
     C                   Z-ADD     WL0397        YL0382                         OD Unused Prc 8
     C                   MOVEL(P)  WL0398        YL0383                         OD MPR Sent to
     C                   MOVEL(P)  WL0399        YL0384                         OD MPR Prc Read
     C                   MOVEL(P)  WL0400        YL0385                         OD UnUsed Price
     C                   Z-ADD     WL0401        YL0386                         Weight Amount E
     C                   Z-ADD     WL0402        YL0387                         Item Age Days
     C                   Z-ADD     WL0403        YL0388                         Production Ovr
     C                   Z-ADD     WL0404        YL0389                         Production Ovr
     C                   MOVEL(P)  WL0405        YL0390                         OD Spot Buy
     C                   MOVEL(P)  WL0406        YL0391                         OD Clm Full Ret
     C                   MOVEL(P)  WL0407        YL0392                         Order Line Erro
     C                   Z-ADD     WL0408        YL0393                         OD Market Begin
     C                   Z-ADD     WL0409        YL0394                         OD Market Endin
     C                   Z-ADD     WL0410        YL0395                         OD Atch to Ord
     C                   MOVEL(P)  WL0411        YL0396                         EDI Status 1
     C                   MOVEL(P)  WL0412        YL0397                         EDI Status 2
     C                   MOVEL(P)  WL0413        YL0398                         EDI Status 3
     C                   Z-ADD     WL0414        YL0399                         Job Time
     C                   MOVEL(P)  WL0415        YL0400                         User Id
     C                   MOVEL(P)  WL0416        YL0401                         Job Name
     C                   Z-ADD     WL0417        YL0402                         Job Date
      * ** Change or Add a new Detail line.
      * CASE: PGM.*Return code is *Normal
      * ** Quantity Ordered
      * CASE: DB1.Quantity Ordered is Equal to zero
     C                   IF        W0RTN = ' '
      * ** No change
     C                   IF        WMAVQT = 0
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Quantity Ordered NE LCL.Quantity Ordered
     C                   IF        WMAVQT <> YL0313
     C                   Z-ADD     WMAVQT        YL0313                         Quantity Ordere
     C                   END                                                    *FI
      * ** If the DB1 and LCL are the same, there is no change.
     C                   END                                                    *FI
     C     YL0313        MULT      YL0324        YL0314                         Weight Ordered
      * ** Palletize
      * CASE: DB1.Palletize is blank
      * ** No change
     C                   IF        WMVEST = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Palletize NE LCL.Palletize
      * Test for Valid values, Otherwise Blank
      * CASE: DB1.Palletize is Y/N/' ' Values
     C                   IF        WMVEST <> YL0306
     C                   IF        WMVEST = ' ' OR
     C                             WMVEST = 'N' OR
     C                             WMVEST = 'Y'
     C                   MOVEL     WMVEST        YL0306                         Palletize
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0306 = ' '                                 Palletize
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** If the DB1 and LCL are the same, there is no change.
     C                   END                                                    *FI
      * ** Slip Sheet
      * CASE: DB1.Slip Sheet is blank
      * ** No change
     C                   IF        WMVGST = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Slip Sheet NE LCL.Slip Sheet
      * Needs to valid.  Otherwise Blank.
      * CASE: DB1.Slip Sheet is Y/N/' ' Values
     C                   IF        WMVGST <> YL0307
     C                   IF        WMVGST = ' ' OR
     C                             WMVGST = 'N' OR
     C                             WMVGST = 'Y'
     C                   MOVEL     WMVGST        YL0307                         Slip Sheet
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0307 = ' '                                 Slip Sheet
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** If the DB1 and LCL are the same, there is no change.
     C                   END                                                    *FI
      * ** Pallet Type
      * CASE: DB1.OD Pallet Type is Blank
      * ** No change
     C                   IF        WMF5SX = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.OD Pallet Type NE LCL.OD Pallet Type
      * ** If valid, use it.  Otherwise go get it.
      * CASE: DB1.OD Pallet Type is Valid Values
     C                   IF        WMF5SX <> YL0357
     C                   IF        WMF5SX = '01' OR
     C                             WMF5SX = '02' OR
     C                             WMF5SX = 'CH' OR
     C                             WMF5SX = 'HT' OR
     C                             WMF5SX = '04' OR
     C                             WMF5SX = '03'
     C                   MOVEL     WMF5SX        YL0357                         OD Pallet Type
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv All - Customer EXT2  * Pallet Type
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0279        WL0001                         Ship To Custome
     C                   EXSR      SGRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        YN0207                         M3 Supplier ID
     C                   MOVEL(P)  WL0003        YN0208                         Dft Mode of Tra
     C                   MOVEL(P)  WL0004        YN0209                         Buying Group
     C                   MOVEL(P)  WL0005        YN0210                         Buying Group Op
     C                   MOVEL(P)  WL0006        YN0211                         Ship To Establi
     C                   MOVEL(P)  WL0007        YL0357                         PM Pallet Type
     C                   MOVEL(P)  WL0008        YN0212                         Cust Dft Price
     C                   Z-ADD     WL0009        YN0213                         Cust Dft Age Da
     C                   Z-ADD     WL0010        YN0214                         Cust Dft Delive
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** If the DB1 and LCL are the same, there is no change.
     C                   END                                                    *FI
      * ** Set OD Pallet Type to ' ' if palletize='N'
      * CASE: LCL.Palletize is Blank/N
     C                   IF        YL0306 = ' ' OR
     C                             YL0306 = 'N'
     C                   EVAL      YL0357 = ' '                                 OD Pallet Type
     C                   END                                                    *FI
      * ** Update warehouse code
      * CASE: LCL.Warehouse Code NE PAR.Warehouse Code
     C                   IF        YL0276 <> WL0280
     C                   MOVEL     WL0280        YL0276                         Warehouse Code
     C                   END                                                    *FI
      * ** Update Requested & scheduled ship date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Requested Ship Date NE LCL.Requested Ship Date
      *   |- c2    : PAR.Requested Ship Date is entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WL0281 <> YL0326
     C                   IF        WL0281 <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WL0281        YL0326                         Requested Ship
     C                   Z-ADD     WL0281        YL0327                         Scheduled Ship
     C                   END                                                    *FI
      * ** WI546_2 Cancel detail line or Update
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Detail Line Status is Cancelled
      *   |- c2    : DB1.Cancel Date is entered
      *   '-
      * *** WI546_2-Validate Date format is CYMD for Cancel Date
      * CASE: DB1.Cancel Date is entered
     C                   IF        WMGMST = 'X' OR
     C                             WMACDT <> 0
     C                   IF        WMACDT <> 0
     C                   EVAL      YL0403 = ' '                                 Text usr 11
     C                   EVAL      YL0404 = ' '                                 Date From Conve
     C                   MOVEL     WMACDT        YL0404                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0404        WQ0748                         Date From Conve
     C     YL0403        PARM      *BLANK        WQ0749                         Date To Convert
     C                   PARM      '*CYMD'       WQ0750                         Date From Forma
     C                   PARM      '*YYMD'       WQ0751                         Date To Format
     C                   PARM      '*NONE'       WQ0752                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0403 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(226)      CAT(P)    't.':ZQ       YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0753                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0754                         Order Number
     C                   PARM      'INVCAN'      WQ0755                         BOE Error Reaso
     C                   PARM      YL0405        WQ0756                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 1019801 JM - WI546_2 Make sure Cancel Date is present in Calen
      * CASE: *OTHERWISE
      * RTV Calendar           RT - Calendar Master  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0277        WL0051                         Company Number
     C                   Z-ADD     WMACDT        WL0052                         Post to G_L Dat
     C                   EXSR      SMRVGN
      * CASE: PGM.*Return code is Calendar not found
     C                   IF        W0RTN = @CN(055)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(227)      CAT(P)    @CN(228):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0757                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0758                         Order Number
     C                   PARM      'INVCAN'      WQ0759                         BOE Error Reaso
     C                   PARM      YL0405        WQ0760                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * *** WI546_2-validate cancel date & proceed for cancellation
      * CASE: *OTHERWISE
      * LCL.From Date             USR = JOB.*Job exec start date + CON.-7
     C     ##ED7         ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     -7            XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0406
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0406
     C                   END
      * LCL.To Date               USR = JOB.*Job exec start date + CON.7
     C     ##ED7         ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     7             XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0407
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0407
     C                   END
      * *** Validate Cancel Date within 7 days.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Cancel Date LT LCL.From Date             USR
      *   |- c2    : DB1.Cancel Date GT LCL.To Date               USR
      *   '-
     C                   IF        WMACDT < YL0406 OR
     C                             WMACDT > YL0407
     C                   EVAL      YL0408 = ' '                                 Date 7A
     C                   MOVEL     WMACDT        YL0408                         Date 7A
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(229)      CAT(P)    @CN(230):ZQ   YL0405                         BOE Error Comme
     C                   Z-ADD     1             ZQ
     C     YL0405        CAT(P)    YL0408:ZQ     YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0761                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0762                         Order Number
     C                   PARM      'INVDAT'      WQ0763                         BOE Error Reaso
     C                   PARM      YL0405        WQ0764                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV Cancel Order Detail - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0277        WL0418                         Company Number
     C                   Z-ADD     WL0278        WL0419                         Order Number
     C                   Z-ADD     WMDXNB        WL0420                         Order Sequence
     C                   Z-ADD     1             WL0421                         Order Secondary
     C                   Z-ADD     WMACDT        WL0422                         OD Cancel Date
     C                   EXSR      THRVGN
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * CHG PD Order Detail Block - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0277        WL0465                         Company Number
     C                   Z-ADD     WL0278        WL0466                         Order Number
     C                   Z-ADD     WMDXNB        WL0467                         Order Sequence
     C                   Z-ADD     1             WL0468                         Order Secondary
     C                   Z-ADD     YL0275        WL0469                         Item Code
     C                   MOVEL(P)  YL0276        WL0470                         Warehouse Code
     C                   Z-ADD     YL0277        WL0471                         Ship To Custome
     C                   Z-ADD     YL0278        WL0472                         Order Group Cod
     C                   MOVEL(P)  YL0279        WL0473                         Detail Line Sta
     C                   MOVEL(P)  YL0280        WL0474                         Detail Line Sta
     C                   Z-ADD     YL0281        WL0475                         Billing Detail
     C                   Z-ADD     YL0282        WL0476                         Billing Detail
     C                   Z-ADD     YL0283        WL0477                         Billing Detail
     C                   Z-ADD     YL0284        WL0478                         Quantity to Sub
     C                   MOVEL(P)  YL0285        WL0479                         Comment Print A
     C                   MOVEL(P)  YL0286        WL0480                         Comment Print I
     C                   MOVEL(P)  YL0287        WL0481                         Comment Print P
     C                   MOVEL(P)  YL0288        WL0482                         Comment Print S
     C                   Z-ADD     YL0289        WL0483                         Extended Amount
     C                   Z-ADD     YL0290        WL0484                         Market Pricing
     C                   MOVEL(P)  YL0291        WL0485                         Commodity Marke
     C                   MOVEL(P)  YL0292        WL0486                         Date Method Cod
     C                   MOVEL(P)  YL0293        WL0487                         Price Method Co
     C                   Z-ADD     YL0294        WL0488                         Price Overage O
     C                   Z-ADD     YL0295        WL0489                         Contract Number
     C                   MOVEL(P)  YL0296        WL0490                         Price Status
     C                   Z-ADD     YL0297        WL0491                         Pricing Date Us
     C                   MOVEL(P)  YL0298        WL0492                         U_M_Base Price
     C                   MOVEL(P)  YL0299        WL0493                         U_M_Ordered
     C                   MOVEL(P)  YL0300        WL0494                         Work Confirm St
     C                   MOVEL(P)  YL0301        WL0495                         Work Over_Short
     C                   MOVEL(P)  YL0302        WL0496                         OD Production P
     C                   MOVEL(P)  YL0303        WL0497                         Order Desc_Line
     C                   MOVEL(P)  YL0304        WL0498                         Order Desc_Line
     C                   MOVEL(P)  YL0305        WL0499                         Age Code
     C                   MOVEL(P)  YL0306        WL0500                         Palletize
     C                   MOVEL(P)  YL0307        WL0501                         Slip Sheet
     C                   MOVEL(P)  YL0308        WL0502                         Catch Weight St
     C                   MOVEL(P)  YL0309        WL0503                         Price Audit
     C                   MOVEL(P)  YL0310        WL0504                         Price Audit Rea
     C                   MOVEL(P)  YL0311        WL0505                         Production Date
     C                   Z-ADD     YL0312        WL0506                         Rated Freight
     C                   Z-ADD     YL0313        WL0507                         Quantity Ordere
     C                   Z-ADD     YL0314        WL0508                         Weight Ordered
     C                   Z-ADD     YL0315        WL0509                         Quantity Schedu
     C                   Z-ADD     YL0316        WL0510                         Weight Schedule
     C                   Z-ADD     YL0317        WL0511                         Quantity Shippe
     C                   Z-ADD     YL0318        WL0512                         Weight Shipped
     C                   Z-ADD     YL0319        WL0513                         Unit Cost Prici
     C                   Z-ADD     YL0320        WL0514                         Unit Cost Per P
     C                   Z-ADD     YL0321        WL0515                         Unit Price
     C                   Z-ADD     YL0322        WL0516                         Unit Price_Cred
     C                   Z-ADD     YL0323        WL0517                         Unit Price Orde
     C                   Z-ADD     YL0324        WL0518                         Unit Weight Ord
     C                   Z-ADD     YL0325        WL0519                         Tare Weight Tot
     C                   Z-ADD     YL0326        WL0520                         Requested Ship
     C                   Z-ADD     YL0327        WL0521                         Scheduled Ship
     C                   Z-ADD     YL0328        WL0522                         Actual Shipped
     C                   MOVEL(P)  YL0329        WL0523                         Affect Inventor
     C                   MOVEL(P)  YL0330        WL0524                         Affect Sales Do
     C                   MOVEL(P)  YL0331        WL0525                         Affect Sales Pn
     C                   Z-ADD     YL0332        WL0526                         Item Structure
     C                   Z-ADD     YL0333        WL0527                         Item Structure
     C                   Z-ADD     YL0334        WL0528                         Item Structure
     C                   MOVEL(P)  YL0335        WL0529                         Item Level
     C                   MOVEL(P)  YL0336        WL0530                         Quality Level
     C                   MOVEL(P)  YL0337        WL0531                         Pricing Product
     C                   MOVEL(P)  YL0338        WL0532                         Season Product
     C                   Z-ADD     YL0339        WL0533                         Date of Origina
     C                   MOVEL(P)  @CN(069)      WL0534                         User Profile Na
     C                   MOVEL(P)  YL0341        WL0535                         Country Code
     C                   MOVEL(P)  YL0342        WL0536                         Event Code
     C                   MOVEL(P)  YL0343        WL0537                         Reason Code
     C                   MOVEL(P)  YL0344        WL0538                         Sales Route Cod
     C                   MOVEL(P)  YL0345        WL0539                         Modified Flag
     C                   MOVEL(P)  YL0346        WL0540                         Substituted Fla
     C                   MOVEL(P)  YL0347        WL0541                         OD Schedule Ove
     C                   Z-ADD     YL0348        WL0542                         Invoice Unit Pr
     C                   Z-ADD     YL0349        WL0543                         Invoice Extende
     C                   Z-ADD     YL0350        WL0544                         Ham Group Numbe
     C                   MOVEL(P)  YL0351        WL0545                         OD Adj Type Ove
     C                   MOVEL(P)  YL0352        WL0546                         Affect Trade Fu
     C                   MOVEL(P)  YL0353        WL0547                         Affect Commissi
     C                   MOVEL(P)  YL0354        WL0548                         Affect Pricing
     C                   MOVEL(P)  YL0355        WL0549                         Released by Use
     C                   MOVEL(P)  YL0356        WL0550                         Ord TF Exempt C
     C                   MOVEL(P)  YL0357        WL0551                         OD Pallet Type
     C                   MOVEL(P)  YL0358        WL0552                         Production Ware
     C                   MOVEL(P)  YL0359        WL0553                         OD Price Type
     C                   Z-ADD     YL0360        WL0554                         Warehouse Palle
     C                   Z-ADD     YL0361        WL0555                         Consumed Item C
     C                   Z-ADD     YL0362        WL0556                         Deadline Depart
     C                   Z-ADD     YL0363        WL0557                         OD Price Type R
     C                   Z-ADD     YL0364        WL0558                         OD Firm Date
     C                   Z-ADD     YL0365        WL0559                         Deadline Depart
     C                   Z-ADD     YL0366        WL0560                         Price Code
     C                   Z-ADD     YL0367        WL0561                         Maximum Net Wei
     C                   Z-ADD     YL0368        WL0562                         Substitution Li
     C                   Z-ADD     YL0369        WL0563                         Max Qty to sche
     C                   Z-ADD     YL0370        WL0564                         Warehouse Palle
     C                   Z-ADD     YL0371        WL0565                         Warehouse Avg P
     C                   Z-ADD     YL0372        WL0566                         OD Item Target
     C                   Z-ADD     YL0373        WL0567                         OD Estimated Gr
     C                   Z-ADD     YL0374        WL0568                         OD Maximum Unit
     C                   Z-ADD     YL0375        WL0569                         Order Gate_Fina
     C                   Z-ADD     YL0376        WL0570                         OD Ceiling Pric
     C                   Z-ADD     YL0377        WL0571                         OD Gate_Final P
     C                   Z-ADD     YL0378        WL0572                         OD Weighted Avg
     C                   Z-ADD     YL0379        WL0573                         OD Original Ord
     C                   Z-ADD     YL0380        WL0574                         OD Cancel Date
     C                   Z-ADD     YL0381        WL0575                         OD Unused Prc 7
     C                   Z-ADD     YL0382        WL0576                         OD Unused Prc 8
     C                   MOVEL(P)  YL0383        WL0577                         OD MPR Sent to
     C                   MOVEL(P)  YL0384        WL0578                         OD MPR Prc Read
     C                   MOVEL(P)  YL0385        WL0579                         OD UnUsed Price
     C                   Z-ADD     YL0386        WL0580                         Weight Amount E
     C                   Z-ADD     YL0387        WL0581                         Item Age Days
     C                   Z-ADD     YL0388        WL0582                         Production Ovr
     C                   Z-ADD     YL0389        WL0583                         Production Ovr
     C                   MOVEL(P)  YL0390        WL0584                         OD Spot Buy
     C                   MOVEL(P)  YL0391        WL0585                         OD Clm Full Ret
     C                   MOVEL(P)  YL0392        WL0586                         Order Line Erro
     C                   Z-ADD     YL0393        WL0587                         OD Market Begin
     C                   Z-ADD     YL0394        WL0588                         OD Market Endin
     C                   Z-ADD     YL0395        WL0589                         OD Atch to Ord
     C                   MOVEL(P)  YL0396        WL0590                         EDI Status 1
     C                   MOVEL(P)  YL0397        WL0591                         EDI Status 2
     C                   MOVEL(P)  YL0398        WL0592                         EDI Status 3
     C                   EXSR      TPCHRC
     C                   Z-ADD     WL0278        YL0433                         Order Number
     C                   MOVEL     'Y'           YL0274                         USR Update Flag
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * ** Didn't find a detail so we must be creating a new one.
      * Rtv f/Copy Orders TemplXF - Company Item  * 
     C                   CALL      'PUX7XFR'                            90      Rtv f/Copy Orde
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ0830                         Company Number
     C                   PARM      WMHGCD        WQ0831                         Item Code
     C     YL0303        PARM      *BLANK        WQ0832                         Description Lin
     C     YL0304        PARM      *BLANK        WQ0833                         Description Lin
     C     YL0299        PARM      *BLANK        WQ0834                         UOM Primary
     C     YL0298        PARM      *BLANK        WQ0835                         UOM Pricing
     C     YL0324        PARM      *ZERO         WQ0836                         Unit Weight
     C     YL0335        PARM      *BLANK        WQ0837                         Item Level
     C     YL0311        PARM      *BLANK        WQ0838                         Production Date
     C     YL0308        PARM      *BLANK        WQ0839                         Catch Weight St
     C     YL0334        PARM      *ZERO         WQ0840                         Item Structure
     C     YL0333        PARM      *ZERO         WQ0841                         Item Structure
     C     YL0332        PARM      *ZERO         WQ0842                         Item Structure
     C                   PARM      *BLANK        WQ0843                         Default Commod
     C                   PARM      *ZERO         WQ0844                         Transportation
     C     YL0434        PARM      *BLANK        WQ0845                         Item Type Code
     C                   PARM      *BLANK        WQ0846                         Commodity Price
     C                   PARM      *BLANK        WQ0847                         Default Warehou
     C                   PARM      *BLANK        WQ0848                         Price Method De
     C                   PARM      *ZERO         WQ0849                         Fresh Chilling
     C     YL0435        PARM      *BLANK        WQ0850                         Variety_Rendere
     C     YL0372        PARM      *ZERO         WQ0851                         Item Target Pri
     C     YL0436        PARM      *BLANK        WQ0852                         Sold 100 Percen
     C     YL0437        PARM      *BLANK        WQ0853                         Error Status
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUX7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Error Status is yes
     C                   IF        YL0437 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(231)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0854                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0855                         Order Number
     C                   PARM      'INVITM'      WQ0856                         BOE Error Reaso
     C                   PARM      YL0405        WQ0857                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv Item Def/TFExp/CO XF - Item Default  * 
     C                   CALL      'PNNCXFR'                            90      Rtv Item Def/TF
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHGCD        WQ0858                         Item Code
     C     YL0438        PARM      *BLANK        WQ0859                         TF Co_Ownership
     C     YL0356        PARM      *BLANK        WQ0860                         Item TF Exempt
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNNCXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                   CALL      'POP1XFR'                            90      Rtv First Consu
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ0861                         Company Number
     C                   PARM      WMHGCD        WQ0862                         Item Code
     C     YL0361        PARM      *ZERO         WQ0863                         Component Item
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POP1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Val Manual Price      XF - Company Item  * 
     C                   CALL      'POA5XFR'                            90      Val Manual Pric
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ0864                         Company Number
     C                   PARM      WMHGCD        WQ0865                         Item Code
     C                   PARM      *BLANK        WQ0866                         Description Lin
     C     YL0439        PARM      *BLANK        WQ0867                         Default Commod
     C     YL0440        PARM      *ZERO         WQ0868                         Market Overage
     C                   PARM      *ZERO         WQ0869                         Standard Overag
     C     YL0441        PARM      *BLANK        WQ0870                         Commodity Price
     C                   PARM      *ZERO         WQ0871                         Std Weight_Head
     C     YL0442        PARM      *BLANK        WQ0872                         Primal Group Co
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POA5XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Rtv Cust Tf Exempt    XF - Customer EXT  * 
     C                   CALL      'PPSMXFR'                            90      Rtv Cust Tf Exe
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0279        WQ0873                         Ship To Custome
     C     YL0443        PARM      *BLANK        WQ0874                         Customer TF Exe
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPSMXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Set/Val OH TF Exempt2 IF
     C                   EVAL      YL0445 = ' '                                 OH TF Exempt Er
      * Set / Validate TF Exempt code values              RMC 8/24/05
      * CASE: PAR.OH TF Exempt Code is Blank
      * VAL: Customer Exempt Code  w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C                   IF        YL0444 = ' '
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Item Codes
     C                   IF        YL0443 = 'NE'
     C                   IF        YL0356 = 'EP' OR
     C                             YL0356 = 'NE'
     C                   EVAL      YL0444 = ' '                                 OH TF Exempt Co
     C                   MOVEL     YL0356        YL0444                         OH TF Exempt Co
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
     C                   IF        YL0443 = 'EC'
     C                   EVAL      YL0444 = ' '                                 OH TF Exempt Co
     C                   MOVEL     YL0443        YL0444                         OH TF Exempt Co
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C                   IF        YL0356 = 'NE'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
     C                   IF        YL0438 = 'S' OR
     C                             YL0438 = 'T'
     C                   MOVEL     'TFEXE1'      YL0445                         OH TF Exempt Er
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EC'          YL0356                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EP'          YL0356                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Validate after 1 line item has been entered
      * If not Pre-Commencement, set exempt code
      * CASE: PAR.OH TF Exempt Code is Not Pre-Commencement
      * VAL: Customer Exempt Code w/Item Exempt Code
      * CASE: PAR.Customer TF Exempt Code is Not Exempt
     C                   IF        YL0444 = 'EC' OR
     C                             YL0444 = 'EP' OR
     C                             YL0444 = 'NE'
      * Line item must eq whats in the header, else Error
      * CASE: PAR.OH TF Exempt Code NE PAR.Ord TF Exempt Code
     C                   IF        YL0443 = 'NE'
     C                   IF        YL0444 <> YL0356
     C                   MOVEL     'TFEXE2'      YL0445                         OH TF Exempt Er
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Customer TF Exempt Code is Exempt Customer
      * VAL: Item Exempt Code
      * CASE: PAR.Ord TF Exempt Code is Not Exempt
     C                   IF        YL0443 = 'EC'
      * CASE: PAR.TF Co-Ownership Sts is Co-Owned
     C                   IF        YL0356 = 'NE'
      * E00505-Prevent Co-Owned Item to be sold to Exempt Customers.
     C                   IF        YL0438 = 'S' OR
     C                             YL0438 = 'T'
     C                   MOVEL     'TFEXE1'      YL0445                         OH TF Exempt Er
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EC'          YL0356                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'EP'          YL0356                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'PC'          YL0356                         Ord TF Exempt C
     C                   END                                                    *FI
     C                   END                                                    *FI
      * *** WI546_2 Validate OH TF Exempt Error Cde U
      * CASE: LCL.OH TF Exempt Error Cde U is NE *Blank
      * CASE: LCL.OH TF Exempt Error Cde U is TF Exempt-Item & Cust
     C                   IF        YL0445 <> ' '
     C                   IF        YL0445 = @CN(072)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(073)      CAT(P)    @CN(074):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0875                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0876                         Order Number
     C                   PARM      'TFEXE1'      WQ0877                         BOE Error Reaso
     C                   PARM      YL0405        WQ0878                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.OH TF Exempt Error Cde U is Tf Exempt - mix error
     C                   IF        YL0445 = @CN(075)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(076)      CAT(P)    @CN(077):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0879                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0880                         Order Number
     C                   PARM      'TFEXE2'      WQ0881                         BOE Error Reaso
     C                   PARM      YL0405        WQ0882                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL Item Level Exists  XF - Item Level Codes  * 
     C                   CLEAR                   PBRC
     C                   MOVEL(P)  YL0335        PBRBCD                         Item Level
      *
     C                   CALL      'PNH3XFR'                            90      VAL Item Level
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PBRC                           KEY: Item Level
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNH3XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Item code not found
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(078)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0883                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0884                         Order Number
     C                   PARM      'ITMLVL'      WQ0885                         BOE Error Reaso
     C                   PARM      YL0405        WQ0886                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Not Finished Goods
      * CASE:
      *  - NOT c1
      *   |- c1    : LCL.Item Type Code is Finished Good
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0434 = 'FG'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(079)      CAT(P)    @CN(080):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0887                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0888                         Order Number
     C                   PARM      'ITMTYP'      WQ0889                         BOE Error Reaso
     C                   PARM      YL0405        WQ0890                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Warehouse type=Fresh & Sold 100%=Frozen
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Warehouse Type is Fresh
      *   |- c2    : LCL.Sold 100 Percent Frozen is yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0446 = 'FR'
     C                   IF        YL0436 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(081)      CAT(P)    'rozen':ZQ    YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0891                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0892                         Order Number
     C                   PARM      '100FRZ'      WQ0893                         BOE Error Reaso
     C                   PARM      YL0405        WQ0894                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Rendered & Regular Load Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Variety_Rendered_Cut is Rendered
      *   |- c2    : LCL.Load Type is Regular
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0435 = 'R'
     C                   IF        YL0447 = 'R'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(082)      CAT(P)    @CN(083):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0895                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0896                         Order Number
     C                   PARM      'BLKITM'      WQ0897                         BOE Error Reaso
     C                   PARM      YL0405        WQ0898                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Rendered & Bulk Load Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Variety_Rendered_Cut is Rendered
      *   |- c2    : LCL.Load Type is Bulk
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0435 = 'R'
     C                   IF        YL0447 = 'B'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(084)      CAT(P)    @CN(085):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0899                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0900                         Order Number
     C                   PARM      'BLKORD'      WQ0901                         BOE Error Reaso
     C                   PARM      YL0405        WQ0902                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * Rtv Plan Prod Sts     XF - Company Item Ext  * 
     C                   CALL      'PNHKXFR'                            90      Rtv Plan Prod S
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ0903                         Company Number
     C                   PARM      WMHGCD        WQ0904                         Item Code
     C     YL0448        PARM      *BLANK        WQ0905                         Plan Production
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNHKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Val ItmBal.Unit Cst    XF - /UT Inv. Interface Funcs  * 
     C                   CALL      'PDMCXFR'                            90      Val ItmBal.Unit
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ0906                         Company Number
     C                   PARM      WMHGCD        WQ0907                         Item Code
     C                   PARM      WL0280        WQ0908                         Warehouse Code
     C     YL0320        PARM      *ZERO         WQ0909                         Unit Cost Per P
     C     YL0437        PARM      *BLANK        WQ0910                         Error Status
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDMCXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Unit Cost for Warehouse
      * CASE: LCL.Unit Cost Per Pound is equal to zero
     C                   IF        YL0320 = 0
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(086)      CAT(P)    @CN(087):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0911                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0912                         Order Number
     C                   PARM      'UNTCST'      WQ0913                         BOE Error Reaso
     C                   PARM      YL0405        WQ0914                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Item Balance not found
      * CASE: LCL.Error Status is yes
     C                   IF        YL0437 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(088)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0915                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0916                         Order Number
     C                   PARM      'ITMBAL'      WQ0917                         BOE Error Reaso
     C                   PARM      YL0405        WQ0918                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * Val Age Information2  IF
     C                   EVAL      YL0452 = ' '                                 Error Reason De
     C                   EVAL      YL0453 = ' '                                 Error Reason De
     C                   EVAL      YL0454 = ' '                                 Error Reason De
     C                   EVAL      YL0455 = ' '                                 Error Reason De
     C                   EVAL      YL0456 = ' '                                 Error Reason De
     C                   EVAL      WUB8SX = ' '                                 Error Flag
     C                   EVAL      YL0437 = ' '                                 Error Status
     C                   EVAL      WUKWTX = ' '                                 Error Reason De
     C                   EVAL      WUKXTX = ' '                                 Error Reason De
     C                   EVAL      WUKYTX = ' '                                 Error Reason De
     C                   EVAL      WUKZTX = ' '                                 Error Reason De
     C                   EVAL      WUTITX = ' '                                 Error Reason De
      * CASE: PAR.Company Organization is Seaboard
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                   IF        YL0451 = 'S'
     C                   CALL      'PNQNXFR'                            90      Val Age informa
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHGCD        WQ0919                         Item Code
     C                   PARM      WL0280        WQ0920                         Warehouse Code
     C     WUB8SX        PARM      WUB8SX        WQ0921                         Error Flag
     C     WUKWTX        PARM      WUKWTX        WQ0922                         Error Reason De
     C     WUKXTX        PARM      WUKXTX        WQ0923                         Error Reason De
     C     WUKYTX        PARM      WUKYTX        WQ0924                         Error Reason De
     C     WUKZTX        PARM      WUKZTX        WQ0925                         Error Reason De
     C     WUTITX        PARM      WUTITX        WQ0926                         Error Reason De
     C                   PARM      WL0277        WQ0927                         Company Number
     C                   PARM      WL0281        WQ0928                         Scheduled Ship
     C                   PARM      WL0281        WQ0929                         Requested Deliv
     C                   PARM      WMRINY        WQ0930                         Item Age Days
     C                   PARM      *ZERO         WQ0931                         Production Ovr
     C                   PARM      *ZERO         WQ0932                         Production Ovr
     C     YL0449        PARM      YL0449        WQ0933                         Production AgeD
     C     YL0450        PARM      YL0450        WQ0934                         Production AgeD
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNQNXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WUB8SX = 'Y'
     C                   IF        'V' = 'V'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C                   IF        Y0CX01 = '1'
     C                   IF        WUKWTX <> WUW4TX
     C                   MOVEL     WUKWTX        YL0452                         Error Reason De
     C                   END                                                    *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C                   IF        WUKXTX <> WUW4TX
     C                   MOVEL     WUKXTX        YL0453                         Error Reason De
     C                   END                                                    *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C                   IF        WUKYTX <> WUW4TX
     C                   MOVEL     WUKYTX        YL0454                         Error Reason De
     C                   END                                                    *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C                   IF        WUKZTX <> WUW4TX
     C                   MOVEL     WUKZTX        YL0455                         Error Reason De
     C                   END                                                    *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C                   IF        WUTITX <> WUW4TX
     C                   MOVEL     WUTITX        YL0456                         Error Reason De
     C                   END                                                    *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
      * ** These are coming in as *ZERO in the parms. So no error.
     C                   IF        *ZERO = 0
     C                   MOVEL     'N'           WUB8SX                         Error Flag
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0458 = ' '                                 Error Reason De
     C                   MOVEL     @CN(089)      YL0458                         Error Reason De
     C                   MOVEL     'N'           WUB8SX                         Error Flag
     C                   END                                                    *FI
      * CASE: WRK.Error Flag            USR is Yes
     C                   IF        WUB8SX = 'Y'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Error Reason Descr 1
      * CASE: LCL.Error Reason Descript 1 is Not Blank
     C                   IF        YL0452 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(090)      CAT(P)    @CN(091):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0935                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0936                         Order Number
     C                   PARM      'OVAGD1'      WQ0937                         BOE Error Reaso
     C                   PARM      YL0405        WQ0938                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 2
      * CASE: LCL.Error Reason Descript 2 is Not Blank
     C                   IF        YL0453 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(092)      CAT(P)    @CN(093):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0939                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0940                         Order Number
     C                   PARM      'OVAGD2'      WQ0941                         BOE Error Reaso
     C                   PARM      YL0405        WQ0942                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 3
      * CASE: LCL.Error Reason Descript 3 is Not Blank
     C                   IF        YL0454 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(094)      CAT(P)    @CN(095):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0943                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0944                         Order Number
     C                   PARM      'OVAGD3'      WQ0945                         BOE Error Reaso
     C                   PARM      YL0405        WQ0946                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 4
      * CASE: LCL.Error Reason Descript 4 is Not Blank
     C                   IF        YL0455 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(094)      CAT(P)    @CN(095):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0947                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0948                         Order Number
     C                   PARM      'OVAGD3'      WQ0949                         BOE Error Reaso
     C                   PARM      YL0405        WQ0950                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 5
      * CASE: LCL.Error Reason Descript 5 is Not Blank
     C                   IF        YL0456 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(094)      CAT(P)    @CN(095):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0951                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0952                         Order Number
     C                   PARM      'OVAGD3'      WQ0953                         BOE Error Reaso
     C                   PARM      YL0405        WQ0954                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** Error Reason Descr 6
      * CASE: LCL.Error Reason Descript 6 is Not Blank
     C                   IF        YL0457 <> ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(096)      CAT(P)    @CN(097):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0955                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0956                         Order Number
     C                   PARM      'OVAGD6'      WQ0957                         BOE Error Reaso
     C                   PARM      YL0405        WQ0958                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * Val Item              XF - Ham Group Item  * 
     C                   CALL      'PMG1XFR'                            90      Val Item
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHGCD        WQ0959                         Ham Group Item
     C     YL0459        PARM      *BLANK        WQ0960                         Record Found US
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PMG1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Ham Group Reqd
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Found USR is Record Found
      *   |- c2    : DB1.Ham Group Number is Not Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0459 = 'Y'
     C                   IF        WMA1AA = 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(098)      CAT(P)    @CN(099):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0961                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0962                         Order Number
     C                   PARM      'HAMGRP'      WQ0963                         BOE Error Reaso
     C                   PARM      YL0405        WQ0964                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Found USR is Record Found
      *   |- c2    : DB1.Ham Group Number is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0459 = 'Y'
     C                   IF        WMA1AA <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Rtv Credit Item Sts   RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WL0277        WL0053                         Company Number
     C                   Z-ADD     WMHGCD        WL0054                         Item Code
     C                   EXSR      SORVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0055        YL0460                         Credit Item Sta
      * CASE: LCL.Credit Item Status is yes
     C                   IF        YL0460 = 'Y'
     C                   ELSE
      * CASE: *OTHERWISE
      * VAL Ham Group/Item     RT - Ham Group Item  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WMA1AA        WL0056                         Ham Group Numbe
     C                   Z-ADD     WMHGCD        WL0057                         Ham Group Item
     C                   EXSR      SPRVGN
      * ** Ham / Item error
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(100)      CAT(P)    'nd.':ZQ      YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0965                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0966                         Order Number
     C                   PARM      'HAMITM'      WQ0967                         BOE Error Reaso
     C                   PARM      YL0405        WQ0968                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 2 Quantity Ordered
      * CASE: DB1.Quantity Ordered is Equal to zero
     C                   IF        WMAVQT = 0
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(101)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0969                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0970                         Order Number
     C                   PARM      'QTYORD'      WQ0971                         BOE Error Reaso
     C                   PARM      YL0405        WQ0972                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                   CALL      'PNS7XFR'                            90      RTV PrcMthTyp/P
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ0973                         Company Number
     C                   PARM      WMQ7CD        WQ0974                         Price Method Co
     C     YL0461        PARM      *BLANK        WQ0975                         Price Method Ty
     C                   PARM      *BLANK        WQ0976                         PMH Price Type
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNS7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** 3 Price Method Code
      * CASE: LCL.Price Method Type is *Blank
     C                   IF        YL0461 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(102)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0977                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0978                         Order Number
     C                   PARM      'PRCMTH'      WQ0979                         BOE Error Reaso
     C                   PARM      YL0405        WQ0980                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 4 Item Age Days
      * CASE: DB1.Item Age Days is Not Entered
     C                   IF        WMRINY = 0
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(103)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0981                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0982                         Order Number
     C                   PARM      'OVAGD6'      WQ0983                         BOE Error Reaso
     C                   PARM      YL0405        WQ0984                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 5 OD Price Type
      * CASE: DB1.OD Price Type is Valid Values
     C                   IF        WMF7SX = 'CON' OR
     C                             WMF7SX = 'FRM' OR
     C                             WMF7SX = 'NEG' OR
     C                             WMF7SX = 'HDG' OR
     C                             WMF7SX = 'DST' OR
     C                             WMF7SX = 'NHT' OR
     C                             WMF7SX = 'TNK' OR
     C                             WMF7SX = 'FLR'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(104)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0985                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0986                         Order Number
     C                   PARM      'PRCTYP'      WQ0987                         BOE Error Reaso
     C                   PARM      YL0405        WQ0988                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * *** Load From and Thru Date for 1 month prior and after today.
      * LCL.From Date             USR = JOB.*Job exec start date + CON.-1
     C     ##ED7         ADD       1000000       XDINDT
     C                   Z-ADD     -1            XDURR
     C                   EXSR      XDAMO
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0406
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0406
     C                   END
      * LCL.Thru Date             USR = JOB.*Job exec start date + CON.1
     C     ##ED7         ADD       1000000       XDINDT
     C                   Z-ADD     1             XDURR
     C                   EXSR      XDAMO
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0462
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0462
     C                   END
      * ** WI546_2-Validate Date format is CYMD for Market Pricing Date
      * CASE: DB1.Market Pricing Date is NE Zero
     C                   IF        WMEXDT <> 0
     C                   EVAL      YL0403 = ' '                                 Text usr 11
     C                   EVAL      YL0404 = ' '                                 Date From Conve
     C                   MOVEL     WMEXDT        YL0404                         Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                   CALL      'POD5UPR'                            90      Cvt Date
     C                   PARM      YL0404        WQ0989                         Date From Conve
     C     YL0403        PARM      *BLANK        WQ0990                         Date To Convert
     C                   PARM      '*CYMD'       WQ0991                         Date From Forma
     C                   PARM      '*YYMD'       WQ0992                         Date To Format
     C                   PARM      '*NONE'       WQ0993                         Date Separator
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POD5UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Text usr 11 is Not Entered
     C                   IF        YL0403 = ' '
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(105)      CAT(P)    @CN(043):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0994                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0995                         Order Number
     C                   PARM      'MKTPDT'      WQ0996                         BOE Error Reaso
     C                   PARM      YL0405        WQ0997                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** 7 OC MPR Prc Ready to Send
      * CASE: DB1.OD MPR Prc Ready to Send is MPR Ready Sts
     C                   IF        WMHPST = ' ' OR
     C                             WMHPST = 'X' OR
     C                             WMHPST = 'N' OR
     C                             WMHPST = 'Y'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(106)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ0998                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ0999                         Order Number
     C                   PARM      'MPRRDY'      WQ1000                         BOE Error Reaso
     C                   PARM      YL0405        WQ1001                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** 8 Price Overage Override
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.OD MPR Prc Ready to Send is yes
      *   |- c2    : DB1.Price Overage Override is LE .0100
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WMHPST = 'Y'
     C                   IF        WMBZPR <= .0100
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(107)      CAT(P)    @CN(108):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1002                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1003                         Order Number
     C                   PARM      'PRCOVR'      WQ1004                         BOE Error Reaso
     C                   PARM      YL0405        WQ1005                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** OD Pallet Type  WI546_2
      * CASE: DB1.OD Pallet Type is Valid Values
     C                   IF        WMF5SX = '01' OR
     C                             WMF5SX = '02' OR
     C                             WMF5SX = 'CH' OR
     C                             WMF5SX = 'HT' OR
     C                             WMF5SX = '04' OR
     C                             WMF5SX = '03'
     C                   MOVEL     WMF5SX        YL0357                         OD Pallet Type
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv All - Customer EXT2  * OD Pallet Type
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0279        WL0001                         Ship To Custome
     C                   EXSR      SGRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        YN0207                         M3 Supplier ID
     C                   MOVEL(P)  WL0003        YN0208                         Dft Mode of Tra
     C                   MOVEL(P)  WL0004        YN0209                         Buying Group
     C                   MOVEL(P)  WL0005        YN0210                         Buying Group Op
     C                   MOVEL(P)  WL0006        YN0211                         Ship To Establi
     C                   MOVEL(P)  WL0007        YL0357                         PM Pallet Type
     C                   MOVEL(P)  WL0008        YN0212                         Cust Dft Price
     C                   Z-ADD     WL0009        YN0213                         Cust Dft Age Da
     C                   Z-ADD     WL0010        YN0214                         Cust Dft Delive
     C                   END                                                    *FI
      * ** Test for Valid values,Palletize Otherwise Blank
      * CASE: DB1.Palletize is Y/N/' ' Values
     C                   IF        WMVEST = ' ' OR
     C                             WMVEST = 'N' OR
     C                             WMVEST = 'Y'
     C                   MOVEL     WMVEST        YL0306                         Palletize
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0306 = ' '                                 Palletize
     C                   END                                                    *FI
      * ** Test for Slip Sheet
      * CASE: DB1.Slip Sheet is Y/N/' ' Values
     C                   IF        WMVGST = ' ' OR
     C                             WMVGST = 'N' OR
     C                             WMVGST = 'Y'
     C                   MOVEL     WMVGST        YL0307                         Slip Sheet
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0307 = ' '                                 Slip Sheet
     C                   END                                                    *FI
      * ** Write Detail to Ord Detail in Qtemp if validation passed.
      * CASE: PAR.Hdr/Dtl Validation Pass U is Yes
      * RTV All fields - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                   IF        WL0285 = 'Y'
     C                   Z-ADD     WL0277        WL0058                         Company Number
     C                   Z-ADD     WL0279        WL0059                         Ship To Custome
     C                   EXSR      SQRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0060        YN0226                         Terms Code
     C                   MOVEL(P)  WL0061        YN0227                         Sales Route Cod
     C                   MOVEL(P)  WL0062        YN0228                         Special Instruc
     C                   MOVEL(P)  WL0063        YN0229                         Special Instruc
     C                   MOVEL(P)  WL0064        YN0230                         Carrier Code
     C                   MOVEL(P)  WL0065        YN0231                         Broker
     C                   MOVEL(P)  WL0066        YN0232                         P_O Required Fl
     C                   Z-ADD     WL0067        YN0233                         Deliver after t
     C                   Z-ADD     WL0068        YN0234                         Deliver before
     C                   MOVEL(P)  WL0069        YN0235                         Alt Remittance
     C                   MOVEL(P)  WL0070        YN0236                         Type Code
     C                   Z-ADD     WL0071        YN0237                         Absorbed Freigh
     C                   Z-ADD     WL0072        YN0238                         Mileage To Cust
     C                   Z-ADD     WL0073        YN0239                         Co_Cust Overage
     C                   MOVEL(P)  WL0074        YN0240                         Age Code
     C                   MOVEL(P)  WL0075        YN0241                         Warehouse Code
     C                   MOVEL(P)  WL0076        YN0242                         Outside Warehou
     C                   MOVEL(P)  WL0077        YN0243                         Customer Group
     C                   MOVEL(P)  WL0078        YN0244                         Customer Group
     C                   MOVEL(P)  WL0079        YN0245                         G_L Code
     C                   MOVEL(P)  WL0080        YL0291                         Commodity Marke
     C                   MOVEL(P)  WL0081        YN0246                         Credit Contact
     C                   MOVEL(P)  WL0082        YN0247                         Credit Contact
     C                   MOVEL(P)  WL0083        YN0248                         Credit Contact
     C                   MOVEL(P)  WL0084        YN0249                         Credit Contact
     C                   MOVEL(P)  WL0085        YN0250                         Allow Man_Qt WO
     C                   MOVEL(P)  WL0086        YN0251                         Fax Invoice Fla
     C                   MOVEL(P)  WL0087        YN0252                         Fax Invoice Fax
     C                   MOVEL(P)  WL0088        YN0253                         Fax Invoice Con
     C                   MOVEL(P)  WL0089        YN0254                         Distributor
     C                   MOVEL(P)  WL0090        YN0255                         Default Shippin
     C                   MOVEL(P)  WL0091        YN0256                         Ord Ent Default
     C                   MOVEL(P)  WL0092        YN0257                         Bypass DDt_Dela
     C                   MOVEL(P)  WL0093        YN0258                         EDI Status 1
     C                   MOVEL(P)  WL0094        YN0259                         EDI Status 2
     C                   MOVEL(P)  WL0095        YN0260                         EDI Status 3
     C                   MOVEL(P)  WL0096        YN0261                         Record Status
     C                   Z-ADD     WL0097        YN0262                         Job Time
     C                   MOVEL(P)  WL0098        YN0263                         User Id
     C                   MOVEL(P)  WL0099        YN0264                         Job Name
     C                   Z-ADD     WL0100        YN0265                         Job Date
      * Crt Block Order Qtemp XF - Order Detail  * Not in Qtemp now.
     C                   CLEAR                   PCRC
     C                   Z-ADD     WL0277        PCAIC3                         Company Number
     C                   Z-ADD     WMC4NB        PCC4NB                         Order Number
     C                   Z-ADD     WMDXNB        PCDPNB                         Order Sequence
     C                   Z-ADD     1             PCUENB                         Order Secondary
     C                   Z-ADD     WMHGCD        PCHGCD                         Item Code
     C                   MOVEL(P)  WL0280        PCAJCD                         Warehouse Code
     C                   Z-ADD     WL0279        PCBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         PCCFC7                         Order Group Cod
     C                   MOVEL(P)  'E'           PCGMST                         Detail Line Sta
     C                   MOVEL(P)  'E'           PCGNST                         Detail Line Sta
     C                   Z-ADD     *ZERO         PCMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         PCKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         PCL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         PCL9VA                         Quantity to Sub
     C                   EVAL      PCGTST = ' '                                 Comment Print A
     C                   EVAL      PCGVST = ' '                                 Comment Print I
     C                   EVAL      PCGUST = ' '                                 Comment Print P
     C                   EVAL      PCQFST = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         PCAYVA                         Extended Amount
     C                   Z-ADD     WMEXDT        PCEXDT                         Market Pricing
     C                   MOVEL(P)  YL0291        PCLQCD                         Commodity Marke
     C                   EVAL      PCRDCD = ' '                                 Date Method Cod
     C                   MOVEL(P)  WMQ7CD        PCQ7CD                         Price Method Co
     C                   Z-ADD     WMBZPR        PCBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         PCL6NB                         Contract Number
     C                   MOVEL(P)  'U'           PCU1ST                         Price Status
     C                   Z-ADD     *ZERO         PCGIDT                         Pricing Date Us
     C                   MOVEL(P)  YL0298        PCCRCD                         U_M_Base Price
     C                   MOVEL(P)  YL0299        PCAGCD                         U_M_Ordered
     C                   EVAL      PCRZST = ' '                                 Work Confirm St
     C                   EVAL      PCR0ST = ' '                                 Work Over_Short
     C                   MOVEL(P)  YL0302        PCR1ST                         OD Production P
     C                   MOVEL(P)  YL0303        PCG7NA                         Order Desc_Line
     C                   MOVEL(P)  YL0304        PCG8NA                         Order Desc_Line
     C                   EVAL      PCRPCD = ' '                                 Age Code
     C                   MOVEL(P)  YL0306        PCVEST                         Palletize
     C                   MOVEL(P)  YL0307        PCVGST                         Slip Sheet
     C                   MOVEL(P)  YL0308        PCAVST                         Catch Weight St
     C                   EVAL      PCU0ST = ' '                                 Price Audit
     C                   EVAL      PCRFCD = ' '                                 Price Audit Rea
     C                   MOVEL(P)  YL0311        PCFZST                         Production Date
     C                   Z-ADD     *ZERO         PCR1NB                         Rated Freight
     C                   Z-ADD     WMAVQT        PCAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         PCD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         PCCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         PCAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         PCCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         PCATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         PCAQCS                         Unit Cost Prici
     C                   Z-ADD     YL0320        PCAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         PCAKPR                         Unit Price
     C                   Z-ADD     *ZERO         PCALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         PCAUPR                         Unit Price Orde
     C                   Z-ADD     YL0324        PCAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         PCA4WG                         Tare Weight Tot
     C                   Z-ADD     WL0281        PCA5DT                         Requested Ship
     C                   Z-ADD     WL0281        PCAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         PCGNDT                         Actual Shipped
     C                   MOVEL(P)  YL0329        PCAMST                         Affect Inventor
     C                   MOVEL(P)  YL0330        PCANST                         Affect Sales Do
     C                   MOVEL(P)  YL0331        PCVAST                         Affect Sales Pn
     C                   Z-ADD     YL0332        PCRGNB                         Item Structure
     C                   Z-ADD     YL0333        PCRHNB                         Item Structure
     C                   Z-ADD     YL0334        PCRINB                         Item Structure
     C                   MOVEL(P)  YL0335        PCRBCD                         Item Level
     C                   EVAL      PCHICD = ' '                                 Quality Level
     C                   EVAL      PCRNCD = ' '                                 Pricing Product
     C                   EVAL      PCROCD = ' '                                 Season Product
     C                   Z-ADD     ##ED7         PCCXDT                         Date of Origina
     C                   MOVEL(P)  @CN(069)      PCAJVN                         User Profile Na
     C                   MOVEL(P)  WL0283        PCKXCD                         Country Code
     C                   MOVEL(P)  '01'          PCJPCD                         Event Code
     C                   EVAL      PCCQCD = ' '                                 Reason Code
     C                   MOVEL(P)  YL0344        PCR4CD                         Sales Route Cod
     C                   EVAL      PCZ1ST = ' '                                 Modified Flag
     C                   EVAL      PCZ3ST = ' '                                 Substituted Fla
     C                   EVAL      PCZ4ST = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         PCDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         PCB6VL                         Invoice Extende
     C                   Z-ADD     WMA1AA        PCA1AA                         Ham Group Numbe
     C                   EVAL      PCFZSX = ' '                                 OD Adj Type Ove
     C                   MOVEL(P)  'Y'           PCF0SX                         Affect Trade Fu
     C                   MOVEL(P)  'Y'           PCF1SX                         Affect Commissi
     C                   MOVEL(P)  'Y'           PCF2SX                         Affect Pricing
     C                   EVAL      PCF3SX = ' '                                 Released by Use
     C                   MOVEL(P)  YL0356        PCF4SX                         Ord TF Exempt C
     C                   MOVEL(P)  YL0357        PCF5SX                         OD Pallet Type
     C                   MOVEL(P)  YL0358        PCF6SX                         Production Ware
     C                   MOVEL(P)  WMF7SX        PCF7SX                         OD Price Type
     C                   Z-ADD     *ZERO         PCNTDT                         Warehouse Palle
     C                   Z-ADD     YL0361        PCNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         PCNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         PCNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         PCNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         PCBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         PCBVTM                         Price Code
     C                   Z-ADD     *ZERO         PCBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         PCBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         PCBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         PCH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         PCH6NX                         Warehouse Avg P
     C                   Z-ADD     YL0372        PCH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         PCH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         PCH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         PCDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         PCDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         PCDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         PCDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         PCDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         PCGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         PCGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         PCGUPR                         OD Unused Prc 8
     C                   EVAL      PCHOST = ' '                                 OD MPR Sent to
     C                   MOVEL(P)  WMHPST        PCHPST                         OD MPR Prc Read
     C                   EVAL      PCIOST = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         PCPEWG                         Weight Amount E
     C                   Z-ADD     WMRINY        PCRINY                         Item Age Days
     C                   Z-ADD     *ZERO         PCTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         PCTJDT                         Production Ovr
     C                   MOVEL(P)  WL0282        PCH2ST                         OD Spot Buy
     C                   EVAL      PCH0ST = ' '                                 OD Clm Full Ret
     C                   EVAL      PCH1ST = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         PCTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         PCTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         PCTMDT                         OD Atch to Ord
     C                   EVAL      PCUVST = ' '                                 EDI Status 1
     C                   EVAL      PCUWST = ' '                                 EDI Status 2
     C                   EVAL      PCUXST = ' '                                 EDI Status 3
      *
     C                   CALL      'PUZ7XFR'                            90      Crt Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PCRC                           RCD: Order Deta
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUZ7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Edt OD Pricing Validt2 IF
     C                   EVAL      YL0467 = ' '                                 Pricing Valid E
     C                   Z-ADD     *ZERO         YL0322                         Unit Price_Cred
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                   CALL      'PNS7XFR'                            90      RTV PrcMthTyp/P
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ1006                         Company Number
     C                   PARM      YL0293        WQ1007                         Price Method Co
     C     YL0136        PARM      *BLANK        WQ1008                         Price Method Ty
     C     YL0137        PARM      *BLANK        WQ1009                         PMH Price Type
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNS7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Rtv Market Dtls OrEnt XF - IP Item Market Details  * 
     C                   CLEAR                   PDRC
     C                   Z-ADD     WMHGCD        PDHGCD                         Item Code
     C                   MOVEL(P)  YL0291        PDLQCD                         Commodity Marke
      *
     C                   CALL      'PNS1XFR'                            90      Rtv Market Dtls
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PDRC                           KEY: IP Item Ma
     C     YL0138        PARM      *BLANK        WQ1010                         Commodity Price
     C     YL0139        PARM      *ZERO         WQ1011                         Market Prem/Ded
     C     YL0140        PARM      *BLANK        WQ1012                         Record Found US
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNS1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0466                         USR Display 4
      * LCL.Commodity Price Group & LCL.Market Overage
      * CASE: LCL.Record Found USR is Record Found
     C                   IF        YL0140 = 'Y'
     C                   Z-ADD     YL0139        YL0141                         Market Overage
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     YL0441        YL0138                         Commodity Price
     C                   Z-ADD     YL0440        YL0141                         Market Overage
     C                   END                                                    *FI
      * VAL: Price Method Code
      * CASE: PAR.Price Method Code is Blank
     C                   IF        YL0293 = ' '
     C                   MOVEL     'Y'           YL0437                         Error Status
      * Setup message data for message
     C                   MOVEL     YL0293        ZA0008                         Price Method Co
      * Send message 'Value Required (alpha)'
     C                   MOVEL     'USR2808'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
      * VAL: Price Code
      * CASE: PAR.Price Code is Entered
      * VAL: Price Code
      * CASE: LCL.Price Method Type is Not Contract
     C                   IF        *ZERO > 0
     C                   IF        YL0136 = 'X' OR
     C                             YL0136 = 'F' OR
     C                             YL0136 = 'M' OR
     C                             YL0136 = 'K'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER1'      YL0467                         Pricing Valid E
      * CASE: PAR.USR Display 4 is No
     C                   IF        YL0466 = 'N'
     C                   MOVEL     'Y'           YL0466                         USR Display 4
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv Cust Prc Str/End  XF - Customer Price Header  * 
     C                   CALL      'PNTAXFR'                            90      Rtv Cust Prc St
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0279        WQ1013                         Ship To Custome
     C                   PARM      *ZERO         WQ1014                         Price Code
     C     YL0142        PARM      *ZERO         WQ1015                         Price Start Dat
     C     YL0143        PARM      *ZERO         WQ1016                         Price End Date
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNTAXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.Price Start Date is Not Entered
     C                   IF        YL0142 = 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER2'      YL0467                         Pricing Valid E
     C                   ELSE
      * CASE: *OTHERWISE
      * VAL: Contract Start & End Date
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Scheduled Ship Date LT LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date GT LCL.Price End Date
      *   '-
     C                   IF        WL0281 < YL0142 OR
     C                             WL0281 > YL0143
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER3'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * Rtv Max Wt and price  XF - Customer Price Detail  * 
     C                   CALL      'PNTBXFR'                            90      Rtv Max Wt and
     C                   PARM      *BLANK        W0RTN
     C     W0RTN         PARM      *BLANK        WQ1017                         *Return code
     C                   PARM      WL0279        WQ1018                         Ship To Custome
     C                   PARM      *ZERO         WQ1019                         Price Code
     C                   PARM      WMHGCD        WQ1020                         Item Code
     C     YL0144        PARM      *ZERO         WQ1021                         Maximum Contrac
     C     YL0145        PARM      *ZERO         WQ1022                         Customer Price_
     C     YL0146        PARM      *BLANK        WQ1023                         Commodity Marke
     C     YL0147        PARM      *BLANK        WQ1024                         Price Method Co
     C     YL0148        PARM      *BLANK        WQ1025                         Date Method Cod
     C     YL0149        PARM      *BLANK        WQ1026                         Contract Unit T
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PNTBXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER4'      YL0467                         Pricing Valid E
     C                   ELSE
      * CASE: *OTHERWISE
      * Sum weights shipped/ordered for ship to /price code
      *
     C                   Z-ADD     *ZERO         WN0390                         Total Weight Or
     C                   Z-ADD     *ZERO         WN0391                         Total Quantity
     C                   Z-ADD     *ZERO         WN0392                         Maximum Contrac
     C                   Z-ADD     *ZERO         WN0393                         Customer Price_
     C                   EVAL      WN0394 = ' '                                 Contract Unit T
      *
      * Clc Sum Ship/Ord Unit2 IF
     C                   MOVEL     'N'           YL0437                         Error Status
     C     WMAVQT        MULT      YL0324        YL0151                         Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                   CLEAR                   PERC
     C                   Z-ADD     WL0279        PEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         PEBVTM                         Price Code
     C                   Z-ADD     WMHGCD        PEHGCD                         Item Code
      *
     C                   CALL      'PPA6XFR'                            90      CLC Sum Ship/Or
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PERC                           KEY: Order Deta
     C     WN0390        PARM      WN0390        WQ1027                         Total Weight Or
     C                   PARM      9999999       WQ1028                         Order Number
     C     WN0391        PARM      WN0391        WQ1029                         Total Quantity
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPA6XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ADD       YL0151        WN0390                         Total Weight Or
     C                   ADD       WMAVQT        WN0391                         Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                   CALL      'PPA7XFR'                            90      Rtv Cust Prc hd
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0279        WQ1030                         Ship To Custome
     C                   PARM      *ZERO         WQ1031                         Price Code
     C     WUPLDT        PARM      *ZERO         WQ1032                         Price Start Dat
     C     WUPMDT        PARM      *ZERO         WQ1033                         Price End Date
     C                   PARM      WMHGCD        WQ1034                         Item Code
     C     WN0392        PARM      *ZERO         WQ1035                         Maximum Contrac
     C     WN0393        PARM      *ZERO         WQ1036                         Customer Price_
     C     YL0291        PARM      *BLANK        WQ1037                         Commodity Marke
     C     YL0152        PARM      *BLANK        WQ1038                         Price Method Co
     C     YL0292        PARM      *BLANK        WQ1039                         Date Method Cod
     C     WN0394        PARM      *BLANK        WQ1040                         Contract Unit T
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPA7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     YL0152        YL0293                         Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0277        WL0101                         Company Number
     C                   MOVEL(P)  YL0152        WL0102                         Price Method Co
     C                   EXSR      SRRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0103        YL0136                         Price Method Ty
     C                   MOVEL(P)  WL0104        YL0137                         PMH Price Type
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C                   IF        WN0394 = 'W'
     C                   IF        WN0390 > WN0392
     C                   MOVEL     'Y'           YL0437                         Error Status
     C     WN0390        SUB       WN0392        YL0153                         Weight Allocate
     C                   MOVEL     'PRCERT'      YL0150                         Pricing Valid E
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C                   IF        WN0391 > WN0392
     C                   MOVEL     'Y'           YL0437                         Error Status
     C     WN0391        SUB       WN0392        YL0153                         Weight Allocate
     C                   MOVEL     'PRCERT'      YL0150                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C                   IF        YL0437 = 'N'
     C                   Z-ADD     WN0393        YL0294                         Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C                   IF        YL0137 = 'I'
     C                   Z-ADD     WN0393        YL0294                         Price Overage O
     C                   Z-ADD     *ZERO         YL0376                         OD Ceiling Pric
     C                   ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C                   IF        YL0137 = 'C'
     C                   Z-ADD     *ZERO         YL0294                         Price Overage O
     C                   Z-ADD     WN0393        YL0376                         OD Ceiling Pric
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 1
     C                   IF        YL0150 = @CN(109)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(110)      CAT(P)    @CN(111):ZQ   YL0154                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) 9999999' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0155        WQ1041                         Surrogate Numbe
     C                   PARM      9999999       WQ1042                         Order Number
     C                   PARM      'PRCER1'      WQ1043                         BOE Error Reaso
     C                   PARM      YL0154        WQ1044                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           YL0156                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 1
     C                   IF        YL0150 = @CN(109)
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * VAL: Price Code Required
      * CASE: LCL.Price Method Type is Contract Pricing
     C                   IF        YL0136 = 'Q'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER5'      YL0467                         Pricing Valid E
      * CASE: PAR.USR Display 4 is No
     C                   IF        YL0466 = 'N'
     C                   MOVEL     'Y'           YL0466                         USR Display 4
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Market Price Date/Range
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0290 <> 0
     C                   MOVEL     '0'           Y0CX02
     C                   IF        YL0393 <> 0 OR
     C                             YL0394 <> 0
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER6'      YL0467                         Pricing Valid E
     C                   ELSE
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
      * CASE: PAR.OD Market Ending Date is not entered
     C                   IF        YL0393 > YL0394
     C                   IF        YL0394 = 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER7'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Published
      * CASE: LCL.Price Method Type is Published Pricing
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C                   IF        YL0136 = 'P'
     C                   IF        YL0294 <> 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER8'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   MOVEL     'SBD'         YL0291                         Commodity Marke
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C                   IF        YL0292 <> ' '
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCER9'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C                   IF        YL0376 <> 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERA'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c2 OR c3
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   IF        YL0393 <> 0 OR
     C                             YL0394 <> 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERB'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Manual/Extended
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c3    : LCL.Price Method Type is Extended Pricing
      *   '-
      * VAL: Price Overage Override for Price Method Type=Extended
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override is Equal zero
      *   |- c2    : LCL.Price Method Type is Extended Pricing
      *   '-
     C                   IF        YL0136 = 'M' OR
     C                             YL0136 = 'X'
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0294 = 0
     C                   IF        YL0136 = 'X'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERC'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Entered
     C                   IF        YL0291 <> ' '
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERD'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
     C                   IF        YL0292 <> ' '
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERE'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Ceiling Price
      * CASE: PAR.OD Ceiling Price is Not Zeros
      * Setup message data for message
     C                   IF        YL0376 <> 0
     C                   Z-ADD     YL0376        ZA0009                         OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                   MOVEL     'USR4333'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   Z-ADD     *ZERO         YL0376                         OD Ceiling Pric
     C                   END                                                    *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   IF        YL0290 <> 0 OR
     C                             YL0393 <> 0 OR
     C                             YL0394 <> 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERF'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Manual Pricing
      * CASE: LCL.Price Method Type is Manual Pricing
      * VAL: Manual Price Range
      * CASE: PAR.Billing Activity Type is Not Warehouse Transfer
     C                   IF        YL0136 = 'M'
      * CASE: PAR.Primal Group Code is NE Samples or Cut Loss
     C                   IF        YL0465 = '2' OR
     C                             YL0465 = '3' OR
     C                             YL0465 = '1'
      * RMC S14013 remove chk for type n= Promo/Samples- we want them val
      *
     C                   IF        YL0442 <> 'UNID'
     C                   Z-ADD     *ZERO         WN0395                         Manual Price Ac
     C                   Z-ADD     *ZERO         WN0396                         CoPk_FdSrv ManP
     C                   Z-ADD     *ZERO         WN0397                         Percent 7.4 USR
     C                   Z-ADD     *ZERO         WN0398                         Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                   Z-ADD     *ZERO         YL0157                         Projected Marke
     C                   Z-ADD     *ZERO         YL0159                         Minimum Price
     C                   Z-ADD     *ZERO         YL0160                         Maximum Price
     C                   MOVEL     'Y'           YL0158                         Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WL0277        WL0105                         Company Number
     C                   EXSR      SSRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0106        WN0395                         Manual Price Ac
     C                   Z-ADD     WL0107        WN0396                         CoPk_FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C                   IF        YL0439 = 'FSV' OR
     C                             YL0439 = 'CPK'
     C                   Z-ADD     WN0396        WN0395                         Manual Price Ac
     C                   END                                                    *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0291        WL0108                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0109                         Commodity Price
     C                   Z-ADD     9999999       WL0110                         Market Price Da
     C                   EXSR      STRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0111        YL0157                         Commodity Marke
     C                   Z-ADD     WL0112        WUE7DT                         USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C     YL0157        ADD       YL0141        W0WB01                         *Synon (15,5) w
     C     YL0464        DIV(H)    100           W0WB02                         *Synon (15,5) w
     C     W0WB01        ADD       W0WB02        W0WB00                         *Synon (15,5) w
     C                   Z-ADD     W0WB00        YL0157                         Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C                   IF        W0RTN = ' '
     C     WN0395        DIV(H)    100           W0WD02                         *Synon (17,7) w
     C     1             SUB       W0WD02        W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0159                         Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C     WN0395        DIV(H)    100           W0WD02                         *Synon (17,7) w
     C     W0WD02        ADD       1             W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0160                         Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0294 >= YL0159
     C                   IF        YL0294 <= YL0160
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'N'           YL0158                         Error Status  3
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0439        WL0108                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0109                         Commodity Price
     C                   Z-ADD     9999999       WL0110                         Market Price Da
     C                   EXSR      STRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0111        YL0157                         Commodity Marke
     C                   Z-ADD     WL0112        WUE7DT                         USR Date Priced
      * CASE: PGM.*Return code is *Normal
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C                   IF        W0RTN = ' '
     C     WN0395        DIV(H)    100           W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0159                         Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C     WN0395        DIV(H)    100           W0WD02                         *Synon (17,7) w
     C     W0WD02        ADD       1             W0WD01                         *Synon (17,7) w
     C     W0WD01        MULT(H)   YL0157        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     W0WD00        YL0160                         Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0294 >= YL0159
     C                   IF        YL0294 <= YL0160
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'N'           YL0158                         Error Status  3
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0157                         Projected Marke
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     YL0157        YL0322                         Unit Price_Cred
     C                   END                                                    *FI
      * CASE: LCL.Error Status  3 is Yes
      * CASE: LCL.Projected Market Price is Not Zeros
     C                   IF        YL0158 = 'Y'
      * Setup message data for message
     C                   IF        YL0157 <> 0
     C                   Z-ADD     YL0294        ZA0010                         Price Overage O
      * Send message 'Manual price within Prcnt'
     C                   MOVEL     'USR2351'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERG'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Contract
      * CASE: LCL.Price Method Type is Contract Pricing
      * VAL: Commodity Market Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Commodity Market Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                   IF        YL0136 = 'Q'
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0291 <> ' '
     C                   IF        YL0137 = 'I'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERH'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Date Method Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0292 <> ' '
     C                   IF        YL0137 = 'I'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERI'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Ceiling Price
      * CASE: LCL.PMH Price Type is Invoice Price
      * ERR: Ceiling Price not allowed
      * CASE: PAR.OD Ceiling Price is Not Zeros
     C                   IF        YL0137 = 'I'
      * Setup message data for message
     C                   IF        YL0376 <> 0
     C                   Z-ADD     YL0376        ZA0011                         OD Ceiling Pric
      * Send message 'Ceiling Price Invalid'
     C                   MOVEL     'USR4333'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   Z-ADD     *ZERO         YL0376                         OD Ceiling Pric
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * ERR: Ceiling Price Required
      * CASE: PAR.OD Ceiling Price is Equal zero
     C                   IF        YL0376 = 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERJ'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   Z-ADD     YL0376        YL0322                         Unit Price_Cred
     C                   END                                                    *FI
      * VAL: Market Date or Date Range
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   IF        YL0290 <> 0 OR
     C                             YL0393 <> 0 OR
     C                             YL0394 <> 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERK'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * VAL: Price Method Type = Market/Formula
      * CASE: LCL.Price Method Type is Market or Formula
      * VAL: Price Overage Override
      * CASE: PAR.Price Overage Override is Not Zeros
     C                   IF        YL0136 = 'F' OR
     C                             YL0136 = 'K'
     C                   IF        YL0294 <> 0
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERL'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Commodity Market Code
      * CASE: PAR.Commodity Market Code is Not Entered
     C                   IF        YL0291 = ' '
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERM'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL: Date Method Code
      * CASE: PAR.Date Method Code is Entered
      * VAL Date Method Exists RT - Market Date Method  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0292 <> ' '
     C                   Z-ADD     WL0277        WL0113                         Company Number
     C                   MOVEL(P)  YL0292        WL0114                         Date Method Cod
     C                   MOVEL(P)  'O'           WL0116                         System using Da
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0115        YN0163                         Date Method Des
      * ERR: Date Method Code Invalid
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERN'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ERR: Date Method Entered & Market Price Date/Range Entered
      * CASE:
      *  - (c1 AND c2) OR (c1 AND c3 AND c4)
      *   |- c1    : PAR.Date Method Code is Entered
      *   |- c2    : PAR.Market Pricing Date is NE Zero
      *   |- c3    : PAR.OD Market Begin Date is Entered
      *   |- c4    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0292 <> ' '
     C                   IF        YL0290 <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 <> '1'
     C                   IF        YL0292 <> ' '
     C                   IF        YL0393 <> 0
     C                   IF        YL0394 <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERO'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * ERR: Date Method = Blank and Market Price Date/Rage = Zero
      * CASE: (No Market Dates Entered)
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : PAR.Date Method Code is Not Entered
      *   |- c2    : PAR.Market Pricing Date is EQ Zero
      *   |- c3    : PAR.OD Market Begin Date is not entered
      *   |- c4    : PAR.OD Market Ending Date is not entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0292 = ' '
     C                   IF        YL0290 = 0
     C                   IF        YL0393 = 0
     C                   IF        YL0394 = 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERP'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * ERR: Market Price Date & Market Price Date Range Entered
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PAR.Market Pricing Date is NE Zero
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0290 <> 0
     C                   MOVEL     '0'           Y0CX02
     C                   IF        YL0393 <> 0 OR
     C                             YL0394 <> 0
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERQ'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * ERR: Market Price Begin Date > Market Price Ending Date
      * CASE: PAR.OD Market Begin Date GT PAR.OD Market Ending Date
     C                   IF        YL0393 > YL0394
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERR'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0291        WL0117                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0118                         Commodity Price
     C                   EXSR      SVRVGN
      * VAL: Commodity Market Price Exists
      * CASE: PGM.*Return code is *Record does not exist
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C                   IF        W0RTN = @CN(003)
      * VAL Market Cd & Group  RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0291 <> YL0439
     C                   MOVEL(P)  YL0439        WL0117                         Commodity Marke
     C                   MOVEL(P)  YL0138        WL0118                         Commodity Price
     C                   EXSR      SVRVGN
      * Use Company Item
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(003)
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERS'      YL0467                         Pricing Valid E
     C                   ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                   MOVEL     YL0291        ZA0012                         Commodity Marke
     C                   MOVEL     YL0138        ZA0013                         Commodity Price
     C                   MOVEL     YL0439        ZA0014                         Default Commod
      * Send message 'No Price Mkt/Group Deflt'
     C                   MOVEL     'USR2350'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0437                         Error Status
     C                   MOVEL     'PRCERS'      YL0467                         Pricing Valid E
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * ** Error processing
      * CASE: LCL.Pricing Valid Error Cde U is NE *Blank
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 1
     C                   IF        YL0467 <> ' '
     C                   IF        YL0467 = @CN(109)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(112)      CAT(P)    @CN(111):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1045                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1046                         Order Number
     C                   PARM      'PRCER1'      WQ1047                         BOE Error Reaso
     C                   PARM      YL0405        WQ1048                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 2
     C                   IF        YL0467 = @CN(113)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(114)      CAT(P)    @CN(115):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1049                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1050                         Order Number
     C                   PARM      'PRCER2'      WQ1051                         BOE Error Reaso
     C                   PARM      YL0405        WQ1052                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 3
     C                   IF        YL0467 = @CN(116)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(117)      CAT(P)    @CN(118):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1053                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1054                         Order Number
     C                   PARM      'PRCER3'      WQ1055                         BOE Error Reaso
     C                   PARM      YL0405        WQ1056                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 4
     C                   IF        YL0467 = @CN(119)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(120)      CAT(P)    @CN(121):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1057                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1058                         Order Number
     C                   PARM      'PRCER4'      WQ1059                         BOE Error Reaso
     C                   PARM      YL0405        WQ1060                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 5
     C                   IF        YL0467 = @CN(122)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(123)      CAT(P)    @CN(124):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1061                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1062                         Order Number
     C                   PARM      'PRCER5'      WQ1063                         BOE Error Reaso
     C                   PARM      YL0405        WQ1064                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 6
     C                   IF        YL0467 = @CN(125)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(126)      CAT(P)    @CN(127):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1065                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1066                         Order Number
     C                   PARM      'PRCER6'      WQ1067                         BOE Error Reaso
     C                   PARM      YL0405        WQ1068                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 7
     C                   IF        YL0467 = @CN(128)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(129)      CAT(P)    @CN(130):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1069                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1070                         Order Number
     C                   PARM      'PRCER7'      WQ1071                         BOE Error Reaso
     C                   PARM      YL0405        WQ1072                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 8
     C                   IF        YL0467 = @CN(131)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(132)      CAT(P)    @CN(133):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1073                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1074                         Order Number
     C                   PARM      'PRCER8'      WQ1075                         BOE Error Reaso
     C                   PARM      YL0405        WQ1076                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error 9
     C                   IF        YL0467 = @CN(134)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(135)      CAT(P)    @CN(136):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1077                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1078                         Order Number
     C                   PARM      'PRCER9'      WQ1079                         BOE Error Reaso
     C                   PARM      YL0405        WQ1080                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error B
     C                   IF        YL0467 = @CN(137)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(138)      CAT(P)    @CN(139):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1081                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1082                         Order Number
     C                   PARM      'PRCERB'      WQ1083                         BOE Error Reaso
     C                   PARM      YL0405        WQ1084                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error C
     C                   IF        YL0467 = @CN(140)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(141)      CAT(P)    @CN(142):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1085                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1086                         Order Number
     C                   PARM      'PRCERC'      WQ1087                         BOE Error Reaso
     C                   PARM      YL0405        WQ1088                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error D
     C                   IF        YL0467 = @CN(143)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(144)      CAT(P)    @CN(142):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1089                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1090                         Order Number
     C                   PARM      'PRCERD'      WQ1091                         BOE Error Reaso
     C                   PARM      YL0405        WQ1092                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error E
     C                   IF        YL0467 = @CN(145)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(146)      CAT(P)    @CN(136):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1093                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1094                         Order Number
     C                   PARM      'PRCERE'      WQ1095                         BOE Error Reaso
     C                   PARM      YL0405        WQ1096                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error F
     C                   IF        YL0467 = @CN(147)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(148)      CAT(P)    @CN(149):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1097                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1098                         Order Number
     C                   PARM      'PRCERF'      WQ1099                         BOE Error Reaso
     C                   PARM      YL0405        WQ1100                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error G
     C                   IF        YL0467 = @CN(150)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(151)      CAT(P)    @CN(152):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1101                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1102                         Order Number
     C                   PARM      'PRCERG'      WQ1103                         BOE Error Reaso
     C                   PARM      YL0405        WQ1104                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error H
     C                   IF        YL0467 = @CN(153)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(154)      CAT(P)    @CN(142):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1105                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1106                         Order Number
     C                   PARM      'PRCERH'      WQ1107                         BOE Error Reaso
     C                   PARM      YL0405        WQ1108                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error I
     C                   IF        YL0467 = @CN(155)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(146)      CAT(P)    @CN(136):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1109                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1110                         Order Number
     C                   PARM      'PRCERI'      WQ1111                         BOE Error Reaso
     C                   PARM      YL0405        WQ1112                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error J
     C                   IF        YL0467 = @CN(156)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(157)      CAT(P)    @CN(158):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1113                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1114                         Order Number
     C                   PARM      'PRCERJ'      WQ1115                         BOE Error Reaso
     C                   PARM      YL0405        WQ1116                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error K
     C                   IF        YL0467 = @CN(159)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(160)      CAT(P)    @CN(161):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1117                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1118                         Order Number
     C                   PARM      'PRCERK'      WQ1119                         BOE Error Reaso
     C                   PARM      YL0405        WQ1120                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error L
     C                   IF        YL0467 = @CN(162)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(163)      CAT(P)    @CN(164):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1121                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1122                         Order Number
     C                   PARM      'PRCERL'      WQ1123                         BOE Error Reaso
     C                   PARM      YL0405        WQ1124                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error M
     C                   IF        YL0467 = @CN(165)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(166)      CAT(P)    @CN(167):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1125                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1126                         Order Number
     C                   PARM      'PRCERM'      WQ1127                         BOE Error Reaso
     C                   PARM      YL0405        WQ1128                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error N
     C                   IF        YL0467 = @CN(168)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(169)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1129                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1130                         Order Number
     C                   PARM      'PRCERN'      WQ1131                         BOE Error Reaso
     C                   PARM      YL0405        WQ1132                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error O
     C                   IF        YL0467 = @CN(170)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(171)      CAT(P)    @CN(172):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1133                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1134                         Order Number
     C                   PARM      'PRCERO'      WQ1135                         BOE Error Reaso
     C                   PARM      YL0405        WQ1136                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error P
     C                   IF        YL0467 = @CN(173)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(174)      CAT(P)    ' ':ZQ        YL0405                         BOE Error Comme
      * **  Did not create PRCERP as is is a duplicate. Used PRCERN
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1137                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1138                         Order Number
     C                   PARM      'PRCERN'      WQ1139                         BOE Error Reaso
     C                   PARM      YL0405        WQ1140                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error Q
     C                   IF        YL0467 = @CN(175)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(176)      CAT(P)    @CN(177):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1141                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1142                         Order Number
     C                   PARM      'PRCERQ'      WQ1143                         BOE Error Reaso
     C                   PARM      YL0405        WQ1144                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error R
     C                   IF        YL0467 = @CN(178)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(129)      CAT(P)    @CN(130):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1145                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1146                         Order Number
     C                   PARM      'PRCERR'      WQ1147                         BOE Error Reaso
     C                   PARM      YL0405        WQ1148                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error S
     C                   IF        YL0467 = @CN(179)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(180)      CAT(P)    @CN(181):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1149                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1150                         Order Number
     C                   PARM      'PRCERS'      WQ1151                         BOE Error Reaso
     C                   PARM      YL0405        WQ1152                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   ELSE
      * CASE: LCL.Pricing Valid Error Cde U is Pricing Valid Error T
     C                   IF        YL0467 = @CN(182)
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(183)      CAT(P)    @CN(184):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1153                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1154                         Order Number
     C                   PARM      'PRCERT'      WQ1155                         BOE Error Reaso
     C                   PARM      YL0405        WQ1156                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     WMAVQT        MULT      YL0324        YL0314                         Weight Ordered
      * Exc Calc Ord ExemptCd XF - Order Header TRG  * 
     C                   CALL      'PPSLXFR'                            90      Exc Calc Ord Ex
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ1157                         Company Number
     C                   PARM      9999999       WQ1158                         Order Number
     C                   PARM      WL0279        WQ1159                         Ship To Custome
     C     YL0444        PARM      YL0444        WQ1160                         OH TF Exempt Co
     C     YL0468        PARM      YL0468        WQ1161                         Error Flag
     C                   PARM      'Y'           WQ1162                         Error Status  2
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PPSLXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * ** Error checking...
      * CASE: LCL.Error Flag            USR is Yes
     C                   IF        YL0468 = 'Y'
     C                   Z-ADD     *ZERO         ZQ
     C     @CN(185)      CAT(P)    @CN(186):ZQ   YL0405                         BOE Error Comme
      * EXC Crt Blk Order ErrorEX - WF Block Order Errors  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WMC4NB' defaulted for 'Order Number'.
     C                   CALL      'PVAWXFR'                            90      EXC Crt Blk Ord
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WMHQNZ        WQ1163                         Surrogate Numbe
     C                   PARM      WMC4NB        WQ1164                         Order Number
     C                   PARM      'TFEXMX'      WQ1165                         BOE Error Reaso
     C                   PARM      YL0405        WQ1166                         BOE Error Comme
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVAWXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'N'           WL0285                         Hdr/Dtl Validat
     C                   END                                                    *FI
      * ** If TF Exempt Code is not *Blank...
      * CASE: LCL.OH TF Exempt Code NE LCL.Blank 1 USR
      * Upd Block Order Qtemp XF - Order Header TRG  * 
     C                   IF        YL0444 <> YL0469
     C                   CALL      'PUZ8XFR'                            90      Upd Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ1167                         Company Number
     C                   PARM      9999999       WQ1168                         Order Number
     C                   PARM      YL0444        WQ1169                         OH TF Exempt Co
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUZ8XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * ** Test to see if we need to update Detail record again.
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10
      *   |- c1    : LCL.Date Method Code is Entered
      *   |- c2    : LCL.Weight Ordered is Not equal zero
      *   |- c3    : LCL.Unit Price_Credit is Not Zeros
      *   |- c4    : LCL.Market Pricing Date is NE Zero
      *   |- c5    : LCL.Commodity Market Code is Entered
      *   |- c6    : LCL.Price Method Code is Not Blank
      *   |- c7    : LCL.Price Overage Override is Not Zeros
      *   |- c8    : LCL.OD Ceiling Price is Not Zeros
      *   |- c9    : LCL.OD Market Begin Date is Entered
      *   |- c10   : LCL.OD Market Ending Date is Entered
      *   '-
      * Upd Block Order Qtemp XF - Order Detail  * 
     C                   IF        YL0292 <> ' ' OR
     C                             YL0314 <> 0 OR
     C                             YL0322 <> 0 OR
     C                             YL0290 <> 0 OR
     C                             YL0291 <> ' ' OR
     C                             YL0293 <> ' ' OR
     C                             YL0294 <> 0 OR
     C                             YL0376 <> 0 OR
     C                             YL0393 <> 0 OR
     C                             YL0394 <> 0
     C                   CALL      'PUZ9XFR'                            90      Upd Block Order
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WL0277        WQ1170                         Company Number
     C                   PARM      WMC4NB        WQ1171                         Order Number
     C                   PARM      WMDXNB        WQ1172                         Order Sequence
     C                   PARM      1             WQ1173                         Order Secondary
     C                   PARM      YL0290        WQ1174                         Market Pricing
     C                   PARM      YL0291        WQ1175                         Commodity Marke
     C                   PARM      YL0292        WQ1176                         Date Method Cod
     C                   PARM      WMQ7CD        WQ1177                         Price Method Co
     C                   PARM      WMBZPR        WQ1178                         Price Overage O
     C                   PARM      YL0314        WQ1179                         Weight Ordered
     C                   PARM      YL0322        WQ1180                         Unit Price_Cred
     C                   PARM      YL0376        WQ1181                         OD Ceiling Pric
     C                   PARM      YL0393        WQ1182                         OD Market Begin
     C                   PARM      YL0394        WQ1183                         OD Market Endin
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUZ9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSTE         READE     @C3CPL9                                90    *
     C                   ENDDO
      * USER: Exit processing
      * ** WI546_2 Update Order Total weight in OMS Header
      * CASE: LCL.USR Update Flag is Yes
      * UPD Order Weight - Order Header TRG  * 
     C                   IF        YL0274 = 'Y'
     C                   CLEAR                   PFRC
     C                   Z-ADD     WL0277        PFAIC3                         Company Number
     C                   Z-ADD     YL0433        PFC4NB                         Order Number
      *
     C                   CALL      'PVFEXFR'                            90      UPD Order Weigh
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PFRC                           KEY: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVFEXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      *================================================================
     CSR   TEEXIT        ENDSR
      /EJECT
     CSR   TFCHRC        BEGSR
      *================================================================
      * Chg Block Order Upl DtlCH - WF Block Order Upload Dtl  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @C3CPL8
     C                   Z-ADD     WMHQNZ        TFHQNZ                         Surrogate Numbe
     C                   Z-ADD     WMDXNB        TFDXNB                         Sequence Number
      *
     C     KLCHTF        KLIST
     C                   KFLD                    TFHQNZ                         Surrogate Numbe
     C                   KFLD                    TFDXNB                         Sequence Number
     C     KLCHTF        CHAIN     @C3CPL8                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PUC3CPL0'    MDACP
     C                   MOVEL     '@C3CPL8'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TFEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TFEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPUC31        YBRDCS
      * Move non-key fields to @C3CPL8
     C                   Z-ADD     WL0278        TFC4NB                         Order Number
     C                   Z-ADD     WMHGCD        TFHGCD                         Item Code
     C                   MOVEL(P)  WMGMST        TFGMST                         Detail Line Sta
     C                   Z-ADD     WMACDT        TFACDT                         Cancel Date
     C                   Z-ADD     WMAVQT        TFAVQT                         Quantity Ordere
     C                   MOVEL(P)  WMQ7CD        TFQ7CD                         Price Method Co
     C                   Z-ADD     WMRINY        TFRINY                         Item Age Days
     C                   MOVEL(P)  WMF7SX        TFF7SX                         OD Price Type
     C                   Z-ADD     WMEXDT        TFEXDT                         Market Pricing
     C                   MOVEL(P)  WMHPST        TFHPST                         OD MPR Prc Read
     C                   Z-ADD     WMBZPR        TFBZPR                         Price Overage O
     C                   Z-ADD     WMA1AA        TFA1AA                         Ham Group Numbe
     C                   MOVEL(P)  WMVEST        TFVEST                         Palletize
     C                   MOVEL(P)  WMF5SX        TFF5SX                         OD Pallet Type
     C                   MOVEL(P)  WMVGST        TFVGST                         Slip Sheet
     C                   MOVEL(P)  WMVSST        TFVSST                         Record Status
     C                   MOVEL(P)  WMBGTS        TFBGTS                         Create Date Tim
     C                   MOVEL(P)  WMRUU1        TFRUU1                         Create User ID
     C                   MOVEL(P)  WMRVU1        TFRVU1                         Create Program
     C                   MOVEL(P)  WMBHTS        TFBHTS                         Update Date Tim
     C                   MOVEL(P)  WMRWU1        TFRWU1                         Update User Id
     C                   MOVEL(P)  WMRXU1        TFRXU1                         Update Program
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUC31 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   EVAL      TFRWU1 = ' '                                 Update User Id
     C                   MOVEL     @CN(069)      TFRWU1                         Update User Id
     C                   MOVEL     @CN(225)      TFRXU1                         Update Program
      * DB1.Update Date Timestamp = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         TFBHTS                         Update Date Tim
      * Set PGM.*Record Data Changed flag
     C                   IF        QPUC31 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @C3CPL8                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PUC3CPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TFEXIT        ENDSR
      /EJECT
     CSR   TGRVGN        BEGSR
      *================================================================
      * RTV All (Really all)  RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTG         KLIST
     C                   KFLD                    TEAIC3                         Company Number
     C                   KFLD                    TEC4NB                         Order Number
     C                   KFLD                    TEDPNB                         Order Sequence
     C                   KFLD                    TEUENB                         Order Secondary
      * Setup key
     C                   Z-ADD     WL0286        TEAIC3                         Company Number
     C                   Z-ADD     WL0287        TEC4NB                         Order Number
     C                   Z-ADD     WL0288        TEDPNB                         Order Sequence
     C                   Z-ADD     WL0289        TEUENB                         Order Secondary
      * Establish starting position
     C     KRSTG         CHAIN     @BGWKL1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1309'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         WL0290                         Item Code
     C                   EVAL      WL0291 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WL0292                         Ship To Custome
     C                   Z-ADD     *ZERO         WL0293                         Order Group Cod
     C                   EVAL      WL0294 = ' '                                 Detail Line Sta
     C                   EVAL      WL0295 = ' '                                 Detail Line Sta
     C                   Z-ADD     *ZERO         WL0296                         Billing Detail
     C                   Z-ADD     *ZERO         WL0297                         Billing Detail
     C                   Z-ADD     *ZERO         WL0298                         Billing Detail
     C                   Z-ADD     *ZERO         WL0299                         Quantity to Sub
     C                   EVAL      WL0300 = ' '                                 Comment Print A
     C                   EVAL      WL0301 = ' '                                 Comment Print I
     C                   EVAL      WL0302 = ' '                                 Comment Print P
     C                   EVAL      WL0303 = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         WL0304                         Extended Amount
     C                   Z-ADD     *ZERO         WL0305                         Market Pricing
     C                   EVAL      WL0306 = ' '                                 Commodity Marke
     C                   EVAL      WL0307 = ' '                                 Date Method Cod
     C                   EVAL      WL0308 = ' '                                 Price Method Co
     C                   Z-ADD     *ZERO         WL0309                         Price Overage O
     C                   Z-ADD     *ZERO         WL0310                         Contract Number
     C                   EVAL      WL0311 = ' '                                 Price Status
     C                   Z-ADD     *ZERO         WL0312                         Pricing Date Us
     C                   EVAL      WL0313 = ' '                                 U_M_Base Price
     C                   EVAL      WL0314 = ' '                                 U_M_Ordered
     C                   EVAL      WL0315 = ' '                                 Work Confirm St
     C                   EVAL      WL0316 = ' '                                 Work Over_Short
     C                   EVAL      WL0317 = ' '                                 OD Production P
     C                   EVAL      WL0318 = ' '                                 Order Desc_Line
     C                   EVAL      WL0319 = ' '                                 Order Desc_Line
     C                   EVAL      WL0320 = ' '                                 Age Code
     C                   EVAL      WL0321 = ' '                                 Palletize
     C                   EVAL      WL0322 = ' '                                 Slip Sheet
     C                   EVAL      WL0323 = ' '                                 Catch Weight St
     C                   EVAL      WL0324 = ' '                                 Price Audit
     C                   EVAL      WL0325 = ' '                                 Price Audit Rea
     C                   EVAL      WL0326 = ' '                                 Production Date
     C                   Z-ADD     *ZERO         WL0327                         Rated Freight
     C                   Z-ADD     *ZERO         WL0328                         Quantity Ordere
     C                   Z-ADD     *ZERO         WL0329                         Weight Ordered
     C                   Z-ADD     *ZERO         WL0330                         Quantity Schedu
     C                   Z-ADD     *ZERO         WL0331                         Weight Schedule
     C                   Z-ADD     *ZERO         WL0332                         Quantity Shippe
     C                   Z-ADD     *ZERO         WL0333                         Weight Shipped
     C                   Z-ADD     *ZERO         WL0334                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WL0335                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WL0336                         Unit Price
     C                   Z-ADD     *ZERO         WL0337                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WL0338                         Unit Price Orde
     C                   Z-ADD     *ZERO         WL0339                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WL0340                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WL0341                         Requested Ship
     C                   Z-ADD     *ZERO         WL0342                         Scheduled Ship
     C                   Z-ADD     *ZERO         WL0343                         Actual Shipped
     C                   EVAL      WL0344 = ' '                                 Affect Inventor
     C                   EVAL      WL0345 = ' '                                 Affect Sales Do
     C                   EVAL      WL0346 = ' '                                 Affect Sales Pn
     C                   Z-ADD     *ZERO         WL0347                         Item Structure
     C                   Z-ADD     *ZERO         WL0348                         Item Structure
     C                   Z-ADD     *ZERO         WL0349                         Item Structure
     C                   EVAL      WL0350 = ' '                                 Item Level
     C                   EVAL      WL0351 = ' '                                 Quality Level
     C                   EVAL      WL0352 = ' '                                 Pricing Product
     C                   EVAL      WL0353 = ' '                                 Season Product
     C                   Z-ADD     *ZERO         WL0354                         Date of Origina
     C                   EVAL      WL0355 = ' '                                 User Profile Na
     C                   EVAL      WL0356 = ' '                                 Country Code
     C                   EVAL      WL0357 = ' '                                 Event Code
     C                   EVAL      WL0358 = ' '                                 Reason Code
     C                   EVAL      WL0359 = ' '                                 Sales Route Cod
     C                   EVAL      WL0360 = ' '                                 Modified Flag
     C                   EVAL      WL0361 = ' '                                 Substituted Fla
     C                   EVAL      WL0362 = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         WL0363                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WL0364                         Invoice Extende
     C                   Z-ADD     *ZERO         WL0365                         Ham Group Numbe
     C                   EVAL      WL0366 = ' '                                 OD Adj Type Ove
     C                   EVAL      WL0367 = ' '                                 Affect Trade Fu
     C                   EVAL      WL0368 = ' '                                 Affect Commissi
     C                   EVAL      WL0369 = ' '                                 Affect Pricing
     C                   EVAL      WL0370 = ' '                                 Released by Use
     C                   EVAL      WL0371 = ' '                                 Ord TF Exempt C
     C                   EVAL      WL0372 = ' '                                 OD Pallet Type
     C                   EVAL      WL0373 = ' '                                 Production Ware
     C                   EVAL      WL0374 = ' '                                 OD Price Type
     C                   Z-ADD     *ZERO         WL0375                         Warehouse Palle
     C                   Z-ADD     *ZERO         WL0376                         Consumed Item C
     C                   Z-ADD     *ZERO         WL0377                         Deadline Depart
     C                   Z-ADD     *ZERO         WL0378                         OD Price Type R
     C                   Z-ADD     *ZERO         WL0379                         OD Firm Date
     C                   Z-ADD     *ZERO         WL0380                         Deadline Depart
     C                   Z-ADD     *ZERO         WL0381                         Price Code
     C                   Z-ADD     *ZERO         WL0382                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WL0383                         Substitution Li
     C                   Z-ADD     *ZERO         WL0384                         Max Qty to sche
     C                   Z-ADD     *ZERO         WL0385                         Warehouse Palle
     C                   Z-ADD     *ZERO         WL0386                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WL0387                         OD Item Target
     C                   Z-ADD     *ZERO         WL0388                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WL0389                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WL0390                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WL0391                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WL0392                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WL0393                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WL0394                         OD Original Ord
     C                   Z-ADD     *ZERO         WL0395                         OD Cancel Date
     C                   Z-ADD     *ZERO         WL0396                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WL0397                         OD Unused Prc 8
     C                   EVAL      WL0398 = ' '                                 OD MPR Sent to
     C                   EVAL      WL0399 = ' '                                 OD MPR Prc Read
     C                   EVAL      WL0400 = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         WL0401                         Weight Amount E
     C                   Z-ADD     *ZERO         WL0402                         Item Age Days
     C                   Z-ADD     *ZERO         WL0403                         Production Ovr
     C                   Z-ADD     *ZERO         WL0404                         Production Ovr
     C                   EVAL      WL0405 = ' '                                 OD Spot Buy
     C                   EVAL      WL0406 = ' '                                 OD Clm Full Ret
     C                   EVAL      WL0407 = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         WL0408                         OD Market Begin
     C                   Z-ADD     *ZERO         WL0409                         OD Market Endin
     C                   Z-ADD     *ZERO         WL0410                         OD Atch to Ord
     C                   EVAL      WL0411 = ' '                                 EDI Status 1
     C                   EVAL      WL0412 = ' '                                 EDI Status 2
     C                   EVAL      WL0413 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WL0414                         Job Time
     C                   EVAL      WL0415 = ' '                                 User Id
     C                   EVAL      WL0416 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WL0417                         Job Date
     C                   GOTO      TGEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     TEHGCD        WL0290                         Item Code
     C                   MOVEL     TEAJCD        WL0291                         Warehouse Code
     C                   Z-ADD     TEBKC7        WL0292                         Ship To Custome
     C                   Z-ADD     TECFC7        WL0293                         Order Group Cod
     C                   MOVEL     TEGMST        WL0294                         Detail Line Sta
     C                   MOVEL     TEGNST        WL0295                         Detail Line Sta
     C                   Z-ADD     TEMAVA        WL0296                         Billing Detail
     C                   Z-ADD     TEKDVA        WL0297                         Billing Detail
     C                   Z-ADD     TEL8VA        WL0298                         Billing Detail
     C                   Z-ADD     TEL9VA        WL0299                         Quantity to Sub
     C                   MOVEL     TEGTST        WL0300                         Comment Print A
     C                   MOVEL     TEGVST        WL0301                         Comment Print I
     C                   MOVEL     TEGUST        WL0302                         Comment Print P
     C                   MOVEL     TEQFST        WL0303                         Comment Print S
     C                   Z-ADD     TEAYVA        WL0304                         Extended Amount
     C                   Z-ADD     TEEXDT        WL0305                         Market Pricing
     C                   MOVEL     TELQCD        WL0306                         Commodity Marke
     C                   MOVEL     TERDCD        WL0307                         Date Method Cod
     C                   MOVEL     TEQ7CD        WL0308                         Price Method Co
     C                   Z-ADD     TEBZPR        WL0309                         Price Overage O
     C                   Z-ADD     TEL6NB        WL0310                         Contract Number
     C                   MOVEL     TEU1ST        WL0311                         Price Status
     C                   Z-ADD     TEGIDT        WL0312                         Pricing Date Us
     C                   MOVEL     TECRCD        WL0313                         U_M_Base Price
     C                   MOVEL     TEAGCD        WL0314                         U_M_Ordered
     C                   MOVEL     TERZST        WL0315                         Work Confirm St
     C                   MOVEL     TER0ST        WL0316                         Work Over_Short
     C                   MOVEL     TER1ST        WL0317                         OD Production P
     C                   MOVEL     TEG7NA        WL0318                         Order Desc_Line
     C                   MOVEL     TEG8NA        WL0319                         Order Desc_Line
     C                   MOVEL     TERPCD        WL0320                         Age Code
     C                   MOVEL     TEVEST        WL0321                         Palletize
     C                   MOVEL     TEVGST        WL0322                         Slip Sheet
     C                   MOVEL     TEAVST        WL0323                         Catch Weight St
     C                   MOVEL     TEU0ST        WL0324                         Price Audit
     C                   MOVEL     TERFCD        WL0325                         Price Audit Rea
     C                   MOVEL     TEFZST        WL0326                         Production Date
     C                   Z-ADD     TER1NB        WL0327                         Rated Freight
     C                   Z-ADD     TEAVQT        WL0328                         Quantity Ordere
     C                   Z-ADD     TED0WG        WL0329                         Weight Ordered
     C                   Z-ADD     TECCQT        WL0330                         Quantity Schedu
     C                   Z-ADD     TEAUWG        WL0331                         Weight Schedule
     C                   Z-ADD     TECBQT        WL0332                         Quantity Shippe
     C                   Z-ADD     TEATWG        WL0333                         Weight Shipped
     C                   Z-ADD     TEAQCS        WL0334                         Unit Cost Prici
     C                   Z-ADD     TEAGCS        WL0335                         Unit Cost Per P
     C                   Z-ADD     TEAKPR        WL0336                         Unit Price
     C                   Z-ADD     TEALPR        WL0337                         Unit Price_Cred
     C                   Z-ADD     TEAUPR        WL0338                         Unit Price Orde
     C                   Z-ADD     TEAVWG        WL0339                         Unit Weight Ord
     C                   Z-ADD     TEA4WG        WL0340                         Tare Weight Tot
     C                   Z-ADD     TEA5DT        WL0341                         Requested Ship
     C                   Z-ADD     TEAODT        WL0342                         Scheduled Ship
     C                   Z-ADD     TEGNDT        WL0343                         Actual Shipped
     C                   MOVEL     TEAMST        WL0344                         Affect Inventor
     C                   MOVEL     TEANST        WL0345                         Affect Sales Do
     C                   MOVEL     TEVAST        WL0346                         Affect Sales Pn
     C                   Z-ADD     TERGNB        WL0347                         Item Structure
     C                   Z-ADD     TERHNB        WL0348                         Item Structure
     C                   Z-ADD     TERINB        WL0349                         Item Structure
     C                   MOVEL     TERBCD        WL0350                         Item Level
     C                   MOVEL     TEHICD        WL0351                         Quality Level
     C                   MOVEL     TERNCD        WL0352                         Pricing Product
     C                   MOVEL     TEROCD        WL0353                         Season Product
     C                   Z-ADD     TECXDT        WL0354                         Date of Origina
     C                   MOVEL     TEAJVN        WL0355                         User Profile Na
     C                   MOVEL     TEKXCD        WL0356                         Country Code
     C                   MOVEL     TEJPCD        WL0357                         Event Code
     C                   MOVEL     TECQCD        WL0358                         Reason Code
     C                   MOVEL     TER4CD        WL0359                         Sales Route Cod
     C                   MOVEL     TEZ1ST        WL0360                         Modified Flag
     C                   MOVEL     TEZ3ST        WL0361                         Substituted Fla
     C                   MOVEL     TEZ4ST        WL0362                         OD Schedule Ove
     C                   Z-ADD     TEDUPR        WL0363                         Invoice Unit Pr
     C                   Z-ADD     TEB6VL        WL0364                         Invoice Extende
     C                   Z-ADD     TEA1AA        WL0365                         Ham Group Numbe
     C                   MOVEL     TEFZSX        WL0366                         OD Adj Type Ove
     C                   MOVEL     TEF0SX        WL0367                         Affect Trade Fu
     C                   MOVEL     TEF1SX        WL0368                         Affect Commissi
     C                   MOVEL     TEF2SX        WL0369                         Affect Pricing
     C                   MOVEL     TEF3SX        WL0370                         Released by Use
     C                   MOVEL     TEF4SX        WL0371                         Ord TF Exempt C
     C                   MOVEL     TEF5SX        WL0372                         OD Pallet Type
     C                   MOVEL     TEF6SX        WL0373                         Production Ware
     C                   MOVEL     TEF7SX        WL0374                         OD Price Type
     C                   Z-ADD     TENTDT        WL0375                         Warehouse Palle
     C                   Z-ADD     TENUDT        WL0376                         Consumed Item C
     C                   Z-ADD     TENVDT        WL0377                         Deadline Depart
     C                   Z-ADD     TENWDT        WL0378                         OD Price Type R
     C                   Z-ADD     TENXDT        WL0379                         OD Firm Date
     C                   Z-ADD     TEBUTM        WL0380                         Deadline Depart
     C                   Z-ADD     TEBVTM        WL0381                         Price Code
     C                   Z-ADD     TEBWTM        WL0382                         Maximum Net Wei
     C                   Z-ADD     TEBXTM        WL0383                         Substitution Li
     C                   Z-ADD     TEBYTM        WL0384                         Max Qty to sche
     C                   Z-ADD     TEH5NX        WL0385                         Warehouse Palle
     C                   Z-ADD     TEH6NX        WL0386                         Warehouse Avg P
     C                   Z-ADD     TEH7NX        WL0387                         OD Item Target
     C                   Z-ADD     TEH8NX        WL0388                         OD Estimated Gr
     C                   Z-ADD     TEH9NX        WL0389                         OD Maximum Unit
     C                   Z-ADD     TEDVPR        WL0390                         Order Gate_Fina
     C                   Z-ADD     TEDWPR        WL0391                         OD Ceiling Pric
     C                   Z-ADD     TEDXPR        WL0392                         OD Gate_Final P
     C                   Z-ADD     TEDYPR        WL0393                         OD Weighted Avg
     C                   Z-ADD     TEDZPR        WL0394                         OD Original Ord
     C                   Z-ADD     TEGSPR        WL0395                         OD Cancel Date
     C                   Z-ADD     TEGTPR        WL0396                         OD Unused Prc 7
     C                   Z-ADD     TEGUPR        WL0397                         OD Unused Prc 8
     C                   MOVEL     TEHOST        WL0398                         OD MPR Sent to
     C                   MOVEL     TEHPST        WL0399                         OD MPR Prc Read
     C                   MOVEL     TEIOST        WL0400                         OD UnUsed Price
     C                   Z-ADD     TEPEWG        WL0401                         Weight Amount E
     C                   Z-ADD     TERINY        WL0402                         Item Age Days
     C                   Z-ADD     TETIDT        WL0403                         Production Ovr
     C                   Z-ADD     TETJDT        WL0404                         Production Ovr
     C                   MOVEL     TEH2ST        WL0405                         OD Spot Buy
     C                   MOVEL     TEH0ST        WL0406                         OD Clm Full Ret
     C                   MOVEL     TEH1ST        WL0407                         Order Line Erro
     C                   Z-ADD     TETKDT        WL0408                         OD Market Begin
     C                   Z-ADD     TETLDT        WL0409                         OD Market Endin
     C                   Z-ADD     TETMDT        WL0410                         OD Atch to Ord
     C                   MOVEL     TEUVST        WL0411                         EDI Status 1
     C                   MOVEL     TEUWST        WL0412                         EDI Status 2
     C                   MOVEL     TEUXST        WL0413                         EDI Status 3
     C                   Z-ADD     TEAATM        WL0414                         Job Time
     C                   MOVEL     TEAYNA        WL0415                         User Id
     C                   MOVEL     TEA0NA        WL0416                         Job Name
     C                   Z-ADD     TEAXDT        WL0417                         Job Date
     C                   ENDIF
      *================================================================
     CSR   TGEXIT        ENDSR
      /EJECT
     CSR   THRVGN        BEGSR
      *================================================================
      * RTV Cancel Order Detail - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTH         KLIST
     C                   KFLD                    WQTH01                         Company Number
     C                   KFLD                    WQTH02                         Order Number
     C                   KFLD                    WQTH03                         Order Sequence
      * Setup key
     C                   Z-ADD     WL0418        WQTH01                         Company Number
     C                   Z-ADD     WL0419        WQTH02                         Order Number
     C                   Z-ADD     WL0420        WQTH03                         Order Sequence
      * Establish starting position
     C     KRSTH         SETLL     @BGWKL1                                      *
     C     KRSTH         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   Z-ADD     TECCQT        YL0409                         Quantity Schedu
     C                   Z-ADD     TEAUWG        YL0410                         Weight Schedule
      * **WI546_2-Dealloc inventory
      * CASE: DB1.OD Production Plan Sts is Yes
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                   IF        TER1ST = ' '
     C                   CALL      'PDQNXFR'                            90      UPD Avail-To-Se
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TEAIC3        WQ0765                         Company Number
     C                   PARM      TEC4NB        WQ0766                         Order Number
     C                   PARM      TEDPNB        WQ0767                         Order Sequence
     C                   PARM      TEUENB        WQ0768                         Order Secondary
     C                   PARM      TEHGCD        WQ0769                         Item Code
     C                   PARM      TEAJCD        WQ0770                         Warehouse Code
     C                   PARM      TEA5DT        WQ0771                         Ship Date USR
     C                   PARM      *ZERO         WQ0772                         Quantity Ordere
     C                   PARM      *ZERO         WQ0773                         Weight Ordered
     C     YL0409        PARM      YL0409        WQ0774                         Quantity Schedu
     C     YL0410        PARM      YL0410        WQ0775                         Weight Schedule
     C                   PARM      'OD'          WQ0776                         ATS Adj Type US
     C                   PARM      ##PGM         WQ0777                         PSAA Program Na
     C                   PARM      TERINY        WQ0778                         Item Age Days
     C                   PARM      TETIDT        WQ0779                         Production Ovr
     C                   PARM      TETJDT        WQ0780                         Production Ovr
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDQNXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0409                         Quantity Schedu
     C                   Z-ADD     *ZERO         YL0410                         Weight Schedule
     C                   END                                                    *FI
      * Chg Qty/Wgt Sched BlockOR - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0423                         Company Number
     C                   Z-ADD     TEC4NB        WL0424                         Order Number
     C                   Z-ADD     TEDPNB        WL0425                         Order Sequence
     C                   Z-ADD     TEUENB        WL0426                         Order Secondary
     C                   Z-ADD     YL0409        WL0427                         Quantity Schedu
     C                   Z-ADD     YL0410        WL0428                         Weight Schedule
     C                   EXSR      TICHRC
      * **WI546_2-Cancellation logic same as PDN9EFR UI.
      * CASE: DB1.Detail Line Status is Entered
      * DLT PD Order Detail    DL - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        TEGMST = 'E'
     C                   Z-ADD     TEAIC3        WL0429                         Company Number
     C                   Z-ADD     TEC4NB        WL0430                         Order Number
     C                   Z-ADD     TEDPNB        WL0431                         Order Sequence
     C                   Z-ADD     TEUENB        WL0432                         Order Secondary
     C                   EXSR      TJDLRC
      * Rtv Dlt OD Files/CanclXF - Order Detail  * 
     C                   CALL      'PUKGXFR'                            90      Rtv Dlt OD File
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TEAIC3        WQ0781                         Company Number
     C                   PARM      TEC4NB        WQ0782                         Order Number
     C                   PARM      TEDPNB        WQ0783                         Order Sequence
     C                   PARM      TEUENB        WQ0784                         Order Secondary
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUKGXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     TEGMST        YL0411                         Detail Line Sta
     C                   MOVEL     'X'           YL0412                         Detail Line Sta
      * CHG Sts,Alloc          CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0433                         Company Number
     C                   Z-ADD     TEC4NB        WL0434                         Order Number
     C                   Z-ADD     TEDPNB        WL0435                         Order Sequence
     C                   Z-ADD     TEUENB        WL0436                         Order Secondary
     C                   MOVEL(P)  YL0412        WL0437                         Detail Line Sta
     C                   MOVEL(P)  YL0411        WL0438                         Detail Line Sta
     C                   Z-ADD     TECCQT        WL0439                         Quantity Schedu
     C                   Z-ADD     TEAUWG        WL0440                         Weight Schedule
     C                   EXSR      TKCHRC
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0441                         Company Number
     C                   Z-ADD     TEC4NB        WL0442                         Order Number
     C                   Z-ADD     TEDPNB        WL0443                         Order Sequence
     C                   Z-ADD     TEUENB        WL0444                         Order Secondary
     C                   EXSR      TLRVGN
     C                   END                                                    *FI
     C     KRSTH         READE     @BGWKL1                                90    *
     C                   ENDDO
      * USER: Exit processing
      * RTV If Item Not Cancelled - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0445                         Company Number
     C                   Z-ADD     TEC4NB        WL0446                         Order Number
     C                   EXSR      TNRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0447        YL0418                         USR Return Code
      * CASE: LCL.USR Return Code is Does Not Exist
     C                   IF        YL0418 = 'N'
     C                   MOVEL     TEGMST        YL0419                         Header Status L
      * Chg Order Status BlockOrd - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0448                         Company Number
     C                   Z-ADD     TEC4NB        WL0449                         Order Number
     C                   Z-ADD     WL0422        WL0450                         Cancel Date
     C                   MOVEL(P)  'X'           WL0451                         Header Status
     C                   MOVEL(P)  YL0419        WL0452                         Header Status L
     C                   Z-ADD     *ZERO         WL0453                         Order Value Tot
     C                   Z-ADD     *ZERO         WL0454                         Order Weight To
     C                   MOVEL(P)  'N'           WL0455                         Credit Hold
     C                   MOVEL(P)  'N'           WL0456                         Production Hold
     C                   Z-ADD     *ZERO         WL0457                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WL0458                         Rated Freight
     C                   Z-ADD     *ZERO         WL0459                         Attach to Invoi
     C                   MOVEL(P)  'N'           WL0460                         Affect Auto Acc
     C                   EVAL      WL0461 = ' '                                 Sales Route Cod
     C                   Z-ADD     *ZERO         WL0462                         Attach to Order
     C                   EVAL      WL0463 = ' '                                 Reason for Pric
     C                   Z-ADD     *ZERO         WL0464                         A_R order Value
     C                   EXSR      TOCHRC
     C                   END                                                    *FI
      *================================================================
     CSR   THEXIT        ENDSR
      /EJECT
     CSR   TICHRC        BEGSR
      *================================================================
      * Chg Qty/Wgt Sched BlockOR - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0027                         Item Code
     C                   EVAL      WN0028 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0029                         Ship To Custome
     C                   Z-ADD     *ZERO         WN0030                         Order Group Cod
     C                   EVAL      WN0031 = ' '                                 Detail Line Sta
     C                   EVAL      WN0032 = ' '                                 Detail Line Sta
     C                   Z-ADD     *ZERO         WN0033                         Billing Detail
     C                   Z-ADD     *ZERO         WN0034                         Billing Detail
     C                   Z-ADD     *ZERO         WN0035                         Billing Detail
     C                   Z-ADD     *ZERO         WN0036                         Quantity to Sub
     C                   EVAL      WN0037 = ' '                                 Comment Print A
     C                   EVAL      WN0038 = ' '                                 Comment Print I
     C                   EVAL      WN0039 = ' '                                 Comment Print P
     C                   EVAL      WN0040 = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         WN0041                         Extended Amount
     C                   Z-ADD     *ZERO         WN0042                         Market Pricing
     C                   EVAL      WN0043 = ' '                                 Commodity Marke
     C                   EVAL      WN0044 = ' '                                 Date Method Cod
     C                   EVAL      WN0045 = ' '                                 Price Method Co
     C                   Z-ADD     *ZERO         WN0046                         Price Overage O
     C                   Z-ADD     *ZERO         WN0047                         Contract Number
     C                   EVAL      WN0048 = ' '                                 Price Status
     C                   Z-ADD     *ZERO         WN0049                         Pricing Date Us
     C                   EVAL      WN0050 = ' '                                 U_M_Base Price
     C                   EVAL      WN0051 = ' '                                 U_M_Ordered
     C                   EVAL      WN0052 = ' '                                 Work Confirm St
     C                   EVAL      WN0053 = ' '                                 Work Over_Short
     C                   EVAL      WN0054 = ' '                                 OD Production P
     C                   EVAL      WN0055 = ' '                                 Order Desc_Line
     C                   EVAL      WN0056 = ' '                                 Order Desc_Line
     C                   EVAL      WN0057 = ' '                                 Age Code
     C                   EVAL      WN0058 = ' '                                 Palletize
     C                   EVAL      WN0059 = ' '                                 Slip Sheet
     C                   EVAL      WN0060 = ' '                                 Catch Weight St
     C                   EVAL      WN0061 = ' '                                 Price Audit
     C                   EVAL      WN0062 = ' '                                 Price Audit Rea
     C                   EVAL      WN0063 = ' '                                 Production Date
     C                   Z-ADD     *ZERO         WN0064                         Rated Freight
     C                   Z-ADD     *ZERO         WN0065                         Quantity Ordere
     C                   Z-ADD     *ZERO         WN0066                         Weight Ordered
     C                   Z-ADD     *ZERO         WN0067                         Quantity Shippe
     C                   Z-ADD     *ZERO         WN0068                         Weight Shipped
     C                   Z-ADD     *ZERO         WN0069                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WN0070                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WN0071                         Unit Price
     C                   Z-ADD     *ZERO         WN0072                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WN0073                         Unit Price Orde
     C                   Z-ADD     *ZERO         WN0074                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WN0075                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WN0076                         Requested Ship
     C                   Z-ADD     *ZERO         WN0077                         Scheduled Ship
     C                   Z-ADD     *ZERO         WN0078                         Actual Shipped
     C                   EVAL      WN0079 = ' '                                 Affect Inventor
     C                   EVAL      WN0080 = ' '                                 Affect Sales Do
     C                   EVAL      WN0081 = ' '                                 Affect Sales Pn
     C                   Z-ADD     *ZERO         WN0082                         Item Structure
     C                   Z-ADD     *ZERO         WN0083                         Item Structure
     C                   Z-ADD     *ZERO         WN0084                         Item Structure
     C                   EVAL      WN0085 = ' '                                 Item Level
     C                   EVAL      WN0086 = ' '                                 Quality Level
     C                   EVAL      WN0087 = ' '                                 Pricing Product
     C                   EVAL      WN0088 = ' '                                 Season Product
     C                   Z-ADD     *ZERO         WN0089                         Date of Origina
     C                   EVAL      WN0090 = ' '                                 User Profile Na
     C                   EVAL      WN0091 = ' '                                 Country Code
     C                   EVAL      WN0092 = ' '                                 Event Code
     C                   EVAL      WN0093 = ' '                                 Reason Code
     C                   EVAL      WN0094 = ' '                                 Sales Route Cod
     C                   EVAL      WN0095 = ' '                                 Modified Flag
     C                   EVAL      WN0096 = ' '                                 Substituted Fla
     C                   EVAL      WN0097 = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         WN0098                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WN0099                         Invoice Extende
     C                   Z-ADD     *ZERO         WN0100                         Ham Group Numbe
     C                   EVAL      WN0101 = ' '                                 OD Adj Type Ove
     C                   EVAL      WN0102 = ' '                                 Affect Trade Fu
     C                   EVAL      WN0103 = ' '                                 Affect Commissi
     C                   EVAL      WN0104 = ' '                                 Affect Pricing
     C                   EVAL      WN0105 = ' '                                 Released by Use
     C                   EVAL      WN0106 = ' '                                 Ord TF Exempt C
     C                   EVAL      WN0107 = ' '                                 OD Pallet Type
     C                   EVAL      WN0108 = ' '                                 Production Ware
     C                   EVAL      WN0109 = ' '                                 OD Price Type
     C                   Z-ADD     *ZERO         WN0110                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0111                         Consumed Item C
     C                   Z-ADD     *ZERO         WN0112                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0113                         OD Price Type R
     C                   Z-ADD     *ZERO         WN0114                         OD Firm Date
     C                   Z-ADD     *ZERO         WN0115                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0116                         Price Code
     C                   Z-ADD     *ZERO         WN0117                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WN0118                         Substitution Li
     C                   Z-ADD     *ZERO         WN0119                         Max Qty to sche
     C                   Z-ADD     *ZERO         WN0120                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0121                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WN0122                         OD Item Target
     C                   Z-ADD     *ZERO         WN0123                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WN0124                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WN0125                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WN0126                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WN0127                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WN0128                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WN0129                         OD Original Ord
     C                   Z-ADD     *ZERO         WN0130                         OD Cancel Date
     C                   Z-ADD     *ZERO         WN0131                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WN0132                         OD Unused Prc 8
     C                   EVAL      WN0133 = ' '                                 OD MPR Sent to
     C                   EVAL      WN0134 = ' '                                 OD MPR Prc Read
     C                   EVAL      WN0135 = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         WN0136                         Weight Amount E
     C                   Z-ADD     *ZERO         WN0137                         Item Age Days
     C                   Z-ADD     *ZERO         WN0138                         Production Ovr
     C                   Z-ADD     *ZERO         WN0139                         Production Ovr
     C                   EVAL      WN0140 = ' '                                 OD Spot Buy
     C                   EVAL      WN0141 = ' '                                 OD Clm Full Ret
     C                   EVAL      WN0142 = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         WN0143                         OD Market Begin
     C                   Z-ADD     *ZERO         WN0144                         OD Market Endin
     C                   Z-ADD     *ZERO         WN0145                         OD Atch to Ord
     C                   EVAL      WN0146 = ' '                                 EDI Status 1
     C                   EVAL      WN0147 = ' '                                 EDI Status 2
     C                   EVAL      WN0148 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0149                         Job Time
     C                   EVAL      WN0150 = ' '                                 User Id
     C                   EVAL      WN0151 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0152                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YCRDC = ' '
      *
      * Move key fields to @BGWKL0
     C                   Z-ADD     WL0423        TGAIC3                         Company Number
     C                   Z-ADD     WL0424        TGC4NB                         Order Number
     C                   Z-ADD     WL0425        TGDPNB                         Order Sequence
     C                   Z-ADD     WL0426        TGUENB                         Order Secondary
      *
     C     KLCHTI        KLIST
     C                   KFLD                    TGAIC3                         Company Number
     C                   KFLD                    TGC4NB                         Order Number
     C                   KFLD                    TGDPNB                         Order Sequence
     C                   KFLD                    TGUENB                         Order Secondary
     C     KLCHTI        CHAIN     @BGWKL0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TIEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TIEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBG1        YCRDCS
      * Move non-key fields to @BGWKL0
     C                   Z-ADD     WL0427        TGCCQT                         Quantity Schedu
     C                   Z-ADD     WL0428        TGAUWG                         Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                   Z-ADD     ##JTM         TGAATM                         Job Time
     C                   MOVEL     ##USR         TGAYNA                         User Id
     C                   MOVEL     ##PGM         TGA0NA                         Job Name
     C                   Z-ADD     ##JDT         TGAXDT                         Job Date
     C                   MOVEL     @CN(069)      TGAYNA                         User Id
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YCRDC = 'Y'
     C                   UPDATE    @BGWKL0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBGWKL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TIEXIT        ENDSR
      /EJECT
     CSR   TJDLRC        BEGSR
      *================================================================
      * DLT PD Order Detail    DL - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move key fields to @BGWKL0
     C                   Z-ADD     WL0429        TGAIC3                         Company Number
     C                   Z-ADD     WL0430        TGC4NB                         Order Number
     C                   Z-ADD     WL0431        TGDPNB                         Order Sequence
     C                   Z-ADD     WL0432        TGUENB                         Order Secondary
      *
     C     KLDLTJ        KLIST
     C                   KFLD                    TGAIC3                         Company Number
     C                   KFLD                    TGC4NB                         Order Number
     C                   KFLD                    TGDPNB                         Order Sequence
     C                   KFLD                    TGUENB                         Order Secondary
     C     KLDLTJ        CHAIN     @BGWKL0                            9091      *
      * Record already deleted
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*DLT'        MDACT
      * Record not found label: LBL004.
     C                   MOVEL     'LBL004'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TJEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TJEXIT
     C                   ENDIF
      *
      *................................................................
     C                   DELETE    @BGWKL0                              91      *
      * Delete error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   TJEXIT        ENDSR
      /EJECT
     CSR   TKCHRC        BEGSR
      *================================================================
      * CHG Sts,Alloc          CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0153                         Item Code
     C                   EVAL      WN0154 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0155                         Ship To Custome
     C                   Z-ADD     *ZERO         WN0156                         Order Group Cod
     C                   Z-ADD     *ZERO         WN0157                         Billing Detail
     C                   Z-ADD     *ZERO         WN0158                         Billing Detail
     C                   Z-ADD     *ZERO         WN0159                         Billing Detail
     C                   Z-ADD     *ZERO         WN0160                         Quantity to Sub
     C                   EVAL      WN0161 = ' '                                 Comment Print A
     C                   EVAL      WN0162 = ' '                                 Comment Print I
     C                   EVAL      WN0163 = ' '                                 Comment Print P
     C                   EVAL      WN0164 = ' '                                 Comment Print S
     C                   Z-ADD     *ZERO         WN0165                         Extended Amount
     C                   Z-ADD     *ZERO         WN0166                         Market Pricing
     C                   EVAL      WN0167 = ' '                                 Commodity Marke
     C                   EVAL      WN0168 = ' '                                 Date Method Cod
     C                   EVAL      WN0169 = ' '                                 Price Method Co
     C                   Z-ADD     *ZERO         WN0170                         Price Overage O
     C                   Z-ADD     *ZERO         WN0171                         Contract Number
     C                   EVAL      WN0172 = ' '                                 Price Status
     C                   Z-ADD     *ZERO         WN0173                         Pricing Date Us
     C                   EVAL      WN0174 = ' '                                 U_M_Base Price
     C                   EVAL      WN0175 = ' '                                 U_M_Ordered
     C                   EVAL      WN0176 = ' '                                 Work Confirm St
     C                   EVAL      WN0177 = ' '                                 Work Over_Short
     C                   EVAL      WN0178 = ' '                                 OD Production P
     C                   EVAL      WN0179 = ' '                                 Order Desc_Line
     C                   EVAL      WN0180 = ' '                                 Order Desc_Line
     C                   EVAL      WN0181 = ' '                                 Age Code
     C                   EVAL      WN0182 = ' '                                 Palletize
     C                   EVAL      WN0183 = ' '                                 Slip Sheet
     C                   EVAL      WN0184 = ' '                                 Catch Weight St
     C                   EVAL      WN0185 = ' '                                 Price Audit
     C                   EVAL      WN0186 = ' '                                 Price Audit Rea
     C                   EVAL      WN0187 = ' '                                 Production Date
     C                   Z-ADD     *ZERO         WN0188                         Rated Freight
     C                   Z-ADD     *ZERO         WN0189                         Quantity Ordere
     C                   Z-ADD     *ZERO         WN0190                         Weight Ordered
     C                   Z-ADD     *ZERO         WN0191                         Quantity Shippe
     C                   Z-ADD     *ZERO         WN0192                         Weight Shipped
     C                   Z-ADD     *ZERO         WN0193                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WN0194                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WN0195                         Unit Price
     C                   Z-ADD     *ZERO         WN0196                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WN0197                         Unit Price Orde
     C                   Z-ADD     *ZERO         WN0198                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WN0199                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WN0200                         Requested Ship
     C                   Z-ADD     *ZERO         WN0201                         Scheduled Ship
     C                   Z-ADD     *ZERO         WN0202                         Actual Shipped
     C                   EVAL      WN0203 = ' '                                 Affect Inventor
     C                   EVAL      WN0204 = ' '                                 Affect Sales Do
     C                   EVAL      WN0205 = ' '                                 Affect Sales Pn
     C                   Z-ADD     *ZERO         WN0206                         Item Structure
     C                   Z-ADD     *ZERO         WN0207                         Item Structure
     C                   Z-ADD     *ZERO         WN0208                         Item Structure
     C                   EVAL      WN0209 = ' '                                 Item Level
     C                   EVAL      WN0210 = ' '                                 Quality Level
     C                   EVAL      WN0211 = ' '                                 Pricing Product
     C                   EVAL      WN0212 = ' '                                 Season Product
     C                   Z-ADD     *ZERO         WN0213                         Date of Origina
     C                   EVAL      WN0214 = ' '                                 User Profile Na
     C                   EVAL      WN0215 = ' '                                 Country Code
     C                   EVAL      WN0216 = ' '                                 Event Code
     C                   EVAL      WN0217 = ' '                                 Reason Code
     C                   EVAL      WN0218 = ' '                                 Sales Route Cod
     C                   EVAL      WN0219 = ' '                                 Modified Flag
     C                   EVAL      WN0220 = ' '                                 Substituted Fla
     C                   EVAL      WN0221 = ' '                                 OD Schedule Ove
     C                   Z-ADD     *ZERO         WN0222                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WN0223                         Invoice Extende
     C                   Z-ADD     *ZERO         WN0224                         Ham Group Numbe
     C                   EVAL      WN0225 = ' '                                 OD Adj Type Ove
     C                   EVAL      WN0226 = ' '                                 Affect Trade Fu
     C                   EVAL      WN0227 = ' '                                 Affect Commissi
     C                   EVAL      WN0228 = ' '                                 Affect Pricing
     C                   EVAL      WN0229 = ' '                                 Released by Use
     C                   EVAL      WN0230 = ' '                                 Ord TF Exempt C
     C                   EVAL      WN0231 = ' '                                 OD Pallet Type
     C                   EVAL      WN0232 = ' '                                 Production Ware
     C                   EVAL      WN0233 = ' '                                 OD Price Type
     C                   Z-ADD     *ZERO         WN0234                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0235                         Consumed Item C
     C                   Z-ADD     *ZERO         WN0236                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0237                         OD Price Type R
     C                   Z-ADD     *ZERO         WN0238                         OD Firm Date
     C                   Z-ADD     *ZERO         WN0239                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0240                         Price Code
     C                   Z-ADD     *ZERO         WN0241                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WN0242                         Substitution Li
     C                   Z-ADD     *ZERO         WN0243                         Max Qty to sche
     C                   Z-ADD     *ZERO         WN0244                         Warehouse Palle
     C                   Z-ADD     *ZERO         WN0245                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WN0246                         OD Item Target
     C                   Z-ADD     *ZERO         WN0247                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WN0248                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WN0249                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WN0250                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WN0251                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WN0252                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WN0253                         OD Original Ord
     C                   Z-ADD     *ZERO         WN0254                         OD Cancel Date
     C                   Z-ADD     *ZERO         WN0255                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WN0256                         OD Unused Prc 8
     C                   EVAL      WN0257 = ' '                                 OD MPR Sent to
     C                   EVAL      WN0258 = ' '                                 OD MPR Prc Read
     C                   EVAL      WN0259 = ' '                                 OD UnUsed Price
     C                   Z-ADD     *ZERO         WN0260                         Weight Amount E
     C                   Z-ADD     *ZERO         WN0261                         Item Age Days
     C                   Z-ADD     *ZERO         WN0262                         Production Ovr
     C                   Z-ADD     *ZERO         WN0263                         Production Ovr
     C                   EVAL      WN0264 = ' '                                 OD Spot Buy
     C                   EVAL      WN0265 = ' '                                 OD Clm Full Ret
     C                   EVAL      WN0266 = ' '                                 Order Line Erro
     C                   Z-ADD     *ZERO         WN0267                         OD Market Begin
     C                   Z-ADD     *ZERO         WN0268                         OD Market Endin
     C                   Z-ADD     *ZERO         WN0269                         OD Atch to Ord
     C                   EVAL      WN0270 = ' '                                 EDI Status 1
     C                   EVAL      WN0271 = ' '                                 EDI Status 2
     C                   EVAL      WN0272 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0273                         Job Time
     C                   EVAL      WN0274 = ' '                                 User Id
     C                   EVAL      WN0275 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0276                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YDRDC = ' '
      *
      * Move key fields to @BGWKL0
     C                   Z-ADD     WL0433        TGAIC3                         Company Number
     C                   Z-ADD     WL0434        TGC4NB                         Order Number
     C                   Z-ADD     WL0435        TGDPNB                         Order Sequence
     C                   Z-ADD     WL0436        TGUENB                         Order Secondary
      *
     C     KLCHTK        KLIST
     C                   KFLD                    TGAIC3                         Company Number
     C                   KFLD                    TGC4NB                         Order Number
     C                   KFLD                    TGDPNB                         Order Sequence
     C                   KFLD                    TGUENB                         Order Secondary
     C     KLCHTK        CHAIN     @BGWKL0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL005.
     C                   MOVEL     'LBL005'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TKEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TKEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBG1        YDRDCS
      * Move non-key fields to @BGWKL0
     C                   MOVEL(P)  WL0437        TGGMST                         Detail Line Sta
     C                   MOVEL(P)  WL0438        TGGNST                         Detail Line Sta
     C                   Z-ADD     WL0439        TGCCQT                         Quantity Schedu
     C                   Z-ADD     WL0440        TGAUWG                         Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YDRDCS AND
     C                             YDRDC <> 'N'
     C                   MOVE      'Y'           YDRDC
     C                   ENDIF
      * USER: Processing before Data update
      * E2640 Write chg log for cancel line item
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Detail Line Status is Cancelled
      *   |- c2    : PAR.Detail Line Status Last is Not cancelled
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WL0437 = 'X'
     C                   IF        WL0438 = 'L' OR
     C                             WL0438 = 'A' OR
     C                             WL0438 = 'C' OR
     C                             WL0438 = 'R' OR
     C                             WL0438 = 'E' OR
     C                             WL0438 = 'H' OR
     C                             WL0438 = 'I'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     TGDPNB        YL0413                         Text 3 Length U
     C                   Z-ADD     TGD0WG        YL0414                         Weight Beg Inv
     C                   MOVEL     YL0414        YL0415                         Text USR 7
     C                   Z-ADD     1             ZQ
     C     YL0413        CAT(P)    YL0415:ZQ     YL0416                         Change Log Prio
      * New value is -0- for cancel
     C                   Z-ADD     0             YL0414                         Weight Beg Inv
     C                   EVAL      YL0417 = ' '                                 Change Log New
     C                   MOVEL     YL0414        YL0417                         Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                   CALL      'PBFLXFR'                            90      CRT Load/OrderC
     C                   PARM      *BLANK        W0RTN
     C                   PARM      *ZERO         WQ0785                         Load ID
     C                   PARM      'ORDWGT'      WQ0786                         Load Change Typ
     C                   PARM      'SLS'         WQ0787                         Department Cont
     C                   PARM      YL0416        WQ0788                         Change Log Prio
     C                   PARM      YL0417        WQ0789                         Change Log New
     C                   PARM      TGAIC3        WQ0790                         Company Number
     C                   PARM      TGC4NB        WQ0791                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBFLXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     TGAVQT        YL0414                         Weight Beg Inv
     C                   MOVEL     YL0414        YL0415                         Text USR 7
     C                   Z-ADD     1             ZQ
     C     YL0413        CAT(P)    YL0415:ZQ     YL0416                         Change Log Prio
      * New value is -0- for cancel
     C                   Z-ADD     0             YL0414                         Weight Beg Inv
     C                   EVAL      YL0417 = ' '                                 Change Log New
     C                   MOVEL     YL0414        YL0417                         Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                   CALL      'PBFLXFR'                            90      CRT Load/OrderC
     C                   PARM      *BLANK        W0RTN
     C                   PARM      *ZERO         WQ0792                         Load ID
     C                   PARM      'ORDQTY'      WQ0793                         Load Change Typ
     C                   PARM      'SLS'         WQ0794                         Department Cont
     C                   PARM      YL0416        WQ0795                         Change Log Prio
     C                   PARM      YL0417        WQ0796                         Change Log New
     C                   PARM      TGAIC3        WQ0797                         Company Number
     C                   PARM      TGC4NB        WQ0798                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBFLXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YDRDCS AND
     C                             YDRDC <> 'N'
     C                   MOVE      'Y'           YDRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YDRDC = 'Y'
     C                   UPDATE    @BGWKL0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBGWKL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TKEXIT        ENDSR
      /EJECT
     CSR   TLRVGN        BEGSR
      *================================================================
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTL         KLIST
     C                   KFLD                    WQTL01                         Company Number
     C                   KFLD                    WQTL02                         Order Number
     C                   KFLD                    WQTL03                         Order Sequence
     C                   KFLD                    WQTL04                         Order Secondary
      * Setup key
     C                   Z-ADD     WL0441        WQTL01                         Company Number
     C                   Z-ADD     WL0442        WQTL02                         Order Number
     C                   Z-ADD     WL0443        WQTL03                         Order Sequence
     C                   Z-ADD     WL0444        WQTL04                         Order Secondary
      * Establish starting position
     C     KRSTL         SETLL     @MSREX2                                      *
     C     KRSTL         READE     @MSREX2                                90    *
      * Data record not found
     C   90              MOVEL     'USR2745'     W0RTN
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                   DOW       NOT *IN90
     C                   EXSR      TMDLRC
     C     KRSTL         READE     @MSREX2                                90    *
     C                   ENDDO
      *================================================================
     CSR   TLEXIT        ENDSR
      /EJECT
     CSR   TMDLRC        BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move key fields to @MSREW4
     C                   Z-ADD     THAIC3        TIAIC3                         Company Number
     C                   Z-ADD     THC4NB        TIC4NB                         Order Number
     C                   MOVEL     THDGSX        TIDGSX                         ED Export Docum
     C                   MOVEL     THKXCD        TIKXCD                         Country Code
     C                   Z-ADD     THDPNB        TIDPNB                         Order Sequence
     C                   Z-ADD     THUENB        TIUENB                         Order Secondary
      *
     C     KLDLTM        KLIST
     C                   KFLD                    TIAIC3                         Company Number
     C                   KFLD                    TIC4NB                         Order Number
     C                   KFLD                    TIDGSX                         ED Export Docum
     C                   KFLD                    TIKXCD                         Country Code
     C                   KFLD                    TIDPNB                         Order Sequence
     C                   KFLD                    TIUENB                         Order Secondary
     C     KLDLTM        CHAIN     @MSREW4                            9091      *
      * Record already deleted
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PDMSREL0'    MDACP
     C                   MOVEL     '@MSREW4'     MDFMT
     C                   MOVEL     '*DLT'        MDACT
      * Record not found label: LBL006.
     C                   MOVEL     'LBL006'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TMEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TMEXIT
     C                   ENDIF
      *
      *................................................................
     C                   DELETE    @MSREW4                              91      *
      * Delete error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   TMEXIT        ENDSR
      /EJECT
     CSR   TNRVGN        BEGSR
      *================================================================
      * RTV If Item Not Cancelled - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           WL0447                         USR Return Code
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTN         KLIST
     C                   KFLD                    WQTN01                         Company Number
     C                   KFLD                    WQTN02                         Order Number
      * Setup key
     C                   Z-ADD     WL0445        WQTN01                         Company Number
     C                   Z-ADD     WL0446        WQTN02                         Order Number
      * Establish starting position
     C     KRSTN         SETLL     @BGWKIG                                      *
     C     KRSTN         READE     @BGWKIG                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancel Status Types
     C                   DOW       NOT *IN90
     C                   IF        TJGMST = 'L' OR
     C                             TJGMST = 'A' OR
     C                             TJGMST = 'E' OR
     C                             TJGMST = 'H'
     C                   MOVEL     'E'           WL0447                         USR Return Code
     C                   GOTO      TNEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSTN         READE     @BGWKIG                                90    *
     C                   ENDDO
      *================================================================
     CSR   TNEXIT        ENDSR
      /EJECT
     CSR   TOCHRC        BEGSR
      *================================================================
      * Chg Order Status BlockOrd - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   EVAL      WN0277 = ' '                                 Order Type_Sale
     C                   Z-ADD     *ZERO         WN0278                         AR Customer Num
     C                   Z-ADD     *ZERO         WN0279                         Ship To Custome
     C                   EVAL      WN0280 = ' '                                 Ship To Name
     C                   EVAL      WN0281 = ' '                                 Ship To Address
     C                   EVAL      WN0282 = ' '                                 Ship To Address
     C                   EVAL      WN0283 = ' '                                 Ship To Address
     C                   EVAL      WN0284 = ' '                                 Ship To City
     C                   EVAL      WN0285 = ' '                                 Ship To State C
     C                   EVAL      WN0286 = ' '                                 Ship To Zip_Pos
     C                   Z-ADD     *ZERO         WN0287                         Bill to Custome
     C                   EVAL      WN0288 = ' '                                 Bill to Name
     C                   EVAL      WN0289 = ' '                                 Bill to Address
     C                   EVAL      WN0290 = ' '                                 Bill to Address
     C                   EVAL      WN0291 = ' '                                 Bill to Address
     C                   EVAL      WN0292 = ' '                                 Bill to City
     C                   EVAL      WN0293 = ' '                                 Bill to State C
     C                   EVAL      WN0294 = ' '                                 Bill to Zip_Pos
     C                   EVAL      WN0295 = ' '                                 Customer Purcha
     C                   Z-ADD     *ZERO         WN0296                         Order Date
     C                   Z-ADD     *ZERO         WN0297                         Requested Ship
     C                   Z-ADD     *ZERO         WN0298                         Actual Shipped
     C                   EVAL      WN0299 = ' '                                 Terms Code
     C                   EVAL      WN0300 = ' '                                 Special Instruc
     C                   EVAL      WN0301 = ' '                                 Special Instruc
     C                   EVAL      WN0302 = ' '                                 Carrier Code
     C                   EVAL      WN0303 = ' '                                 Comment Print A
     C                   EVAL      WN0304 = ' '                                 Comment Print I
     C                   EVAL      WN0305 = ' '                                 Comment Print P
     C                   EVAL      WN0306 = ' '                                 Comment Print S
     C                   EVAL      WN0307 = ' '                                 Reason Code
     C                   EVAL      WN0308 = ' '                                 Order in Use
     C                   EVAL      WN0309 = ' '                                 Order Type Prin
     C                   Z-ADD     *ZERO         WN0310                         Scheduled Ship
     C                   EVAL      WN0311 = ' '                                 User Original E
     C                   Z-ADD     *ZERO         WN0312                         Date of Origina
     C                   EVAL      WN0313 = ' '                                 New Customer Ho
     C                   Z-ADD     *ZERO         WN0314                         Requested Deliv
     C                   Z-ADD     *ZERO         WN0315                         Requested Deliv
     C                   EVAL      WN0316 = ' '                                 Accounts Receiv
     C                   EVAL      WN0317 = ' '                                 Accounts Receiv
     C                   Z-ADD     *ZERO         WN0318                         Load ID
     C                   EVAL      WN0319 = ' '                                 LTL Flag
     C                   EVAL      WN0320 = ' '                                 Price Audit
     C                   EVAL      WN0321 = ' '                                 Price Status
     C                   EVAL      WN0322 = ' '                                 Shipping Method
     C                   EVAL      WN0323 = ' '                                 Export Status
     C                   EVAL      WN0324 = ' '                                 Palletize
     C                   EVAL      WN0325 = ' '                                 Shrink Wrap
     C                   EVAL      WN0326 = ' '                                 Slip Sheet
     C                   EVAL      WN0327 = ' '                                 Age Code
     C                   Z-ADD     *ZERO         WN0328                         Reefer Temperat
     C                   EVAL      WN0329 = ' '                                 Load Type
     C                   EVAL      WN0330 = ' '                                 Load Plan Order
     C                   EVAL      WN0331 = ' '                                 Print Pick Slip
     C                   Z-ADD     *ZERO         WN0332                         Resell Referenc
     C                   EVAL      WN0333 = ' '                                 Special Comment
     C                   EVAL      WN0334 = ' '                                 Special Comment
     C                   EVAL      WN0335 = ' '                                 Manager Level C
     C                   EVAL      WN0336 = ' '                                 VP Level Code
     C                   Z-ADD     *ZERO         WN0337                         Invoice Number
     C                   EVAL      WN0338 = ' '                                 Invoice Suffix
     C                   Z-ADD     *ZERO         WN0339                         Invoice Date
     C                   EVAL      WN0340 = ' '                                 Event Code
     C                   EVAL      WN0341 = ' '                                 Trans Contol AS
     C                   EVAL      WN0342 = ' '                                 Modified Flag
     C                   EVAL      WN0343 = ' '                                 Billing Activit
     C                   EVAL      WN0344 = ' '                                 Block Order Fla
     C                   EVAL      WN0345 = ' '                                 Order Certifica
     C                   Z-ADD     *ZERO         WN0346                         Invoice Order V
     C                   EVAL      WN0347 = ' '                                 Process Sts for
     C                   EVAL      WN0348 = ' '                                 Order Conf Fax
     C                   EVAL      WN0349 = ' '                                 Manifest Fax St
     C                   EVAL      WN0350 = ' '                                 Invoice Fax Sts
     C                   EVAL      WN0351 = ' '                                 Transfer in Sto
     C                   EVAL      WN0352 = ' '                                 Email Cust On O
     C                   EVAL      WN0353 = ' '                                 Order Emailed
     C                   EVAL      WN0354 = ' '                                 Export Docs Go
     C                   EVAL      WN0355 = ' '                                 Shipping Temp C
     C                   EVAL      WN0356 = ' '                                 Broker Order St
     C                   EVAL      WN0357 = ' '                                 Air Freight Ord
     C                   EVAL      WN0358 = ' '                                 Order Requires
     C                   EVAL      WN0359 = ' '                                 OH Load Plan Re
     C                   EVAL      WN0360 = ' '                                 Export USDA App
     C                   EVAL      WN0361 = ' '                                 HPB Ship to War
     C                   EVAL      WN0362 = ' '                                 OH TF Exempt Co
     C                   Z-ADD     *ZERO         WN0363                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WN0364                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WN0365                         Load Actual Shi
     C                   Z-ADD     *ZERO         WN0366                         Load BOL Comple
     C                   Z-ADD     *ZERO         WN0367                         Load Truck Depa
     C                   Z-ADD     *ZERO         WN0368                         Maximum Gross W
     C                   Z-ADD     *ZERO         WN0369                         Time of Origina
     C                   Z-ADD     *ZERO         WN0370                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WN0371                         Load BOL Comple
     C                   Z-ADD     *ZERO         WN0372                         Load Truck Depa
     C                   Z-ADD     *ZERO         WN0373                         Act Frt Referen
     C                   Z-ADD     *ZERO         WN0374                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WN0375                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WN0376                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WN0377                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WN0378                         Claim Number
     C                   EVAL      WN0379 = ' '                                 EDI Status 1
     C                   EVAL      WN0380 = ' '                                 EDI Status 2
     C                   EVAL      WN0381 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0382                         Job Time
     C                   EVAL      WN0383 = ' '                                 User Id
     C                   EVAL      WN0384 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0385                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YERDC = ' '
      *
      * Move key fields to @BECPFJ
     C                   Z-ADD     WL0448        TKAIC3                         Company Number
     C                   Z-ADD     WL0449        TKC4NB                         Order Number
      *
     C     KLCHTO        KLIST
     C                   KFLD                    TKAIC3                         Company Number
     C                   KFLD                    TKC4NB                         Order Number
     C     KLCHTO        CHAIN     @BECPFJ                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBFCPL0'    MDACP
     C                   MOVEL     '@BECPFJ'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL007.
     C                   MOVEL     'LBL007'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TOEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TOEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBF1        YERDCS
      * Move non-key fields to @BECPFJ
     C                   Z-ADD     WL0450        TKACDT                         Cancel Date
     C                   MOVEL(P)  WL0451        TKGWST                         Header Status
     C                   MOVEL(P)  WL0452        TKGXST                         Header Status L
     C                   Z-ADD     WL0453        TKJZVA                         Order Value Tot
     C                   Z-ADD     WL0454        TKA1WG                         Order Weight To
     C                   MOVEL(P)  WL0455        TKXIST                         Credit Hold
     C                   MOVEL(P)  WL0456        TKXJST                         Production Hold
     C                   Z-ADD     WL0457        TKTBNB                         Absorbed Freigh
     C                   Z-ADD     WL0458        TKR1NB                         Rated Freight
     C                   Z-ADD     WL0459        TKATIN                         Attach to Invoi
     C                   MOVEL(P)  WL0460        TKWBST                         Affect Auto Acc
     C                   MOVEL(P)  WL0461        TKR4CD                         Sales Route Cod
     C                   Z-ADD     WL0462        TKT3NB                         Attach to Order
     C                   MOVEL(P)  WL0463        TKSICD                         Reason for Pric
     C                   Z-ADD     WL0464        TKVRVA                         A_R order Value
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF1 <> YERDCS AND
     C                             YERDC <> 'N'
     C                   MOVE      'Y'           YERDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         TKAATM                         Job Time
     C                   MOVEL     ##USR         TKAYNA                         User Id
     C                   MOVEL     ##PGM         TKA0NA                         Job Name
     C                   Z-ADD     ##JDT         TKAXDT                         Job Date
     C                   MOVEL     @CN(225)      TKA0NA                         Job Name
     C                   MOVEL     @CN(069)      TKAYNA                         User Id
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                   CLEAR                   PIRC
     C                   Z-ADD     TKAIC3        PIAIC3                         Company Number
     C                   Z-ADD     TKC4NB        PIC4NB                         Order Number
     C                   MOVEL(P)  TKJNCD        PIJNCD                         Order Type_Sale
     C                   Z-ADD     TKANC7        PIANC7                         AR Customer Num
     C                   Z-ADD     TKBKC7        PIBKC7                         Ship To Custome
     C                   MOVEL(P)  TKBRTX        PIBRTX                         Ship To Name
     C                   MOVEL(P)  TKHMNA        PIHMNA                         Ship To Address
     C                   MOVEL(P)  TKHONA        PIHONA                         Ship To Address
     C                   MOVEL(P)  TKHPNA        PIHPNA                         Ship To Address
     C                   MOVEL(P)  TKHNNA        PIHNNA                         Ship To City
     C                   MOVEL(P)  TKDBCD        PIDBCD                         Ship To State C
     C                   MOVEL(P)  TKCKTX        PICKTX                         Ship To Zip_Pos
     C                   Z-ADD     TKB0C7        PIB0C7                         Bill to Custome
     C                   MOVEL(P)  TKAETX        PIAETX                         Bill to Name
     C                   MOVEL(P)  TKB1NA        PIB1NA                         Bill to Address
     C                   MOVEL(P)  TKB3NA        PIB3NA                         Bill to Address
     C                   MOVEL(P)  TKB4NA        PIB4NA                         Bill to Address
     C                   MOVEL(P)  TKB2NA        PIB2NA                         Bill to City
     C                   MOVEL(P)  TKBHCD        PIBHCD                         Bill to State C
     C                   MOVEL(P)  TKC8TX        PIC8TX                         Bill to Zip_Pos
     C                   MOVEL(P)  TKBCNA        PIBCNA                         Customer Purcha
     C                   Z-ADD     TKA0DT        PIA0DT                         Order Date
     C                   Z-ADD     TKA5DT        PIA5DT                         Requested Ship
     C                   Z-ADD     TKGNDT        PIGNDT                         Actual Shipped
     C                   Z-ADD     TKACDT        PIACDT                         Cancel Date
     C                   MOVEL(P)  TKAQCD        PIAQCD                         Terms Code
     C                   MOVEL(P)  TKB6NA        PIB6NA                         Special Instruc
     C                   MOVEL(P)  TKBYNA        PIBYNA                         Special Instruc
     C                   MOVEL(P)  TKBZNA        PIBZNA                         Carrier Code
     C                   MOVEL(P)  TKGTST        PIGTST                         Comment Print A
     C                   MOVEL(P)  TKGVST        PIGVST                         Comment Print I
     C                   MOVEL(P)  TKGUST        PIGUST                         Comment Print P
     C                   MOVEL(P)  TKQFST        PIQFST                         Comment Print S
     C                   MOVEL(P)  TKCQCD        PICQCD                         Reason Code
     C                   MOVEL(P)  TKGJST        PIGJST                         Order in Use
     C                   MOVEL(P)  TKGWST        PIGWST                         Header Status
     C                   MOVEL(P)  TKGXST        PIGXST                         Header Status L
     C                   MOVEL(P)  TKGYST        PIGYST                         Order Type Prin
     C                   Z-ADD     TKAODT        PIAODT                         Scheduled Ship
     C                   MOVEL(P)  TKAIVN        PIAIVN                         User Original E
     C                   Z-ADD     TKCXDT        PICXDT                         Date of Origina
     C                   Z-ADD     TKJZVA        PIJZVA                         Order Value Tot
     C                   Z-ADD     TKA1WG        PIA1WG                         Order Weight To
     C                   MOVEL(P)  TKXIST        PIXIST                         Credit Hold
     C                   MOVEL(P)  TKXJST        PIXJST                         Production Hold
     C                   MOVEL(P)  TKXKST        PIXKST                         New Customer Ho
     C                   Z-ADD     TKEIDT        PIEIDT                         Requested Deliv
     C                   Z-ADD     TKAFTM        PIAFTM                         Requested Deliv
     C                   MOVEL(P)  TKE8CD        PIE8CD                         Accounts Receiv
     C                   MOVEL(P)  TKE9CD        PIE9CD                         Accounts Receiv
     C                   Z-ADD     TKRMNB        PIRMNB                         Load ID
     C                   Z-ADD     TKTBNB        PITBNB                         Absorbed Freigh
     C                   Z-ADD     TKR1NB        PIR1NB                         Rated Freight
     C                   MOVEL(P)  TKPJST        PIPJST                         LTL Flag
     C                   MOVEL(P)  TKU0ST        PIU0ST                         Price Audit
     C                   MOVEL(P)  TKU1ST        PIU1ST                         Price Status
     C                   MOVEL(P)  TKQ2CD        PIQ2CD                         Shipping Method
     C                   MOVEL(P)  TKU2ST        PIU2ST                         Export Status
     C                   MOVEL(P)  TKVEST        PIVEST                         Palletize
     C                   MOVEL(P)  TKVFST        PIVFST                         Shrink Wrap
     C                   MOVEL(P)  TKVGST        PIVGST                         Slip Sheet
     C                   MOVEL(P)  TKRPCD        PIRPCD                         Age Code
     C                   Z-ADD     TKRNNB        PIRNNB                         Reefer Temperat
     C                   MOVEL(P)  TKVDST        PIVDST                         Load Type
     C                   Z-ADD     TKATIN        PIATIN                         Attach to Invoi
     C                   MOVEL(P)  TKU4ST        PIU4ST                         Load Plan Order
     C                   MOVEL(P)  TKU5ST        PIU5ST                         Print Pick Slip
     C                   Z-ADD     TKRSRN        PIRSRN                         Resell Referenc
     C                   MOVEL(P)  TKMHNA        PIMHNA                         Special Comment
     C                   MOVEL(P)  TKMINA        PIMINA                         Special Comment
     C                   MOVEL(P)  TKWBST        PIWBST                         Affect Auto Acc
     C                   MOVEL(P)  TKR4CD        PIR4CD                         Sales Route Cod
     C                   MOVEL(P)  TKBFCD        PIBFCD                         Manager Level C
     C                   MOVEL(P)  TKQ4CD        PIQ4CD                         VP Level Code
     C                   Z-ADD     TKT3NB        PIT3NB                         Attach to Order
     C                   MOVEL(P)  TKSICD        PISICD                         Reason for Pric
     C                   Z-ADD     TKCONB        PICONB                         Invoice Number
     C                   MOVEL(P)  TKCEST        PICEST                         Invoice Suffix
     C                   Z-ADD     TKAWDT        PIAWDT                         Invoice Date
     C                   MOVEL(P)  TKJPCD        PIJPCD                         Event Code
     C                   MOVEL(P)  TKXUST        PIXUST                         Trans Contol AS
     C                   MOVEL(P)  TKZ1ST        PIZ1ST                         Modified Flag
     C                   Z-ADD     TKVRVA        PIVRVA                         A_R order Value
     C                   MOVEL(P)  TKOBST        PIOBST                         Billing Activit
     C                   MOVEL(P)  TKBCST        PIBCST                         Block Order Fla
     C                   MOVEL(P)  TKBDST        PIBDST                         Order Certifica
     C                   Z-ADD     TKB7VL        PIB7VL                         Invoice Order V
     C                   MOVEL(P)  TKGASX        PIGASX                         Process Sts for
     C                   MOVEL(P)  TKGBSX        PIGBSX                         Order Conf Fax
     C                   MOVEL(P)  TKGCSX        PIGCSX                         Manifest Fax St
     C                   MOVEL(P)  TKGDSX        PIGDSX                         Invoice Fax Sts
     C                   MOVEL(P)  TKFNSX        PIFNSX                         Transfer in Sto
     C                   MOVEL(P)  TKFOSX        PIFOSX                         Email Cust On O
     C                   MOVEL(P)  TKFPSX        PIFPSX                         Order Emailed
     C                   MOVEL(P)  TKFQSX        PIFQSX                         Export Docs Go
     C                   MOVEL(P)  TKFRSX        PIFRSX                         Shipping Temp C
     C                   MOVEL(P)  TKFSSX        PIFSSX                         Broker Order St
     C                   MOVEL(P)  TKFTSX        PIFTSX                         Air Freight Ord
     C                   MOVEL(P)  TKFUSX        PIFUSX                         Order Requires
     C                   MOVEL(P)  TKFVSX        PIFVSX                         OH Load Plan Re
     C                   MOVEL(P)  TKFWSX        PIFWSX                         Export USDA App
     C                   MOVEL(P)  TKFXSX        PIFXSX                         HPB Ship to War
     C                   MOVEL(P)  TKFYSX        PIFYSX                         OH TF Exempt Co
     C                   Z-ADD     TKNODT        PINODT                         OH Appt Confirm
     C                   Z-ADD     TKNPDT        PINPDT                         JPN Invoice Iss
     C                   Z-ADD     TKNQDT        PINQDT                         Load Actual Shi
     C                   Z-ADD     TKNRDT        PINRDT                         Load BOL Comple
     C                   Z-ADD     TKNSDT        PINSDT                         Load Truck Depa
     C                   Z-ADD     TKBPTM        PIBPTM                         Maximum Gross W
     C                   Z-ADD     TKBQTM        PIBQTM                         Time of Origina
     C                   Z-ADD     TKBRTM        PIBRTM                         OH Appt Confirm
     C                   Z-ADD     TKBSTM        PIBSTM                         Load BOL Comple
     C                   Z-ADD     TKBTTM        PIBTTM                         Load Truck Depa
     C                   Z-ADD     TKH0NX        PIH0NX                         Act Frt Referen
     C                   Z-ADD     TKH1NX        PIH1NX                         Act Non_Ref Frt
     C                   Z-ADD     TKH2NX        PIH2NX                         OH Fuel Surchar
     C                   Z-ADD     TKH3NX        PIH3NX                         OH Total Non_Re
     C                   Z-ADD     TKH4NX        PIH4NX                         OH Total Ref Fr
     C                   Z-ADD     TKC0C7        PIC0C7                         Claim Number
     C                   MOVEL(P)  TKUVST        PIUVST                         EDI Status 1
     C                   MOVEL(P)  TKUWST        PIUWST                         EDI Status 2
     C                   MOVEL(P)  TKUXST        PIUXST                         EDI Status 3
     C                   Z-ADD     TKAATM        PIAATM                         Job Time
     C                   MOVEL(P)  TKAYNA        PIAYNA                         User Id
     C                   MOVEL(P)  TKA0NA        PIA0NA                         Job Name
     C                   Z-ADD     TKAXDT        PIAXDT                         Job Date
      *
     C                   CALL      'PDW9XFR'                            90      TRG Order Hdr C
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PIRC                           RCD: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDW9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF1 <> YERDCS AND
     C                             YERDC <> 'N'
     C                   MOVE      'Y'           YERDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YERDC = 'Y'
     C                   UPDATE    @BECPFJ                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBFCPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TOEXIT        ENDSR
      /EJECT
     CSR   TPCHRC        BEGSR
      *================================================================
      * CHG PD Order Detail Block - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0386                         Job Time
     C                   EVAL      WN0387 = ' '                                 User Id
     C                   EVAL      WN0388 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0389                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YFRDC = ' '
      *
      * Move key fields to @BGWKL0
     C                   Z-ADD     WL0465        TGAIC3                         Company Number
     C                   Z-ADD     WL0466        TGC4NB                         Order Number
     C                   Z-ADD     WL0467        TGDPNB                         Order Sequence
     C                   Z-ADD     WL0468        TGUENB                         Order Secondary
      *
     C     KLCHTP        KLIST
     C                   KFLD                    TGAIC3                         Company Number
     C                   KFLD                    TGC4NB                         Order Number
     C                   KFLD                    TGDPNB                         Order Sequence
     C                   KFLD                    TGUENB                         Order Secondary
     C     KLCHTP        CHAIN     @BGWKL0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBGWKL0'    MDACP
     C                   MOVEL     '@BGWKL0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL008.
     C                   MOVEL     'LBL008'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TPEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TPEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBG1        YFRDCS
      * USER: Processing after Data read
      * E2247 RMC 10/03/12 Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Sent to USDA Sts is yes
      * If price type changes, then create type: ORDPRT
      * CASE: DB1.OD Price Type NE PAR.OD Price Type
     C                   IF        TGHOST = 'Y'
      * change log prior has seq in pos 1-3, price type 5-7: '001 NEG
     C                   IF        TGF7SX <> WL0553
     C                   MOVEL     TGDPNB        YL0420                         Text 3 Length U
     C                   Z-ADD     1             ZQ
     C     YL0420        CAT(P)    TGF7SX:ZQ     YL0421                         Change Log Prio
     C                   EVAL      YL0422 = ' '                                 Change Log New
     C                   MOVEL     WL0553        YL0422                         Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                   CALL      'PBFLXFR'                            90      CRT Load/OrderC
     C                   PARM      *BLANK        W0RTN
     C                   PARM      *ZERO         WQ0799                         Load ID
     C                   PARM      'ORDPRT'      WQ0800                         Load Change Typ
     C                   PARM      'SLS'         WQ0801                         Department Cont
     C                   PARM      YL0421        WQ0802                         Change Log Prio
     C                   PARM      YL0422        WQ0803                         Change Log New
     C                   PARM      TGAIC3        WQ0804                         Company Number
     C                   PARM      TGC4NB        WQ0805                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBFLXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If not the transfer order nbr 9999999 -> crt chg logs
      * CASE: DB1.Order Number is ne 9999999
      * If qty changes, then create type: ORDWGT & ORDQTY ->ALWAYS 6/14/1
      * CASE: DB1.Quantity Ordered NE PAR.Quantity Ordered
     C                   IF        TGC4NB <> 9999999
      * (do this off of qty, because wgt can change often since unit wgt
      * change log prior has seq in pos 1-3, weight in 5-11: '001 0000nnn
     C                   IF        TGAVQT <> WL0507
     C                   MOVEL     TGDPNB        YL0420                         Text 3 Length U
     C                   Z-ADD     TGD0WG        YL0423                         Weight Beg Inv
     C                   MOVEL     YL0423        YL0424                         Text USR 7
     C                   Z-ADD     1             ZQ
     C     YL0420        CAT(P)    YL0424:ZQ     YL0421                         Change Log Prio
     C                   Z-ADD     WL0508        YL0423                         Weight Beg Inv
     C                   EVAL      YL0422 = ' '                                 Change Log New
     C                   MOVEL     YL0423        YL0422                         Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                   CALL      'PBFLXFR'                            90      CRT Load/OrderC
     C                   PARM      *BLANK        W0RTN
     C                   PARM      *ZERO         WQ0806                         Load ID
     C                   PARM      'ORDWGT'      WQ0807                         Load Change Typ
     C                   PARM      'SLS'         WQ0808                         Department Cont
     C                   PARM      YL0421        WQ0809                         Change Log Prio
     C                   PARM      YL0422        WQ0810                         Change Log New
     C                   PARM      TGAIC3        WQ0811                         Company Number
     C                   PARM      TGC4NB        WQ0812                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBFLXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     TGAVQT        YL0423                         Weight Beg Inv
     C                   MOVEL     YL0423        YL0424                         Text USR 7
     C                   Z-ADD     1             ZQ
     C     YL0420        CAT(P)    YL0424:ZQ     YL0421                         Change Log Prio
     C                   Z-ADD     WL0507        YL0423                         Weight Beg Inv
     C                   EVAL      YL0422 = ' '                                 Change Log New
     C                   MOVEL     YL0423        YL0422                         Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                   CALL      'PBFLXFR'                            90      CRT Load/OrderC
     C                   PARM      *BLANK        W0RTN
     C                   PARM      *ZERO         WQ0813                         Load ID
     C                   PARM      'ORDQTY'      WQ0814                         Load Change Typ
     C                   PARM      'SLS'         WQ0815                         Department Cont
     C                   PARM      YL0421        WQ0816                         Change Log Prio
     C                   PARM      YL0422        WQ0817                         Change Log New
     C                   PARM      TGAIC3        WQ0818                         Company Number
     C                   PARM      TGC4NB        WQ0819                         Order Number
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBFLXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Move non-key fields to @BGWKL0
     C                   Z-ADD     WL0469        TGHGCD                         Item Code
     C                   MOVEL(P)  WL0470        TGAJCD                         Warehouse Code
     C                   Z-ADD     WL0471        TGBKC7                         Ship To Custome
     C                   Z-ADD     WL0472        TGCFC7                         Order Group Cod
     C                   MOVEL(P)  WL0473        TGGMST                         Detail Line Sta
     C                   MOVEL(P)  WL0474        TGGNST                         Detail Line Sta
     C                   Z-ADD     WL0475        TGMAVA                         Billing Detail
     C                   Z-ADD     WL0476        TGKDVA                         Billing Detail
     C                   Z-ADD     WL0477        TGL8VA                         Billing Detail
     C                   Z-ADD     WL0478        TGL9VA                         Quantity to Sub
     C                   MOVEL(P)  WL0479        TGGTST                         Comment Print A
     C                   MOVEL(P)  WL0480        TGGVST                         Comment Print I
     C                   MOVEL(P)  WL0481        TGGUST                         Comment Print P
     C                   MOVEL(P)  WL0482        TGQFST                         Comment Print S
     C                   Z-ADD     WL0483        TGAYVA                         Extended Amount
     C                   Z-ADD     WL0484        TGEXDT                         Market Pricing
     C                   MOVEL(P)  WL0485        TGLQCD                         Commodity Marke
     C                   MOVEL(P)  WL0486        TGRDCD                         Date Method Cod
     C                   MOVEL(P)  WL0487        TGQ7CD                         Price Method Co
     C                   Z-ADD     WL0488        TGBZPR                         Price Overage O
     C                   Z-ADD     WL0489        TGL6NB                         Contract Number
     C                   MOVEL(P)  WL0490        TGU1ST                         Price Status
     C                   Z-ADD     WL0491        TGGIDT                         Pricing Date Us
     C                   MOVEL(P)  WL0492        TGCRCD                         U_M_Base Price
     C                   MOVEL(P)  WL0493        TGAGCD                         U_M_Ordered
     C                   MOVEL(P)  WL0494        TGRZST                         Work Confirm St
     C                   MOVEL(P)  WL0495        TGR0ST                         Work Over_Short
     C                   MOVEL(P)  WL0496        TGR1ST                         OD Production P
     C                   MOVEL(P)  WL0497        TGG7NA                         Order Desc_Line
     C                   MOVEL(P)  WL0498        TGG8NA                         Order Desc_Line
     C                   MOVEL(P)  WL0499        TGRPCD                         Age Code
     C                   MOVEL(P)  WL0500        TGVEST                         Palletize
     C                   MOVEL(P)  WL0501        TGVGST                         Slip Sheet
     C                   MOVEL(P)  WL0502        TGAVST                         Catch Weight St
     C                   MOVEL(P)  WL0503        TGU0ST                         Price Audit
     C                   MOVEL(P)  WL0504        TGRFCD                         Price Audit Rea
     C                   MOVEL(P)  WL0505        TGFZST                         Production Date
     C                   Z-ADD     WL0506        TGR1NB                         Rated Freight
     C                   Z-ADD     WL0507        TGAVQT                         Quantity Ordere
     C                   Z-ADD     WL0508        TGD0WG                         Weight Ordered
     C                   Z-ADD     WL0509        TGCCQT                         Quantity Schedu
     C                   Z-ADD     WL0510        TGAUWG                         Weight Schedule
     C                   Z-ADD     WL0511        TGCBQT                         Quantity Shippe
     C                   Z-ADD     WL0512        TGATWG                         Weight Shipped
     C                   Z-ADD     WL0513        TGAQCS                         Unit Cost Prici
     C                   Z-ADD     WL0514        TGAGCS                         Unit Cost Per P
     C                   Z-ADD     WL0515        TGAKPR                         Unit Price
     C                   Z-ADD     WL0516        TGALPR                         Unit Price_Cred
     C                   Z-ADD     WL0517        TGAUPR                         Unit Price Orde
     C                   Z-ADD     WL0518        TGAVWG                         Unit Weight Ord
     C                   Z-ADD     WL0519        TGA4WG                         Tare Weight Tot
     C                   Z-ADD     WL0520        TGA5DT                         Requested Ship
     C                   Z-ADD     WL0521        TGAODT                         Scheduled Ship
     C                   Z-ADD     WL0522        TGGNDT                         Actual Shipped
     C                   MOVEL(P)  WL0523        TGAMST                         Affect Inventor
     C                   MOVEL(P)  WL0524        TGANST                         Affect Sales Do
     C                   MOVEL(P)  WL0525        TGVAST                         Affect Sales Pn
     C                   Z-ADD     WL0526        TGRGNB                         Item Structure
     C                   Z-ADD     WL0527        TGRHNB                         Item Structure
     C                   Z-ADD     WL0528        TGRINB                         Item Structure
     C                   MOVEL(P)  WL0529        TGRBCD                         Item Level
     C                   MOVEL(P)  WL0530        TGHICD                         Quality Level
     C                   MOVEL(P)  WL0531        TGRNCD                         Pricing Product
     C                   MOVEL(P)  WL0532        TGROCD                         Season Product
     C                   Z-ADD     WL0533        TGCXDT                         Date of Origina
     C                   MOVEL(P)  WL0534        TGAJVN                         User Profile Na
     C                   MOVEL(P)  WL0535        TGKXCD                         Country Code
     C                   MOVEL(P)  WL0536        TGJPCD                         Event Code
     C                   MOVEL(P)  WL0537        TGCQCD                         Reason Code
     C                   MOVEL(P)  WL0538        TGR4CD                         Sales Route Cod
     C                   MOVEL(P)  WL0539        TGZ1ST                         Modified Flag
     C                   MOVEL(P)  WL0540        TGZ3ST                         Substituted Fla
     C                   MOVEL(P)  WL0541        TGZ4ST                         OD Schedule Ove
     C                   Z-ADD     WL0542        TGDUPR                         Invoice Unit Pr
     C                   Z-ADD     WL0543        TGB6VL                         Invoice Extende
     C                   Z-ADD     WL0544        TGA1AA                         Ham Group Numbe
     C                   MOVEL(P)  WL0545        TGFZSX                         OD Adj Type Ove
     C                   MOVEL(P)  WL0546        TGF0SX                         Affect Trade Fu
     C                   MOVEL(P)  WL0547        TGF1SX                         Affect Commissi
     C                   MOVEL(P)  WL0548        TGF2SX                         Affect Pricing
     C                   MOVEL(P)  WL0549        TGF3SX                         Released by Use
     C                   MOVEL(P)  WL0550        TGF4SX                         Ord TF Exempt C
     C                   MOVEL(P)  WL0551        TGF5SX                         OD Pallet Type
     C                   MOVEL(P)  WL0552        TGF6SX                         Production Ware
     C                   MOVEL(P)  WL0553        TGF7SX                         OD Price Type
     C                   Z-ADD     WL0554        TGNTDT                         Warehouse Palle
     C                   Z-ADD     WL0555        TGNUDT                         Consumed Item C
     C                   Z-ADD     WL0556        TGNVDT                         Deadline Depart
     C                   Z-ADD     WL0557        TGNWDT                         OD Price Type R
     C                   Z-ADD     WL0558        TGNXDT                         OD Firm Date
     C                   Z-ADD     WL0559        TGBUTM                         Deadline Depart
     C                   Z-ADD     WL0560        TGBVTM                         Price Code
     C                   Z-ADD     WL0561        TGBWTM                         Maximum Net Wei
     C                   Z-ADD     WL0562        TGBXTM                         Substitution Li
     C                   Z-ADD     WL0563        TGBYTM                         Max Qty to sche
     C                   Z-ADD     WL0564        TGH5NX                         Warehouse Palle
     C                   Z-ADD     WL0565        TGH6NX                         Warehouse Avg P
     C                   Z-ADD     WL0566        TGH7NX                         OD Item Target
     C                   Z-ADD     WL0567        TGH8NX                         OD Estimated Gr
     C                   Z-ADD     WL0568        TGH9NX                         OD Maximum Unit
     C                   Z-ADD     WL0569        TGDVPR                         Order Gate_Fina
     C                   Z-ADD     WL0570        TGDWPR                         OD Ceiling Pric
     C                   Z-ADD     WL0571        TGDXPR                         OD Gate_Final P
     C                   Z-ADD     WL0572        TGDYPR                         OD Weighted Avg
     C                   Z-ADD     WL0573        TGDZPR                         OD Original Ord
     C                   Z-ADD     WL0574        TGGSPR                         OD Cancel Date
     C                   Z-ADD     WL0575        TGGTPR                         OD Unused Prc 7
     C                   Z-ADD     WL0576        TGGUPR                         OD Unused Prc 8
     C                   MOVEL(P)  WL0577        TGHOST                         OD MPR Sent to
     C                   MOVEL(P)  WL0578        TGHPST                         OD MPR Prc Read
     C                   MOVEL(P)  WL0579        TGIOST                         OD UnUsed Price
     C                   Z-ADD     WL0580        TGPEWG                         Weight Amount E
     C                   Z-ADD     WL0581        TGRINY                         Item Age Days
     C                   Z-ADD     WL0582        TGTIDT                         Production Ovr
     C                   Z-ADD     WL0583        TGTJDT                         Production Ovr
     C                   MOVEL(P)  WL0584        TGH2ST                         OD Spot Buy
     C                   MOVEL(P)  WL0585        TGH0ST                         OD Clm Full Ret
     C                   MOVEL(P)  WL0586        TGH1ST                         Order Line Erro
     C                   Z-ADD     WL0587        TGTKDT                         OD Market Begin
     C                   Z-ADD     WL0588        TGTLDT                         OD Market Endin
     C                   Z-ADD     WL0589        TGTMDT                         OD Atch to Ord
     C                   MOVEL(P)  WL0590        TGUVST                         EDI Status 1
     C                   MOVEL(P)  WL0591        TGUWST                         EDI Status 2
     C                   MOVEL(P)  WL0592        TGUXST                         EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YFRDCS AND
     C                             YFRDC <> 'N'
     C                   MOVE      'Y'           YFRDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   EVAL      TGRPCD = ' '                                 Age Code
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         TGAATM                         Job Time
     C                   MOVEL     ##USR         TGAYNA                         User Id
     C                   MOVEL     ##PGM         TGA0NA                         Job Name
     C                   Z-ADD     ##JDT         TGAXDT                         Job Date
     C                   MOVEL     @CN(225)      TGA0NA                         Job Name
     C                   MOVEL     @CN(069)      TGAYNA                         User Id
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TGAIC3        WL0593                         Company Number
     C                   Z-ADD     TGHGCD        WL0594                         Item Code
     C                   EXSR      TQRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0595        TGRINB                         Item Structure
     C                   Z-ADD     WL0596        TGRHNB                         Item Structure
     C                   Z-ADD     WL0597        TGRGNB                         Item Structure
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  TGAJCD        WL0598                         Warehouse Code
     C                   EXSR      TRRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0599        TGF6SX                         Production Ware
     C                   Z-ADD     WL0600        YN0215                         Accounting Comp
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                   EXSR      UFSUBR                                       Calc Gross Weig
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBG1 <> YFRDCS AND
     C                             YFRDC <> 'N'
     C                   MOVE      'Y'           YFRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YFRDC = 'Y'
     C                   UPDATE    @BGWKL0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBGWKL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TPEXIT        ENDSR
      /EJECT
     CSR   TQRVGN        BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTQ         KLIST
     C                   KFLD                    WOAIC3                         Company Number
     C                   KFLD                    WOHGCD                         Item Code
      * Setup key
     C                   Z-ADD     WL0593        WOAIC3                         Company Number
     C                   Z-ADD     WL0594        WOHGCD                         Item Code
      * Establish starting position
     C     KRSTQ         CHAIN     @BZREJU                            90        *
      * Data record not found
     C   90              MOVEL     'USR0326'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WORINB        WL0595                         Item Structure
     C                   Z-ADD     WORHNB        WL0596                         Item Structure
     C                   Z-ADD     WORGNB        WL0597                         Item Structure
     C                   ENDIF
      *================================================================
     CSR   TQEXIT        ENDSR
      /EJECT
     CSR   TRRVGN        BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTR         KLIST
     C                   KFLD                    WIAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WL0598        WIAJCD                         Warehouse Code
      * Establish starting position
     C     KRSTR         CHAIN     @ADRET1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0599 = ' '                                 Production Ware
     C                   Z-ADD     *ZERO         WL0600                         Accounting Comp
     C                   GOTO      TREXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WIAOCD        WL0599                         Production Ware
     C                   Z-ADD     WIBTC3        WL0600                         Accounting Comp
     C                   ENDIF
      *================================================================
     CSR   TREXIT        ENDSR
      /EJECT
     CSR   TSCHRC        BEGSR
      *================================================================
      * Chg Order Header WRK  CH1 - Order Header TRG  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0399                         Cancel Date
     C                   EVAL      WN0400 = ' '                                 Header Status
     C                   EVAL      WN0401 = ' '                                 Header Status L
     C                   Z-ADD     *ZERO         WN0402                         Order Weight To
     C                   Z-ADD     *ZERO         WN0403                         Job Time
     C                   EVAL      WN0404 = ' '                                 User Id
     C                   EVAL      WN0405 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0406                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YGRDC = ' '
      *
      * Move key fields to @BFCPMD
     C                   Z-ADD     WAAIC3        TLAIC3                         Company Number
     C                   Z-ADD     WAC4NB        TLC4NB                         Order Number
      *
     C     KLCHTS        KLIST
     C                   KFLD                    TLAIC3                         Company Number
     C                   KFLD                    TLC4NB                         Order Number
     C     KLCHTS        CHAIN     @BFCPMD                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
      * USER: Processing if Data record not found
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   IF        W0RTN <> ' '
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBFCPW0'    MDACP
     C                   MOVEL     '@BFCPMD'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL009.
     C                   MOVEL     'LBL009'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   ENDIF
     C                   GOTO      TSEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TSEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBF2        YGRDCS
      * USER: Processing after Data read
      * 01/22/09 RMC  move here from "before Data update" spot
      * 06/23/00 PKD Added the update of the Export Status on the Load
      *              if the Export Status on the Order is changed to Y,
      * Change the Export Status.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Export Status NE DB1.Export Status
      *   |- c2    : PAR.Export Status is yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0197 <> TLU2ST
     C                   IF        YL0197 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load ID is NE Blank
      *   |- c2    : DB1.Load Plan Order is yes
      *   '-
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     '0'           Y0CX01
     C                   IF        TLRMNB <> 0
     C                   IF        TLU4ST = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Chg Export Status     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     TLRMNB        WL0601                         Load ID
     C                   MOVEL(P)  YL0197        WL0602                         Export Status
     C                   EXSR      TTCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   MOVEL     'N'           YL0471                         Status Flag 1
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE:
      *  - (c1ORc2) AND c3
      *   |- c1    : PAR.Requested Delivery Date NE DB1.Requested Deliver
      *   |- c2    : PAR.Requested Delivery Time NE DB1.Requested Deliver
      *   |- c3    : DB1.OH Appt Confirmation Dt is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   MOVEL     '0'           Y0CX02
     C                   IF        YL0190 <> TLEIDT OR
     C                             YL0028 <> TLAFTM
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   IF        TLNODT > 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0471                         Status Flag 1
     C                   END                                                    *FI
      * Move non-key fields to @BFCPMD
     C                   MOVEL(P)  YL0165        TLJNCD                         Order Type_Sale
     C                   Z-ADD     YL0012        TLANC7                         AR Customer Num
     C                   Z-ADD     YL0166        TLBKC7                         Ship To Custome
     C                   MOVEL(P)  YL0005        TLBRTX                         Ship To Name
     C                   MOVEL(P)  YL0006        TLHMNA                         Ship To Address
     C                   MOVEL(P)  YL0007        TLHONA                         Ship To Address
     C                   MOVEL(P)  YL0008        TLHPNA                         Ship To Address
     C                   MOVEL(P)  YL0009        TLHNNA                         Ship To City
     C                   MOVEL(P)  YL0010        TLDBCD                         Ship To State C
     C                   MOVEL(P)  YL0011        TLCKTX                         Ship To Zip_Pos
     C                   Z-ADD     YL0167        TLB0C7                         Bill to Custome
     C                   MOVEL(P)  YL0015        TLAETX                         Bill to Name
     C                   MOVEL(P)  YL0016        TLB1NA                         Bill to Address
     C                   MOVEL(P)  YL0017        TLB3NA                         Bill to Address
     C                   MOVEL(P)  YL0018        TLB4NA                         Bill to Address
     C                   MOVEL(P)  YL0019        TLB2NA                         Bill to City
     C                   MOVEL(P)  YL0020        TLBHCD                         Bill to State C
     C                   MOVEL(P)  YL0021        TLC8TX                         Bill to Zip_Pos
     C                   MOVEL(P)  YL0168        TLBCNA                         Customer Purcha
     C                   Z-ADD     YL0169        TLA0DT                         Order Date
     C                   Z-ADD     YL0060        TLA5DT                         Requested Ship
     C                   Z-ADD     YL0170        TLGNDT                         Actual Shipped
     C                   MOVEL(P)  YL0024        TLAQCD                         Terms Code
     C                   MOVEL(P)  YL0027        TLB6NA                         Special Instruc
     C                   MOVEL(P)  YL0026        TLBYNA                         Special Instruc
     C                   MOVEL(P)  YL0172        TLBZNA                         Carrier Code
     C                   MOVEL(P)  YL0173        TLGTST                         Comment Print A
     C                   MOVEL(P)  YL0174        TLGVST                         Comment Print I
     C                   MOVEL(P)  YL0175        TLGUST                         Comment Print P
     C                   MOVEL(P)  YL0176        TLQFST                         Comment Print S
     C                   MOVEL(P)  YL0177        TLCQCD                         Reason Code
     C                   MOVEL(P)  YL0178        TLGJST                         Order in Use
     C                   MOVEL(P)  YL0181        TLGYST                         Order Type Prin
     C                   Z-ADD     YL0182        TLAODT                         Scheduled Ship
     C                   MOVEL(P)  @CN(069)      TLAIVN                         User Original E
     C                   Z-ADD     YL0184        TLCXDT                         Date of Origina
     C                   Z-ADD     YL0185        TLJZVA                         Order Value Tot
     C                   MOVEL(P)  YL0187        TLXIST                         Credit Hold
     C                   MOVEL(P)  YL0188        TLXJST                         Production Hold
     C                   MOVEL(P)  YL0189        TLXKST                         New Customer Ho
     C                   Z-ADD     YL0190        TLEIDT                         Requested Deliv
     C                   Z-ADD     YL0028        TLAFTM                         Requested Deliv
     C                   MOVEL(P)  YL0191        TLE8CD                         Accounts Receiv
     C                   MOVEL(P)  YL0192        TLE9CD                         Accounts Receiv
     C                   Z-ADD     YL0193        TLRMNB                         Load ID
     C                   Z-ADD     YL0030        TLTBNB                         Absorbed Freigh
     C                   Z-ADD     YL0194        TLR1NB                         Rated Freight
     C                   MOVEL(P)  YL0041        TLPJST                         LTL Flag
     C                   MOVEL(P)  YL0195        TLU0ST                         Price Audit
     C                   MOVEL(P)  YL0196        TLU1ST                         Price Status
     C                   MOVEL(P)  YL0047        TLQ2CD                         Shipping Method
     C                   MOVEL(P)  YL0197        TLU2ST                         Export Status
     C                   MOVEL(P)  YL0044        TLVEST                         Palletize
     C                   MOVEL(P)  YL0042        TLVFST                         Shrink Wrap
     C                   MOVEL(P)  YL0046        TLVGST                         Slip Sheet
     C                   MOVEL(P)  YL0198        TLRPCD                         Age Code
     C                   Z-ADD     YL0199        TLRNNB                         Reefer Temperat
     C                   MOVEL(P)  YL0200        TLVDST                         Load Type
     C                   Z-ADD     YL0201        TLATIN                         Attach to Invoi
     C                   MOVEL(P)  YL0202        TLU4ST                         Load Plan Order
     C                   MOVEL(P)  YL0203        TLU5ST                         Print Pick Slip
     C                   Z-ADD     YL0204        TLRSRN                         Resell Referenc
     C                   MOVEL(P)  YL0205        TLMHNA                         Special Comment
     C                   MOVEL(P)  YL0206        TLMINA                         Special Comment
     C                   MOVEL(P)  YL0207        TLWBST                         Affect Auto Acc
     C                   MOVEL(P)  YL0025        TLR4CD                         Sales Route Cod
     C                   MOVEL(P)  YL0034        TLBFCD                         Manager Level C
     C                   MOVEL(P)  YL0035        TLQ4CD                         VP Level Code
     C                   Z-ADD     YL0208        TLT3NB                         Attach to Order
     C                   MOVEL(P)  YL0209        TLSICD                         Reason for Pric
     C                   Z-ADD     YL0210        TLCONB                         Invoice Number
     C                   MOVEL(P)  YL0211        TLCEST                         Invoice Suffix
     C                   Z-ADD     YL0212        TLAWDT                         Invoice Date
     C                   MOVEL(P)  YL0213        TLJPCD                         Event Code
     C                   MOVEL(P)  YL0056        TLXUST                         Trans Contol AS
     C                   MOVEL(P)  YL0214        TLZ1ST                         Modified Flag
     C                   Z-ADD     YL0215        TLVRVA                         A_R order Value
     C                   MOVEL(P)  YL0050        TLOBST                         Billing Activit
     C                   MOVEL(P)  YL0216        TLBCST                         Block Order Fla
     C                   MOVEL(P)  YL0217        TLBDST                         Order Certifica
     C                   Z-ADD     YL0218        TLB7VL                         Invoice Order V
     C                   MOVEL(P)  YL0219        TLGASX                         Process Sts for
     C                   MOVEL(P)  YL0220        TLGBSX                         Order Conf Fax
     C                   MOVEL(P)  YL0221        TLGCSX                         Manifest Fax St
     C                   MOVEL(P)  YL0222        TLGDSX                         Invoice Fax Sts
     C                   MOVEL(P)  YL0223        TLFNSX                         Transfer in Sto
     C                   MOVEL(P)  YL0013        TLFOSX                         Email Cust On O
     C                   MOVEL(P)  YL0224        TLFPSX                         Order Emailed
     C                   MOVEL(P)  YL0225        TLFQSX                         Export Docs Go
     C                   MOVEL(P)  YL0226        TLFRSX                         Shipping Temp C
     C                   MOVEL(P)  YL0227        TLFSSX                         Broker Order St
     C                   MOVEL(P)  YL0014        TLFTSX                         Air Freight Ord
     C                   MOVEL(P)  YL0228        TLFUSX                         Order Requires
     C                   MOVEL(P)  YL0229        TLFVSX                         OH Load Plan Re
     C                   MOVEL(P)  YL0230        TLFWSX                         Export USDA App
     C                   MOVEL(P)  YL0059        TLFXSX                         HPB Ship to War
     C                   MOVEL(P)  YL0231        TLFYSX                         OH TF Exempt Co
     C                   Z-ADD     YL0232        TLNODT                         OH Appt Confirm
     C                   Z-ADD     YL0233        TLNPDT                         JPN Invoice Iss
     C                   Z-ADD     YL0234        TLNQDT                         Load Actual Shi
     C                   Z-ADD     YL0235        TLNRDT                         Load BOL Comple
     C                   Z-ADD     YL0236        TLNSDT                         Load Truck Depa
     C                   Z-ADD     YL0237        TLBPTM                         Maximum Gross W
     C                   Z-ADD     YL0238        TLBQTM                         Time of Origina
     C                   Z-ADD     YL0239        TLBRTM                         OH Appt Confirm
     C                   Z-ADD     YL0240        TLBSTM                         Load BOL Comple
     C                   Z-ADD     YL0241        TLBTTM                         Load Truck Depa
     C                   Z-ADD     YL0242        TLH0NX                         Act Frt Referen
     C                   Z-ADD     YL0243        TLH1NX                         Act Non_Ref Frt
     C                   Z-ADD     YL0244        TLH2NX                         OH Fuel Surchar
     C                   Z-ADD     YL0245        TLH3NX                         OH Total Non_Re
     C                   Z-ADD     YL0246        TLH4NX                         OH Total Ref Fr
     C                   Z-ADD     YL0247        TLC0C7                         Claim Number
     C                   MOVEL(P)  YL0248        TLUVST                         EDI Status 1
     C                   MOVEL(P)  YL0249        TLUWST                         EDI Status 2
     C                   MOVEL(P)  YL0250        TLUXST                         EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF2 <> YGRDCS AND
     C                             YGRDC <> 'N'
     C                   MOVE      'Y'           YGRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         TLAATM                         Job Time
     C                   MOVEL     ##USR         TLAYNA                         User Id
     C                   MOVEL     ##PGM         TLA0NA                         Job Name
     C                   Z-ADD     ##JDT         TLAXDT                         Job Date
     C                   MOVEL     @CN(069)      TLAYNA                         User Id
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                   CLEAR                   PIRC
     C                   Z-ADD     TLAIC3        PIAIC3                         Company Number
     C                   Z-ADD     TLC4NB        PIC4NB                         Order Number
     C                   MOVEL(P)  TLJNCD        PIJNCD                         Order Type_Sale
     C                   Z-ADD     TLANC7        PIANC7                         AR Customer Num
     C                   Z-ADD     TLBKC7        PIBKC7                         Ship To Custome
     C                   MOVEL(P)  TLBRTX        PIBRTX                         Ship To Name
     C                   MOVEL(P)  TLHMNA        PIHMNA                         Ship To Address
     C                   MOVEL(P)  TLHONA        PIHONA                         Ship To Address
     C                   MOVEL(P)  TLHPNA        PIHPNA                         Ship To Address
     C                   MOVEL(P)  TLHNNA        PIHNNA                         Ship To City
     C                   MOVEL(P)  TLDBCD        PIDBCD                         Ship To State C
     C                   MOVEL(P)  TLCKTX        PICKTX                         Ship To Zip_Pos
     C                   Z-ADD     TLB0C7        PIB0C7                         Bill to Custome
     C                   MOVEL(P)  TLAETX        PIAETX                         Bill to Name
     C                   MOVEL(P)  TLB1NA        PIB1NA                         Bill to Address
     C                   MOVEL(P)  TLB3NA        PIB3NA                         Bill to Address
     C                   MOVEL(P)  TLB4NA        PIB4NA                         Bill to Address
     C                   MOVEL(P)  TLB2NA        PIB2NA                         Bill to City
     C                   MOVEL(P)  TLBHCD        PIBHCD                         Bill to State C
     C                   MOVEL(P)  TLC8TX        PIC8TX                         Bill to Zip_Pos
     C                   MOVEL(P)  TLBCNA        PIBCNA                         Customer Purcha
     C                   Z-ADD     TLA0DT        PIA0DT                         Order Date
     C                   Z-ADD     TLA5DT        PIA5DT                         Requested Ship
     C                   Z-ADD     TLGNDT        PIGNDT                         Actual Shipped
     C                   Z-ADD     TLACDT        PIACDT                         Cancel Date
     C                   MOVEL(P)  TLAQCD        PIAQCD                         Terms Code
     C                   MOVEL(P)  TLB6NA        PIB6NA                         Special Instruc
     C                   MOVEL(P)  TLBYNA        PIBYNA                         Special Instruc
     C                   MOVEL(P)  TLBZNA        PIBZNA                         Carrier Code
     C                   MOVEL(P)  TLGTST        PIGTST                         Comment Print A
     C                   MOVEL(P)  TLGVST        PIGVST                         Comment Print I
     C                   MOVEL(P)  TLGUST        PIGUST                         Comment Print P
     C                   MOVEL(P)  TLQFST        PIQFST                         Comment Print S
     C                   MOVEL(P)  TLCQCD        PICQCD                         Reason Code
     C                   MOVEL(P)  TLGJST        PIGJST                         Order in Use
     C                   MOVEL(P)  TLGWST        PIGWST                         Header Status
     C                   MOVEL(P)  TLGXST        PIGXST                         Header Status L
     C                   MOVEL(P)  TLGYST        PIGYST                         Order Type Prin
     C                   Z-ADD     TLAODT        PIAODT                         Scheduled Ship
     C                   MOVEL(P)  TLAIVN        PIAIVN                         User Original E
     C                   Z-ADD     TLCXDT        PICXDT                         Date of Origina
     C                   Z-ADD     TLJZVA        PIJZVA                         Order Value Tot
     C                   Z-ADD     TLA1WG        PIA1WG                         Order Weight To
     C                   MOVEL(P)  TLXIST        PIXIST                         Credit Hold
     C                   MOVEL(P)  TLXJST        PIXJST                         Production Hold
     C                   MOVEL(P)  TLXKST        PIXKST                         New Customer Ho
     C                   Z-ADD     TLEIDT        PIEIDT                         Requested Deliv
     C                   Z-ADD     TLAFTM        PIAFTM                         Requested Deliv
     C                   MOVEL(P)  TLE8CD        PIE8CD                         Accounts Receiv
     C                   MOVEL(P)  TLE9CD        PIE9CD                         Accounts Receiv
     C                   Z-ADD     TLRMNB        PIRMNB                         Load ID
     C                   Z-ADD     TLTBNB        PITBNB                         Absorbed Freigh
     C                   Z-ADD     TLR1NB        PIR1NB                         Rated Freight
     C                   MOVEL(P)  TLPJST        PIPJST                         LTL Flag
     C                   MOVEL(P)  TLU0ST        PIU0ST                         Price Audit
     C                   MOVEL(P)  TLU1ST        PIU1ST                         Price Status
     C                   MOVEL(P)  TLQ2CD        PIQ2CD                         Shipping Method
     C                   MOVEL(P)  TLU2ST        PIU2ST                         Export Status
     C                   MOVEL(P)  TLVEST        PIVEST                         Palletize
     C                   MOVEL(P)  TLVFST        PIVFST                         Shrink Wrap
     C                   MOVEL(P)  TLVGST        PIVGST                         Slip Sheet
     C                   MOVEL(P)  TLRPCD        PIRPCD                         Age Code
     C                   Z-ADD     TLRNNB        PIRNNB                         Reefer Temperat
     C                   MOVEL(P)  TLVDST        PIVDST                         Load Type
     C                   Z-ADD     TLATIN        PIATIN                         Attach to Invoi
     C                   MOVEL(P)  TLU4ST        PIU4ST                         Load Plan Order
     C                   MOVEL(P)  TLU5ST        PIU5ST                         Print Pick Slip
     C                   Z-ADD     TLRSRN        PIRSRN                         Resell Referenc
     C                   MOVEL(P)  TLMHNA        PIMHNA                         Special Comment
     C                   MOVEL(P)  TLMINA        PIMINA                         Special Comment
     C                   MOVEL(P)  TLWBST        PIWBST                         Affect Auto Acc
     C                   MOVEL(P)  TLR4CD        PIR4CD                         Sales Route Cod
     C                   MOVEL(P)  TLBFCD        PIBFCD                         Manager Level C
     C                   MOVEL(P)  TLQ4CD        PIQ4CD                         VP Level Code
     C                   Z-ADD     TLT3NB        PIT3NB                         Attach to Order
     C                   MOVEL(P)  TLSICD        PISICD                         Reason for Pric
     C                   Z-ADD     TLCONB        PICONB                         Invoice Number
     C                   MOVEL(P)  TLCEST        PICEST                         Invoice Suffix
     C                   Z-ADD     TLAWDT        PIAWDT                         Invoice Date
     C                   MOVEL(P)  TLJPCD        PIJPCD                         Event Code
     C                   MOVEL(P)  TLXUST        PIXUST                         Trans Contol AS
     C                   MOVEL(P)  TLZ1ST        PIZ1ST                         Modified Flag
     C                   Z-ADD     TLVRVA        PIVRVA                         A_R order Value
     C                   MOVEL(P)  TLOBST        PIOBST                         Billing Activit
     C                   MOVEL(P)  TLBCST        PIBCST                         Block Order Fla
     C                   MOVEL(P)  TLBDST        PIBDST                         Order Certifica
     C                   Z-ADD     TLB7VL        PIB7VL                         Invoice Order V
     C                   MOVEL(P)  TLGASX        PIGASX                         Process Sts for
     C                   MOVEL(P)  TLGBSX        PIGBSX                         Order Conf Fax
     C                   MOVEL(P)  TLGCSX        PIGCSX                         Manifest Fax St
     C                   MOVEL(P)  TLGDSX        PIGDSX                         Invoice Fax Sts
     C                   MOVEL(P)  TLFNSX        PIFNSX                         Transfer in Sto
     C                   MOVEL(P)  TLFOSX        PIFOSX                         Email Cust On O
     C                   MOVEL(P)  TLFPSX        PIFPSX                         Order Emailed
     C                   MOVEL(P)  TLFQSX        PIFQSX                         Export Docs Go
     C                   MOVEL(P)  TLFRSX        PIFRSX                         Shipping Temp C
     C                   MOVEL(P)  TLFSSX        PIFSSX                         Broker Order St
     C                   MOVEL(P)  TLFTSX        PIFTSX                         Air Freight Ord
     C                   MOVEL(P)  TLFUSX        PIFUSX                         Order Requires
     C                   MOVEL(P)  TLFVSX        PIFVSX                         OH Load Plan Re
     C                   MOVEL(P)  TLFWSX        PIFWSX                         Export USDA App
     C                   MOVEL(P)  TLFXSX        PIFXSX                         HPB Ship to War
     C                   MOVEL(P)  TLFYSX        PIFYSX                         OH TF Exempt Co
     C                   Z-ADD     TLNODT        PINODT                         OH Appt Confirm
     C                   Z-ADD     TLNPDT        PINPDT                         JPN Invoice Iss
     C                   Z-ADD     TLNQDT        PINQDT                         Load Actual Shi
     C                   Z-ADD     TLNRDT        PINRDT                         Load BOL Comple
     C                   Z-ADD     TLNSDT        PINSDT                         Load Truck Depa
     C                   Z-ADD     TLBPTM        PIBPTM                         Maximum Gross W
     C                   Z-ADD     TLBQTM        PIBQTM                         Time of Origina
     C                   Z-ADD     TLBRTM        PIBRTM                         OH Appt Confirm
     C                   Z-ADD     TLBSTM        PIBSTM                         Load BOL Comple
     C                   Z-ADD     TLBTTM        PIBTTM                         Load Truck Depa
     C                   Z-ADD     TLH0NX        PIH0NX                         Act Frt Referen
     C                   Z-ADD     TLH1NX        PIH1NX                         Act Non_Ref Frt
     C                   Z-ADD     TLH2NX        PIH2NX                         OH Fuel Surchar
     C                   Z-ADD     TLH3NX        PIH3NX                         OH Total Non_Re
     C                   Z-ADD     TLH4NX        PIH4NX                         OH Total Ref Fr
     C                   Z-ADD     TLC0C7        PIC0C7                         Claim Number
     C                   MOVEL(P)  TLUVST        PIUVST                         EDI Status 1
     C                   MOVEL(P)  TLUWST        PIUWST                         EDI Status 2
     C                   MOVEL(P)  TLUXST        PIUXST                         EDI Status 3
     C                   Z-ADD     TLAATM        PIAATM                         Job Time
     C                   MOVEL(P)  TLAYNA        PIAYNA                         User Id
     C                   MOVEL(P)  TLA0NA        PIA0NA                         Job Name
     C                   Z-ADD     TLAXDT        PIAXDT                         Job Date
      *
     C                   CALL      'PDW9XFR'                            90      TRG Order Hdr C
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PIRC                           RCD: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDW9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * -----------------------------------------------------------------
      * -----------------------------------------------------------------
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF2 <> YGRDCS AND
     C                             YGRDC <> 'N'
     C                   MOVE      'Y'           YGRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YGRDC = 'Y'
     C                   UPDATE    @BFCPMD                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBFCPW0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE: LCL.Status Flag 1  Y/N is Yes
      * Exc Email Ord RqDtChg XF - Order Header TRG  * 
     C                   IF        YL0471 = 'Y'
     C                   CALL      'PBEPXFR'                            90      Exc Email Ord R
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TLAIC3        WQ1184                         Company Number
     C                   PARM      TLC4NB        WQ1185                         Order Number
     C                   PARM      TLR4CD        WQ1186                         Sales Route Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBEPXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   TSEXIT        ENDSR
      /EJECT
     CSR   TTCHRC        BEGSR
      *================================================================
      * Chg Export Status     CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0407                         Company Number
     C                   Z-ADD     *ZERO         WN0408                         Scheduled Ship
     C                   EVAL      WN0409 = ' '                                 LTL Flag
     C                   EVAL      WN0410 = ' '                                 Load Status
     C                   Z-ADD     *ZERO         WN0411                         Reefer Temperat
     C                   EVAL      WN0412 = ' '                                 Seal 1
     C                   EVAL      WN0413 = ' '                                 Seal 2
     C                   EVAL      WN0414 = ' '                                 Seal 3
     C                   EVAL      WN0415 = ' '                                 Seal 4
     C                   EVAL      WN0416 = ' '                                 Seal 2 Unused
     C                   Z-ADD     *ZERO         WN0417                         Total Load Orde
     C                   Z-ADD     *ZERO         WN0418                         Flat Amount
     C                   EVAL      WN0419 = ' '                                 Allocate Pounds
     C                   Z-ADD     *ZERO         WN0420                         Total Stops
     C                   EVAL      WN0421 = ' '                                 Trailer Id
     C                   EVAL      WN0422 = ' '                                 Transloader Car
     C                   Z-ADD     *ZERO         WN0423                         BOL Time
     C                   EVAL      WN0424 = ' '                                 Carrier Code
     C                   EVAL      WN0425 = ' '                                 Truck Size
     C                   Z-ADD     *ZERO         WN0426                         Ld Hdr_Ld Dtl U
     C                   Z-ADD     *ZERO         WN0427                         Rated Freight
     C                   EVAL      WN0428 = ' '                                 Ship Status
     C                   EVAL      WN0429 = ' '                                 Load Type
     C                   Z-ADD     *ZERO         WN0430                         Number Pallets
     C                   Z-ADD     *ZERO         WN0431                         Number Pallets
     C                   Z-ADD     *ZERO         WN0432                         Load Carrier Pa
     C                   Z-ADD     *ZERO         WN0433                         Estimated Arriv
     C                   Z-ADD     *ZERO         WN0434                         Actual Arrival
     C                   Z-ADD     *ZERO         WN0435                         Actual Arrival
     C                   Z-ADD     *ZERO         WN0436                         Trailer IN Weig
     C                   Z-ADD     *ZERO         WN0437                         Trailer OUT Wei
     C                   Z-ADD     *ZERO         WN0438                         Actual Departur
     C                   Z-ADD     *ZERO         WN0439                         Departure Time
     C                   Z-ADD     *ZERO         WN0440                         Schedule Sequen
     C                   Z-ADD     *ZERO         WN0441                         Product Tempera
     C                   Z-ADD     *ZERO         WN0442                         Number Spacers
     C                   EVAL      WN0443 = ' '                                 Car_Veh_Initial
     C                   Z-ADD     *ZERO         WN0444                         Total Load Mile
     C                   EVAL      WN0445 = ' '                                 Recorder ID
     C                   EVAL      WN0446 = ' '                                 Shipping Method
     C                   EVAL      WN0447 = ' '                                 Ship From Wareh
     C                   EVAL      WN0448 = ' '                                 Ship To State C
     C                   Z-ADD     *ZERO         WN0449                         Gross Weight
     C                   EVAL      WN0450 = ' '                                 Carrier Broker
     C                   Z-ADD     *ZERO         WN0451                         Actual Ship Dat
     C                   EVAL      WN0452 = ' '                                 On Time_Y_N
     C                   Z-ADD     *ZERO         WN0453                         Truck Ready Dat
     C                   Z-ADD     *ZERO         WN0454                         Truck Ready Tim
     C                   Z-ADD     *ZERO         WN0455                         Spotted Date
     C                   Z-ADD     *ZERO         WN0456                         Spotted Time
     C                   Z-ADD     *ZERO         WN0457                         Load Finished D
     C                   Z-ADD     *ZERO         WN0458                         Load Finished T
     C                   Z-ADD     *ZERO         WN0459                         BOL Complete Da
     C                   Z-ADD     *ZERO         WN0460                         BOL Complete Ti
     C                   Z-ADD     *ZERO         WN0461                         BOL Received Da
     C                   Z-ADD     *ZERO         WN0462                         BOL Received Ti
     C                   Z-ADD     *ZERO         WN0463                         Truck Departure
     C                   Z-ADD     *ZERO         WN0464                         Truck Departure
     C                   Z-ADD     *ZERO         WN0465                         Adjusted Depart
     C                   Z-ADD     *ZERO         WN0466                         Adjusted Depart
     C                   EVAL      WN0467 = ' '                                 Shipping Line
     C                   EVAL      WN0468 = ' '                                 Port Delv Termi
     C                   EVAL      WN0469 = ' '                                 Vessel Name
     C                   Z-ADD     *ZERO         WN0470                         Voyage
     C                   Z-ADD     *ZERO         WN0471                         Sail Date
     C                   EVAL      WN0472 = ' '                                 Booking Number
     C                   EVAL      WN0473 = ' '                                 Discharge Port
     C                   Z-ADD     *ZERO         WN0474                         Arrival Date
     C                   EVAL      WN0475 = ' '                                 Container Numbe
     C                   Z-ADD     *ZERO         WN0476                         Date In
     C                   Z-ADD     *ZERO         WN0477                         Time In
     C                   Z-ADD     *ZERO         WN0478                         Date Out
     C                   Z-ADD     *ZERO         WN0479                         Time Out
     C                   Z-ADD     *ZERO         WN0480                         Load Total Frei
     C                   Z-ADD     *ZERO         WN0481                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WN0482                         Scheduled Deliv
     C                   EVAL      WN0483 = ' '                                 LH Unused Sts
     C                   EVAL      WN0484 = ' '                                 LH Carrier Paym
     C                   Z-ADD     *ZERO         WN0485                         Bring Back Mile
     C                   Z-ADD     *ZERO         WN0486                         Requested Deliv
     C                   EVAL      WN0487 = ' '                                 Load Acceptance
     C                   EVAL      WN0488 = ' '                                 Warehouse Code
     C                   Z-ADD     *ZERO         WN0489                         On Yard Date
     C                   Z-ADD     *ZERO         WN0490                         On Yard Time
     C                   Z-ADD     *ZERO         WN0491                         Deadline Depart
     C                   Z-ADD     *ZERO         WN0492                         Deadline Depart
     C                   EVAL      WN0493 = ' '                                 Load Held Over
     C                   EVAL      WN0494 = ' '                                 Load Held Over
     C                   EVAL      WN0495 = ' '                                 Load Held Over
     C                   EVAL      WN0496 = ' '                                 Ocean BOL Numbe
     C                   EVAL      WN0497 = ' '                                 Express Mail Nu
     C                   Z-ADD     *ZERO         WN0498                         Express Mail Da
     C                   EVAL      WN0499 = ' '                                 Load Shag Flag
     C                   EVAL      WN0500 = ' '                                 Load Wash Flag
     C                   Z-ADD     *ZERO         WN0501                         Product Complet
     C                   Z-ADD     *ZERO         WN0502                         Product Complet
     C                   Z-ADD     *ZERO         WN0503                         Pallets Loaded
     C                   Z-ADD     *ZERO         WN0504                         Avg Pallet Tare
     C                   Z-ADD     *ZERO         WN0505                         Tot Pallet Tare
     C                   EVAL      WN0506 = ' '                                 Load Confirmed
     C                   EVAL      WN0507 = ' '                                 Load Confirmed
     C                   Z-ADD     *ZERO         WN0508                         Load Confirmati
     C                   Z-ADD     *ZERO         WN0509                         Load Door 1
     C                   Z-ADD     *ZERO         WN0510                         Override Total
     C                   Z-ADD     *ZERO         WN0511                         Load Door 2
     C                   EVAL      WN0512 = ' '                                 Partial Load
     C                   EVAL      WN0513 = ' '                                 Load Confirmati
     C                   EVAL      WN0514 = ' '                                 Export Load USD
     C                   EVAL      WN0515 = ' '                                 Late Delivery E
     C                   Z-ADD     *ZERO         WN0516                         Load Actual Fre
     C                   EVAL      WN0517 = ' '                                 Hide on WW Load
     C                   EVAL      WN0518 = ' '                                 Late Billing Em
     C                   EVAL      WN0519 = ' '                                 Shipping Temp C
     C                   EVAL      WN0520 = ' '                                 LH Held Over Rs
     C                   EVAL      WN0521 = ' '                                 Multi Company L
     C                   EVAL      WN0522 = ' '                                 Fax Sent to SSI
     C                   EVAL      WN0523 = ' '                                 Schedule Pos Lo
     C                   EVAL      WN0524 = ' '                                 LH Power Only L
     C                   EVAL      WN0525 = ' '                                 MG Created Load
     C                   EVAL      WN0526 = ' '                                 LH Unused Sts 5
     C                   EVAL      WN0527 = ' '                                 Load U_M
     C                   EVAL      WN0528 = ' '                                 TPM Shipment St
     C                   EVAL      WN0529 = ' '                                 LH Unused Sts 8
     C                   EVAL      WN0530 = ' '                                 LH On-Time Reas
     C                   EVAL      WN0531 = ' '                                 LH Held Over Re
     C                   Z-ADD     *ZERO         WN0532                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WN0533                         LH Carrier Paid
     C                   Z-ADD     *ZERO         WN0534                         LH Last Combo P
     C                   Z-ADD     *ZERO         WN0535                         LH Last Combo P
     C                   Z-ADD     *ZERO         WN0536                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WN0537                         LPT Load Plan S
     C                   Z-ADD     *ZERO         WN0538                         TPM Planned Shi
     C                   Z-ADD     *ZERO         WN0539                         LH Unused Time
     C                   Z-ADD     *ZERO         WN0540                         LH Unused Date
     C                   Z-ADD     *ZERO         WN0541                         LH Unused Time
     C                   Z-ADD     *ZERO         WN0542                         LH Unused Date
     C                   Z-ADD     *ZERO         WN0543                         LH Unused Time
     C                   EVAL      WN0544 = ' '                                 EDI Status 1
     C                   EVAL      WN0545 = ' '                                 EDI Status 2
     C                   EVAL      WN0546 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0547                         Job Time
     C                   EVAL      WN0548 = ' '                                 User Id
     C                   EVAL      WN0549 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0550                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YHRDC = ' '
      *
      * Move key fields to @FJCPBO
     C                   Z-ADD     WL0601        TMRMNB                         Load ID
      *
     C     KLCHTT        KLIST
     C                   KFLD                    TMRMNB                         Load ID
     C     KLCHTT        CHAIN     @FJCPBO                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OMFJCPL1'    MDACP
     C                   MOVEL     '@FJCPBO'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL010.
     C                   MOVEL     'LBL010'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TTEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TTEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOMFJ1        YHRDCS
      * Move non-key fields to @FJCPBO
     C                   MOVEL(P)  WL0602        TMU2ST                         Export Status
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFJ1 <> YHRDCS AND
     C                             YHRDC <> 'N'
     C                   MOVE      'Y'           YHRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                   Z-ADD     ##JTM         TMAATM                         Job Time
     C                   MOVEL     ##USR         TMAYNA                         User Id
     C                   MOVEL     ##PGM         TMA0NA                         Job Name
     C                   Z-ADD     ##JDT         TMAXDT                         Job Date
      * Set PGM.*Record Data Changed flag
     C                   IF        QOMFJ1 <> YHRDCS AND
     C                             YHRDC <> 'N'
     C                   MOVE      'Y'           YHRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YHRDC = 'Y'
     C                   UPDATE    @FJCPBO                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OMFJCPL1                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TTEXIT        ENDSR
      /EJECT
     CSR   TUCHRC        BEGSR
      *================================================================
      * Chg Order Header WRK  CH - Order Header TRG  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0551                         Order Weight To
     C                   Z-ADD     *ZERO         WN0552                         Job Time
     C                   EVAL      WN0553 = ' '                                 User Id
     C                   EVAL      WN0554 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0555                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YIRDC = ' '
      *
      * Move key fields to @BFCPMD
     C                   Z-ADD     WAAIC3        TLAIC3                         Company Number
     C                   Z-ADD     WAC4NB        TLC4NB                         Order Number
      *
     C     KLCHTU        KLIST
     C                   KFLD                    TLAIC3                         Company Number
     C                   KFLD                    TLC4NB                         Order Number
     C     KLCHTU        CHAIN     @BFCPMD                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
      * USER: Processing if Data record not found
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   IF        W0RTN <> ' '
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBFCPW0'    MDACP
     C                   MOVEL     '@BFCPMD'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL011.
     C                   MOVEL     'LBL011'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   ENDIF
     C                   GOTO      TUEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TUEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBF2        YIRDCS
      * USER: Processing after Data read
      * 01/22/09 RMC  move here from "before Data update" spot
      * 06/23/00 PKD Added the update of the Export Status on the Load
      *              if the Export Status on the Order is changed to Y,
      * Change the Export Status.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Export Status NE DB1.Export Status
      *   |- c2    : PAR.Export Status is yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0197 <> TLU2ST
     C                   IF        YL0197 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load ID is NE Blank
      *   |- c2    : DB1.Load Plan Order is yes
      *   '-
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     '0'           Y0CX01
     C                   IF        TLRMNB <> 0
     C                   IF        TLU4ST = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Chg Export Status     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     TLRMNB        WL0601                         Load ID
     C                   MOVEL(P)  YL0197        WL0602                         Export Status
     C                   EXSR      TTCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   MOVEL     'N'           YL0472                         Status Flag 1
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE:
      *  - (c1ORc2) AND c3
      *   |- c1    : PAR.Requested Delivery Date NE DB1.Requested Deliver
      *   |- c2    : PAR.Requested Delivery Time NE DB1.Requested Deliver
      *   |- c3    : DB1.OH Appt Confirmation Dt is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   MOVEL     '0'           Y0CX02
     C                   IF        YL0190 <> TLEIDT OR
     C                             YL0028 <> TLAFTM
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   IF        TLNODT > 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0472                         Status Flag 1
     C                   END                                                    *FI
      * Move non-key fields to @BFCPMD
     C                   MOVEL(P)  YL0165        TLJNCD                         Order Type_Sale
     C                   Z-ADD     YL0012        TLANC7                         AR Customer Num
     C                   Z-ADD     YL0166        TLBKC7                         Ship To Custome
     C                   MOVEL(P)  YL0005        TLBRTX                         Ship To Name
     C                   MOVEL(P)  YL0006        TLHMNA                         Ship To Address
     C                   MOVEL(P)  YL0007        TLHONA                         Ship To Address
     C                   MOVEL(P)  YL0008        TLHPNA                         Ship To Address
     C                   MOVEL(P)  YL0009        TLHNNA                         Ship To City
     C                   MOVEL(P)  YL0010        TLDBCD                         Ship To State C
     C                   MOVEL(P)  YL0011        TLCKTX                         Ship To Zip_Pos
     C                   Z-ADD     YL0167        TLB0C7                         Bill to Custome
     C                   MOVEL(P)  YL0015        TLAETX                         Bill to Name
     C                   MOVEL(P)  YL0016        TLB1NA                         Bill to Address
     C                   MOVEL(P)  YL0017        TLB3NA                         Bill to Address
     C                   MOVEL(P)  YL0018        TLB4NA                         Bill to Address
     C                   MOVEL(P)  YL0019        TLB2NA                         Bill to City
     C                   MOVEL(P)  YL0020        TLBHCD                         Bill to State C
     C                   MOVEL(P)  YL0021        TLC8TX                         Bill to Zip_Pos
     C                   MOVEL(P)  YL0168        TLBCNA                         Customer Purcha
     C                   Z-ADD     YL0169        TLA0DT                         Order Date
     C                   Z-ADD     YL0060        TLA5DT                         Requested Ship
     C                   Z-ADD     YL0170        TLGNDT                         Actual Shipped
     C                   Z-ADD     YL0171        TLACDT                         Cancel Date
     C                   MOVEL(P)  YL0024        TLAQCD                         Terms Code
     C                   MOVEL(P)  YL0027        TLB6NA                         Special Instruc
     C                   MOVEL(P)  YL0026        TLBYNA                         Special Instruc
     C                   MOVEL(P)  YL0172        TLBZNA                         Carrier Code
     C                   MOVEL(P)  YL0173        TLGTST                         Comment Print A
     C                   MOVEL(P)  YL0174        TLGVST                         Comment Print I
     C                   MOVEL(P)  YL0175        TLGUST                         Comment Print P
     C                   MOVEL(P)  YL0176        TLQFST                         Comment Print S
     C                   MOVEL(P)  YL0177        TLCQCD                         Reason Code
     C                   MOVEL(P)  YL0178        TLGJST                         Order in Use
     C                   MOVEL(P)  YL0179        TLGWST                         Header Status
     C                   MOVEL(P)  YL0180        TLGXST                         Header Status L
     C                   MOVEL(P)  YL0181        TLGYST                         Order Type Prin
     C                   Z-ADD     YL0182        TLAODT                         Scheduled Ship
     C                   MOVEL(P)  @CN(069)      TLAIVN                         User Original E
     C                   Z-ADD     YL0184        TLCXDT                         Date of Origina
     C                   Z-ADD     YL0185        TLJZVA                         Order Value Tot
     C                   MOVEL(P)  YL0187        TLXIST                         Credit Hold
     C                   MOVEL(P)  YL0188        TLXJST                         Production Hold
     C                   MOVEL(P)  YL0189        TLXKST                         New Customer Ho
     C                   Z-ADD     YL0190        TLEIDT                         Requested Deliv
     C                   Z-ADD     YL0028        TLAFTM                         Requested Deliv
     C                   MOVEL(P)  YL0191        TLE8CD                         Accounts Receiv
     C                   MOVEL(P)  YL0192        TLE9CD                         Accounts Receiv
     C                   Z-ADD     YL0193        TLRMNB                         Load ID
     C                   Z-ADD     YL0030        TLTBNB                         Absorbed Freigh
     C                   Z-ADD     YL0194        TLR1NB                         Rated Freight
     C                   MOVEL(P)  YL0041        TLPJST                         LTL Flag
     C                   MOVEL(P)  YL0195        TLU0ST                         Price Audit
     C                   MOVEL(P)  YL0196        TLU1ST                         Price Status
     C                   MOVEL(P)  YL0047        TLQ2CD                         Shipping Method
     C                   MOVEL(P)  YL0197        TLU2ST                         Export Status
     C                   MOVEL(P)  YL0044        TLVEST                         Palletize
     C                   MOVEL(P)  YL0042        TLVFST                         Shrink Wrap
     C                   MOVEL(P)  YL0046        TLVGST                         Slip Sheet
     C                   MOVEL(P)  YL0198        TLRPCD                         Age Code
     C                   Z-ADD     YL0199        TLRNNB                         Reefer Temperat
     C                   MOVEL(P)  YL0200        TLVDST                         Load Type
     C                   Z-ADD     YL0201        TLATIN                         Attach to Invoi
     C                   MOVEL(P)  YL0202        TLU4ST                         Load Plan Order
     C                   MOVEL(P)  YL0203        TLU5ST                         Print Pick Slip
     C                   Z-ADD     YL0204        TLRSRN                         Resell Referenc
     C                   MOVEL(P)  YL0205        TLMHNA                         Special Comment
     C                   MOVEL(P)  YL0206        TLMINA                         Special Comment
     C                   MOVEL(P)  YL0207        TLWBST                         Affect Auto Acc
     C                   MOVEL(P)  YL0025        TLR4CD                         Sales Route Cod
     C                   MOVEL(P)  YL0034        TLBFCD                         Manager Level C
     C                   MOVEL(P)  YL0035        TLQ4CD                         VP Level Code
     C                   Z-ADD     YL0208        TLT3NB                         Attach to Order
     C                   MOVEL(P)  YL0209        TLSICD                         Reason for Pric
     C                   Z-ADD     YL0210        TLCONB                         Invoice Number
     C                   MOVEL(P)  YL0211        TLCEST                         Invoice Suffix
     C                   Z-ADD     YL0212        TLAWDT                         Invoice Date
     C                   MOVEL(P)  YL0213        TLJPCD                         Event Code
     C                   MOVEL(P)  YL0056        TLXUST                         Trans Contol AS
     C                   MOVEL(P)  YL0214        TLZ1ST                         Modified Flag
     C                   Z-ADD     YL0215        TLVRVA                         A_R order Value
     C                   MOVEL(P)  YL0050        TLOBST                         Billing Activit
     C                   MOVEL(P)  YL0216        TLBCST                         Block Order Fla
     C                   MOVEL(P)  YL0217        TLBDST                         Order Certifica
     C                   Z-ADD     YL0218        TLB7VL                         Invoice Order V
     C                   MOVEL(P)  YL0219        TLGASX                         Process Sts for
     C                   MOVEL(P)  YL0220        TLGBSX                         Order Conf Fax
     C                   MOVEL(P)  YL0221        TLGCSX                         Manifest Fax St
     C                   MOVEL(P)  YL0222        TLGDSX                         Invoice Fax Sts
     C                   MOVEL(P)  YL0223        TLFNSX                         Transfer in Sto
     C                   MOVEL(P)  YL0013        TLFOSX                         Email Cust On O
     C                   MOVEL(P)  YL0224        TLFPSX                         Order Emailed
     C                   MOVEL(P)  YL0225        TLFQSX                         Export Docs Go
     C                   MOVEL(P)  YL0226        TLFRSX                         Shipping Temp C
     C                   MOVEL(P)  YL0227        TLFSSX                         Broker Order St
     C                   MOVEL(P)  YL0014        TLFTSX                         Air Freight Ord
     C                   MOVEL(P)  YL0228        TLFUSX                         Order Requires
     C                   MOVEL(P)  YL0229        TLFVSX                         OH Load Plan Re
     C                   MOVEL(P)  YL0230        TLFWSX                         Export USDA App
     C                   MOVEL(P)  YL0059        TLFXSX                         HPB Ship to War
     C                   MOVEL(P)  YL0231        TLFYSX                         OH TF Exempt Co
     C                   Z-ADD     YL0232        TLNODT                         OH Appt Confirm
     C                   Z-ADD     YL0233        TLNPDT                         JPN Invoice Iss
     C                   Z-ADD     YL0234        TLNQDT                         Load Actual Shi
     C                   Z-ADD     YL0235        TLNRDT                         Load BOL Comple
     C                   Z-ADD     YL0236        TLNSDT                         Load Truck Depa
     C                   Z-ADD     YL0237        TLBPTM                         Maximum Gross W
     C                   Z-ADD     YL0238        TLBQTM                         Time of Origina
     C                   Z-ADD     YL0239        TLBRTM                         OH Appt Confirm
     C                   Z-ADD     YL0240        TLBSTM                         Load BOL Comple
     C                   Z-ADD     YL0241        TLBTTM                         Load Truck Depa
     C                   Z-ADD     YL0242        TLH0NX                         Act Frt Referen
     C                   Z-ADD     YL0243        TLH1NX                         Act Non_Ref Frt
     C                   Z-ADD     YL0244        TLH2NX                         OH Fuel Surchar
     C                   Z-ADD     YL0245        TLH3NX                         OH Total Non_Re
     C                   Z-ADD     YL0246        TLH4NX                         OH Total Ref Fr
     C                   Z-ADD     YL0247        TLC0C7                         Claim Number
     C                   MOVEL(P)  YL0248        TLUVST                         EDI Status 1
     C                   MOVEL(P)  YL0249        TLUWST                         EDI Status 2
     C                   MOVEL(P)  YL0250        TLUXST                         EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF2 <> YIRDCS AND
     C                             YIRDC <> 'N'
     C                   MOVE      'Y'           YIRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         TLAATM                         Job Time
     C                   MOVEL     ##USR         TLAYNA                         User Id
     C                   MOVEL     ##PGM         TLA0NA                         Job Name
     C                   Z-ADD     ##JDT         TLAXDT                         Job Date
     C                   MOVEL     @CN(069)      TLAYNA                         User Id
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                   CLEAR                   PIRC
     C                   Z-ADD     TLAIC3        PIAIC3                         Company Number
     C                   Z-ADD     TLC4NB        PIC4NB                         Order Number
     C                   MOVEL(P)  TLJNCD        PIJNCD                         Order Type_Sale
     C                   Z-ADD     TLANC7        PIANC7                         AR Customer Num
     C                   Z-ADD     TLBKC7        PIBKC7                         Ship To Custome
     C                   MOVEL(P)  TLBRTX        PIBRTX                         Ship To Name
     C                   MOVEL(P)  TLHMNA        PIHMNA                         Ship To Address
     C                   MOVEL(P)  TLHONA        PIHONA                         Ship To Address
     C                   MOVEL(P)  TLHPNA        PIHPNA                         Ship To Address
     C                   MOVEL(P)  TLHNNA        PIHNNA                         Ship To City
     C                   MOVEL(P)  TLDBCD        PIDBCD                         Ship To State C
     C                   MOVEL(P)  TLCKTX        PICKTX                         Ship To Zip_Pos
     C                   Z-ADD     TLB0C7        PIB0C7                         Bill to Custome
     C                   MOVEL(P)  TLAETX        PIAETX                         Bill to Name
     C                   MOVEL(P)  TLB1NA        PIB1NA                         Bill to Address
     C                   MOVEL(P)  TLB3NA        PIB3NA                         Bill to Address
     C                   MOVEL(P)  TLB4NA        PIB4NA                         Bill to Address
     C                   MOVEL(P)  TLB2NA        PIB2NA                         Bill to City
     C                   MOVEL(P)  TLBHCD        PIBHCD                         Bill to State C
     C                   MOVEL(P)  TLC8TX        PIC8TX                         Bill to Zip_Pos
     C                   MOVEL(P)  TLBCNA        PIBCNA                         Customer Purcha
     C                   Z-ADD     TLA0DT        PIA0DT                         Order Date
     C                   Z-ADD     TLA5DT        PIA5DT                         Requested Ship
     C                   Z-ADD     TLGNDT        PIGNDT                         Actual Shipped
     C                   Z-ADD     TLACDT        PIACDT                         Cancel Date
     C                   MOVEL(P)  TLAQCD        PIAQCD                         Terms Code
     C                   MOVEL(P)  TLB6NA        PIB6NA                         Special Instruc
     C                   MOVEL(P)  TLBYNA        PIBYNA                         Special Instruc
     C                   MOVEL(P)  TLBZNA        PIBZNA                         Carrier Code
     C                   MOVEL(P)  TLGTST        PIGTST                         Comment Print A
     C                   MOVEL(P)  TLGVST        PIGVST                         Comment Print I
     C                   MOVEL(P)  TLGUST        PIGUST                         Comment Print P
     C                   MOVEL(P)  TLQFST        PIQFST                         Comment Print S
     C                   MOVEL(P)  TLCQCD        PICQCD                         Reason Code
     C                   MOVEL(P)  TLGJST        PIGJST                         Order in Use
     C                   MOVEL(P)  TLGWST        PIGWST                         Header Status
     C                   MOVEL(P)  TLGXST        PIGXST                         Header Status L
     C                   MOVEL(P)  TLGYST        PIGYST                         Order Type Prin
     C                   Z-ADD     TLAODT        PIAODT                         Scheduled Ship
     C                   MOVEL(P)  TLAIVN        PIAIVN                         User Original E
     C                   Z-ADD     TLCXDT        PICXDT                         Date of Origina
     C                   Z-ADD     TLJZVA        PIJZVA                         Order Value Tot
     C                   Z-ADD     TLA1WG        PIA1WG                         Order Weight To
     C                   MOVEL(P)  TLXIST        PIXIST                         Credit Hold
     C                   MOVEL(P)  TLXJST        PIXJST                         Production Hold
     C                   MOVEL(P)  TLXKST        PIXKST                         New Customer Ho
     C                   Z-ADD     TLEIDT        PIEIDT                         Requested Deliv
     C                   Z-ADD     TLAFTM        PIAFTM                         Requested Deliv
     C                   MOVEL(P)  TLE8CD        PIE8CD                         Accounts Receiv
     C                   MOVEL(P)  TLE9CD        PIE9CD                         Accounts Receiv
     C                   Z-ADD     TLRMNB        PIRMNB                         Load ID
     C                   Z-ADD     TLTBNB        PITBNB                         Absorbed Freigh
     C                   Z-ADD     TLR1NB        PIR1NB                         Rated Freight
     C                   MOVEL(P)  TLPJST        PIPJST                         LTL Flag
     C                   MOVEL(P)  TLU0ST        PIU0ST                         Price Audit
     C                   MOVEL(P)  TLU1ST        PIU1ST                         Price Status
     C                   MOVEL(P)  TLQ2CD        PIQ2CD                         Shipping Method
     C                   MOVEL(P)  TLU2ST        PIU2ST                         Export Status
     C                   MOVEL(P)  TLVEST        PIVEST                         Palletize
     C                   MOVEL(P)  TLVFST        PIVFST                         Shrink Wrap
     C                   MOVEL(P)  TLVGST        PIVGST                         Slip Sheet
     C                   MOVEL(P)  TLRPCD        PIRPCD                         Age Code
     C                   Z-ADD     TLRNNB        PIRNNB                         Reefer Temperat
     C                   MOVEL(P)  TLVDST        PIVDST                         Load Type
     C                   Z-ADD     TLATIN        PIATIN                         Attach to Invoi
     C                   MOVEL(P)  TLU4ST        PIU4ST                         Load Plan Order
     C                   MOVEL(P)  TLU5ST        PIU5ST                         Print Pick Slip
     C                   Z-ADD     TLRSRN        PIRSRN                         Resell Referenc
     C                   MOVEL(P)  TLMHNA        PIMHNA                         Special Comment
     C                   MOVEL(P)  TLMINA        PIMINA                         Special Comment
     C                   MOVEL(P)  TLWBST        PIWBST                         Affect Auto Acc
     C                   MOVEL(P)  TLR4CD        PIR4CD                         Sales Route Cod
     C                   MOVEL(P)  TLBFCD        PIBFCD                         Manager Level C
     C                   MOVEL(P)  TLQ4CD        PIQ4CD                         VP Level Code
     C                   Z-ADD     TLT3NB        PIT3NB                         Attach to Order
     C                   MOVEL(P)  TLSICD        PISICD                         Reason for Pric
     C                   Z-ADD     TLCONB        PICONB                         Invoice Number
     C                   MOVEL(P)  TLCEST        PICEST                         Invoice Suffix
     C                   Z-ADD     TLAWDT        PIAWDT                         Invoice Date
     C                   MOVEL(P)  TLJPCD        PIJPCD                         Event Code
     C                   MOVEL(P)  TLXUST        PIXUST                         Trans Contol AS
     C                   MOVEL(P)  TLZ1ST        PIZ1ST                         Modified Flag
     C                   Z-ADD     TLVRVA        PIVRVA                         A_R order Value
     C                   MOVEL(P)  TLOBST        PIOBST                         Billing Activit
     C                   MOVEL(P)  TLBCST        PIBCST                         Block Order Fla
     C                   MOVEL(P)  TLBDST        PIBDST                         Order Certifica
     C                   Z-ADD     TLB7VL        PIB7VL                         Invoice Order V
     C                   MOVEL(P)  TLGASX        PIGASX                         Process Sts for
     C                   MOVEL(P)  TLGBSX        PIGBSX                         Order Conf Fax
     C                   MOVEL(P)  TLGCSX        PIGCSX                         Manifest Fax St
     C                   MOVEL(P)  TLGDSX        PIGDSX                         Invoice Fax Sts
     C                   MOVEL(P)  TLFNSX        PIFNSX                         Transfer in Sto
     C                   MOVEL(P)  TLFOSX        PIFOSX                         Email Cust On O
     C                   MOVEL(P)  TLFPSX        PIFPSX                         Order Emailed
     C                   MOVEL(P)  TLFQSX        PIFQSX                         Export Docs Go
     C                   MOVEL(P)  TLFRSX        PIFRSX                         Shipping Temp C
     C                   MOVEL(P)  TLFSSX        PIFSSX                         Broker Order St
     C                   MOVEL(P)  TLFTSX        PIFTSX                         Air Freight Ord
     C                   MOVEL(P)  TLFUSX        PIFUSX                         Order Requires
     C                   MOVEL(P)  TLFVSX        PIFVSX                         OH Load Plan Re
     C                   MOVEL(P)  TLFWSX        PIFWSX                         Export USDA App
     C                   MOVEL(P)  TLFXSX        PIFXSX                         HPB Ship to War
     C                   MOVEL(P)  TLFYSX        PIFYSX                         OH TF Exempt Co
     C                   Z-ADD     TLNODT        PINODT                         OH Appt Confirm
     C                   Z-ADD     TLNPDT        PINPDT                         JPN Invoice Iss
     C                   Z-ADD     TLNQDT        PINQDT                         Load Actual Shi
     C                   Z-ADD     TLNRDT        PINRDT                         Load BOL Comple
     C                   Z-ADD     TLNSDT        PINSDT                         Load Truck Depa
     C                   Z-ADD     TLBPTM        PIBPTM                         Maximum Gross W
     C                   Z-ADD     TLBQTM        PIBQTM                         Time of Origina
     C                   Z-ADD     TLBRTM        PIBRTM                         OH Appt Confirm
     C                   Z-ADD     TLBSTM        PIBSTM                         Load BOL Comple
     C                   Z-ADD     TLBTTM        PIBTTM                         Load Truck Depa
     C                   Z-ADD     TLH0NX        PIH0NX                         Act Frt Referen
     C                   Z-ADD     TLH1NX        PIH1NX                         Act Non_Ref Frt
     C                   Z-ADD     TLH2NX        PIH2NX                         OH Fuel Surchar
     C                   Z-ADD     TLH3NX        PIH3NX                         OH Total Non_Re
     C                   Z-ADD     TLH4NX        PIH4NX                         OH Total Ref Fr
     C                   Z-ADD     TLC0C7        PIC0C7                         Claim Number
     C                   MOVEL(P)  TLUVST        PIUVST                         EDI Status 1
     C                   MOVEL(P)  TLUWST        PIUWST                         EDI Status 2
     C                   MOVEL(P)  TLUXST        PIUXST                         EDI Status 3
     C                   Z-ADD     TLAATM        PIAATM                         Job Time
     C                   MOVEL(P)  TLAYNA        PIAYNA                         User Id
     C                   MOVEL(P)  TLA0NA        PIA0NA                         Job Name
     C                   Z-ADD     TLAXDT        PIAXDT                         Job Date
      *
     C                   CALL      'PDW9XFR'                            90      TRG Order Hdr C
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PIRC                           RCD: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDW9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * -----------------------------------------------------------------
      * -----------------------------------------------------------------
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF2 <> YIRDCS AND
     C                             YIRDC <> 'N'
     C                   MOVE      'Y'           YIRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YIRDC = 'Y'
     C                   UPDATE    @BFCPMD                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBFCPW0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE: LCL.Status Flag 1  Y/N is Yes
      * Exc Email Ord RqDtChg XF - Order Header TRG  * 
     C                   IF        YL0472 = 'Y'
     C                   CALL      'PBEPXFR'                            90      Exc Email Ord R
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TLAIC3        WQ1187                         Company Number
     C                   PARM      TLC4NB        WQ1188                         Order Number
     C                   PARM      TLR4CD        WQ1189                         Sales Route Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBEPXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   TUEXIT        ENDSR
      /EJECT
     CSR   TVRVGN        BEGSR
      *================================================================
      * RTV Block Order Flag  RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTV         KLIST
     C                   KFLD                    TDAIC3                         Company Number
     C                   KFLD                    TDC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        TDAIC3                         Company Number
     C                   Z-ADD     WAC4NB        TDC4NB                         Order Number
      * Establish starting position
     C     KRSTV         CHAIN     @BECPFK                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0176'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0216 = ' '                                 Block Order Fla
     C                   GOTO      TVEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     TDBCST        YL0216                         Block Order Fla
     C                   ENDIF
      *================================================================
     CSR   TVEXIT        ENDSR
      /EJECT
     CSR   TWRVGN        BEGSR
      *================================================================
      * RTV Cancel Order       RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTW         KLIST
     C                   KFLD                    TDAIC3                         Company Number
     C                   KFLD                    TDC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        TDAIC3                         Company Number
     C                   Z-ADD     WAC4NB        TDC4NB                         Order Number
      * Establish starting position
     C     KRSTW         CHAIN     @BECPFK                            90        *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * RTV Cancel Entire Order - Order Detail  * 
     C                   IF        NOT *IN90
     C                   EXSR      TXRVGN
      * CASE: LCL.USR Return Code is Does Not Exist
     C                   IF        YL0476 = 'N'
     C                   MOVEL     TDGWST        YL0482                         Header Status L
      * Chg Order Status BlockOrd - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TDAIC3        WL0448                         Company Number
     C                   Z-ADD     TDC4NB        WL0449                         Order Number
     C                   Z-ADD     WAACDT        WL0450                         Cancel Date
     C                   MOVEL(P)  'X'           WL0451                         Header Status
     C                   MOVEL(P)  YL0482        WL0452                         Header Status L
     C                   Z-ADD     *ZERO         WL0453                         Order Value Tot
     C                   Z-ADD     *ZERO         WL0454                         Order Weight To
     C                   MOVEL(P)  'N'           WL0455                         Credit Hold
     C                   MOVEL(P)  'N'           WL0456                         Production Hold
     C                   Z-ADD     *ZERO         WL0457                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WL0458                         Rated Freight
     C                   Z-ADD     *ZERO         WL0459                         Attach to Invoi
     C                   MOVEL(P)  'N'           WL0460                         Affect Auto Acc
     C                   EVAL      WL0461 = ' '                                 Sales Route Cod
     C                   Z-ADD     *ZERO         WL0462                         Attach to Order
     C                   EVAL      WL0463 = ' '                                 Reason for Pric
     C                   Z-ADD     *ZERO         WL0464                         A_R order Value
     C                   EXSR      TOCHRC
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   TWEXIT        ENDSR
      /EJECT
     CSR   TXRVGN        BEGSR
      *================================================================
      * RTV Cancel Entire Order - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0476                         USR Return Code
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTX         KLIST
     C                   KFLD                    WQTX01                         Company Number
     C                   KFLD                    WQTX02                         Order Number
      * Setup key
     C                   Z-ADD     TDAIC3        WQTX01                         Company Number
     C                   Z-ADD     TDC4NB        WQTX02                         Order Number
      * Establish starting position
     C     KRSTX         SETLL     @BGWKL1                                      *
     C     KRSTX         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   MOVEL     'E'           YL0476                         USR Return Code
     C                   Z-ADD     TECCQT        YL0477                         Quantity Schedu
     C                   Z-ADD     TEAUWG        YL0478                         Weight Schedule
      * **WI546_2-Dealloc inventory
      * CASE: DB1.OD Production Plan Sts is Yes
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                   IF        TER1ST = ' '
     C                   CALL      'PDQNXFR'                            90      UPD Avail-To-Se
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TEAIC3        WQ1215                         Company Number
     C                   PARM      TEC4NB        WQ1216                         Order Number
     C                   PARM      TEDPNB        WQ1217                         Order Sequence
     C                   PARM      TEUENB        WQ1218                         Order Secondary
     C                   PARM      TEHGCD        WQ1219                         Item Code
     C                   PARM      TEAJCD        WQ1220                         Warehouse Code
     C                   PARM      TEA5DT        WQ1221                         Ship Date USR
     C                   PARM      *ZERO         WQ1222                         Quantity Ordere
     C                   PARM      *ZERO         WQ1223                         Weight Ordered
     C     YL0477        PARM      YL0477        WQ1224                         Quantity Schedu
     C     YL0478        PARM      YL0478        WQ1225                         Weight Schedule
     C                   PARM      'OD'          WQ1226                         ATS Adj Type US
     C                   PARM      ##PGM         WQ1227                         PSAA Program Na
     C                   PARM      TERINY        WQ1228                         Item Age Days
     C                   PARM      TETIDT        WQ1229                         Production Ovr
     C                   PARM      TETJDT        WQ1230                         Production Ovr
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDQNXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0477                         Quantity Schedu
     C                   Z-ADD     *ZERO         YL0478                         Weight Schedule
     C                   END                                                    *FI
      * Chg Qty/Wgt Sched BlockOR - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0423                         Company Number
     C                   Z-ADD     TEC4NB        WL0424                         Order Number
     C                   Z-ADD     TEDPNB        WL0425                         Order Sequence
     C                   Z-ADD     TEUENB        WL0426                         Order Secondary
     C                   Z-ADD     YL0477        WL0427                         Quantity Schedu
     C                   Z-ADD     YL0478        WL0428                         Weight Schedule
     C                   EXSR      TICHRC
      * **WI546_2-Cancellation logic same as PDN9EFR UI.
      * CASE: DB1.Detail Line Status is Entered
      * DLT PD Order Detail    DL - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        TEGMST = 'E'
     C                   Z-ADD     TEAIC3        WL0429                         Company Number
     C                   Z-ADD     TEC4NB        WL0430                         Order Number
     C                   Z-ADD     TEDPNB        WL0431                         Order Sequence
     C                   Z-ADD     TEUENB        WL0432                         Order Secondary
     C                   EXSR      TJDLRC
      * Rtv Dlt OD Files/CanclXF - Order Detail  * 
     C                   CALL      'PUKGXFR'                            90      Rtv Dlt OD File
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TEAIC3        WQ1231                         Company Number
     C                   PARM      TEC4NB        WQ1232                         Order Number
     C                   PARM      TEDPNB        WQ1233                         Order Sequence
     C                   PARM      TEUENB        WQ1234                         Order Secondary
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUKGXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     TEGMST        YL0479                         Detail Line Sta
     C                   MOVEL     'X'           YL0480                         Detail Line Sta
      * CHG Sts,Alloc          CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0433                         Company Number
     C                   Z-ADD     TEC4NB        WL0434                         Order Number
     C                   Z-ADD     TEDPNB        WL0435                         Order Sequence
     C                   Z-ADD     TEUENB        WL0436                         Order Secondary
     C                   MOVEL(P)  YL0480        WL0437                         Detail Line Sta
     C                   MOVEL(P)  YL0479        WL0438                         Detail Line Sta
     C                   Z-ADD     TECCQT        WL0439                         Quantity Schedu
     C                   Z-ADD     TEAUWG        WL0440                         Weight Schedule
     C                   EXSR      TKCHRC
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0441                         Company Number
     C                   Z-ADD     TEC4NB        WL0442                         Order Number
     C                   Z-ADD     TEDPNB        WL0443                         Order Sequence
     C                   Z-ADD     TEUENB        WL0444                         Order Secondary
     C                   EXSR      TLRVGN
     C                   END                                                    *FI
     C     KRSTX         READE     @BGWKL1                                90    *
     C                   ENDDO
      * USER: Exit processing
     C                   MOVEL     TEGMST        YL0481                         Header Status L
      * Chg Order Status BlockOrd - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     TEAIC3        WL0448                         Company Number
     C                   Z-ADD     TEC4NB        WL0449                         Order Number
     C                   Z-ADD     WAACDT        WL0450                         Cancel Date
     C                   MOVEL(P)  'X'           WL0451                         Header Status
     C                   MOVEL(P)  YL0481        WL0452                         Header Status L
     C                   Z-ADD     *ZERO         WL0453                         Order Value Tot
     C                   Z-ADD     *ZERO         WL0454                         Order Weight To
     C                   MOVEL(P)  'N'           WL0455                         Credit Hold
     C                   MOVEL(P)  'N'           WL0456                         Production Hold
     C                   Z-ADD     *ZERO         WL0457                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WL0458                         Rated Freight
     C                   Z-ADD     *ZERO         WL0459                         Attach to Invoi
     C                   MOVEL(P)  'N'           WL0460                         Affect Auto Acc
     C                   EVAL      WL0461 = ' '                                 Sales Route Cod
     C                   Z-ADD     *ZERO         WL0462                         Attach to Order
     C                   EVAL      WL0463 = ' '                                 Reason for Pric
     C                   Z-ADD     *ZERO         WL0464                         A_R order Value
     C                   EXSR      TOCHRC
      *================================================================
     CSR   TXEXIT        ENDSR
      /EJECT
     CSR   TYRVGN        BEGSR
      *================================================================
      * RTV Send Error Emails  RT - WF Block Order Upload Hdr  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * RTV Data Libraries     RT - System Values  * Prod or Test
     C                   EXSR      TZRVGN
      * If Not PROD Then get 'TEST' Email address.
      * CASE: LCL.Library List Code is Not PRKFLIB
      * RTV System Value Alpha RT - System Values  * Get Blck Ord Email A
      * Move input parameters to subroutine local variables.
     C                   IF        YL0483 <> @CN(236)
     C                   MOVEL(P)  @CN(237)      WL0603                         System Value Co
     C                   EXSR      NARVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0604        YL0484                         System Value Al
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV System Value Alpha RT - System Values  * Get Blck Ord Email A
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  @CN(238)      WL0603                         System Value Co
     C                   EXSR      NARVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0604        YL0484                         System Value Al
     C                   END                                                    *FI
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTY         KLIST
     C                   KFLD                    WQTY01                         Record Processe
      * Setup key
     C                   MOVEL     'E'           WQTY01                         Record Processe
      * Establish starting position
     C     KRSTY         SETLL     @C2CPM5                                      *
     C     KRSTY         READE     @C2CPM5                                90    *
      * Data record not found
     C   90              MOVEL     'USR5299'     W0RTN
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   MOVEL     'N'           YL0485                         Send Email USR
      * ** Send one email for all errors per surrogate number.
      * RTV Send Email for Err RT - WF Block Order Errors  * 
     C                   EXSR      NBRVGN
      * ** Update header with Email Sent
      * CASE: LCL.Email Sent is Yes
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TOC4NB' defaulted for 'Order Number'.
      * Field '(DB1) TOGWST' defaulted for 'Header Status'.
      * Field '(DB1) TOACDT' defaulted for 'Cancel Date'.
      * Field '(DB1) TOVEST' defaulted for 'Palletize'.
      * Field '(DB1) TOVGST' defaulted for 'Slip Sheet'.
      * Field '(DB1) TOQ2CD' defaulted for 'Shipping Method'.
      * Field '(DB1) TORNNB' defaulted for 'Reefer Temperature'.
      * Field '(DB1) TOEIDT' defaulted for 'Requested Delivery Date'.
      * Field '(DB1) TOVFST' defaulted for 'Shrink Wrap'.
      * Chg Block Order Upl HdrCH - WF Block Order Upload Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0486 = 'Y'
     C                   Z-ADD     TOHQNZ        WL0119                         Surrogate Numbe
     C                   Z-ADD     TOAIC3        WL0120                         Company Number
     C                   Z-ADD     TOC4NB        WL0121                         Order Number
     C                   MOVEL(P)  TOGWST        WL0122                         Header Status
     C                   Z-ADD     TOBKC7        WL0123                         Ship To Custome
     C                   MOVEL(P)  TOAJCD        WL0124                         Warehouse Code
     C                   Z-ADD     TOA5DT        WL0125                         Requested Ship
     C                   Z-ADD     TOACDT        WL0126                         Cancel Date
     C                   MOVEL(P)  TOC3TX        WL0127                         OHE Spot Buy
     C                   MOVEL(P)  TOBCNA        WL0128                         Customer Purcha
     C                   MOVEL(P)  TOU2ST        WL0129                         Export Status
     C                   MOVEL(P)  TOKXCD        WL0130                         Country Code
     C                   MOVEL(P)  TOLWAA        WL0131                         OHE Intended fo
     C                   MOVEL(P)  TOFQSX        WL0132                         Export Docs Go
     C                   MOVEL(P)  TOVEST        WL0133                         Palletize
     C                   MOVEL(P)  TOVGST        WL0134                         Slip Sheet
     C                   MOVEL(P)  TOQ2CD        WL0135                         Shipping Method
     C                   Z-ADD     TORNNB        WL0136                         Reefer Temperat
     C                   MOVEL(P)  TON6SC        WL0137                         Record Processe
     C                   MOVEL(P)  YL0486        WL0138                         Email Sent
     C                   Z-ADD     TOEIDT        WL0139                         Requested Deliv
     C                   MOVEL(P)  TOVFST        WL0140                         Shrink Wrap
     C                   MOVEL(P)  TOVSST        WL0141                         Record Status
     C                   Z-ADD     TOMJDT        WL0142                         Create Date
     C                   Z-ADD     TOBETM        WL0143                         Create Time
     C                   MOVEL(P)  TOCCVN        WL0144                         Create User
     C                   MOVEL(P)  TOCDVN        WL0145                         Create Program
     C                   Z-ADD     TOMKDT        WL0146                         Change Date
     C                   Z-ADD     TOBFTM        WL0147                         Change Time
     C                   MOVEL(P)  TOCEVN        WL0148                         Change User
     C                   MOVEL(P)  TOCFVN        WL0149                         Change Program
     C                   EXSR      SWCHRC
     C                   END                                                    *FI
     C     KRSTY         READE     @C2CPM5                                90    *
     C                   ENDDO
      *================================================================
     CSR   TYEXIT        ENDSR
      /EJECT
     CSR   TZRVGN        BEGSR
      *================================================================
      * RTV Data Libraries     RT - System Values  * Prod or Test
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KPSTZ         KLIST
     C                   KFLD                    TRDOCD                         System Value Co
      * Setup key
     C                   EVALR     TRDOCD = ' '                                 System Value Co
     C                   MOVEL     'DTALIB'      TRDOCD                         System Value Co
      * Establish starting position
     C     KPSTZ         SETLL     @DPRETD                                      *
     C                   READ      @DPRETD                                90    *
      * Data record not found
     C   90              MOVEL     'USR0759'     W0RTN
      * USER: Process Data record
      * CASE: DB1.System Value Code is Data File Library
     C                   DOW       NOT *IN90
     C                   IF        TRDOCD = @CN(234)
     C                   MOVEL     TRBXTX        YL0483                         Library List Co
     C                   ELSE
      * CASE: DB1.System Value Code is History File Library
     C                   IF        TRDOCD = @CN(235)
     C                   MOVEL     TRBXTX        YN0379                         @Library List C
     C                   GOTO      TZEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   READ      @DPRETD                                90    *
     C                   ENDDO
      *================================================================
     CSR   TZEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Program Comments.
      *================================================================
      * S027849-JM-03/28/25-Stop firm order update by block order automat
      * S027442-JM-03/20/25-Fix zero order number scenario in order detai
      * S028944-JM-09/09/24-Block Order Automation Fixes
      * S016189-JM-07/03/24-Block Order Automation Fixes
      * WI546_2 Called from informatica job ETLBLOCK.
      * ** WI546_2 05/22/24
      * 1019801 JM - WI546_2 Added RDD check in Calendar file.
      * ** WI546 10/01/23
      * This program will process through two work files.  Block order
      * Header and Block Order Detail.  We will process the records from
      * these two files and test for a number of different errors.  If
      * errors are found then we will write and email for each
      * Surrogate #.  If we don't find an error, we will post to Order
      * Header and Detail in Qtemp.  More errors are tested and if we
      * find no more, then we copy the records from Qtemp to Production.
      * ** WI546_2  02/22/24
      * Part 2 of Block Orders has added additional fields and those
      * need to be validated and not defaulted.  We will also be
      * processing changed records and will need to validate those also.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   UBSUBR        BEGSR
      *================================================================
      * Must Read - Trigger Information
      *================================================================
      * DB2 Trigger is added on files PUC2CPP & PUC3CPP.
      *================================================================
     CSR   UBEXIT        ENDSR
      /EJECT
     CSR   UCSUBR        BEGSR
      *================================================================
      * Comments
      *================================================================
      * ** WI546 10/01/23
      * Process through all the Work file Header records and for each
      * Header record, process the Work file detail records for that
      * Surrogate #.  Write emails for any errors.
      * ** WI546_2 02/22/24
      * Additional validations and process changed records.
      * ** WI546_2 06/06/24
      * Updated Order Number from 9999999 to New one in work file.
      * This will take care of scheduling.
      *================================================================
     CSR   UCEXIT        ENDSR
      /EJECT
     CSR   UDSUBR        BEGSR
      *================================================================
      * Comments
      *================================================================
      * ** WI546 10/01/23
      * Validate for error conditions in the Header Work file.
      * ** WI546_2 02/22/24
      * Validate additional fields for new orders (No order number)
      *  and process change records (Order Number is Present).
      *================================================================
     CSR   UDEXIT        ENDSR
      /EJECT
     CSR   UESUBR        BEGSR
      *================================================================
      * ** Comments
      *================================================================
      * ** WI546 10/01/23
      * In this routine we will process each detail record in the Work
      * File.  Each record will be checked for a number of possible error
      * conditions.  If an error is found, we will add a record to the
      * Error Work File.  If no errors are found, we will write a
      * record to the Order Detail file in Qtemp.
      *================================================================
     CSR   UEEXIT        ENDSR
      /EJECT
     CSR   UFSUBR        BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                   CALL      'PBI3XFR'                            90      Rtv Tare Weight
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TGAIC3        WQ0820                         Company Number
     C                   PARM      TGHGCD        WQ0821                         Item Code
     C     YL0425        PARM      YL0425        WQ0822                         Misc Tare Weigh
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBI3XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * wi464 change
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                   CALL      'PBI4XFR'                            90      RTV Itm BxID &
     C                   PARM      *BLANK        W0RTN
     C                   PARM      TGAIC3        WQ0823                         Company Number
     C                   PARM      TGHGCD        WQ0824                         Item Code
     C     YL0426        PARM      *ZERO         WQ0825                         Box Weight
     C     YL0427        PARM      *ZERO         WQ0826                         Number Cases On
     C     YL0428        PARM      *ZERO         WQ0827                         Pallet Tare Wei
     C     YL0429        PARM      *ZERO         WQ0828                         Box iD
     C                   PARM      TGF5SX        WQ0829                         OD Pallet Type
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBI4XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C     YL0426        ADD       YL0425        YL0430                         Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C     YL0426        ADD       YL0425        W0WA01                         *Synon (15,2) w
     C     W0WA01        MULT(H)   TGAVQT        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        YL0431                         Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C                   IF        TGVEST = 'Y'
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C                   IF        YL0427 > 0
     C     TGAVQT        DIV(H)    YL0427        W0WA01                         *Synon (15,2) w
     C     W0WA01        MULT(H)   YL0428        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        YL0432                         Weight 1.2
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0432                         Weight 1.2
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0432                         Weight 1.2
     C                   END                                                    *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C     TGD0WG        ADD       YL0431        W0WA01                         *Synon (15,2) w
     C     W0WA01        ADD       YL0432        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        TGH8NX                         OD Estimated Gr
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      *================================================================
     CSR   UFEXIT        ENDSR
      /EJECT
     CSR   XCVFA         BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C                   IF        XDAY1 > 109267
     C                   ADD       2             XDAY1
     C                   ELSE
     C                   IF        XDAY1 > 36218
     C                   ADD       1             XDAY1
     C                   END
     C                   END
      * Full years (up to the date)
     C     XDAY1         DIV       365.25        XDWK1
     C                   MVR                     XDWK3
     C                   Z-ADD     XDWK1         XDINYY
      * The date is the end of a year
     C                   IF        XDWK3 = 0
     C                   Z-ADD     12            XDINMM
     C                   Z-ADD     31            XDINDD
     C                   ELSE
      * Year days up to the date
     C     XDWK1         MULT      365.25        XDWK2
     C                   SUB       XDWK2         XDAY1
     C                   ADD       1             XDINYY
      * Leap year ?
     C     XDINYY        DIV       4             XDWK1
     C                   MVR                     XDWK1
      * March 1 (relative day of the year)
     C                   IF        XDWK1 = 0
     C                   Z-ADD     60            XDWK1
     C                   ELSE
     C                   Z-ADD     59            XDWK1
     C                   END
      * Define date base month and offset day -
      *  - January (thru February)
     C                   IF        XDAY1 <= XDWK1
     C                   Z-ADD     1             XDINMM
     C                   ELSE
     C                   SUB       XDWK1         XDAY1
      *  - March (thru July)
     C                   IF        XDAY1 <= 153
     C                   Z-ADD     3             XDINMM
     C                   ELSE
      *  - August (thru December)
     C                   Z-ADD     8             XDINMM
     C                   SUB       153           XDAY1
     C                   END
      * Calculate 2 month base and offset day
     C     XDAY1         SUB       1             XDWK1
     C                   DIV       61            XDWK1
     C                   MVR                     XDAY1
     C                   ADD       1             XDAY1
     C                   MULT      2             XDWK1
     C                   ADD       XDWK1         XDINMM
     C                   END
      * Calculate date increment,
     C                   IF        XDAY1 > 31
     C                   ADD       1             XDINMM
     C                   SUB       31            XDAY1
     C                   END
     C                   Z-ADD     XDAY1         XDINDD
     C                   END
      *================================================================
     CSR   XCVFAE        ENDSR
      /EJECT
     CSR   XCVTA         BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C     XDINYY        SUB       1             XDWK1
     C     XDWK1         MULT      365.25        XDAY1
     C                   IF        XDWK1 >= 300
     C                   SUB       2             XDAY1
     C                   ELSE
     C                   IF        XDWK1 >= 100
     C                   SUB       1             XDAY1
     C                   END
     C                   END
      * (from the beginning of the year to the beginning of the month:)
     C     XDINMM        SUB       1             XDWK1
      *     ...+31*(MM-1) (for January-February) ...
     C                   IF        XDINMM < 3
     C                   MULT      31            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                   MULT      30            XDWK1
     C                   ADD       XDWK1         XDAY1
      *         ...-2 (for preceding February) ...
     C                   SUB       2             XDAY1
      *         ...+1 (for preceding February, if leap year) ...
     C                   IF        XDINYY <> 100 AND
     C                             XDINYY <> 300
     C     XDINYY        DIV       4             XDWK1
     C                   MVR                     XDWK1
     C                   IF        XDWK1 = 0
     C                   ADD       1             XDAY1
     C                   END
     C                   END
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C                   IF        XDINMM < 8
     C     XDINMM        MULT      .5            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C     XDINMM        ADD       1             XDWK1
     C                   MULT      .5            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   END
     C                   END
      * ...+DD (days in the month up to the ending date)
     C                   ADD       XDINDD        XDAY1
      *================================================================
     CSR   XCVTAE        ENDSR
      /EJECT
     CSR   XDADY         BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
      * None days of week selected
     C                   IF        XDURR = 0 OR
     C                             XDWSL = 0
     C                   Z-ADD     XDAY2         XDAY1
      * Return Code: Unable to increment date.
     C                   IF        XDURR <> *ZERO
     C                   MOVEL     'Y2U0059'     W0RTN
     C                   ENDIF
     C                   GOTO      XDADYE
     C                   ENDIF
      * All days of week selected
     C                   IF        XDWSL = 7
     C     XDAY2         ADD       XDURR         XDAY1
     C                   GOTO      XDADYM
     C                   ENDIF
      * Some days of week selected
     C                   IF        XDURR >= 0
     C                   Z-ADD     1             XDSTP
     C                   ELSE
     C                   Z-ADD     -1            XDSTP
     C                   ENDIF
      * Get number of full weeks in the duration
     C     XDURR         DIV       XDWSL         XDWNB
      * Isolate the last week
     C                   MVR                     XDLSW
     C                   IF        XDLSW = 0
     C     XDWSL         MULT      XDSTP         XDLSW
     C                   SUB       XDSTP         XDWNB
     C                   ENDIF
      * Increment the date by the full weeks
     C     XDWNB         MULT      7             XDWK1
     C     XDAY2         ADD       XDWK1         XDAY1
      * Determine day of week of the beginning date
     C     XDAY2         ADD       3             YY
     C                   DIV       7             YY
     C                   MVR                     YY
     C                   IF        YY = 0
     C                   Z-ADD     7             YY
     C                   ENDIF
      * Loop: Increment the date by the last week
      * Increment the date
     C                   DOW       XDLSW <> 0
     C                   ADD       XDSTP         XDAY1
      * Increment the day of week
     C                   ADD       XDSTP         YY
      * Put day of week into the range 1-7
     C                   IF        YY = 0
     C                   Z-ADD     7             YY
     C                   ELSE
     C                   IF        YY = 8
     C                   Z-ADD     1             YY
     C                   ELSE
     C                   IF        YY = -1
     C                   Z-ADD     6             YY
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * Selected day of the last week has been processed
     C                   IF        YDOW(YY) = XDSEL
     C                   SUB       XDSTP         XDLSW
     C                   ENDIF
      * End of loop
     C                   ENDDO
     C     XDADYM        TAG
     C                   IF        XDINDD < 1
     C                   Z-ADD     1             XDINDD
     C                   MOVEL     'Y2U0006'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   XDADYE        ENDSR
      /EJECT
     CSR   XDAG1         BEGSR
      *================================================================
      * Prepare parameters to calculate Date Increment
      *================================================================
      * Negative date increment
     C                   IF        XDURR < 0
     C                   Z-ADD     -1            XDWK2
     C                   ELSE
      * Positive date increment
     C                   Z-ADD     1             XDWK2
     C                   ENDIF
     C                   MULT      XDWK2         XDURR
      * Refresh the length of updated month (returned in XDWK1).
     C                   Z-ADD     XDINDT        XDINT2
     C                   EXSR      XDMNH
      * Save the start day
     C                   IF        XDINDD = XDWK1
     C                   Z-ADD     0             XDINDD
     C                   ENDIF
     C                   Z-ADD     0             XDINT2
     C                   Z-ADD     0             XDIMDT
     C                   EVAL      W0RTN = ' '
      *================================================================
     CSR   XDAG1E        ENDSR
      /EJECT
     CSR   XDAG2         BEGSR
      *================================================================
      * General calculations driven by Increment Mask
      *================================================================
      * Extract days
     C                   IF        XDIMDD = 1
     C                   DIV       100           XDURR
     C                   MVR                     XDIND2
     C                   ENDIF
      * Extract months
     C                   IF        XDIMMM = 1
     C                   DIV       100           XDURR
     C                   MVR                     XDINM2
     C                   ENDIF
      * Extract years
     C                   IF        XDIMYY = 1
     C                   DIV       1000          XDURR
     C                   MVR                     XDINY2
     C                   ENDIF
     C                   IF        XDURR <> 0
     C                   MOVEL     'Y2U0006'     W0RTN
     C                   ENDIF
      * Normalize month increment
     C     XDINM2        DIV       12            XDURR
     C                   MVR                     XDINM2
     C                   ADD       XDURR         XDINY2
      * Apply year increment
     C                   MULT      XDWK2         XDINY2
     C                   ADD       XDINYY        XDINY2
      * Apply month increment
     C                   MULT      XDWK2         XDINM2
     C                   ADD       XDINMM        XDINM2
      * Normalize updated month
     C                   EXSR      XDNZM
      * Restore the start day
     C                   IF        XDINDD > XDWK1 OR
     C                             XDINDD = 0
     C                   Z-ADD     XDWK1         XDINDD
     C                   ENDIF
      * Apply day increment
     C                   MULT      XDWK2         XDIND2
     C     XDINDD        ADD       XDIND2        XDURR
     C                   Z-ADD     0             XDIND2
      * Normalize day increment
     C                   DOW       XDIND2 <= 0
     C                   IF        XDURR = 0
     C                   ADD       XDWK2         XDINM2
      * Normalize updated month
     C                   EXSR      XDNZM
     C                   Z-ADD     XDWK1         XDURR
     C                   ENDIF
     C                   IF        XDURR < 0
     C                   SUB       1             XDINM2
      * Normalize updated month
     C                   EXSR      XDNZM
     C                   ADD       XDWK1         XDURR
     C                   ELSE
     C                   IF        XDURR > XDWK1
     C                   SUB       XDWK1         XDURR
     C                   ADD       1             XDINM2
      * Normalize updated month
     C                   EXSR      XDNZM
     C                   ELSE
     C                   Z-ADD     XDURR         XDIND2
     C                   ENDIF
     C                   ENDIF
     C                   ENDDO
      * Check updated year
     C                   IF        XDINY2 >= 400 OR
     C                             XDINY2 <= 0
     C                   MOVEL     'Y2U0006'     W0RTN
     C                   ENDIF
     C                   IF        W0RTN = 'Y2U0006'
     C                   Z-ADD     0             XDINDT
     C                   ELSE
     C                   Z-ADD     XDINT2        XDINDT
     C                   ENDIF
      *================================================================
     CSR   XDAG2E        ENDSR
      /EJECT
     CSR   XDAMO         BEGSR
      *================================================================
      * Calculate duration, *MONTHS
      *================================================================
      * Transform the *MONTHS format to the *YYMM format.
     C                   DIV       12            XDURR
     C                   MVR                     XDWK1
     C                   MULT      100           XDURR
     C                   ADD       XDWK1         XDURR
      * Check and adjust End Of Month dates, if any.
     C                   EXSR      XDAG1
      * Define increment Mask.
     C                   Z-ADD     1             XDIMYY
     C                   Z-ADD     1             XDIMMM
      * Initiate general DATE INCREMENT calculations.
     C                   EXSR      XDAG2
      *================================================================
     CSR   XDAMOE        ENDSR
      /EJECT
     CSR   XDMNH         BEGSR
      *================================================================
      * Find length(XDWK1) in days for the month passed in XDIN2TS
      *================================================================
     C                   IF        XDINM2 = 4 OR
     C                             XDINM2 = 6 OR
     C                             XDINM2 = 9 OR
     C                             XDINM2 = 11
     C                   Z-ADD     30            XDWK1
     C                   ELSE
     C                   Z-ADD     31            XDWK1
     C                   END
      * Determine February length
     C                   IF        XDINM2 = 2
     C                   IF        XDINY2 = 300 OR
     C                             XDINY2 = 100
     C                   Z-ADD     28            XDWK1
     C                   ELSE
     C     XDINY2        DIV       4             XDWK1
     C                   MVR                     XDWK1
     C                   IF        XDWK1 = 0
     C                   Z-ADD     29            XDWK1
     C                   ELSE
     C                   Z-ADD     28            XDWK1
     C                   END
     C                   END
     C                   END
      *================================================================
     CSR   XDMNHE        ENDSR
      /EJECT
     CSR   XDNZM         BEGSR
      *================================================================
      * Normalize days
      *================================================================
     C                   IF        XDINM2 < 1
     C                   ADD       12            XDINM2
     C                   SUB       1             XDINY2
     C                   ENDIF
     C                   IF        XDINM2 > 12
     C                   SUB       12            XDINM2
     C                   ADD       1             XDINY2
     C                   ENDIF
      * Refresh the length of updated month (returned in XDWK1).
     C                   EXSR      XDMNH
      *================================================================
     CSR   XDNZME        ENDSR
      /EJECT
     CSR   XDOWS         BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                   MOVEA     XDCDW         YDOW
     C                   Z-ADD     0             XDWSL
     C                   Z-ADD     1             YY
     C                   DOW       YY <= 7
     C                   IF        YDOW(YY) = XDSEL
     C                   ADD       1             XDWSL
     C                   END
     C                   ADD       1             YY
     C                   END
      *================================================================
     CSR   XDOWSE        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAHQNZ                         Surrogate Numbe
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAMJDT                         Create Date
     C                   Z-ADD     *ZERO         WABETM                         Create Time
     C                   Z-ADD     *ZERO         WAMKDT                         Change Date
     C                   Z-ADD     *ZERO         WABFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBHQNZ                         Surrogate Numbe
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBMJDT                         Create Date
     C                   Z-ADD     *ZERO         WBBETM                         Create Time
     C                   Z-ADD     *ZERO         WBMKDT                         Change Date
     C                   Z-ADD     *ZERO         WBBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCXXTM                         Departure Time
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WDP3NB                         D_B Number
     C                   Z-ADD     *ZERO         WDI6DT                         Date of D_B Rat
     C                   Z-ADD     *ZERO         WDAYDT                         Credit Line Exp
     C                   Z-ADD     *ZERO         WDANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WDBTC7                         Parent Customer
     C                   Z-ADD     *ZERO         WDS2NB                         Parent Credit L
     C                   Z-ADD     *ZERO         WDVHVA                         AR Credit Limit
     C                   Z-ADD     *ZERO         WDI7DT                         Order Entry Hol
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WEAAC8                         Customer G_L Ve
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WGGBNZ                         CEXT2 Unused Nb
     C                   Z-ADD     *ZERO         WGFCNZ                         CEXT2 Unused Nb
     C                   Z-ADD     *ZERO         WGXKDT                         CEXT2 Unused Dt
     C                   Z-ADD     *ZERO         WGEPTM                         CEXT2 Unused Tm
     C                   Z-ADD     *ZERO         WGGANZ                         Cust Dft Age Da
     C                   Z-ADD     *ZERO         WGEOTM                         Cust Dft Delive
     C                   Z-ADD     *ZERO         WGMJDT                         Create Date
     C                   Z-ADD     *ZERO         WGBETM                         Create Time
     C                   Z-ADD     *ZERO         WGMKDT                         Change Date
     C                   Z-ADD     *ZERO         WGBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WHAATM                         Job Time
     C                   Z-ADD     *ZERO         WHAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WIDBNB                         Warehouse Chill
     C                   Z-ADD     *ZERO         WIBWC3                         Shipping Compan
     C                   Z-ADD     *ZERO         WIBTC3                         Accounting Comp
     C                   Z-ADD     *ZERO         WIBUC3                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WIBVC3                         WHS Inventory C
     C                   Z-ADD     *ZERO         WIAATM                         Job Time
     C                   Z-ADD     *ZERO         WIAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WKAIC3                         Company Number
     C                   Z-ADD     *ZERO         WKM8NB                         System Value Nu
     C                   Z-ADD     *ZERO         WKAATM                         Job Time
     C                   Z-ADD     *ZERO         WKAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WLAIC3                         Company Number
     C                   Z-ADD     *ZERO         WLBCDT                         Post to G_L Dat
     C                   Z-ADD     *ZERO         WLCQNB                         Julian Date
     C                   Z-ADD     *ZERO         WLESNB                         Accounting Year
     C                   Z-ADD     *ZERO         WLETNB                         Accounting Peri
     C                   Z-ADD     *ZERO         WLBZNB                         OM Week
     C                   Z-ADD     *ZERO         WLEINB                         Week Number
     C                   Z-ADD     *ZERO         WLAQNB                         Billing Cycle
     C                   Z-ADD     *ZERO         WLOJDT                         HPS PIC Date
     C                   Z-ADD     *ZERO         WLNQNX                         HPS Calendar Ye
     C                   Z-ADD     *ZERO         WLNRNX                         HPS Calendar We
     C                   Z-ADD     *ZERO         WLOKDT                         Calendar Unused
     C                   Z-ADD     *ZERO         WLOLDT                         Calendar Unused
     C                   Z-ADD     *ZERO         WLAATM                         Job Time
     C                   Z-ADD     *ZERO         WLAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WMHQNZ                         Surrogate Numbe
     C                   Z-ADD     *ZERO         WMDXNB                         Sequence Number
     C                   Z-ADD     *ZERO         WMC4NB                         Order Number
     C                   Z-ADD     *ZERO         WMHGCD                         Item Code
     C                   Z-ADD     *ZERO         WMACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WMAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WMRINY                         Item Age Days
     C                   Z-ADD     *ZERO         WMEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WMBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WMA1AA                         Ham Group Numbe
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(070)      XDTSDL
     C                   MOVEL     XDTSDL        WMBGTS                         Create Date Tim
     C                   MOVEL     XDTSDL        WMBHTS                         Update Date Tim
      * Define work field Error Flag            USR
     C                   EVAL      WUB8SX = ' '
      * Define work field Error Reason Descript 1
     C                   EVAL      WUKWTX = ' '
      * Define work field Error Reason Descript 2
     C                   EVAL      WUKXTX = ' '
      * Define work field Error Reason Descript 3
     C                   EVAL      WUKYTX = ' '
      * Define work field Error Reason Descript 4
     C                   EVAL      WUKZTX = ' '
      * Define work field Error Reason Descript 5
     C                   EVAL      WUTITX = ' '
      * Define work field Blank for 30          USR
     C                   EVAL      WUW4TX = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WOAIC3                         Company Number
     C                   Z-ADD     *ZERO         WOHGCD                         Item Code
     C                   Z-ADD     *ZERO         WOAWPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WOAXPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WOAIWG                         Unit Weight
     C                   Z-ADD     *ZERO         WOCZWG                         Minimum Weight
     C                   Z-ADD     *ZERO         WOC0WG                         Maximum Weight
     C                   Z-ADD     *ZERO         WOURTN                         Number Cases On
     C                   Z-ADD     *ZERO         WOAJC8                         Vendor Item Def
     C                   Z-ADD     *ZERO         WORINB                         Item Structure
     C                   Z-ADD     *ZERO         WORHNB                         Item Structure
     C                   Z-ADD     *ZERO         WORGNB                         Item Structure
     C                   Z-ADD     *ZERO         WOTFNB                         Transportation
     C                   Z-ADD     *ZERO         WOTMVA                         Maximum Audit V
     C                   Z-ADD     *ZERO         WOTNVA                         Minimum Audit V
     C                   Z-ADD     *ZERO         WOBLPR                         Market Overage
     C                   Z-ADD     *ZERO         WOBMPR                         Standard Overag
     C                   Z-ADD     *ZERO         WOCMCO                         Item Pricing Co
     C                   Z-ADD     *ZERO         WOCHTM                         Fresh Chilling
     C                   Z-ADD     *ZERO         WOSWGH                         Std Weight_Head
     C                   Z-ADD     *ZERO         WOPPHE                         Pieces Per Head
     C                   Z-ADD     *ZERO         WOICN1                         Item Category N
     C                   Z-ADD     *ZERO         WOICN2                         Item Category N
     C                   Z-ADD     *ZERO         WOV2NB                         Item Category N
     C                   Z-ADD     *ZERO         WOITCN                         Item Category N
     C                   Z-ADD     *ZERO         WOITC5                         Item Category N
     C                   Z-ADD     *ZERO         WOICN6                         Item Category N
     C                   Z-ADD     *ZERO         WOICN7                         Item Category N
     C                   Z-ADD     *ZERO         WOICN8                         Item Category N
     C                   Z-ADD     *ZERO         WOICN9                         Item Category N
     C                   Z-ADD     *ZERO         WOICN0                         Item Category N
     C                   Z-ADD     *ZERO         WOSFNB                         Pallet Tare Wei
     C                   Z-ADD     *ZERO         WOA3WG                         Misc Tare Weigh
     C                   Z-ADD     *ZERO         WOSJNB                         Production Lead
     C                   Z-ADD     *ZERO         WOSKNB                         Agrimetrics gro
     C                   Z-ADD     *ZERO         WOSLNB                         Agrimetrics pac
     C                   Z-ADD     *ZERO         WOSMNB                         Agrimetrics gra
     C                   Z-ADD     *ZERO         WOCFNB                         PM Pounds per H
     C                   Z-ADD     *ZERO         WOCGNB                         Item Frt Overag
     C                   Z-ADD     *ZERO         WOILNB                         Packages per ca
     C                   Z-ADD     *ZERO         WOCHNB                         Use_Freeze_Sell
     C                   Z-ADD     *ZERO         WOCINB                         PM Batch Size
     C                   Z-ADD     *ZERO         WOCJNB                         Package Level s
     C                   Z-ADD     *ZERO         WOCMNB                         Partial Item Co
     C                   Z-ADD     *ZERO         WOCNNB                         WIP Item Code
     C                   Z-ADD     *ZERO         WOCRNB                         WIP Reject Code
     C                   Z-ADD     *ZERO         WOCSNB                         Std Costing Uni
     C                   Z-ADD     *ZERO         WOCVNB                         FP Std Green We
     C                   Z-ADD     *ZERO         WOCWNB                         PM Std LBS Man
     C                   Z-ADD     *ZERO         WOCXNB                         PM Raw Meat LBS
     C                   Z-ADD     *ZERO         WOCZNB                         PM Formula LBS
     C                   Z-ADD     *ZERO         WOC0NB                         PM Finished LBS
     C                   Z-ADD     *ZERO         WOB4NB                         PM Raw Material
     C                   Z-ADD     *ZERO         WOB5NB                         PM Line Number
     C                   Z-ADD     *ZERO         WOBDNB                         Pieces Per Bag
     C                   Z-ADD     *ZERO         WOBJNB                         Bags Per Unit
     C                   Z-ADD     *ZERO         WOF5WG                         Item Target Pri
     C                   Z-ADD     *ZERO         WOF6WG                         Minimum Piece W
     C                   Z-ADD     *ZERO         WOF7WG                         Maximum Piece W
     C                   Z-ADD     *ZERO         WOBLNB                         Seaboard Equiva
     C                   Z-ADD     *ZERO         WOBNNB                         Production Qty
     C                   Z-ADD     *ZERO         WOAATM                         Job Time
     C                   Z-ADD     *ZERO         WOAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WRA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WRDPC7                         Ham Group Item
     C                   Z-ADD     *ZERO         WRJJNX                         Ham Group Item
     C                   Z-ADD     *ZERO         WRAATM                         Job Time
     C                   Z-ADD     *ZERO         WRAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WSAIC3                         Company Number
     C                   Z-ADD     *ZERO         WSBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WSR5NB                         Deliver after t
     C                   Z-ADD     *ZERO         WSR6NB                         Deliver before
     C                   Z-ADD     *ZERO         WSTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WSMTCU                         Mileage To Cust
     C                   Z-ADD     *ZERO         WSW2NB                         Co_Cust Overage
     C                   Z-ADD     *ZERO         WSAATM                         Job Time
     C                   Z-ADD     *ZERO         WSAXDT                         Job Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Define work field Price Start Date
     C                   Z-ADD     *ZERO         WUPLDT
      * Define work field Price End Date
     C                   Z-ADD     *ZERO         WUPMDT
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WTAIC3                         Company Number
     C                   Z-ADD     *ZERO         WTRMNY                         Decimal Places
     C                   Z-ADD     *ZERO         WTAATM                         Job Time
     C                   Z-ADD     *ZERO         WTAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WVAIC3                         Company Number
     C                   Z-ADD     *ZERO         WVAXNB                         Current Account
     C                   Z-ADD     *ZERO         WVNGNB                         Current Account
     C                   Z-ADD     *ZERO         WVBZNB                         OM Week
     C                   Z-ADD     *ZERO         WVC5NB                         Next Order Numb
     C                   Z-ADD     *ZERO         WVC3NB                         Next Invoice Nu
     C                   Z-ADD     *ZERO         WVCYNB                         Next Credit Mem
     C                   Z-ADD     *ZERO         WVIONB                         Next Charge Bac
     C                   Z-ADD     *ZERO         WVI6NB                         Next On Acct Ca
     C                   Z-ADD     *ZERO         WVDCNB                         Next Voucher Nu
     C                   Z-ADD     *ZERO         WVC7NB                         Next Customer #
     C                   Z-ADD     *ZERO         WVC2NB                         Next Inventory
     C                   Z-ADD     *ZERO         WVC1NB                         Next PFS Batch
     C                   Z-ADD     *ZERO         WVL8NB                         Next Contract_P
     C                   Z-ADD     *ZERO         WVBANB                         Next HPB Batch
     C                   Z-ADD     *ZERO         WVAIPC                         Manual Price Ac
     C                   Z-ADD     *ZERO         WVASPC                         CoPk_FdSrv ManP
     C                   Z-ADD     *ZERO         WVA2VA                         Late Charge Min
     C                   Z-ADD     *ZERO         WVAADY                         A_P Aging Days_
     C                   Z-ADD     *ZERO         WVABDY                         A_P Aging Days_
     C                   Z-ADD     *ZERO         WVACDY                         A_P Aging Days_
     C                   Z-ADD     *ZERO         WVADDY                         A_P Aging Days_
     C                   Z-ADD     *ZERO         WVAEDY                         A_R Aging Days_
     C                   Z-ADD     *ZERO         WVAFDY                         A_R Aging Days_
     C                   Z-ADD     *ZERO         WVAGDY                         A_R Aging Days_
     C                   Z-ADD     *ZERO         WVAHDY                         A_R Aging Days_
     C                   Z-ADD     *ZERO         WVAENB                         Retention Perio
     C                   Z-ADD     *ZERO         WVALNB                         Retention Perio
     C                   Z-ADD     *ZERO         WVEVNB                         Retention Perio
     C                   Z-ADD     *ZERO         WVRPOP                         Retention Perio
     C                   Z-ADD     *ZERO         WVDWNB                         Retention Perio
     C                   Z-ADD     *ZERO         WVR3NB                         Next Load ID
     C                   Z-ADD     *ZERO         WVR4NB                         Next Item Numbe
     C                   Z-ADD     *ZERO         WVSCNB                         Production Numb
     C                   Z-ADD     *ZERO         WVAATM                         Job Time
     C                   Z-ADD     *ZERO         WVAXDT                         Job Date
      * Define work field USR Date Priced
     C                   Z-ADD     *ZERO         WUE7DT
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WWEQDT                         Market Price Da
     C                   Z-ADD     *ZERO         WWA5PR                         Commodity Marke
     C                   Z-ADD     *ZERO         WWB8PR                         Projected Marke
     C                   Z-ADD     *ZERO         WWAATM                         Job Time
     C                   Z-ADD     *ZERO         WWAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WXAIC3                         Company Number
     C                   Z-ADD     *ZERO         WXCPRD                         CTL Prior Day
     C                   Z-ADD     *ZERO         WXQMNB                         CTL Prior Week
     C                   Z-ADD     *ZERO         WXCNOT                         CTL Number of T
     C                   Z-ADD     *ZERO         WXCDOW                         CTL Day of Week
     C                   Z-ADD     *ZERO         WXAATM                         Job Time
     C                   Z-ADD     *ZERO         WXAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         TBHQNZ                         Surrogate Numbe
     C                   Z-ADD     *ZERO         TBDXNB                         Sequence Number
     C                   Z-ADD     *ZERO         TBC4NB                         Order Number
      * Clear all neither parameters
      * Crt Block Order Trans CR - WF Block Order Trans  * 
     C                   Z-ADD     *ZERO         TCMJDT                         Create Date
     C                   Z-ADD     *ZERO         TCBETM                         Create Time
     C                   Z-ADD     *ZERO         TCMKDT                         Change Date
     C                   Z-ADD     *ZERO         TCBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         TDAIC3                         Company Number
     C                   Z-ADD     *ZERO         TDC4NB                         Order Number
     C                   Z-ADD     *ZERO         TDANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         TDBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         TDB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         TDA0DT                         Order Date
     C                   Z-ADD     *ZERO         TDA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         TDGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         TDACDT                         Cancel Date
     C                   Z-ADD     *ZERO         TDAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         TDCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         TDJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         TDA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         TDEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         TDAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         TDRMNB                         Load ID
     C                   Z-ADD     *ZERO         TDTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         TDR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         TDRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         TDATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         TDRSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         TDT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         TDCONB                         Invoice Number
     C                   Z-ADD     *ZERO         TDAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         TDVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         TDB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         TDNODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         TDNPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         TDNQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         TDNRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         TDNSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         TDBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         TDBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         TDBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         TDBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         TDBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         TDH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         TDH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         TDH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         TDH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         TDH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         TDC0C7                         Claim Number
     C                   Z-ADD     *ZERO         TDAATM                         Job Time
     C                   Z-ADD     *ZERO         TDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         TEAIC3                         Company Number
     C                   Z-ADD     *ZERO         TEC4NB                         Order Number
     C                   Z-ADD     *ZERO         TEDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         TEUENB                         Order Secondary
     C                   Z-ADD     *ZERO         TEHGCD                         Item Code
     C                   Z-ADD     *ZERO         TEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         TECFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         TEMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         TEKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         TEL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         TEL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         TEAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         TEEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         TEBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         TEL6NB                         Contract Number
     C                   Z-ADD     *ZERO         TEGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         TER1NB                         Rated Freight
     C                   Z-ADD     *ZERO         TEAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         TED0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         TECCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         TEAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         TECBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         TEATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         TEAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         TEAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         TEAKPR                         Unit Price
     C                   Z-ADD     *ZERO         TEALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         TEAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         TEAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         TEA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         TEA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         TEAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         TEGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         TERGNB                         Item Structure
     C                   Z-ADD     *ZERO         TERHNB                         Item Structure
     C                   Z-ADD     *ZERO         TERINB                         Item Structure
     C                   Z-ADD     *ZERO         TECXDT                         Date of Origina
     C                   Z-ADD     *ZERO         TEDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         TEB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         TEA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         TENTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         TENUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         TENVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         TENWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         TENXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         TEBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         TEBVTM                         Price Code
     C                   Z-ADD     *ZERO         TEBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         TEBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         TEBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         TEH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         TEH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         TEH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         TEH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         TEH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         TEDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         TEDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         TEDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         TEDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         TEDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         TEGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         TEGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         TEGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         TEPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         TERINY                         Item Age Days
     C                   Z-ADD     *ZERO         TETIDT                         Production Ovr
     C                   Z-ADD     *ZERO         TETJDT                         Production Ovr
     C                   Z-ADD     *ZERO         TETKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         TETLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         TETMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         TEAATM                         Job Time
     C                   Z-ADD     *ZERO         TEAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         THAIC3                         Company Number
     C                   Z-ADD     *ZERO         THC4NB                         Order Number
     C                   Z-ADD     *ZERO         THDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         THUENB                         Order Secondary
     C                   Z-ADD     *ZERO         THDIC7                         ED Item Code
     C                   Z-ADD     *ZERO         THHJWG                         ED Product Net
     C                   Z-ADD     *ZERO         THHKWG                         ED Product Net
     C                   Z-ADD     *ZERO         THAONX                         ED Product Nbr
     C                   Z-ADD     *ZERO         THAMNX                         ED Pieces per B
     C                   Z-ADD     *ZERO         THANNX                         ED Bags per Uni
     C                   Z-ADD     *ZERO         THAPNX                         ED Total Nbr of
     C                   Z-ADD     *ZERO         THDKPR                         ED Product Unit
     C                   Z-ADD     *ZERO         THA9VL                         ED Producet Ext
     C                   Z-ADD     *ZERO         THAJNX                         ED Consignee Ad
     C                   Z-ADD     *ZERO         THW0DT                         ED Nbr of Packi
     C                   Z-ADD     *ZERO         THAATM                         Job Time
     C                   Z-ADD     *ZERO         THAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         TMRMNB                         Load ID
     C                   Z-ADD     *ZERO         TMAIC3                         Company Number
     C                   Z-ADD     *ZERO         TMAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         TMRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         TMRPNB                         Total Load Orde
     C                   Z-ADD     *ZERO         TMFLAM                         Flat Amount
     C                   Z-ADD     *ZERO         TMRRNB                         Total Stops
     C                   Z-ADD     *ZERO         TMSBNB                         BOL Time
     C                   Z-ADD     *ZERO         TMSQNB                         Ld Hdr_Ld Dtl U
     C                   Z-ADD     *ZERO         TMR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         TMSDNB                         Number Pallets
     C                   Z-ADD     *ZERO         TMPAOU                         Number Pallets
     C                   Z-ADD     *ZERO         TMDGWG                         Load Carrier Pa
     C                   Z-ADD     *ZERO         TMSXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         TMHADT                         Actual Arrival
     C                   Z-ADD     *ZERO         TMAART                         Actual Arrival
     C                   Z-ADD     *ZERO         TMDHWG                         Trailer IN Weig
     C                   Z-ADD     *ZERO         TMDIWG                         Trailer OUT Wei
     C                   Z-ADD     *ZERO         TMAQDT                         Actual Departur
     C                   Z-ADD     *ZERO         TMS6NB                         Departure Time
     C                   Z-ADD     *ZERO         TMT4NB                         Schedule Sequen
     C                   Z-ADD     *ZERO         TMPRTM                         Product Tempera
     C                   Z-ADD     *ZERO         TMNPSV                         Number Spacers
     C                   Z-ADD     *ZERO         TMTLMI                         Total Load Mile
     C                   Z-ADD     *ZERO         TMGRWE                         Gross Weight
     C                   Z-ADD     *ZERO         TMF9DT                         Actual Ship Dat
     C                   Z-ADD     *ZERO         TMJ4DT                         Truck Ready Dat
     C                   Z-ADD     *ZERO         TMTRTM                         Truck Ready Tim
     C                   Z-ADD     *ZERO         TMJ5DT                         Spotted Date
     C                   Z-ADD     *ZERO         TMSPTM                         Spotted Time
     C                   Z-ADD     *ZERO         TMJ6DT                         Load Finished D
     C                   Z-ADD     *ZERO         TMLFTM                         Load Finished T
     C                   Z-ADD     *ZERO         TMJ7DT                         BOL Complete Da
     C                   Z-ADD     *ZERO         TMBOTM                         BOL Complete Ti
     C                   Z-ADD     *ZERO         TMJ8DT                         BOL Received Da
     C                   Z-ADD     *ZERO         TMBLTM                         BOL Received Ti
     C                   Z-ADD     *ZERO         TMKIDT                         Truck Departure
     C                   Z-ADD     *ZERO         TMASTM                         Truck Departure
     C                   Z-ADD     *ZERO         TMKADT                         Adjusted Depart
     C                   Z-ADD     *ZERO         TMAJCM                         Adjusted Depart
     C                   Z-ADD     *ZERO         TMVOAG                         Voyage
     C                   Z-ADD     *ZERO         TMKBDT                         Sail Date
     C                   Z-ADD     *ZERO         TMEFDT                         Arrival Date
     C                   Z-ADD     *ZERO         TMKCDT                         Date In
     C                   Z-ADD     *ZERO         TMTMIN                         Time In
     C                   Z-ADD     *ZERO         TMKDDT                         Date Out
     C                   Z-ADD     *ZERO         TMVMNB                         Time Out
     C                   Z-ADD     *ZERO         TMOCFR                         Load Total Frei
     C                   Z-ADD     *ZERO         TMKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         TMATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         TMBRBK                         Bring Back Mile
     C                   Z-ADD     *ZERO         TMEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         TMKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         TMAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         TMKZDT                         Deadline Depart
     C                   Z-ADD     *ZERO         TMAXTM                         Deadline Depart
     C                   Z-ADD     *ZERO         TMLLDT                         Express Mail Da
     C                   Z-ADD     *ZERO         TMK0DT                         Product Complet
     C                   Z-ADD     *ZERO         TMAYTM                         Product Complet
     C                   Z-ADD     *ZERO         TMKNNX                         Pallets Loaded
     C                   Z-ADD     *ZERO         TMICWG                         Avg Pallet Tare
     C                   Z-ADD     *ZERO         TMIDWG                         Tot Pallet Tare
     C                   Z-ADD     *ZERO         TMK1DT                         Load Confirmati
     C                   Z-ADD     *ZERO         TMAZTM                         Load Door 1
     C                   Z-ADD     *ZERO         TMK2DT                         Override Total
     C                   Z-ADD     *ZERO         TMA0TM                         Load Door 2
     C                   Z-ADD     *ZERO         TMZBVA                         Load Actual Fre
     C                   Z-ADD     *ZERO         TMPYDT                         LH Carrier Paid
     C                   Z-ADD     *ZERO         TMCKTM                         LH Carrier Paid
     C                   Z-ADD     *ZERO         TMPZDT                         LH Last Combo P
     C                   Z-ADD     *ZERO         TMCLTM                         LH Last Combo P
     C                   Z-ADD     *ZERO         TMP0DT                         LPT Load Plan S
     C                   Z-ADD     *ZERO         TMCMTM                         LPT Load Plan S
     C                   Z-ADD     *ZERO         TMP1DT                         TPM Planned Shi
     C                   Z-ADD     *ZERO         TMCNTM                         LH Unused Time
     C                   Z-ADD     *ZERO         TMP2DT                         LH Unused Date
     C                   Z-ADD     *ZERO         TMCOTM                         LH Unused Time
     C                   Z-ADD     *ZERO         TMP3DT                         LH Unused Date
     C                   Z-ADD     *ZERO         TMCQTM                         LH Unused Time
     C                   Z-ADD     *ZERO         TMAATM                         Job Time
     C                   Z-ADD     *ZERO         TMAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         TRM8NB                         System Value Nu
     C                   Z-ADD     *ZERO         TRAATM                         Job Time
     C                   Z-ADD     *ZERO         TRAXDT                         Job Date
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        W0WB01                         *Synon (15,5) w
     C                   Z-ADD     *ZEROS        W0WB02                         *Synon (15,5) w
     C                   Z-ADD     *ZEROS        W0WB00                         *Synon (15,5) w
     C                   Z-ADD     *ZEROS        W0WD02                         *Synon (17,7) w
     C                   Z-ADD     *ZEROS        W0WD01                         *Synon (17,7) w
     C                   Z-ADD     *ZEROS        W0WD00                         *Synon (17,7) w
     C                   Z-ADD     *ZEROS        W0WA01                         *Synon (15,2) w
     C                   Z-ADD     *ZEROS        W0WA00                         *Synon (15,2) w
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SGRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   EVAL      WL0002 = ' '
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   EVAL      WL0005 = ' '
     C                   EVAL      WL0006 = ' '
     C                   EVAL      WL0007 = ' '
     C                   EVAL      WL0008 = ' '
     C                   Z-ADD     *ZERO         WL0009
     C                   Z-ADD     *ZERO         WL0010
      * Define local variables for subroutine SHRVGN.
     C                   EVAL      WL0011 = ' '
     C                   EVAL      WL0012 = ' '
      * Define local variables for subroutine SJRVGN.
     C                   EVAL      WL0013 = ' '
     C                   EVAL      WL0014 = ' '
     C                   EVAL      WL0015 = ' '
     C                   EVAL      WL0016 = ' '
     C                   EVAL      WL0017 = ' '
     C                   EVAL      WL0018 = ' '
     C                   EVAL      WL0019 = ' '
     C                   EVAL      WL0020 = ' '
     C                   EVAL      WL0021 = ' '
     C                   EVAL      WL0022 = ' '
     C                   EVAL      WL0023 = ' '
     C                   EVAL      WL0024 = ' '
     C                   EVAL      WL0025 = ' '
     C                   EVAL      WL0026 = ' '
     C                   EVAL      WL0027 = ' '
     C                   Z-ADD     *ZERO         WL0028
     C                   EVAL      WL0029 = ' '
     C                   EVAL      WL0030 = ' '
     C                   EVAL      WL0031 = ' '
     C                   EVAL      WL0032 = ' '
     C                   Z-ADD     *ZERO         WL0033
     C                   Z-ADD     *ZERO         WL0034
     C                   Z-ADD     *ZERO         WL0035
     C                   Z-ADD     *ZERO         WL0036
     C                   EVAL      WL0037 = ' '
     C                   EVAL      WL0038 = ' '
     C                   EVAL      WL0039 = ' '
     C                   EVAL      WL0040 = ' '
     C                   EVAL      WL0041 = ' '
     C                   EVAL      WL0042 = ' '
     C                   EVAL      WL0043 = ' '
     C                   EVAL      WL0044 = ' '
     C                   EVAL      WL0045 = ' '
     C                   EVAL      WL0046 = ' '
     C                   EVAL      WL0047 = ' '
     C                   EVAL      WL0048 = ' '
     C                   EVAL      WL0049 = ' '
     C                   EVAL      WL0050 = ' '
      * Define local variables for subroutine SMRVGN.
     C                   Z-ADD     *ZERO         WL0051
     C                   Z-ADD     *ZERO         WL0052
      * Define local variables for subroutine SORVGN.
     C                   Z-ADD     *ZERO         WL0053
     C                   Z-ADD     *ZERO         WL0054
     C                   EVAL      WL0055 = ' '
      * Define local variables for subroutine SPRVGN.
     C                   Z-ADD     *ZERO         WL0056
     C                   Z-ADD     *ZERO         WL0057
      * Define local variables for subroutine SQRVGN.
     C                   Z-ADD     *ZERO         WL0058
     C                   Z-ADD     *ZERO         WL0059
     C                   EVAL      WL0060 = ' '
     C                   EVAL      WL0061 = ' '
     C                   EVAL      WL0062 = ' '
     C                   EVAL      WL0063 = ' '
     C                   EVAL      WL0064 = ' '
     C                   EVAL      WL0065 = ' '
     C                   EVAL      WL0066 = ' '
     C                   Z-ADD     *ZERO         WL0067
     C                   Z-ADD     *ZERO         WL0068
     C                   EVAL      WL0069 = ' '
     C                   EVAL      WL0070 = ' '
     C                   Z-ADD     *ZERO         WL0071
     C                   Z-ADD     *ZERO         WL0072
     C                   Z-ADD     *ZERO         WL0073
     C                   EVAL      WL0074 = ' '
     C                   EVAL      WL0075 = ' '
     C                   EVAL      WL0076 = ' '
     C                   EVAL      WL0077 = ' '
     C                   EVAL      WL0078 = ' '
     C                   EVAL      WL0079 = ' '
     C                   EVAL      WL0080 = ' '
     C                   EVAL      WL0081 = ' '
     C                   EVAL      WL0082 = ' '
     C                   EVAL      WL0083 = ' '
     C                   EVAL      WL0084 = ' '
     C                   EVAL      WL0085 = ' '
     C                   EVAL      WL0086 = ' '
     C                   EVAL      WL0087 = ' '
     C                   EVAL      WL0088 = ' '
     C                   EVAL      WL0089 = ' '
     C                   EVAL      WL0090 = ' '
     C                   EVAL      WL0091 = ' '
     C                   EVAL      WL0092 = ' '
     C                   EVAL      WL0093 = ' '
     C                   EVAL      WL0094 = ' '
     C                   EVAL      WL0095 = ' '
     C                   EVAL      WL0096 = ' '
     C                   Z-ADD     *ZERO         WL0097
     C                   EVAL      WL0098 = ' '
     C                   EVAL      WL0099 = ' '
     C                   Z-ADD     *ZERO         WL0100
      * Define local variables for subroutine SRRVGN.
     C                   Z-ADD     *ZERO         WL0101
     C                   EVAL      WL0102 = ' '
     C                   EVAL      WL0103 = ' '
     C                   EVAL      WL0104 = ' '
      * Define local variables for subroutine SSRVGN.
     C                   Z-ADD     *ZERO         WL0105
     C                   Z-ADD     *ZERO         WL0106
     C                   Z-ADD     *ZERO         WL0107
      * Define local variables for subroutine STRVGN.
     C                   EVAL      WL0108 = ' '
     C                   EVAL      WL0109 = ' '
     C                   Z-ADD     *ZERO         WL0110
     C                   Z-ADD     *ZERO         WL0111
     C                   Z-ADD     *ZERO         WL0112
      * Define local variables for subroutine SURVGN.
     C                   Z-ADD     *ZERO         WL0113
     C                   EVAL      WL0114 = ' '
     C                   EVAL      WL0115 = ' '
     C                   EVAL      WL0116 = ' '
      * Define local variables for subroutine SVRVGN.
     C                   EVAL      WL0117 = ' '
     C                   EVAL      WL0118 = ' '
      * Define local variables for subroutine SWCHRC.
     C                   Z-ADD     *ZERO         WL0119
     C                   Z-ADD     *ZERO         WL0120
     C                   Z-ADD     *ZERO         WL0121
     C                   EVAL      WL0122 = ' '
     C                   Z-ADD     *ZERO         WL0123
     C                   EVAL      WL0124 = ' '
     C                   Z-ADD     *ZERO         WL0125
     C                   Z-ADD     *ZERO         WL0126
     C                   EVAL      WL0127 = ' '
     C                   EVAL      WL0128 = ' '
     C                   EVAL      WL0129 = ' '
     C                   EVAL      WL0130 = ' '
     C                   EVAL      WL0131 = ' '
     C                   EVAL      WL0132 = ' '
     C                   EVAL      WL0133 = ' '
     C                   EVAL      WL0134 = ' '
     C                   EVAL      WL0135 = ' '
     C                   Z-ADD     *ZERO         WL0136
     C                   EVAL      WL0137 = ' '
     C                   EVAL      WL0138 = ' '
     C                   Z-ADD     *ZERO         WL0139
     C                   EVAL      WL0140 = ' '
     C                   EVAL      WL0141 = ' '
     C                   Z-ADD     *ZERO         WL0142
     C                   Z-ADD     *ZERO         WL0143
     C                   EVAL      WL0144 = ' '
     C                   EVAL      WL0145 = ' '
     C                   Z-ADD     *ZERO         WL0146
     C                   Z-ADD     *ZERO         WL0147
     C                   EVAL      WL0148 = ' '
     C                   EVAL      WL0149 = ' '
      * Define local variables for subroutine TARVGN.
     C                   Z-ADD     *ZERO         WL0150
     C                   Z-ADD     *ZERO         WL0151
     C                   EVAL      WL0152 = ' '
     C                   Z-ADD     *ZERO         WL0153
     C                   Z-ADD     *ZERO         WL0154
     C                   EVAL      WL0155 = ' '
     C                   EVAL      WL0156 = ' '
     C                   EVAL      WL0157 = ' '
     C                   EVAL      WL0158 = ' '
     C                   EVAL      WL0159 = ' '
     C                   EVAL      WL0160 = ' '
     C                   EVAL      WL0161 = ' '
     C                   Z-ADD     *ZERO         WL0162
     C                   EVAL      WL0163 = ' '
     C                   EVAL      WL0164 = ' '
     C                   EVAL      WL0165 = ' '
     C                   EVAL      WL0166 = ' '
     C                   EVAL      WL0167 = ' '
     C                   EVAL      WL0168 = ' '
     C                   EVAL      WL0169 = ' '
     C                   EVAL      WL0170 = ' '
     C                   Z-ADD     *ZERO         WL0171
     C                   Z-ADD     *ZERO         WL0172
     C                   Z-ADD     *ZERO         WL0173
     C                   Z-ADD     *ZERO         WL0174
     C                   EVAL      WL0175 = ' '
     C                   EVAL      WL0176 = ' '
     C                   EVAL      WL0177 = ' '
     C                   EVAL      WL0178 = ' '
     C                   EVAL      WL0179 = ' '
     C                   EVAL      WL0180 = ' '
     C                   EVAL      WL0181 = ' '
     C                   EVAL      WL0182 = ' '
     C                   EVAL      WL0183 = ' '
     C                   EVAL      WL0184 = ' '
     C                   EVAL      WL0185 = ' '
     C                   EVAL      WL0186 = ' '
     C                   EVAL      WL0187 = ' '
     C                   Z-ADD     *ZERO         WL0188
     C                   EVAL      WL0189 = ' '
     C                   Z-ADD     *ZERO         WL0190
     C                   Z-ADD     *ZERO         WL0191
     C                   Z-ADD     *ZERO         WL0192
     C                   EVAL      WL0193 = ' '
     C                   EVAL      WL0194 = ' '
     C                   EVAL      WL0195 = ' '
     C                   Z-ADD     *ZERO         WL0196
     C                   Z-ADD     *ZERO         WL0197
     C                   EVAL      WL0198 = ' '
     C                   EVAL      WL0199 = ' '
     C                   Z-ADD     *ZERO         WL0200
     C                   Z-ADD     *ZERO         WL0201
     C                   Z-ADD     *ZERO         WL0202
     C                   EVAL      WL0203 = ' '
     C                   EVAL      WL0204 = ' '
     C                   EVAL      WL0205 = ' '
     C                   EVAL      WL0206 = ' '
     C                   EVAL      WL0207 = ' '
     C                   EVAL      WL0208 = ' '
     C                   EVAL      WL0209 = ' '
     C                   EVAL      WL0210 = ' '
     C                   EVAL      WL0211 = ' '
     C                   Z-ADD     *ZERO         WL0212
     C                   EVAL      WL0213 = ' '
     C                   Z-ADD     *ZERO         WL0214
     C                   EVAL      WL0215 = ' '
     C                   EVAL      WL0216 = ' '
     C                   Z-ADD     *ZERO         WL0217
     C                   EVAL      WL0218 = ' '
     C                   EVAL      WL0219 = ' '
     C                   EVAL      WL0220 = ' '
     C                   EVAL      WL0221 = ' '
     C                   EVAL      WL0222 = ' '
     C                   EVAL      WL0223 = ' '
     C                   Z-ADD     *ZERO         WL0224
     C                   EVAL      WL0225 = ' '
     C                   Z-ADD     *ZERO         WL0226
     C                   EVAL      WL0227 = ' '
     C                   Z-ADD     *ZERO         WL0228
     C                   EVAL      WL0229 = ' '
     C                   EVAL      WL0230 = ' '
     C                   EVAL      WL0231 = ' '
     C                   Z-ADD     *ZERO         WL0232
     C                   EVAL      WL0233 = ' '
     C                   EVAL      WL0234 = ' '
     C                   EVAL      WL0235 = ' '
     C                   Z-ADD     *ZERO         WL0236
     C                   EVAL      WL0237 = ' '
     C                   EVAL      WL0238 = ' '
     C                   EVAL      WL0239 = ' '
     C                   EVAL      WL0240 = ' '
     C                   EVAL      WL0241 = ' '
     C                   EVAL      WL0242 = ' '
     C                   EVAL      WL0243 = ' '
     C                   EVAL      WL0244 = ' '
     C                   EVAL      WL0245 = ' '
     C                   EVAL      WL0246 = ' '
     C                   EVAL      WL0247 = ' '
     C                   EVAL      WL0248 = ' '
     C                   EVAL      WL0249 = ' '
     C                   EVAL      WL0250 = ' '
     C                   EVAL      WL0251 = ' '
     C                   EVAL      WL0252 = ' '
     C                   Z-ADD     *ZERO         WL0253
     C                   Z-ADD     *ZERO         WL0254
     C                   Z-ADD     *ZERO         WL0255
     C                   Z-ADD     *ZERO         WL0256
     C                   Z-ADD     *ZERO         WL0257
     C                   Z-ADD     *ZERO         WL0258
     C                   Z-ADD     *ZERO         WL0259
     C                   Z-ADD     *ZERO         WL0260
     C                   Z-ADD     *ZERO         WL0261
     C                   Z-ADD     *ZERO         WL0262
     C                   Z-ADD     *ZERO         WL0263
     C                   Z-ADD     *ZERO         WL0264
     C                   Z-ADD     *ZERO         WL0265
     C                   Z-ADD     *ZERO         WL0266
     C                   Z-ADD     *ZERO         WL0267
     C                   Z-ADD     *ZERO         WL0268
     C                   EVAL      WL0269 = ' '
     C                   EVAL      WL0270 = ' '
     C                   EVAL      WL0271 = ' '
     C                   Z-ADD     *ZERO         WL0272
     C                   EVAL      WL0273 = ' '
     C                   EVAL      WL0274 = ' '
     C                   Z-ADD     *ZERO         WL0275
      * Define local variables for subroutine TERVGN.
     C                   Z-ADD     *ZERO         WL0276
     C                   Z-ADD     *ZERO         WL0277
     C                   Z-ADD     *ZERO         WL0278
     C                   Z-ADD     *ZERO         WL0279
     C                   EVAL      WL0280 = ' '
     C                   Z-ADD     *ZERO         WL0281
     C                   EVAL      WL0282 = ' '
     C                   EVAL      WL0283 = ' '
     C                   Z-ADD     *ZERO         WL0284
     C                   EVAL      WL0285 = ' '
      * Define local variables for subroutine TGRVGN.
     C                   Z-ADD     *ZERO         WL0286
     C                   Z-ADD     *ZERO         WL0287
     C                   Z-ADD     *ZERO         WL0288
     C                   Z-ADD     *ZERO         WL0289
     C                   Z-ADD     *ZERO         WL0290
     C                   EVAL      WL0291 = ' '
     C                   Z-ADD     *ZERO         WL0292
     C                   Z-ADD     *ZERO         WL0293
     C                   EVAL      WL0294 = ' '
     C                   EVAL      WL0295 = ' '
     C                   Z-ADD     *ZERO         WL0296
     C                   Z-ADD     *ZERO         WL0297
     C                   Z-ADD     *ZERO         WL0298
     C                   Z-ADD     *ZERO         WL0299
     C                   EVAL      WL0300 = ' '
     C                   EVAL      WL0301 = ' '
     C                   EVAL      WL0302 = ' '
     C                   EVAL      WL0303 = ' '
     C                   Z-ADD     *ZERO         WL0304
     C                   Z-ADD     *ZERO         WL0305
     C                   EVAL      WL0306 = ' '
     C                   EVAL      WL0307 = ' '
     C                   EVAL      WL0308 = ' '
     C                   Z-ADD     *ZERO         WL0309
     C                   Z-ADD     *ZERO         WL0310
     C                   EVAL      WL0311 = ' '
     C                   Z-ADD     *ZERO         WL0312
     C                   EVAL      WL0313 = ' '
     C                   EVAL      WL0314 = ' '
     C                   EVAL      WL0315 = ' '
     C                   EVAL      WL0316 = ' '
     C                   EVAL      WL0317 = ' '
     C                   EVAL      WL0318 = ' '
     C                   EVAL      WL0319 = ' '
     C                   EVAL      WL0320 = ' '
     C                   EVAL      WL0321 = ' '
     C                   EVAL      WL0322 = ' '
     C                   EVAL      WL0323 = ' '
     C                   EVAL      WL0324 = ' '
     C                   EVAL      WL0325 = ' '
     C                   EVAL      WL0326 = ' '
     C                   Z-ADD     *ZERO         WL0327
     C                   Z-ADD     *ZERO         WL0328
     C                   Z-ADD     *ZERO         WL0329
     C                   Z-ADD     *ZERO         WL0330
     C                   Z-ADD     *ZERO         WL0331
     C                   Z-ADD     *ZERO         WL0332
     C                   Z-ADD     *ZERO         WL0333
     C                   Z-ADD     *ZERO         WL0334
     C                   Z-ADD     *ZERO         WL0335
     C                   Z-ADD     *ZERO         WL0336
     C                   Z-ADD     *ZERO         WL0337
     C                   Z-ADD     *ZERO         WL0338
     C                   Z-ADD     *ZERO         WL0339
     C                   Z-ADD     *ZERO         WL0340
     C                   Z-ADD     *ZERO         WL0341
     C                   Z-ADD     *ZERO         WL0342
     C                   Z-ADD     *ZERO         WL0343
     C                   EVAL      WL0344 = ' '
     C                   EVAL      WL0345 = ' '
     C                   EVAL      WL0346 = ' '
     C                   Z-ADD     *ZERO         WL0347
     C                   Z-ADD     *ZERO         WL0348
     C                   Z-ADD     *ZERO         WL0349
     C                   EVAL      WL0350 = ' '
     C                   EVAL      WL0351 = ' '
     C                   EVAL      WL0352 = ' '
     C                   EVAL      WL0353 = ' '
     C                   Z-ADD     *ZERO         WL0354
     C                   EVAL      WL0355 = ' '
     C                   EVAL      WL0356 = ' '
     C                   EVAL      WL0357 = ' '
     C                   EVAL      WL0358 = ' '
     C                   EVAL      WL0359 = ' '
     C                   EVAL      WL0360 = ' '
     C                   EVAL      WL0361 = ' '
     C                   EVAL      WL0362 = ' '
     C                   Z-ADD     *ZERO         WL0363
     C                   Z-ADD     *ZERO         WL0364
     C                   Z-ADD     *ZERO         WL0365
     C                   EVAL      WL0366 = ' '
     C                   EVAL      WL0367 = ' '
     C                   EVAL      WL0368 = ' '
     C                   EVAL      WL0369 = ' '
     C                   EVAL      WL0370 = ' '
     C                   EVAL      WL0371 = ' '
     C                   EVAL      WL0372 = ' '
     C                   EVAL      WL0373 = ' '
     C                   EVAL      WL0374 = ' '
     C                   Z-ADD     *ZERO         WL0375
     C                   Z-ADD     *ZERO         WL0376
     C                   Z-ADD     *ZERO         WL0377
     C                   Z-ADD     *ZERO         WL0378
     C                   Z-ADD     *ZERO         WL0379
     C                   Z-ADD     *ZERO         WL0380
     C                   Z-ADD     *ZERO         WL0381
     C                   Z-ADD     *ZERO         WL0382
     C                   Z-ADD     *ZERO         WL0383
     C                   Z-ADD     *ZERO         WL0384
     C                   Z-ADD     *ZERO         WL0385
     C                   Z-ADD     *ZERO         WL0386
     C                   Z-ADD     *ZERO         WL0387
     C                   Z-ADD     *ZERO         WL0388
     C                   Z-ADD     *ZERO         WL0389
     C                   Z-ADD     *ZERO         WL0390
     C                   Z-ADD     *ZERO         WL0391
     C                   Z-ADD     *ZERO         WL0392
     C                   Z-ADD     *ZERO         WL0393
     C                   Z-ADD     *ZERO         WL0394
     C                   Z-ADD     *ZERO         WL0395
     C                   Z-ADD     *ZERO         WL0396
     C                   Z-ADD     *ZERO         WL0397
     C                   EVAL      WL0398 = ' '
     C                   EVAL      WL0399 = ' '
     C                   EVAL      WL0400 = ' '
     C                   Z-ADD     *ZERO         WL0401
     C                   Z-ADD     *ZERO         WL0402
     C                   Z-ADD     *ZERO         WL0403
     C                   Z-ADD     *ZERO         WL0404
     C                   EVAL      WL0405 = ' '
     C                   EVAL      WL0406 = ' '
     C                   EVAL      WL0407 = ' '
     C                   Z-ADD     *ZERO         WL0408
     C                   Z-ADD     *ZERO         WL0409
     C                   Z-ADD     *ZERO         WL0410
     C                   EVAL      WL0411 = ' '
     C                   EVAL      WL0412 = ' '
     C                   EVAL      WL0413 = ' '
     C                   Z-ADD     *ZERO         WL0414
     C                   EVAL      WL0415 = ' '
     C                   EVAL      WL0416 = ' '
     C                   Z-ADD     *ZERO         WL0417
      * Define local variables for subroutine THRVGN.
     C                   Z-ADD     *ZERO         WL0418
     C                   Z-ADD     *ZERO         WL0419
     C                   Z-ADD     *ZERO         WL0420
     C                   Z-ADD     *ZERO         WL0421
     C                   Z-ADD     *ZERO         WL0422
      * Define local variables for subroutine TICHRC.
     C                   Z-ADD     *ZERO         WL0423
     C                   Z-ADD     *ZERO         WL0424
     C                   Z-ADD     *ZERO         WL0425
     C                   Z-ADD     *ZERO         WL0426
     C                   Z-ADD     *ZERO         WL0427
     C                   Z-ADD     *ZERO         WL0428
      * Define local variables for subroutine TJDLRC.
     C                   Z-ADD     *ZERO         WL0429
     C                   Z-ADD     *ZERO         WL0430
     C                   Z-ADD     *ZERO         WL0431
     C                   Z-ADD     *ZERO         WL0432
      * Define local variables for subroutine TKCHRC.
     C                   Z-ADD     *ZERO         WL0433
     C                   Z-ADD     *ZERO         WL0434
     C                   Z-ADD     *ZERO         WL0435
     C                   Z-ADD     *ZERO         WL0436
     C                   EVAL      WL0437 = ' '
     C                   EVAL      WL0438 = ' '
     C                   Z-ADD     *ZERO         WL0439
     C                   Z-ADD     *ZERO         WL0440
      * Define local variables for subroutine TLRVGN.
     C                   Z-ADD     *ZERO         WL0441
     C                   Z-ADD     *ZERO         WL0442
     C                   Z-ADD     *ZERO         WL0443
     C                   Z-ADD     *ZERO         WL0444
      * Define local variables for subroutine TNRVGN.
     C                   Z-ADD     *ZERO         WL0445
     C                   Z-ADD     *ZERO         WL0446
     C                   EVAL      WL0447 = ' '
      * Define local variables for subroutine TOCHRC.
     C                   Z-ADD     *ZERO         WL0448
     C                   Z-ADD     *ZERO         WL0449
     C                   Z-ADD     *ZERO         WL0450
     C                   EVAL      WL0451 = ' '
     C                   EVAL      WL0452 = ' '
     C                   Z-ADD     *ZERO         WL0453
     C                   Z-ADD     *ZERO         WL0454
     C                   EVAL      WL0455 = ' '
     C                   EVAL      WL0456 = ' '
     C                   Z-ADD     *ZERO         WL0457
     C                   Z-ADD     *ZERO         WL0458
     C                   Z-ADD     *ZERO         WL0459
     C                   EVAL      WL0460 = ' '
     C                   EVAL      WL0461 = ' '
     C                   Z-ADD     *ZERO         WL0462
     C                   EVAL      WL0463 = ' '
     C                   Z-ADD     *ZERO         WL0464
      * Define local variables for subroutine TPCHRC.
     C                   Z-ADD     *ZERO         WL0465
     C                   Z-ADD     *ZERO         WL0466
     C                   Z-ADD     *ZERO         WL0467
     C                   Z-ADD     *ZERO         WL0468
     C                   Z-ADD     *ZERO         WL0469
     C                   EVAL      WL0470 = ' '
     C                   Z-ADD     *ZERO         WL0471
     C                   Z-ADD     *ZERO         WL0472
     C                   EVAL      WL0473 = ' '
     C                   EVAL      WL0474 = ' '
     C                   Z-ADD     *ZERO         WL0475
     C                   Z-ADD     *ZERO         WL0476
     C                   Z-ADD     *ZERO         WL0477
     C                   Z-ADD     *ZERO         WL0478
     C                   EVAL      WL0479 = ' '
     C                   EVAL      WL0480 = ' '
     C                   EVAL      WL0481 = ' '
     C                   EVAL      WL0482 = ' '
     C                   Z-ADD     *ZERO         WL0483
     C                   Z-ADD     *ZERO         WL0484
     C                   EVAL      WL0485 = ' '
     C                   EVAL      WL0486 = ' '
     C                   EVAL      WL0487 = ' '
     C                   Z-ADD     *ZERO         WL0488
     C                   Z-ADD     *ZERO         WL0489
     C                   EVAL      WL0490 = ' '
     C                   Z-ADD     *ZERO         WL0491
     C                   EVAL      WL0492 = ' '
     C                   EVAL      WL0493 = ' '
     C                   EVAL      WL0494 = ' '
     C                   EVAL      WL0495 = ' '
     C                   EVAL      WL0496 = ' '
     C                   EVAL      WL0497 = ' '
     C                   EVAL      WL0498 = ' '
     C                   EVAL      WL0499 = ' '
     C                   EVAL      WL0500 = ' '
     C                   EVAL      WL0501 = ' '
     C                   EVAL      WL0502 = ' '
     C                   EVAL      WL0503 = ' '
     C                   EVAL      WL0504 = ' '
     C                   EVAL      WL0505 = ' '
     C                   Z-ADD     *ZERO         WL0506
     C                   Z-ADD     *ZERO         WL0507
     C                   Z-ADD     *ZERO         WL0508
     C                   Z-ADD     *ZERO         WL0509
     C                   Z-ADD     *ZERO         WL0510
     C                   Z-ADD     *ZERO         WL0511
     C                   Z-ADD     *ZERO         WL0512
     C                   Z-ADD     *ZERO         WL0513
     C                   Z-ADD     *ZERO         WL0514
     C                   Z-ADD     *ZERO         WL0515
     C                   Z-ADD     *ZERO         WL0516
     C                   Z-ADD     *ZERO         WL0517
     C                   Z-ADD     *ZERO         WL0518
     C                   Z-ADD     *ZERO         WL0519
     C                   Z-ADD     *ZERO         WL0520
     C                   Z-ADD     *ZERO         WL0521
     C                   Z-ADD     *ZERO         WL0522
     C                   EVAL      WL0523 = ' '
     C                   EVAL      WL0524 = ' '
     C                   EVAL      WL0525 = ' '
     C                   Z-ADD     *ZERO         WL0526
     C                   Z-ADD     *ZERO         WL0527
     C                   Z-ADD     *ZERO         WL0528
     C                   EVAL      WL0529 = ' '
     C                   EVAL      WL0530 = ' '
     C                   EVAL      WL0531 = ' '
     C                   EVAL      WL0532 = ' '
     C                   Z-ADD     *ZERO         WL0533
     C                   EVAL      WL0534 = ' '
     C                   EVAL      WL0535 = ' '
     C                   EVAL      WL0536 = ' '
     C                   EVAL      WL0537 = ' '
     C                   EVAL      WL0538 = ' '
     C                   EVAL      WL0539 = ' '
     C                   EVAL      WL0540 = ' '
     C                   EVAL      WL0541 = ' '
     C                   Z-ADD     *ZERO         WL0542
     C                   Z-ADD     *ZERO         WL0543
     C                   Z-ADD     *ZERO         WL0544
     C                   EVAL      WL0545 = ' '
     C                   EVAL      WL0546 = ' '
     C                   EVAL      WL0547 = ' '
     C                   EVAL      WL0548 = ' '
     C                   EVAL      WL0549 = ' '
     C                   EVAL      WL0550 = ' '
     C                   EVAL      WL0551 = ' '
     C                   EVAL      WL0552 = ' '
     C                   EVAL      WL0553 = ' '
     C                   Z-ADD     *ZERO         WL0554
     C                   Z-ADD     *ZERO         WL0555
     C                   Z-ADD     *ZERO         WL0556
     C                   Z-ADD     *ZERO         WL0557
     C                   Z-ADD     *ZERO         WL0558
     C                   Z-ADD     *ZERO         WL0559
     C                   Z-ADD     *ZERO         WL0560
     C                   Z-ADD     *ZERO         WL0561
     C                   Z-ADD     *ZERO         WL0562
     C                   Z-ADD     *ZERO         WL0563
     C                   Z-ADD     *ZERO         WL0564
     C                   Z-ADD     *ZERO         WL0565
     C                   Z-ADD     *ZERO         WL0566
     C                   Z-ADD     *ZERO         WL0567
     C                   Z-ADD     *ZERO         WL0568
     C                   Z-ADD     *ZERO         WL0569
     C                   Z-ADD     *ZERO         WL0570
     C                   Z-ADD     *ZERO         WL0571
     C                   Z-ADD     *ZERO         WL0572
     C                   Z-ADD     *ZERO         WL0573
     C                   Z-ADD     *ZERO         WL0574
     C                   Z-ADD     *ZERO         WL0575
     C                   Z-ADD     *ZERO         WL0576
     C                   EVAL      WL0577 = ' '
     C                   EVAL      WL0578 = ' '
     C                   EVAL      WL0579 = ' '
     C                   Z-ADD     *ZERO         WL0580
     C                   Z-ADD     *ZERO         WL0581
     C                   Z-ADD     *ZERO         WL0582
     C                   Z-ADD     *ZERO         WL0583
     C                   EVAL      WL0584 = ' '
     C                   EVAL      WL0585 = ' '
     C                   EVAL      WL0586 = ' '
     C                   Z-ADD     *ZERO         WL0587
     C                   Z-ADD     *ZERO         WL0588
     C                   Z-ADD     *ZERO         WL0589
     C                   EVAL      WL0590 = ' '
     C                   EVAL      WL0591 = ' '
     C                   EVAL      WL0592 = ' '
      * Define local variables for subroutine TQRVGN.
     C                   Z-ADD     *ZERO         WL0593
     C                   Z-ADD     *ZERO         WL0594
     C                   Z-ADD     *ZERO         WL0595
     C                   Z-ADD     *ZERO         WL0596
     C                   Z-ADD     *ZERO         WL0597
      * Define local variables for subroutine TRRVGN.
     C                   EVAL      WL0598 = ' '
     C                   EVAL      WL0599 = ' '
     C                   Z-ADD     *ZERO         WL0600
      * Define local variables for subroutine TTCHRC.
     C                   Z-ADD     *ZERO         WL0601
     C                   EVAL      WL0602 = ' '
      * Define local variables for subroutine NARVGN.
     C                   EVAL      WL0603 = ' '
     C                   EVAL      WL0604 = ' '
      * Define local work field First Time Flag
     C                   EVAL      YL0001 = ' '
      * Define local work field Hdr/Dtl Validation Pass U
     C                   EVAL      YL0002 = ' '
      * Define null work field Company Number
     C                   Z-ADD     *ZERO         YN0001
      * Define null work field Order Number
     C                   Z-ADD     *ZERO         YN0002
      * Define null work field Record Processed
     C                   EVAL      YN0003 = ' '
      * Define null work field Record Status
     C                   EVAL      YN0004 = ' '
      * Define local work field @Text 9
     C                   EVAL      YL0003 = ' '
      * Define local work field BOE Error Comment
     C                   EVAL      YL0004 = ' '
      * Define local work field Ship To Name
     C                   EVAL      YL0005 = ' '
      * Define local work field Ship To Address Line 1
     C                   EVAL      YL0006 = ' '
      * Define local work field Ship To Address Line 2
     C                   EVAL      YL0007 = ' '
      * Define local work field Ship To Address Line 3
     C                   EVAL      YL0008 = ' '
      * Define local work field Ship To City
     C                   EVAL      YL0009 = ' '
      * Define local work field Ship To State Code
     C                   EVAL      YL0010 = ' '
      * Define null work field County Code
     C                   EVAL      YN0005 = ' '
      * Define local work field Ship To Zip_Postal Code
     C                   EVAL      YL0011 = ' '
      * Define null work field Telephone Number FF
     C                   EVAL      YN0006 = ' '
      * Define null work field Fax Number FF
     C                   EVAL      YN0007 = ' '
      * Define null work field Alpha Search
     C                   EVAL      YN0008 = ' '
      * Define null work field Federal Tax Id
     C                   EVAL      YN0009 = ' '
      * Define null work field New Customer Status
     C                   EVAL      YN0010 = ' '
      * Define null work field SIC Number
     C                   EVAL      YN0011 = ' '
      * Define null work field D_B Number
     C                   Z-ADD     *ZERO         YN0012
      * Define null work field D_B Rating
     C                   EVAL      YN0013 = ' '
      * Define null work field Date of D_B Rating
     C                   Z-ADD     *ZERO         YN0014
      * Define null work field Credit Line Expire Date
     C                   Z-ADD     *ZERO         YN0015
      * Define local work field AR Customer Number
     C                   Z-ADD     *ZERO         YL0012
      * Define null work field Parent Customer
     C                   Z-ADD     *ZERO         YN0016
      * Define null work field Credit Check AR Customer
     C                   EVAL      YN0017 = ' '
      * Define null work field Credit Check Parent Cust
     C                   EVAL      YN0018 = ' '
      * Define null work field Country Code
     C                   EVAL      YN0019 = ' '
      * Define null work field EDI Invoice Sts
     C                   EVAL      YN0020 = ' '
      * Define null work field Order Entry Hold
     C                   EVAL      YN0021 = ' '
      * Define null work field Parent Credit Limit
     C                   Z-ADD     *ZERO         YN0022
      * Define null work field AR Credit Limit
     C                   Z-ADD     *ZERO         YN0023
      * Define null work field Order Entry Hold Date
     C                   Z-ADD     *ZERO         YN0024
      * Define null work field Ship To Customer Flag
     C                   EVAL      YN0025 = ' '
      * Define null work field Field vs In_House flag
     C                   EVAL      YN0026 = ' '
      * Define local work field Email Cust On Order Ship
     C                   EVAL      YL0013 = ' '
      * Define null work field Print Invoice Sts
     C                   EVAL      YN0027 = ' '
      * Define null work field Item Reference Status
     C                   EVAL      YN0028 = ' '
      * Define null work field Statement Print Frequency
     C                   EVAL      YN0029 = ' '
      * Define null work field EDI Status 1
     C                   EVAL      YN0030 = ' '
      * Define null work field EDI Status 2
     C                   EVAL      YN0031 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0032 = ' '
      * Define null work field Job Time
     C                   Z-ADD     *ZERO         YN0033
      * Define null work field User Id
     C                   EVAL      YN0034 = ' '
      * Define null work field Job Name
     C                   EVAL      YN0035 = ' '
      * Define null work field Job Date
     C                   Z-ADD     *ZERO         YN0036
      * Define local work field Air Freight Order
     C                   EVAL      YL0014 = ' '
      * Define local work field Bill to Name
     C                   EVAL      YL0015 = ' '
      * Define local work field Bill to Address Line 1
     C                   EVAL      YL0016 = ' '
      * Define local work field Bill to Address Line 2
     C                   EVAL      YL0017 = ' '
      * Define local work field Bill to Address Line 3
     C                   EVAL      YL0018 = ' '
      * Define local work field Bill to City
     C                   EVAL      YL0019 = ' '
      * Define local work field Bill to State Code
     C                   EVAL      YL0020 = ' '
      * Define local work field Bill to Zip_Postal Code
     C                   EVAL      YL0021 = ' '
      * Define local work field Order Entry Hold
     C                   EVAL      YL0022 = ' '
      * Define local work field Ship To Customer Flag
     C                   EVAL      YL0023 = ' '
      * Define local work field Terms Code
     C                   EVAL      YL0024 = ' '
      * Define local work field Sales Route Code
     C                   EVAL      YL0025 = ' '
      * Define local work field Special Instructions 2
     C                   EVAL      YL0026 = ' '
      * Define local work field Special Instructions
     C                   EVAL      YL0027 = ' '
      * Define null work field Carrier Code
     C                   EVAL      YN0037 = ' '
      * Define null work field P_O Required Flag
     C                   EVAL      YN0038 = ' '
      * Define local work field Requested Delivery Time
     C                   Z-ADD     *ZERO         YL0028
      * Define local work field Type Code
     C                   EVAL      YL0029 = ' '
      * Define local work field Absorbed Freight Rate CWT
     C                   Z-ADD     *ZERO         YL0030
      * Define null work field Mileage To Customer
     C                   Z-ADD     *ZERO         YN0039
      * Define null work field Warehouse Code
     C                   EVAL      YN0040 = ' '
      * Define local work field Outside Warehouse Flag
     C                   EVAL      YL0031 = ' '
      * Define null work field Customer Group Code
     C                   EVAL      YN0041 = ' '
      * Define null work field Customer Group Code 2
     C                   EVAL      YN0042 = ' '
      * Define null work field Ord Ent Default Sls Rte
     C                   EVAL      YN0043 = ' '
      * Define local work field Record Found USR
     C                   EVAL      YL0032 = ' '
      * Define local work field Salesperson Code
     C                   EVAL      YL0033 = ' '
      * Define local work field Manager Level Code
     C                   EVAL      YL0034 = ' '
      * Define local work field VP Level Code
     C                   EVAL      YL0035 = ' '
      * Define local work field Description
     C                   EVAL      YL0036 = ' '
      * Define null work field M3 Supplier ID
     C                   EVAL      YN0044 = ' '
      * Define null work field Dft Mode of Transportaton
     C                   EVAL      YN0045 = ' '
      * Define null work field Buying Group
     C                   EVAL      YN0046 = ' '
      * Define null work field Buying Group Opt In_Out
     C                   EVAL      YN0047 = ' '
      * Define null work field Ship To Establishment nbr
     C                   EVAL      YN0048 = ' '
      * Define null work field PM Pallet Type
     C                   EVAL      YN0049 = ' '
      * Define null work field Cust Dft Price Type
     C                   EVAL      YN0050 = ' '
      * Define null work field Cust Dft Age Days
     C                   Z-ADD     *ZERO         YN0051
      * Define local work field Cust Dft Delivery Time
     C                   Z-ADD     *ZERO         YL0037
      * Define local work field Time Alpha usr 6
     C                   EVAL      YL0038 = ' '
      * Define local work field Time HHMM Alpha USR
     C                   EVAL      YL0039 = ' '
      * Define null work field Shipping Method Dft
     C                   EVAL      YN0052 = ' '
      * Define local work field Load Type Dft
     C                   EVAL      YL0040 = ' '
      * Define local work field LTL Flag
     C                   EVAL      YL0041 = ' '
      * Define null work field Export Status Dft
     C                   EVAL      YN0053 = ' '
      * Define local work field Shrink Wrap
     C                   EVAL      YL0042 = ' '
      * Define null work field Departure Time DFT
     C                   Z-ADD     *ZERO         YN0054
      * Define null work field Export Code Dft
     C                   EVAL      YN0055 = ' '
      * Define null work field Allow Mult Whse to Order
     C                   EVAL      YN0056 = ' '
      * Define null work field Allow Multi Export On Ord
     C                   EVAL      YN0057 = ' '
      * Define local work field Slip Sheet Dft
     C                   EVAL      YL0043 = ' '
      * Define local work field Palletize
     C                   EVAL      YL0044 = ' '
      * Define local work field Company Organization
     C                   EVAL      YL0045 = ' '
      * Define local work field Slip Sheet
     C                   EVAL      YL0046 = ' '
      * Define local work field Shipping Method
     C                   EVAL      YL0047 = ' '
      * Define local work field USR Record Status
     C                   EVAL      YL0048 = ' '
      * Define local work field OD Pallet Type
     C                   EVAL      YL0049 = ' '
      * Define null work field PM Description
     C                   EVAL      YN0058 = ' '
      * Define null work field Order Type Description
     C                   EVAL      YN0059 = ' '
      * Define null work field Processing Cycle Type
     C                   EVAL      YN0060 = ' '
      * Define local work field Billing Activity Type
     C                   EVAL      YL0050 = ' '
      * Define local work field Affect Inventory Default
     C                   EVAL      YL0051 = ' '
      * Define local work field Affect Sales Doll Default
     C                   EVAL      YL0052 = ' '
      * Define local work field Affect Sales Pnds Default
     C                   EVAL      YL0053 = ' '
      * Define null work field Warehouse Description
     C                   EVAL      YN0061 = ' '
      * Define null work field Address Line 1
     C                   EVAL      YN0062 = ' '
      * Define null work field Address Line 2
     C                   EVAL      YN0063 = ' '
      * Define null work field Address Line 3
     C                   EVAL      YN0064 = ' '
      * Define null work field City
     C                   EVAL      YN0065 = ' '
      * Define null work field Zip Postal Code
     C                   EVAL      YN0066 = ' '
      * Define local work field Production Warehouse
     C                   EVAL      YL0054 = ' '
      * Define null work field State Code
     C                   EVAL      YN0067 = ' '
      * Define null work field Lot Tracking Flag
     C                   EVAL      YN0068 = ' '
      * Define null work field Default Printer
     C                   EVAL      YN0069 = ' '
      * Define local work field Warehouse Type
     C                   EVAL      YL0055 = ' '
      * Define local work field Trans Contol AS400_Plant
     C                   EVAL      YL0056 = ' '
      * Define null work field Warehouse Location
     C                   EVAL      YN0070 = ' '
      * Define null work field Warehouse Std Chill Time
     C                   EVAL      YN0071 = ' '
      * Define null work field Warehouse Chill Time
     C                   Z-ADD     *ZERO         YN0072
      * Define null work field Include in Auto Pre Pick
     C                   EVAL      YN0073 = ' '
      * Define null work field Default Manifest Copies
     C                   EVAL      YN0074 = ' '
      * Define null work field Default Load Sequence
     C                   EVAL      YN0075 = ' '
      * Define null work field WHS Slotting Limit Type
     C                   EVAL      YN0076 = ' '
      * Define null work field Shipping Company
     C                   Z-ADD     *ZERO         YN0077
      * Define null work field Accounting Company
     C                   Z-ADD     *ZERO         YN0078
      * Define null work field WHS Sched Prod Max Days
     C                   Z-ADD     *ZERO         YN0079
      * Define null work field WHS Inventory Chill Time
     C                   Z-ADD     *ZERO         YN0080
      * Define null work field Parent Warehouse
     C                   EVAL      YN0081 = ' '
      * Define null work field Default Shipping Whs
     C                   EVAL      YN0082 = ' '
      * Define null work field WHS Live with Carlisle
     C                   EVAL      YN0083 = ' '
      * Define null work field WHS PFS Interface
     C                   EVAL      YN0084 = ' '
      * Define null work field WHS Req Meter Reading Shp
     C                   EVAL      YN0085 = ' '
      * Define null work field WHS Default Load Type
     C                   EVAL      YN0086 = ' '
      * Define null work field WHS TMS Planning Region
     C                   EVAL      YN0087 = ' '
      * Define null work field Default Carrier Code
     C                   EVAL      YN0088 = ' '
      * Define null work field Inventory Logic Version
     C                   EVAL      YN0089 = ' '
      * Define null work field WHS Auto Inv Restoration
     C                   EVAL      YN0090 = ' '
      * Define null work field Reefer Temperature Dft
     C                   Z-ADD     *ZERO         YN0091
      * Define local work field Temperature Code C_F
     C                   EVAL      YL0057 = ' '
      * Define local work field Fresh Chilling Time
     C                   Z-ADD     *ZERO         YL0058
      * Define local work field HPB Ship to Warehouse
     C                   EVAL      YL0059 = ' '
      * Define local work field Requested Ship Date
     C                   Z-ADD     *ZERO         YL0060
      * Define local work field Date From Convert USR
     C                   EVAL      YL0061 = ' '
      * Define local work field Text usr 11
     C                   EVAL      YL0062 = ' '
      * Define local work field OD Spot Buy
     C                   EVAL      YL0063 = ' '
      * Define local work field Record Status
     C                   EVAL      YL0064 = ' '
      * Define local work field Warehouse Code
     C                   EVAL      YL0065 = ' '
      * Define local work field Must Ship Error
     C                   EVAL      YL0066 = ' '
      * Define local work field Must Ship Date        USR
     C                   Z-ADD     *ZERO         YL0067
      * Define local work field Must Ship Time        USR
     C                   Z-ADD     *ZERO         YL0068
      * Define local work field Explaination Text 1
     C                   EVAL      YL0069 = ' '
      * Define local work field USR Work Field 7A
     C                   EVAL      YL0070 = ' '
      * Define local work field USR Date Alpha
     C                   EVAL      YL0071 = ' '
      * Define local work field Order Desc_Line One
     C                   EVAL      YL0072 = ' '
      * Define local work field Order Desc_Line Two
     C                   EVAL      YL0073 = ' '
      * Define local work field U_M_Ordered
     C                   EVAL      YL0074 = ' '
      * Define local work field U_M_Base Price
     C                   EVAL      YL0075 = ' '
      * Define local work field Unit Weight Ordered U_M
     C                   Z-ADD     *ZERO         YL0076
      * Define local work field Item Level
     C                   EVAL      YL0077 = ' '
      * Define local work field Production Date Control
     C                   EVAL      YL0078 = ' '
      * Define local work field Catch Weight Status
     C                   EVAL      YL0079 = ' '
      * Define local work field Item Structure Class Code
     C                   Z-ADD     *ZERO         YL0080
      * Define local work field Item Structure Group Code
     C                   Z-ADD     *ZERO         YL0081
      * Define local work field Item Structure Type Code
     C                   Z-ADD     *ZERO         YL0082
      * Define null work field Default Commod Mark basis
     C                   EVAL      YN0092 = ' '
      * Define null work field Transportation Temp
     C                   Z-ADD     *ZERO         YN0093
      * Define local work field Item Type Code
     C                   EVAL      YL0083 = ' '
      * Define null work field Commodity Price Group
     C                   EVAL      YN0094 = ' '
      * Define null work field Default Warehouse
     C                   EVAL      YN0095 = ' '
      * Define null work field Price Method Default
     C                   EVAL      YN0096 = ' '
      * Define null work field Fresh Chilling Time
     C                   Z-ADD     *ZERO         YN0097
      * Define local work field Variety_Rendered_Cut
     C                   EVAL      YL0084 = ' '
      * Define local work field OD Item Target Price
     C                   Z-ADD     *ZERO         YL0085
      * Define local work field Sold 100 Percent Frozen
     C                   EVAL      YL0086 = ' '
      * Define local work field Error Status
     C                   EVAL      YL0087 = ' '
      * Define local work field BOE Error Comment
     C                   EVAL      YL0088 = ' '
      * Define local work field TF Co_Ownership Sts
     C                   EVAL      YL0089 = ' '
      * Define local work field Ord TF Exempt Code
     C                   EVAL      YL0090 = ' '
      * Define local work field Consumed Item Code
     C                   Z-ADD     *ZERO         YL0091
      * Define null work field Description Line One
     C                   EVAL      YN0098 = ' '
      * Define local work field Default Commod Mark basis
     C                   EVAL      YL0092 = ' '
      * Define local work field Market Overage
     C                   Z-ADD     *ZERO         YL0093
      * Define null work field Standard Overage_Underage
     C                   Z-ADD     *ZERO         YN0099
      * Define local work field Commodity Price Group
     C                   EVAL      YL0094 = ' '
      * Define null work field Std Weight_Head_Var_Ren
     C                   Z-ADD     *ZERO         YN0100
      * Define local work field Primal Group Code
     C                   EVAL      YL0095 = ' '
      * Define local work field Customer TF Exempt Code
     C                   EVAL      YL0096 = ' '
      * Define local work field OH TF Exempt Code
     C                   EVAL      YL0097 = ' '
      * Define local work field Item Code
     C                   Z-ADD     *ZERO         YL0098
      * Define local work field OH TF Exempt Error Cde U
     C                   EVAL      YL0099 = ' '
      * Define local work field Warehouse Type
     C                   EVAL      YL0100 = ' '
      * Define local work field Load Type
     C                   EVAL      YL0101 = ' '
      * Define local work field Plan Production Sts
     C                   EVAL      YL0102 = ' '
      * Define local work field Unit Cost Per Pound
     C                   Z-ADD     *ZERO         YL0103
      * Define local work field Production AgeDte Fr
     C                   Z-ADD     *ZERO         YL0104
      * Define local work field Production AgeDte To
     C                   Z-ADD     *ZERO         YL0105
      * Define local work field Company Organization
     C                   EVAL      YL0106 = ' '
      * Define null work field Description Line Two
     C                   EVAL      YN0101 = ' '
      * Define null work field UOM Pricing
     C                   EVAL      YN0102 = ' '
      * Define null work field Unit Weight
     C                   Z-ADD     *ZERO         YN0103
      * Define null work field Item Level
     C                   EVAL      YN0104 = ' '
      * Define null work field Production Date Control
     C                   EVAL      YN0105 = ' '
      * Define null work field Catch Weight Status
     C                   EVAL      YN0106 = ' '
      * Define null work field Item Structure Class Code
     C                   Z-ADD     *ZERO         YN0107
      * Define null work field Item Structure Group Code
     C                   Z-ADD     *ZERO         YN0108
      * Define null work field Item Structure Type Code
     C                   Z-ADD     *ZERO         YN0109
      * Define null work field Item Type Code
     C                   EVAL      YN0110 = ' '
      * Define null work field Variety_Rendered_Cut
     C                   EVAL      YN0111 = ' '
      * Define null work field Item Target Price
     C                   Z-ADD     *ZERO         YN0112
      * Define null work field Error Status
     C                   EVAL      YN0113 = ' '
      * Define local work field Record Found USR
     C                   EVAL      YL0107 = ' '
      * Define local work field Credit Item Status
     C                   EVAL      YL0108 = ' '
      * Define local work field Price Method Type
     C                   EVAL      YL0109 = ' '
      * Define null work field PMH Price Type
     C                   EVAL      YN0114 = ' '
      * Define local work field Price Method Code
     C                   EVAL      YL0110 = ' '
      * Define local work field Commodity Market Code USR
     C                   EVAL      YL0111 = ' '
      * Define local work field From Date             USR
     C                   Z-ADD     *ZERO         YL0112
      * Define local work field Thru Date             USR
     C                   Z-ADD     *ZERO         YL0113
      * Define local work field Text usr 11
     C                   EVAL      YL0114 = ' '
      * Define local work field Date From Convert USR
     C                   EVAL      YL0115 = ' '
      * Define local work field Hdr/Dtl Validation Pass U
     C                   EVAL      YL0116 = ' '
      * Define local work field Palletize
     C                   EVAL      YL0117 = ' '
      * Define local work field OD Pallet Type
     C                   EVAL      YL0118 = ' '
      * Define null work field M3 Supplier ID
     C                   EVAL      YN0115 = ' '
      * Define null work field Dft Mode of Transportaton
     C                   EVAL      YN0116 = ' '
      * Define null work field Buying Group
     C                   EVAL      YN0117 = ' '
      * Define null work field Buying Group Opt In_Out
     C                   EVAL      YN0118 = ' '
      * Define null work field Ship To Establishment nbr
     C                   EVAL      YN0119 = ' '
      * Define null work field Cust Dft Price Type
     C                   EVAL      YN0120 = ' '
      * Define null work field Cust Dft Age Days
     C                   Z-ADD     *ZERO         YN0121
      * Define null work field Cust Dft Delivery Time
     C                   Z-ADD     *ZERO         YN0122
      * Define local work field Slip Sheet
     C                   EVAL      YL0119 = ' '
      * Define null work field Terms Code
     C                   EVAL      YN0123 = ' '
      * Define null work field Sales Route Code
     C                   EVAL      YN0124 = ' '
      * Define null work field Special Instructions 2
     C                   EVAL      YN0125 = ' '
      * Define null work field Special Instructions
     C                   EVAL      YN0126 = ' '
      * Define null work field Carrier Code
     C                   EVAL      YN0127 = ' '
      * Define null work field Broker
     C                   EVAL      YN0128 = ' '
      * Define null work field P_O Required Flag
     C                   EVAL      YN0129 = ' '
      * Define null work field Deliver after time
     C                   Z-ADD     *ZERO         YN0130
      * Define null work field Deliver before time
     C                   Z-ADD     *ZERO         YN0131
      * Define null work field Alt Remittance Flag
     C                   EVAL      YN0132 = ' '
      * Define null work field Type Code
     C                   EVAL      YN0133 = ' '
      * Define null work field Absorbed Freight Rate CWT
     C                   Z-ADD     *ZERO         YN0134
      * Define null work field Mileage To Customer
     C                   Z-ADD     *ZERO         YN0135
      * Define null work field Co_Cust Overage Rate CWT
     C                   Z-ADD     *ZERO         YN0136
      * Define null work field Age Code
     C                   EVAL      YN0137 = ' '
      * Define null work field Warehouse Code
     C                   EVAL      YN0138 = ' '
      * Define null work field Outside Warehouse Flag
     C                   EVAL      YN0139 = ' '
      * Define null work field Customer Group Code
     C                   EVAL      YN0140 = ' '
      * Define null work field Customer Group Code 2
     C                   EVAL      YN0141 = ' '
      * Define null work field G_L Code
     C                   EVAL      YN0142 = ' '
      * Define local work field Commodity Market Code
     C                   EVAL      YL0120 = ' '
      * Define null work field Credit Contact Name
     C                   EVAL      YN0143 = ' '
      * Define null work field Credit Contact Telephone
     C                   EVAL      YN0144 = ' '
      * Define null work field Credit Contact Bus Title
     C                   EVAL      YN0145 = ' '
      * Define null work field Credit Contact Fax Number
     C                   EVAL      YN0146 = ' '
      * Define null work field Allow Man_Qt WO_Approval
     C                   EVAL      YN0147 = ' '
      * Define null work field Fax Invoice Flag
     C                   EVAL      YN0148 = ' '
      * Define null work field Fax Invoice Fax Number
     C                   EVAL      YN0149 = ' '
      * Define null work field Fax Invoice Contact Name
     C                   EVAL      YN0150 = ' '
      * Define null work field Distributor
     C                   EVAL      YN0151 = ' '
      * Define null work field Default Shipping Co Sts
     C                   EVAL      YN0152 = ' '
      * Define null work field Ord Ent Default Sls Rte
     C                   EVAL      YN0153 = ' '
      * Define null work field Bypass DDt_Delay w_Invcng
     C                   EVAL      YN0154 = ' '
      * Define null work field EDI Status 1
     C                   EVAL      YN0155 = ' '
      * Define null work field EDI Status 2
     C                   EVAL      YN0156 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0157 = ' '
      * Define null work field Record Status
     C                   EVAL      YN0158 = ' '
      * Define null work field Job Time
     C                   Z-ADD     *ZERO         YN0159
      * Define null work field User Id
     C                   EVAL      YN0160 = ' '
      * Define null work field Job Name
     C                   EVAL      YN0161 = ' '
      * Define null work field Job Date
     C                   Z-ADD     *ZERO         YN0162
      * Define local work field OD Production Plan Sts
     C                   EVAL      YL0121 = ' '
      * Define local work field Sales Route Code
     C                   EVAL      YL0122 = ' '
      * Define local work field Production Warehouse
     C                   EVAL      YL0123 = ' '
      * Define local work field Billing Activity Type
     C                   EVAL      YL0124 = ' '
      * Define local work field Market Pricing Date
     C                   Z-ADD     *ZERO         YL0125
      * Define local work field Date Method Code
     C                   EVAL      YL0126 = ' '
      * Define local work field Price Overage Override
     C                   Z-ADD     *ZERO         YL0127
      * Define local work field Unit Price_Credit
     C                   Z-ADD     *ZERO         YL0128
      * Define local work field OD Ceiling Price
     C                   Z-ADD     *ZERO         YL0129
      * Define local work field OD Market Begin Date
     C                   Z-ADD     *ZERO         YL0130
      * Define local work field OD Market Ending Date
     C                   Z-ADD     *ZERO         YL0131
      * Define local work field Type Code
     C                   EVAL      YL0132 = ' '
      * Define local work field Absorbed Freight Rate CWT
     C                   Z-ADD     *ZERO         YL0133
      * Define local work field USR Display 4
     C                   EVAL      YL0134 = ' '
      * Define local work field Pricing Valid Error Cde U
     C                   EVAL      YL0135 = ' '
      * Define local work field Price Method Type
     C                   EVAL      YL0136 = ' '
      * Define local work field PMH Price Type
     C                   EVAL      YL0137 = ' '
      * Define local work field Commodity Price Group
     C                   EVAL      YL0138 = ' '
      * Define local work field Market Prem/Ded
     C                   Z-ADD     *ZERO         YL0139
      * Define local work field Record Found USR
     C                   EVAL      YL0140 = ' '
      * Define local work field Market Overage
     C                   Z-ADD     *ZERO         YL0141
      * Define local work field Price Start Date
     C                   Z-ADD     *ZERO         YL0142
      * Define local work field Price End Date
     C                   Z-ADD     *ZERO         YL0143
      * Define local work field Maximum Contract Units
     C                   Z-ADD     *ZERO         YL0144
      * Define local work field Customer Price_UM Prc
     C                   Z-ADD     *ZERO         YL0145
      * Define local work field Commodity Market Code USR
     C                   EVAL      YL0146 = ' '
      * Define local work field Price Method Code USR
     C                   EVAL      YL0147 = ' '
      * Define local work field Date Method Code USR
     C                   EVAL      YL0148 = ' '
      * Define local work field Contract Unit Type
     C                   EVAL      YL0149 = ' '
      * Define local work field Pricing Valid Error Cde U
     C                   EVAL      YL0150 = ' '
      * Define local work field Weight Ordered
     C                   Z-ADD     *ZERO         YL0151
      * Define local work field Price Method Code
     C                   EVAL      YL0152 = ' '
      * Define local work field Weight Allocated USR
     C                   Z-ADD     *ZERO         YL0153
      * Define local work field BOE Error Comment
     C                   EVAL      YL0154 = ' '
      * Define local work field Surrogate Number
     C                   Z-ADD     *ZERO         YL0155
      * Define local work field Hdr/Dtl Validation Pass U
     C                   EVAL      YL0156 = ' '
      * Define local work field Projected Market Price
     C                   Z-ADD     *ZERO         YL0157
      * Define local work field Error Status  3
     C                   EVAL      YL0158 = ' '
      * Define local work field Minimum Price   USR
     C                   Z-ADD     *ZERO         YL0159
      * Define local work field Maximum Price  USR
     C                   Z-ADD     *ZERO         YL0160
      * Define null work field Date Method Description
     C                   EVAL      YN0163 = ' '
      * Define local work field Weight Ordered
     C                   Z-ADD     *ZERO         YL0161
      * Define local work field Error Flag            USR
     C                   EVAL      YL0162 = ' '
      * Define local work field Blank 1 USR
     C                   EVAL      YL0163 = ' '
      * Define local work field Next Order Number
     C                   Z-ADD     *ZERO         YL0164
      * Define local work field Order Type_Sales
     C                   EVAL      YL0165 = ' '
      * Define local work field Ship To Customer
     C                   Z-ADD     *ZERO         YL0166
      * Define local work field Bill to Customer
     C                   Z-ADD     *ZERO         YL0167
      * Define local work field Customer Purchase Order #
     C                   EVAL      YL0168 = ' '
      * Define local work field Order Date
     C                   Z-ADD     *ZERO         YL0169
      * Define local work field Actual Shipped Date
     C                   Z-ADD     *ZERO         YL0170
      * Define local work field Cancel Date
     C                   Z-ADD     *ZERO         YL0171
      * Define local work field Carrier Code
     C                   EVAL      YL0172 = ' '
      * Define local work field Comment Print Acknowledge
     C                   EVAL      YL0173 = ' '
      * Define local work field Comment Print Inv_Cr_Memo
     C                   EVAL      YL0174 = ' '
      * Define local work field Comment Print Pick Slip
     C                   EVAL      YL0175 = ' '
      * Define local work field Comment Print Ship Doc
     C                   EVAL      YL0176 = ' '
      * Define local work field Reason Code
     C                   EVAL      YL0177 = ' '
      * Define local work field Order in Use
     C                   EVAL      YL0178 = ' '
      * Define local work field Header Status
     C                   EVAL      YL0179 = ' '
      * Define local work field Header Status Last
     C                   EVAL      YL0180 = ' '
      * Define local work field Order Type Print Status
     C                   EVAL      YL0181 = ' '
      * Define local work field Scheduled Ship Date
     C                   Z-ADD     *ZERO         YL0182
      * Define local work field User Original Entry
     C                   EVAL      YL0183 = ' '
      * Define local work field Date of Original Entry
     C                   Z-ADD     *ZERO         YL0184
      * Define local work field Order Value Total
     C                   Z-ADD     *ZERO         YL0185
      * Define local work field Order Weight Total
     C                   Z-ADD     *ZERO         YL0186
      * Define local work field Credit Hold
     C                   EVAL      YL0187 = ' '
      * Define local work field Production Hold
     C                   EVAL      YL0188 = ' '
      * Define local work field New Customer Hold
     C                   EVAL      YL0189 = ' '
      * Define local work field Requested Delivery Date
     C                   Z-ADD     *ZERO         YL0190
      * Define local work field Accounts Receiv_Ent 1
     C                   EVAL      YL0191 = ' '
      * Define local work field Accounts Receiv_Ent 2
     C                   EVAL      YL0192 = ' '
      * Define local work field Load ID
     C                   Z-ADD     *ZERO         YL0193
      * Define local work field Rated Freight
     C                   Z-ADD     *ZERO         YL0194
      * Define local work field Price Audit
     C                   EVAL      YL0195 = ' '
      * Define local work field Price Status
     C                   EVAL      YL0196 = ' '
      * Define local work field Export Status
     C                   EVAL      YL0197 = ' '
      * Define local work field Age Code
     C                   EVAL      YL0198 = ' '
      * Define local work field Reefer Temperature
     C                   Z-ADD     *ZERO         YL0199
      * Define local work field Load Type
     C                   EVAL      YL0200 = ' '
      * Define local work field Attach to Invoice Number
     C                   Z-ADD     *ZERO         YL0201
      * Define local work field Load Plan Order
     C                   EVAL      YL0202 = ' '
      * Define local work field Print Pick Slip
     C                   EVAL      YL0203 = ' '
      * Define local work field Resell Reference Number
     C                   Z-ADD     *ZERO         YL0204
      * Define local work field Special Comment 1
     C                   EVAL      YL0205 = ' '
      * Define local work field Special Comment 2
     C                   EVAL      YL0206 = ' '
      * Define local work field Affect Auto Accruals
     C                   EVAL      YL0207 = ' '
      * Define local work field Attach to Order Number
     C                   Z-ADD     *ZERO         YL0208
      * Define local work field Reason for Price Audit
     C                   EVAL      YL0209 = ' '
      * Define local work field Invoice Number
     C                   Z-ADD     *ZERO         YL0210
      * Define local work field Invoice Suffix
     C                   EVAL      YL0211 = ' '
      * Define local work field Invoice Date
     C                   Z-ADD     *ZERO         YL0212
      * Define local work field Event Code
     C                   EVAL      YL0213 = ' '
      * Define local work field Modified Flag
     C                   EVAL      YL0214 = ' '
      * Define local work field A_R order Value Total
     C                   Z-ADD     *ZERO         YL0215
      * Define local work field Block Order Flag
     C                   EVAL      YL0216 = ' '
      * Define local work field Order Certification Flag
     C                   EVAL      YL0217 = ' '
      * Define local work field Invoice Order Value Tot
     C                   Z-ADD     *ZERO         YL0218
      * Define local work field Process Sts for 3C
     C                   EVAL      YL0219 = ' '
      * Define local work field Order Conf Fax Sts
     C                   EVAL      YL0220 = ' '
      * Define local work field Manifest Fax Sts
     C                   EVAL      YL0221 = ' '
      * Define local work field Invoice Fax Sts
     C                   EVAL      YL0222 = ' '
      * Define local work field Transfer in Storage Ind
     C                   EVAL      YL0223 = ' '
      * Define local work field Order Emailed
     C                   EVAL      YL0224 = ' '
      * Define local work field Export Docs Go w_Driver
     C                   EVAL      YL0225 = ' '
      * Define local work field Shipping Temp Code C_F
     C                   EVAL      YL0226 = ' '
      * Define local work field Broker Order Status
     C                   EVAL      YL0227 = ' '
      * Define local work field Order Requires Review
     C                   EVAL      YL0228 = ' '
      * Define local work field OH Load Plan Ready
     C                   EVAL      YL0229 = ' '
      * Define local work field Export USDA Approved
     C                   EVAL      YL0230 = ' '
      * Define local work field OH TF Exempt Code
     C                   EVAL      YL0231 = ' '
      * Define local work field OH Appt Confirmation Dt
     C                   Z-ADD     *ZERO         YL0232
      * Define local work field JPN Invoice Issuance Date
     C                   Z-ADD     *ZERO         YL0233
      * Define local work field Load Actual Shipped Date
     C                   Z-ADD     *ZERO         YL0234
      * Define local work field Load BOL Complete Date
     C                   Z-ADD     *ZERO         YL0235
      * Define local work field Load Truck Departure Date
     C                   Z-ADD     *ZERO         YL0236
      * Define local work field Maximum Gross Weight
     C                   Z-ADD     *ZERO         YL0237
      * Define local work field Time of Original Entry
     C                   Z-ADD     *ZERO         YL0238
      * Define local work field OH Appt Confirmation Tm
     C                   Z-ADD     *ZERO         YL0239
      * Define local work field Load BOL Complete Time
     C                   Z-ADD     *ZERO         YL0240
      * Define local work field Load Truck Departure Time
     C                   Z-ADD     *ZERO         YL0241
      * Define local work field Act Frt Reference Amount
     C                   Z-ADD     *ZERO         YL0242
      * Define local work field Act Non_Ref Frt Amount
     C                   Z-ADD     *ZERO         YL0243
      * Define local work field OH Fuel Surcharge Amount
     C                   Z-ADD     *ZERO         YL0244
      * Define local work field OH Total Non_Ref Frt Amt
     C                   Z-ADD     *ZERO         YL0245
      * Define local work field OH Total Ref Frt Amt
     C                   Z-ADD     *ZERO         YL0246
      * Define local work field Claim Number
     C                   Z-ADD     *ZERO         YL0247
      * Define local work field EDI Status 1
     C                   EVAL      YL0248 = ' '
      * Define local work field EDI Status 2
     C                   EVAL      YL0249 = ' '
      * Define local work field EDI Status 3
     C                   EVAL      YL0250 = ' '
      * Define local work field Job Time
     C                   Z-ADD     *ZERO         YL0251
      * Define local work field User Id
     C                   EVAL      YL0252 = ' '
      * Define local work field Job Name
     C                   EVAL      YL0253 = ' '
      * Define local work field Job Date
     C                   Z-ADD     *ZERO         YL0254
      * Define local work field Hdr/Dtl Validation PassSv
     C                   EVAL      YL0255 = ' '
      * Define local work field Order Number
     C                   Z-ADD     *ZERO         YL0256
      * Define local work field Change Flag USR
     C                   EVAL      YL0257 = ' '
      * Define local work field Text usr 11
     C                   EVAL      YL0258 = ' '
      * Define local work field Date From Convert USR
     C                   EVAL      YL0259 = ' '
      * Define local work field BOE Error Comment
     C                   EVAL      YL0260 = ' '
      * Define local work field Hdr/Dtl Validation Pass U
     C                   EVAL      YL0261 = ' '
      * Define local work field Requested Ship Date
     C                   Z-ADD     *ZERO         YL0262
      * Define local work field Requested Delivery Date
     C                   Z-ADD     *ZERO         YL0263
      * Define null work field M3 Supplier ID
     C                   EVAL      YN0164 = ' '
      * Define null work field Dft Mode of Transportaton
     C                   EVAL      YN0165 = ' '
      * Define null work field Buying Group
     C                   EVAL      YN0166 = ' '
      * Define null work field Buying Group Opt In_Out
     C                   EVAL      YN0167 = ' '
      * Define null work field Ship To Establishment nbr
     C                   EVAL      YN0168 = ' '
      * Define null work field PM Pallet Type
     C                   EVAL      YN0169 = ' '
      * Define null work field Cust Dft Price Type
     C                   EVAL      YN0170 = ' '
      * Define null work field Cust Dft Age Days
     C                   Z-ADD     *ZERO         YN0171
      * Define local work field Requested Delivery Time
     C                   Z-ADD     *ZERO         YL0264
      * Define local work field Shipping Method
     C                   EVAL      YL0265 = ' '
      * Define null work field Warehouse Description
     C                   EVAL      YN0172 = ' '
      * Define null work field Address Line 1
     C                   EVAL      YN0173 = ' '
      * Define null work field Address Line 2
     C                   EVAL      YN0174 = ' '
      * Define null work field Address Line 3
     C                   EVAL      YN0175 = ' '
      * Define null work field City
     C                   EVAL      YN0176 = ' '
      * Define null work field Zip Postal Code
     C                   EVAL      YN0177 = ' '
      * Define local work field Production Warehouse
     C                   EVAL      YL0266 = ' '
      * Define null work field State Code
     C                   EVAL      YN0178 = ' '
      * Define null work field Lot Tracking Flag
     C                   EVAL      YN0179 = ' '
      * Define null work field Default Printer
     C                   EVAL      YN0180 = ' '
      * Define local work field Warehouse Type
     C                   EVAL      YL0267 = ' '
      * Define local work field Trans Contol AS400_Plant
     C                   EVAL      YL0268 = ' '
      * Define null work field Warehouse Location
     C                   EVAL      YN0181 = ' '
      * Define null work field Warehouse Std Chill Time
     C                   EVAL      YN0182 = ' '
      * Define null work field Warehouse Chill Time
     C                   Z-ADD     *ZERO         YN0183
      * Define null work field Include in Auto Pre Pick
     C                   EVAL      YN0184 = ' '
      * Define null work field Default Manifest Copies
     C                   EVAL      YN0185 = ' '
      * Define null work field Default Load Sequence
     C                   EVAL      YN0186 = ' '
      * Define null work field WHS Slotting Limit Type
     C                   EVAL      YN0187 = ' '
      * Define null work field Shipping Company
     C                   Z-ADD     *ZERO         YN0188
      * Define null work field Accounting Company
     C                   Z-ADD     *ZERO         YN0189
      * Define null work field WHS Sched Prod Max Days
     C                   Z-ADD     *ZERO         YN0190
      * Define null work field WHS Inventory Chill Time
     C                   Z-ADD     *ZERO         YN0191
      * Define null work field Parent Warehouse
     C                   EVAL      YN0192 = ' '
      * Define null work field Default Shipping Whs
     C                   EVAL      YN0193 = ' '
      * Define null work field WHS Live with Carlisle
     C                   EVAL      YN0194 = ' '
      * Define null work field WHS PFS Interface
     C                   EVAL      YN0195 = ' '
      * Define null work field WHS Req Meter Reading Shp
     C                   EVAL      YN0196 = ' '
      * Define null work field WHS Default Load Type
     C                   EVAL      YN0197 = ' '
      * Define null work field WHS TMS Planning Region
     C                   EVAL      YN0198 = ' '
      * Define null work field Default Carrier Code
     C                   EVAL      YN0199 = ' '
      * Define null work field Inventory Logic Version
     C                   EVAL      YN0200 = ' '
      * Define null work field WHS Auto Inv Restoration
     C                   EVAL      YN0201 = ' '
      * Define null work field EDI Status 1
     C                   EVAL      YN0202 = ' '
      * Define null work field EDI Status 2
     C                   EVAL      YN0203 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0204 = ' '
      * Define null work field Record Status
     C                   EVAL      YN0205 = ' '
      * Define null work field Reefer Temperature Dft
     C                   Z-ADD     *ZERO         YN0206
      * Define local work field Temperature Code C_F
     C                   EVAL      YL0269 = ' '
      * Define local work field Reefer Temperature
     C                   Z-ADD     *ZERO         YL0270
      * Define local work field Palletize
     C                   EVAL      YL0271 = ' '
      * Define local work field Shrink Wrap
     C                   EVAL      YL0272 = ' '
      * Define local work field Slip Sheet
     C                   EVAL      YL0273 = ' '
      * Define local work field USR Update Flag
     C                   EVAL      YL0274 = ' '
      * Define local work field Item Code
     C                   Z-ADD     *ZERO         YL0275
      * Define local work field Warehouse Code
     C                   EVAL      YL0276 = ' '
      * Define local work field Ship To Customer
     C                   Z-ADD     *ZERO         YL0277
      * Define local work field Order Group Code
     C                   Z-ADD     *ZERO         YL0278
      * Define local work field Detail Line Status
     C                   EVAL      YL0279 = ' '
      * Define local work field Detail Line Status Last
     C                   EVAL      YL0280 = ' '
      * Define local work field Billing Detail Cost Dol
     C                   Z-ADD     *ZERO         YL0281
      * Define local work field Billing Detail Gross Dol
     C                   Z-ADD     *ZERO         YL0282
      * Define local work field Billing Detail Net Dol
     C                   Z-ADD     *ZERO         YL0283
      * Define local work field Quantity to Substitute
     C                   Z-ADD     *ZERO         YL0284
      * Define local work field Comment Print Acknowledge
     C                   EVAL      YL0285 = ' '
      * Define local work field Comment Print Inv_Cr_Memo
     C                   EVAL      YL0286 = ' '
      * Define local work field Comment Print Pick Slip
     C                   EVAL      YL0287 = ' '
      * Define local work field Comment Print Ship Doc
     C                   EVAL      YL0288 = ' '
      * Define local work field Extended Amount
     C                   Z-ADD     *ZERO         YL0289
      * Define local work field Market Pricing Date
     C                   Z-ADD     *ZERO         YL0290
      * Define local work field Commodity Market Code
     C                   EVAL      YL0291 = ' '
      * Define local work field Date Method Code
     C                   EVAL      YL0292 = ' '
      * Define local work field Price Method Code
     C                   EVAL      YL0293 = ' '
      * Define local work field Price Overage Override
     C                   Z-ADD     *ZERO         YL0294
      * Define local work field Contract Number
     C                   Z-ADD     *ZERO         YL0295
      * Define local work field Price Status
     C                   EVAL      YL0296 = ' '
      * Define local work field Pricing Date Used
     C                   Z-ADD     *ZERO         YL0297
      * Define local work field U_M_Base Price
     C                   EVAL      YL0298 = ' '
      * Define local work field U_M_Ordered
     C                   EVAL      YL0299 = ' '
      * Define local work field Work Confirm Status
     C                   EVAL      YL0300 = ' '
      * Define local work field Work Over_Short Status
     C                   EVAL      YL0301 = ' '
      * Define local work field OD Production Plan Sts
     C                   EVAL      YL0302 = ' '
      * Define local work field Order Desc_Line One
     C                   EVAL      YL0303 = ' '
      * Define local work field Order Desc_Line Two
     C                   EVAL      YL0304 = ' '
      * Define local work field Age Code
     C                   EVAL      YL0305 = ' '
      * Define local work field Palletize
     C                   EVAL      YL0306 = ' '
      * Define local work field Slip Sheet
     C                   EVAL      YL0307 = ' '
      * Define local work field Catch Weight Status
     C                   EVAL      YL0308 = ' '
      * Define local work field Price Audit
     C                   EVAL      YL0309 = ' '
      * Define local work field Price Audit Reason Code
     C                   EVAL      YL0310 = ' '
      * Define local work field Production Date Control
     C                   EVAL      YL0311 = ' '
      * Define local work field Rated Freight
     C                   Z-ADD     *ZERO         YL0312
      * Define local work field Quantity Ordered
     C                   Z-ADD     *ZERO         YL0313
      * Define local work field Weight Ordered
     C                   Z-ADD     *ZERO         YL0314
      * Define local work field Quantity Scheduled
     C                   Z-ADD     *ZERO         YL0315
      * Define local work field Weight Scheduled
     C                   Z-ADD     *ZERO         YL0316
      * Define local work field Quantity Shipped Total
     C                   Z-ADD     *ZERO         YL0317
      * Define local work field Weight Shipped Total
     C                   Z-ADD     *ZERO         YL0318
      * Define local work field Unit Cost Pricing U_M
     C                   Z-ADD     *ZERO         YL0319
      * Define local work field Unit Cost Per Pound
     C                   Z-ADD     *ZERO         YL0320
      * Define local work field Unit Price
     C                   Z-ADD     *ZERO         YL0321
      * Define local work field Unit Price_Credit
     C                   Z-ADD     *ZERO         YL0322
      * Define local work field Unit Price Ordered U_M
     C                   Z-ADD     *ZERO         YL0323
      * Define local work field Unit Weight Ordered U_M
     C                   Z-ADD     *ZERO         YL0324
      * Define local work field Tare Weight Total
     C                   Z-ADD     *ZERO         YL0325
      * Define local work field Requested Ship Date
     C                   Z-ADD     *ZERO         YL0326
      * Define local work field Scheduled Ship Date
     C                   Z-ADD     *ZERO         YL0327
      * Define local work field Actual Shipped Date
     C                   Z-ADD     *ZERO         YL0328
      * Define local work field Affect Inventory Status
     C                   EVAL      YL0329 = ' '
      * Define local work field Affect Sales Doll Status
     C                   EVAL      YL0330 = ' '
      * Define local work field Affect Sales Pnds Status
     C                   EVAL      YL0331 = ' '
      * Define local work field Item Structure Type Code
     C                   Z-ADD     *ZERO         YL0332
      * Define local work field Item Structure Group Code
     C                   Z-ADD     *ZERO         YL0333
      * Define local work field Item Structure Class Code
     C                   Z-ADD     *ZERO         YL0334
      * Define local work field Item Level
     C                   EVAL      YL0335 = ' '
      * Define local work field Quality Level
     C                   EVAL      YL0336 = ' '
      * Define local work field Pricing Product Class Rep
     C                   EVAL      YL0337 = ' '
      * Define local work field Season Product Class Repo
     C                   EVAL      YL0338 = ' '
      * Define local work field Date of Original Entry
     C                   Z-ADD     *ZERO         YL0339
      * Define local work field User Profile Name
     C                   EVAL      YL0340 = ' '
      * Define local work field Country Code
     C                   EVAL      YL0341 = ' '
      * Define local work field Event Code
     C                   EVAL      YL0342 = ' '
      * Define local work field Reason Code
     C                   EVAL      YL0343 = ' '
      * Define local work field Sales Route Code
     C                   EVAL      YL0344 = ' '
      * Define local work field Modified Flag
     C                   EVAL      YL0345 = ' '
      * Define local work field Substituted Flag
     C                   EVAL      YL0346 = ' '
      * Define local work field OD Schedule Override Sts
     C                   EVAL      YL0347 = ' '
      * Define local work field Invoice Unit Price
     C                   Z-ADD     *ZERO         YL0348
      * Define local work field Invoice Extended Amt
     C                   Z-ADD     *ZERO         YL0349
      * Define local work field Ham Group Number
     C                   Z-ADD     *ZERO         YL0350
      * Define local work field OD Adj Type Override
     C                   EVAL      YL0351 = ' '
      * Define local work field Affect Trade Fund
     C                   EVAL      YL0352 = ' '
      * Define local work field Affect Commission
     C                   EVAL      YL0353 = ' '
      * Define local work field Affect Pricing
     C                   EVAL      YL0354 = ' '
      * Define local work field Released by User Sts Y_N
     C                   EVAL      YL0355 = ' '
      * Define local work field Ord TF Exempt Code
     C                   EVAL      YL0356 = ' '
      * Define local work field OD Pallet Type
     C                   EVAL      YL0357 = ' '
      * Define local work field Production Warehouse
     C                   EVAL      YL0358 = ' '
      * Define local work field OD Price Type
     C                   EVAL      YL0359 = ' '
      * Define local work field Warehouse Pallets Loaded
     C                   Z-ADD     *ZERO         YL0360
      * Define local work field Consumed Item Code
     C                   Z-ADD     *ZERO         YL0361
      * Define local work field Deadline Depart Date LH
     C                   Z-ADD     *ZERO         YL0362
      * Define local work field OD Price Type Ref Num
     C                   Z-ADD     *ZERO         YL0363
      * Define local work field OD Firm Date
     C                   Z-ADD     *ZERO         YL0364
      * Define local work field Deadline Depart Time LH
     C                   Z-ADD     *ZERO         YL0365
      * Define local work field Price Code
     C                   Z-ADD     *ZERO         YL0366
      * Define local work field Maximum Net Weight
     C                   Z-ADD     *ZERO         YL0367
      * Define local work field Substitution Line Number
     C                   Z-ADD     *ZERO         YL0368
      * Define local work field Max Qty to sched per day
     C                   Z-ADD     *ZERO         YL0369
      * Define local work field Warehouse Pallet Tare
     C                   Z-ADD     *ZERO         YL0370
      * Define local work field Warehouse Avg Pallet Tare
     C                   Z-ADD     *ZERO         YL0371
      * Define local work field OD Item Target Price
     C                   Z-ADD     *ZERO         YL0372
      * Define local work field OD Estimated Gross Weight
     C                   Z-ADD     *ZERO         YL0373
      * Define local work field OD Maximum Unit Weight
     C                   Z-ADD     *ZERO         YL0374
      * Define local work field Order Gate_Final Price
     C                   Z-ADD     *ZERO         YL0375
      * Define local work field OD Ceiling Price
     C                   Z-ADD     *ZERO         YL0376
      * Define local work field OD Gate_Final Price Adj
     C                   Z-ADD     *ZERO         YL0377
      * Define local work field OD Weighted Avg Price
     C                   Z-ADD     *ZERO         YL0378
      * Define local work field OD Original Ordered Qty
     C                   Z-ADD     *ZERO         YL0379
      * Define local work field OD Cancel Date
     C                   Z-ADD     *ZERO         YL0380
      * Define local work field OD Unused Prc 7
     C                   Z-ADD     *ZERO         YL0381
      * Define local work field OD Unused Prc 8
     C                   Z-ADD     *ZERO         YL0382
      * Define local work field OD MPR Sent to USDA Sts
     C                   EVAL      YL0383 = ' '
      * Define local work field OD MPR Prc Ready to Send
     C                   EVAL      YL0384 = ' '
      * Define local work field OD UnUsed Price Sts 3
     C                   EVAL      YL0385 = ' '
      * Define local work field Weight Amount Entered
     C                   Z-ADD     *ZERO         YL0386
      * Define local work field Item Age Days
     C                   Z-ADD     *ZERO         YL0387
      * Define local work field Production Ovr AgeDte Fr
     C                   Z-ADD     *ZERO         YL0388
      * Define local work field Production Ovr AgeDte To
     C                   Z-ADD     *ZERO         YL0389
      * Define local work field OD Spot Buy
     C                   EVAL      YL0390 = ' '
      * Define local work field OD Clm Full Return to Plt
     C                   EVAL      YL0391 = ' '
      * Define local work field Order Line Error Type
     C                   EVAL      YL0392 = ' '
      * Define local work field OD Market Begin Date
     C                   Z-ADD     *ZERO         YL0393
      * Define local work field OD Market Ending Date
     C                   Z-ADD     *ZERO         YL0394
      * Define local work field OD Atch to Ord ActShpDte
     C                   Z-ADD     *ZERO         YL0395
      * Define local work field EDI Status 1
     C                   EVAL      YL0396 = ' '
      * Define local work field EDI Status 2
     C                   EVAL      YL0397 = ' '
      * Define local work field EDI Status 3
     C                   EVAL      YL0398 = ' '
      * Define local work field Job Time
     C                   Z-ADD     *ZERO         YL0399
      * Define local work field User Id
     C                   EVAL      YL0400 = ' '
      * Define local work field Job Name
     C                   EVAL      YL0401 = ' '
      * Define local work field Job Date
     C                   Z-ADD     *ZERO         YL0402
      * Define null work field M3 Supplier ID
     C                   EVAL      YN0207 = ' '
      * Define null work field Dft Mode of Transportaton
     C                   EVAL      YN0208 = ' '
      * Define null work field Buying Group
     C                   EVAL      YN0209 = ' '
      * Define null work field Buying Group Opt In_Out
     C                   EVAL      YN0210 = ' '
      * Define null work field Ship To Establishment nbr
     C                   EVAL      YN0211 = ' '
      * Define null work field Cust Dft Price Type
     C                   EVAL      YN0212 = ' '
      * Define null work field Cust Dft Age Days
     C                   Z-ADD     *ZERO         YN0213
      * Define null work field Cust Dft Delivery Time
     C                   Z-ADD     *ZERO         YN0214
      * Define local work field Text usr 11
     C                   EVAL      YL0403 = ' '
      * Define local work field Date From Convert USR
     C                   EVAL      YL0404 = ' '
      * Define local work field BOE Error Comment
     C                   EVAL      YL0405 = ' '
      * Define local work field From Date             USR
     C                   Z-ADD     *ZERO         YL0406
      * Define local work field To Date               USR
     C                   Z-ADD     *ZERO         YL0407
      * Define local work field Date 7A              USR
     C                   EVAL      YL0408 = ' '
      * Define local work field Quantity Scheduled
     C                   Z-ADD     *ZERO         YL0409
      * Define local work field Weight Scheduled
     C                   Z-ADD     *ZERO         YL0410
      * Define local work field Detail Line Status Last
     C                   EVAL      YL0411 = ' '
      * Define local work field Detail Line Status
     C                   EVAL      YL0412 = ' '
      * Define local work field Text 3 Length USR
     C                   EVAL      YL0413 = ' '
      * Define local work field Weight Beg Inv usr
     C                   Z-ADD     *ZERO         YL0414
      * Define local work field Text USR 7
     C                   EVAL      YL0415 = ' '
      * Define local work field Change Log Prior Value
     C                   EVAL      YL0416 = ' '
      * Define local work field Change Log New Value
     C                   EVAL      YL0417 = ' '
      * Define local work field USR Return Code
     C                   EVAL      YL0418 = ' '
      * Define local work field Header Status Last
     C                   EVAL      YL0419 = ' '
      * Define local work field Text 3 Length USR
     C                   EVAL      YL0420 = ' '
      * Define local work field Change Log Prior Value
     C                   EVAL      YL0421 = ' '
      * Define local work field Change Log New Value
     C                   EVAL      YL0422 = ' '
      * Define local work field Weight Beg Inv usr
     C                   Z-ADD     *ZERO         YL0423
      * Define local work field Text USR 7
     C                   EVAL      YL0424 = ' '
      * Define null work field Accounting Company
     C                   Z-ADD     *ZERO         YN0215
      * Define local work field Misc Tare Weight
     C                   Z-ADD     *ZERO         YL0425
      * Define local work field Box Weight
     C                   Z-ADD     *ZERO         YL0426
      * Define local work field Number Cases On A Pallet
     C                   Z-ADD     *ZERO         YL0427
      * Define local work field Pallet Tare Weight
     C                   Z-ADD     *ZERO         YL0428
      * Define local work field Box iD
     C                   Z-ADD     *ZERO         YL0429
      * Define local work field Total Tare USR
     C                   Z-ADD     *ZERO         YL0430
      * Define local work field Weight 1.1             .U
     C                   Z-ADD     *ZERO         YL0431
      * Define local work field Weight 1.2             .U
     C                   Z-ADD     *ZERO         YL0432
      * Define local work field Order Number
     C                   Z-ADD     *ZERO         YL0433
      * Define null work field Default Commod Mark basis
     C                   EVAL      YN0216 = ' '
      * Define null work field Transportation Temp
     C                   Z-ADD     *ZERO         YN0217
      * Define local work field Item Type Code
     C                   EVAL      YL0434 = ' '
      * Define null work field Commodity Price Group
     C                   EVAL      YN0218 = ' '
      * Define null work field Default Warehouse
     C                   EVAL      YN0219 = ' '
      * Define null work field Price Method Default
     C                   EVAL      YN0220 = ' '
      * Define null work field Fresh Chilling Time
     C                   Z-ADD     *ZERO         YN0221
      * Define local work field Variety_Rendered_Cut
     C                   EVAL      YL0435 = ' '
      * Define local work field Sold 100 Percent Frozen
     C                   EVAL      YL0436 = ' '
      * Define local work field Error Status
     C                   EVAL      YL0437 = ' '
      * Define local work field TF Co_Ownership Sts
     C                   EVAL      YL0438 = ' '
      * Define null work field Description Line One
     C                   EVAL      YN0222 = ' '
      * Define local work field Default Commod Mark basis
     C                   EVAL      YL0439 = ' '
      * Define local work field Market Overage
     C                   Z-ADD     *ZERO         YL0440
      * Define null work field Standard Overage_Underage
     C                   Z-ADD     *ZERO         YN0223
      * Define local work field Commodity Price Group
     C                   EVAL      YL0441 = ' '
      * Define null work field Std Weight_Head_Var_Ren
     C                   Z-ADD     *ZERO         YN0224
      * Define local work field Primal Group Code
     C                   EVAL      YL0442 = ' '
      * Define local work field Customer TF Exempt Code
     C                   EVAL      YL0443 = ' '
      * Define local work field OH TF Exempt Code
     C                   EVAL      YL0444 = ' '
      * Define local work field OH TF Exempt Error Cde U
     C                   EVAL      YL0445 = ' '
      * Define local work field Warehouse Type
     C                   EVAL      YL0446 = ' '
      * Define local work field Load Type
     C                   EVAL      YL0447 = ' '
      * Define local work field Plan Production Sts
     C                   EVAL      YL0448 = ' '
      * Define local work field Production AgeDte Fr
     C                   Z-ADD     *ZERO         YL0449
      * Define local work field Production AgeDte To
     C                   Z-ADD     *ZERO         YL0450
      * Define local work field Company Organization
     C                   EVAL      YL0451 = ' '
      * Define local work field Error Reason Descript 1
     C                   EVAL      YL0452 = ' '
      * Define local work field Error Reason Descript 2
     C                   EVAL      YL0453 = ' '
      * Define local work field Error Reason Descript 3
     C                   EVAL      YL0454 = ' '
      * Define local work field Error Reason Descript 4
     C                   EVAL      YL0455 = ' '
      * Define local work field Error Reason Descript 5
     C                   EVAL      YL0456 = ' '
      * Define local work field Error Reason Descript 6
     C                   EVAL      YL0457 = ' '
      * Define local work field Error Reason Descript 7
     C                   EVAL      YL0458 = ' '
      * Define local work field Record Found USR
     C                   EVAL      YL0459 = ' '
      * Define local work field Credit Item Status
     C                   EVAL      YL0460 = ' '
      * Define local work field Price Method Type
     C                   EVAL      YL0461 = ' '
      * Define null work field PMH Price Type
     C                   EVAL      YN0225 = ' '
      * Define local work field Thru Date             USR
     C                   Z-ADD     *ZERO         YL0462
      * Define null work field Terms Code
     C                   EVAL      YN0226 = ' '
      * Define null work field Sales Route Code
     C                   EVAL      YN0227 = ' '
      * Define null work field Special Instructions 2
     C                   EVAL      YN0228 = ' '
      * Define null work field Special Instructions
     C                   EVAL      YN0229 = ' '
      * Define null work field Carrier Code
     C                   EVAL      YN0230 = ' '
      * Define null work field Broker
     C                   EVAL      YN0231 = ' '
      * Define null work field P_O Required Flag
     C                   EVAL      YN0232 = ' '
      * Define null work field Deliver after time
     C                   Z-ADD     *ZERO         YN0233
      * Define null work field Deliver before time
     C                   Z-ADD     *ZERO         YN0234
      * Define null work field Alt Remittance Flag
     C                   EVAL      YN0235 = ' '
      * Define null work field Type Code
     C                   EVAL      YN0236 = ' '
      * Define null work field Absorbed Freight Rate CWT
     C                   Z-ADD     *ZERO         YN0237
      * Define null work field Mileage To Customer
     C                   Z-ADD     *ZERO         YN0238
      * Define null work field Co_Cust Overage Rate CWT
     C                   Z-ADD     *ZERO         YN0239
      * Define null work field Age Code
     C                   EVAL      YN0240 = ' '
      * Define null work field Warehouse Code
     C                   EVAL      YN0241 = ' '
      * Define null work field Outside Warehouse Flag
     C                   EVAL      YN0242 = ' '
      * Define null work field Customer Group Code
     C                   EVAL      YN0243 = ' '
      * Define null work field Customer Group Code 2
     C                   EVAL      YN0244 = ' '
      * Define null work field G_L Code
     C                   EVAL      YN0245 = ' '
      * Define null work field Credit Contact Name
     C                   EVAL      YN0246 = ' '
      * Define null work field Credit Contact Telephone
     C                   EVAL      YN0247 = ' '
      * Define null work field Credit Contact Bus Title
     C                   EVAL      YN0248 = ' '
      * Define null work field Credit Contact Fax Number
     C                   EVAL      YN0249 = ' '
      * Define null work field Allow Man_Qt WO_Approval
     C                   EVAL      YN0250 = ' '
      * Define null work field Fax Invoice Flag
     C                   EVAL      YN0251 = ' '
      * Define null work field Fax Invoice Fax Number
     C                   EVAL      YN0252 = ' '
      * Define null work field Fax Invoice Contact Name
     C                   EVAL      YN0253 = ' '
      * Define null work field Distributor
     C                   EVAL      YN0254 = ' '
      * Define null work field Default Shipping Co Sts
     C                   EVAL      YN0255 = ' '
      * Define null work field Ord Ent Default Sls Rte
     C                   EVAL      YN0256 = ' '
      * Define null work field Bypass DDt_Delay w_Invcng
     C                   EVAL      YN0257 = ' '
      * Define null work field EDI Status 1
     C                   EVAL      YN0258 = ' '
      * Define null work field EDI Status 2
     C                   EVAL      YN0259 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0260 = ' '
      * Define null work field Record Status
     C                   EVAL      YN0261 = ' '
      * Define null work field Job Time
     C                   Z-ADD     *ZERO         YN0262
      * Define null work field User Id
     C                   EVAL      YN0263 = ' '
      * Define null work field Job Name
     C                   EVAL      YN0264 = ' '
      * Define null work field Job Date
     C                   Z-ADD     *ZERO         YN0265
      * Define local work field Type Code
     C                   EVAL      YL0463 = ' '
      * Define local work field Absorbed Freight Rate CWT
     C                   Z-ADD     *ZERO         YL0464
      * Define local work field Billing Activity Type
     C                   EVAL      YL0465 = ' '
      * Define local work field USR Display 4
     C                   EVAL      YL0466 = ' '
      * Define local work field Pricing Valid Error Cde U
     C                   EVAL      YL0467 = ' '
      * Define local work field Error Flag            USR
     C                   EVAL      YL0468 = ' '
      * Define local work field Blank 1 USR
     C                   EVAL      YL0469 = ' '
      * Define local work field USR Return Code
     C                   EVAL      YL0470 = ' '
      * Define local work field Status Flag 1  Y/N
     C                   EVAL      YL0471 = ' '
      * Define local work field Status Flag 1  Y/N
     C                   EVAL      YL0472 = ' '
      * Define null work field Order Type_Sales
     C                   EVAL      YN0266 = ' '
      * Define null work field AR Customer Number
     C                   Z-ADD     *ZERO         YN0267
      * Define null work field Ship To Customer
     C                   Z-ADD     *ZERO         YN0268
      * Define null work field Ship To Name
     C                   EVAL      YN0269 = ' '
      * Define null work field Ship To Address Line 1
     C                   EVAL      YN0270 = ' '
      * Define null work field Ship To Address Line 2
     C                   EVAL      YN0271 = ' '
      * Define null work field Ship To Address Line 3
     C                   EVAL      YN0272 = ' '
      * Define null work field Ship To City
     C                   EVAL      YN0273 = ' '
      * Define null work field Ship To State Code
     C                   EVAL      YN0274 = ' '
      * Define null work field Ship To Zip_Postal Code
     C                   EVAL      YN0275 = ' '
      * Define null work field Bill to Customer
     C                   Z-ADD     *ZERO         YN0276
      * Define null work field Bill to Name
     C                   EVAL      YN0277 = ' '
      * Define null work field Bill to Address Line 1
     C                   EVAL      YN0278 = ' '
      * Define null work field Bill to Address Line 2
     C                   EVAL      YN0279 = ' '
      * Define null work field Bill to Address Line 3
     C                   EVAL      YN0280 = ' '
      * Define null work field Bill to City
     C                   EVAL      YN0281 = ' '
      * Define null work field Bill to State Code
     C                   EVAL      YN0282 = ' '
      * Define null work field Bill to Zip_Postal Code
     C                   EVAL      YN0283 = ' '
      * Define null work field Customer Purchase Order #
     C                   EVAL      YN0284 = ' '
      * Define null work field Order Date
     C                   Z-ADD     *ZERO         YN0285
      * Define null work field Requested Ship Date
     C                   Z-ADD     *ZERO         YN0286
      * Define null work field Actual Shipped Date
     C                   Z-ADD     *ZERO         YN0287
      * Define null work field Cancel Date
     C                   Z-ADD     *ZERO         YN0288
      * Define null work field Terms Code
     C                   EVAL      YN0289 = ' '
      * Define null work field Special Instructions
     C                   EVAL      YN0290 = ' '
      * Define null work field Special Instructions 2
     C                   EVAL      YN0291 = ' '
      * Define null work field Comment Print Acknowledge
     C                   EVAL      YN0292 = ' '
      * Define null work field Comment Print Inv_Cr_Memo
     C                   EVAL      YN0293 = ' '
      * Define null work field Comment Print Pick Slip
     C                   EVAL      YN0294 = ' '
      * Define null work field Comment Print Ship Doc
     C                   EVAL      YN0295 = ' '
      * Define null work field Reason Code
     C                   EVAL      YN0296 = ' '
      * Define null work field Header Status Last
     C                   EVAL      YN0297 = ' '
      * Define null work field Order Type Print Status
     C                   EVAL      YN0298 = ' '
      * Define null work field Scheduled Ship Date
     C                   Z-ADD     *ZERO         YN0299
      * Define null work field User Original Entry
     C                   EVAL      YN0300 = ' '
      * Define null work field Date of Original Entry
     C                   Z-ADD     *ZERO         YN0301
      * Define null work field Order Value Total
     C                   Z-ADD     *ZERO         YN0302
      * Define null work field Order Weight Total
     C                   Z-ADD     *ZERO         YN0303
      * Define null work field Credit Hold
     C                   EVAL      YN0304 = ' '
      * Define null work field Production Hold
     C                   EVAL      YN0305 = ' '
      * Define null work field New Customer Hold
     C                   EVAL      YN0306 = ' '
      * Define null work field Requested Delivery Date
     C                   Z-ADD     *ZERO         YN0307
      * Define null work field Requested Delivery Time
     C                   Z-ADD     *ZERO         YN0308
      * Define null work field Accounts Receiv_Ent 1
     C                   EVAL      YN0309 = ' '
      * Define null work field Accounts Receiv_Ent 2
     C                   EVAL      YN0310 = ' '
      * Define null work field Load ID
     C                   Z-ADD     *ZERO         YN0311
      * Define null work field Absorbed Freight Rate CWT
     C                   Z-ADD     *ZERO         YN0312
      * Define null work field Rated Freight
     C                   Z-ADD     *ZERO         YN0313
      * Define null work field LTL Flag
     C                   EVAL      YN0314 = ' '
      * Define null work field Price Audit
     C                   EVAL      YN0315 = ' '
      * Define null work field Price Status
     C                   EVAL      YN0316 = ' '
      * Define null work field Shipping Method
     C                   EVAL      YN0317 = ' '
      * Define null work field Export Status
     C                   EVAL      YN0318 = ' '
      * Define null work field Palletize
     C                   EVAL      YN0319 = ' '
      * Define null work field Shrink Wrap
     C                   EVAL      YN0320 = ' '
      * Define null work field Slip Sheet
     C                   EVAL      YN0321 = ' '
      * Define null work field Age Code
     C                   EVAL      YN0322 = ' '
      * Define null work field Reefer Temperature
     C                   Z-ADD     *ZERO         YN0323
      * Define null work field Load Type
     C                   EVAL      YN0324 = ' '
      * Define null work field Attach to Invoice Number
     C                   Z-ADD     *ZERO         YN0325
      * Define null work field Load Plan Order
     C                   EVAL      YN0326 = ' '
      * Define null work field Print Pick Slip
     C                   EVAL      YN0327 = ' '
      * Define null work field Resell Reference Number
     C                   Z-ADD     *ZERO         YN0328
      * Define null work field Special Comment 1
     C                   EVAL      YN0329 = ' '
      * Define null work field Special Comment 2
     C                   EVAL      YN0330 = ' '
      * Define null work field Affect Auto Accruals
     C                   EVAL      YN0331 = ' '
      * Define null work field Sales Route Code
     C                   EVAL      YN0332 = ' '
      * Define null work field Manager Level Code
     C                   EVAL      YN0333 = ' '
      * Define null work field VP Level Code
     C                   EVAL      YN0334 = ' '
      * Define null work field Attach to Order Number
     C                   Z-ADD     *ZERO         YN0335
      * Define null work field Reason for Price Audit
     C                   EVAL      YN0336 = ' '
      * Define null work field Invoice Number
     C                   Z-ADD     *ZERO         YN0337
      * Define null work field Invoice Suffix
     C                   EVAL      YN0338 = ' '
      * Define null work field Invoice Date
     C                   Z-ADD     *ZERO         YN0339
      * Define null work field Event Code
     C                   EVAL      YN0340 = ' '
      * Define null work field Trans Contol AS400_Plant
     C                   EVAL      YN0341 = ' '
      * Define null work field Modified Flag
     C                   EVAL      YN0342 = ' '
      * Define null work field A_R order Value Total
     C                   Z-ADD     *ZERO         YN0343
      * Define null work field Billing Activity Type
     C                   EVAL      YN0344 = ' '
      * Define null work field Order Certification Flag
     C                   EVAL      YN0345 = ' '
      * Define null work field Invoice Order Value Tot
     C                   Z-ADD     *ZERO         YN0346
      * Define null work field Process Sts for 3C
     C                   EVAL      YN0347 = ' '
      * Define null work field Order Conf Fax Sts
     C                   EVAL      YN0348 = ' '
      * Define null work field Manifest Fax Sts
     C                   EVAL      YN0349 = ' '
      * Define null work field Invoice Fax Sts
     C                   EVAL      YN0350 = ' '
      * Define null work field Transfer in Storage Ind
     C                   EVAL      YN0351 = ' '
      * Define null work field Email Cust On Order Ship
     C                   EVAL      YN0352 = ' '
      * Define null work field Order Emailed
     C                   EVAL      YN0353 = ' '
      * Define null work field Export Docs Go w_Driver
     C                   EVAL      YN0354 = ' '
      * Define null work field Shipping Temp Code C_F
     C                   EVAL      YN0355 = ' '
      * Define null work field Broker Order Status
     C                   EVAL      YN0356 = ' '
      * Define null work field Air Freight Order
     C                   EVAL      YN0357 = ' '
      * Define null work field Order Requires Review
     C                   EVAL      YN0358 = ' '
      * Define null work field OH Load Plan Ready
     C                   EVAL      YN0359 = ' '
      * Define null work field Export USDA Approved
     C                   EVAL      YN0360 = ' '
      * Define null work field HPB Ship to Warehouse
     C                   EVAL      YN0361 = ' '
      * Define null work field OH TF Exempt Code
     C                   EVAL      YN0362 = ' '
      * Define null work field OH Appt Confirmation Dt
     C                   Z-ADD     *ZERO         YN0363
      * Define null work field JPN Invoice Issuance Date
     C                   Z-ADD     *ZERO         YN0364
      * Define null work field Load Actual Shipped Date
     C                   Z-ADD     *ZERO         YN0365
      * Define null work field Load BOL Complete Date
     C                   Z-ADD     *ZERO         YN0366
      * Define null work field Load Truck Departure Date
     C                   Z-ADD     *ZERO         YN0367
      * Define null work field Maximum Gross Weight
     C                   Z-ADD     *ZERO         YN0368
      * Define null work field Time of Original Entry
     C                   Z-ADD     *ZERO         YN0369
      * Define null work field OH Appt Confirmation Tm
     C                   Z-ADD     *ZERO         YN0370
      * Define null work field Load BOL Complete Time
     C                   Z-ADD     *ZERO         YN0371
      * Define null work field Load Truck Departure Time
     C                   Z-ADD     *ZERO         YN0372
      * Define null work field Act Frt Reference Amount
     C                   Z-ADD     *ZERO         YN0373
      * Define null work field Act Non_Ref Frt Amount
     C                   Z-ADD     *ZERO         YN0374
      * Define null work field OH Fuel Surcharge Amount
     C                   Z-ADD     *ZERO         YN0375
      * Define null work field OH Total Non_Ref Frt Amt
     C                   Z-ADD     *ZERO         YN0376
      * Define null work field OH Total Ref Frt Amt
     C                   Z-ADD     *ZERO         YN0377
      * Define null work field Claim Number
     C                   Z-ADD     *ZERO         YN0378
      * Define local work field From Date             USR
     C                   Z-ADD     *ZERO         YL0473
      * Define local work field To Date               USR
     C                   Z-ADD     *ZERO         YL0474
      * Define local work field Date 7A              USR
     C                   EVAL      YL0475 = ' '
      * Define local work field USR Return Code
     C                   EVAL      YL0476 = ' '
      * Define local work field Quantity Scheduled
     C                   Z-ADD     *ZERO         YL0477
      * Define local work field Weight Scheduled
     C                   Z-ADD     *ZERO         YL0478
      * Define local work field Detail Line Status Last
     C                   EVAL      YL0479 = ' '
      * Define local work field Detail Line Status
     C                   EVAL      YL0480 = ' '
      * Define local work field Header Status Last
     C                   EVAL      YL0481 = ' '
      * Define local work field Header Status Last
     C                   EVAL      YL0482 = ' '
      * Define local work field Library List Code
     C                   EVAL      YL0483 = ' '
      * Define null work field @Library List Code
     C                   EVAL      YN0379 = ' '
      * Define local work field Email Address
     C                   EVAL      YL0484 = ' '
      * Define local work field Send Email USR
     C                   EVAL      YL0485 = ' '
      * Define local work field Email Sent
     C                   EVAL      YL0486 = ' '
      * Define local work field First Time Through USR
     C                   EVAL      YL0487 = ' '
      * Define local work field Count Records        USR
     C                   Z-ADD     *ZERO         YL0488
      * Define local work field Count Records        USR
     C                   Z-ADD     *ZERO         YL0489
      * Define local work field Email Subject 2 USR
     C                   EVAL      YL0490 = ' '
      * Define local work field Text USR 9
     C                   EVAL      YL0491 = ' '
      * Define local work field Email Message 2 USR
     C                   EVAL      YL0492 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 Surrogate ID #:
00002 is already present.
00003 Y2U0005
00004 Invalid Company
00005 Invalid Bill to
00006 Invalid Ship to
00007 Customer #
00008 Ship To Customer Flag
00009 not use as Ship To
00010 Customer is held for
00011 New Orders
00012 Company Customer not
00013 Sales Route not found in
00014 Company Customer
00015 Salesperson Code not
00016 found in Sales Route
00017 Type Code is not set in
00018 Salesperson Electronic
00019 CM Table
00020 Salesperson is not assign
00021 ed a Sales Route
00022 Shipping Method is not
00023 a Valid Value.
00024 Intended for Export canno
00025 t be entered for Export
00026 Type code is not setup as
00027  Export.
00028 Export Status Should Be Y
00029 es For Exporting.
00030 Load Type cannot be Blank
00031 Palletize cannot be blank
00032 in Company Defaults file
00033 Slip Sheet cannot be blan
00034 k in Company Default file
00035 Cust is Outside WHS,but O
00036 rder Type not WHS XFR
00037 Warehouse Code is Invalid
00038  in Warehouse Codes file.
00039 FZNCHLTME
00040 Requested Ship Date not y
00041 et in Calendar File
00042 Invalid Requested Ship Da
00043 te Format.
00044 Invalid Spot Buy Value
00045 Invalid Purchase Order Nu
00046 Export Status must be Ent
00047 Country Code does not Exi
00048 st or is Inactive
00049 Intended for Export Count
00050 ry not exist or Inactive
00051 Both Intend for Exprt and
00052 Country can't be entered.
00053 Invalid Requested Deliver
00054 y Date Format.
00055 USR0018
00056 Requested Delivery Date N
00057 ot Found In Calendar.
00058 y Date.
00059 Order should have already
00060  shipped
00061 Deadline after Delivery
00062 Must Ship after Deadline
00063 Scheduled Ship after Must
00064 No Miles Between Cities
00065 Requested Ship Date shoul
00066 d = Must Ship
00067 Order must be shipped on
00068 or before:
00069 INFORMATIC
00070 0001-01-01-00.00.00.00000
00071 Invalid Item Code
00072 TFEXE1
00073 Error-Item Must be Non Co
00074 -Owned for Exempt Cust
00075 TFEXE2
00076 TF Exempt Error-Can't mix
00077  exempt/non-exempt items
00078 Item Level not Found
00079 Ordered Items Must be Fin
00080 ished Goods
00081 Item Invalid. Sold 100% F
00082 Bulk Items cannot be on R
00083 egular Order Type
00084 Only Bulk Items can be on
00085  a Bulk Order Load Type
00086 Unit Cost for Warehouse c
00087 annot be 0
00088 Item Balance not found.
00089 Inv Prod Ovr Age Fr/To Dt
00090 Production Date is Invali
00091 d for Requested Ship Date
00092 Enter Age Days or Product
00093 ion Override Age Frm/To
00094 Override Dates after Ship
00095 ped Date.
00096 Invalid Itm Age Days in I
00097 tm Age Info Validation.
00098 Ham Group is Required for
00099  Item Code.
00100 Ham Group Item is not fou
00101 Invalid Quantity Ordered.
00102 Invalid Price Method Code
00103 Invalid Item Age Days.
00104 Invalid OD Price Type.
00105 Invalid Market Pricing Da
00106 Invalid MPR Ready Status.
00107 Cannot send to MPR with p
00108 rice <=.01
00109 PRCER1
00110 Price Code must be Zero f
00111 or Price Method Code.
00112 Price Code must be zero f
00113 PRCER2
00114 Price Code not found for
00115 Cust or Invalid Dt Range
00116 PRCER3
00117 Price Code not Valid for
00118 Start/End Dates.
00119 PRCER4
00120 Price Code not Found for
00121 Item Code.
00122 PRCER5
00123 Price Code Required for P
00124 ricing Method.
00125 PRCER6
00126 Mkt Pricing Dt & Mkt Prc
00127 Dt Rng can't both exist.
00128 PRCER7
00129 Market Price Date Range I
00130 nvalid.
00131 PRCER8
00132 Price Override not Allowe
00133 d with Price Method.
00134 PRCER9
00135 Date Method Code not Allo
00136 wed for Price Method.
00137 PRCERB
00138 Market Pricing Date Range
00139  must be 0 for Prc Method
00140 PRCERC
00141 Price Override Required f
00142 or Price Method.
00143 PRCERD
00144 Market Code not allowed f
00145 PRCERE
00146 Date Method Code not allo
00147 PRCERF
00148 Mkt Prc Dt or Dt Range mu
00149 st be 0 for Price Method.
00150 PRCERG
00151 No Price Found for Commod
00152 ity Market Code/Group.
00153 PRCERH
00154 Market Code not Allowed f
00155 PRCERI
00156 PRCERJ
00157 Ceiling Price is Required
00158  for Pricing Method.
00159 PRCERK
00160 Market Prc Dt or Dt Range
00161  must be 0 for Prc Methd
00162 PRCERL
00163 Price Overage Override no
00164 t allowed for Price Mthd
00165 PRCERM
00166 Market Code must be enter
00167 ed for Price Method.
00168 PRCERN
00169 Date Method is Invalid.
00170 PRCERO
00171 Dt Mthd & Mkt Prc Dt or D
00172 t Range not Allowed.
00173 PRCERP
00174 Date Method is Invalid
00175 PRCERQ
00176 Market Pricing Date/Range
00177  can be entered not both.
00178 PRCERR
00179 PRCERS
00180 No Price can be found for
00181  Market Code/Group
00182 PRCERT
00183 Max Cntrct Units for Item
00184 /Prc cd wgt alloc exceed
00185 Can't mix Exempt & Non Ex
00186 empt items for Customer.
00187 OPBFCPW0
00188 OPBGWKW0
00189 OPBFCPL*
00190 OPBFCPN*
00191 OPBFCPW*
00192 OPBFCPP
00193 OPBGWKN*
00194 OPBGWKL*
00195 OPBGWKW*
00196 OPBGWKP
00197 OMCRWKL*
00198 OMCRWKP
00199 OPCPCPL*
00200 OPCPCPP
00201 PDIECPL*
00202 PDIECPP
00203 PDMRREL*
00204 PDMRREP
00205 PNGTCPL*
00206 PNGTCPP
00207 PDMSREL*
00208 PDMSREP
00209 PUA6CPL*
00210 PUA6CPP
00211 Order is No longer in Blo
00212 ck Order status.
00213 Order is Confirmed or Com
00214 plete. No change allowed.
00215 Order is In Use and canno
00216 t be changed.
00217 Block Order already exist
00218 s in OMS, can not create.
00219 Order has been updated af
00220 ter the upload.
00221 Invalid Surrogate Number.
00222 Requested Shipping Date N
00223 Requested Delivery Date n
00224 ot yet in Calendar File
00225 AUTOUPLOAD
00226 Invalid Cancel Date Forma
00227 Cancel Date Not Found In
00228  Calendar.
00229 Cancel Date is out of Ran
00230 ge. Must be + - 7 days.
00231 Ivalid Item Code
00232 Firm Order can not be can
00233 celled using automation.
00234 DTALIB
00235 HISLIB
00236 PRKFLIB
00237 AUTBORTST
00238 AUTBOREML
00239 Block Order Automation Er
00240 Surrogate #:
00241 - TEST
