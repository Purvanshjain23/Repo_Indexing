     H/TITLE Clc Kill/Rend/Cut Val XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:11:24
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB1CPL4IF  E           K        DISK
      * RSQ : Carcass Detail            Co/KDte/Tto/HtWgt/Ln%
      *
     I@B1CPNT
      * Carcass Detail            Co/KDte/Tto/HtWgt/Ln%
      * Renamed input format fields
     I              B1HMNB                          WAHMNB
     I              B1BNNB                          WABNNB
     I              B1BONB                          WABONB
     I              B1CVNB                          WACVNB
     I              B1B0DT                          WAB0DT
     I              B1LGNB                          WALGNB
     I              B1EUNB                          WAEUNB
     I              B1LHNB                          WALHNB
     I              B1INST                          WAINST
     I              B1BEPR                          WABEPR
     I              B1ASPC                          WAASPC
     I              B1EWNB                          WAEWNB
     I              B1B4PR                          WAB4PR
     I              B1EYNB                          WAEYNB
     I              B1B1PR                          WAB1PR
     I              B1AVPR                          WAAVPR
     I              B1AUPC                          WAAUPC
     I              B1AWPR                          WAAWPR
     I              B1AXPR                          WAAXPR
     I              B1EZNB                          WAEZNB
     I              B1AYPR                          WAAYPR
     I              B1BBDT                          WABBDT
     I              B1AKTM                          WAAKTM
     I              B1IQST                          WAIQST
     I              B1EFST                          WAEFST
     I              B1H6NB                          WAH6NB
     I              B1BEPC                          WABEPC
     I              B1GCST                          WAGCST
     I              B1GDST                          WAGDST
     I              B1GEST                          WAGEST
     I              B1BHPC                          WABHPC
     I              B1IOST                          WAIOST
     I              B1IPST                          WAIPST
     I              B1LTNB                          WALTNB
     I              B1JNST                          WAJNST
     I              B1X4NB                          WAX4NB
     I              B1FNPC                          WAFNPC
     I              B1FOPC                          WAFOPC
     I              B1FPPC                          WAFPPC
     I              B1K2ST                          WAK2ST
     I              B1K3ST                          WAK3ST
     I              B1JWPR                          WAJWPR
     I              B1F5PC                          WAF5PC
     I              B1JXPR                          WAJXPR
     I              B1JYPR                          WAJYPR
     I              B1JZPR                          WAJZPR
     I              B1J0PR                          WAJ0PR
     I              B1J1PR                          WAJ1PR
     I              B1J2PR                          WAJ2PR
     I              B1J3PR                          WAJ3PR
     I              B1J4PR                          WAJ4PR
     I              B1UTST                          WAUTST
     I              B1HVCD                          WAHVCD
     I              B1DKJR                          WADKJR
     I              B1ITJF                          WAITJF
     I              B1IJGR                          WAIJGR
     I              B1ORJE                          WAORJE
     I              B1OTJR                          WAOTJR
     I              B1PEIR                          WAPEIR
     I              B1IEUF                          WAIEUF
     I              B1ORUE                          WAORUE
     I              B1IUTR                          WAIUTR
     I              B1IJRR                          WAIJRR
     I              B1VCST                          WAVCST
     I              B1VDST                          WAVDST
     I              B1VEST                          WAVEST
     I              B1VFST                          WAVFST
     I              B1VGST                          WAVGST
     I              B1ABCD                          WAABCD
     I              B1AACD                          WAAACD
     I              B1AAVN                          WAAAVN
     I              B1AADT                          WAAADT
     I              B1AMTM                          WAAMTM
     I              B1AJST                          WAAJST
     I              B1AHVN                          WAAHVN
     I              B1AGVN                          WAAGVN
     I              B1ABVN                          WAABVN
     I              B1ABDT                          WAABDT
     I              B1ABTM                          WAABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  TH Kill Date
     I                                    P   3   60P1B0DT
      * I :  Cutout Matrix Code USR
     I                                        7  12 P1C9CD
      * I :  Effective Month/Day USR
     I                                    P  13  150P1KLNB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Oms Warehouse Code
     I                                        1   3 P2J8NB
      * N :  CC Company Number
     I                                    P   4   50P2HONB
      * N :  Oms Application Code
     I                                        6  11 P2C7CD
      * N :  Oms SalesPerson Code
     I                                       12  14 P2C8CD
      * N :  Oms Allow Multi-Company
     I                                       15  15 P2G8ST
      * N :  Oms Default Printer
     I                                       16  25 P2G9ST
      * N :  Oms Name
     I                                       26  55 P2EUTX
      * N :  Oms System Value Alpha
     I                                       56  95 P2EVTX
      * N :  Oms Access Denied (Y/N)
     I                                       96  96 P2HAST
     IP3PARM      DS
      * N :  Cooler Shrink Percent USR
     I                                    P   1   32P3FIPC
     IP4PARM      DS
      * N :  Prod Kill Val/Hd USR
     I                                    P   1   84P4CBVA
     IP5PARM      DS
      * N :  Prod Rend Val/Hd USR
     I                                    P   1   84P5CCVA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1B0DT    PARM           WP0002  70       TH Kill Date
     C           P1C9CD    PARM           WP0003  6        Cutout Matrix C
     C           P1KLNB    PARM           WP0004  40       Effective Month
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc Kill/Rend/Cut Val XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Del Cutout Value 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDKFXFR'              90  Del Cutout Valu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       BOH Company Num
     C                     PARM P1B0DT    WQ0002  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Coolr Shrnk% 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDAWXFR'              90  Rtv Coolr Shrnk
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0003  30       Company Number
     C           P3FIPC    PARM *ZERO     WQ0004  52       Cooler Shrink P
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Clc Kill/Rnd Val 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUHPFR'              90  Clc Kill/Rnd Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0005  30       Company Number
     C                     PARM P1B0DT    WQ0006  70       Kill Date Usr
     C           P4CBVA    PARM P4CBVA    WQ0007 154       Prod Kill Val/H
     C           P5CCVA    PARM P5CCVA    WQ0008 154       Prod Rend Val/H
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Clc Cutout Value      RT - Carcass Detail  * 
     C                     EXSR SARVGN
      * Upd Tattoo Value 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDJ3PFR'              90  Upd Tattoo Valu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0019  30       BOH Company Num
     C                     PARM P1B0DT    WQ0020  70       TH Kill Date
     C                     PARM P4CBVA    WQ0021 154       Prod Kill Val/H
     C                     PARM P5CCVA    WQ0022 154       Prod Rend Val/H
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJ3PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Clc Cutout Value      RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSA02           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     Z-ADDP1B0DT    WQSA02           TH Kill Date
      * Establish starting position
     C           KRSSA     SETLL@B1CPNT                    *
     C           KRSSA     READE@B1CPNT                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CD Record Add/Del Sts is Delete
     C           WAINST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAAUPC    WUBPPC           Lean % 3.0 USR
      * Upd Cutout Items 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDKEXFR'              90  Upd Cutout Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0009  30       BOH Company Num
     C                     PARM WAB0DT    WQ0010  70       TH Kill Date
     C                     PARM WACVNB    WQ0011  50       TH Tattoo Numbe
     C                     PARM WAEWNB    WQ0012  51       CD Carcass/Hot
     C                     PARM WUBPPC    WQ0013  31       CD Lean Percent
     C                     PARM P1C9CD    WQ0014  6        Cutout Matrix C
     C                     PARM P1KLNB    WQ0015  40       Effective Month
     C                     PARM WABNNB    WQ0016  70       BOH Buy Order N
     C                     PARM WABONB    WQ0017  50       BOL Load Number
     C                     PARM P3FIPC    WQ0018  52       Cooler Shrink P
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSA     READE@B1CPNT                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/02/20 - Increased the Buy Order Number
      * field length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P2HONB           CC Company Numb
     C                     MOVEL*BLANK    P2C7CD           Oms Application
     C                     MOVEL*BLANK    P2C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P2G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P2G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P2EUTX           Oms Name
     C                     MOVEL*BLANK    P2EVTX           Oms System Valu
     C                     MOVEL*BLANK    P2HAST           Oms Access Deni
     C                     Z-ADD*ZERO     P3FIPC           Cooler Shrink P
     C                     Z-ADD*ZERO     P4CBVA           Prod Kill Val/H
     C                     Z-ADD*ZERO     P5CCVA           Prod Rend Val/H
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WALGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WAEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WALHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WABEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WAASPC           CD STD Yield
     C                     Z-ADD*ZERO     WAEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WAB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WAEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WAB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WAAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WAAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WAAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WABBDT           CD Kill Date
     C                     Z-ADD*ZERO     WAAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WAH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WABEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WABHPC           CD FFLI
     C                     Z-ADD*ZERO     WALTNB           CD LOT
     C                     Z-ADD*ZERO     WAX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WAFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WAFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WAF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WAJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WAJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WADKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WAITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WAIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WAORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WAOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WAIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WAORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WAIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Lean % 3.0 USR
     C                     Z-ADD*ZERO     WUBPPC  30
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
