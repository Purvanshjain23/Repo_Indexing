     H/TITLE EDT ReValue Open Ord  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 09:03:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPLKIF  E           K        DISK
      * RSQ : Order Header TRG         SSD/LdId/Ord -Open Ord
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDKNCPL0UF  E           K        DISK
      * UPD : Order Detail Schedule     Update index
      *
     I@BFCPNR
      * Order Header TRG         SSD/LdId/Ord -Open Ord
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@ASREVL
      * Company Control           Retrieval Active Only
      * Renamed input format fields
     I              ASAIC3                          WDAIC3
     I              ASAXNB                          WDAXNB
     I              ASNGNB                          WDNGNB
     I              ASBZNB                          WDBZNB
     I              ASC5NB                          WDC5NB
     I              ASC3NB                          WDC3NB
     I              ASCYNB                          WDCYNB
     I              ASIONB                          WDIONB
     I              ASI6NB                          WDI6NB
     I              ASDCNB                          WDDCNB
     I              ASC7NB                          WDC7NB
     I              ASC2NB                          WDC2NB
     I              ASC1NB                          WDC1NB
     I              ASL8NB                          WDL8NB
     I              ASBANB                          WDBANB
     I              ASCHST                          WDCHST
     I              ASCKST                          WDCKST
     I              ASCIST                          WDCIST
     I              ASCGST                          WDCGST
     I              ASAIPC                          WDAIPC
     I              ASASPC                          WDASPC
     I              ASA2VA                          WDA2VA
     I              ASC2ST                          WDC2ST
     I              ASD8ST                          WDD8ST
     I              ASD7ST                          WDD7ST
     I              ASA8NA                          WDA8NA
     I              ASA9NA                          WDA9NA
     I              ASBANA                          WDBANA
     I              ASBBNA                          WDBBNA
     I              ASEUST                          WDEUST
     I              ASAADY                          WDAADY
     I              ASABDY                          WDABDY
     I              ASACDY                          WDACDY
     I              ASADDY                          WDADDY
     I              ASAEDY                          WDAEDY
     I              ASAFDY                          WDAFDY
     I              ASAGDY                          WDAGDY
     I              ASAHDY                          WDAHDY
     I              ASAENB                          WDAENB
     I              ASALNB                          WDALNB
     I              ASEVNB                          WDEVNB
     I              ASRPOP                          WDRPOP
     I              ASDWNB                          WDDWNB
     I              ASR3NB                          WDR3NB
     I              ASPNST                          WDPNST
     I              ASR4NB                          WDR4NB
     I              ASPOST                          WDPOST
     I              ASSCNB                          WDSCNB
     I              ASVIST                          WDVIST
     I              ASVJST                          WDVJST
     I              ASBVVN                          WDBVVN
     I              ASUVST                          WDUVST
     I              ASUWST                          WDUWST
     I              ASUXST                          WDUXST
     I              ASVSST                          WDVSST
     I              ASAATM                          WDAATM
     I              ASAYNA                          WDAYNA
     I              ASA0NA                          WDA0NA
     I              ASAXDT                          WDAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WELQCD
     I              F0LRCD                          WELRCD
     I              F0EQDT                          WEEQDT
     I              F0A5PR                          WEA5PR
     I              F0B8PR                          WEB8PR
     I              F0UVST                          WEUVST
     I              F0UWST                          WEUWST
     I              F0UXST                          WEUXST
     I              F0VSST                          WEVSST
     I              F0AATM                          WEAATM
     I              F0AYNA                          WEAYNA
     I              F0A0NA                          WEA0NA
     I              F0AXDT                          WEAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WGAIC3
     I              KNC4NB                          WGC4NB
     I              KNDPNB                          WGDPNB
     I              KNUENB                          WGUENB
     I              KNJGDT                          WGJGDT
     I              KNAODT                          WGAODT
     I              KNAJCD                          WGAJCD
     I              KNAYAA                          WGAYAA
     I              KNHGCD                          WGHGCD
     I              KNIGQT                          WGIGQT
     I              KNFLWG                          WGFLWG
     I              KNIUQT                          WGIUQT
     I              KNF3WG                          WGF3WG
     I              KNIVQT                          WGIVQT
     I              KNF4WG                          WGF4WG
     I              KNP7ST                          WGP7ST
     I              KNP8ST                          WGP8ST
     I              KNQAST                          WGQAST
     I              KNUVST                          WGUVST
     I              KNUWST                          WGUWST
     I              KNUXST                          WGUXST
     I              KNVSST                          WGVSST
     I              KNAATM                          WGAATM
     I              KNAYNA                          WGAYNA
     I              KNA0NA                          WGA0NA
     I              KNAXDT                          WGAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WHAIC3
     I              KNC4NB                          WHC4NB
     I              KNDPNB                          WHDPNB
     I              KNUENB                          WHUENB
     I              KNJGDT                          WHJGDT
     I              KNAODT                          WHAODT
     I              KNAJCD                          WHAJCD
     I              KNAYAA                          WHAYAA
     I              KNHGCD                          WHHGCD
     I              KNIGQT                          WHIGQT
     I              KNFLWG                          WHFLWG
     I              KNIUQT                          WHIUQT
     I              KNF3WG                          WHF3WG
     I              KNIVQT                          WHIVQT
     I              KNF4WG                          WHF4WG
     I              KNP7ST                          WHP7ST
     I              KNP8ST                          WHP8ST
     I              KNQAST                          WHQAST
     I              KNUVST                          WHUVST
     I              KNUWST                          WHUWST
     I              KNUXST                          WHUXST
     I              KNVSST                          WHVSST
     I              KNAATM                          WHAATM
     I              KNAYNA                          WHAYNA
     I              KNA0NA                          WHA0NA
     I              KNAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WHAIC3
     I              KNC4NB                          WHC4NB
     I              KNDPNB                          WHDPNB
     I              KNUENB                          WHUENB
     I              KNJGDT                          WHJGDT
     I              KNAODT                          WHAODT
     I              KNAJCD                          WHAJCD
     I              KNAYAA                          WHAYAA
     I              KNHGCD                          WHHGCD
     I              KNIGQT                          WHIGQT
     I              KNFLWG                          WHFLWG
     I              KNIUQT                          WHIUQT
     I              KNF3WG                          WHF3WG
     I              KNIVQT                          WHIVQT
     I              KNF4WG                          WHF4WG
     I              KNP7ST                          WHP7ST
     I              KNP8ST                          WHP8ST
     I              KNQAST                          WHQAST
     I              KNUVST                          WHUVST
     I              KNUWST                          WHUWST
     I              KNUXST                          WHUXST
     I              KNVSST                          WHVSST
     I              KNAATM                          WHAATM
     I              KNAYNA                          WHAYNA
     I              KNA0NA                          WHA0NA
     I              KNAXDT                          WHAXDT
      *
     IYBRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Scheduled Ship Date
     I                                    P   1   40P1AODT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AODT    PARM           WP0001  70       Scheduled Ship
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EDT ReValue Open Ord  XF
      * EDT ReValue Open Ord  RT - Order Header TRG  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * EDT ReValue Open Ord  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAAODT           Scheduled Ship
      * Setup key
     C                     Z-ADDP1AODT    WAAODT           Scheduled Ship
      * Establish starting position
     C           KPSSA     SETLL@BFCPNR                    *
     C                     READ @BFCPNR                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Header Status is Confirmed
     C           WAGWST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
     C                     EXSR SBRVGN
      * RTV Com Mkt Code       RT - Company Customer  * 
     C                     EXSR SCRVGN
      * Edt ReValue Open Ord  RT - Order Detail  * 
     C                     EXSR SDRVGN
      * CASE: LCL.Post Flag USR is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0010  30       Company Number
     C                     PARM WAC4NB    WQ0011  70       Order Number
     C                     PARM WABKC7    WQ0012  70       Ship To Custome
     C           YL0018    PARM YL0018    WQ0013 112       Order Value Tot
     C           YL0019    PARM *ZERO     WQ0014 112       Order Weight To
     C                     PARM YL0020    WQ0015  6        USR Country Cod
     C                     PARM YL0021    WQ0016  3        USR Warehouse C
     C                     PARM 'OE'      WQ0017  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BFCPNR                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWABKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSB     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Type Code
     C                     Z-ADD*ZERO     YL0002           Absorbed Freigh
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBOCD    YL0001           Type Code
     C                     Z-ADDWBTBNB    YL0002           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Com Mkt Code       RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWABKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBLQCD    YL0003           Commodity Marke
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Edt ReValue Open Ord  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0004           Post Flag USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSD02           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSD01           Company Number
     C                     Z-ADDWAC4NB    WQSD02           Order Number
      * Establish starting position
     C           KRSSD     SETLL@BGWKL1                    *
     C           KRSSD     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Unit Price - Credit is Equal zero
     C           WCALPR    IFEQ *ZERO                      *IF
      * If manual pricing and not a transfer order, check price range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : PAR.Order Type - Sales is Regular Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCQ7CD    IFEQ 'MAN'                      *IF
     C           WAJNCD    IFEQ 'OR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Manual Price      XF - Company Item  * 
     C                     CALL 'POA5XFR'              90  Val Manual Pric
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0001  30       Company Number
     C                     PARM WCHGCD    WQ0002  70       Item Code
     C           YL0005    PARM *BLANK    WQ0003 30        Description Lin
     C           YL0006    PARM *BLANK    WQ0004  3        Default Commod
     C           YL0007    PARM *ZERO     WQ0005 114       Market Overage
     C           YL0008    PARM *ZERO     WQ0006 114       Standard Overag
     C           YL0009    PARM *BLANK    WQ0007  7        Commodity Price
     C           YL0010    PARM *ZERO     WQ0008 112       Std Weight/Head
     C           YL0011    PARM *BLANK    WQ0009  6        Primal Group Co
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POA5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Primal Group Code is NE Samples or Cut Loss
      *   |- c2    : PAR.Type Code is Not Promotional/Samples
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFNE 'UNID'                     *IF
     C           YL0001    IFNE 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0001  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0002  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0003  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0004 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     YL0012           Projected Marke
     C                     Z-ADD*ZERO     YL0013           Minimum Price
     C                     Z-ADD*ZERO     YL0014           Maximum Price
     C                     MOVEL'Y'       WUTXST           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
     C                     EXSR SERVGN
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           YL0006    IFEQ 'FSV'                      *IF
     C           YL0006    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0002    WN0001           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0003    WL0001    P      Commodity Marke
     C                     MOVELYL0009    WL0002    P      Commodity Price
     C                     Z-ADD9999999   WL0003           Market Price Da
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0012           Commodity Marke
     C                     Z-ADDWL0005    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage/Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0012    ADD  YL0007    W0WB01           *Synon (15,5) w
     C           WATBNB    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0012           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0001    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0012    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0001    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0012    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0014           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCBZPR    IFGE YL0013                     *IF
     C           WCBZPR    IFLE YL0014                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0006    WL0001    P      Commodity Marke
     C                     MOVELYL0009    WL0002    P      Commodity Price
     C                     Z-ADD9999999   WL0003           Market Price Da
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0012           Commodity Marke
     C                     Z-ADDWL0005    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0001    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0012    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0001    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0012    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0014           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCBZPR    IFGE YL0013                     *IF
     C           WCBZPR    IFLE YL0014                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0012           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0012    YL0015           Unit Price - Cr
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Unit Price - Credit is Not Zeros
     C           YL0015    IFNE *ZERO                      *IF
      * Chg Unit Price-Credit CH - Order Detail  * 
     C                     EXSR SGCHRC
     C                     MOVEL'Y'       YL0004           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.OD Production Plan Sts is No
     C           WCR1ST    IFEQ 'N'                        *IF
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
     C                     EXSR SHRVGN
      * CASE: DB1.Quantity Scheduled NE DB1.Quantity Ordered
     C           WCCCQT    IFNE WCAVQT                     *IF
     C                     Z-ADDWCAVQT    YL0016           Quantity Schedu
     C                     Z-ADDWCD0WG    YL0017           Weight Schedule
      * Chg Qty-Wgt Schd/Sts  CH - Order Detail  * 
     C                     EXSR SJCHRC
     C                     MOVEL'Y'       YL0004           Post Flag USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIC3           Company Number
      * Setup key
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
      * Establish starting position
     C           KRSSE     CHAIN@ASREVL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Manual Price Ac
     C                     Z-ADD*ZERO     WN0002           CoPk/FdSrv ManP
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAIPC    WN0001           Manual Price Ac
     C                     Z-ADDWDASPC    WN0002           CoPk/FdSrv ManP
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WELQCD    WQSF01           Commodity Marke
     C           *LIKE     DEFN WELRCD    WQSF02           Commodity Price
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Commodity Marke
     C                     KFLD           WQSF02           Commodity Price
     C                     KFLD           WEEQDT           Market Price Da
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Commodity Marke
     C                     KFLD           WQSF02           Commodity Price
      * Setup key
     C                     MOVELWL0001    WQSF01           Commodity Marke
     C                     MOVELWL0002    WQSF02           Commodity Price
     C                     Z-ADDWL0003    WEEQDT           Market Price Da
      * Establish starting position
     C           KPSSF     SETLL@F0CPEP                    *
     C           KRSSF     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Commodity Marke
     C                     Z-ADD*ZERO     WL0005           USR Date Priced
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWEA5PR    WL0004           Commodity Marke
     C                     Z-ADDWEEQDT    WL0005           USR Date Priced
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Unit Price-Credit CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       Item Code
     C                     MOVEL*BLANK    WN0006  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0007  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0008  70       Order Group Cod
     C                     MOVEL*BLANK    WN0009  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0010  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0011 112       Billing Detail
     C                     Z-ADD*ZERO     WN0012 112       Billing Detail
     C                     Z-ADD*ZERO     WN0013 112       Billing Detail
     C                     Z-ADD*ZERO     WN0014 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0015  1        Comment Print A
     C                     MOVEL*BLANK    WN0016  1        Comment Print I
     C                     MOVEL*BLANK    WN0017  1        Comment Print P
     C                     MOVEL*BLANK    WN0018  1        Comment Print S
     C                     Z-ADD*ZERO     WN0019 112       Extended Amount
     C                     Z-ADD*ZERO     WN0020  70       Market Pricing
     C                     MOVEL*BLANK    WN0021  3        Commodity Marke
     C                     MOVEL*BLANK    WN0022  3        Date Method Cod
     C                     MOVEL*BLANK    WN0023  3        Price Method Co
     C                     Z-ADD*ZERO     WN0024 114       Price Overage O
     C                     Z-ADD*ZERO     WN0025  70       Contract Number
     C                     MOVEL*BLANK    WN0026  1        Price Status
     C                     Z-ADD*ZERO     WN0027  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0028  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0029  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0030  1        Work Confirm St
     C                     MOVEL*BLANK    WN0031  1        Work Over/Short
     C                     MOVEL*BLANK    WN0032  1        OD Production P
     C                     MOVEL*BLANK    WN0033 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0034 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0035  1        Age Code
     C                     MOVEL*BLANK    WN0036  1        Palletize
     C                     MOVEL*BLANK    WN0037  1        Slip Sheet
     C                     MOVEL*BLANK    WN0038  1        Catch Weight St
     C                     MOVEL*BLANK    WN0039  1        Price Audit
     C                     MOVEL*BLANK    WN0040  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0041  1        Production Date
     C                     Z-ADD*ZERO     WN0042 112       Rated Freight
     C                     Z-ADD*ZERO     WN0043 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0044 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0045 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0046 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0047 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0048 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0049 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0050 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0051 114       Unit Price
     C                     Z-ADD*ZERO     WN0052 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0053 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0054 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0055  70       Requested Ship
     C                     Z-ADD*ZERO     WN0056  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0057  70       Actual Shipped
     C                     MOVEL*BLANK    WN0058  1        Affect Inventor
     C                     MOVEL*BLANK    WN0059  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0060  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0061  30       Item Structure
     C                     Z-ADD*ZERO     WN0062  30       Item Structure
     C                     Z-ADD*ZERO     WN0063  30       Item Structure
     C                     MOVEL*BLANK    WN0064  2        Item Level
     C                     MOVEL*BLANK    WN0065  2        Quality Level
     C                     MOVEL*BLANK    WN0066  2        Pricing Product
     C                     MOVEL*BLANK    WN0067  2        Season Product
     C                     Z-ADD*ZERO     WN0068  70       Date of Origina
     C                     MOVEL*BLANK    WN0069 10        User Profile Na
     C                     MOVEL*BLANK    WN0070  6        Country Code
     C                     MOVEL*BLANK    WN0071  2        Event Code
     C                     MOVEL*BLANK    WN0072  3        Reason Code
     C                     MOVEL*BLANK    WN0073  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0074  1        Modified Flag
     C                     MOVEL*BLANK    WN0075  1        Substituted Fla
     C                     MOVEL*BLANK    WN0076  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0077 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0078 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0079  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0080  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0081  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0082  1        Affect Commissi
     C                     MOVEL*BLANK    WN0083  1        Affect Pricing
     C                     MOVEL*BLANK    WN0084  1        Released by Use
     C                     MOVEL*BLANK    WN0085  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0086  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0087  3        Production Ware
     C                     MOVEL*BLANK    WN0088  3        OD Price Type
     C                     Z-ADD*ZERO     WN0089  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0090  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0091  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0092  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0093  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0094  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0095  60       Price Code
     C                     Z-ADD*ZERO     WN0096  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0097  60       Substitution Li
     C                     Z-ADD*ZERO     WN0098  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0099 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0100 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0101 112       OD Item Target
     C                     Z-ADD*ZERO     WN0102 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0103 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0104 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0105 114       OD Base MKT Ovr
     C                     Z-ADD*ZERO     WN0106 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0107 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0108 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0109 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0110 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0111 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0112  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0113  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0114  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0115 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0116  40       Delv Ageing Day
     C                     Z-ADD*ZERO     WN0117  70       Production Ovr
     C                     Z-ADD*ZERO     WN0118  70       Production Ovr
     C                     MOVEL*BLANK    WN0119  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0120  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0121  3        OD UnUsed Statu
     C                     Z-ADD*ZERO     WN0122  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0123  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0124  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0125  1        EDI Status 1
     C                     MOVEL*BLANK    WN0126  1        EDI Status 2
     C                     MOVEL*BLANK    WN0127  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0128  60       Job Time
     C                     MOVEL*BLANK    WN0129 10        User Id
     C                     MOVEL*BLANK    WN0130 10        Job Name
     C                     Z-ADD*ZERO     WN0131  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWCAIC3    WFAIC3           Company Number
     C                     Z-ADDWCC4NB    WFC4NB           Order Number
     C                     Z-ADDWCDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWCUENB    WFUENB           Order Secondary
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSG    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0015    WFALPR           Unit Price - Cr
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WGDPNB    WQSH03           Order Sequence
     C           *LIKE     DEFN WGUENB    WQSH04           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           Order Sequence
     C                     KFLD           WQSH04           Order Secondary
      * Setup key
     C                     Z-ADDWCAIC3    WQSH01           Company Number
     C                     Z-ADDWCC4NB    WQSH02           Order Number
     C                     Z-ADDWCDPNB    WQSH03           Order Sequence
     C                     Z-ADDWCUENB    WQSH04           Order Secondary
      * Establish starting position
     C           KRSSH     SETLL@KNCPHO                    *
     C           KRSSH     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
     C                     EXSR SIDLRC
     C           KRSSH     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGC4NB    WHC4NB           Order Number
     C                     Z-ADDWGDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWGUENB    WHUENB           Order Secondary
     C                     Z-ADDWGJGDT    WHJGDT           OD Production D
      *
     C           KLDLSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
     C           KLDLSI    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Qty-Wgt Schd/Sts  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0132  70       Item Code
     C                     MOVEL*BLANK    WN0133  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0134  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0135  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0136 112       Billing Detail
     C                     Z-ADD*ZERO     WN0137 112       Billing Detail
     C                     Z-ADD*ZERO     WN0138 112       Billing Detail
     C                     Z-ADD*ZERO     WN0139 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0140  1        Comment Print A
     C                     MOVEL*BLANK    WN0141  1        Comment Print I
     C                     MOVEL*BLANK    WN0142  1        Comment Print P
     C                     MOVEL*BLANK    WN0143  1        Comment Print S
     C                     Z-ADD*ZERO     WN0144 112       Extended Amount
     C                     Z-ADD*ZERO     WN0145  70       Market Pricing
     C                     MOVEL*BLANK    WN0146  3        Commodity Marke
     C                     MOVEL*BLANK    WN0147  3        Date Method Cod
     C                     MOVEL*BLANK    WN0148  3        Price Method Co
     C                     Z-ADD*ZERO     WN0149 114       Price Overage O
     C                     Z-ADD*ZERO     WN0150  70       Contract Number
     C                     MOVEL*BLANK    WN0151  1        Price Status
     C                     Z-ADD*ZERO     WN0152  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0153  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0154  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0155  1        Work Confirm St
     C                     MOVEL*BLANK    WN0156  1        Work Over/Short
     C                     MOVEL*BLANK    WN0157  1        OD Production P
     C                     MOVEL*BLANK    WN0158 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0159 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0160  1        Age Code
     C                     MOVEL*BLANK    WN0161  1        Palletize
     C                     MOVEL*BLANK    WN0162  1        Slip Sheet
     C                     MOVEL*BLANK    WN0163  1        Catch Weight St
     C                     MOVEL*BLANK    WN0164  1        Price Audit
     C                     MOVEL*BLANK    WN0165  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0166  1        Production Date
     C                     Z-ADD*ZERO     WN0167 112       Rated Freight
     C                     Z-ADD*ZERO     WN0168 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0169 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0170 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0171 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0172 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0173 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0174 114       Unit Price
     C                     Z-ADD*ZERO     WN0175 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0176 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0177 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0178 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0179  70       Requested Ship
     C                     Z-ADD*ZERO     WN0180  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0181  70       Actual Shipped
     C                     MOVEL*BLANK    WN0182  1        Affect Inventor
     C                     MOVEL*BLANK    WN0183  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0184  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0185  30       Item Structure
     C                     Z-ADD*ZERO     WN0186  30       Item Structure
     C                     Z-ADD*ZERO     WN0187  30       Item Structure
     C                     MOVEL*BLANK    WN0188  2        Item Level
     C                     MOVEL*BLANK    WN0189  2        Quality Level
     C                     MOVEL*BLANK    WN0190  2        Pricing Product
     C                     MOVEL*BLANK    WN0191  2        Season Product
     C                     Z-ADD*ZERO     WN0192  70       Date of Origina
     C                     MOVEL*BLANK    WN0193 10        User Profile Na
     C                     MOVEL*BLANK    WN0194  6        Country Code
     C                     MOVEL*BLANK    WN0195  2        Event Code
     C                     MOVEL*BLANK    WN0196  3        Reason Code
     C                     MOVEL*BLANK    WN0197  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0198  1        Modified Flag
     C                     MOVEL*BLANK    WN0199  1        Substituted Fla
     C                     MOVEL*BLANK    WN0200  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0201 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0202 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0203  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0204  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0205  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0206  1        Affect Commissi
     C                     MOVEL*BLANK    WN0207  1        Affect Pricing
     C                     MOVEL*BLANK    WN0208  1        Released by Use
     C                     MOVEL*BLANK    WN0209  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0210  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0211  3        Production Ware
     C                     MOVEL*BLANK    WN0212  3        OD Price Type
     C                     Z-ADD*ZERO     WN0213  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0214  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0215  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0216  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0217  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0218  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0219  60       Price Code
     C                     Z-ADD*ZERO     WN0220  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0221  60       Substitution Li
     C                     Z-ADD*ZERO     WN0222  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0223 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0224 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0225 112       OD Item Target
     C                     Z-ADD*ZERO     WN0226 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0227 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0228 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0229 114       OD Base MKT Ovr
     C                     Z-ADD*ZERO     WN0230 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0231 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0232 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0233 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0234 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0235 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0236  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0237  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0238  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0239 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0240  40       Delv Ageing Day
     C                     Z-ADD*ZERO     WN0241  70       Production Ovr
     C                     Z-ADD*ZERO     WN0242  70       Production Ovr
     C                     MOVEL*BLANK    WN0243  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0244  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0245  3        OD UnUsed Statu
     C                     Z-ADD*ZERO     WN0246  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0247  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0248  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0249  1        EDI Status 1
     C                     MOVEL*BLANK    WN0250  1        EDI Status 2
     C                     MOVEL*BLANK    WN0251  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0252  60       Job Time
     C                     MOVEL*BLANK    WN0253 10        User Id
     C                     MOVEL*BLANK    WN0254 10        Job Name
     C                     Z-ADD*ZERO     WN0255  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWCAIC3    WFAIC3           Company Number
     C                     Z-ADDWCC4NB    WFC4NB           Order Number
     C                     Z-ADDWCDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWCUENB    WFUENB           Order Secondary
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSJ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWCGMST    WFGMST    P      Detail Line Sta
     C                     MOVELWCGNST    WFGNST    P      Detail Line Sta
     C                     Z-ADDYL0016    WFCCQT           Quantity Schedu
     C                     Z-ADDYL0017    WFAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Unused Date
     C                     Z-ADD*ZERO     WANPDT           OH Unused Date
     C                     Z-ADD*ZERO     WANQDT           OH Unused Date
     C                     Z-ADD*ZERO     WANRDT           OH Unused Date
     C                     Z-ADD*ZERO     WANSDT           OH Unused Date
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Unused Time
     C                     Z-ADD*ZERO     WABSTM           OH Unused Time
     C                     Z-ADD*ZERO     WABTTM           OH Unused Time
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WCDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WCDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WCDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WCDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WCGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WCTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WCTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAXNB           Current Account
     C                     Z-ADD*ZERO     WDNGNB           Current Account
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WDC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WDCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WDIONB           Next Late Charg
     C                     Z-ADD*ZERO     WDI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WDDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WDC7NB           Next Customer #
     C                     Z-ADD*ZERO     WDC2NB           Next Inventory
     C                     Z-ADD*ZERO     WDC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WDL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WDBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WDAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WDASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WDA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WDAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WDABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAENB           Retention Perio
     C                     Z-ADD*ZERO     WDALNB           Retention Perio
     C                     Z-ADD*ZERO     WDEVNB           Retention Perio
     C                     Z-ADD*ZERO     WDRPOP           Retention Perio
     C                     Z-ADD*ZERO     WDDWNB           Retention Perio
     C                     Z-ADD*ZERO     WDR3NB           Next Load ID
     C                     Z-ADD*ZERO     WDR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WDSCNB           Production Numb
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEEQDT           Market Price Da
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WEB8PR           Projected Marke
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGJGDT           OD Production D
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WGFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WGIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WGF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WGIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WGF4WG           OD Weight Unuse
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  7
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004 114
     C                     Z-ADD*ZERO     WL0005  70
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0002  52
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Post Flag USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0005 30
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0007 114
      * Define local work field Standard Overage/Underage
     C                     Z-ADD*ZERO     YL0008 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0011  6
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0012 114
      * Define local work field Minimum Price   USR
     C                     Z-ADD*ZERO     YL0013 114
      * Define local work field Maximum Price  USR
     C                     Z-ADD*ZERO     YL0014 114
      * Define local work field Unit Price - Credit
     C                     Z-ADD*ZERO     YL0015 114
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0016 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0017 112
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0019 112
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0020  6
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0021  3
      *================================================================
     CSR         ZZEXIT    ENDSR
