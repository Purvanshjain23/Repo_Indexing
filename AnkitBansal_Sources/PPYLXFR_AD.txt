// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPYLXFR
// ?Date: 14.08.2025 Time: 03:42:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?** Company Number is NOT passed in - this program loops thru all comps
//?** Actual Ship Date is NOT passed in - date is retrieved from
//?** the TFP099 file in the Revenue record.
//?03/30/17 DN R9700-Will Now Read All Company by Inter Company Group
//?  and Thru Actual Ship Date will be passed in hence TFP099 is not
//?  needed.
// LCL.Company Number ReadW UsR = CON.*ZERO
LCL.Company_Number_ReadW_UsR = *ZERO;

// LCL.Company Number ProcW Usr = CON.*ZERO
LCL.Company_Number_ProcW_Usr = *ZERO;

//?03/30/17 DN R9700-Commented out & Moved/Changed Below to Support IC Group.
//?03/30/17 DN R9700-Process by Inter Company Group.
CASE;

// IF *OTHERWISE
IF *OTHERWISE;

// LCL.End of IC Grp Process USR = CND.Blank
LCL.End_of_IC_Grp_Process_USR = *BLANK;

// Call program Rtv Next IC Group Cmp XF.
CALL PROGRAM(Rtv Next IC Group Cmp XF) ('PUBPXFR');
PARAMETER(PAR.Inter_Company_Grp_Cde_USR);
PARAMETER(LCL.Company_Number_ReadW_UsR);
PARAMETER(LCL.Company_Number_ProcW_Usr);
PARAMETER(LCL.End_of_IC_Grp_Process_USR);

//?** Loop Through All Plant Companies By Inter Company Group.
// DOW NOT LCL.End of IC Grp Process USR is Yes
DOW ! LCL.End_of_IC_Grp_Process_USR = 'Y';

//?Build Parameters and Submit the IC Invoice Print and Post.
CASE;

// IF *OTHERWISE
IF *OTHERWISE;

//?** Retrieve the current begin and end revenue dates from TFP099
//?03/30/17 DN R9700-Commented out & Set Thru Date from PAR.To Date       USR
// PAR.Thru Date Pass        USR = PAR.To Date               USR
PAR.Thru_Date_Pass_USR = PAR.To_Date_USR;

// PAR.Company Number Pass   USR = LCL.Company Number ProcW Usr
PAR.Company_Number_Pass_USR = LCL.Company_Number_ProcW_Usr;

// PAR.Order Number 1  PASS  USR = CON.*ZERO
PAR.Order_Number_1_PASS_USR = *ZERO;

// PAR.Order Number 2  PASS  USR = CON.*ZERO
PAR.Order_Number_2_PASS_USR = *ZERO;

// PAR.Billing Activity Type = CND.Invoice
PAR.Billing_Activity_Type = 1;

// PAR.PRT Hold Output Sts = CND.*YES
PAR.PRT_Hold_Output_Sts = *YES;

// PAR.PRT Save Output Sts = CND.*YES
PAR.PRT_Save_Output_Sts = *YES;

// LCL.Company Alpha = CVTVAR(LCL.Company Number ProcW Usr)
LCL.Company_Alpha = CVTVAR(LCL.Company_Number_ProcW_Usr);

// PAR.PRT Description = CONCAT(LCL.Company Alpha,CON.Print All IC Invoices,CON.1)
PAR.PRT_Description = LCL.Company_Alpha + 'Print All IC Invoices' (1);

//?** Order Number 1 and 2 are for Load ID and Order# respectively
//?** These are both zeros for the Inter-Company post
//?** PPXVUPC is passed in from the calling party in Program Name
// Call program PMT Pass Inv Prnt&Post UP.
CALL PROGRAM(PMT Pass Inv Prnt&Post UP) ('PPXUUPC');
PARAMETER(*BLANK);
PARAMETER(PAR.Program_name_USR);
PARAMETER(PAR.Application_Code);
PARAMETER(PAR.Billing_Activity_Type);
PARAMETER(PAR.PRT_Description);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER(PAR.Company_Number_Pass_USR);
PARAMETER(PAR.Thru_Date_Pass_USR);
PARAMETER(PAR.Order_Number_1_PASS_USR);
PARAMETER(PAR.Order_Number_2_PASS_USR);
PARAMETER(PAR.System_Value_Numeric);
PARAMETER(PAR.Status_Y_or_N);
PARAMETER(PAR.Process_Cust_Types_Usr);
PARAMETER(PAR.Job_Name);

CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// Send information message - 'Print has been submitted.'
MESSAGE(USR1832 *INFO);

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Return code = CND.*Normal
PGM.*Return_code = *BLANK;

ENDIF;

ENDIF;

// LCL.Company Number ReadW UsR = LCL.Company Number ProcW Usr
LCL.Company_Number_ReadW_UsR = LCL.Company_Number_ProcW_Usr;

// Call program Rtv Next IC Group Cmp XF.
CALL PROGRAM(Rtv Next IC Group Cmp XF) ('PUBPXFR');
PARAMETER(PAR.Inter_Company_Grp_Cde_USR);
PARAMETER(LCL.Company_Number_ReadW_UsR);
PARAMETER(LCL.Company_Number_ProcW_Usr);
PARAMETER(LCL.End_of_IC_Grp_Process_USR);

ENDDO;

ENDIF;

