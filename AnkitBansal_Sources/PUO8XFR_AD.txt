// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUO8XFR
// ?Date: 14.08.2025 Time: 03:51:01
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(RTV ShpTo,BillTo,OTyp RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1977668;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(LCL.AR_Customer_Number);
PARAMETER(LCL.Ship_To_Customer);
PARAMETER(LCL.Bill_to_Customer);
PARAMETER(LCL.Billing_Activity_Type);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?R15305 DN 11/04/19-EDI 856 Advance Shipping Notice Processing.
CASE;

// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(Val Cust Setup 4/856 V2IF) TYPE(EXCINTFUN)                     AC2178250;
PARAMETER(PAR.Create_EDI_ASN_856_V2_USR);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(LCL.Bill_to_Customer);
PARAMETER(NLL.EDI_Trading_Partner_No);
PARAMETER(NLL.Country_Code);
PARAMETER(NLL.Warehouse_Code);
PARAMETER(*MISSING);
PARAMETER('PDN2XFR');
{
 //?Execute internal function

 //?VALIDATIONS: Is Bill To Customer Setup for EDI 856 ASN V2?
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Create EDI ASN 856 V2 USR = CND.No
 PAR.Create_EDI_ASN_856_V2_USR = 'N';

 EXECUTE FUNCTION(RTV EDI ASN 856 Info  RT) TYPE(RTVOBJ) FILE(PNGQREP)           AC2177034;
 PARAMETER(PAR.Bill_to_Customer);
 PARAMETER('ADVSN');
 PARAMETER(PAR.EDI_Trading_Partner_No);
 PARAMETER(LCL.EDI_Detailed_ASN_856_Rqd);
 PARAMETER(LCL.Record_Status);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Do Not Check Customer & Warehouse if Coming From PDN2XFR Program.
 CASE;

 //?Do Not Check Customer & Warehouse if Coming From PDN2XFR Program.
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Bill To Customer Must Be Active & Setup for EDI 856.
 CASE;

 // IF LCL.EDI Detailed ASN 856 Rqd is Yes
 IF LCL.EDI_Detailed_ASN_856_Rqd = 'Y';

 // AND LCL.Record Status is Active
 AND LCL.Record_Status = 'A';

 // PAR.Create EDI ASN 856 V2 USR = CND.Yes
 PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 ENDIF;

 //?WI609_2 Check Internal or External Warehouse Qualifies for 856 ASN.
 CASE;

 // IF PAR.Create EDI ASN 856 V2 USR is Yes
 IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 EXECUTE FUNCTION(RTV 1st Whse/Country   RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1426676;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Order_Number);
 PARAMETER(1);
 PARAMETER(1);
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(PAR.Country_Code);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 EXECUTE FUNCTION(Rtv EDI 856 ASN Info RT) TYPE(RTVOBJ) FILE(CAADREP)            AC2234972;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(LCL.Warehouse_Location);
 PARAMETER(LCL.WHS_Live_with_Carlisle);
 PARAMETER(NLL.WHS_PFS_Interface);
 PARAMETER(LCL.Crt_856_ASN_for_3PL_Whse);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // PAR.Warehouse Location = LCL.Warehouse Location
 PAR.Warehouse_Location = LCL.Warehouse_Location;

 CASE;

 // IF LCL.Warehouse Location is Internal (Plant)
 IF LCL.Warehouse_Location = 'I';

 // AND LCL.WHS Live w/Carlisle is Yes
 AND LCL.WHS_Live_with_Carlisle = 'Y';

 // PAR.Create EDI ASN 856 V2 USR = CND.Yes
 PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 // PAR.Warehouse Code = LCL.Warehouse Code
 PAR.Warehouse_Code = LCL.Warehouse_Code;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Create EDI ASN 856 V2 USR = CND.No
 PAR.Create_EDI_ASN_856_V2_USR = 'N';

 //?WI609_2 JM 10/08/24-Allow External 3PL Warehouses to Receive EDI 856 ASN.
 CASE;

 // IF LCL.Warehouse Location is External
 IF LCL.Warehouse_Location = 'E';

 CASE;

 // IF LCL.Crt 856 ASN for 3PL Whse is Yes
 IF LCL.Crt_856_ASN_for_3PL_Whse = 'Y';

 // PAR.Create EDI ASN 856 V2 USR = CND.Yes
 PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 // PAR.Warehouse Code = LCL.Warehouse Code
 PAR.Warehouse_Code = LCL.Warehouse_Code;

 ENDIF;

 ENDIF;

 ENDIF;

 ENDIF;

 //?WI609_2 JM 10/08/24-Check EDI Manual PO.
 CASE;

 // IF PAR.Create EDI ASN 856 V2 USR is Yes
 IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 // Call program Rtv EDI Manual PO Sts XF.
 CALL PROGRAM(Rtv EDI Manual PO Sts XF) ('PUTBXFR');
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Order_Number);
 PARAMETER('ADVSN');
 PARAMETER(LCL.Send_EDI_Document_Y_N);

 //?If Send EDI Documents = N, set Create EDI ASN 856 V2 USR = N
 CASE;

 // IF LCL.Send EDI Document Y/N is No
 IF LCL.Send_EDI_Document_Y_N = 'N';

 // PAR.Create EDI ASN 856 V2 USR = CND.No
 PAR.Create_EDI_ASN_856_V2_USR = 'N';

 ENDIF;

 ENDIF;

 ENDIF;

 ENDIF;

}


//?TP Not Setup for EDI 856 ASN V2, Continue w/ Existing 856 ASN.
CASE;

// IF PAR.Create EDI ASN 856 V2 USR is No
IF PAR.Create_EDI_ASN_856_V2_USR = 'N';

EXECUTE FUNCTION(Rtv All Values        RT) TYPE(RTVOBJ) FILE(PDNEREP)           AC1569834;
PARAMETER(LCL.AR_Customer_Number);
PARAMETER(NLL.Internet_Password);
PARAMETER(NLL.Email_Address);
PARAMETER(NLL.Email_User_ID);
PARAMETER(LCL.EDI_Trading_Partner_No);
PARAMETER(NLL.EDI_Cust_Duns_Number);
PARAMETER(NLL.EDI_Warehouse_Store_No);
PARAMETER(NLL.State_Tax_ID);
PARAMETER(NLL.Cust_Shipping_Temp_C_F);
PARAMETER(NLL.One_Invoice_Per_PO);
PARAMETER(LCL.EDI_Advanced_Ship_Notice);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


CASE;

// IF LCL.EDI Advanced Ship Notice is Yes
IF LCL.EDI_Advanced_Ship_Notice = 'Y';

// LCL.Company Alpha = CVTVAR(PAR.Company Number)
LCL.Company_Alpha = CVTVAR(PAR.Company_Number);

// LCL.Order Number Alpha = CVTVAR(PAR.Order Number)
LCL.Order_Number_Alpha = CVTVAR(PAR.Order_Number);

// Call program Exc EDI Adv Ship Noti XF.
CALL PROGRAM(Exc EDI Adv Ship Noti XF) ('PNNXXFR');
PARAMETER(LCL.Company_Alpha);
PARAMETER(LCL.Order_Number_Alpha);
PARAMETER(LCL.EDI_Trading_Partner_No);

ENDIF;

ENDIF;

ENDIF;

