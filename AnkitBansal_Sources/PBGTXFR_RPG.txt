     H/TITLE Exc Calc FOB Omaha PR XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/06/20  Time  : 13:48:55
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBASREL1IF  E           K        DISK
      * RTV : MPR FOB Omaha Control     Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPBARCPL2IF  E           K        DISK
      * RSQ : MPR FOB Omaha Rate Table  Country/St/Zip
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDMRREL1IF  E           K        DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     I@ASREOY
      * MPR FOB Omaha Control     Retrieval index
      * Renamed input format fields
     I              ASP2AA                          WAP2AA
     I              ASW6NY                          WAW6NY
     I              ASXANY                          WAXANY
     I              ASXBNY                          WAXBNY
     I              ASZYT1                          WAZYT1
     I              ASZZT1                          WAZZT1
     I              ASP9ST                          WAP9ST
     I              ASQCST                          WAQCST
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@ARCPOV
      * MPR FOB Omaha Rate Table  Country/St/Zip
      * Renamed input format fields
     I              ARPZAA                          WCPZAA
     I              ARW5NY                          WCW5NY
     I              ARP0AA                          WCP0AA
     I              ARW6NY                          WCW6NY
     I              ARHSPR                          WCHSPR
     I              ARW7NY                          WCW7NY
     I              ARU2DT                          WCU2DT
     I              ARZWT1                          WCZWT1
     I              ARZXT1                          WCZXT1
     I              ARVSST                          WCVSST
     I              ARMJDT                          WCMJDT
     I              ARBETM                          WCBETM
     I              ARCCVN                          WCCCVN
     I              ARCDVN                          WCCDVN
     I              ARMKDT                          WCMKDT
     I              ARBFTM                          WCBFTM
     I              ARCEVN                          WCCEVN
     I              ARCFVN                          WCCFVN
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WDAIC3
     I              AMC4NB                          WDC4NB
     I              AMRMNB                          WDRMNB
     I              AMRUNB                          WDRUNB
     I              AMXACD                          WDXACD
     I              AMOANA                          WDOANA
     I              AMHBAA                          WDHBAA
     I              AMJ0T1                          WDJ0T1
     I              AMGENY                          WDGENY
     I              AMJ1T1                          WDJ1T1
     I              AMHCAA                          WDHCAA
     I              AMQWDT                          WDQWDT
     I              AMQXDT                          WDQXDT
     I              AMQYDT                          WDQYDT
     I              AMHDAA                          WDHDAA
     I              AMCCTX                          WDCCTX
     I              AMJ2T1                          WDJ2T1
     I              AMRLNA                          WDRLNA
     I              AMRMNA                          WDRMNA
     I              AMGINY                          WDGINY
     I              AMGFNY                          WDGFNY
     I              AMGGNY                          WDGGNY
     I              AMGHNY                          WDGHNY
     I              AMHEVL                          WDHEVL
     I              AMHFVL                          WDHFVL
     I              AMHGVL                          WDHGVL
     I              AMQZDT                          WDQZDT
     I              AMQ0DT                          WDQ0DT
     I              AMQ1DT                          WDQ1DT
     I              AMQ2DT                          WDQ2DT
     I              AMC2TX                          WDC2TX
     I              AMC3TX                          WDC3TX
     I              AMC6TX                          WDC6TX
     I              AMCHTX                          WDCHTX
     I              AMCITX                          WDCITX
     I              AMCLTX                          WDCLTX
     I              AMB4TX                          WDB4TX
     I              AMCUTX                          WDCUTX
     I              AMCVTX                          WDCVTX
     I              AMB9TX                          WDB9TX
     I              AMJWSC                          WDJWSC
     I              AMITNY                          WDITNY
     I              AMLMT1                          WDLMT1
     I              AMLWAA                          WDLWAA
     I              AMFVST                          WDFVST
     I              AMF0ST                          WDF0ST
     I              AMF2ST                          WDF2ST
     I              AMF3ST                          WDF3ST
     I              AMJUSC                          WDJUSC
     I              AMJVSC                          WDJVSC
     I              AMV3T1                          WDV3T1
     I              AMV4T1                          WDV4T1
     I              AMV5T1                          WDV5T1
     I              AMV6T1                          WDV6T1
     I              AMV7T1                          WDV7T1
     I              AMV8T1                          WDV8T1
     I              AMV9T1                          WDV9T1
     I              AMWAT1                          WDWAT1
     I              AMWBT1                          WDWBT1
     I              AMWCT1                          WDWCT1
     I              AMWDT1                          WDWDT1
     I              AMQJNY                          WDQJNY
     I              AMQKNY                          WDQKNY
     I              AMQLNY                          WDQLNY
     I              AMP8NY                          WDP8NY
     I              AMP9NY                          WDP9NY
     I              AMQANY                          WDQANY
     I              AMQCNY                          WDQCNY
     I              AMQDNY                          WDQDNY
     I              AMQENY                          WDQENY
     I              AMQFNY                          WDQFNY
     I              AMQGNY                          WDQGNY
     I              AMQHNY                          WDQHNY
     I              AMQINY                          WDQINY
     I              AMQMNY                          WDQMNY
     I              AMMYU1                          WDMYU1
     I              AMJXSC                          WDJXSC
     I              AMJYSC                          WDJYSC
     I              AMJZSC                          WDJZSC
     I              AMJ0SC                          WDJ0SC
     I              AMMZU1                          WDMZU1
     I              AMM0U1                          WDM0U1
     I              AMM1U1                          WDM1U1
     I              AMM2U1                          WDM2U1
     I              AMM3U1                          WDM3U1
     I              AMW5DT                          WDW5DT
     I              AMW6DT                          WDW6DT
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
     I@MRREWT
      * Export Doc Order Hdr      Retrieval index
      * Renamed input format fields
     I              MRAIC3                          WEAIC3
     I              MRC4NB                          WEC4NB
     I              MRDGSX                          WEDGSX
     I              MRKXCD                          WEKXCD
     I              MRZMCD                          WEZMCD
     I              MRPSTX                          WEPSTX
     I              MRPUTX                          WEPUTX
     I              MRPVTX                          WEPVTX
     I              MRPWTX                          WEPWTX
     I              MRRVTX                          WERVTX
     I              MRPPU1                          WEPPU1
     I              MRZ7AA                          WEZ7AA
     I              MRPDU1                          WEPDU1
     I              MRZ8AA                          WEZ8AA
     I              MRRHTX                          WERHTX
     I              MRRITX                          WERITX
     I              MRRJTX                          WERJTX
     I              MRSCTX                          WESCTX
     I              MRSDTX                          WESDTX
     I              MRAAAB                          WEAAAB
     I              MRPHU1                          WEPHU1
     I              MRABAB                          WEABAB
     I              MRPXTX                          WEPXTX
     I              MRZOCD                          WEZOCD
     I              MRZNCD                          WEZNCD
     I              MRCSSX                          WECSSX
     I              MRCTSX                          WECTSX
     I              MRCUSX                          WECUSX
     I              MRCVSX                          WECVSX
     I              MRPTTX                          WEPTTX
     I              MRORNA                          WEORNA
     I              MRRKTX                          WERKTX
     I              MRPZTX                          WEPZTX
     I              MRRLTX                          WERLTX
     I              MRP0TX                          WEP0TX
     I              MRP1TX                          WEP1TX
     I              MRP2TX                          WEP2TX
     I              MRP3TX                          WEP3TX
     I              MRP4TX                          WEP4TX
     I              MRP5TX                          WEP5TX
     I              MRP6TX                          WEP6TX
     I              MRYHTX                          WEYHTX
     I              MRYITX                          WEYITX
     I              MRCWSX                          WECWSX
     I              MROUNA                          WEOUNA
     I              MRP7TX                          WEP7TX
     I              MRP9TX                          WEP9TX
     I              MROVNA                          WEOVNA
     I              MRQATX                          WEQATX
     I              MRQBTX                          WEQBTX
     I              MRQCTX                          WEQCTX
     I              MROWNA                          WEOWNA
     I              MROXNA                          WEOXNA
     I              MRABNX                          WEABNX
     I              MRACNX                          WEACNX
     I              MRADNX                          WEADNX
     I              MRQDTX                          WEQDTX
     I              MRQETX                          WEQETX
     I              MROYNA                          WEOYNA
     I              MROZNA                          WEOZNA
     I              MRO0NA                          WEO0NA
     I              MRO1NA                          WEO1NA
     I              MRCXSX                          WECXSX
     I              MRCYSX                          WECYSX
     I              MRAGNX                          WEAGNX
     I              MRCZSX                          WECZSX
     I              MRC0SX                          WEC0SX
     I              MRC1SX                          WEC1SX
     I              MRQFTX                          WEQFTX
     I              MRAHNX                          WEAHNX
     I              MRQGTX                          WEQGTX
     I              MRQHTX                          WEQHTX
     I              MRQITX                          WEQITX
     I              MRQJTX                          WEQJTX
     I              MRQKTX                          WEQKTX
     I              MRQMTX                          WEQMTX
     I              MRQNTX                          WEQNTX
     I              MRQOTX                          WEQOTX
     I              MRQPTX                          WEQPTX
     I              MRQQTX                          WEQQTX
     I              MRQRTX                          WEQRTX
     I              MRQSTX                          WEQSTX
     I              MRQTTX                          WEQTTX
     I              MRQUTX                          WEQUTX
     I              MRQVTX                          WEQVTX
     I              MRQYTX                          WEQYTX
     I              MRQWTX                          WEQWTX
     I              MRQZTX                          WEQZTX
     I              MRAINX                          WEAINX
     I              MRQ1TX                          WEQ1TX
     I              MRQ2TX                          WEQ2TX
     I              MRQ3TX                          WEQ3TX
     I              MRQ4TX                          WEQ4TX
     I              MRQ5TX                          WEQ5TX
     I              MRQ6TX                          WEQ6TX
     I              MRQ7TX                          WEQ7TX
     I              MRQ8TX                          WEQ8TX
     I              MRQ9TX                          WEQ9TX
     I              MRSMTX                          WESMTX
     I              MRZQCD                          WEZQCD
     I              MRZRCD                          WEZRCD
     I              MRA7VL                          WEA7VL
     I              MRA8VL                          WEA8VL
     I              MRC2SX                          WEC2SX
     I              MRC8SX                          WEC8SX
     I              MRHRWG                          WEHRWG
     I              MRBIVL                          WEBIVL
     I              MRK2QT                          WEK2QT
     I              MRO5NA                          WEO5NA
     I              MRHSWG                          WEHSWG
     I              MRBJVL                          WEBJVL
     I              MRRATX                          WERATX
     I              MRRBTX                          WERBTX
     I              MRRCTX                          WERCTX
     I              MRRDTX                          WERDTX
     I              MRRETX                          WERETX
     I              MRC3SX                          WEC3SX
     I              MRC4SX                          WEC4SX
     I              MRC5SX                          WEC5SX
     I              MRC6SX                          WEC6SX
     I              MRC7SX                          WEC7SX
     I              MRMQDT                          WEMQDT
     I              MRMRDT                          WEMRDT
     I              MRMSDT                          WEMSDT
     I              MRAJNX                          WEAJNX
     I              MRYFTX                          WEYFTX
     I              MRX9TX                          WEX9TX
     I              MRYATX                          WEYATX
     I              MRYBTX                          WEYBTX
     I              MRB5AA                          WEB5AA
     I              MRYCTX                          WEYCTX
     I              MRYDTX                          WEYDTX
     I              MRYETX                          WEYETX
     I              MRB6AA                          WEB6AA
     I              MRPADT                          WEPADT
     I              MRPBDT                          WEPBDT
     I              MRPCDT                          WEPCDT
     I              MRPDDT                          WEPDDT
     I              MRPEDT                          WEPEDT
     I              MRO4SX                          WEO4SX
     I              MRO5SX                          WEO5SX
     I              MRC1T1                          WEC1T1
     I              MRC2T1                          WEC2T1
     I              MRLKSC                          WELKSC
     I              MRLLSC                          WELLSC
     I              MRPIU1                          WEPIU1
     I              MRPJU1                          WEPJU1
     I              MRFFNZ                          WEFFNZ
     I              MRBUDX                          WEBUDX
     I              MRUVST                          WEUVST
     I              MRUWST                          WEUWST
     I              MRUXST                          WEUXST
     I              MRVSST                          WEVSST
     I              MRAATM                          WEAATM
     I              MRAYNA                          WEAYNA
     I              MRA0NA                          WEA0NA
     I              MRAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Ship To Zip/Postal Code
     I                                        7  17 P1CKTX
      * I :  Shipping Method
     I                                       18  19 P1Q2CD
     IP2PARM      DS
      * FLD: MPR FOB Omaha Rate Table
      * B :  MPR Country
     I                                        1   6 P2PZAA
      * N :  MPR Region
     I                                    P   7   80P2W5NY
     IP3PARM      DS
      * I :  Warehouse Code
     I                                        1   3 P3AJCD
     IP4PARM      DS
      * B :  MPR FOB Omaha Price
     I                                    P   1   42P4HNPR
     IP5PARM      DS
      * FLD: MPR Wholesale Pork Daily
      * I :  MPR FOB Plant Price/CWT
     I                                    P   1   42P5HMPR
      * I :  MPR Unit Price
     I                                    P   5  104P5HOPR
      * B :  MPR FOB Rate per Mile
     I                                    P  11  154P5HSPR
      * B :  MPR Shipping Method
     I                                       16  17 P5P6ST
      * B :  MPR State Code
     I                                       18  19 P5P0AA
      * B :  MPR Zip Code
     I                                    P  20  220P5W6NY
      * B :  MPR FOB Miles to Omaha
     I                                    P  23  260P5W7NY
     IP6PARM      DS
      * FLD: MPR FOB Omaha Control
      * N :  MPR Form ID
     I                                        1   6 P6P2AA
      * N :  MPR Minimum Freight $
     I                                    P   7   90P6XANY
      * N :  MPR Dft Load Size
     I                                    P  10  120P6XBNY
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1CKTX    PARM           WP0003 11        Ship To Zip/Pos
     C           P1Q2CD    PARM           WP0004  2        Shipping Method
     C           P2PZAA    PARM P2PZAA    WP0005  6        MPR Country
     C           P3AJCD    PARM           WP0006  3        Warehouse Code
     C           P4HNPR    PARM P4HNPR    WP0007  62       MPR FOB Omaha P
     C           P5HMPR    PARM           WP0008  62       MPR FOB Plant P
     C           P5HOPR    PARM           WP0009 114       MPR Unit Price
     C           P5HSPR    PARM P5HSPR    WP0010  94       MPR FOB Rate pe
     C           P5P6ST    PARM P5P6ST    WP0011  2        MPR Shipping Me
     C           P5P0AA    PARM P5P0AA    WP0012  2        MPR State Code
     C           P5W6NY    PARM P5W6NY    WP0013  50       MPR Zip Code
     C           P5W7NY    PARM P5W7NY    WP0014  70       MPR FOB Miles t
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Calc FOB Omaha Pr XF
      * FOB Omaha Price is calculated to zip zode --> 68108
      * Whenever the FOB Rate * Mileage is < 550, use 550 as the total fr
      * value, so use this as what to subtract from FOB Plant Price or Un
      * ($550 / 40000) * 100 = $1.375/cwt
      * Whenever the FOB Rate * Mileage is >=550, use the (fob rate*milea
      * value, so do this as what to subtract from FOB Plant Price or Uni
      * (fob rate*mileage) / 40000) * 100 = fob Omaha to subtract from FO
      * Get minimum freight $ and load size from control file:
      * RTV MPR Ctl Fields    RT - MPR FOB Omaha Control  * 
     C                     EXSR SARVGN
     C                     Z-ADD*ZERO     P4HNPR           MPR FOB Omaha P
      * If Collect - use mileage & rate from the plant/whse to Omaha
      *    and subtract calculated price from FOB Plant Price
      * IF Collect - use mileage & rate from the plant/whse to Omaha
      * CASE: PAR.Shipping Method is Collect
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
     C                     MOVEL*BLANK    P2PZAA           MPR Country
     C                     MOVEL'USA'     P2PZAA           MPR Country
      * RTV Warehouse Address  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3AJCD    WL0001    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0001    P      Warehouse Descr
     C                     MOVELWL0003    YL0002    P      Address Line 1
     C                     MOVELWL0004    YL0003    P      Address Line 2
     C                     MOVELWL0005    YL0004    P      Address Line 3
     C                     MOVELWL0006    YL0005    P      City
     C                     MOVELWL0007    YL0006    P      Zip/Postal Code
     C                     MOVELWL0008    P5P0AA    P      State Code
     C                     MOVELYL0006    YL0007           Text USR 5
     C                     MOVE YL0007    P5W6NY           MPR Zip Code
      * Rtv Rate per Zip      RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PZAA    WL0009    P      MPR Country
     C                     MOVELP5P0AA    WL0010    P      MPR State Code
     C                     Z-ADDP5W6NY    WL0011           MPR Zip Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P5HSPR           MPR FOB Rate pe
     C                     Z-ADDWL0013    P5W7NY           MPR FOB Miles t
     C           P5W7NY    MULT P5HSPR    YL0008           AMOUNT
      * If amount > 0 or dest zip is 68108 omaha
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.AMOUNT is not 0
      *   |- c2    : PAR.MPR Zip Code is eq 68108
      *   '-
     C           YL0008    IFNE 0                          *IF
     C           P5W6NY    OREQ 68108                      *OR
      * CASE: LCL.AMOUNT LT PAR.MPR Minimum Freight $
     C           YL0008    IFLT P6XANY                     *IF
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : PAR.MPR Minimum Freight $
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P6XANY    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : LCL.AMOUNT
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C           P5HOPR    SUB  P4HNPR    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C                     END                             *FI
      * If Prepaid - Domestic or NAFTA (Mex or CAN) or Overseas
      *    and subtract calculated price from Unit price (ie. delivered p
      * IF Prepaid - use mileage & rate from the destination to Omaha
      * CASE: PAR.Shipping Method is Prepaid
     C           P1Q2CD    IFEQ 'PR'                       *IF
     C           P1Q2CD    OREQ 'PT'
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
     C                     EXSR SDRVGN
      * If Intended to Export is CAN and state code is a Canadian provinc
      * CASE: LCL.OHE Intended for ExportCC is Canada
     C           YL0009    IFEQ 'CAN'                      *IF
     C                     MOVELP5P0AA    YL0010           ED MPR Canadian
      * CASE: LCL.ED MPR Canadian Province is *ALL values
     C           YL0010    IFEQ 'ON'                       *IF
     C           YL0010    OREQ 'AB'
     C           YL0010    OREQ 'BC'
     C           YL0010    OREQ 'YU'
     C           YL0010    OREQ 'MB'
     C           YL0010    OREQ 'NT'
     C           YL0010    OREQ 'NU'
     C           YL0010    OREQ 'NS'
     C           YL0010    OREQ 'SA'
     C           YL0010    OREQ 'QB'
     C                     MOVELYL0009    P2PZAA           MPR Country
     C                     END                             *FI
     C                     END                             *FI
      * MEX or USA
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MPR Country is Mexico
      *   |- c2    : PAR.MPR Country is USA
      *   '-
     C           P2PZAA    IFEQ 'MEX'                      *IF
     C           P2PZAA    OREQ 'USA'                      *OR
     C                     MOVEL*BLANK    P2PZAA           MPR Country
     C                     MOVEL'USA'     P2PZAA           MPR Country
     C                     MOVELP1CKTX    YL0007           Text USR 5
     C                     MOVE YL0007    P5W6NY           MPR Zip Code
      * Default Texas zip for MEX
      * CASE: PAR.MPR State Code is International Accounts
     C           P5P0AA    IFEQ '.'                        *IF
     C                     MOVEL'TX'      P5P0AA           MPR State Code
     C                     Z-ADD73301     P5W6NY           MPR Zip Code
     C                     END                             *FI
      * Rtv Rate per Zip      RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PZAA    WL0009    P      MPR Country
     C                     MOVELP5P0AA    WL0010    P      MPR State Code
     C                     Z-ADDP5W6NY    WL0011           MPR Zip Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P5HSPR           MPR FOB Rate pe
     C                     Z-ADDWL0013    P5W7NY           MPR FOB Miles t
     C           P5W7NY    MULT P5HSPR    YL0008           AMOUNT
      * If amount > 0 or  dest zip = 68108 omaha (let $0 go for omaha shi
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.AMOUNT is not 0
      *   |- c2    : PAR.MPR Zip Code is eq 68108
      *   '-
     C           YL0008    IFNE 0                          *IF
     C           P5W6NY    OREQ 68108                      *OR
      * CASE: LCL.AMOUNT LT PAR.MPR Minimum Freight $
     C           YL0008    IFLT P6XANY                     *IF
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : PAR.MPR Minimum Freight $
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P6XANY    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : LCL.AMOUNT
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C           P5HOPR    SUB  P4HNPR    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C                     END                             *FI
      * CAN
      * CASE: PAR.MPR Country is Canada
     C           P2PZAA    IFEQ 'CAN'                      *IF
     C                     Z-ADD99999     P5W6NY           MPR Zip Code
      * Rtv Consignee         RT - Export Doc Order Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0014           Company Number
     C                     Z-ADDP1C4NB    WL0015           Order Number
     C                     MOVEL'H'       WL0016    P      ED Export Docum
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0011    P      ED Consignee Ad
     C                     MOVELWL0018    YL0012    P      ED Consignee Ad
     C                     MOVELWL0019    YL0013    P      ED Consignee Ad
     C                     MOVELWL0020    YL0014    P      ED Consignee Ad
     C                     MOVELWL0021    YL0010    P      ED MPR Canadian
      * CASE: LCL.ED MPR Canadian Province is *ALL values
     C           YL0010    IFEQ 'ON'                       *IF
     C           YL0010    OREQ 'AB'
     C           YL0010    OREQ 'BC'
     C           YL0010    OREQ 'YU'
     C           YL0010    OREQ 'MB'
     C           YL0010    OREQ 'NT'
     C           YL0010    OREQ 'NU'
     C           YL0010    OREQ 'NS'
     C           YL0010    OREQ 'SA'
     C           YL0010    OREQ 'QB'
     C                     MOVELYL0010    P5P0AA           MPR State Code
     C                     END                             *FI
      * Rtv Rate per Zip      RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PZAA    WL0009    P      MPR Country
     C                     MOVELP5P0AA    WL0010    P      MPR State Code
     C                     Z-ADDP5W6NY    WL0011           MPR Zip Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P5HSPR           MPR FOB Rate pe
     C                     Z-ADDWL0013    P5W7NY           MPR FOB Miles t
     C           P5W7NY    MULT P5HSPR    YL0008           AMOUNT
      * If amount > 0 or  dest zip = 68108 omaha (let $0 go for omaha shi
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.AMOUNT is not 0
      *   |- c2    : PAR.MPR Zip Code is eq 68108
      *   '-
     C           YL0008    IFNE 0                          *IF
     C           P5W6NY    OREQ 68108                      *OR
      * CASE: LCL.AMOUNT LT PAR.MPR Minimum Freight $
     C           YL0008    IFLT P6XANY                     *IF
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : PAR.MPR Minimum Freight $
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P6XANY    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : LCL.AMOUNT
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C           P5HOPR    SUB  P4HNPR    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C                     END                             *FI
      * Overseas
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : PAR.MPR Country is Not Canada
      *   |- c2    : PAR.MPR Country is Not Mexico
      *   |- c3    : PAR.MPR Country is Not USA
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PZAA    IFNE 'CAN'                      *IF
     C           P2PZAA    IFNE 'MEX'                      *IF
     C           P2PZAA    IFNE 'USA'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Dest is Domestic State
      * CASE: PAR.MPR State Code is Not International
     C           P5P0AA    IFNE '.'                        *IF
     C                     MOVEL*BLANK    P2PZAA           MPR Country
     C                     MOVEL'USA'     P2PZAA           MPR Country
     C                     MOVELP1CKTX    YL0007           Text USR 5
     C                     MOVE YL0007    P5W6NY           MPR Zip Code
      * Rtv Rate per Zip      RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PZAA    WL0009    P      MPR Country
     C                     MOVELP5P0AA    WL0010    P      MPR State Code
     C                     Z-ADDP5W6NY    WL0011           MPR Zip Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P5HSPR           MPR FOB Rate pe
     C                     Z-ADDWL0013    P5W7NY           MPR FOB Miles t
     C           P5W7NY    MULT P5HSPR    YL0008           AMOUNT
      * If amount > 0 or  dest zip = 68108 omaha (let $0 go for omaha shi
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.AMOUNT is not 0
      *   |- c2    : PAR.MPR Zip Code is eq 68108
      *   '-
     C           YL0008    IFNE 0                          *IF
     C           P5W6NY    OREQ 68108                      *OR
      * CASE: LCL.AMOUNT LT PAR.MPR Minimum Freight $
     C           YL0008    IFLT P6XANY                     *IF
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : PAR.MPR Minimum Freight $
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P6XANY    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : LCL.AMOUNT
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C           P5HOPR    SUB  P4HNPR    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C                     END                             *FI
      * If Dest is Overseas - FOB Plant price instead of delivered price
      * CASE: PAR.MPR State Code is International Accounts
     C           P5P0AA    IFEQ '.'                        *IF
      * Get mileage from plant/warehouse to Omaha
     C                     MOVEL*BLANK    P2PZAA           MPR Country
     C                     MOVEL'USA'     P2PZAA           MPR Country
      * RTV Warehouse Address  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3AJCD    WL0001    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0001    P      Warehouse Descr
     C                     MOVELWL0003    YL0002    P      Address Line 1
     C                     MOVELWL0004    YL0003    P      Address Line 2
     C                     MOVELWL0005    YL0004    P      Address Line 3
     C                     MOVELWL0006    YL0005    P      City
     C                     MOVELWL0007    YL0006    P      Zip/Postal Code
     C                     MOVELWL0008    P5P0AA    P      State Code
     C                     MOVELYL0006    YL0007           Text USR 5
     C                     MOVE YL0007    P5W6NY           MPR Zip Code
      * Rtv Rate per Zip      RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PZAA    WL0009    P      MPR Country
     C                     MOVELP5P0AA    WL0010    P      MPR State Code
     C                     Z-ADDP5W6NY    WL0011           MPR Zip Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P5HSPR           MPR FOB Rate pe
     C                     Z-ADDWL0013    P5W7NY           MPR FOB Miles t
     C           P5W7NY    MULT P5HSPR    YL0008           AMOUNT
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.AMOUNT is not 0
      *   |- c2    : PAR.MPR Zip Code is eq 68108
      *   '-
     C           YL0008    IFNE 0                          *IF
     C           P5W6NY    OREQ 68108                      *OR
      * DO FOR OVERSEAS     as of 4/25/2013 per April 16 2013 audit
      * CASE: LCL.AMOUNT LT PAR.MPR Minimum Freight $
     C           YL0008    IFLT P6XANY                     *IF
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : PAR.MPR Minimum Freight $
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P6XANY    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : LCL.AMOUNT
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C           P5HMPR    SUB  P4HNPR    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C                     END                             *FI
      * If Dest is foreign, but address is CANada, treat as Canada
      * RTV Val Canada state  RT - MPR FOB Omaha Rate Table  * 
     C                     EXSR SFRVGN
      * CAN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0015    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P2PZAA           MPR Country
     C                     MOVEL'CAN'     P2PZAA           MPR Country
     C                     Z-ADD99999     P5W6NY           MPR Zip Code
      * Rtv Consignee         RT - Export Doc Order Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0014           Company Number
     C                     Z-ADDP1C4NB    WL0015           Order Number
     C                     MOVEL'H'       WL0016    P      ED Export Docum
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0011    P      ED Consignee Ad
     C                     MOVELWL0018    YL0012    P      ED Consignee Ad
     C                     MOVELWL0019    YL0013    P      ED Consignee Ad
     C                     MOVELWL0020    YL0014    P      ED Consignee Ad
     C                     MOVELWL0021    YL0010    P      ED MPR Canadian
      * CASE: LCL.ED MPR Canadian Province is *ALL values
     C           YL0010    IFEQ 'ON'                       *IF
     C           YL0010    OREQ 'AB'
     C           YL0010    OREQ 'BC'
     C           YL0010    OREQ 'YU'
     C           YL0010    OREQ 'MB'
     C           YL0010    OREQ 'NT'
     C           YL0010    OREQ 'NU'
     C           YL0010    OREQ 'NS'
     C           YL0010    OREQ 'SA'
     C           YL0010    OREQ 'QB'
     C                     MOVELYL0010    P5P0AA           MPR State Code
     C                     END                             *FI
      * Rtv Rate per Zip      RT - MPR FOB Omaha Rate Table  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2PZAA    WL0009    P      MPR Country
     C                     MOVELP5P0AA    WL0010    P      MPR State Code
     C                     Z-ADDP5W6NY    WL0011           MPR Zip Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P5HSPR           MPR FOB Rate pe
     C                     Z-ADDWL0013    P5W7NY           MPR FOB Miles t
     C           P5W7NY    MULT P5HSPR    YL0008           AMOUNT
      * If amount > 0 or  dest zip = 68108 omaha (let $0 go for omaha shi
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.AMOUNT is not 0
      *   |- c2    : PAR.MPR Zip Code is eq 68108
      *   '-
     C           YL0008    IFNE 0                          *IF
     C           P5W6NY    OREQ 68108                      *OR
      * CASE: LCL.AMOUNT LT PAR.MPR Minimum Freight $
     C           YL0008    IFLT P6XANY                     *IF
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : PAR.MPR Minimum Freight $
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P6XANY    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: fob omaha price
      * PAR.MPR FOB Omaha Price =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : LCL.AMOUNT
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.MPR Dft Load Size
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0008    DIV  P6XBNY    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C           P5HOPR    SUB  P4HNPR    P4HNPR           MPR FOB Omaha P
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV MPR Ctl Fields    RT - MPR FOB Omaha Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAP2AA           MPR Form ID
      * Setup key
     C                     MOVE *BLANK    WAP2AA           MPR Form ID
     C                     MOVEL'LS89'    WAP2AA           MPR Form ID
      * Establish starting position
     C           KRSSA     CHAIN@ASREOY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4555' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P6XANY           MPR Minimum Fre
     C                     Z-ADD*ZERO     P6XBNY           MPR Dft Load Si
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAXANY    P6XANY           MPR Minimum Fre
     C                     Z-ADDWAXBNY    P6XBNY           MPR Dft Load Si
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Warehouse Address  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBF8NA    WL0002           Warehouse Descr
     C                     MOVELWBACNA    WL0003           Address Line 1
     C                     MOVELWBADNA    WL0004           Address Line 2
     C                     MOVELWBAENA    WL0005           Address Line 3
     C                     MOVELWBAJNA    WL0006           City
     C                     MOVELWBBTTX    WL0007           Zip/Postal Code
     C                     MOVELWBBGCD    WL0008           State Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Rate per Zip      RT - MPR FOB Omaha Rate Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCPZAA    WQSC01           MPR Country
     C           *LIKE     DEFN WCP0AA    WQSC02           MPR State Code
     C           *LIKE     DEFN WCW6NY    WQSC03           MPR Zip Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           MPR Country
     C                     KFLD           WQSC02           MPR State Code
     C                     KFLD           WQSC03           MPR Zip Code
      * Setup key
     C                     MOVELWL0009    WQSC01           MPR Country
     C                     MOVELWL0010    WQSC02           MPR State Code
     C                     Z-ADDWL0011    WQSC03           MPR Zip Code
      * Establish starting position
     C           KRSSC     SETLL@ARCPOV                    *
     C           KRSSC     READE@ARCPOV                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4551' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0012           MPR FOB Rate pe
     C                     Z-ADD*ZERO     WL0013           MPR FOB Miles t
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCHSPR    WL0012           MPR FOB Rate pe
     C                     Z-ADDWCW7NY    WL0013           MPR FOB Miles t
     C           KRSSC     READE@ARCPOV                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDLWAA    YL0009           OHE Intended fo
     C                     GOTO SDEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Consignee         RT - Export Doc Order Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
     C           *LIKE     DEFN WEDGSX    WQSE03           ED Export Docum
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WQSE03           ED Export Docum
      * Setup key
     C                     Z-ADDWL0014    WQSE01           Company Number
     C                     Z-ADDWL0015    WQSE02           Order Number
     C                     MOVELWL0016    WQSE03           ED Export Docum
      * Establish starting position
     C           KRSSE     SETLL@MRREWT                    *
     C           KRSSE     READE@MRREWT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2743' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0017           ED Consignee Ad
     C                     MOVEL*BLANK    WL0018           ED Consignee Ad
     C                     MOVEL*BLANK    WL0019           ED Consignee Ad
     C                     MOVEL*BLANK    WL0020           ED Consignee Ad
     C                     MOVEL*BLANK    WL0021           ED MPR Canadian
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWERITX    WL0017           ED Consignee Ad
     C                     MOVELWERJTX    WL0018           ED Consignee Ad
     C                     MOVELWESCTX    WL0019           ED Consignee Ad
     C                     MOVELWESDTX    WL0020           ED Consignee Ad
     C                     MOVELWEO5SX    WL0021           ED MPR Canadian
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@MRREWT                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Val Canada state  RT - MPR FOB Omaha Rate Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCPZAA    WQSF01           MPR Country
     C           *LIKE     DEFN WCP0AA    WQSF02           MPR State Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           MPR Country
     C                     KFLD           WQSF02           MPR State Code
      * Setup key
     C                     MOVE *BLANK    WQSF01           MPR Country
     C                     MOVEL'CAN'     WQSF01           MPR Country
     C                     MOVELP5P0AA    WQSF02           MPR State Code
      * Establish starting position
     C           KRSSF     SETLL@ARCPOV                    *
     C           KRSSF     READE@ARCPOV                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4551' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0015           Record Found US
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0015           Record Found US
     C           KRSSF     READE@ARCPOV                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2W5NY           MPR Region
     C                     MOVEL*BLANK    P6P2AA           MPR Form ID
     C                     Z-ADD*ZERO     P6XANY           MPR Minimum Fre
     C                     Z-ADD*ZERO     P6XBNY           MPR Dft Load Si
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAW6NY           MPR Zip Code
     C                     Z-ADD*ZERO     WAXANY           MPR Minimum Fre
     C                     Z-ADD*ZERO     WAXBNY           MPR Dft Load Si
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCW5NY           MPR Region
     C                     Z-ADD*ZERO     WCW6NY           MPR Zip Code
     C                     Z-ADD*ZERO     WCHSPR           MPR FOB Rate pe
     C                     Z-ADD*ZERO     WCW7NY           MPR FOB Miles t
     C                     Z-ADD*ZERO     WCU2DT           MPR FOB Unused
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WDQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WDQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WDQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WDGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WDHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WDHGVL           Transload Termi
     C                     Z-ADD*ZERO     WDQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WDQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WDQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WDQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WDITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WDQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WDQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WDQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WDP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WDQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WDQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WDQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WDQENY           Original Appoin
     C                     Z-ADD*ZERO     WDQFNY           Original Appoin
     C                     Z-ADD*ZERO     WDQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WDQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WDW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEABNX           ED Can. Import
     C                     Z-ADD*ZERO     WEACNX           ED Can. Import
     C                     Z-ADD*ZERO     WEADNX           ED Seaboard Pla
     C                     Z-ADD*ZERO     WEAHNX           ED Plant Contac
     C                     Z-ADD*ZERO     WEAINX           ED Nbr of prods
     C                     Z-ADD*ZERO     WEA7VL           ED Total Unit P
     C                     Z-ADD*ZERO     WEA8VL           ED Invoice Tota
     C                     Z-ADD*ZERO     WEHRWG           ED Total Net We
     C                     Z-ADD*ZERO     WEBIVL           ED Total Net We
     C                     Z-ADD*ZERO     WEK2QT           ED Nbr of Packa
     C                     Z-ADD*ZERO     WEHSWG           ED Total Gross
     C                     Z-ADD*ZERO     WEBJVL           ED Total Gross
     C                     Z-ADD*ZERO     WEMQDT           ED Export Certi
     C                     Z-ADD*ZERO     WEMRDT           ED Sail Date
     C                     Z-ADD*ZERO     WEMSDT           ED Sworn on Dat
     C                     Z-ADD*ZERO     WEAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WEPADT           ED Document Dat
     C                     Z-ADD*ZERO     WEPBDT           ED Packing Date
     C                     Z-ADD*ZERO     WEPCDT           ED Expiration D
     C                     Z-ADD*ZERO     WEPDDT           ED Packing Date
     C                     Z-ADD*ZERO     WEPEDT           ED Unused Date
     C                     Z-ADD*ZERO     WEFFNZ           EDOH Unused Num
     C                     Z-ADD*ZERO     WEBUDX           EDOH Unused Dat
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 20
     C                     MOVEL*BLANK    WL0007 11
     C                     MOVEL*BLANK    WL0008  2
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0009  6
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  50
     C                     Z-ADD*ZERO     WL0012  94
     C                     Z-ADD*ZERO     WL0013  70
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017 63
     C                     MOVEL*BLANK    WL0018 63
     C                     MOVEL*BLANK    WL0019 63
     C                     MOVEL*BLANK    WL0020 63
     C                     MOVEL*BLANK    WL0021  2
      * Define local work field Warehouse Description
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field Address Line 1
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0003 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0004 30
      * Define local work field City
     C                     MOVEL*BLANK    YL0005 20
      * Define local work field Zip/Postal Code
     C                     MOVEL*BLANK    YL0006 11
      * Define local work field Text USR 5
     C                     MOVEL*BLANK    YL0007  5
      * Define local work field AMOUNT
     C                     Z-ADD*ZERO     YL0008  82
      * Define local work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field ED MPR Canadian Province
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field ED Consignee Addr 1
     C                     MOVEL*BLANK    YL0011 63
      * Define local work field ED Consignee Addr 2
     C                     MOVEL*BLANK    YL0012 63
      * Define local work field ED Consignee Addr 3
     C                     MOVEL*BLANK    YL0013 63
      * Define local work field ED Consignee Addr 4
     C                     MOVEL*BLANK    YL0014 63
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0015  1
      *================================================================
     CSR         ZZEXIT    ENDSR
