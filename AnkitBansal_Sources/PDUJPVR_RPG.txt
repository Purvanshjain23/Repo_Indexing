     H/TITLE Prt Export Load Report PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 02/05/20  Time  : 10:32:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDUJPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Prt Export Load Report PV Prompt & validate record
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOME5REL2IF  E           K        DISK
      * RTV : Country                   Active Only
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker                    Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FCABBREL4IF  E           K        DISK
      * RSQ : Customer                  Bill To/Ship To
      *
     FOMHOREL2IF  E           K        DISK
      * RSQ : Customer Accrual          RSQ Accrual
      *
     FPMAMRELHIF  E           K        DISK
      * RSQ : Order Header Extension    Booking Number
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FCAADREL6IF  E           K        DISK
      * RSQ : Warehouse                 Typ/Whs
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 058  5 0A
     E                    W0END   7 058  5 0A
     E                    W0NAM   7 058 10
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WAAIC3
     I              JYZ9ST                          WAZ9ST
     I              JYCSST                          WACSST
     I              JYZ8ST                          WAZ8ST
     I              JYCXST                          WACXST
     I              JYSWST                          WASWST
     I              JYXXTM                          WAXXTM
     I              JYUECD                          WAUECD
     I              JYHSST                          WAHSST
     I              JYAMEO                          WAAMEO
     I              JYSSDF                          WASSDF
     I              JYPDFT                          WAPDFT
     I              JYYISX                          WAYISX
     I              JYYJSX                          WAYJSX
     I              JYYKSX                          WAYKSX
     I              JYYLSX                          WAYLSX
     I              JYYMSX                          WAYMSX
     I              JYYNSX                          WAYNSX
     I              JYUVST                          WAUVST
     I              JYUWST                          WAUWST
     I              JYUXST                          WAUXST
     I              JYVSST                          WAVSST
     I              JYAATM                          WAAATM
     I              JYAYNA                          WAAYNA
     I              JYA0NA                          WAA0NA
     I              JYAXDT                          WAAXDT
      *
     I@E5REVS
      * Country                   Active Only
      * Renamed input format fields
     I              E5KXCD                          WBKXCD
     I              E5DATX                          WBDATX
     I              E5UVST                          WBUVST
     I              E5UWST                          WBUWST
     I              E5UXST                          WBUXST
     I              E5VSST                          WBVSST
     I              E5AATM                          WBAATM
     I              E5AYNA                          WBAYNA
     I              E5A0NA                          WBA0NA
     I              E5AXDT                          WBAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WCBKC7
     I              BBAYTX                          WCAYTX
     I              BBACNA                          WCACNA
     I              BBADNA                          WCADNA
     I              BBAENA                          WCAENA
     I              BBAJNA                          WCAJNA
     I              BBBGCD                          WCBGCD
     I              BBG5CD                          WCG5CD
     I              BBBTTX                          WCBTTX
     I              BBBVTX                          WCBVTX
     I              BBBWTX                          WCBWTX
     I              BBABTX                          WCABTX
     I              BBA2NA                          WCA2NA
     I              BBCBST                          WCCBST
     I              BBB0NA                          WCB0NA
     I              BBP3NB                          WCP3NB
     I              BBAXNA                          WCAXNA
     I              BBI6DT                          WCI6DT
     I              BBAYDT                          WCAYDT
     I              BBANC7                          WCANC7
     I              BBBTC7                          WCBTC7
     I              BBK6ST                          WCK6ST
     I              BBUZST                          WCUZST
     I              BBKXCD                          WCKXCD
     I              BBLTCD                          WCLTCD
     I              BBQNST                          WCQNST
     I              BBS2NB                          WCS2NB
     I              BBVHVA                          WCVHVA
     I              BBI7DT                          WCI7DT
     I              BBRJST                          WCRJST
     I              BBRKST                          WCRKST
     I              BBQWST                          WCQWST
     I              BBQXST                          WCQXST
     I              BBQYST                          WCQYST
     I              BBUNCS                          WCUNCS
     I              BBUVST                          WCUVST
     I              BBUWST                          WCUWST
     I              BBUXST                          WCUXST
     I              BBVSST                          WCVSST
     I              BBAATM                          WCAATM
     I              BBAYNA                          WCAYNA
     I              BBA0NA                          WCA0NA
     I              BBAXDT                          WCAXDT
      *
     I@C5RESJ
      * Broker                    Retrieval index
      * Renamed input format fields
     I              C5HHAA                          WDHHAA
     I              C5C4T1                          WDC4T1
     I              C5QMNA                          WDQMNA
     I              C5QNNA                          WDQNNA
     I              C5QONA                          WDQONA
     I              C5QPNA                          WDQPNA
     I              C5C5T1                          WDC5T1
     I              C5C6T1                          WDC6T1
     I              C5C7T1                          WDC7T1
     I              C5C8T1                          WDC8T1
     I              C5C9T1                          WDC9T1
     I              C5DAT1                          WDDAT1
     I              C5DBT1                          WDDBT1
     I              C5DCT1                          WDDCT1
     I              C5DDT1                          WDDDT1
     I              C5PWSX                          WDPWSX
     I              C5PXSX                          WDPXSX
     I              C5PYSX                          WDPYSX
     I              C5PZSX                          WDPZSX
     I              C5BCCD                          WDBCCD
     I              C5UVST                          WDUVST
     I              C5UWST                          WDUWST
     I              C5UXST                          WDUXST
     I              C5VSST                          WDVSST
     I              C5AATM                          WDAATM
     I              C5AYNA                          WDAYNA
     I              C5A0NA                          WDA0NA
     I              C5AXDT                          WDAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WFBZNA
     I              FFADTX                          WFADTX
     I              FFACNA                          WFACNA
     I              FFADNA                          WFADNA
     I              FFAENA                          WFAENA
     I              FFAJNA                          WFAJNA
     I              FFBTTX                          WFBTTX
     I              FFEZNB                          WFEZNB
     I              FFBGCD                          WFBGCD
     I              FFEEDT                          WFEEDT
     I              FFDUTX                          WFDUTX
     I              FFNRVA                          WFNRVA
     I              FFNSVA                          WFNSVA
     I              FFNTVA                          WFNTVA
     I              FFNUVA                          WFNUVA
     I              FFP1ST                          WFP1ST
     I              FFDVTX                          WFDVTX
     I              FFDWTX                          WFDWTX
     I              FFLVCD                          WFLVCD
     I              FFS8NB                          WFS8NB
     I              FFS9NB                          WFS9NB
     I              FFNMVA                          WFNMVA
     I              FFNOVA                          WFNOVA
     I              FFNPVA                          WFNPVA
     I              FFNQVA                          WFNQVA
     I              FFMFCD                          WFMFCD
     I              FFQXNB                          WFQXNB
     I              FFQ1NB                          WFQ1NB
     I              FFMRNG                          WFMRNG
     I              FFMRNE                          WFMRNE
     I              FFRFNB                          WFRFNB
     I              FFMREG                          WFMREG
     I              FFBQPR                          WFBQPR
     I              FFBRPR                          WFBRPR
     I              FFBSPR                          WFBSPR
     I              FFBTPR                          WFBTPR
     I              FFBUPR                          WFBUPR
     I              FFBVPR                          WFBVPR
     I              FFDJWG                          WFDJWG
     I              FFDKWG                          WFDKWG
     I              FFDLWG                          WFDLWG
     I              FFDMWG                          WFDMWG
     I              FFDNWG                          WFDNWG
     I              FFDOWG                          WFDOWG
     I              FFB2PR                          WFB2PR
     I              FFB3PR                          WFB3PR
     I              FFB4PR                          WFB4PR
     I              FFB5PR                          WFB5PR
     I              FFB6PR                          WFB6PR
     I              FFB7PR                          WFB7PR
     I              FFAAC7                          WFAAC7
     I              FFCOFI                          WFCOFI
     I              FFK6TX                          WFK6TX
     I              FFOCNA                          WFOCNA
     I              FFODNA                          WFODNA
     I              FFW7CD                          WFW7CD
     I              FFK7TX                          WFK7TX
     I              FFTENO                          WFTENO
     I              FFK8TX                          WFK8TX
     I              FFAOFC                          WFAOFC
     I              FFAOLI                          WFAOLI
     I              FFKHDT                          WFKHDT
     I              FFUNUS                          WFUNUS
     I              FFUNU2                          WFUNU2
     I              FFUNU3                          WFUNU3
     I              FFUVST                          WFUVST
     I              FFUWST                          WFUWST
     I              FFUXST                          WFUXST
     I              FFVSST                          WFVSST
     I              FFAATM                          WFAATM
     I              FFAYNA                          WFAYNA
     I              FFA0NA                          WFA0NA
     I              FFAXDT                          WFAXDT
      *
     I@BBREC1
      * Customer                  Bill To/Ship To
      * Renamed input format fields
     I              BBBKC7                          WGBKC7
     I              BBAYTX                          WGAYTX
     I              BBACNA                          WGACNA
     I              BBADNA                          WGADNA
     I              BBAENA                          WGAENA
     I              BBAJNA                          WGAJNA
     I              BBBGCD                          WGBGCD
     I              BBG5CD                          WGG5CD
     I              BBBTTX                          WGBTTX
     I              BBBVTX                          WGBVTX
     I              BBBWTX                          WGBWTX
     I              BBABTX                          WGABTX
     I              BBA2NA                          WGA2NA
     I              BBCBST                          WGCBST
     I              BBB0NA                          WGB0NA
     I              BBP3NB                          WGP3NB
     I              BBAXNA                          WGAXNA
     I              BBI6DT                          WGI6DT
     I              BBAYDT                          WGAYDT
     I              BBANC7                          WGANC7
     I              BBBTC7                          WGBTC7
     I              BBK6ST                          WGK6ST
     I              BBUZST                          WGUZST
     I              BBKXCD                          WGKXCD
     I              BBLTCD                          WGLTCD
     I              BBQNST                          WGQNST
     I              BBS2NB                          WGS2NB
     I              BBVHVA                          WGVHVA
     I              BBI7DT                          WGI7DT
     I              BBRJST                          WGRJST
     I              BBRKST                          WGRKST
     I              BBQWST                          WGQWST
     I              BBQXST                          WGQXST
     I              BBQYST                          WGQYST
     I              BBUNCS                          WGUNCS
     I              BBUVST                          WGUVST
     I              BBUWST                          WGUWST
     I              BBUXST                          WGUXST
     I              BBVSST                          WGVSST
     I              BBAATM                          WGAATM
     I              BBAYNA                          WGAYNA
     I              BBA0NA                          WGA0NA
     I              BBAXDT                          WGAXDT
      *
     I@HORELO
      * Customer Accrual          RSQ Accrual
      * Renamed input format fields
     I              HOBKC7                          WHBKC7
     I              HOOJCD                          WHOJCD
     I              HOGUNY                          WHGUNY
     I              HOBFDT                          WHBFDT
     I              HOA2DT                          WHA2DT
     I              HOBKPR                          WHBKPR
     I              HOTTST                          WHTTST
     I              HOSHSX                          WHSHSX
     I              HOQDSX                          WHQDSX
     I              HOPJDT                          WHPJDT
     I              HOPKDT                          WHPKDT
     I              HOECVL                          WHECVL
     I              HOQESX                          WHQESX
     I              HOQFSX                          WHQFSX
     I              HOHHAA                          WHHHAA
     I              HOHQVL                          WHHQVL
     I              HOQGSX                          WHQGSX
     I              HOQHSX                          WHQHSX
     I              HOQISX                          WHQISX
     I              HOQJSX                          WHQJSX
     I              HOUVST                          WHUVST
     I              HOUWST                          WHUWST
     I              HOUXST                          WHUXST
     I              HOAATM                          WHAATM
     I              HOAYNA                          WHAYNA
     I              HOA0NA                          WHA0NA
     I              HOAXDT                          WHAXDT
      *
     I@AMREMK
      * Order Header Extension    Booking Number
      * Renamed input format fields
     I              AMAIC3                          WIAIC3
     I              AMC4NB                          WIC4NB
     I              AMRMNB                          WIRMNB
     I              AMRUNB                          WIRUNB
     I              AMXACD                          WIXACD
     I              AMOANA                          WIOANA
     I              AMHBAA                          WIHBAA
     I              AMJ0T1                          WIJ0T1
     I              AMGENY                          WIGENY
     I              AMJ1T1                          WIJ1T1
     I              AMHCAA                          WIHCAA
     I              AMQWDT                          WIQWDT
     I              AMQXDT                          WIQXDT
     I              AMQYDT                          WIQYDT
     I              AMHDAA                          WIHDAA
     I              AMCCTX                          WICCTX
     I              AMJ2T1                          WIJ2T1
     I              AMRLNA                          WIRLNA
     I              AMRMNA                          WIRMNA
     I              AMGINY                          WIGINY
     I              AMGFNY                          WIGFNY
     I              AMGGNY                          WIGGNY
     I              AMGHNY                          WIGHNY
     I              AMHEVL                          WIHEVL
     I              AMHFVL                          WIHFVL
     I              AMHGVL                          WIHGVL
     I              AMQZDT                          WIQZDT
     I              AMQ0DT                          WIQ0DT
     I              AMQ1DT                          WIQ1DT
     I              AMQ2DT                          WIQ2DT
     I              AMC2TX                          WIC2TX
     I              AMC3TX                          WIC3TX
     I              AMC6TX                          WIC6TX
     I              AMCHTX                          WICHTX
     I              AMCITX                          WICITX
     I              AMCLTX                          WICLTX
     I              AMB4TX                          WIB4TX
     I              AMCUTX                          WICUTX
     I              AMCVTX                          WICVTX
     I              AMB9TX                          WIB9TX
     I              AMJWSC                          WIJWSC
     I              AMITNY                          WIITNY
     I              AMLMT1                          WILMT1
     I              AMLWAA                          WILWAA
     I              AMFVST                          WIFVST
     I              AMF0ST                          WIF0ST
     I              AMF2ST                          WIF2ST
     I              AMF3ST                          WIF3ST
     I              AMJUSC                          WIJUSC
     I              AMJVSC                          WIJVSC
     I              AMV3T1                          WIV3T1
     I              AMV4T1                          WIV4T1
     I              AMV5T1                          WIV5T1
     I              AMV6T1                          WIV6T1
     I              AMV7T1                          WIV7T1
     I              AMV8T1                          WIV8T1
     I              AMV9T1                          WIV9T1
     I              AMWAT1                          WIWAT1
     I              AMWBT1                          WIWBT1
     I              AMWCT1                          WIWCT1
     I              AMWDT1                          WIWDT1
     I              AMQJNY                          WIQJNY
     I              AMQKNY                          WIQKNY
     I              AMQLNY                          WIQLNY
     I              AMP8NY                          WIP8NY
     I              AMP9NY                          WIP9NY
     I              AMQANY                          WIQANY
     I              AMQCNY                          WIQCNY
     I              AMQDNY                          WIQDNY
     I              AMQENY                          WIQENY
     I              AMQFNY                          WIQFNY
     I              AMQGNY                          WIQGNY
     I              AMQHNY                          WIQHNY
     I              AMQINY                          WIQINY
     I              AMQMNY                          WIQMNY
     I              AMMYU1                          WIMYU1
     I              AMJXSC                          WIJXSC
     I              AMJYSC                          WIJYSC
     I              AMJZSC                          WIJZSC
     I              AMJ0SC                          WIJ0SC
     I              AMMZU1                          WIMZU1
     I              AMM0U1                          WIM0U1
     I              AMM1U1                          WIM1U1
     I              AMM2U1                          WIM2U1
     I              AMM3U1                          WIM3U1
     I              AMW5DT                          WIW5DT
     I              AMW6DT                          WIW6DT
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
     I@E5REB8
      * Country                   Retrieval index
      * Renamed input format fields
     I              E5KXCD                          WJKXCD
     I              E5DATX                          WJDATX
     I              E5UVST                          WJUVST
     I              E5UWST                          WJUWST
     I              E5UXST                          WJUXST
     I              E5VSST                          WJVSST
     I              E5AATM                          WJAATM
     I              E5AYNA                          WJAYNA
     I              E5A0NA                          WJA0NA
     I              E5AXDT                          WJAXDT
      *
     I@ADREOJ
      * Warehouse                 Typ/Whs
      * Renamed input format fields
     I              ADAJCD                          WKAJCD
     I              ADF8NA                          WKF8NA
     I              ADACNA                          WKACNA
     I              ADADNA                          WKADNA
     I              ADAENA                          WKAENA
     I              ADAJNA                          WKAJNA
     I              ADBTTX                          WKBTTX
     I              ADAOCD                          WKAOCD
     I              ADBGCD                          WKBGCD
     I              ADVHST                          WKVHST
     I              ADMPNA                          WKMPNA
     I              ADWPST                          WKWPST
     I              ADXUST                          WKXUST
     I              ADT0ST                          WKT0ST
     I              ADT1ST                          WKT1ST
     I              ADDBNB                          WKDBNB
     I              ADT2ST                          WKT2ST
     I              ADT3ST                          WKT3ST
     I              ADT4ST                          WKT4ST
     I              ADT6ST                          WKT6ST
     I              ADBWC3                          WKBWC3
     I              ADBTC3                          WKBTC3
     I              ADBUC3                          WKBUC3
     I              ADBVC3                          WKBVC3
     I              ADFCAA                          WKFCAA
     I              ADRQSX                          WKRQSX
     I              ADRRSX                          WKRRSX
     I              ADRSSX                          WKRSSX
     I              ADRTSX                          WKRTSX
     I              ADT7ST                          WKT7ST
     I              ADT8ST                          WKT8ST
     I              ADRNSX                          WKRNSX
     I              ADROSX                          WKROSX
     I              ADRPSX                          WKRPSX
     I              ADUVST                          WKUVST
     I              ADUWST                          WKUWST
     I              ADUXST                          WKUXST
     I              ADVSST                          WKVSST
     I              ADAATM                          WKAATM
     I              ADAYNA                          WKAYNA
     I              ADA0NA                          WKA0NA
     I              ADAXDT                          WKAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WLAJCD
     I              ADF8NA                          WLF8NA
     I              ADACNA                          WLACNA
     I              ADADNA                          WLADNA
     I              ADAENA                          WLAENA
     I              ADAJNA                          WLAJNA
     I              ADBTTX                          WLBTTX
     I              ADAOCD                          WLAOCD
     I              ADBGCD                          WLBGCD
     I              ADVHST                          WLVHST
     I              ADMPNA                          WLMPNA
     I              ADWPST                          WLWPST
     I              ADXUST                          WLXUST
     I              ADT0ST                          WLT0ST
     I              ADT1ST                          WLT1ST
     I              ADDBNB                          WLDBNB
     I              ADT2ST                          WLT2ST
     I              ADT3ST                          WLT3ST
     I              ADT4ST                          WLT4ST
     I              ADT6ST                          WLT6ST
     I              ADBWC3                          WLBWC3
     I              ADBTC3                          WLBTC3
     I              ADBUC3                          WLBUC3
     I              ADBVC3                          WLBVC3
     I              ADFCAA                          WLFCAA
     I              ADRQSX                          WLRQSX
     I              ADRRSX                          WLRRSX
     I              ADRSSX                          WLRSSX
     I              ADRTSX                          WLRTSX
     I              ADT7ST                          WLT7ST
     I              ADT8ST                          WLT8ST
     I              ADRNSX                          WLRNSX
     I              ADROSX                          WLROSX
     I              ADRPSX                          WLRPSX
     I              ADUVST                          WLUVST
     I              ADUWST                          WLUWST
     I              ADUXST                          WLUXST
     I              ADVSST                          WLVSST
     I              ADAATM                          WLAATM
     I              ADAYNA                          WLAYNA
     I              ADA0NA                          WLA0NA
     I              ADAXDT                          WLAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WMAIC3
     I              KMV8CD                          WMV8CD
     I              KMAUNA                          WMAUNA
     I              KMI5ST                          WMI5ST
     I              KMBXTX                          WMBXTX
     I              KMM8NB                          WMM8NB
     I              KMUVST                          WMUVST
     I              KMUWST                          WMUWST
     I              KMUXST                          WMUXST
     I              KMVSST                          WMVSST
     I              KMAATM                          WMAATM
     I              KMAYNA                          WMAYNA
     I              KMA0NA                          WMA0NA
     I              KMAXDT                          WMAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WOAJVN
     I              DRAUNA                          WOAUNA
     I              DRB8NA                          WOB8NA
     I              DRAHVN                          WOAHVN
     I              DRI6ST                          WOI6ST
     I              DRI7ST                          WOI7ST
     I              DRXMST                          WOXMST
     I              DRXNST                          WOXNST
     I              DRI8ST                          WOI8ST
     I              DRNLNB                          WONLNB
     I              DRMPNA                          WOMPNA
     I              DRBCCD                          WOBCCD
     I              DRAIC3                          WOAIC3
     I              DRDQCD                          WODQCD
     I              DRDRCD                          WODRCD
     I              DRAJCD                          WOAJCD
     I              DRBUVN                          WOBUVN
     I              DRUVST                          WOUVST
     I              DRUWST                          WOUWST
     I              DRUXST                          WOUXST
     I              DRAATM                          WOAATM
     I              DRAYNA                          WOAYNA
     I              DRA0NA                          WOA0NA
     I              DRAXDT                          WOAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WRAJVN
     I              DTDNCD                          WRDNCD
     I              DTAIC3                          WRAIC3
     I              DTDQCD                          WRDQCD
     I              DTDRCD                          WRDRCD
     I              DTAJCD                          WRAJCD
     I              DTJFST                          WRJFST
     I              DTUVST                          WRUVST
     I              DTUWST                          WRUWST
     I              DTUXST                          WRUXST
     I              DTAATM                          WRAATM
     I              DTAYNA                          WRAYNA
     I              DTA0NA                          WRA0NA
     I              DTAXDT                          WRAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WSDNCD
     I              DNAUNA                          WSAUNA
     I              DNVKST                          WSVKST
     I              DNRSCD                          WSRSCD
     I              DNUVST                          WSUVST
     I              DNUWST                          WSUWST
     I              DNUXST                          WSUXST
     I              DNAATM                          WSAATM
     I              DNAYNA                          WSAYNA
     I              DNA0NA                          WSA0NA
     I              DNAXDT                          WSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Broker Code
     I                                        1   6 P1HHAA
     IP2PARM      DS
      * I :  Country Code
     I                                        1   6 P2KXCD
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P3AJCD
      * N : MAP Company Number
     I                                    P   4   50P3AIC3
      * N : MAP Application Code
     I                                        6  11 P3DNCD
      * N : MAP System Date Format
     I                                       12  14 P3B8NA
      * N : MAP User Profile Name
     I                                       15  24 P3AJVN
      * N : MAP Allow Multi-Company
     I                                       25  25 P3I6ST
      * N : MAP Default Printer
     I                                       26  35 P3MPNA
     IP4PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P4G3TX
      * N : MAP PRT Printer Device
     I                                       26  35 P4WRST
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P4WSST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P4WTST
      * N : MAP PRT Number of Copies
     I                                       44  450P4DYNB
      * N : MAP PRT Night Queue Run Sts
     I                                       46  46 P4WUST
      * N : MAP PRT Night Queue
     I                                       47  56 P4BVVN
      * N : MAP Company Number Pass   USR
     I                                    P  57  645P4AJAA
      * N : MAP From Date Pass        USR
     I                                    P  65  725P4AJAD
      * N : MAP Thru Date Pass        USR
     I                                    P  73  805P4AJAG
      * N : MAP System Value Numeric
     I                                    P  81  885P4M8NB
      * N :  Trans Type 1 PASS     USR
     I                                       89  90 P4ZSST
      * N :  Trans Type 2 PASS     USR
     I                                       91  92 P4ZTST
      * N :  Status - Y or N
     I                                       93  93 P4B8ST
      * N : MAP Order Company Pass Usr
     I                                    P  94 1015P4YONX
      * N :  Change Flag USR
     I                                      102 102 P4HWSX
     IP5PARM      DS
      * FLD: Company Name and Address
      * N : MAP Name
     I                                        1  30 P5ADTX
     IP6PARM      DS
      * N :  Day of Week
     I                                        1   1 P6A9ST
     IP7PARM      DS
      * N :  Plant Company Sts
     I                                        1   1 P7YISX
     IP8PARM      DS
      * FLD: *Arrays
      * N :  Country Code 1 usr
     I                                        1   6 P8KIAA
      * N :  Country Code 2 usr
     I                                        7  12 P8KJAA
      * N :  Country Code 3 usr
     I                                       13  18 P8KKAA
      * N :  Country Code 4 usr
     I                                       19  24 P8KLAA
      * N :  Country Code 5 usr
     I                                       25  30 P8KMAA
      * N :  Country Code 6 usr
     I                                       31  36 P8KNAA
      * N :  Country Code 7 usr
     I                                       37  42 P8NHAA
      * N :  Country Code 8 usr
     I                                       43  48 P8NIAA
      * N :  Country Code 9 usr
     I                                       49  54 P8NJAA
      * N :  Country Code 10 usr
     I                                       55  60 P8NKAA
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Company must be a Plant'
      * @Numeric 3,0
     I                                    P   1   20ZA0001
      * Message data for 'From date exceeds to date'
      * Message data for 'Load Id is not found'
      * Load ID
     I                                    P   1   40ZA0002
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0003
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0004
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0005
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0006
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0007
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0008
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0009
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0010
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0011
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0012
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0013
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0014
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0015
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0016
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0017
      * Message data for 'Customer not found'
      * Message data for 'Broker                 NF'
      * Broker Code
     I                                        1   6 ZA0018
      * Message data for 'Customer not fnd for brok'
      * Ship to Customer      USR
     I                                        1   7 ZA0019
      * Message data for 'Booking Number not found'
      * OHE Booking Number
     I                                        1  15 ZA0020
      * Message data for 'Type Code Not Found'
      * Type Code
     I                                        1   2 ZA0021
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0022
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0023
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0024
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0025
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0026
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0027
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0028
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0029
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0030
      * Message data for 'Country                NF'
      * Country Code
     I                                        1   6 ZA0031
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0032
      * Warehouse Type
     I                                        4   5 ZA0033
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0034
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0035
      * Warehouse Type
     I                                        4   5 ZA0036
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0037
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0038
      * Warehouse Type
     I                                        4   5 ZA0039
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0040
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0041
      * Warehouse Type
     I                                        4   5 ZA0042
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0043
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0044
      * Warehouse Type
     I                                        4   5 ZA0045
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0046
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0047
      * Warehouse Type
     I                                        4   5 ZA0048
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0049
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0050
      * Warehouse Type
     I                                        4   5 ZA0051
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0052
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0053
      * Warehouse Type
     I                                        4   5 ZA0054
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0055
      * Message data for 'Whse for Type not found'
      * Warehouse Code
     I                                        1   3 ZA0056
      * Warehouse Type
     I                                        4   5 ZA0057
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0058
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0059
      * Message data for 'Email Addr is blanks'
      * Email Address
     I                                        1  50 ZA0060
      * Message data for 'Email Addr is blanks'
      * Email Address
     I                                        1  50 ZA0061
      * Message data for 'Opt must be Spreadsheet'
      * Email Format
     I                                        1   5 ZA0062
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0063
      * Message data for 'Email Fmt must be 'S''
      * Email Format
     I                                        1   5 ZA0064
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0065
      * Application Code
     I                                       11  16 ZA0066
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0067
      * Application Code
     I                                       11  16 ZA0068
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HHAA    PARM           WP0001  6        Broker Code
     C           P2KXCD    PARM           WP0002  6        Country Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
      * Submit job for Print
     C                     MOVELP3MPNA    P4WRST           PRT Printer Dev
     C                     MOVEL'N'       P4WUST           PRT Night Queue
     C                     MOVEL*BLANK    P4BVVN           PRT Night Queue
     C                     MOVEL*BLANK    P4WTST           PRT Save Output
     C                     MOVEL'*NO'     P4WTST           PRT Save Output
     C                     MOVEL*BLANK    P4WSST           PRT Hold Output
     C                     MOVEL'*NO'     P4WSST           PRT Hold Output
      * ** Hold print file if emailing the report
      * CASE: DTL.Email Address is Entered
     C           #DUGTX    IFNE *BLANK                     *IF
      * ** Default printer to QPRINT2 if email, fax, or download
     C                     MOVEL*BLANK    P4WRST           PRT Printer Dev
     C                     MOVEL'QPRINT2' P4WRST           PRT Printer Dev
     C                     MOVEL'*YES'    P4WSST           PRT Hold Output
     C                     END                             *FI
      * ** description
      * CASE: DTL.Select Option is Export Load Report
     C           #DOPTI    IFEQ 'E'                        *IF
     C                     MOVEL@CN,001   YL0001           PRT Description
     C                     ELSE
      * CASE: DTL.Select Option is Export Load Rpt w/Weights
     C           #DOPTI    IFEQ 'W'                        *IF
     C                     MOVEL@CN,002   YL0001           PRT Description
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt for Exports
     C           #DOPTI    IFEQ 'B'                        *IF
     C                     MOVEL@CN,003   YL0001           PRT Description
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt 4/Export-Less
     C           #DOPTI    IFEQ 'L'                        *IF
     C                     MOVEL@CN,004   YL0001           PRT Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * move Load Start Company & dates to 15.5
     C                     Z-ADD#DATNB    P4AJAA           Company Number
      * PAR.From Date Pass        USR = DTL.USR From Date
     C                     Z-ADD#DBDDT    P4AJAD           From Date Pass
      * PAR.Thru Date Pass        USR = DTL.USR To Date
     C                     Z-ADD#DFDDT    P4AJAG           Thru Date Pass
      * ** break email address into 2-25 char fields  rc-2/11
     C                     MOVEL#DUGTX    YL0002           Email addr 1
      * *Move-Right - /UT User Source  * 
     C                     MOVE #DUGTX    YL0003
      * ** Add: Warehouse Type and Type of Customer           E002587
      * 07/17/19 DN R15161-Replaced Enterprise Code 2 parm w/ OHE Booking
      * 01/17/20 DN S16050-Passed in 9th Warehouse Code.
      * Prt Export Load Pass   UP - /UT User Programs  * 
     C                     CALL 'PPICUPC'              90  Prt Export Load
     C           WUH3TX    PARM *BLANK    WQ0001  7        Return Code Usr
     C                     PARM 'TRF'     WQ0002  6        Application Cod
     C                     PARM #DJ1T1    WQ0003 15        OHE Booking Num
     C                     PARM YL0001    WQ0004 25        PRT Description
     C           P4WRST    PARM P4WRST    WQ0005 10        PRT Printer Dev
     C           P4WSST    PARM P4WSST    WQ0006  4        PRT Hold Output
     C           P4WTST    PARM P4WTST    WQ0007  4        PRT Save Output
     C           P4WUST    PARM P4WUST    WQ0008  1        PRT Night Queue
     C           P4BVVN    PARM P4BVVN    WQ0009 10        PRT Night Queue
     C                     PARM P4AJAA    WQ0010 155       Company Number
     C                     PARM P4AJAD    WQ0011 155       From Date Pass
     C                     PARM P4AJAG    WQ0012 155       Thru Date Pass
     C                     PARM #DNNNB    WQ0013 155       Order Number 1
     C           P4M8NB    PARM P4M8NB    WQ0014 155       System Value Nu
     C                     PARM #DBOCD    WQ0015  2        Trans Type 1 PA
     C                     PARM #DWPST    WQ0016  2        Trans Type 2 PA
     C                     PARM #DB4TX    WQ0017  3        Reason Code 1 P
     C                     PARM #DSQSX    WQ0018  1        USR Include all
     C                     PARM #DAJNB    WQ0019 155       Ship to Custome
     C                     PARM #DB8ST    WQ0020  1        Status - Y or N
     C                     PARM #DOPTI    WQ0021  1        Change Flag USR
     C                     PARM #DU1AM    WQ0022  1        USR Confirm Sta
     C                     PARM #DNLAA    WQ0023  3        Carrier Code Us
     C                     PARM #DNMAA    WQ0024  3        Carrier Code Us
     C                     PARM #DNNAA    WQ0025  3        Carrier Code Us
     C                     PARM #DNOAA    WQ0026  3        Carrier Code Us
     C                     PARM #DNPAA    WQ0027  3        Carrier Code Us
     C                     PARM #DNQAA    WQ0028  3        Carrier Code Us
     C                     PARM #DNRAA    WQ0029  3        Carrier Code Us
     C                     PARM #DNSAA    WQ0030  3        Carrier Code Us
     C                     PARM #DNTAA    WQ0031  3        Carrier Code Us
     C                     PARM #DNUAA    WQ0032  3        Carrier Code Us
     C                     PARM #DN0AA    WQ0033  3        Carrier Code Us
     C                     PARM #DNWAA    WQ0034  3        Carrier Code Us
     C                     PARM #DNXAA    WQ0035  3        Carrier Code Us
     C                     PARM #DNYAA    WQ0036  3        Carrier Code Us
     C                     PARM #DNZAA    WQ0037  3        Carrier Code Us
     C                     PARM #DKIAA    WQ0038  6        Country Code 1
     C                     PARM #DKJAA    WQ0039  6        Country Code 2
     C                     PARM #DKKAA    WQ0040  6        Country Code 3
     C                     PARM #DKLAA    WQ0041  6        Country Code 4
     C                     PARM #DKMAA    WQ0042  6        Country Code 5
     C                     PARM #DKNAA    WQ0043  6        Country Code 6
     C                     PARM #DNHAA    WQ0044  6        Country Code 7
     C                     PARM #DNIAA    WQ0045  6        Country Code 8
     C                     PARM #DNJAA    WQ0046  6        Country Code 9
     C                     PARM #DNKAA    WQ0047  6        Country Code 10
     C                     PARM #DAJCD    WQ0048  3        USR Warehouse C
     C                     PARM #DZUCD    WQ0049  3        USR CDE Parm 1
     C                     PARM #DZVCD    WQ0050  3        USR CDE Parm 2
     C                     PARM #DZWCD    WQ0051  3        USR CDE Parm 3
     C                     PARM #DZXCD    WQ0052  3        USR CDE Parm 4
     C                     PARM #DZYCD    WQ0053  3        USR CDE Parm 5
     C                     PARM #DZZCD    WQ0054  3        USR CDE Parm 6
     C                     PARM #DZ0CD    WQ0055  3        USR CDE Parm 7
     C                     PARM #DZ1CD    WQ0056  3        USR CDE Parm 8
     C                     PARM #DHHAA    WQ0057  6        Broker Code
     C                     PARM #DVQSX    WQ0058  1        Email Selection
     C                     PARM YL0002    WQ0059 25        Email addr 1
     C                     PARM YL0003    WQ0060 25        Email Addr 2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPICUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     996835*
     C                     SETON                     673736*
     C                     SETON                     555466*
     C                     SETON                     333839*
     C                     SETON                     404142*
     C                     END
      * report has been submitted message
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Report has been submitted'
     C                     MOVEL'USR2720' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate USR From Date
      * External date
     C                     Z-ADDVDBDDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #DBDDT
      * Validate USR To Date
      * External date
     C                     Z-ADDVDFDDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #DFDDT
      * Validate Select Option
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DOPTI'  IFEQ YPMTFD
      * Select Option
     C                     MOVEL#DOPTI    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHOPTI
     C                     SELEC
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD1         ZHOPTI
     C           W0INVL    WHEQ 'W'                        W
     C                     Z-ADD2         ZHOPTI
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD3         ZHOPTI
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD4         ZHOPTI
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD5         ZHOPTI
     C                     ENDSL
     C                     EXFMTZGOPTI
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHOPTI    WHEQ 1
     C                     MOVEL'E'       W0INVL           E
     C           ZHOPTI    WHEQ 2
     C                     MOVEL'W'       W0INVL           W
     C           ZHOPTI    WHEQ 3
     C                     MOVEL'B'       W0INVL           B
     C           ZHOPTI    WHEQ 4
     C                     MOVEL'C'       W0INVL           C
     C           ZHOPTI    WHEQ 5
     C                     MOVEL'L'       W0INVL           L
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DOPTI
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate OHE Load Haul Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DB4TX'  IFEQ YPMTFD
      * OHE Load Haul Type
     C                     MOVEL#DB4TX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHB4TX
     C                     SELEC
     C           W0INVL    WHEQ 'STK'                      STK
     C                     Z-ADD1         ZHB4TX
     C           W0INVL    WHEQ 'FZG'                      FZG
     C                     Z-ADD2         ZHB4TX
     C           W0INVL    WHEQ 'FZT'                      FZT
     C                     Z-ADD3         ZHB4TX
     C           W0INVL    WHEQ 'IMD'                      IMD
     C                     Z-ADD4         ZHB4TX
     C           W0INVL    WHEQ 'GUY'                      GUY
     C                     Z-ADD5         ZHB4TX
     C           W0INVL    WHEQ 'TRF'                      TRF
     C                     Z-ADD6         ZHB4TX
     C           W0INVL    WHEQ 'RR'                       RR
     C                     Z-ADD7         ZHB4TX
     C           W0INVL    WHEQ 'STJ'                      STJ
     C                     Z-ADD8         ZHB4TX
     C                     ENDSL
     C                     EXFMTZGB4TX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHB4TX    WHEQ 1
     C                     MOVEL'STK'     W0INVL           STK
     C           ZHB4TX    WHEQ 2
     C                     MOVEL'FZG'     W0INVL           FZG
     C           ZHB4TX    WHEQ 3
     C                     MOVEL'FZT'     W0INVL           FZT
     C           ZHB4TX    WHEQ 4
     C                     MOVEL'IMD'     W0INVL           IMD
     C           ZHB4TX    WHEQ 5
     C                     MOVEL'GUY'     W0INVL           GUY
     C           ZHB4TX    WHEQ 6
     C                     MOVEL'TRF'     W0INVL           TRF
     C           ZHB4TX    WHEQ 7
     C                     MOVEL'RR'      W0INVL           RR
     C           ZHB4TX    WHEQ 8
     C                     MOVEL'STJ'     W0INVL           STJ
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DB4TX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Warehouse Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DWPST'  IFEQ YPMTFD
      * Warehouse Type
     C                     MOVEL#DWPST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHWPST
     C                     SELEC
     C           W0INVL    WHEQ 'FR'                       FR
     C                     Z-ADD1         ZHWPST
     C           W0INVL    WHEQ 'FZ'                       FZ
     C                     Z-ADD2         ZHWPST
     C                     ENDSL
     C                     EXFMTZGWPST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHWPST    WHEQ 1
     C                     MOVEL'FR'      W0INVL           FR
     C           ZHWPST    WHEQ 2
     C                     MOVEL'FZ'      W0INVL           FZ
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DWPST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Select Report Options USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DU1AM'  IFEQ YPMTFD
      * Select Report Options USR
     C                     MOVEL#DU1AM    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHU1AM
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZHU1AM
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD2         ZHU1AM
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHU1AM
     C                     ENDSL
     C                     EXFMTZGU1AM
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHU1AM    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZHU1AM    WHEQ 2
     C                     MOVEL'E'       W0INVL           E
     C           ZHU1AM    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DU1AM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Type of Customer USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSQSX'  IFEQ YPMTFD
      * Type of Customer USR
     C                     MOVEL#DSQSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSQSX
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZHSQSX
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHSQSX
     C                     ENDSL
     C                     EXFMTZGSQSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSQSX    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZHSQSX    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSQSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Status - Y or N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DB8ST'  IFEQ YPMTFD
      * Status - Y or N
     C                     MOVEL#DB8ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHB8ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHB8ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHB8ST
     C                     ENDSL
     C                     EXFMTZGB8ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHB8ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHB8ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DB8ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Email Selection usr
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DVQSX'  IFEQ YPMTFD
      * Email Selection usr
     C                     MOVEL#DVQSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVQSX
     C                     SELEC
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD1         ZHVQSX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD2         ZHVQSX
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZHVQSX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD4         ZHVQSX
     C                     ENDSL
     C                     EXFMTZGVQSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVQSX    WHEQ 1
     C                     MOVEL'E'       W0INVL           E
     C           ZHVQSX    WHEQ 2
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHVQSX    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZHVQSX    WHEQ 4
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DVQSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Process F4 on Company and on Broker
     C                     EXSR UASUBR                     Process F4 on C
      * Process F4 on Load Number
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.CD7 Int Numeric Key
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNNNB'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#DNNNB    WUBIC7           Load ID Alpha
      * SEL Export Loads       SR - Load Header  * 
     C                     CALL 'PDULSRR'              90  SEL Export Load
     C                     PARM *BLANK    W0RTN   7
     C           WUBIC7    PARM WUBIC7    WQ0063  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDULSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUBIC7    #DNNNB           CD7 Int Numeric
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Customer - base return on Type of Customer  E002587
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Customer Number       NBR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DAJNB'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Type of Customer USR is Bill To
     C           #DSQSX    IFEQ 'B'                        *IF
      * ** Select Customer for Broker if Broker is passed in  E001704
      * CASE: PAR.Broker Code is Entered
     C           P1HHAA    IFNE *BLANK                     *IF
      * SEL Cust Accr by Brokr SR - Customer Accrual  * 
     C                     CALL 'PBBESRR'              90  SEL Cust Accr b
     C                     PARM *BLANK    W0RTN   7
     C           YL0004    PARM YL0004    WQ0064  70       Ship To Custome
     C                     PARM P1HHAA    WQ0065  6        Broker Code
     C           #DAJNB    PARM *ZERO     WQ0066  70       A/R Customer Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBBESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9954  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Bill To for ContrctSR - Customer  * 
     C                     CALL 'PBJASRR'              90  SEL Bill To for
     C                     PARM *BLANK    W0RTN   7
     C           #DBKC7    PARM #DBKC7    WQ0067  70       Ship To Custome
     C           #DAJNB    PARM #DAJNB    WQ0068  70       A/R Customer Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBJASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9954  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Type of Customer USR is ShipTo
     C           #DSQSX    IFEQ 'S'                        *IF
      * ** Select Customer for Broker if Broker is passed in  E001704
      * CASE: PAR.Broker Code is Entered
     C           P1HHAA    IFNE *BLANK                     *IF
      * SEL Cust Accr by Brokr SR - Customer Accrual  * 
     C                     CALL 'PBBESRR'              90  SEL Cust Accr b
     C                     PARM *BLANK    W0RTN   7
     C           #DBKC7    PARM #DBKC7    WQ0069  70       Ship To Custome
     C                     PARM P1HHAA    WQ0070  6        Broker Code
     C                     PARM *ZERO     WQ0071  70       A/R Customer Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBBESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * 4/2/04 slm add select on shipped to customer with customer name s
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #DBKC7    PARM #DBKC7    WQ0072  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process F4 on Country Codes (10 total)      P000737
     C                     EXSR UBSUBR                     Process F4 on C
      * Process F4 on Carrier Codes                 P000737
     C                     EXSR UCSUBR                     Process F4 on C
      * Process F4 on Shipping Lines                P000737
     C                     EXSR UDSUBR                     Process F4 on S
      * 07/17/19 DN R15161-Replaced Booking Number with OHE Booking Numbe
      * Process F4 on Booking Number                  07/17/19 DN R15161
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.OHE Booking Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DJ1T1'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Booking Number     SR - Order Header Extension  * 
     C                     CALL 'PBA9SRR'              90  SEL Booking Num
     C                     PARM *BLANK    W0RTN   7
     C           #DJ1T1    PARM #DJ1T1    WQ0098 15        OHE Booking Num
     C           YL0005    PARM *BLANK    WQ0099  1        Record Selected
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBA9SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9968  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Select Email Format, display correct description  E
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Select Option
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DOPTI'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** display selection option description
      * CASE: DTL.Select Option is Export Load Report
     C           #DOPTI    IFEQ 'E'                        *IF
     C                     MOVEL@CN,001   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Export Load Rpt w/Weights
     C           #DOPTI    IFEQ 'W'                        *IF
     C                     MOVEL@CN,005   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt for Exports
     C           #DOPTI    IFEQ 'B'                        *IF
     C                     MOVEL@CN,003   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking for Exp Coord
     C           #DOPTI    IFEQ 'C'                        *IF
     C                     MOVEL@CN,006   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt 4/Export-Less
     C           #DOPTI    IFEQ 'L'                        *IF
     C                     MOVEL@CN,004   #DHLTX           Condition Desc.
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Customer Type Code            E002395
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Type Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DBOCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Type Codes         SR - Type Codes  * 
     C                     CALL 'CABVSRR'              90  SEL Type Codes
     C                     PARM *BLANK    W0RTN   7
     C           #DBOCD    PARM #DBOCD    WQ0100  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9967  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on each of 9 Warehouses          E004105
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse Code
     C           W0CFL     IFEQ '#DAJCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DAJCD    PARM #DAJCD    WQ0101  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9957  *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 1 USR
     C           W0CFL     IFEQ '#DZUCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZUCD    PARM #DZUCD    WQ0102  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9958  *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 2 USR
     C           W0CFL     IFEQ '#DZVCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZVCD    PARM #DZVCD    WQ0103  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9959  *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 3 USR
     C           W0CFL     IFEQ '#DZWCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZWCD    PARM #DZWCD    WQ0104  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9960  *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 4 USR
     C           W0CFL     IFEQ '#DZXCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZXCD    PARM #DZXCD    WQ0105  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9961  *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 5 USR
     C           W0CFL     IFEQ '#DZYCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZYCD    PARM #DZYCD    WQ0106  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9962  *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 6 USR
     C           W0CFL     IFEQ '#DZZCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZZCD    PARM #DZZCD    WQ0107  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9963  *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 7 USR
     C           W0CFL     IFEQ '#DZ0CD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZ0CD    PARM #DZ0CD    WQ0108  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9964  *
     C                     END
     C                     END                             *FI
      * 01/17/20 DN S16050-Added 9th Warehouse.
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse 8 USR
     C           W0CFL     IFEQ '#DZ1CD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DZ1CD    PARM #DZ1CD    WQ0109  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9965  *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Country
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
      * ** Get Ship-to customer name
      * ** Get Warehouse Type name (Fresh or Frozen)  E002587
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBKC7    WL0005           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DAYTX    P      Customer Name
      * DTL.Condition Desc. 10 USR = Condition name of DTL.Email Selectio
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1731444   Y2LSNO  70       List number
     C                     PARM #DVQSX    W0INVL 25        Email Selection
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHUTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Whse Type Description = Condition name of DTL.Warehouse Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1275008   Y2LSNO  70       List number
     C                     PARM #DWPST    W0INVL 25        Warehouse Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DU1AL    PARM           W0CNNM 25        Whse Type Descr
      *
      * DTL.Description 21a 1 Usr = Condition name of DTL.Select Report O
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2078426   Y2LSNO  70       List number
     C                     PARM #DU1AM    W0INVL 25        Select Report O
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DGZT1    PARM           W0CNNM 25        Description 21a
      *
      * * Default whse type descr to *all if whse type = blanks   E002587
      * CASE: DTL.Warehouse Type is Equal blank
     C           #DWPST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #DU1AL           Whse Type Descr
     C                     MOVEL'*ALL'    #DU1AL           Whse Type Descr
     C                     END                             *FI
     C                     MOVELYL0006    #DI6TX           Description 14A
      * ** display selection option description
      * CASE: DTL.Select Option is Export Load Report
     C           #DOPTI    IFEQ 'E'                        *IF
     C                     MOVEL@CN,001   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Export Load Rpt w/Weights
     C           #DOPTI    IFEQ 'W'                        *IF
     C                     MOVEL@CN,005   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt for Exports
     C           #DOPTI    IFEQ 'B'                        *IF
     C                     MOVEL@CN,003   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking for Exp Coord
     C           #DOPTI    IFEQ 'C'                        *IF
     C                     MOVEL@CN,006   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt 4/Export-Less
     C           #DOPTI    IFEQ 'L'                        *IF
     C                     MOVEL@CN,004   #DHLTX           Condition Desc.
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #DDET1           Broker Name DRV
      * Broker Name DRV
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) #DHHAA' defaulted for 'Broker Code'.
      * Rtv Broker Info       RT - Broker  * 
     C                     EXSR SDRVGN
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
     C                     MOVEL*BLANK    #DEUT1           Order Company N
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL*BLANK    #1ADTX           Name
      * Validate load company if entered
      * CASE: DTL.Company Number CDE is not equal to zero
     C           #DATNB    IFNE *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0003           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DAPTX    P      Name
      * CASE: PGM.*Return code is Company not found
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     Z-ADD#DATNB    #1AIC3           Company Number
      * Send message 'Company Number not found'
     C                     MOVEL'USR0163' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * 02/13/07 PKD Removed hardcoding of company number
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0007    P      Plant Company S
      * CASE: LCL.Plant Company Sts is Plant Company
     C           YL0007    IFEQ 'P'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DATNB    #1AIC3           Company Number
      * Send message 'Company Number not found'
     C                     MOVEL'USR0163' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Dates
      * CASE: DTL.USR From Date GT DTL.USR To Date
     C           #DBDDT    IFGT #DFDDT                     *IF
      * Setup message data for message
      * Send message 'From date exceeds to date'
     C                     MOVEL'USR0319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Validate Load Id
      * CASE: DTL.CD7 Int Numeric Key is not equal zero
     C           #DNNNB    IFNE *ZERO                      *IF
      * RTV Load Status        RT - OM Load Header  * 
     C                     EXSR SERVGN
      * Load not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
     C                     Z-ADD#DNNNB    WUBIC7           Load ID Alpha
      * Setup message data for message
     C                     Z-ADD#DNNNB    ZA0002           CD7 Int Numeric
      * Send message 'Load Id is not found'
     C                     MOVEL'USR2783' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Codes              P000737
     C                     EXSR UESUBR                     Validate Carrie
      * Validate Shipping Lines             P000737
     C                     EXSR UFSUBR                     Validate Shippi
      * Validate Customer                                     E002587
      * CASE: DTL.Customer Number       NBR is not equal 0
     C           #DAJNB    IFNE *ZERO                      *IF
      * CASE: DTL.Type of Customer USR is Bill To
     C           #DSQSX    IFEQ 'B'                        *IF
      * RTV Bill To Cust Name  RT - Customer  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: DTL.Type of Customer USR is ShipTo
     C           #DSQSX    IFEQ 'S'                        *IF
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DAJNB    WL0005           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DAYTX    P      Customer Name
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
      * Send message 'Customer not found'
     C                     MOVEL'USR0525' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate customer if broker code is entered           E001704
      * CASE: DTL.Broker Code is Entered
     C           #DHHAA    IFNE *BLANK                     *IF
      * VAL Broker Exists     RT - Broker  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DHHAA    ZA0018           Broker Code
      * Send message 'Broker                 NF'
     C                     MOVEL'USR3288' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If ship to cust is entered, it must belong to the broker
      * CASE: DTL.Customer Number       NBR is not equal 0
     C           #DAJNB    IFNE *ZERO                      *IF
      * CASE: DTL.Type of Customer USR is ShipTo
     C           #DSQSX    IFEQ 'S'                        *IF
      * VAL Broker for ShipTo  RT - Customer Accrual  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
     C                     Z-ADD#DAJNB    WUD0C7           Ship to Custome
      * Setup message data for message
      * Convert Ship to Customer      USR to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WUD0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWUD0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0019           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0019           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Customer not fnd for brok'
     C                     MOVEL'USR4469' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 07/17/19 DN R15161-Replaced Booking Number with OHE Booking Numbe
      * Validate Booking Number                       07/17/19 DN R15161
      * CASE: DTL.OHE Booking Number is Entered
     C           #DJ1T1    IFNE *BLANK                     *IF
      * RTV Booking Number     RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DJ1T1    WL0010    P      OHE Booking Num
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    YL0008    P      Record Found US
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DJ1T1    ZA0020           OHE Booking Num
      * Send message 'Booking Number not found'
     C                     MOVEL'USR4471' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9968  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Type Code                  E002395
      * CASE: DTL.Type Code is Entered
     C           #DBOCD    IFNE *BLANK                     *IF
      * Val Type Codes         XF - Type Codes  * 
     C                     CALL 'PBAKXFR'              90  Val Type Codes
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DBOCD    WQ0112  2        Type Code
     C           YL0009    PARM YL0009    WQ0113  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9967  *
     C                     END
      * CASE: LCL.Return Code Usr is *Blank
     C           YL0009    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DBOCD    ZA0021           Type Code
      * Send message 'Type Code Not Found'
     C                     MOVEL'USR3388' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9967  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Country Codes (10 total)   P000737
     C                     EXSR UGSUBR                     Validate Countr
      * VAL: Warehouse or Warehouse and Warehouse Type        E002587
      * CASE: DTL.Warehouse Code is Warehouse Code not Blank
     C           #DAJCD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DAJCD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0032           Warehouse Code
     C                     MOVEL#DWPST    ZA0033           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     995737*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0034           Warehouse Code
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 1                   E004105
      * CASE: DTL.Warehouse 1 USR is Entered
     C           #DZUCD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZUCD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZUCD    ZA0035           Warehouse 1 USR
     C                     MOVEL#DWPST    ZA0036           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     995837*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZUCD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZUCD    ZA0037           Warehouse 1 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9958  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 2                   E004105
      * CASE: DTL.Warehouse 2 USR is Entered
     C           #DZVCD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZVCD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZVCD    ZA0038           Warehouse 2 USR
     C                     MOVEL#DWPST    ZA0039           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     995937*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZVCD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZVCD    ZA0040           Warehouse 2 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9959  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 3                   E004105
      * CASE: DTL.Warehouse 3 USR is Entered
     C           #DZWCD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZWCD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZWCD    ZA0041           Warehouse 3 USR
     C                     MOVEL#DWPST    ZA0042           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     996037*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZWCD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZWCD    ZA0043           Warehouse 3 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9960  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 4                   E004105
      * CASE: DTL.Warehouse 4 USR is Entered
     C           #DZXCD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZXCD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZXCD    ZA0044           Warehouse 4 USR
     C                     MOVEL#DWPST    ZA0045           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     996137*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZXCD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZXCD    ZA0046           Warehouse 4 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9961  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 5                   E004105
      * CASE: DTL.Warehouse 5 USR is Entered
     C           #DZYCD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZYCD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZYCD    ZA0047           Warehouse 5 USR
     C                     MOVEL#DWPST    ZA0048           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     996237*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZYCD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZYCD    ZA0049           Warehouse 5 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9962  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 6                   E004105
      * CASE: DTL.Warehouse 6 USR is Entered
     C           #DZZCD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZZCD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZZCD    ZA0050           Warehouse 6 USR
     C                     MOVEL#DWPST    ZA0051           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     996337*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZZCD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZZCD    ZA0052           Warehouse 6 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9963  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 7                   E004105
      * CASE: DTL.Warehouse 7 USR is Entered
     C           #DZ0CD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZ0CD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZ0CD    ZA0053           Warehouse 7 USR
     C                     MOVEL#DWPST    ZA0054           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     996437*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZ0CD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZ0CD    ZA0055           Warehouse 7 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9964  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse and Warehouse Type 8                   S16050
      * CASE: DTL.Warehouse 8 USR is Entered
     C           #DZ1CD    IFNE *BLANK                     *IF
      * CASE: DTL.Warehouse Type NE WRK.Blank for 3          USR
     C           #DWPST    IFNE WUUAT1                     *IF
      * Val Whse for Type      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DWPST    WL0013    P      Warehouse Type
     C                     MOVEL#DZ1CD    WL0014    P      Warehouse Code
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZ1CD    ZA0056           Warehouse 8 USR
     C                     MOVEL#DWPST    ZA0057           Warehouse Type
      * Send message 'Whse for Type not found'
     C                     MOVEL'USR4626' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     996537*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DZ1CD    WL0015    P      Warehouse Code
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DZ1CD    ZA0058           Warehouse 8 USR
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9965  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val: Email selector is entered if email address is entered
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Email Address is Entered
      *   |- c2    : DTL.Email Selection usr is Not Selected
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DUGTX    IFNE *BLANK                     *IF
     C           #DVQSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DVQSX    ZA0059           Email Selection
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Val: Email address entered if email format is selected
      * CASE: DTL.Email Selection usr is E,Y,S only
     C           #DVQSX    IFEQ 'E'                        *IF
     C           #DVQSX    OREQ 'S'
     C           #DVQSX    OREQ 'Y'
      * email address cannot be blanks
      * CASE: DTL.Email Address is Blank
     C           #DUGTX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DUGTX    ZA0060           Email Address
      * Send message 'Email Addr is blanks'
     C                     MOVEL'USR3670' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * * Don't test first time around     E001788
      * CASE: LCL.First Time Flag is NO
     C           YL0010    IFEQ 'N'                        *IF
      * email address cannot be blanks
      * CASE: DTL.Email Address is Blank
     C           #DUGTX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DUGTX    ZA0061           Email Address
      * Send message 'Email Addr is blanks'
     C                     MOVEL'USR3670' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val: If Booking download selected then format must be Spreadsheet
      * CASE: DTL.Select Option is Booking Rpt for Exports
     C           #DOPTI    IFEQ 'B'                        *IF
      * E, Y, or blanks invalid. S only allowed for Booking Download.
      * CASE: DTL.Email Selection usr is Spreadsheet Format
     C           #DVQSX    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DVQSX    ZA0062           Email Selection
      * Send message 'Opt must be Spreadsheet'
     C                     MOVEL'USR4502' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val: If Exp Coord booking download then check Type/email format E
      * CASE: DTL.Select Option is Booking for Exp Coord
     C           #DOPTI    IFEQ 'C'                        *IF
      * Type Code is required for Export Coordinator Booking Download
      * CASE: DTL.Type Code is EQ Blank
     C           #DBOCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DBOCD    ZA0063           Type Code
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9967  *
      *
     C                     END                             *FI
      * Email Format must be 'S' for Export Coordinator Booking Download
      * CASE: DTL.Email Selection usr is Spreadsheet Format
     C           #DVQSX    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DVQSX    ZA0064           Email Selection
      * Send message 'Email Fmt must be 'S''
     C                     MOVEL'USR4685' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       YL0010           First Time Flag
     C                     END
      * USR From Date required
     C           #DBDDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * USR To Date required
     C           #DFDDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Select Option required
     C           #DOPTI    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Status - Y or N required
     C           #DB8ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9966  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P3I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADDP4YONX    #PYONX           Order Company P
     C                     Z-ADDP4AJAG    #PAJAG           Thru Date Pass
     C                     MOVELP3DNCD    #PDNCD           Application Cod
     C                     MOVELP3B8NA    #PB8NA           System Date For
     C                     MOVELP3AJVN    #PAJVN           User Profile Na
     C                     MOVELP3I6ST    #PI6ST           Allow Multi-Com
     C                     MOVELP3MPNA    #PMPNA           Default Printer
     C                     MOVELP4G3TX    #PG3TX           PRT Description
     C                     MOVELP4WRST    #PWRST           PRT Printer Dev
     C                     MOVELP4WSST    #PWSST           PRT Hold Output
     C                     MOVELP4WTST    #PWTST           PRT Save Output
     C                     Z-ADDP4DYNB    #PDYNB           PRT Number of C
     C                     MOVELP4WUST    #PWUST           PRT Night Queue
     C                     MOVELP4BVVN    #PBVVN           PRT Night Queue
     C                     Z-ADDP4AJAA    #PAJAA           Company Number
     C                     Z-ADDP4AJAD    #PAJAD           From Date Pass
     C                     Z-ADDP4M8NB    #PM8NB           System Value Nu
     C                     Z-ADDP3AIC3    #1AIC3           Company Number
     C                     Z-ADD*ZERO     #DYNNX           Order Company C
     C                     MOVEL*BLANK    #DEUT1           Order Company N
     C                     MOVEL*BLANK    #DBZNA           Carrier Code
     C                     MOVELP5ADTX    #1ADTX           Name
     C                     Z-ADD*ZERO     #DBKC7           Ship To Custome
     C                     Z-ADD*ZERO     #DBEDT           USR Through Dat
     C                     MOVEL*BLANK    #DNBBO           Booking Number
     C                     MOVEL*BLANK    #DDATX           Country Descrip
     C                     MOVEL*BLANK    #1KXCD           Country Code
     C                     MOVEL*BLANK    #DTJT1           Description 2 u
     C                     MOVEL*BLANK    #DTKT1           Description 3 u
     C                     MOVEL*BLANK    #DTLT1           Description 4 u
     C                     MOVEL*BLANK    #DTMT1           Description 5 u
     C                     MOVEL*BLANK    #DIXTX           Condition Name
     C                     Z-ADD*ZERO     #DBDDT           USR From Date
      * Clear external version also
     C                     Z-ADD*ZERO     VDBDDT
     C                     Z-ADD*ZERO     #DFDDT           USR To Date
      * Clear external version also
     C                     Z-ADD*ZERO     VDFDDT
     C                     MOVEL*BLANK    #DOPTI           Select Option
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     Z-ADD*ZERO     #DATNB           Company Number
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     Z-ADD*ZERO     #DNNNB           CD7 Int Numeric
     C                     MOVEL*BLANK    #DB4TX           OHE Load Haul T
     C                     MOVEL*BLANK    #DWPST           Warehouse Type
     C                     MOVEL*BLANK    #DU1AL           Whse Type Descr
     C                     MOVEL*BLANK    #DU1AM           Select Report O
     C                     MOVEL*BLANK    #DGZT1           Description 21a
     C                     MOVEL*BLANK    #DNLAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNMAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNNAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNOAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNPAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNQAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNRAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNSAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNTAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNUAA           Carrier Code Us
     C                     MOVEL*BLANK    #DN0AA           Carrier Code Us
     C                     MOVEL*BLANK    #DNWAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNXAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNYAA           Carrier Code Us
     C                     MOVEL*BLANK    #DNZAA           Carrier Code Us
     C                     Z-ADD*ZERO     #DAJNB           Customer Number
     C                     MOVEL*BLANK    #DAYTX           Customer Name
     C                     MOVEL*BLANK    #DSQSX           Type of Custome
     C                     MOVEL*BLANK    #DHHAA           Broker Code
     C                     MOVEL*BLANK    #DDET1           Broker Name DRV
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     MOVEL*BLANK    #DZUCD           Warehouse 1 USR
     C                     MOVEL*BLANK    #DZVCD           Warehouse 2 USR
     C                     MOVEL*BLANK    #DZWCD           Warehouse 3 USR
     C                     MOVEL*BLANK    #DZXCD           Warehouse 4 USR
     C                     MOVEL*BLANK    #DZYCD           Warehouse 5 USR
     C                     MOVEL*BLANK    #DZZCD           Warehouse 6 USR
     C                     MOVEL*BLANK    #DZ0CD           Warehouse 7 USR
     C                     MOVEL*BLANK    #DZ1CD           Warehouse 8 USR
     C                     MOVEL*BLANK    #DB8ST           Status - Y or N
     C                     MOVEL*BLANK    #DBOCD           Type Code
     C                     MOVEL*BLANK    #DJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    #DKIAA           Country Code 1
     C                     MOVEL*BLANK    #DKJAA           Country Code 2
     C                     MOVEL*BLANK    #DKKAA           Country Code 3
     C                     MOVEL*BLANK    #DKLAA           Country Code 4
     C                     MOVEL*BLANK    #DKMAA           Country Code 5
     C                     MOVEL*BLANK    #DKNAA           Country Code 6
     C                     MOVEL*BLANK    #DNHAA           Country Code 7
     C                     MOVEL*BLANK    #DNIAA           Country Code 8
     C                     MOVEL*BLANK    #DNJAA           Country Code 9
     C                     MOVEL*BLANK    #DNKAA           Country Code 10
     C                     MOVEL*BLANK    #DVQSX           Email Selection
     C                     MOVEL*BLANK    #DHUTX           Condition Desc.
     C                     MOVEL*BLANK    #DI6TX           Description 14A
     C                     MOVEL*BLANK    #DUGTX           Email Address
      * CALC: Screen function fields
      * ** Get Ship-to customer name
      * ** Get Warehouse Type name (Fresh or Frozen)  E002587
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBKC7    WL0005           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DAYTX    P      Customer Name
      * DTL.Condition Desc. 10 USR = Condition name of DTL.Email Selectio
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1731444   Y2LSNO  70       List number
     C                     PARM #DVQSX    W0INVL 25        Email Selection
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHUTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Whse Type Description = Condition name of DTL.Warehouse Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1275008   Y2LSNO  70       List number
     C                     PARM #DWPST    W0INVL 25        Warehouse Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DU1AL    PARM           W0CNNM 25        Whse Type Descr
      *
      * DTL.Description 21a 1 Usr = Condition name of DTL.Select Report O
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2078426   Y2LSNO  70       List number
     C                     PARM #DU1AM    W0INVL 25        Select Report O
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DGZT1    PARM           W0CNNM 25        Description 21a
      *
      * * Default whse type descr to *all if whse type = blanks   E002587
      * CASE: DTL.Warehouse Type is Equal blank
     C           #DWPST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #DU1AL           Whse Type Descr
     C                     MOVEL'*ALL'    #DU1AL           Whse Type Descr
     C                     END                             *FI
     C                     MOVELYL0006    #DI6TX           Description 14A
      * ** display selection option description
      * CASE: DTL.Select Option is Export Load Report
     C           #DOPTI    IFEQ 'E'                        *IF
     C                     MOVEL@CN,001   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Export Load Rpt w/Weights
     C           #DOPTI    IFEQ 'W'                        *IF
     C                     MOVEL@CN,005   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt for Exports
     C           #DOPTI    IFEQ 'B'                        *IF
     C                     MOVEL@CN,003   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking for Exp Coord
     C           #DOPTI    IFEQ 'C'                        *IF
     C                     MOVEL@CN,006   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt 4/Export-Less
     C           #DOPTI    IFEQ 'L'                        *IF
     C                     MOVEL@CN,004   #DHLTX           Condition Desc.
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #DDET1           Broker Name DRV
      * Broker Name DRV
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) #DHHAA' defaulted for 'Broker Code'.
      * Rtv Broker Info       RT - Broker  * 
     C                     EXSR SNRVGN
      * USER: Load screen
      * ** Default Co# & Name only if Allow Multi-Co=NO     03/07/06 LJB
      * CASE: PAR.Allow Multi-Company is no
     C           P3I6ST    IFEQ 'N'                        *IF
     C                     Z-ADDP3AIC3    #DATNB           Company Number
      * CASE: DTL.Company Number CDE is not equal to zero
     C           #DATNB    IFNE *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0003           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DAPTX    P      Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Default "Include Collect Y/N" to Yes           E00210
     C                     MOVEL'Y'       #DB8ST           Status - Y or N
      * ** Default Report Selection to E = Export Load Report  P000737
      * ** If Broker is passed in, get Sumie's email from Company Values
      * ** Add: Customer Type, default to Bill To             E002587
      * ** Add: Warehouse Type, default to Fresh              E002587
      * ** Add: Letter of Credit (L/C) and default to "A" (All) E002768
     C                     MOVEL'E'       #DOPTI           Select Option
     C                     MOVELYL0006    #DI6TX           Description 14A
     C                     MOVEL'FR'      #DWPST           Warehouse Type
      * DTL.Whse Type Description = Condition name of DTL.Warehouse Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1275008   Y2LSNO  70       List number
     C                     PARM #DWPST    W0INVL 25        Warehouse Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DU1AL    PARM           W0CNNM 25        Whse Type Descr
      *
     C                     MOVEL'S'       #DSQSX           Type of Custome
     C                     MOVEL'A'       #DU1AM           Select Report O
      * DTL.Description 21a 1 Usr = Condition name of DTL.Select Report O
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2078426   Y2LSNO  70       List number
     C                     PARM #DU1AM    W0INVL 25        Select Report O
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DGZT1    PARM           W0CNNM 25        Description 21a
      *
      * ** display selection option description
      * CASE: DTL.Select Option is Export Load Report
     C           #DOPTI    IFEQ 'E'                        *IF
     C                     MOVEL@CN,001   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Export Load Rpt w/Weights
     C           #DOPTI    IFEQ 'W'                        *IF
     C                     MOVEL@CN,005   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt for Exports
     C           #DOPTI    IFEQ 'B'                        *IF
     C                     MOVEL@CN,003   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking for Exp Coord
     C           #DOPTI    IFEQ 'C'                        *IF
     C                     MOVEL@CN,006   #DHLTX           Condition Desc.
     C                     ELSE
      * CASE: DTL.Select Option is Booking Rpt 4/Export-Less
     C           #DOPTI    IFEQ 'L'                        *IF
     C                     MOVEL@CN,004   #DHLTX           Condition Desc.
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** If called from Sumi's menu, protect Broker Code   E1704 LJB
      * CASE: PAR.Broker Code is Entered
     C           P1HHAA    IFNE *BLANK                     *IF
     C                     MOVELP1HHAA    #DHHAA           Broker Code
     C                     MOVEL'N'       P4HWSX           Change Flag USR
      * ** If Co# is blanks, default to User Profile Co#   E1788
      * CASE: DTL.Company Number CDE is Equal to zero
     C           #DATNB    IFEQ *ZERO                      *IF
     C                     Z-ADDP3AIC3    #DATNB           Company Number
     C                     END                             *FI
      * ** Default Co# to retrieve email address           E1788
      * CASE: DTL.Company Number CDE is Equal to zero
     C           #DATNB    IFEQ *ZERO                      *IF
     C                     Z-ADDP3AIC3    YL0011           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DATNB    YL0011           Company Number
     C                     END                             *FI
      * ** Default to Email the report to Sumie
     C                     MOVEL'E'       #DVQSX           Email Selection
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SORVGN
     C                     MOVEL*BLANK    #DUGTX           Email Address
     C                     MOVELYL0012    #DUGTX           Email Address
     C                     END                             *FI
      * ** If Country is passed in, protect Country Code    E1704 LJB
      * CASE: PAR.Country Code is Entered
     C           P2KXCD    IFNE *BLANK                     *IF
      * * Put par.country in 1st country code field and protect
     C                     MOVELP2KXCD    #DKIAA           Country Code 1
     C                     MOVEL'N'       P4B8ST           Status - Y or N
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert USR From Date to display format
      * Convert date
     C           1000000   ADD  #DBDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDBDDT
      * Convert USR To Date to display format
      * Convert date
     C           1000000   ADD  #DFDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDFDDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Plant Company S
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAYISX    WL0002           Plant Company S
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0003    ABAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Name
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0004           Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0005    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAYTX    WL0006           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Broker Info       RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHHAA           Broker Code
      * Setup key
     C                     MOVEL#DHHAA    WDHHAA           Broker Code
      * Establish starting position
     C           KRSSD     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDET1           Broker Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDC4T1    #DDET1           Broker Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WERMNB           Load ID
      * Setup key
     C                     Z-ADD#DNNNB    WERMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWEPKST    WUPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0007    WFBZNA           Carrier Code
      * Establish starting position
     C           KRSSF     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Name
     C                     MOVEL*BLANK    WL0009           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFADTX    WL0008           Name
     C                     MOVELWFVSST    WL0009           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Bill To Cust Name  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGANC7    WQSG01           A/R Customer Nu
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           A/R Customer Nu
      * Setup key
     C                     Z-ADD#DAJNB    WQSG01           A/R Customer Nu
      * Establish starting position
     C           KRSSG     SETLL@BBREC1                    *
     C           KRSSG     READE@BBREC1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAYTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.A/R Customer Number EQ DB1.A/R Customer Number
     C           #DAJNB    IFEQ WGANC7                     *IF
      * PAR = DB1 By name
     C                     MOVELWGAYTX    #DAYTX           Customer Name
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@BBREC1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * VAL Broker Exists     RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WDHHAA           Broker Code
      * Setup key
     C                     MOVEL#DHHAA    WDHHAA           Broker Code
      * Establish starting position
     C           KRSSH     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * VAL Broker for ShipTo  RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHOJCD    WQSI02           Accrual Code
     C           *LIKE     DEFN WHBKC7    WQSI03           Ship To Custome
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Accrual Code
     C                     KFLD           WQSI03           Ship To Custome
      * Setup key
     C                     MOVEL#DHHAA    WQSI02           Accrual Code
     C                     Z-ADD#DAJNB    WQSI03           Ship To Custome
      * Establish starting position
     C           KRSSI     SETLL@HORELO                    *
     C           KRSSI     READE@HORELO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSI     READE@HORELO                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Booking Number     RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0011           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIJ1T1    WQSJ01           OHE Booking Num
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           OHE Booking Num
      * Setup key
     C                     MOVELWL0010    WQSJ01           OHE Booking Num
      * Establish starting position
     C           KRSSJ     SETLL@AMREMK                    *
     C           KRSSJ     READE@AMREMK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'Y'       WL0011           Record Found US
     C           KRSSJ     READE@AMREMK                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Chk if valid Cntry RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJKXCD           Country Code
      * Setup key
     C                     MOVELWL0012    WJKXCD           Country Code
      * Establish starting position
     C           KRSSK     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Val Whse for Type      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKWPST           Warehouse Type
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0013    WKWPST           Warehouse Type
     C                     MOVELWL0014    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADREOJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0015    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Broker Info       RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WDHHAA           Broker Code
      * Setup key
     C                     MOVEL#DHHAA    WDHHAA           Broker Code
      * Establish starting position
     C           KRSSN     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDET1           Broker Name
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDC4T1    #DDET1           Broker Name
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMV8CD           Company Value C
      * Setup key
     C                     Z-ADDYL0011    WMAIC3           Company Number
     C                     MOVEL@CN,009   WMV8CD           Company Value C
      * Establish starting position
     C           KRSSO     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBXTX    YL0012           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WOAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WOAJVN           User Profile Na
      * Establish starting position
     C           KRSSP     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOI6ST    P3I6ST           Allow Multi-Com
     C                     MOVELWOMPNA    P3MPNA           Default Printer
     C                     MOVELWOBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDWOAIC3    YL0013           Company Number
     C                     MOVELWOBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WRAJVN           User Profile Na
     C                     KFLD           WRDNCD           Application Cod
      * Setup key
     C                     MOVELWL0016    WRAJVN           User Profile Na
     C                     MOVELWL0017    WRDNCD           Application Cod
      * Establish starting position
     C           KRSSQ     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAIC3    WL0018           Company Number
     C                     MOVELWRAJCD    WL0019           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSDNCD    WQSR01           Application Cod
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSR01           Application Cod
     C                     MOVEL'OMS'     WQSR01           Application Cod
      * Establish starting position
     C           KRSSR     SETLL@DNRESF                    *
     C           KRSSR     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WSRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWSAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C           KRSSR     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSDNCD    WQSS01           Application Cod
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Application Cod
      * Setup key
     C                     MOVELWSRSCD    WQSS01           Application Cod
      * Establish starting position
     C           KRSSS     SETLL@DNRESF                    *
     C           KRSSS     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSAUNA    WUAUNA           Description
     C           KRSSS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Process F4 on Company and on Broker
      *================================================================
      * Load
     C                     MOVEL*BLANK    #DAPTX           Company Name
      * Process F4 on Company Number
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Company Number CDE
     C           W0CFL     IFEQ '#DATNB'                   *IF
      * CASE: PAR.Allow Multi-Company is yes
     C           P3I6ST    IFEQ 'Y'                        *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #DATNB    PARM #DATNB    WQ0061  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prompt Not Allowed'
     C                     MOVEL'USR2410' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Broker Code
     C           W0CFL     IFEQ '#DHHAA'                   *IF
      * Sel Broker            SL - Broker  * E1704
     C                     CALL 'POY6SRR'              90  Sel Broker
     C                     PARM *BLANK    W0RTN   7
     C           #DHHAA    PARM #DHHAA    WQ0062  6        Broker Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9956  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Test for plant co if co# is entered
      * CASE: DTL.Company Number CDE is not equal to zero
     C           #DATNB    IFNE *ZERO                      *IF
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    P7YISX    P      Plant Company S
      * CASE: PAR.Plant Company Sts is Plant Company
     C           P7YISX    IFEQ 'P'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0003           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DAPTX    P      Name
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#DATNB    ZA0001           Company Number
      * Send message 'Company must be a Plant'
     C                     MOVEL'USR3706' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Process F4 on Country Codes (10 total)      P000737
      *================================================================
      * Only allow prompt if Country was not passed in        E001704
      * CASE: PAR.Change Flag USR is *yes/blank
     C           P4HWSX    IFEQ *BLANK                     *IF
     C           P4HWSX    OREQ 'Y'
      * Process F4 on Country 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 1 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DKIAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKIAA    PARM #DKIAA    WQ0073  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9969  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 2 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DKJAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKJAA    PARM #DKJAA    WQ0074  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9970  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 3 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DKKAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKKAA    PARM #DKKAA    WQ0075  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9971  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 4 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DKLAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKLAA    PARM #DKLAA    WQ0076  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9972  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 5 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DKMAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKMAA    PARM #DKMAA    WQ0077  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9973  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 6
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 6 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DKNAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKNAA    PARM #DKNAA    WQ0078  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9974  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 7
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 7 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNHAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DNHAA    PARM #DNHAA    WQ0079  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9975  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 8 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNIAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DNIAA    PARM #DNIAA    WQ0080  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9976  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 9
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 9 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNJAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DNJAA    PARM #DNJAA    WQ0081  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9977  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Country 10
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code 10 usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNKAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DNKAA    PARM #DNKAA    WQ0082  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9978  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Process F4 on Carrier Codes                 P000737
      *================================================================
      * Process F4 on Carrier 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNLAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNLAA    PARM #DNLAA    WQ0083  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNMAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNMAA    PARM #DNMAA    WQ0084  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 3
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNNAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNNAA    PARM #DNNAA    WQ0085  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 4
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNOAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNOAA    PARM #DNOAA    WQ0086  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 5
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNPAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNPAA    PARM #DNPAA    WQ0087  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9943  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 6
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 6
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNQAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNQAA    PARM #DNQAA    WQ0088  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 7
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 7
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNRAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNRAA    PARM #DNRAA    WQ0089  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 8
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNSAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNSAA    PARM #DNSAA    WQ0090  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 9
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 9
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNTAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNTAA    PARM #DNTAA    WQ0091  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9947  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Carrier 10
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 10
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNUAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNUAA    PARM #DNUAA    WQ0092  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Process F4 on Shipping Lines                P000737
      *================================================================
      * Process F4 on Shipper 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 11
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DN0AA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DN0AA    PARM #DN0AA    WQ0093  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9949  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Shipper 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 12
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNWAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNWAA    PARM #DNWAA    WQ0094  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9950  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Shipper 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 13
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNXAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNXAA    PARM #DNXAA    WQ0095  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9951  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Shipper 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 14
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNYAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNYAA    PARM #DNYAA    WQ0096  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9952  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Process F4 on Shipper 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Carrier Code Usr 15
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DNZAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DNZAA    PARM #DNZAA    WQ0097  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9953  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Validate Carrier Codes              P000737
      *================================================================
      * Validate Carrier Code 1
      * CASE: DTL.Carrier Code Usr 1 is Entered
     C           #DNLAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNLAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNLAA    ZA0003           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 2
      * CASE: DTL.Carrier Code Usr 2 is Entered
     C           #DNMAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNMAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNMAA    ZA0004           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 3
      * CASE: DTL.Carrier Code Usr 3 is Entered
     C           #DNNAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNNAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNNAA    ZA0005           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 4
      * CASE: DTL.Carrier Code Usr 4 is Entered
     C           #DNOAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNOAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNOAA    ZA0006           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 5
      * CASE: DTL.Carrier Code Usr 5 is Entered
     C           #DNPAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNPAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNPAA    ZA0007           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 6
      * CASE: DTL.Carrier Code Usr 6 is Entered
     C           #DNQAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNQAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNQAA    ZA0008           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 7
      * CASE: DTL.Carrier Code Usr 7 is Entered
     C           #DNRAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNRAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNRAA    ZA0009           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 8
      * CASE: DTL.Carrier Code Usr 8 is Entered
     C           #DNSAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNSAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNSAA    ZA0010           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 9
      * CASE: DTL.Carrier Code Usr 9 is Entered
     C           #DNTAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNTAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNTAA    ZA0011           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier Code 10
      * CASE: DTL.Carrier Code Usr 10 is Entered
     C           #DNUAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNUAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNUAA    ZA0012           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Validate Shipping Lines             P000737
      *================================================================
      * Validate Shipping Line 1
      * CASE: DTL.Carrier Code Usr 11 is Entered
     C           #DN0AA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DN0AA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DN0AA    ZA0013           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Shipping Line 2
      * CASE: DTL.Carrier Code Usr 12 is Entered
     C           #DNWAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNWAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNWAA    ZA0014           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Shipping Line 3
      * CASE: DTL.Carrier Code Usr 13 is Entered
     C           #DNXAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNXAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNXAA    ZA0015           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Shipping Line 4
      * CASE: DTL.Carrier Code Usr 14 is Entered
     C           #DNYAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNYAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNYAA    ZA0016           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Shipping Line 5
      * CASE: DTL.Carrier Code Usr 15 is Entered
     C           #DNZAA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNZAA    WL0007    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0013    P      Name
     C                     MOVELWL0009    WUVSST    P      Record Status
      * Carrier not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * Setup message data for message
     C                     MOVEL#DNZAA    ZA0017           Carrier Code Us
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Validate Country Codes (10 total)   P000737
      *================================================================
      * VAL: Country Code 1
      * CASE: DTL.Country Code 1 usr is Entered
     C           #DKIAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKIAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DKIAA    ZA0022           Country Code 1
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9969  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 2
      * CASE: DTL.Country Code 2 usr is Entered
     C           #DKJAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKJAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DKJAA    ZA0023           Country Code 2
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9970  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 3
      * CASE: DTL.Country Code 3 usr is Entered
     C           #DKKAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKKAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DKKAA    ZA0024           Country Code 3
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9971  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 4
      * CASE: DTL.Country Code 4 usr is Entered
     C           #DKLAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKLAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DKLAA    ZA0025           Country Code 4
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9972  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 5
      * CASE: DTL.Country Code 5 usr is Entered
     C           #DKMAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKMAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DKMAA    ZA0026           Country Code 5
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9973  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 6
      * CASE: DTL.Country Code 6 usr is Entered
     C           #DKNAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKNAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DKNAA    ZA0027           Country Code 6
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9974  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 7
      * CASE: DTL.Country Code 7 usr is entered
     C           #DNHAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNHAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DNHAA    ZA0028           Country Code 7
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9975  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 8
      * CASE: DTL.Country Code 8 usr is Entered
     C           #DNIAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNIAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DNIAA    ZA0029           Country Code 8
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9976  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 9
      * CASE: DTL.Country Code 9 usr is Entered
     C           #DNJAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNJAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DNJAA    ZA0030           Country Code 9
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9977  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Country Code 10
      * CASE: DTL.Country Code 10 usr is Entered
     C           #DNKAA    IFNE *BLANK                     *IF
      * RTV Chk if valid Cntry RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DNKAA    WL0012    P      Country Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DNKAA    ZA0031           Country Code 10
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9978  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0110  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Country
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1KXCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #1KXCD    PARM #1KXCD    WQ0111  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1KXCD    IFEQ *BLANK                     Country Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWB    KLIST
     C                     KFLD           WBKXCD           Country Code
      * Setup key
     C                     MOVEL#1KXCD    WBKXCD
     C           KLVBWB    CHAIN@E5REVS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1158' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDEQ029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DOPTI'  YPMTFD           Select Option
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DB4TX'  YPMTFD           OHE Load Haul T
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DWPST'  YPMTFD           Warehouse Type
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ055
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DU1AM'  YPMTFD           Select Report O
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ076
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSQSX'  YPMTFD           Type of Custome
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ025
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DB8ST'  YPMTFD           Status - Y or N
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DVQSX'  YPMTFD           Email Selection
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL*BLANK    P3B8NA           System Date For
     C                     MOVEL*BLANK    P3AJVN           User Profile Na
     C                     MOVEL*BLANK    P3I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P3MPNA           Default Printer
     C                     MOVEL*BLANK    P4G3TX           PRT Description
     C                     MOVEL*BLANK    P4WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P4WSST           PRT Hold Output
     C                     MOVEL*BLANK    P4WTST           PRT Save Output
     C                     Z-ADD*ZERO     P4DYNB           PRT Number of C
     C                     MOVEL*BLANK    P4WUST           PRT Night Queue
     C                     MOVEL*BLANK    P4BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P4AJAA           Company Number
     C                     Z-ADD*ZERO     P4AJAD           From Date Pass
     C                     Z-ADD*ZERO     P4AJAG           Thru Date Pass
     C                     Z-ADD*ZERO     P4M8NB           System Value Nu
     C                     MOVEL*BLANK    P4ZSST           Trans Type 1 PA
     C                     MOVEL*BLANK    P4ZTST           Trans Type 2 PA
     C                     MOVEL*BLANK    P4B8ST           Status - Y or N
     C                     Z-ADD*ZERO     P4YONX           Order Company P
     C                     MOVEL*BLANK    P4HWSX           Change Flag USR
     C                     MOVEL*BLANK    P5ADTX           Name
     C                     MOVEL*BLANK    P6A9ST           Day of Week
     C                     MOVEL*BLANK    P7YISX           Plant Company S
     C                     MOVEL*BLANK    P8KIAA           Country Code 1
     C                     MOVEL*BLANK    P8KJAA           Country Code 2
     C                     MOVEL*BLANK    P8KKAA           Country Code 3
     C                     MOVEL*BLANK    P8KLAA           Country Code 4
     C                     MOVEL*BLANK    P8KMAA           Country Code 5
     C                     MOVEL*BLANK    P8KNAA           Country Code 6
     C                     MOVEL*BLANK    P8NHAA           Country Code 7
     C                     MOVEL*BLANK    P8NIAA           Country Code 8
     C                     MOVEL*BLANK    P8NJAA           Country Code 9
     C                     MOVEL*BLANK    P8NKAA           Country Code 10
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAXXTM           Departure Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Load ID Alpha
     C                     Z-ADD*ZERO     WUBIC7  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCP3NB           D & B Number
     C                     Z-ADD*ZERO     WCI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WCAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBTC7           Parent Customer
     C                     Z-ADD*ZERO     WCS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WCVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WCI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDAT1           Broker G/L Vend
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WERPNB           Total Load Orde
     C                     Z-ADD*ZERO     WEFLAM           Flat Amount
     C                     Z-ADD*ZERO     WERRNB           Total Stops
     C                     Z-ADD*ZERO     WESBNB           BOL Time
     C                     Z-ADD*ZERO     WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WESDNB           Number Pallets
     C                     Z-ADD*ZERO     WEPAOU           Number Pallets
     C                     Z-ADD*ZERO     WEDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WESXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WEHADT           Actual Arrival
     C                     Z-ADD*ZERO     WEAART           Actual Arrival
     C                     Z-ADD*ZERO     WEDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WEDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WEAQDT           Actual Departur
     C                     Z-ADD*ZERO     WES6NB           Departure Time
     C                     Z-ADD*ZERO     WET4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WEPRTM           Product Tempera
     C                     Z-ADD*ZERO     WENPSV           Number Spacers
     C                     Z-ADD*ZERO     WETLMI           Total Load Mile
     C                     Z-ADD*ZERO     WEGRWE           Gross Weight
     C                     Z-ADD*ZERO     WEF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WEJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WETRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WEJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WESPTM           Spotted Time
     C                     Z-ADD*ZERO     WEJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WELFTM           Load Finished T
     C                     Z-ADD*ZERO     WEJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WEBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WEJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WEBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WEKIDT           Truck Departure
     C                     Z-ADD*ZERO     WEASTM           Truck Departure
     C                     Z-ADD*ZERO     WEKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WEAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WEVOAG           Voyage
     C                     Z-ADD*ZERO     WEKBDT           Sail Date
     C                     Z-ADD*ZERO     WEEFDT           Arrival Date
     C                     Z-ADD*ZERO     WEKCDT           Date In
     C                     Z-ADD*ZERO     WETMIN           Time In
     C                     Z-ADD*ZERO     WEKDDT           Date Out
     C                     Z-ADD*ZERO     WEVMNB           Time Out
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WEATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WEBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WEKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WELLDT           Express Mail Da
     C                     Z-ADD*ZERO     WEK0DT           Product Complet
     C                     Z-ADD*ZERO     WEAYTM           Product Complet
     C                     Z-ADD*ZERO     WEKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WEICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WEIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WEK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WEAZTM           Load Door 1
     C                     Z-ADD*ZERO     WEK2DT           Override Total
     C                     Z-ADD*ZERO     WEA0TM           Load Door 2
     C                     Z-ADD*ZERO     WEZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WEPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WECKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WEPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WECLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WEP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WECMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WEP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WECNTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WECOTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WECQTM           LH Unused Time
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WFEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WFNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WFNSVA           Long hook balan
     C                     Z-ADD*ZERO     WFNTVA           Short hook bala
     C                     Z-ADD*ZERO     WFNUVA           Tub Balance
     C                     Z-ADD*ZERO     WFS8NB           Home Phone
     C                     Z-ADD*ZERO     WFS9NB           Other Phone
     C                     Z-ADD*ZERO     WFNMVA           Flat Rate
     C                     Z-ADD*ZERO     WFNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WFNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WFNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WFQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WFQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WFMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WFMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WFRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WFMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WFBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WFB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WFAAC7           Contact Number
     C                     Z-ADD*ZERO     WFTENO           Carrier Unused
     C                     Z-ADD*ZERO     WFAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WFAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WFKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WHBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WHA2DT           Period Ending D
     C                     Z-ADD*ZERO     WHBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WHPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WHPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WHECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WHHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Ship to Customer      USR
     C                     Z-ADD*ZERO     WUD0C7  70
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WIQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WIQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WIQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WIGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WIHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WIHGVL           Transload Termi
     C                     Z-ADD*ZERO     WIQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WIQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WIQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WIQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WIITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WIQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WIQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WIQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WIP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WIQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WIQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WIQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WIQENY           Original Appoin
     C                     Z-ADD*ZERO     WIQFNY           Original Appoin
     C                     Z-ADD*ZERO     WIQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WIQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WIQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WIQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WIW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WIW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WKBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WKBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WKBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WKBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMM8NB           System Value Nu
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WONLNB           Entity Number
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006 30
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009  1
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0010 15
     C                     MOVEL*BLANK    WL0011  1
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0012  6
      * Define local variables for subroutine SLRVGN.
     C                     MOVEL*BLANK    WL0013  2
     C                     MOVEL*BLANK    WL0014  3
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0015  3
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0016 10
     C                     MOVEL*BLANK    WL0017  6
     C                     Z-ADD*ZERO     WL0018  30
     C                     MOVEL*BLANK    WL0019  3
      * Define local work field PRT Description
     C                     MOVEL*BLANK    YL0001 25
      * Define local work field Email addr 1
     C                     MOVEL*BLANK    YL0002 25
      * Define local work field Email Addr 2
     C                     MOVEL*BLANK    YL0003 25
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0004  70
      * Define null work field A/R Customer Number
     C                     Z-ADD*ZERO     YN0001  70
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Description 14A      USR
     C                     MOVEL*BLANK    YL0006 14
      * Define null work field Broker Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Broker Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Broker City
     C                     MOVEL*BLANK    YN0004 20
      * Define null work field Broker State
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field Broker Zip
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Broker Office Manager
     C                     MOVEL*BLANK    YN0007 30
      * Define null work field Broker Telephone Number
     C                     MOVEL*BLANK    YN0008 25
      * Define null work field Broker Fax Number
     C                     MOVEL*BLANK    YN0009 25
      * Define null work field Broker Email Address
     C                     MOVEL*BLANK    YN0010 50
      * Define null work field Broker G/L Vendor Number
     C                     Z-ADD*ZERO     YN0011  80
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0012  3
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Name
     C                     MOVEL*BLANK    YN0013 30
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0012 40
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0014  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SPRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,008                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0065           User Profile Na
     C                     MOVEL'OMS'     ZA0066           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0016    P      User Profile Na
     C                     MOVEL'OMS'     WL0017    P      Application Cod
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    P3AIC3           Company Number
     C                     MOVELWL0019    YL0014    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0016    P      User Profile Na
     C                     MOVEL'OMS'     WL0017    P      Application Cod
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    P3AIC3           Company Number
     C                     MOVELWL0019    YL0014    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0014    P3AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0067           User Profile Na
     C                     MOVEL'OMS'     ZA0068           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0013    IFNE 0                          *IF
     C                     Z-ADDYL0013    P3AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0014    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P3AJCD    PARM *BLANK    WQ0114  3        Warehouse Code
     C                     PARM YL0013    WQ0115  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SRRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P4HWSX           Change Flag USR
     C                     MOVEL'Y'       P4B8ST           Status - Y or N
     C                     MOVEL'Y'       YL0010           First Time Flag
     C                     MOVEL@CN,010   YL0006           Description 14A
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01053010640130901314020730208302329
02585028410284802871028750309703104
03111031180312503353033600336703374
03381036090361603623036300363703865
03875039160412104131043700437704384
04391043980440504412044190442604633
04649046700489304903049130492304933
05149051590516905179051890540505411
0543705661
** W0END
01060010710130901338020750211202335
02587028420285402871028900309903106
03113031200312703355033620336903376
03383036110361803625036320363903871
03904039160412604160043720437904386
04393044000440704414044210442804633
04650046840489804908049180492804938
05154051640517405184051940540505435
0545005710
** W0NAM
VDBDDT    VDFDDT    #DOPTI    #DHLTX    #DATNB    #DAPTX    #DNNNB
#DB4TX    #DWPST    #DU1AL    #DU1AM    #DGZT1    #DNLAA    #DNMAA
#DNNAA    #DNOAA    #DNPAA    #DNQAA    #DNRAA    #DNSAA    #DNTAA
#DNUAA    #DN0AA    #DNWAA    #DNXAA    #DNYAA    #DNZAA    #DAJNB
#DAYTX    #DSQSX    #DHHAA    #DDET1    #DAJCD    #DZUCD    #DZVCD
#DZWCD    #DZXCD    #DZYCD    #DZZCD    #DZ0CD    #DZ1CD    #DB8ST
#DBOCD    #DJ1T1    #DKIAA    #DKJAA    #DKKAA    #DKLAA    #DKMAA
#DKNAA    #DNHAA    #DNIAA    #DNJAA    #DNKAA    #DVQSX    #DHUTX
#DI6TX    #DUGTX
** @CN
00001 Export Load Report
00002 Exp Ld Rept w/Amt & Wgts
00003 Booking Rpt for Exports
00004 Booking Rpt 4/Export-Less
00005 Export Load Rpt w/Weights
00006 Booking for Exp Coord
00007 USR0003
00008 Y2U0005
00009 JPNBRKREML
00010 (S=Spreadsht )
