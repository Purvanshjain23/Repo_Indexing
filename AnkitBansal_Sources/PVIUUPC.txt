/*********************************************************************/
/* PROGRAM : PVIUUPC                                                 */
/* DESC    : CNV CRT IB&IBD SUFFIX2CL  EXECUTE USER PROGRAM          */
/* DATE    : 11/25/2024                                              */
/* PROJECT : SR # 3023318                                            */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Create one time conversion process to create the WIM    */
/*           Item Balance & WIM Item Balance Detail suffix 'EDI'     */
/*           tables.                                                 */
/*           WIB = PUCGCPP => PUCGCPPEDI                             */
/*           WIBD = PUCHCPP => PUCHCPPEDI                            */
/*                                                                   */
/*           ***MANUALLY SUBMIT PVIUUPC TO BATCH.                    */
/*                                                                   */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* MM/DD/YY                                                          */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&DATA) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATAH) TYPE(*CHAR) LEN(10)


/*-------------------------------------------------------------------*/
/* PROD OR TEST ENVIRONMENT?                                         */
/*-------------------------------------------------------------------*/
             CALL       PGM(CAQXXFR) PARM(' ' &DATA &DATAH)

/*-------------------------------------------------------------------*/
/* Recreate PUCGCPP & PUCHCPP with 'EDI' Suffix in the Appropriate Library. */
/*-------------------------------------------------------------------*/
  /***********************************/
  /*TEST Environment Processing     */
  /***********************************/
             IF         COND(&DATA *NE 'PRKFLIB') THEN(DO)

             CHKOBJ     OBJ(&DATA/PUCGCPPEDI) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)  /* NOT FOUND */

      /*‚FOR OMSDEVSQC ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_EDI FOR +
                          SYSTEM NAME PUCGCPPEDI LIKE +
                          OMSDEVSQC/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_DETAIL_EDI FOR +
                          SYSTEM NAME PUCHCPPEDI LIKE +
                          OMSDEVSQC/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - OMSDEVSQC -ˆDON'T NEED! TABLE +
          ˆCREATION AUTOMATICALLY APPLIES JOURNAL. */
        /*   STRJRNPF   FILE(OMSDEVSQC/PUCGCPPEDI) +
                          JRN(TESTJRN/DEVJRN) IMAGES(*AFTER) */
        /*   STRJRNPF   FILE(OMSDEVSQC/PUCHCPPEDI) +
                          JRN(TESTJRN/DEVJRN) IMAGES(*AFTER) */

      /*‚FOR PRKTESTF ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_EDI FOR +
                          SYSTEM NAME PUCGCPPEDI LIKE +
                          PRKTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_DETAIL_EDI FOR +
                          SYSTEM NAME PUCHCPPEDI LIKE +
                          PRKTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)


      /*‚FOR TPMTESTF ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_EDI FOR +
                          SYSTEM NAME PUCGCPPEDI LIKE +
                          TPMTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_DETAIL_EDI FOR +
                          SYSTEM NAME PUCHCPPEDI LIKE +
                          TPMTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

      /*‚FOR PRKUATF ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_EDI FOR +
                          SYSTEM NAME PUCGCPPEDI LIKE +
                          PRKUATF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_DETAIL_EDI FOR +
                          SYSTEM NAME PUCHCPPEDI LIKE +
                          PRKUATF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

             ENDDO
             ENDDO      /* &DATA *NE 'PRKFLIB' */

  /***********************************/
  /*ˆPROD Environment Processing     */
  /***********************************/
             IF         COND(&DATA *EQ 'PRKFLIB') THEN(DO)
             CHKOBJ     OBJ(&DATA/PUCGCPPEDI) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)  /* NOT FOUND */

      /* FOR PRKFLIB ENV */
         /* Item Balance */
             CRTDUPOBJ  OBJ(CAB0REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB0REPEDI)
             CHGPF      FILE(PRKFLIB/CAB0REPEDI) SIZE(*NOMAX)

         /* Item Balance Detail */
             CRTDUPOBJ  OBJ(CAB1REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB1REPEDI)
             RMVPFTRG   FILE(PRKFLIB/CAB1REPEDI)
             CHGPF      FILE(PRKFLIB/CAB1REPEDI) SIZE(*NOMAX)

         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_EDI FOR +
                          SYSTEM NAME PUCGCPPEDI LIKE +
                          PRKFLIB/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_DETAIL_EDI FOR +
                          SYSTEM NAME PUCHCPPEDI LIKE +
                          PRKFLIB/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - PRKFLIB -ˆDON'T NEED! TABLE +
          ˆCREATION AUTOMATICALLY APPLIES JOURNAL. */
        /*   STRJRNPF   FILE(PRKFLIB/PUCGCPPEDI) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER) */
        /*   STRJRNPF   FILE(PRKFLIB/PUCHCPPEDI) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER) */

             ENDDO
             ENDDO      /* &DATA *EQ 'PRKFLIB' */

 ENDPGM:     ENDPGM
