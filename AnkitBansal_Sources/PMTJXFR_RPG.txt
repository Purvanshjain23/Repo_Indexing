     H/TITLE Exc Crt RIN Actvy Rpt XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/13/17  Time  : 13:19:13
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FPMDACPLKIF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/GenDt/ULSD CMP/Batch
      *
     FPMDACPLLIF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/RinDt/ULSD CMP/Batch
      *
     FPMDRCPL0IF  E           K        DISK                      A
      * UPD : RFS RIN Activity Rpt      Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@CAREOB
      * COA Property Define Hdr   Retrieval index
      * Renamed input format fields
     I              CAAIC3                          WAAIC3
     I              CAIDAA                          WAIDAA
     I              CAR2NA                          WAR2NA
     I              CAL2T1                          WAL2T1
     I              CAL3T1                          WAL3T1
     I              CAL4T1                          WAL4T1
     I              CAL5T1                          WAL5T1
     I              CAL6T1                          WAL6T1
     I              CAL7T1                          WAL7T1
     I              CAL8T1                          WAL8T1
     I              CAL9T1                          WAL9T1
     I              CAMAT1                          WAMAT1
     I              CAJCNY                          WAJCNY
     I              CAJDNY                          WAJDNY
     I              CAJENY                          WAJENY
     I              CAJFNY                          WAJFNY
     I              CAGMPC                          WAGMPC
     I              CAMBT1                          WAMBT1
     I              CAIEAA                          WAIEAA
     I              CAIFAA                          WAIFAA
     I              CAIGAA                          WAIGAA
     I              CAIHAA                          WAIHAA
     I              CAIIAA                          WAIIAA
     I              CAIJAA                          WAIJAA
     I              CAJQNY                          WAJQNY
     I              CALXST                          WALXST
     I              CAJRNY                          WAJRNY
     I              CALYST                          WALYST
     I              CAIMTX                          WAIMTX
     I              CAFEDS                          WAFEDS
     I              CAIBAA                          WAIBAA
     I              CAI1NY                          WAI1NY
     I              CAHCTU                          WAHCTU
     I              CAMCT1                          WAMCT1
     I              CAVSST                          WAVSST
     I              CAMJDT                          WAMJDT
     I              CABETM                          WABETM
     I              CACCVN                          WACCVN
     I              CACDVN                          WACDVN
     I              CAMKDT                          WAMKDT
     I              CABFTM                          WABFTM
     I              CACEVN                          WACEVN
     I              CACFVN                          WACFVN
      *
     I@DACPNI
      * COA Batch Header RIN      Co/GenDt/ULSD CMP/Batch
      * Renamed input format fields
     I              DAAIC3                          WBAIC3
     I              DAL6T1                          WBL6T1
     I              DAI3NY                          WBI3NY
     I              DAJYNY                          WBJYNY
     I              DAQ1NY                          WBQ1NY
     I              DAMUT1                          WBMUT1
     I              DAJZNY                          WBJZNY
     I              DAJ0NY                          WBJ0NY
     I              DAJ2NY                          WBJ2NY
     I              DARIDT                          WBRIDT
     I              DAC5TM                          WBC5TM
     I              DAMVT1                          WBMVT1
     I              DAMWT1                          WBMWT1
     I              DARINT                          WBRINT
     I              DARJDT                          WBRJDT
     I              DAC6TM                          WBC6TM
     I              DAC4NB                          WBC4NB
     I              DADPNB                          WBDPNB
     I              DAUENB                          WBUENB
     I              DARZNB                          WBRZNB
     I              DANGT1                          WBNGT1
     I              DARMNB                          WBRMNB
     I              DARKDT                          WBRKDT
     I              DAC7TM                          WBC7TM
     I              DARINS                          WBRINS
     I              DAMXT1                          WBMXT1
     I              DAG3ST                          WBG3ST
     I              DAQWNY                          WBQWNY
     I              DAL0AA                          WBL0AA
     I              DAMAT1                          WBMAT1
     I              DATDNA                          WBTDNA
     I              DACWC3                          WBCWC3
     I              DAQXNY                          WBQXNY
     I              DAQZNY                          WBQZNY
     I              DAQ0NY                          WBQ0NY
     I              DALVTX                          WBLVTX
     I              DANYT1                          WBNYT1
     I              DAG5ST                          WBG5ST
     I              DAG7ST                          WBG7ST
     I              DATFDT                          WBTFDT
     I              DATGDT                          WBTGDT
     I              DAWIT1                          WBWIT1
     I              DAQYNY                          WBQYNY
     I              DAL7T1                          WBL7T1
     I              DAR8NY                          WBR8NY
     I              DAR0NY                          WBR0NY
     I              DAI7AA                          WBI7AA
     I              DAMXAA                          WBMXAA
     I              DAMSAA                          WBMSAA
     I              DAR7NY                          WBR7NY
     I              DAHEPR                          WBHEPR
     I              DAHFPR                          WBHFPR
     I              DAWVT1                          WBWVT1
     I              DAW0T1                          WBW0T1
     I              DAR5NY                          WBR5NY
     I              DAW1T1                          WBW1T1
     I              DAR6NY                          WBR6NY
     I              DAJ1ST                          WBJ1ST
     I              DAKHST                          WBKHST
     I              DATWDT                          WBTWDT
     I              DADUTM                          WBDUTM
     I              DAKGST                          WBKGST
     I              DATVDT                          WBTVDT
     I              DADTTM                          WBDTTM
     I              DAR9NY                          WBR9NY
     I              DASQNY                          WBSQNY
     I              DABHR3                          WBBHR3
     I              DASRNY                          WBSRNY
     I              DAW7T1                          WBW7T1
     I              DAW8T1                          WBW8T1
     I              DAT2DT                          WBT2DT
     I              DASXNY                          WBSXNY
     I              DASYNY                          WBSYNY
     I              DASZNY                          WBSZNY
     I              DAVSST                          WBVSST
     I              DAMJDT                          WBMJDT
     I              DABETM                          WBBETM
     I              DACCVN                          WBCCVN
     I              DACDVN                          WBCDVN
     I              DAMKDT                          WBMKDT
     I              DABFTM                          WBBFTM
     I              DACEVN                          WBCEVN
     I              DACFVN                          WBCFVN
      *
     I@DACPNJ
      * COA Batch Header RIN      Co/RinDt/ULSD CMP/Batch
      * Renamed input format fields
     I              DAAIC3                          WCAIC3
     I              DAL6T1                          WCL6T1
     I              DAI3NY                          WCI3NY
     I              DAJYNY                          WCJYNY
     I              DAQ1NY                          WCQ1NY
     I              DAMUT1                          WCMUT1
     I              DAJZNY                          WCJZNY
     I              DAJ0NY                          WCJ0NY
     I              DAJ2NY                          WCJ2NY
     I              DARIDT                          WCRIDT
     I              DAC5TM                          WCC5TM
     I              DAMVT1                          WCMVT1
     I              DAMWT1                          WCMWT1
     I              DARINT                          WCRINT
     I              DARJDT                          WCRJDT
     I              DAC6TM                          WCC6TM
     I              DAC4NB                          WCC4NB
     I              DADPNB                          WCDPNB
     I              DAUENB                          WCUENB
     I              DARZNB                          WCRZNB
     I              DANGT1                          WCNGT1
     I              DARMNB                          WCRMNB
     I              DARKDT                          WCRKDT
     I              DAC7TM                          WCC7TM
     I              DARINS                          WCRINS
     I              DAMXT1                          WCMXT1
     I              DAG3ST                          WCG3ST
     I              DAQWNY                          WCQWNY
     I              DAL0AA                          WCL0AA
     I              DAMAT1                          WCMAT1
     I              DATDNA                          WCTDNA
     I              DACWC3                          WCCWC3
     I              DAQXNY                          WCQXNY
     I              DAQZNY                          WCQZNY
     I              DAQ0NY                          WCQ0NY
     I              DALVTX                          WCLVTX
     I              DANYT1                          WCNYT1
     I              DAG5ST                          WCG5ST
     I              DAG7ST                          WCG7ST
     I              DATFDT                          WCTFDT
     I              DATGDT                          WCTGDT
     I              DAWIT1                          WCWIT1
     I              DAQYNY                          WCQYNY
     I              DAL7T1                          WCL7T1
     I              DAR8NY                          WCR8NY
     I              DAR0NY                          WCR0NY
     I              DAI7AA                          WCI7AA
     I              DAMXAA                          WCMXAA
     I              DAMSAA                          WCMSAA
     I              DAR7NY                          WCR7NY
     I              DAHEPR                          WCHEPR
     I              DAHFPR                          WCHFPR
     I              DAWVT1                          WCWVT1
     I              DAW0T1                          WCW0T1
     I              DAR5NY                          WCR5NY
     I              DAW1T1                          WCW1T1
     I              DAR6NY                          WCR6NY
     I              DAJ1ST                          WCJ1ST
     I              DAKHST                          WCKHST
     I              DATWDT                          WCTWDT
     I              DADUTM                          WCDUTM
     I              DAKGST                          WCKGST
     I              DATVDT                          WCTVDT
     I              DADTTM                          WCDTTM
     I              DAR9NY                          WCR9NY
     I              DASQNY                          WCSQNY
     I              DABHR3                          WCBHR3
     I              DASRNY                          WCSRNY
     I              DAW7T1                          WCW7T1
     I              DAW8T1                          WCW8T1
     I              DAT2DT                          WCT2DT
     I              DASXNY                          WCSXNY
     I              DASYNY                          WCSYNY
     I              DASZNY                          WCSZNY
     I              DAVSST                          WCVSST
     I              DAMJDT                          WCMJDT
     I              DABETM                          WCBETM
     I              DACCVN                          WCCCVN
     I              DACDVN                          WCCDVN
     I              DAMKDT                          WCMKDT
     I              DABFTM                          WCBFTM
     I              DACEVN                          WCCEVN
     I              DACFVN                          WCCFVN
      *
     I@DRCPR9
      * RFS RIN Activity Rpt      Update index
      * Renamed input format fields
     I              DRNWT1                          WDNWT1
     I              DRLTTX                          WDLTTX
     I              DRLUTX                          WDLUTX
     I              DRNXT1                          WDNXT1
     I              DRNYT1                          WDNYT1
     I              DRI4AA                          WDI4AA
     I              DRNZT1                          WDNZT1
     I              DRLVTX                          WDLVTX
     I              DRI5AA                          WDI5AA
     I              DRLXTX                          WDLXTX
     I              DRK6NY                          WDK6NY
     I              DRKZNY                          WDKZNY
     I              DRK7NY                          WDK7NY
     I              DRK8NY                          WDK8NY
     I              DRK9NY                          WDK9NY
     I              DRLANY                          WDLANY
     I              DRLBNY                          WDLBNY
     I              DRLCNY                          WDLCNY
     I              DRLDNY                          WDLDNY
     I              DRLENY                          WDLENY
     I              DRLFNY                          WDLFNY
     I              DRSDNY                          WDSDNY
     I              DRSENY                          WDSENY
     I              DRSFNY                          WDSFNY
     I              DRSGNY                          WDSGNY
     I              DRSHNY                          WDSHNY
     I              DRTLNY                          WDTLNY
     I              DRSINY                          WDSINY
     I              DRSJNY                          WDSJNY
     I              DRSKNY                          WDSKNY
     I              DRSLNY                          WDSLNY
     I              DRSMNY                          WDSMNY
     I              DRSNNY                          WDSNNY
     I              DRSONY                          WDSONY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQPMDR1    E DSPMDRCPL0
      * UPD : RFS RIN Activity Rpt      Update index
      * Renamed input format fields
     I              DRNWT1                          WDNWT1
     I              DRLTTX                          WDLTTX
     I              DRLUTX                          WDLUTX
     I              DRNXT1                          WDNXT1
     I              DRNYT1                          WDNYT1
     I              DRI4AA                          WDI4AA
     I              DRNZT1                          WDNZT1
     I              DRLVTX                          WDLVTX
     I              DRI5AA                          WDI5AA
     I              DRLXTX                          WDLXTX
     I              DRK6NY                          WDK6NY
     I              DRKZNY                          WDKZNY
     I              DRK7NY                          WDK7NY
     I              DRK8NY                          WDK8NY
     I              DRK9NY                          WDK9NY
     I              DRLANY                          WDLANY
     I              DRLBNY                          WDLBNY
     I              DRLCNY                          WDLCNY
     I              DRLDNY                          WDLDNY
     I              DRLENY                          WDLENY
     I              DRLFNY                          WDLFNY
     I              DRSDNY                          WDSDNY
     I              DRSENY                          WDSENY
     I              DRSFNY                          WDSFNY
     I              DRSGNY                          WDSGNY
     I              DRSHNY                          WDSHNY
     I              DRTLNY                          WDTLNY
     I              DRSINY                          WDSINY
     I              DRSJNY                          WDSJNY
     I              DRSKNY                          WDSKNY
     I              DRSLNY                          WDSLNY
     I              DRSMNY                          WDSMNY
     I              DRSNNY                          WDSNNY
     I              DRSONY                          WDSONY
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * FLD: RFS RIN Activity Rpt
      * N :  RFS Report Form ID
     I                                        1   7 P2NWT1
      * I :  RFS Report Type
     I                                        8   8 P2LTTX
      * N :  RFS CBI
     I                                        9   9 P2LUTX
      * N :  RFS Report Date
     I                                       10  19 P2NXT1
      * I :  RFS Report Year
     I                                       20  23 P2NYT1
      * O :  RFS Company ID
     I                                       24  27 P2I4AA
      * I :  RFS Compliance Period
     I                                       28  29 P2LVTX
      * N :  RFS RIN Status
     I                                       30  30 P2LXTX
      * N :  RFS Vol at End of Quarter
     I                                    P  31  370P2K6NY
      * N :  RFS 2009 RFS1 RIN Own Str
     I                                    P  38  440P2KZNY
      * N :  RFS 2009 RFS1 RIN Purchs
     I                                    P  45  490P2K7NY
      * N :  RFS 2009 RFS1 RINS Sold
     I                                    P  50  540P2K8NY
      * N :  RFS 2009 RFS1 RINS Retrd
     I                                    P  55  590P2K9NY
      * N :  RFS 2009 RFS1 RIN Own-End
     I                                    P  60  640P2LANY
      * N :  RFS 2010 RFS1 RIN OwSt
     I                                    P  65  690P2LBNY
      * N :  RFS 2010 RFS1 RIN Prch
     I                                    P  70  740P2LCNY
      * N :  RFS 2010 RFS1 RIN Sold
     I                                    P  75  790P2LDNY
      * N :  RFS 2010 RFS1 RIN Rtrd
     I                                    P  80  840P2LENY
      * N :  RFS 2010 RFS1 RINS Own-En
     I                                    P  85  890P2LFNY
      * N :  RFS Cur RFS2 RINS Own Str
     I                                    P  90  940P2SDNY
      * N :  RFS Cur RFS2 Gl RINS Prch
     I                                    P  95  990P2SENY
      * N :  RFS Cur RFS2 Gl RINS Sold
     I                                    P 100 1040P2SFNY
      * N :  RFS Cur RFS2 Gl RINS Rtrd
     I                                    P 105 1090P2SGNY
      * N :  RFS Cur RFS2 RINS Own-End
     I                                    P 110 1140P2SHNY
      * N :  RFS Cur RFS2 RINS Genertd
     I                                    P 115 1210P2TLNY
     IP3PARM      DS
      * N :  Date From             USR
     I                                    P   1   40P3JEDT
     IP4PARM      DS
      * N :  Date To               USR
     I                                    P   1   40P4JFDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2LTTX    PARM           WP0002  1        RFS Report Type
     C           P2NYT1    PARM           WP0003  4        RFS Report Year
     C           P2I4AA    PARM P2I4AA    WP0004  4        RFS Company ID
     C           P2LVTX    PARM           WP0005  2        RFS Compliance
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt RIN Actvy Rpt XF
      * ________________________________________________________________
      * F1110 - EPA Quarterly Reporting -- Report RFS0100
      *      RFS RIN Activity Report - send quarterly to the EPA
      * Q1 =  Jan - Mar (Due May 31)         Q2 = Apr - Jun (Due Aug 31)
      * Q3 =  Jul - Sep (Due Nov 30)         Q4 = Oct - Dec (Due Feb 28)
      *  Summarize all RIN activities for the reporting period.
      * ________________________________________________________________
      * MODIFICATIONS:
      * E02218 RMC 8/08/2012 Q2 2012:  RFS0103 renamed RFS0104 & fld chan
      *    handled in the sql RFS0104
      * E02013 RMC 3/23/2012  use emts sent date instead of trans date be
      *   trans date is now actual shipped date. to balance with emts we
      *   need to total rins per the date they were sent to EMTS.
      *   So do 2 passes: 1st) Get GEN rins per GEN EMTS Dt
      *   then secondly get the BUY/SEL/RET per the RIN EMTS Date sent
      * E01510 RMC 5/17/2011  increase dec position to 9 from 7
      * E01510 RMC 4/26/2011  Add new fields per Q1 2011 docs; Now RFSA10
      * E921 9/28/2010 EPA RFS2 Modifications-Report RFS0100 is now RFS01
      *    and report rfs1 and rfs2 trans in separate buckets
      *  P00579 RMC 7/28/2010  Added comp id to LF for rtv prior yr data
      *  P00579 RMC 5/26/2010  Added new fields for RFS2
      * ________________________________________________________________
      * Set field values that wont change per batch:
     C                     MOVEL'RFS0104' P2NWT1           RFS Report Form
     C                     MOVEL'N'       P2LUTX           RFS CBI
      * Format report date: MM/DD/YYYY
      *
     C                     MOVEL*BLANK    WN0001  7        Date 7A
      *
      * Clc Fmt Dt MM/DD/YYYY IF
      * Format input date as : MM/DD/YYYY
     C                     MOVEL*BLANK    WN0001           Date 7A
     C                     MOVEL##JDT     WN0001           Date 7A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ WUT8TX    P  90  Day (Alpha) USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * WRK.Year Code = PAR.Date In *YEAR
     C           ##JDT     ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    WUNYTX           Year USR
     C                     Z-ADD0         ZQ      50
     C           WUT5TX    CAT  '/':ZQ    WUN0TX    P      Month MM/  3A
     C                     Z-ADD0         ZQ      50
     C           WUT8TX    CAT  '/':ZQ    WUN1TX    P      Day DD/  3A
     C                     Z-ADD0         ZQ      50
     C           WUN0TX    CAT  WUN1TX:ZQ WUN2TX    P      Month/Day MM/DD
     C                     Z-ADD0         ZQ      50
     C           WUN2TX    CAT  WUNYTX:ZQ P2NXT1    P      MMDDYYYY Usr
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP2NYT1:ZQ WUUATX    P  90  Year Alpha (YY)
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WUUATX:ZQ WUMLT1    P      Text 3 Length U
      * Set Compliance From and To Dates
      * CASE: PAR.RFS Compliance Period is Quarter 1 (Jan-Mar)
     C           P2LVTX    IFEQ 'Q1'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0101':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0331':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 2 (Apr-Jun)
     C           P2LVTX    IFEQ 'Q2'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0401':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0630':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 3 (Jly-Sep)
     C           P2LVTX    IFEQ 'Q3'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0701':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0930':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 4 (Oct-Dec)
     C           P2LVTX    IFEQ 'Q4'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '1001':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '1231':ZQ WUV6CD    P      Date To Alpha
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVE WUV5CD    P3JEDT           Date From
     C                     MOVE WUV6CD    P4JFDT           Date To
      * Get Company Info:
      * RTV for RFS EPA Rpts  RT - COA Property Define Hdr  * 
     C                     EXSR SARVGN
      * CASE: LCL.COA ULSD Facility # is Blanks
     C           YL0006    IFEQ *BLANK                     *IF
     C                     MOVEL'NOTOP'   YL0006           COA ULSD Facili
     C                     END                             *FI
      * Get Current year gallon rins owned at start of quarter
      *    Volume shipped after Quarter start from active batches
      * this can be 0 -> rins arent assigned until ship/invoice time
     C                     Z-ADD*ZERO     P2KZNY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     P2SDNY           RFS Cur RFS2 RI
      * 5/13/09 E00382 Volume of fuel still in the tanks will come from t
      *  Change effective for Q2 2009 report
      * GET fuel inventory at EOQ FROM TOM!!
      *  Gallon RINs owned at Quarter End
      *  ->  can be 0 -> rins arent assigned until ship/invoice time
     C                     Z-ADD*ZERO     P2LANY           RFS 2009 RFS1 R
      * Accum Number of gallon-RINs sold and retired for the period:
      *    For Assigned RINS:  status = 1
     C                     MOVEL'1'       P2LXTX           RFS RIN Status
      * Get RINS Generated for the date range
      * Rtv RFS Act Rpt-GEN   RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP3JEDT    WL0002           COA GEN EMTS Da
     C                     Z-ADDP3JEDT    WL0003           Date From
     C                     Z-ADDP4JFDT    WL0004           Date To
     C                     MOVELP2LXTX    WL0005    P      RFS RIN Status
     C                     Z-ADDP2TLNY    WL0006           RFS Cur RFS2 RI
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    P2TLNY           RFS Cur RFS2 RI
      * Get RINS BUY/SEL/RET for the date range
      * Rtv RFS Act Rpt-EMTS  RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0007           Company Number
     C                     Z-ADDP3JEDT    WL0008           COA RIN EMTS Da
     C                     Z-ADDP3JEDT    WL0009           Date From
     C                     Z-ADDP4JFDT    WL0010           Date To
     C                     MOVELP2LXTX    WL0011    P      RFS RIN Status
     C                     Z-ADDP2SENY    WL0012           RFS Cur RFS2 Gl
     C                     Z-ADDP2SFNY    WL0013           RFS Cur RFS2 Gl
     C                     Z-ADDP2SGNY    WL0014           RFS Cur RFS2 Gl
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P2SENY           RFS Cur RFS2 Gl
     C                     Z-ADDWL0013    P2SFNY           RFS Cur RFS2 Gl
     C                     Z-ADDWL0014    P2SGNY           RFS Cur RFS2 Gl
      * Comp: rfs2 rins own-end
      * PAR.RFS Cur RFS2 RINS Own-End =
      *    *COMPUTE (x1 + x2 +x5 - x3 - x4)
      * x1    : PAR.RFS Cur RFS2 RINS Own Str
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.RFS Cur RFS2 Gl RINS Prch
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.RFS Cur RFS2 RINS Genertd
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.RFS Cur RFS2 Gl RINS Sold
      * -     : PGM.*Synon (17,7) work field
      * x4    : PAR.RFS Cur RFS2 Gl RINS Rtrd
     C           P2SDNY    ADD  P2SENY    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  P2TLNY    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  P2SFNY    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  P2SGNY    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P2SHNY           RFS Cur RFS2 RI
      * Let Tom supply this:  starting Q1 2010 --- commented 7/28/2010
      *   its nmbr of rins that were generated in the prior yr that were
      *   purch/sold/retred/ or still owned at the end of this period
      * Create RFSA101 Record  for Assigned RINs
      * CASE: PAR.Company Number is St Joseph HPB Marketing
     C           P1AIC3    IFEQ 374                        *IF
      * *Move-Right - /UT User Source  * 
     C                     MOVE @CN,001   YL0004
     C                     END                             *FI
      * Crt RFS RIN Actvty Rpt CR - RFS RIN Activity Rpt  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2NWT1    WL0015    P      RFS Report Form
     C                     MOVELP2LTTX    WL0016    P      RFS Report Type
     C                     MOVELP2LUTX    WL0017    P      RFS CBI
     C                     MOVELP2NXT1    WL0018    P      RFS Report Date
     C                     MOVELP2NYT1    WL0019    P      RFS Report Year
     C                     MOVELYL0005    WL0020    P      RFS Company ID
     C                     MOVELYL0004    WL0021    P      RFS Company Nam
     C                     MOVELP2LVTX    WL0022    P      RFS Compliance
     C                     MOVELYL0006    WL0023    P      RFS Compliance
     C                     MOVELP2LXTX    WL0024    P      RFS RIN Status
     C                     Z-ADDP2K6NY    WL0025           RFS Vol at End
     C                     Z-ADDP2KZNY    WL0026           RFS 2009 RFS1 R
     C                     Z-ADDP2K7NY    WL0027           RFS 2009 RFS1 R
     C                     Z-ADDP2K8NY    WL0028           RFS 2009 RFS1 R
     C                     Z-ADDP2K9NY    WL0029           RFS 2009 RFS1 R
     C                     Z-ADDP2LANY    WL0030           RFS 2009 RFS1 R
     C                     Z-ADDP2LBNY    WL0031           RFS 2010 RFS1 R
     C                     Z-ADDP2LCNY    WL0032           RFS 2010 RFS1 R
     C                     Z-ADDP2LDNY    WL0033           RFS 2010 RFS1 R
     C                     Z-ADDP2LENY    WL0034           RFS 2010 RFS1 R
     C                     Z-ADDP2LFNY    WL0035           RFS 2010 RFS1 R
     C                     Z-ADDP2SDNY    WL0036           RFS Cur RFS2 RI
     C                     Z-ADDP2SENY    WL0037           RFS Cur RFS2 Gl
     C                     Z-ADDP2SFNY    WL0038           RFS Cur RFS2 Gl
     C                     Z-ADDP2SGNY    WL0039           RFS Cur RFS2 Gl
     C                     Z-ADDP2SHNY    WL0040           RFS Cur RFS2 RI
     C                     Z-ADDP2TLNY    WL0041           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     WL0042           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0043           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0044           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0045           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0046           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0047           RFS 2009 RFS1 N
     C                     Z-ADD*ZERO     WL0048           RFS 2010 RFS1 N
     C                     EXSR SDCRRC
      * For Separated RINS:  status = 2
     C                     MOVEL'2'       P2LXTX           RFS RIN Status
      * Get RINS Generated for the date range
      * Rtv RFS Act Rpt-GEN   RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP3JEDT    WL0002           COA GEN EMTS Da
     C                     Z-ADDP3JEDT    WL0003           Date From
     C                     Z-ADDP4JFDT    WL0004           Date To
     C                     MOVELP2LXTX    WL0005    P      RFS RIN Status
     C                     Z-ADDP2TLNY    WL0006           RFS Cur RFS2 RI
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    P2TLNY           RFS Cur RFS2 RI
      * Get RINS BUY/SEL/RET for the date range
      * Rtv RFS Act Rpt-EMTS  RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0007           Company Number
     C                     Z-ADDP3JEDT    WL0008           COA RIN EMTS Da
     C                     Z-ADDP3JEDT    WL0009           Date From
     C                     Z-ADDP4JFDT    WL0010           Date To
     C                     MOVELP2LXTX    WL0011    P      RFS RIN Status
     C                     Z-ADDP2SENY    WL0012           RFS Cur RFS2 Gl
     C                     Z-ADDP2SFNY    WL0013           RFS Cur RFS2 Gl
     C                     Z-ADDP2SGNY    WL0014           RFS Cur RFS2 Gl
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P2SENY           RFS Cur RFS2 Gl
     C                     Z-ADDWL0013    P2SFNY           RFS Cur RFS2 Gl
     C                     Z-ADDWL0014    P2SGNY           RFS Cur RFS2 Gl
      * Comp: rfs2 rins own-end
      * PAR.RFS Cur RFS2 RINS Own-End =
      *    *COMPUTE (x1 + x2 + x5 - x3 - x4)
      * x1    : PAR.RFS Cur RFS2 RINS Own Str
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.RFS Cur RFS2 Gl RINS Prch
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.RFS Cur RFS2 RINS Genertd
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.RFS Cur RFS2 Gl RINS Sold
      * -     : PGM.*Synon (17,7) work field
      * x4    : PAR.RFS Cur RFS2 Gl RINS Rtrd
     C           P2SDNY    ADD  P2SENY    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  P2TLNY    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  P2SFNY    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  P2SGNY    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P2SHNY           RFS Cur RFS2 RI
      * Let Tom supply this:  starting Q1 2010 --- commented 7/28/2010
      *   its nmbr of rins that were generated in the prior yr that were
      *   purch/sold/retred/ or still owned at the end of this period
      * Create RFSA101 Record  for Separated RINs
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : PAR.RFS Cur RFS1 Gl RINS Prch is Entered
      *   |- c2    : PAR.RFS Cur RFS1 Gl RINS Sold is Entered
      *   |- c3    : PAR.RFS Cur RFS1 Gl RINS Rtrd is Entered
      *   |- c4    : PAR.RFS Cur RFS1 Gl RINS Prch is Entered
      *   |- c5    : PAR.RFS Cur RFS1 Gl RINS Sold is Entered
      *   |- c6    : PAR.RFS Cur RFS1 Gl RINS Rtrd is Entered
      *   '-
     C           P2K7NY    IFGT 0                          *IF
     C           P2K8NY    ORGT 0                          *OR
     C           P2K9NY    ORGT 0                          *OR
     C           P2K7NY    ORGT 0                          *OR
     C           P2K8NY    ORGT 0                          *OR
     C           P2K9NY    ORGT 0                          *OR
     C                     Z-ADD0         P2K6NY           RFS Vol at End
      * Crt RFS RIN Actvty Rpt CR - RFS RIN Activity Rpt  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2NWT1    WL0015    P      RFS Report Form
     C                     MOVELP2LTTX    WL0016    P      RFS Report Type
     C                     MOVELP2LUTX    WL0017    P      RFS CBI
     C                     MOVELP2NXT1    WL0018    P      RFS Report Date
     C                     MOVELP2NYT1    WL0019    P      RFS Report Year
     C                     MOVELYL0005    WL0020    P      RFS Company ID
     C                     MOVELYL0004    WL0021    P      RFS Company Nam
     C                     MOVELP2LVTX    WL0022    P      RFS Compliance
     C                     MOVELYL0006    WL0023    P      RFS Compliance
     C                     MOVELP2LXTX    WL0024    P      RFS RIN Status
     C                     Z-ADDP2K6NY    WL0025           RFS Vol at End
     C                     Z-ADDP2KZNY    WL0026           RFS 2009 RFS1 R
     C                     Z-ADDP2K7NY    WL0027           RFS 2009 RFS1 R
     C                     Z-ADDP2K8NY    WL0028           RFS 2009 RFS1 R
     C                     Z-ADDP2K9NY    WL0029           RFS 2009 RFS1 R
     C                     Z-ADDP2LANY    WL0030           RFS 2009 RFS1 R
     C                     Z-ADDP2LBNY    WL0031           RFS 2010 RFS1 R
     C                     Z-ADDP2LCNY    WL0032           RFS 2010 RFS1 R
     C                     Z-ADDP2LDNY    WL0033           RFS 2010 RFS1 R
     C                     Z-ADDP2LENY    WL0034           RFS 2010 RFS1 R
     C                     Z-ADDP2LFNY    WL0035           RFS 2010 RFS1 R
     C                     Z-ADDP2SDNY    WL0036           RFS Cur RFS2 RI
     C                     Z-ADDP2SENY    WL0037           RFS Cur RFS2 Gl
     C                     Z-ADDP2SFNY    WL0038           RFS Cur RFS2 Gl
     C                     Z-ADDP2SGNY    WL0039           RFS Cur RFS2 Gl
     C                     Z-ADDP2SHNY    WL0040           RFS Cur RFS2 RI
     C                     Z-ADDP2TLNY    WL0041           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     WL0042           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0043           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0044           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0045           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0046           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WL0047           RFS 2009 RFS1 N
     C                     Z-ADD*ZERO     WL0048           RFS 2010 RFS1 N
     C                     EXSR SDCRRC
     C                     END                             *FI
     C                     MOVELYL0005    P2I4AA           RFS Company ID
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV for RFS EPA Rpts  RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           COA Bio-dsl Fue
     C                     MOVEL*BLANK    YL0002           COA Producer Re
     C                     MOVEL*BLANK    YL0003           COA Employer ID
     C                     MOVEL*BLANK    YL0004           COA Sold From N
     C                     MOVEL*BLANK    YL0005           COA ULSD Compan
     C                     MOVEL*BLANK    YL0006           COA ULSD Facili
     C                     MOVEL*BLANK    YL0007           COA RIN Equival
     C                     MOVEL*BLANK    YL0008           COA RIN Renewab
     C                     MOVEL*BLANK    YL0009           COA RIN Type Fl
     C                     Z-ADD*ZERO     YL0010           COA Density Loa
     C                     Z-ADD*ZERO     YL0011           COA BOL Percent
     C                     MOVEL*BLANK    YL0012           COA RFS Renew F
     C                     MOVEL*BLANK    YL0013           COA RFS Rnwbl F
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAIDAA           COA Bio-diesel
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVE *BLANK    WAIDAA           COA Bio-diesel
     C                     MOVEL'B100'    WAIDAA           COA Bio-diesel
      * Establish starting position
     C           KRSSA     CHAIN@CAREOB              90    *
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAR2NA    YL0001           COA Bio-dsl Fue
     C                     MOVELWAL2T1    YL0002           COA Producer Re
     C                     MOVELWAL3T1    YL0003           COA Employer ID
     C                     MOVELWAL5T1    YL0004           COA Sold From N
     C                     MOVELWAL6T1    YL0005           COA ULSD Compan
     C                     MOVELWAL7T1    YL0006           COA ULSD Facili
     C                     MOVELWAL8T1    YL0007           COA RIN Equival
     C                     MOVELWAL9T1    YL0008           COA RIN Renewab
     C                     MOVELWAMAT1    YL0009           COA RIN Type Fl
     C                     Z-ADDWAJCNY    YL0010           COA Density Loa
     C                     Z-ADDWAGMPC    YL0011           COA BOL Percent
     C                     MOVELWAIMTX    YL0012           COA RFS Renew F
     C                     MOVELWAFEDS    YL0013           COA RFS Rnwbl F
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv RFS Act Rpt-GEN   RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2013 NEW to use the GEN EMTS Date instead of transaction date
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0006           RFS Cur RFS2 RI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WBTWDT           COA GEN EMTS Da
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     Z-ADDWL0002    WBTWDT           COA GEN EMTS Da
      * Establish starting position
     C           KPSSB     SETLL@DACPNI                    *
     C           KRSSB     READE@DACPNI                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.COA GEN EMTS Date Sent GE PAR.Date From
      *   |- c2    : DB1.COA GEN EMTS Date Sent LE PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBTWDT    IFGE WL0003                     *IF
     C           WBTWDT    IFLE WL0004                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WBR0NY    WL0006           RFS Cur RFS2 RI
     C                     END                             *FI
     C           KRSSB     READE@DACPNI                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv RFS Act Rpt-EMTS  RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2013 NEW to use the RIN EMTS Date instead of transaction date
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0012           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     WL0013           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     WL0014           RFS Cur RFS2 Gl
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WCTVDT           COA RIN EMTS Da
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDWL0007    WQSC01           Company Number
     C                     Z-ADDWL0008    WCTVDT           COA RIN EMTS Da
      * Establish starting position
     C           KPSSC     SETLL@DACPNJ                    *
     C           KRSSC     READE@DACPNJ                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.COA RIN EMTS Date Sent GE PAR.Date From
      *   |- c2    : DB1.COA RIN EMTS Date Sent LE PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCTVDT    IFGE WL0009                     *IF
     C           WCTVDT    IFLE WL0010                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FP1322 RMC 03/11/10  accum according to Assigned(1) /Separated St
      * CASE: PAR.RFS RIN Status EQ DB1.COA RIN Type Flag
     C           WL0011    IFEQ WCMAT1                     *IF
      * Accum into RFS1 or RFS2 buckets
      * CASE: DB1.COA BHR RFS Version Nbr is RFS 1
     C           WCJ1ST    IFEQ '1'                        *IF
      * rfs1 is obsolete
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.RFS Transaction Type is Sold or Delivered
     C           WCI7AA    IFEQ 'SEL'                      *IF
     C                     ADD  WCR0NY    WL0013           RFS Cur RFS2 Gl
     C                     ELSE
      * CASE: DB1.RFS Transaction Type is Retired
     C           WCI7AA    IFEQ 'RET'                      *IF
     C                     ADD  WCR0NY    WL0014           RFS Cur RFS2 Gl
     C                     ELSE
      * CASE: DB1.RFS Transaction Type is Buy
     C           WCI7AA    IFEQ 'BUY'                      *IF
     C                     ADD  WCR0NY    WL0012           RFS Cur RFS2 Gl
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@DACPNJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt RFS RIN Actvty Rpt CR - RFS RIN Activity Rpt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DRCPR9
     C                     MOVELWL0015    WDNWT1           RFS Report Form
     C                     MOVELWL0016    WDLTTX           RFS Report Type
     C                     MOVELWL0017    WDLUTX           RFS CBI
     C                     MOVELWL0018    WDNXT1           RFS Report Date
     C                     MOVELWL0019    WDNYT1           RFS Report Year
     C                     MOVELWL0020    WDI4AA           RFS Company ID
     C                     MOVELWL0021    WDNZT1           RFS Company Nam
     C                     MOVELWL0022    WDLVTX           RFS Compliance
     C                     MOVELWL0023    WDI5AA           RFS Compliance
     C                     MOVELWL0024    WDLXTX           RFS RIN Status
     C                     Z-ADDWL0025    WDK6NY           RFS Vol at End
     C                     Z-ADDWL0026    WDKZNY           RFS 2009 RFS1 R
     C                     Z-ADDWL0027    WDK7NY           RFS 2009 RFS1 R
     C                     Z-ADDWL0028    WDK8NY           RFS 2009 RFS1 R
     C                     Z-ADDWL0029    WDK9NY           RFS 2009 RFS1 R
     C                     Z-ADDWL0030    WDLANY           RFS 2009 RFS1 R
     C                     Z-ADDWL0031    WDLBNY           RFS 2010 RFS1 R
     C                     Z-ADDWL0032    WDLCNY           RFS 2010 RFS1 R
     C                     Z-ADDWL0033    WDLDNY           RFS 2010 RFS1 R
     C                     Z-ADDWL0034    WDLENY           RFS 2010 RFS1 R
     C                     Z-ADDWL0035    WDLFNY           RFS 2010 RFS1 R
     C                     Z-ADDWL0036    WDSDNY           RFS Cur RFS2 RI
     C                     Z-ADDWL0037    WDSENY           RFS Cur RFS2 Gl
     C                     Z-ADDWL0038    WDSFNY           RFS Cur RFS2 Gl
     C                     Z-ADDWL0039    WDSGNY           RFS Cur RFS2 Gl
     C                     Z-ADDWL0040    WDSHNY           RFS Cur RFS2 RI
     C                     Z-ADDWL0041    WDTLNY           RFS Cur RFS2 RI
     C                     Z-ADDWL0042    WDSINY           RFS 2008 RFS1 R
     C                     Z-ADDWL0043    WDSJNY           RFS 2008 RFS1 R
     C                     Z-ADDWL0044    WDSKNY           RFS 2008 RFS1 R
     C                     Z-ADDWL0045    WDSLNY           RFS 2008 RFS1 R
     C                     Z-ADDWL0046    WDSMNY           RFS 2008 RFS1 R
     C                     Z-ADDWL0047    WDSNNY           RFS 2009 RFS1 N
     C                     Z-ADDWL0048    WDSONY           RFS 2010 RFS1 N
      *
     C           KLCRSD    KLIST
     C                     KFLD           WDNWT1           RFS Report Form
     C                     KFLD           WDLTTX           RFS Report Type
     C                     KFLD           WDLUTX           RFS CBI
     C                     KFLD           WDNXT1           RFS Report Date
     C                     KFLD           WDNYT1           RFS Report Year
     C                     KFLD           WDI4AA           RFS Company ID
     C                     KFLD           WDNZT1           RFS Company Nam
     C                     KFLD           WDLVTX           RFS Compliance
     C                     KFLD           WDI5AA           RFS Compliance
      * Check for duplicate primary key
     C           KLCRSD    SETLL@DRCPR9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3920' W0RTN   7
      * Send message 'RFS RIN Activity Rpt   EX'
     C                     MOVEL'USR3920' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@DRCPR9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2NWT1           RFS Report Form
     C                     MOVEL*BLANK    P2LUTX           RFS CBI
     C                     MOVEL*BLANK    P2NXT1           RFS Report Date
     C                     MOVEL*BLANK    P2LXTX           RFS RIN Status
     C                     Z-ADD*ZERO     P2K6NY           RFS Vol at End
     C                     Z-ADD*ZERO     P2KZNY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     P2K7NY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     P2K8NY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     P2K9NY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     P2LANY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     P2LBNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     P2LCNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     P2LDNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     P2LENY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     P2LFNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     P2SDNY           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     P2SENY           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     P2SFNY           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     P2SGNY           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     P2SHNY           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     P2TLNY           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     P3JEDT           Date From
     C                     Z-ADD*ZERO     P4JFDT           Date To
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Month (Char) USR
     C                     MOVEL*BLANK    WUT5TX  2
      * Define work field Day (Alpha) USR
     C                     MOVEL*BLANK    WUT8TX  2
      * Define work field Year Code
     C                     Z-ADD*ZERO     WUAYNX  40
      * Define work field Year USR
     C                     MOVEL*BLANK    WUNYTX  4
      * Define work field Month MM/  3A
     C                     MOVEL*BLANK    WUN0TX  3
      * Define work field Day DD/  3A
     C                     MOVEL*BLANK    WUN1TX  3
      * Define work field Month/Day MM/DD/
     C                     MOVEL*BLANK    WUN2TX  6
      * Define work field Year Alpha (YY) USR
     C                     MOVEL*BLANK    WUUATX  2
      * Define work field Text 3 Length USR
     C                     MOVEL*BLANK    WUMLT1  3
      * Define work field Date From Alpha       USR
     C                     MOVEL*BLANK    WUV5CD  7
      * Define work field Date To Alpha         USR
     C                     MOVEL*BLANK    WUV6CD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WAJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WAJENY           COA Temperature
     C                     Z-ADD*ZERO     WAJFNY           COA Temperature
     C                     Z-ADD*ZERO     WAGMPC           COA BOL Percent
     C                     Z-ADD*ZERO     WAJQNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WAJRNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WAI1NY           Sold To Custome
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WBJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WBQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WBJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WBJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WBJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WBRIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WBC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WBRJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WBC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WBC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WBQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WBCWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WBQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WBQZNY           COA Reference B
     C                     Z-ADD*ZERO     WBQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WBTFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WBTGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WBQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WBR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WBR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WBR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WBHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WBHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WBR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WBR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WBTWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WBDUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WBTVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WBDTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WBR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WBSQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WBSRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WBT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WBSXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WBSYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WBSZNY           COA Unassgnd Tx
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDK6NY           RFS Vol at End
     C                     Z-ADD*ZERO     WDKZNY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     WDK7NY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     WDK8NY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     WDK9NY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     WDLANY           RFS 2009 RFS1 R
     C                     Z-ADD*ZERO     WDLBNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     WDLCNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     WDLDNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     WDLENY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     WDLFNY           RFS 2010 RFS1 R
     C                     Z-ADD*ZERO     WDSDNY           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     WDSENY           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     WDSFNY           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     WDSGNY           RFS Cur RFS2 Gl
     C                     Z-ADD*ZERO     WDSHNY           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     WDTLNY           RFS Cur RFS2 RI
     C                     Z-ADD*ZERO     WDSINY           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WDSJNY           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WDSKNY           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WDSLNY           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WDSMNY           RFS 2008 RFS1 R
     C                     Z-ADD*ZERO     WDSNNY           RFS 2009 RFS1 N
     C                     Z-ADD*ZERO     WDSONY           RFS 2010 RFS1 N
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  1
     C                     Z-ADD*ZERO     WL0006 120
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  90
     C                     Z-ADD*ZERO     WL0013  90
     C                     Z-ADD*ZERO     WL0014  90
      * Define local variables for subroutine SDCRRC.
     C                     MOVEL*BLANK    WL0015  7
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018 10
     C                     MOVEL*BLANK    WL0019  4
     C                     MOVEL*BLANK    WL0020  4
     C                     MOVEL*BLANK    WL0021 40
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  5
     C                     MOVEL*BLANK    WL0024  1
     C                     Z-ADD*ZERO     WL0025 120
     C                     Z-ADD*ZERO     WL0026 120
     C                     Z-ADD*ZERO     WL0027  90
     C                     Z-ADD*ZERO     WL0028  90
     C                     Z-ADD*ZERO     WL0029  90
     C                     Z-ADD*ZERO     WL0030  90
     C                     Z-ADD*ZERO     WL0031  90
     C                     Z-ADD*ZERO     WL0032  90
     C                     Z-ADD*ZERO     WL0033  90
     C                     Z-ADD*ZERO     WL0034  90
     C                     Z-ADD*ZERO     WL0035  90
     C                     Z-ADD*ZERO     WL0036  90
     C                     Z-ADD*ZERO     WL0037  90
     C                     Z-ADD*ZERO     WL0038  90
     C                     Z-ADD*ZERO     WL0039  90
     C                     Z-ADD*ZERO     WL0040  90
     C                     Z-ADD*ZERO     WL0041 120
     C                     Z-ADD*ZERO     WL0042  90
     C                     Z-ADD*ZERO     WL0043  90
     C                     Z-ADD*ZERO     WL0044  90
     C                     Z-ADD*ZERO     WL0045  90
     C                     Z-ADD*ZERO     WL0046  90
     C                     Z-ADD*ZERO     WL0047  90
     C                     Z-ADD*ZERO     WL0048  90
      * Define local work field COA Bio-dsl Fuel Cd Descr
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field COA Producer Regist Nbr
     C                     MOVEL*BLANK    YL0002 25
      * Define local work field COA Employer ID
     C                     MOVEL*BLANK    YL0003 20
      * Define local work field COA Sold From Name
     C                     MOVEL*BLANK    YL0004 40
      * Define local work field COA ULSD Company #
     C                     MOVEL*BLANK    YL0005  4
      * Define local work field COA ULSD Facility #
     C                     MOVEL*BLANK    YL0006  5
      * Define local work field COA RIN Equivalence Valu
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field COA RIN Renewable Enrgy
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field COA RIN Type Flag
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0010  75
      * Define local work field COA BOL Percent
     C                     Z-ADD*ZERO     YL0011  41
      * Define local work field COA RFS Renew Fuel Code
     C                     MOVEL*BLANK    YL0012  3
      * Define local work field COA RFS Rnwbl Feedstock
     C                     MOVEL*BLANK    YL0013  3
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 St Joseph Marketing
