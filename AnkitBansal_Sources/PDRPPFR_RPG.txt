     H/TITLE Prt Inv/Ordr for S/Whs PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:13:36
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKLREL2IF  E           K        DISK
      * RSQ : Company Item Avail Group  Co/Group/Item
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDKKREL1IF  E           K        DISK
      * RTV : Availability Group        Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBGWKLUIF  E           K        DISK
      * RSQ : Order Detail              Co/Itm/SSD/Shp/Whs/Ord+
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAB0RELCIF  E           K        DISK
      * RSQ : Item Balance              Co/Whse/Item
      *
     FPDL5CPL8IF  E           K        DISK
      * RSQ : Item Lot Location         Co/Whs/Itm/ASD(d)/LtLcLv
      *
     FPDRPPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Inv/Ordr for S/Whs PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    YDOW        7  1               *Days of week
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item Avail Group
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Availability Group Code
     I                                        3   5 P1V4CD
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Report Type USR
     I                                        1   1 P2QBST
      * I :  Warehouse Code
     I                                        2   4 P2AJCD
      * I :  USR Warehouse Code
     I                                        5   7 P2CPCD
      * I :  Date From             USR
     I                                    P   8  110P2JEDT
      * I :  Date To               USR
     I                                    P  12  150P2JFDT
      * N :  USR Day 1
     I                                    P  16  190P2FFDT
      * N :  USR Day 2
     I                                    P  20  230P2E1DT
      * N :  USR Day 3
     I                                    P  24  270P2E2DT
      * N :  USR Day 4
     I                                    P  28  310P2E3DT
      * N :  USR Day 5
     I                                    P  32  350P2E4DT
     IP3PARM      DS
      * I :  Single Whs/Comparison
     I                                        1   1 P3EBSX
     IP4PARM      DS
      * FLD: Warehouse
      * N :  Lot Tracking Flag
     I                                        1   1 P4VHST
     IP5PARM      DS
      * I :  Report Type(Daily/Weekly)
     I                                        1   1 P5BGTX
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1V4CD    PARM           WP0002  3        Availability Gr
     C           P2QBST    PARM           WP0003  1        Report Type USR
     C           P2AJCD    PARM           WP0004  3        Warehouse Code
     C           P2CPCD    PARM           WP0005  3        USR Warehouse C
     C           P2JEDT    PARM           WP0006  70       Date From
     C           P2JFDT    PARM           WP0007  70       Date To
     C           P3EBSX    PARM           WP0008  1        Single Whs/Comp
     C           P5BGTX    PARM           WP0009  1        Report Type(Dai
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Inv/Ordr for S/Whs PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$KENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Inv/Ordr for S/Whs PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN KLAIC3    WQKA01           Company Number
     C           *LIKE     DEFN KLV4CD    WQKA02           Availability Gr
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Availability Gr
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
     C                     MOVELP1V4CD    WQKA02           Availability Gr
      * Establish starting position
     C           KRSA      SETLL@KLREHI                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Availability Gr
     C                     MOVEL'Y'       W0AL02  1        Item Display Se
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $BAIC3           Company Number
     C                     MOVEL*BLANK    $BADTX           Name
     C                     Z-ADD*ZERO     $BJEDT           Date From
     C                     Z-ADD*ZERO     $BJFDT           Date To
     C                     MOVEL*BLANK    $BV4CD           Availability Gr
     C                     MOVEL*BLANK    $BNVNA           Availability Gr
     C                     MOVEL*BLANK    $BQBST           Report Type USR
     C                     MOVEL*BLANK    $BGUTX           Condition Name
     C                     MOVEL*BLANK    $BAJCD           Warehouse Code
     C                     MOVEL*BLANK    $BF8NA           Warehouse Descr
     C                     MOVEL*BLANK    $BEBSX           Single Whs/Comp
     C                     MOVEL*BLANK    $BSLTX           Text USR 20
     C                     MOVEL*BLANK    $BBGTX           Report Type(Dai
     C                     MOVEL*BLANK    $BHLTX           Condition Desc.
     C                     MOVEL*BLANK    $BCPCD           USR Warehouse C
     C                     MOVEL*BLANK    $BAUNA           Description
      * Load related totals format
     C                     Z-ADD*ZERO     $JSLQN           Quantity Loc On
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDKLAIC3    $CAIC3           Company Number
     C                     Z-ADD*ZERO     $CFFDT           USR Day 1
     C                     Z-ADD*ZERO     $CE1DT           USR Day 2
     C                     Z-ADD*ZERO     $CE2DT           USR Day 3
     C                     Z-ADD*ZERO     $CE3DT           USR Day 4
     C                     Z-ADD*ZERO     $CE4DT           USR Day 5
     C                     MOVEL*BLANK    $CZ4CD           Warehouse 11 US
     C                     MOVEL*BLANK    $CZ2CD           Warehouse 9 USR
     C                     MOVEL*BLANK    $CZ3CD           Warehouse 10 US
     C                     MOVEL*BLANK    $CSTTX           USR Text 7
     C                     MOVEL*BLANK    $CZ6CD           Warehouse 13 US
     C                     MOVEL*BLANK    $CZ7CD           Warehouse 14 US
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDKLAIC3    $IAIC3           Company Number
     C                     Z-ADDKLHGCD    $IHGCD           Item Code
     C                     MOVEL*BLANK    $IOONA           Item Desc DRV
     C                     Z-ADD*ZERO     $IIRQT           Quantity Ordere
     C                     Z-ADD*ZERO     $IQS01           Quantity Schedu
     C                     Z-ADD*ZERO     $IQTO1           Quantity Ordere
     C                     Z-ADD*ZERO     $IQS02           Quantity Schedu
     C                     Z-ADD*ZERO     $IQT02           Quantity Ordere
     C                     Z-ADD*ZERO     $IQS03           Quantity Schedu
     C                     Z-ADD*ZERO     $IQT03           Quantity Ordere
     C                     Z-ADD*ZERO     $IQS04           Quantity Schedu
     C                     Z-ADD*ZERO     $IQT05           Quantity Ordere
     C                     Z-ADD*ZERO     $IQS05           Quantity Schedu
     C                     Z-ADD*ZERO     $IASNX           Quantity Sched
     C                     Z-ADD*ZERO     $IAQNX           Quantity On-Han
     C                     Z-ADD*ZERO     $IODNB           Number Value -
     C                     Z-ADD*ZERO     $IQLTX           Quantity Loc Tr
     C                     Z-ADD*ZERO     $IATNX           Quantity Sched
     C                     Z-ADD*ZERO     $IARNX           Quantity On-Han
     C                     Z-ADD*ZERO     $ITVNB           Calc 7
     C                     MOVELKLV4CD    $IV4CD           Availability Gr
     C                     Z-ADDKLIDSQ    $IIDSQ           Item Display Se
     C                     MOVELKLUVST    $IUVST           EDI Status 1
     C                     MOVELKLUWST    $IUWST           EDI Status 2
     C                     MOVELKLUXST    $IUXST           EDI Status 3
     C                     MOVELKLVSST    $IVSST           Record Status
     C                     Z-ADDKLAATM    $IAATM           Job Time
     C                     MOVELKLAYNA    $IAYNA           User Id
     C                     MOVELKLA0NA    $IA0NA           Job Name
     C                     Z-ADDKLAXDT    $IAXDT           Job Date
      * PRTOBJ calls before print of detail format
      * Embedded PRTOBJ : Prt Inv/Ordr for S/Whs PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $IAQNX    $JSLQN           Quantity Loc On
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KLAIC3    WZA001           Company Number
     C                     Z-ADDKLAIC3    WZA001
     C           *LIKE     DEFN KLV4CD    WZA002           Availability Gr
     C                     MOVELKLV4CD    WZA002
     C           *LIKE     DEFN KLIDSQ    WZA003           Item Display Se
     C                     Z-ADDKLIDSQ    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@KLREHI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Availability Gr
     C                     MOVEL*BLANK    W0AL02  1        Item Display Se
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Availability Gr
     C                     MOVEL'Y'       W0AL02  1        Item Display Se
     C                     ELSE
      * Next record - Detect level breaks
     C           KLAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           KLV4CD    IFNE WZA002                     Availability Gr
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           KLIDSQ    IFNE WZA003                     Item Display Se
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Inv/Ordr for S/Whs PO: Mainline
      *================================================================
      * Prt Inv/Ordr for S/Whs PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQKB01           Company Number
     C           *LIKE     DEFN OMHGCD    WQKB02           Item Code
      * Define keylist
     C           KPSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Item Code
     C                     KFLD           OMAODT           Scheduled Ship
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Item Code
      * Setup key
     C                     Z-ADD$IAIC3    WQKB01           Company Number
     C                     Z-ADD$IHGCD    WQKB02           Item Code
     C                     Z-ADDP2JEDT    OMAODT           Scheduled Ship
      * Establish starting position
     C           KPSB      SETLL@BGWKW6                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Item Code
     C                     MOVEL'Y'       W0BL02  1        Scheduled Ship
     C                     MOVEL'Y'       W0BL03  1        Ship To Custome
     C                     MOVEL'Y'       W0BL04  1        Warehouse Code
     C                     MOVEL'Y'       W0BL05  1        Order Number
     C                     MOVEL'Y'       W0BL06  1        Order Sequence
     C                     MOVEL'Y'       W0BL07  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDOMAIC3    $HAIC3           Company Number
     C                     Z-ADDOMHGCD    $HHGCD           Item Code
     C                     Z-ADD*ZERO     $HM0VI           Quantity Ordere
     C                     Z-ADD*ZERO     $HM00I           Quantity Schedu
     C                     Z-ADD*ZERO     $HMVII           Quantity Ordere
     C                     Z-ADD*ZERO     $HM0II           Quantity Schedu
     C                     Z-ADD*ZERO     $HM008           Quantity Ordere
     C                     Z-ADD*ZERO     $HMIII           Quantity Schedu
     C                     Z-ADD*ZERO     $HM0IX           Quantity Ordere
     C                     Z-ADD*ZERO     $HM0IV           Quantity Schedu
     C                     Z-ADD*ZERO     $HM00X           Quantity Ordere
     C                     Z-ADD*ZERO     $HM00V           Quantity Schedu
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $GM00V           Quantity Schedu
     C                     Z-ADD*ZERO     $GM0IV           Quantity Schedu
     C                     Z-ADD*ZERO     $GMIII           Quantity Schedu
     C                     Z-ADD*ZERO     $GM0II           Quantity Schedu
     C                     Z-ADD*ZERO     $GM00I           Quantity Schedu
     C                     Z-ADD*ZERO     $GM00X           Quantity Ordere
     C                     Z-ADD*ZERO     $GM0IX           Quantity Ordere
     C                     Z-ADD*ZERO     $GM008           Quantity Ordere
     C                     Z-ADD*ZERO     $GMVII           Quantity Ordere
     C                     Z-ADD*ZERO     $GM0VI           Quantity Ordere
     C                     Z-ADDOMAIC3    $GAIC3           Company Number
     C                     Z-ADDOMHGCD    $GHGCD           Item Code
     C                     Z-ADDOMAODT    $GAODT           Scheduled Ship
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $FM00V           Quantity Schedu
     C                     Z-ADD*ZERO     $FM0IV           Quantity Schedu
     C                     Z-ADD*ZERO     $FMIII           Quantity Schedu
     C                     Z-ADD*ZERO     $FM0II           Quantity Schedu
     C                     Z-ADD*ZERO     $FM00I           Quantity Schedu
     C                     Z-ADD*ZERO     $FM0IX           Quantity Ordere
     C                     Z-ADD*ZERO     $FM008           Quantity Ordere
     C                     Z-ADD*ZERO     $FMVII           Quantity Ordere
     C                     Z-ADD*ZERO     $FM0VI           Quantity Ordere
     C                     Z-ADD*ZERO     $FM00X           Quantity Ordere
     C                     Z-ADDOMAIC3    $FAIC3           Company Number
     C                     Z-ADDOMC4NB    $FC4NB           Order Number
     C                     Z-ADDOMHGCD    $FHGCD           Item Code
     C                     Z-ADDOMAODT    $FAODT           Scheduled Ship
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
     C           W0BL06    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $EM00V           Quantity Schedu
     C                     Z-ADD*ZERO     $EM0IV           Quantity Schedu
     C                     Z-ADD*ZERO     $EMIII           Quantity Schedu
     C                     Z-ADD*ZERO     $EM0II           Quantity Schedu
     C                     Z-ADD*ZERO     $EM00I           Quantity Schedu
     C                     Z-ADD*ZERO     $EM00X           Quantity Ordere
     C                     Z-ADD*ZERO     $EM0IX           Quantity Ordere
     C                     Z-ADD*ZERO     $EM008           Quantity Ordere
     C                     Z-ADD*ZERO     $EMVII           Quantity Ordere
     C                     Z-ADD*ZERO     $EM0VI           Quantity Ordere
     C                     Z-ADDOMAIC3    $EAIC3           Company Number
     C                     Z-ADDOMC4NB    $EC4NB           Order Number
     C                     Z-ADDOMDPNB    $EDPNB           Order Sequence
     C                     Z-ADDOMHGCD    $EHGCD           Item Code
     C                     Z-ADDOMAODT    $EAODT           Scheduled Ship
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP06  1
     C                     END
      *
     C           W0BL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP07  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDOMAIC3    $DAIC3           Company Number
     C                     Z-ADDOMHGCD    $DHGCD           Item Code
     C                     MOVEL*BLANK    $DG5TX           Text 1 USR
     C                     MOVEL*BLANK    $DOONA           Item Desc DRV
     C                     Z-ADD*ZERO     $DRMNB           Load ID
     C                     Z-ADDOMC4NB    $DC4NB           Order Number
     C                     Z-ADDOMDPNB    $DDPNB           Order Sequence
     C                     Z-ADDOMUENB    $DUENB           Order Secondary
     C                     MOVELOMAJCD    $DAJCD           Warehouse Code
     C                     Z-ADDOMBKC7    $DBKC7           Ship To Custome
     C                     MOVEL*BLANK    $DG6TX           Text 2 USR
     C                     MOVEL*BLANK    $DBRTX           Ship To Name
     C                     Z-ADDOMCFC7    $DCFC7           Order Group Cod
     C                     MOVELOMGMST    $DGMST           Detail Line Sta
     C                     MOVELOMGNST    $DGNST           Detail Line Sta
     C                     Z-ADDOMMAVA    $DMAVA           Billing Detail
     C                     Z-ADDOMKDVA    $DKDVA           Billing Detail
     C                     Z-ADDOML8VA    $DL8VA           Billing Detail
     C                     Z-ADDOML9VA    $DL9VA           Quantity to Sub
     C                     MOVELOMGTST    $DGTST           Comment Print A
     C                     MOVELOMGVST    $DGVST           Comment Print I
     C                     MOVELOMGUST    $DGUST           Comment Print P
     C                     MOVELOMQFST    $DQFST           Comment Print S
     C                     Z-ADDOMAYVA    $DAYVA           Extended Amount
     C                     Z-ADDOMEXDT    $DEXDT           Market Pricing
     C                     MOVELOMLQCD    $DLQCD           Commodity Marke
     C                     MOVELOMRDCD    $DRDCD           Date Method Cod
     C                     MOVELOMQ7CD    $DQ7CD           Price Method Co
     C                     Z-ADDOMBZPR    $DBZPR           Price Overage O
     C                     Z-ADDOML6NB    $DL6NB           Contract Number
     C                     MOVELOMU1ST    $DU1ST           Price Status
     C                     Z-ADDOMGIDT    $DGIDT           Pricing Date Us
     C                     MOVELOMCRCD    $DCRCD           U/M - Base Pric
     C                     MOVELOMAGCD    $DAGCD           U/M - Ordered
     C                     MOVELOMRZST    $DRZST           Work Confirm St
     C                     MOVELOMR0ST    $DR0ST           Work Over/Short
     C                     MOVELOMR1ST    $DR1ST           OD Production P
     C                     MOVELOMG7NA    $DG7NA           Order Desc. Lin
     C                     MOVELOMG8NA    $DG8NA           Order Desc. Lin
     C                     MOVELOMRPCD    $DRPCD           Age Code
     C                     MOVELOMVEST    $DVEST           Palletize
     C                     MOVELOMVGST    $DVGST           Slip Sheet
     C                     MOVELOMAVST    $DAVST           Catch Weight St
     C                     MOVELOMU0ST    $DU0ST           Price Audit
     C                     MOVELOMRFCD    $DRFCD           Price Audit Rea
     C                     MOVELOMFZST    $DFZST           Production Date
     C                     Z-ADDOMR1NB    $DR1NB           Rated Freight
     C                     Z-ADDOMAVQT    $DAVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    $DD0WG           Weight Ordered
     C                     Z-ADDOMCCQT    $DCCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    $DAUWG           Weight Schedule
     C                     Z-ADDOMCBQT    $DCBQT           Quantity Shippe
     C                     Z-ADDOMATWG    $DATWG           Weight Shipped
     C                     Z-ADDOMAQCS    $DAQCS           Unit Cost Prici
     C                     Z-ADDOMAGCS    $DAGCS           Unit Cost Per P
     C                     Z-ADDOMALPR    $DALPR           Unit Price - Cr
     C                     Z-ADDOMAUPR    $DAUPR           Unit Price Orde
     C                     Z-ADDOMAVWG    $DAVWG           Unit Weight Ord
     C                     Z-ADDOMA4WG    $DA4WG           Tare Weight Tot
     C                     Z-ADDOMA5DT    $DA5DT           Requested Ship
     C                     Z-ADDOMAODT    $DAODT           Scheduled Ship
     C                     Z-ADD*ZERO     $DIRQT           Quantity Ordere
     C                     Z-ADD*ZERO     $DQTO1           Quantity Ordere
     C                     Z-ADD*ZERO     $DQT02           Quantity Ordere
     C                     Z-ADD*ZERO     $DQT03           Quantity Ordere
     C                     Z-ADD*ZERO     $DQT05           Quantity Ordere
     C                     Z-ADD*ZERO     $DQS05           Quantity Schedu
     C                     Z-ADDOMGNDT    $DGNDT           Actual Shipped
     C                     MOVELOMAMST    $DAMST           Affect Inventor
     C                     MOVELOMANST    $DANST           Affect Sales Do
     C                     MOVELOMVAST    $DVAST           Affect Sales Pn
     C                     Z-ADDOMRGNB    $DRGNB           Item Structure
     C                     Z-ADDOMRHNB    $DRHNB           Item Structure
     C                     Z-ADDOMRINB    $DRINB           Item Structure
     C                     MOVELOMRBCD    $DRBCD           Item Level
     C                     MOVELOMHICD    $DHICD           Quality Level
     C                     MOVELOMRNCD    $DRNCD           Pricing Product
     C                     MOVELOMROCD    $DROCD           Season Product
     C                     Z-ADDOMCXDT    $DCXDT           Date of Origina
     C                     MOVELOMAJVN    $DAJVN           User Profile Na
     C                     MOVELOMKXCD    $DKXCD           Country Code
     C                     MOVELOMJPCD    $DJPCD           Event Code
     C                     MOVELOMCQCD    $DCQCD           Reason Code
     C                     MOVELOMR4CD    $DR4CD           Sales Route Cod
     C                     MOVELOMZ1ST    $DZ1ST           Modified Flag
     C                     MOVELOMZ3ST    $DZ3ST           Substituted Fla
     C                     MOVELOMZ4ST    $DZ4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    $DDUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    $DB6VL           Invoice Extende
     C                     Z-ADDOMA1AA    $DA1AA           Ham Group Numbe
     C                     MOVELOMFZSX    $DFZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    $DF0SX           Affect Trade Fu
     C                     MOVELOMF1SX    $DF1SX           Affect Commissi
     C                     MOVELOMF2SX    $DF2SX           Affect Pricing
     C                     MOVELOMF3SX    $DF3SX           Released by Use
     C                     MOVELOMF4SX    $DF4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    $DF5SX           OD Pallet Type
     C                     MOVELOMF6SX    $DF6SX           Production Ware
     C                     MOVELOMF7SX    $DF7SX           OD Price Type
     C                     Z-ADDOMNTDT    $DNTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    $DNUDT           Consumed Item C
     C                     Z-ADDOMNVDT    $DNVDT           Deadline Depart
     C                     Z-ADDOMNWDT    $DNWDT           OD Price Type R
     C                     Z-ADDOMNXDT    $DNXDT           OD Unused Date
     C                     Z-ADDOMBUTM    $DBUTM           Deadline Depart
     C                     Z-ADDOMBVTM    $DBVTM           Price Code
     C                     Z-ADDOMBWTM    $DBWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    $DBXTM           Substitution Li
     C                     Z-ADDOMBYTM    $DBYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    $DH5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    $DH6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    $DH7NX           OD Item Target
     C                     Z-ADDOMH8NX    $DH8NX           OD Minimum Unit
     C                     Z-ADDOMH9NX    $DH9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    $DDVPR           Order Gate Pric
     C                     Z-ADDOMDWPR    $DDWPR           OD Base MKT Ovr
     C                     Z-ADDOMDXPR    $DDXPR           OD Unused Prc 3
     C                     Z-ADDOMDYPR    $DDYPR           OD Unused Prc 4
     C                     Z-ADDOMDZPR    $DDZPR           OD Unused Prc 5
     C                     Z-ADDOMGSPR    $DGSPR           OD Unused Prc 6
     C                     Z-ADDOMGTPR    $DGTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    $DGUPR           OD Unused Prc 8
     C                     MOVELOMHOST    $DHOST           OD UnUsed Price
     C                     MOVELOMHPST    $DHPST           OD UnUsed Price
     C                     MOVELOMIOST    $DIOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    $DPEWG           Weight Amount E
     C                     Z-ADDOMRINY    $DRINY           Delv Ageing Day
     C                     Z-ADDOMTIDT    $DTIDT           Production Ovr
     C                     Z-ADDOMTJDT    $DTJDT           Production Ovr
     C                     MOVELOMH2ST    $DH2ST           OD UnUsed Statu
     C                     MOVELOMH0ST    $DH0ST           OD UnUsed Statu
     C                     MOVELOMH1ST    $DH1ST           OD UnUsed Statu
     C                     Z-ADDOMTKDT    $DTKDT           OD UnUsed Date
     C                     Z-ADDOMTLDT    $DTLDT           OD UnUsed Date
     C                     Z-ADDOMTMDT    $DTMDT           OD UnUsed Date
     C                     MOVELOMUVST    $DUVST           EDI Status 1
     C                     MOVELOMUWST    $DUWST           EDI Status 2
     C                     MOVELOMUXST    $DUXST           EDI Status 3
     C                     Z-ADDOMAATM    $DAATM           Job Time
     C                     MOVELOMAYNA    $DAYNA           User Id
     C                     MOVELOMA0NA    $DA0NA           Job Name
     C                     Z-ADDOMAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $DIRQT    $EM0VI           Quantity Ordere
     C                     ADD  $DQTO1    $EMVII           Quantity Ordere
     C                     ADD  $DQT02    $EM008           Quantity Ordere
     C                     ADD  $DQT03    $EM0IX           Quantity Ordere
     C                     ADD  $DQT05    $EM00X           Quantity Ordere
     C                     ADD  $DQS05    $EM00V           Quantity Schedu
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN OMAIC3    WZB001           Company Number
     C                     Z-ADDOMAIC3    WZB001
     C           *LIKE     DEFN OMHGCD    WZB002           Item Code
     C                     Z-ADDOMHGCD    WZB002
     C           *LIKE     DEFN OMAODT    WZB003           Scheduled Ship
     C                     Z-ADDOMAODT    WZB003
     C           *LIKE     DEFN OMBKC7    WZB004           Ship To Custome
     C                     Z-ADDOMBKC7    WZB004
     C           *LIKE     DEFN OMAJCD    WZB005           Warehouse Code
     C                     MOVELOMAJCD    WZB005
     C           *LIKE     DEFN OMC4NB    WZB006           Order Number
     C                     Z-ADDOMC4NB    WZB006
     C           *LIKE     DEFN OMDPNB    WZB007           Order Sequence
     C                     Z-ADDOMDPNB    WZB007
     C           *LIKE     DEFN OMUENB    WZB008           Order Secondary
     C                     Z-ADDOMUENB    WZB008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BGWKW6                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * EOF
      * CASE:
      *  - c1 ANDc2
      *   |- c1    : DB1.Scheduled Ship Date GT PAR.Date To
      *   |- c2    : PAR.Report Type(Daily/Weekly) is Daily
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMAODT    IFGT P2JFDT                     *IF
     C           P5BGTX    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SET End of File 'B'    US - /UT User Source  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE 'B'
     C                     END                             *FI
      * EOF
      * CASE:
      *  - c1 ANDc2
      *   |- c1    : DB1.Scheduled Ship Date GT PAR.USR Day 4
      *   |- c2    : PAR.Report Type(Daily/Weekly) is Weekly
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMAODT    IFGT P2E3DT                     *IF
     C           P5BGTX    IFEQ '2'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SET End of File 'B'    US - /UT User Source  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE 'B'
     C                     END                             *FI
      * SEL:  Warehouse Code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Warehouse Code EQ DB1.Warehouse Code
      *   |- c2    : PAR.USR Warehouse Code EQ DB1.Warehouse Code
      *   '-
     C           P2AJCD    IFEQ OMAJCD                     *IF
     C           P2CPCD    OREQ OMAJCD                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Header Status is Not Comp/Canc/Conf
      *   |- c2    : LCL.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'L'                        *IF
     C           YL0001    OREQ 'A'
     C           YL0001    OREQ 'E'
     C           YL0001    OREQ 'H'
     C           YL0002    IFEQ '1'                        *IF
     C           YL0002    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Item Code
     C                     MOVEL*BLANK    W0BL02  1        Scheduled Ship
     C                     MOVEL*BLANK    W0BL03  1        Ship To Custome
     C                     MOVEL*BLANK    W0BL04  1        Warehouse Code
     C                     MOVEL*BLANK    W0BL05  1        Order Number
     C                     MOVEL*BLANK    W0BL06  1        Order Sequence
     C                     MOVEL*BLANK    W0BL07  1        Order Secondary
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Item Code
     C                     MOVEL'Y'       W0BL02  1        Scheduled Ship
     C                     MOVEL'Y'       W0BL03  1        Ship To Custome
     C                     MOVEL'Y'       W0BL04  1        Warehouse Code
     C                     MOVEL'Y'       W0BL05  1        Order Number
     C                     MOVEL'Y'       W0BL06  1        Order Sequence
     C                     MOVEL'Y'       W0BL07  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           OMAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           OMHGCD    IFNE WZB002                     Item Code
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           OMAODT    IFNE WZB003                     Scheduled Ship
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           OMBKC7    IFNE WZB004                     Ship To Custome
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           OMAJCD    IFNE WZB005                     Warehouse Code
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           OMC4NB    IFNE WZB006                     Order Number
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C           OMDPNB    IFNE WZB007                     Order Sequence
     C           W0BL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL06
     C                     END
     C           OMUENB    IFNE WZB008                     Order Secondary
     C           W0BL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL07
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP07
     C                     END
      *
     C           W0BL06    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$EKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP06
      * USER: Process after print of Order Sequence Number format
     C                     ADD  $EM0VI    $FM0VI           Quantity Ordere
     C                     ADD  $EMVII    $FMVII           Quantity Ordere
     C                     ADD  $EM008    $FM008           Quantity Ordere
     C                     ADD  $EM0IX    $FM0IX           Quantity Ordere
     C                     ADD  $EM00X    $FM00X           Quantity Ordere
     C                     ADD  $EM00I    $FM00I           Quantity Schedu
     C                     ADD  $EM0II    $FM0II           Quantity Schedu
     C                     ADD  $EMIII    $FMIII           Quantity Schedu
     C                     ADD  $EM0IV    $FM0IV           Quantity Schedu
     C                     ADD  $EM00V    $FM00V           Quantity Schedu
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$FKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
      * USER: Process after print of Order Number format
     C                     ADD  $FM0VI    $GM0VI           Quantity Ordere
     C                     ADD  $FMVII    $GMVII           Quantity Ordere
     C                     ADD  $FM008    $GM008           Quantity Ordere
     C                     ADD  $FM0IX    $GM0IX           Quantity Ordere
     C                     ADD  $FM00X    $GM00X           Quantity Ordere
     C                     ADD  $FM00I    $GM00I           Quantity Schedu
     C                     ADD  $FM0II    $GM0II           Quantity Schedu
     C                     ADD  $FMIII    $GMIII           Quantity Schedu
     C                     ADD  $FM0IV    $GM0IV           Quantity Schedu
     C                     ADD  $FM00V    $GM00V           Quantity Schedu
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$GKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
      * USER: Process after print of Scheduled Ship Date format
     C                     ADD  $GM0VI    $HM0VI           Quantity Ordere
     C                     ADD  $GMVII    $HMVII           Quantity Ordere
     C                     ADD  $GM008    $HM008           Quantity Ordere
     C                     ADD  $GM0IX    $HM0IX           Quantity Ordere
     C                     ADD  $GM00X    $HM00X           Quantity Ordere
     C                     ADD  $GM00I    $HM00I           Quantity Schedu
     C                     ADD  $GM0II    $HM0II           Quantity Schedu
     C                     ADD  $GMIII    $HMIII           Quantity Schedu
     C                     ADD  $GM0IV    $HM0IV           Quantity Schedu
     C                     ADD  $GM00V    $HM00V           Quantity Schedu
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * USER: On print of Item Code format
     C                     Z-ADD$HM0VI    $IIRQT           Quantity Ordere
     C                     Z-ADD$HM00I    $IQS01           Quantity Schedu
     C                     Z-ADD$HMVII    $IQTO1           Quantity Ordere
     C                     Z-ADD$HM0II    $IQS02           Quantity Schedu
     C                     Z-ADD$HM008    $IQT02           Quantity Ordere
     C                     Z-ADD$HMIII    $IQS03           Quantity Schedu
     C                     Z-ADD$HM0IX    $IQT03           Quantity Ordere
     C                     Z-ADD$HM0IV    $IQS04           Quantity Schedu
     C                     Z-ADD$HM00X    $IQT05           Quantity Ordere
     C                     Z-ADD$HM00V    $IQS05           Quantity Schedu
      * Mention hidden format
     C   99N99             WRITE$HKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Inv/Ordr for S/Whs PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Inv/Ordr for S/Whs PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     Z-ADDP2JEDT    $BJEDT           Date From
     C                     Z-ADDP2JFDT    $BJFDT           Date To
     C                     MOVELP1V4CD    $BV4CD           Availability Gr
     C                     MOVELP2QBST    $BQBST           Report Type USR
     C                     MOVELP2AJCD    $BAJCD           Warehouse Code
     C                     MOVELP3EBSX    $BEBSX           Single Whs/Comp
     C                     MOVELP5BGTX    $BBGTX           Report Type(Dai
     C                     MOVELP2CPCD    $BCPCD           USR Warehouse C
      * Calc Day Heading Dates    -- moved here from level headings 01/30
      * CASE: PAR.Report Type(Daily/Weekly) is Daily
     C           P5BGTX    IFEQ '1'                        *IF
     C                     Z-ADDP2JEDT    P2FFDT           USR Day 1
      * PAR.USR Day 2 = PAR.USR Day 1 + CON.1 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E1DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E1DT
     C                     END
      * PAR.USR Day 3 = PAR.USR Day 1 + CON.2 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD2         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E2DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E2DT
     C                     END
      * PAR.USR Day 4 = PAR.USR Day 1 + CON.3 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD3         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E3DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E3DT
     C                     END
      * PAR.USR Day 5 = PAR.USR Day 1 + CON.4 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD4         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E4DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E4DT
     C                     END
     C                     ELSE
      * CASE: PAR.Report Type(Daily/Weekly) is Weekly
     C           P5BGTX    IFEQ '2'                        *IF
      * RTV Next Saturday      RT - Calendar  * 
     C                     EXSR SCRVGN
      * PAR.USR Day 2 = PAR.USR Day 1 + CON.7 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E1DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E1DT
     C                     END
      * PAR.USR Day 3 = PAR.USR Day 1 + CON.14 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD14        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E2DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E2DT
     C                     END
      * PAR.USR Day 4 = PAR.USR Day 1 + CON.21 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD21        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E3DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E3DT
     C                     END
      * PAR.USR Day 5 = PAR.USR Day 1 + CON.28 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD28        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E4DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E4DT
     C                     END
     C                     Z-ADDP2E3DT    $BJFDT           Date To
     C                     END                             *FI
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
      * 1PG.Condition Name USR = Condition name of 1PG.Report Type USR
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1456722   Y2LSNO  70       List number
     C                     PARM $BQBST    W0INVL 25        Report Type USR
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BGUTX    PARM           W0CNNM 25        Condition Name
      *
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$BAJCD    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BF8NA    P      Warehouse Descr
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$BCPCD    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BAUNA    P      Warehouse Descr
      * RTV Group Description  RT - Availability Group  * 
     C                     EXSR SFRVGN
      * 1PG.Text USR 20 = Condition name of 1PG.Single Whs/Comparison
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1537485   Y2LSNO  70       List number
     C                     PARM $BEBSX    W0INVL 25        Single Whs/Comp
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BSLTX    PARM           W0CNNM 25        Text USR 20
      *
      * 1PG.Condition Desc. 1  USR = Condition name of 1PG.Report Type(Da
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1808378   Y2LSNO  70       List number
     C                     PARM $BBGTX    W0INVL 25        Report Type(Dai
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Date From             USR to display format
      * Convert date
     C           1000000   ADD  $BJEDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBJEDT
      * Convert Date To               USR to display format
      * Convert date
     C           1000000   ADD  $BJFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBJFDT
      * Print format
     C                     WRITE$B1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Inv/Ordr for S/Whs PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Company Number format
      * CUR = PAR By name
     C                     Z-ADDP1AIC3    $CAIC3           Company Number
     C                     Z-ADDP2FFDT    $CFFDT           USR Day 1
     C                     Z-ADDP2E1DT    $CE1DT           USR Day 2
     C                     Z-ADDP2E2DT    $CE2DT           USR Day 3
     C                     Z-ADDP2E3DT    $CE3DT           USR Day 4
     C                     Z-ADDP2E4DT    $CE4DT           USR Day 5
     C                     MOVELP2AJCD    $CZ4CD           Warehouse 11 US
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SGRVGN
      * CASE: PAR.Lot Tracking Flag is yes
     C           P4VHST    IFEQ 'Y'                        *IF
      * RMC PFS019 8/21/06 show on hand form item bal instead of lot loc
     C                     MOVEL'On-Hand' $CSTTX           USR Text 7
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'On-Hand' $CSTTX           USR Text 7
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert USR Day 1 to display format
      * Convert date
     C           1000000   ADD  $CFFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCFFDT
      * Convert USR Day 2 to display format
      * Convert date
     C           1000000   ADD  $CE1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE1DT
      * Convert USR Day 3 to display format
      * Convert date
     C           1000000   ADD  $CE2DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE2DT
      * Convert USR Day 4 to display format
      * Convert date
     C           1000000   ADD  $CE3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCE3DT
     C                     MOVEL'0'       *IN79
     C           P2QBST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P4VHST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print Availability Group Code of Prt Inv/Ordr for S/Whs PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Item Display Sequence of Prt Inv/Ordr for S/Whs PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print First Page Format of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Item Code of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Scheduled Ship Date of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Ship To Customer of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Warehouse Code of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Order Number of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print Order Sequence Number of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP06
     C                     END                             FI
      * Print Order Secondary Line Seq of Prt Inv/Ordr for S/Whs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP07
     C                     END                             FI
      * Print Detail line. of Prt Inv/Ordr for S/Whs PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Prt: Item Description
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.First Time Flag is Yes
      *   |- c2    : PGM.*new page flag is *Yes
      *   '-
     C           WN0001    IFEQ 'Y'                        *IF
     C           W0NEWP    OREQ 'Y'                        *OR
     C                     MOVEL*BLANK    $DOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DHGCD    WL0003           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $DOONA    P      Description Lin
     C                     MOVELWL0005    WUAWNA    P      Description Lin
     C                     MOVEL$DOONA    $DG5TX           Text 1 USR
     C                     MOVEL'N'       WN0001           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $DOONA           Item Desc DRV
     C                     Z-ADD*ZERO     $DHGCD           Item Code
     C                     MOVEL$DOONA    $DG5TX           Text 1 USR
     C                     END                             *FI
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SIRVGN
      * Report type = Daily  (original code RMC 01/30/07)
      * CASE: PAR.Report Type(Daily/Weekly) is Daily
     C           P5BGTX    IFEQ '1'                        *IF
      * Set Up Quantities  --> Report type = Daily   -- RMC orig code 01/
      * CASE: DB1.Scheduled Ship Date EQ PAR.USR Day 1
     C           OMAODT    IFEQ P2FFDT                     *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DIRQT           Quantity Ordere
     C                     ELSE
      * CASE: CUR.Warehouse Code EQ PAR.USR Warehouse Code
     C           $DAJCD    IFEQ P2CPCD                     *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date EQ PAR.USR Day 2
     C           OMAODT    IFEQ P2E1DT                     *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQTO1           Quantity Ordere
     C                     ELSE
      * CASE: CUR.Warehouse Code EQ PAR.USR Warehouse Code
     C           $DAJCD    IFEQ P2CPCD                     *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date EQ PAR.USR Day 3
     C           OMAODT    IFEQ P2E2DT                     *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQT02           Quantity Ordere
     C                     ELSE
      * CASE: CUR.Warehouse Code EQ PAR.USR Warehouse Code
     C           $DAJCD    IFEQ P2CPCD                     *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date EQ PAR.USR Day 4
     C           OMAODT    IFEQ P2E3DT                     *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQT03           Quantity Ordere
     C                     ELSE
      * CASE: CUR.Warehouse Code EQ PAR.USR Warehouse Code
     C           $DAJCD    IFEQ P2CPCD                     *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date EQ PAR.USR Day 5
     C           OMAODT    IFEQ P2E4DT                     *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQT05           Quantity Ordere
     C                     ELSE
      * CASE: CUR.Warehouse Code EQ PAR.USR Warehouse Code
     C           $DAJCD    IFEQ P2CPCD                     *IF
     C                     Z-ADD$DAVQT    $DQS05           Quantity Schedu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Report type = Weekly   new code RMC 01/30/07
      * CASE: PAR.Report Type(Daily/Weekly) is Weekly
     C           P5BGTX    IFEQ '2'                        *IF
      * Set Up Quantities  --> Report type = Weekly  -- RMC new code 01/3
      * CASE: DB1.Scheduled Ship Date LE PAR.USR Day 1
     C           OMAODT    IFLE P2FFDT                     *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DIRQT           Quantity Ordere
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Scheduled Ship Date GT PAR.USR Day 1
      *   |- c2    : DB1.Scheduled Ship Date LE PAR.USR Day 2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMAODT    IFGT P2FFDT                     *IF
     C           OMAODT    IFLE P2E1DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQTO1           Quantity Ordere
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Scheduled Ship Date GT PAR.USR Day 2
      *   |- c2    : DB1.Scheduled Ship Date LE PAR.USR Day 3
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMAODT    IFGT P2E1DT                     *IF
     C           OMAODT    IFLE P2E2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQT02           Quantity Ordere
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Scheduled Ship Date GT PAR.USR Day 3
      *   |- c2    : DB1.Scheduled Ship Date LE PAR.USR Day 4
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMAODT    IFGT P2E2DT                     *IF
     C           OMAODT    IFLE P2E3DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQT03           Quantity Ordere
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Scheduled Ship Date GT PAR.USR Day 4
      *   |- c2    : DB1.Scheduled Ship Date LE PAR.USR Day 5
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMAODT    IFGT P2E3DT                     *IF
     C           OMAODT    IFLE P2E4DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Check Warehouse
      * CASE: CUR.Warehouse Code EQ PAR.Warehouse Code
     C           $DAJCD    IFEQ P2AJCD                     *IF
     C                     Z-ADD$DAVQT    $DQT05           Quantity Ordere
     C                     ELSE
      * CASE: CUR.Warehouse Code EQ PAR.USR Warehouse Code
     C           $DAJCD    IFEQ P2CPCD                     *IF
     C                     Z-ADD$DAVQT    $DQS05           Quantity Schedu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Print Format
      * CASE: PAR.Report Type USR is Summary
     C           P2QBST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * RTV Load ID            RT - PD Order Header  * 
     C                     EXSR SJRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print Detail line. of Prt Inv/Ordr for S/Whs PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Whs 1 Scheduled
      * CUR.Quantity Sched 1 USR =
      *    *COMPUTE (x1 + x2 + x3 + x4)
      * x1    : CUR.Quantity Ordered 1 USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Quantity Ordered 2 USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Quantity Ordered 3 USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Quantity Ordered 4 USR
     C           $IIRQT    ADD  $IQTO1    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $IQT02    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $IQT03    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $IASNX           Quantity Sched
      * Whs 2 Scheduled
      * CUR.Quantity Sched 2 USR =
      *    *COMPUTE (x1 + x2 + x3 + x4)
      * x1    : CUR.Quantity Scheduled 1 USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Quantity Scheduled 2 USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : CUR.Quantity Scheduled 3 USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Quantity Scheduled 4 USR
     C           $IQS01    ADD  $IQS02    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  $IQS03    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $IQS04    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $IATNX           Quantity Sched
      * Rtv On-Hand Inventory.
      * CASE: PAR.Lot Tracking Flag is yes
     C           P4VHST    IFEQ 'Y'                        *IF
      * RMC PFS019 8/21/06 show on hand from item bal instead of lot loc
      * RTV On Hand Qty       RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADD$IHGCD    WL0007           Item Code
     C                     MOVELP2AJCD    WL0008    P      Warehouse Code
     C                     Z-ADD$IAQNX    WL0009           On Hand U/M1 Su
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    $IAQNX           On Hand U/M1 Su
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV On Hand Qty       RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADD$IHGCD    WL0007           Item Code
     C                     MOVELP2AJCD    WL0008    P      Warehouse Code
     C                     Z-ADD$IAQNX    WL0009           On Hand U/M1 Su
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    $IAQNX           On Hand U/M1 Su
     C                     END                             *FI
      * Print Format
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : CUR.Quantity Sched 1 USR is Equal to Zero
      *   |- c2    : CUR.Quantity Sched 2 USR is Equal to Zero
      *   |- c3    : CUR.Quantity On-Hand 1 USR is Equal to Zero
      *   |- c4    : CUR.Quantity On-Hand 2 USR is Equal to Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $IASNX    IFEQ *ZERO                      *IF
     C           $IATNX    IFEQ *ZERO                      *IF
     C           $IAQNX    IFEQ *ZERO                      *IF
     C           $IARNX    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C                     MOVEL*BLANK    $IOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$IHGCD    WL0003           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $IOONA    P      Description Lin
     C                     MOVELWL0005    WUAWNA    P      Description Lin
     C           $IAQNX    SUB  $IASNX    $IODNB           Number Value -
     C           $IARNX    SUB  $IATNX    $ITVNB           Calc 7
      * CASE: PAR.Lot Tracking Flag is yes
     C           P4VHST    IFEQ 'Y'                        *IF
      * Rtv Frozen Quantity   RT - IC Item Lot Location  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $IHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$IHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VIHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VIHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           P2QBST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P4VHST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Inv/Ordr for S/Whs PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  8         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Inv/Ordr for S/Whs PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  5         W0FSUM
     C                     END                             FI
      *
      * * Availability Group Code of Prt Inv/Ordr for S/Whs PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Display Sequence of Prt Inv/Ordr for S/Whs PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Inv/Ordr for S/Whs PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Inv/Ordr for S/Whs PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Inv/Ordr for S/Whs PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of Prt Inv/Ordr for S/Whs PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Scheduled Ship Date of Prt Inv/Ordr for S/Whs PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt Inv/Ordr for S/Whs PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Warehouse Code of Prt Inv/Ordr for S/Whs PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Inv/Ordr for S/Whs PO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of Prt Inv/Ordr for S/Whs PO
     C           W0BP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of Prt Inv/Ordr for S/Whs PO
     C           W0BP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Inv/Ordr for S/Whs PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Next Saturday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    WQSC01           Company Number
     C                     Z-ADDP2JEDT    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSC     SETLL@AFREBE                    *
     C           KRSSC     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2FFDT           Scheduled Ship
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Saturday
     C           AFA9ST    IFEQ '7'                        *IF
     C                     Z-ADDAFBCDT    P2FFDT           Scheduled Ship
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BADTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Warehouse Descr
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    WL0002           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Group Description  RT - Availability Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           KKV4CD           Availability Gr
      * Setup key
     C                     MOVEL$BV4CD    KKV4CD           Availability Gr
      * Establish starting position
     C           KRSSF     CHAIN@KKREG7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2215' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BNVNA           Availability Gr
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKKNVNA    $BNVNA           Availability Gr
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELP2AJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P4VHST           Lot Tracking Fl
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAVHST    P4VHST           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0003    BYHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Description Lin
     C                     MOVEL*BLANK    WL0005           Description Lin
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    WL0004           Description Lin
     C                     MOVELBYAWNA    WL0005           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DG6TX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    $DG6TX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    BEAIC3           Company Number
     C                     Z-ADD$DC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DRMNB           Load ID
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBERMNB    $DRMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDOMAIC3    BEAIC3           Company Number
     C                     Z-ADDOMC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    YL0001           Header Status
     C                     MOVELBEOBST    YL0002           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV On Hand Qty       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0009           On Hand U/M1 Su
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQSL01           Company Number
     C           *LIKE     DEFN B0AJCD    WQSL02           Warehouse Code
     C           *LIKE     DEFN B0HGCD    WQSL03           Item Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Warehouse Code
     C                     KFLD           WQSL03           Item Code
      * Setup key
     C                     Z-ADDWL0006    WQSL01           Company Number
     C                     MOVELWL0008    WQSL02           Warehouse Code
     C                     Z-ADDWL0007    WQSL03           Item Code
      * Establish starting position
     C           KRSSL     SETLL@B0REHD                    *
     C           KRSSL     READE@B0REHD                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  B0DDQT    WL0009           On Hand U/M1 Su
     C           KRSSL     READE@B0REHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Frozen Quantity   RT - IC Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $IQLTX           Quantity Loc Tr
      * Declare restrictor key work fields
     C           *LIKE     DEFN L5AIC3    WQSM01           Company Number
     C           *LIKE     DEFN L5AJCD    WQSM02           Warehouse Code
     C           *LIKE     DEFN L5HGCD    WQSM03           Item Code
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Warehouse Code
     C                     KFLD           WQSM03           Item Code
     C                     KFLD           L5LODT           ILL Avail Ship
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Warehouse Code
     C                     KFLD           WQSM03           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSM01           Company Number
     C                     MOVELP2AJCD    WQSM02           Warehouse Code
     C                     Z-ADD$IHGCD    WQSM03           Item Code
     C                     Z-ADD##JDT     L5LODT           ILL Avail Ship
      * Establish starting position
     C           KPSSM     SETLL@L5CPX6                    *
     C           KRSSM     READE@L5CPX6                  90*
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ILL Status is Available
     C           L5AMSX    IFEQ 'A'                        *IF
     C                     ADD  L5J2QT    $IQLTX           Quantity Loc Tr
     C                     END                             *FI
     C           KRSSM     READE@L5CPX6                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Inv/Ordr for S/Whs PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        First Time Flag
      *
      * Prt Inv/Ordr for S/Whs PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt Inv/Ordr for S/Whs PO: Initialise
      *================================================================
      * USER: Initialize program
      * RMC 07/07/09 FP1054 accum per bill act type 1 and 4
      * RMC 06/15/09 FP1054 accum qty ordered instead of scheduled
      * RMC 01/30/07 added parm Report type(daily/weekly)
      *     if Daily, sched ship dates are compared to equalling the pars
      *     if Weekly, sched ship dates are compared to <= pars days
     C                     MOVEL'Y'       WN0001           First Time Flag
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2FFDT           USR Day 1
     C                     Z-ADD*ZERO     P2E1DT           USR Day 2
     C                     Z-ADD*ZERO     P2E2DT           USR Day 3
     C                     Z-ADD*ZERO     P2E3DT           USR Day 4
     C                     Z-ADD*ZERO     P2E4DT           USR Day 5
     C                     MOVEL*BLANK    P4VHST           Lot Tracking Fl
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KLAIC3           Company Number
     C                     MOVEL*LOVAL    KLV4CD           Availability Gr
     C                     MOVEL*LOVAL    KLIDSQ           Item Display Se
     C                     MOVEL*LOVAL    KLHGCD           Item Code
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WABVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    OMAIC3           Company Number
     C                     MOVEL*LOVAL    OMHGCD           Item Code
     C                     MOVEL*LOVAL    OMAODT           Scheduled Ship
     C                     MOVEL*LOVAL    OMBKC7           Ship To Custome
     C                     MOVEL*LOVAL    OMAJCD           Warehouse Code
     C                     MOVEL*LOVAL    OMC4NB           Order Number
     C                     MOVEL*LOVAL    OMDPNB           Order Sequence
     C                     MOVEL*LOVAL    OMUENB           Order Secondary
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009 112
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0002  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * RMC 01/29/07  Added report type (daily/weekly) parm.
      * FP1054 RMC 06/15/09  prt ordered qty/wgt instead of sched
      * FP1054 RMC 07/07/09  accum OD per bill act type 1,4
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
