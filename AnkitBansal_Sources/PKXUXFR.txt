     H/TITLE Bal/Val Tattoo copy   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 01/26/06  Time  : 14:35:52
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB6CPL1IF  E           K        DISK
      * RTV : Eval/Loss Error           Retrieval index
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKA4CPL3IF  E           K        DISK
      * RSQ : Tattoo Header Comment     Co/BOL/Tto/KDt/Typ/Lin
      *
     FPKBSCPL3IF  E           K        DISK
      * RSQ : Loss Trans                By Bo/Ld/Tattoo No Delet
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBSCPLBIF  E           K        DISK
      * RSQ : Loss Trans                Co/LsTyp/Bo/Ld/Tto/KDte
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKDYCPL1IF  E           K        DISK
      * RTV : Tattoo Detail Ext         Retrieval index
      *
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKBVCPLHIF  E           K        DISK
      * RSQ : Eval Trans                Co/Bo/Ld/Tto/KDt/AdTy
      *
     FPKCGCPL4IF  E           K        DISK
      * RSQ : Producer History WKLY     Prod/WkEndDte(D)/Type
      *
     FPKB6CPL3IF  E           K        DISK
      * RSQ : Eval/Loss Error           Eval Errors only
      *
     FPKA4CPL2IF  E           K        DISK
      * RSQ : Tattoo Header Comment     THC Comment, Line (D)
      *
     FPKA1CPNDIF  E           K        DISK
      * RTV : Tattoo Header             Retrieval Index 2
      *
     FPKBVCPL2IF  E           K        DISK
      * RSQ : Eval Trans                Next Eval Trans
      *
     FPKBVCPLIIF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/Tto/KDt/Ln-d/Hw-d
      *
     FPKBVCPLLIF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/Tto/KDt/Ln-A/Hw-A
      *
     FPKB6CPL0UF  E           K        DISK                      A
      * UPD : Eval/Loss Error           Update index
      *
     FPKBVCPL0UF  E           K        DISK                      A
      * UPD : Eval Trans                Update index
      *
     FPKA4CPL0UF  E           K        DISK                      A
      * UPD : Tattoo Header Comment     Update index
      *
     FPKBSCPL0UF  E           K        DISK
      * UPD : Loss Trans                Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKDYCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Detail Ext         Update index
      *
      * Long constants
     E                    @CN#    1   8  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@B6CPGX
      * Eval/Loss Error           Retrieval index
      * Renamed input format fields
     I              B6HRNB                          WAHRNB
     I              B6BPDT                          WABPDT
     I              B6IRNB                          WAIRNB
     I              B6BONM                          WABONM
     I              B6LDNM                          WALDNM
     I              B6FPNB                          WAFPNB
     I              B6DYST                          WADYST
     I              B6DXST                          WADXST
     I              B6B7TX                          WAB7TX
     I              B6AAVN                          WAAAVN
     I              B6AADT                          WAAADT
     I              B6AMTM                          WAAMTM
     I              B6AJST                          WAAJST
     I              B6AHVN                          WAAHVN
     I              B6AGVN                          WAAGVN
     I              B6ABVN                          WAABVN
     I              B6ABDT                          WAABDT
     I              B6ABTM                          WAABTM
      *
     I@B6CPGW
      * Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
     I@BVCPQ9
      * Eval Trans                Co/Bol/KillDt/Tattoo
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     I@A4CPL4
      * Tattoo Header Comment     Co/BOL/Tto/KDt/Typ/Lin
      * Renamed input format fields
     I              A4HMNB                          WEHMNB
     I              A4BNNB                          WEBNNB
     I              A4BONB                          WEBONB
     I              A4CVNB                          WECVNB
     I              A4B0DT                          WEB0DT
     I              A4BETX                          WEBETX
     I              A4BFTX                          WEBFTX
     I              A4ETST                          WEETST
     I              A4AAVN                          WEAAVN
     I              A4AADT                          WEAADT
     I              A4AMTM                          WEAMTM
     I              A4AJST                          WEAJST
     I              A4AHVN                          WEAHVN
     I              A4AGVN                          WEAGVN
     I              A4ABVN                          WEABVN
     I              A4ABDT                          WEABDT
     I              A4ABTM                          WEABTM
      *
     I@A4CPC3
      * Tattoo Header Comment     Update index
      * Renamed input format fields
     I              A4HMNB                          WFHMNB
     I              A4BNNB                          WFBNNB
     I              A4BONB                          WFBONB
     I              A4CVNB                          WFCVNB
     I              A4B0DT                          WFB0DT
     I              A4BETX                          WFBETX
     I              A4BFTX                          WFBFTX
     I              A4ETST                          WFETST
     I              A4AAVN                          WFAAVN
     I              A4AADT                          WFAADT
     I              A4AMTM                          WFAMTM
     I              A4AJST                          WFAJST
     I              A4AHVN                          WFAHVN
     I              A4AGVN                          WFAGVN
     I              A4ABVN                          WFABVN
     I              A4ABDT                          WFABDT
     I              A4ABTM                          WFABTM
      *
     I@BSCPLV
      * Loss Trans                By Bo/Ld/Tattoo No Delet
      * Renamed input format fields
     I              BSHUNB                          WGHUNB
     I              BSA7DT                          WGA7DT
     I              BSFHNB                          WGFHNB
     I              BSFFNB                          WGFFNB
     I              BSEBST                          WGEBST
     I              BSDSNB                          WGDSNB
     I              BSS3NB                          WGS3NB
     I              BSS4NB                          WGS4NB
     I              BSD1ST                          WGD1ST
     I              BSH5ST                          WGH5ST
     I              BSJMST                          WGJMST
     I              BSSMST                          WGSMST
     I              BSBWCD                          WGBWCD
     I              BSBYCD                          WGBYCD
     I              BSHMNB                          WGHMNB
     I              BSBNNB                          WGBNNB
     I              BSBONB                          WGBONB
     I              BSCVNB                          WGCVNB
     I              BSB0DT                          WGB0DT
     I              BSAAVN                          WGAAVN
     I              BSAADT                          WGAADT
     I              BSAMTM                          WGAMTM
     I              BSAJST                          WGAJST
     I              BSAHVN                          WGAHVN
     I              BSAGVN                          WGAGVN
     I              BSABVN                          WGABVN
     I              BSABDT                          WGABDT
     I              BSABTM                          WGABTM
     I              BSB8DT                          WGB8DT
     I              BSAOTM                          WGAOTM
      *
     I@BSCPFS
      * Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WIHMNB
     I              A1BNNB                          WIBNNB
     I              A1BONB                          WIBONB
     I              A1CVNB                          WICVNB
     I              A1B0DT                          WIB0DT
     I              A1AWDT                          WIAWDT
     I              A1BICD                          WIBICD
     I              A1CPST                          WICPST
     I              A1ACPR                          WIACPR
     I              A1B9PR                          WIB9PR
     I              A1CAPR                          WICAPR
     I              A1C4ST                          WIC4ST
     I              A1AIPR                          WIAIPR
     I              A1A6DT                          WIA6DT
     I              A1C2ST                          WIC2ST
     I              A1CXNB                          WICXNB
     I              A1CWNB                          WICWNB
     I              A1FCNB                          WIFCNB
     I              A1H9NB                          WIH9NB
     I              A1FDNB                          WIFDNB
     I              A1FENB                          WIFENB
     I              A1HENB                          WIHENB
     I              A1HFNB                          WIHFNB
     I              A1CYNB                          WICYNB
     I              A1LRNB                          WILRNB
     I              A1E0NB                          WIE0NB
     I              A1A5PC                          WIA5PC
     I              A1FBNB                          WIFBNB
     I              A1A4PC                          WIA4PC
     I              A1F7NB                          WIF7NB
     I              A1HDNB                          WIHDNB
     I              A1F5NB                          WIF5NB
     I              A1F4NB                          WIF4NB
     I              A1F3NB                          WIF3NB
     I              A1F2NB                          WIF2NB
     I              A1AVPC                          WIAVPC
     I              A1AWPC                          WIAWPC
     I              A1CWPC                          WICWPC
     I              A1A8PC                          WIA8PC
     I              A1A7PC                          WIA7PC
     I              A1B8PR                          WIB8PR
     I              A1AMPR                          WIAMPR
     I              A1ANPR                          WIANPR
     I              A1AYVA                          WIAYVA
     I              A1AWVA                          WIAWVA
     I              A1AOPR                          WIAOPR
     I              A1AXVA                          WIAXVA
     I              A1APPR                          WIAPPR
     I              A1ASPR                          WIASPR
     I              A1A4VA                          WIA4VA
     I              A1ATPR                          WIATPR
     I              A1A5VA                          WIA5VA
     I              A1CBPR                          WICBPR
     I              A1CCPR                          WICCPR
     I              A1LPNB                          WILPNB
     I              A1CDPR                          WICDPR
     I              A1A7VA                          WIA7VA
     I              A1A2PR                          WIA2PR
     I              A1JWST                          WIJWST
     I              A1CWST                          WICWST
     I              A1D7ST                          WID7ST
     I              A1D8ST                          WID8ST
     I              A1DWST                          WIDWST
     I              A1D6ST                          WID6ST
     I              A1GHNB                          WIGHNB
     I              A1BYDT                          WIBYDT
     I              A1E0ST                          WIE0ST
     I              A1E1ST                          WIE1ST
     I              A1E2ST                          WIE2ST
     I              A1BSDT                          WIBSDT
     I              A1BTDT                          WIBTDT
     I              A1BUDT                          WIBUDT
     I              A1HGNB                          WIHGNB
     I              A1HHNB                          WIHHNB
     I              A1HINB                          WIHINB
     I              A1A3PR                          WIA3PR
     I              A1A4PR                          WIA4PR
     I              A1A6PR                          WIA6PR
     I              A1J9NB                          WIJ9NB
     I              A1D6PR                          WID6PR
     I              A1D7PR                          WID7PR
     I              A1D8PR                          WID8PR
     I              A1D9PR                          WID9PR
     I              A1EAPR                          WIEAPR
     I              A1EBPR                          WIEBPR
     I              A1ECPR                          WIECPR
     I              A1EDPR                          WIEDPR
     I              A1EEPR                          WIEEPR
     I              A1EFPR                          WIEFPR
     I              A1EGPR                          WIEGPR
     I              A1EHPR                          WIEHPR
     I              A1KAST                          WIKAST
     I              A1J7ST                          WIJ7ST
     I              A1J9ST                          WIJ9ST
     I              A1OXNB                          WIOXNB
     I              A1LKST                          WILKST
     I              A1LLST                          WILLST
     I              A1J8ST                          WIJ8ST
     I              A1LIST                          WILIST
     I              A1LJST                          WILJST
     I              A1NZTX                          WINZTX
     I              A1HJCD                          WIHJCD
     I              A1R4ST                          WIR4ST
     I              A1R5ST                          WIR5ST
     I              A1R6ST                          WIR6ST
     I              A1R7ST                          WIR7ST
     I              A1THWT                          WITHWT
     I              A1T2WT                          WIT2WT
     I              A1THHD                          WITHHD
     I              A1T2HD                          WIT2HD
     I              A1OBPR                          WIOBPR
     I              A1KOER                          WIKOER
     I              A1OPIR                          WIOPIR
     I              A1OPEM                          WIOPEM
     I              A1IORP                          WIIORP
     I              A1OWEO                          WIOWEO
     I              A1OQET                          WIOQET
     I              A1URST                          WIURST
     I              A1USST                          WIUSST
     I              A1HHPC                          WIHHPC
     I              A1S9PR                          WIS9PR
     I              A1TAPR                          WITAPR
     I              A1TBPR                          WITBPR
     I              A1JFUR                          WIJFUR
     I              A1KRIF                          WIKRIF
     I              A1KORF                          WIKORF
     I              A1KAPR                          WIKAPR
     I              A1KROT                          WIKROT
     I              A1OTJG                          WIOTJG
     I              A1IRJG                          WIIRJG
     I              A1IMJF                          WIIMJF
     I              A1IRGF                          WIIRGF
     I              A1KRJF                          WIKRJF
     I              A1OJRF                          WIOJRF
     I              A1KFOR                          WIKFOR
     I              A1ORJK                          WIORJK
     I              A1OMVJ                          WIOMVJ
     I              A1MVNF                          WIMVNF
     I              A1MCNF                          WIMCNF
     I              A1NCNF                          WINCNF
     I              A1NCHF                          WINCHF
     I              A1IGIR                          WIIGIR
     I              A1KFJR                          WIKFJR
     I              A1EADT                          WIEADT
     I              A1EBDT                          WIEBDT
     I              A1ECDT                          WIECDT
     I              A1EDDT                          WIEDDT
     I              A1EEDT                          WIEEDT
     I              A1U4ST                          WIU4ST
     I              A1U5ST                          WIU5ST
     I              A1U6ST                          WIU6ST
     I              A1U7ST                          WIU7ST
     I              A1U8ST                          WIU8ST
     I              A1U9ST                          WIU9ST
     I              A1VAST                          WIVAST
     I              A1VBST                          WIVBST
     I              A1BDCD                          WIBDCD
     I              A1CSCD                          WICSCD
     I              A1ABCD                          WIABCD
     I              A1AECD                          WIAECD
     I              A1ACCD                          WIACCD
     I              A1AGCD                          WIAGCD
     I              A1BECD                          WIBECD
     I              A1AAVN                          WIAAVN
     I              A1AADT                          WIAADT
     I              A1AMTM                          WIAMTM
     I              A1AJST                          WIAJST
     I              A1AHVN                          WIAHVN
     I              A1AGVN                          WIAGVN
     I              A1ABVN                          WIABVN
     I              A1ABDT                          WIABDT
     I              A1ABTM                          WIABTM
      *
     I@BSCPEM
      * Loss Trans                Co/LsTyp/Bo/Ld/Tto/KDte
      * Renamed input format fields
     I              BSHUNB                          WJHUNB
     I              BSA7DT                          WJA7DT
     I              BSFHNB                          WJFHNB
     I              BSFFNB                          WJFFNB
     I              BSEBST                          WJEBST
     I              BSDSNB                          WJDSNB
     I              BSS3NB                          WJS3NB
     I              BSS4NB                          WJS4NB
     I              BSD1ST                          WJD1ST
     I              BSH5ST                          WJH5ST
     I              BSJMST                          WJJMST
     I              BSSMST                          WJSMST
     I              BSBWCD                          WJBWCD
     I              BSBYCD                          WJBYCD
     I              BSHMNB                          WJHMNB
     I              BSBNNB                          WJBNNB
     I              BSBONB                          WJBONB
     I              BSCVNB                          WJCVNB
     I              BSB0DT                          WJB0DT
     I              BSAAVN                          WJAAVN
     I              BSAADT                          WJAADT
     I              BSAMTM                          WJAMTM
     I              BSAJST                          WJAJST
     I              BSAHVN                          WJAHVN
     I              BSAGVN                          WJAGVN
     I              BSABVN                          WJABVN
     I              BSABDT                          WJABDT
     I              BSABTM                          WJABTM
     I              BSB8DT                          WJB8DT
     I              BSAOTM                          WJAOTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WKHMNB
     I              A1BNNB                          WKBNNB
     I              A1BONB                          WKBONB
     I              A1CVNB                          WKCVNB
     I              A1B0DT                          WKB0DT
     I              A1AWDT                          WKAWDT
     I              A1BICD                          WKBICD
     I              A1CPST                          WKCPST
     I              A1ACPR                          WKACPR
     I              A1B9PR                          WKB9PR
     I              A1CAPR                          WKCAPR
     I              A1C4ST                          WKC4ST
     I              A1AIPR                          WKAIPR
     I              A1A6DT                          WKA6DT
     I              A1C2ST                          WKC2ST
     I              A1CXNB                          WKCXNB
     I              A1CWNB                          WKCWNB
     I              A1FCNB                          WKFCNB
     I              A1H9NB                          WKH9NB
     I              A1FDNB                          WKFDNB
     I              A1FENB                          WKFENB
     I              A1HENB                          WKHENB
     I              A1HFNB                          WKHFNB
     I              A1CYNB                          WKCYNB
     I              A1LRNB                          WKLRNB
     I              A1E0NB                          WKE0NB
     I              A1A5PC                          WKA5PC
     I              A1FBNB                          WKFBNB
     I              A1A4PC                          WKA4PC
     I              A1F7NB                          WKF7NB
     I              A1HDNB                          WKHDNB
     I              A1F5NB                          WKF5NB
     I              A1F4NB                          WKF4NB
     I              A1F3NB                          WKF3NB
     I              A1F2NB                          WKF2NB
     I              A1AVPC                          WKAVPC
     I              A1AWPC                          WKAWPC
     I              A1CWPC                          WKCWPC
     I              A1A8PC                          WKA8PC
     I              A1A7PC                          WKA7PC
     I              A1B8PR                          WKB8PR
     I              A1AMPR                          WKAMPR
     I              A1ANPR                          WKANPR
     I              A1AYVA                          WKAYVA
     I              A1AWVA                          WKAWVA
     I              A1AOPR                          WKAOPR
     I              A1AXVA                          WKAXVA
     I              A1APPR                          WKAPPR
     I              A1ASPR                          WKASPR
     I              A1A4VA                          WKA4VA
     I              A1ATPR                          WKATPR
     I              A1A5VA                          WKA5VA
     I              A1CBPR                          WKCBPR
     I              A1CCPR                          WKCCPR
     I              A1LPNB                          WKLPNB
     I              A1CDPR                          WKCDPR
     I              A1A7VA                          WKA7VA
     I              A1A2PR                          WKA2PR
     I              A1JWST                          WKJWST
     I              A1CWST                          WKCWST
     I              A1D7ST                          WKD7ST
     I              A1D8ST                          WKD8ST
     I              A1DWST                          WKDWST
     I              A1D6ST                          WKD6ST
     I              A1GHNB                          WKGHNB
     I              A1BYDT                          WKBYDT
     I              A1E0ST                          WKE0ST
     I              A1E1ST                          WKE1ST
     I              A1E2ST                          WKE2ST
     I              A1BSDT                          WKBSDT
     I              A1BTDT                          WKBTDT
     I              A1BUDT                          WKBUDT
     I              A1HGNB                          WKHGNB
     I              A1HHNB                          WKHHNB
     I              A1HINB                          WKHINB
     I              A1A3PR                          WKA3PR
     I              A1A4PR                          WKA4PR
     I              A1A6PR                          WKA6PR
     I              A1J9NB                          WKJ9NB
     I              A1D6PR                          WKD6PR
     I              A1D7PR                          WKD7PR
     I              A1D8PR                          WKD8PR
     I              A1D9PR                          WKD9PR
     I              A1EAPR                          WKEAPR
     I              A1EBPR                          WKEBPR
     I              A1ECPR                          WKECPR
     I              A1EDPR                          WKEDPR
     I              A1EEPR                          WKEEPR
     I              A1EFPR                          WKEFPR
     I              A1EGPR                          WKEGPR
     I              A1EHPR                          WKEHPR
     I              A1KAST                          WKKAST
     I              A1J7ST                          WKJ7ST
     I              A1J9ST                          WKJ9ST
     I              A1OXNB                          WKOXNB
     I              A1LKST                          WKLKST
     I              A1LLST                          WKLLST
     I              A1J8ST                          WKJ8ST
     I              A1LIST                          WKLIST
     I              A1LJST                          WKLJST
     I              A1NZTX                          WKNZTX
     I              A1HJCD                          WKHJCD
     I              A1R4ST                          WKR4ST
     I              A1R5ST                          WKR5ST
     I              A1R6ST                          WKR6ST
     I              A1R7ST                          WKR7ST
     I              A1THWT                          WKTHWT
     I              A1T2WT                          WKT2WT
     I              A1THHD                          WKTHHD
     I              A1T2HD                          WKT2HD
     I              A1OBPR                          WKOBPR
     I              A1KOER                          WKKOER
     I              A1OPIR                          WKOPIR
     I              A1OPEM                          WKOPEM
     I              A1IORP                          WKIORP
     I              A1OWEO                          WKOWEO
     I              A1OQET                          WKOQET
     I              A1URST                          WKURST
     I              A1USST                          WKUSST
     I              A1HHPC                          WKHHPC
     I              A1S9PR                          WKS9PR
     I              A1TAPR                          WKTAPR
     I              A1TBPR                          WKTBPR
     I              A1JFUR                          WKJFUR
     I              A1KRIF                          WKKRIF
     I              A1KORF                          WKKORF
     I              A1KAPR                          WKKAPR
     I              A1KROT                          WKKROT
     I              A1OTJG                          WKOTJG
     I              A1IRJG                          WKIRJG
     I              A1IMJF                          WKIMJF
     I              A1IRGF                          WKIRGF
     I              A1KRJF                          WKKRJF
     I              A1OJRF                          WKOJRF
     I              A1KFOR                          WKKFOR
     I              A1ORJK                          WKORJK
     I              A1OMVJ                          WKOMVJ
     I              A1MVNF                          WKMVNF
     I              A1MCNF                          WKMCNF
     I              A1NCNF                          WKNCNF
     I              A1NCHF                          WKNCHF
     I              A1IGIR                          WKIGIR
     I              A1KFJR                          WKKFJR
     I              A1EADT                          WKEADT
     I              A1EBDT                          WKEBDT
     I              A1ECDT                          WKECDT
     I              A1EDDT                          WKEDDT
     I              A1EEDT                          WKEEDT
     I              A1U4ST                          WKU4ST
     I              A1U5ST                          WKU5ST
     I              A1U6ST                          WKU6ST
     I              A1U7ST                          WKU7ST
     I              A1U8ST                          WKU8ST
     I              A1U9ST                          WKU9ST
     I              A1VAST                          WKVAST
     I              A1VBST                          WKVBST
     I              A1BDCD                          WKBDCD
     I              A1CSCD                          WKCSCD
     I              A1ABCD                          WKABCD
     I              A1AECD                          WKAECD
     I              A1ACCD                          WKACCD
     I              A1AGCD                          WKAGCD
     I              A1BECD                          WKBECD
     I              A1AAVN                          WKAAVN
     I              A1AADT                          WKAADT
     I              A1AMTM                          WKAMTM
     I              A1AJST                          WKAJST
     I              A1AHVN                          WKAHVN
     I              A1AGVN                          WKAGVN
     I              A1ABVN                          WKABVN
     I              A1ABDT                          WKABDT
     I              A1ABTM                          WKABTM
      *
     I@A2CPDG
      * Tattoo Detail             Retrieval index
      * Renamed input format fields
     I              A2HMNB                          WLHMNB
     I              A2BNNB                          WLBNNB
     I              A2BONB                          WLBONB
     I              A2CVNB                          WLCVNB
     I              A2B0DT                          WLB0DT
     I              A2C2NB                          WLC2NB
     I              A2CZNB                          WLCZNB
     I              A2C0NB                          WLC0NB
     I              A2D8NB                          WLD8NB
     I              A2H7NB                          WLH7NB
     I              A2GGST                          WLGGST
     I              A2AJTM                          WLAJTM
     I              A2JEA1                          WLJEA1
     I              A2B7CD                          WLB7CD
     I              A2D7NB                          WLD7NB
     I              A2D9ST                          WLD9ST
     I              A2E3ST                          WLE3ST
     I              A2E4ST                          WLE4ST
     I              A2E5ST                          WLE5ST
     I              A2BVDT                          WLBVDT
     I              A2BWDT                          WLBWDT
     I              A2BXDT                          WLBXDT
     I              A2HVNB                          WLHVNB
     I              A2CMCD                          WLCMCD
     I              A2B9CD                          WLB9CD
     I              A2H8NB                          WLH8NB
     I              A2CYCD                          WLCYCD
     I              A2AAVN                          WLAAVN
     I              A2AADT                          WLAADT
     I              A2AMTM                          WLAMTM
     I              A2AJST                          WLAJST
     I              A2AHVN                          WLAHVN
     I              A2AGVN                          WLAGVN
     I              A2ABVN                          WLABVN
     I              A2ABDT                          WLABDT
     I              A2ABTM                          WLABTM
      *
     I@DYCPXX
      * Tattoo Detail Ext         Retrieval index
      * Renamed input format fields
     I              DYHMNB                          WMHMNB
     I              DYBNNB                          WMBNNB
     I              DYBONB                          WMBONB
     I              DYCVNB                          WMCVNB
     I              DYB0DT                          WMB0DT
     I              DYC2NB                          WMC2NB
     I              DYP3ST                          WMP3ST
     I              DYLENB                          WMLENB
     I              DYLFNB                          WMLFNB
     I              DYLINB                          WMLINB
     I              DYP4ST                          WMP4ST
     I              DYP5ST                          WMP5ST
     I              DYAAVN                          WMAAVN
     I              DYAADT                          WMAADT
     I              DYAMTM                          WMAMTM
     I              DYAJST                          WMAJST
     I              DYAHVN                          WMAHVN
     I              DYAGVN                          WMAGVN
     I              DYABVN                          WMABVN
     I              DYABDT                          WMABDT
     I              DYABTM                          WMABTM
      *
     I@DYCPXW
      * Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WOHMNB
     I              DYBNNB                          WOBNNB
     I              DYBONB                          WOBONB
     I              DYCVNB                          WOCVNB
     I              DYB0DT                          WOB0DT
     I              DYC2NB                          WOC2NB
     I              DYP3ST                          WOP3ST
     I              DYLENB                          WOLENB
     I              DYLFNB                          WOLFNB
     I              DYLINB                          WOLINB
     I              DYP4ST                          WOP4ST
     I              DYP5ST                          WOP5ST
     I              DYAAVN                          WOAAVN
     I              DYAADT                          WOAADT
     I              DYAMTM                          WOAMTM
     I              DYAJST                          WOAJST
     I              DYAHVN                          WOAHVN
     I              DYAGVN                          WOAGVN
     I              DYABVN                          WOABVN
     I              DYABDT                          WOABDT
     I              DYABTM                          WOABTM
      *
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WRBVCD
     I              BOCBTX                          WRCBTX
     I              BOC5ST                          WRC5ST
     I              BOAFPC                          WRAFPC
     I              BOAGPC                          WRAGPC
     I              BOFEST                          WRFEST
     I              BOAAVN                          WRAAVN
     I              BOAADT                          WRAADT
     I              BOAMTM                          WRAMTM
     I              BOAJST                          WRAJST
     I              BOAHVN                          WRAHVN
     I              BOAGVN                          WRAGVN
     I              BOABVN                          WRABVN
     I              BOABDT                          WRABDT
     I              BOABTM                          WRABTM
      *
     I@BVCPEC
      * Eval Trans                Co/Bo/Ld/Tto/KDt/AdTy
      * Renamed input format fields
     I              BVHSNB                          WSHSNB
     I              BVA9DT                          WSA9DT
     I              BVFJNB                          WSFJNB
     I              BVHCNB                          WSHCNB
     I              BVGDNB                          WSGDNB
     I              BVFINB                          WSFINB
     I              BVLKNB                          WSLKNB
     I              BVEAST                          WSEAST
     I              BVAMPC                          WSAMPC
     I              BVAIPC                          WSAIPC
     I              BVAJPC                          WSAJPC
     I              BVAKPC                          WSAKPC
     I              BVX8NB                          WSX8NB
     I              BVFVPC                          WSFVPC
     I              BVFWPC                          WSFWPC
     I              BVFXPC                          WSFXPC
     I              BVALPC                          WSALPC
     I              BVDIST                          WSDIST
     I              BVFYST                          WSFYST
     I              BVD2ST                          WSD2ST
     I              BVEHST                          WSEHST
     I              BVG1ST                          WSG1ST
     I              BVH4ST                          WSH4ST
     I              BVJLST                          WSJLST
     I              BVUUST                          WSUUST
     I              BVVHST                          WSVHST
     I              BVVIST                          WSVIST
     I              BVVJST                          WSVJST
     I              BVVKST                          WSVKST
     I              BVVLST                          WSVLST
     I              BVHMNB                          WSHMNB
     I              BVBNNB                          WSBNNB
     I              BVBONB                          WSBONB
     I              BVCVNB                          WSCVNB
     I              BVB0DT                          WSB0DT
     I              BVAAVN                          WSAAVN
     I              BVAADT                          WSAADT
     I              BVAMTM                          WSAMTM
     I              BVAJST                          WSAJST
     I              BVAHVN                          WSAHVN
     I              BVAGVN                          WSAGVN
     I              BVABVN                          WSABVN
     I              BVABDT                          WSABDT
     I              BVABTM                          WSABTM
     I              BVB8DT                          WSB8DT
     I              BVAOTM                          WSAOTM
      *
     I@CGCPEJ
      * Producer History WKLY     Prod/WkEndDte(D)/Type
      * Renamed input format fields
     I              CGABCD                          WTABCD
     I              CGUVST                          WTUVST
     I              CGDZDT                          WTDZDT
     I              CGOJJF                          WTOJJF
     I              CGALHD                          WTALHD
     I              CGKDUR                          WTKDUR
     I              CGKJOQ                          WTKJOQ
     I              CGJOWR                          WTJOWR
     I              CGOIWE                          WTOIWE
     I              CGIOTR                          WTIOTR
     I              CGJOWK                          WTJOWK
     I              CGUQWP                          WTUQWP
     I              CGO6PC                          WTO6PC
     I              CGJKSE                          WTJKSE
     I              CGG8PC                          WTG8PC
     I              CGHAPC                          WTHAPC
     I              CGORJG                          WTORJG
     I              CGHDPC                          WTHDPC
     I              CGHFPC                          WTHFPC
     I              CGS1PR                          WTS1PR
     I              CGTCPR                          WTTCPR
     I              CGS3PR                          WTS3PR
     I              CGTDPR                          WTTDPR
     I              CGS5PR                          WTS5PR
     I              CGTEPR                          WTTEPR
     I              CGS7PR                          WTS7PR
     I              CGTFPR                          WTTFPR
     I              CGB6A1                          WTB6A1
     I              CGJKOS                          WTJKOS
     I              CGALRC                          WTALRC
     I              CGKDIE                          WTKDIE
     I              CGJOEW                          WTJOEW
     I              CGOWUI                          WTOWUI
     I              CGIOWN                          WTIOWN
     I              CGORMB                          WTORMB
     I              CGJOQR                          WTJOQR
     I              CGPRUR                          WTPRUR
     I              CGG7PC                          WTG7PC
     I              CGIOOG                          WTIOOG
     I              CGG9PC                          WTG9PC
     I              CGHBPC                          WTHBPC
     I              CGUWOE                          WTUWOE
     I              CGHEPC                          WTHEPC
     I              CGHGPC                          WTHGPC
     I              CGS2PR                          WTS2PR
     I              CGTGPR                          WTTGPR
     I              CGS4PR                          WTS4PR
     I              CGTHPR                          WTTHPR
     I              CGS6PR                          WTS6PR
     I              CGTIPR                          WTTIPR
     I              CGS8PR                          WTS8PR
     I              CGTJPR                          WTTJPR
     I              CGB8A1                          WTB8A1
     I              CGAAVN                          WTAAVN
     I              CGAADT                          WTAADT
     I              CGAMTM                          WTAMTM
     I              CGAJST                          WTAJST
     I              CGAHVN                          WTAHVN
     I              CGAGVN                          WTAGVN
     I              CGABVN                          WTABVN
     I              CGABDT                          WTABDT
     I              CGABTM                          WTABTM
      *
     I@B6CPLW
      * Eval/Loss Error           Eval Errors only
      * Renamed input format fields
     I              B6HRNB                          WVHRNB
     I              B6BPDT                          WVBPDT
     I              B6IRNB                          WVIRNB
     I              B6BONM                          WVBONM
     I              B6LDNM                          WVLDNM
     I              B6FPNB                          WVFPNB
     I              B6DYST                          WVDYST
     I              B6DXST                          WVDXST
     I              B6B7TX                          WVB7TX
     I              B6AAVN                          WVAAVN
     I              B6AADT                          WVAADT
     I              B6AMTM                          WVAMTM
     I              B6AJST                          WVAJST
     I              B6AHVN                          WVAHVN
     I              B6AGVN                          WVAGVN
     I              B6ABVN                          WVABVN
     I              B6ABDT                          WVABDT
     I              B6ABTM                          WVABTM
      *
     I@A4CPL3
      * Tattoo Header Comment     THC Comment, Line (D)
      * Renamed input format fields
     I              A4HMNB                          WWHMNB
     I              A4BNNB                          WWBNNB
     I              A4BONB                          WWBONB
     I              A4CVNB                          WWCVNB
     I              A4B0DT                          WWB0DT
     I              A4BETX                          WWBETX
     I              A4BFTX                          WWBFTX
     I              A4ETST                          WWETST
     I              A4AAVN                          WWAAVN
     I              A4AADT                          WWAADT
     I              A4AMTM                          WWAMTM
     I              A4AJST                          WWAJST
     I              A4AHVN                          WWAHVN
     I              A4AGVN                          WWAGVN
     I              A4ABVN                          WWABVN
     I              A4ABDT                          WWABDT
     I              A4ABTM                          WWABTM
      *
     I@A1CPC7
      * Tattoo Header             Retrieval Index 2
      * Renamed input format fields
     I              A1HMNB                          WXHMNB
     I              A1BNNB                          WXBNNB
     I              A1BONB                          WXBONB
     I              A1CVNB                          WXCVNB
     I              A1B0DT                          WXB0DT
     I              A1AWDT                          WXAWDT
     I              A1BICD                          WXBICD
     I              A1CPST                          WXCPST
     I              A1ACPR                          WXACPR
     I              A1B9PR                          WXB9PR
     I              A1CAPR                          WXCAPR
     I              A1C4ST                          WXC4ST
     I              A1AIPR                          WXAIPR
     I              A1A6DT                          WXA6DT
     I              A1C2ST                          WXC2ST
     I              A1CXNB                          WXCXNB
     I              A1CWNB                          WXCWNB
     I              A1FCNB                          WXFCNB
     I              A1H9NB                          WXH9NB
     I              A1FDNB                          WXFDNB
     I              A1FENB                          WXFENB
     I              A1HENB                          WXHENB
     I              A1HFNB                          WXHFNB
     I              A1CYNB                          WXCYNB
     I              A1LRNB                          WXLRNB
     I              A1E0NB                          WXE0NB
     I              A1A5PC                          WXA5PC
     I              A1FBNB                          WXFBNB
     I              A1A4PC                          WXA4PC
     I              A1F7NB                          WXF7NB
     I              A1HDNB                          WXHDNB
     I              A1F5NB                          WXF5NB
     I              A1F4NB                          WXF4NB
     I              A1F3NB                          WXF3NB
     I              A1F2NB                          WXF2NB
     I              A1AVPC                          WXAVPC
     I              A1AWPC                          WXAWPC
     I              A1CWPC                          WXCWPC
     I              A1A8PC                          WXA8PC
     I              A1A7PC                          WXA7PC
     I              A1B8PR                          WXB8PR
     I              A1AMPR                          WXAMPR
     I              A1ANPR                          WXANPR
     I              A1AYVA                          WXAYVA
     I              A1AWVA                          WXAWVA
     I              A1AOPR                          WXAOPR
     I              A1AXVA                          WXAXVA
     I              A1APPR                          WXAPPR
     I              A1ASPR                          WXASPR
     I              A1A4VA                          WXA4VA
     I              A1ATPR                          WXATPR
     I              A1A5VA                          WXA5VA
     I              A1CBPR                          WXCBPR
     I              A1CCPR                          WXCCPR
     I              A1LPNB                          WXLPNB
     I              A1CDPR                          WXCDPR
     I              A1A7VA                          WXA7VA
     I              A1A2PR                          WXA2PR
     I              A1JWST                          WXJWST
     I              A1CWST                          WXCWST
     I              A1D7ST                          WXD7ST
     I              A1D8ST                          WXD8ST
     I              A1DWST                          WXDWST
     I              A1D6ST                          WXD6ST
     I              A1GHNB                          WXGHNB
     I              A1BYDT                          WXBYDT
     I              A1E0ST                          WXE0ST
     I              A1E1ST                          WXE1ST
     I              A1E2ST                          WXE2ST
     I              A1BSDT                          WXBSDT
     I              A1BTDT                          WXBTDT
     I              A1BUDT                          WXBUDT
     I              A1HGNB                          WXHGNB
     I              A1HHNB                          WXHHNB
     I              A1HINB                          WXHINB
     I              A1A3PR                          WXA3PR
     I              A1A4PR                          WXA4PR
     I              A1A6PR                          WXA6PR
     I              A1J9NB                          WXJ9NB
     I              A1D6PR                          WXD6PR
     I              A1D7PR                          WXD7PR
     I              A1D8PR                          WXD8PR
     I              A1D9PR                          WXD9PR
     I              A1EAPR                          WXEAPR
     I              A1EBPR                          WXEBPR
     I              A1ECPR                          WXECPR
     I              A1EDPR                          WXEDPR
     I              A1EEPR                          WXEEPR
     I              A1EFPR                          WXEFPR
     I              A1EGPR                          WXEGPR
     I              A1EHPR                          WXEHPR
     I              A1KAST                          WXKAST
     I              A1J7ST                          WXJ7ST
     I              A1J9ST                          WXJ9ST
     I              A1OXNB                          WXOXNB
     I              A1LKST                          WXLKST
     I              A1LLST                          WXLLST
     I              A1J8ST                          WXJ8ST
     I              A1LIST                          WXLIST
     I              A1LJST                          WXLJST
     I              A1NZTX                          WXNZTX
     I              A1HJCD                          WXHJCD
     I              A1R4ST                          WXR4ST
     I              A1R5ST                          WXR5ST
     I              A1R6ST                          WXR6ST
     I              A1R7ST                          WXR7ST
     I              A1THWT                          WXTHWT
     I              A1T2WT                          WXT2WT
     I              A1THHD                          WXTHHD
     I              A1T2HD                          WXT2HD
     I              A1OBPR                          WXOBPR
     I              A1KOER                          WXKOER
     I              A1OPIR                          WXOPIR
     I              A1OPEM                          WXOPEM
     I              A1IORP                          WXIORP
     I              A1OWEO                          WXOWEO
     I              A1OQET                          WXOQET
     I              A1URST                          WXURST
     I              A1USST                          WXUSST
     I              A1HHPC                          WXHHPC
     I              A1S9PR                          WXS9PR
     I              A1TAPR                          WXTAPR
     I              A1TBPR                          WXTBPR
     I              A1JFUR                          WXJFUR
     I              A1KRIF                          WXKRIF
     I              A1KORF                          WXKORF
     I              A1KAPR                          WXKAPR
     I              A1KROT                          WXKROT
     I              A1OTJG                          WXOTJG
     I              A1IRJG                          WXIRJG
     I              A1IMJF                          WXIMJF
     I              A1IRGF                          WXIRGF
     I              A1KRJF                          WXKRJF
     I              A1OJRF                          WXOJRF
     I              A1KFOR                          WXKFOR
     I              A1ORJK                          WXORJK
     I              A1OMVJ                          WXOMVJ
     I              A1MVNF                          WXMVNF
     I              A1MCNF                          WXMCNF
     I              A1NCNF                          WXNCNF
     I              A1NCHF                          WXNCHF
     I              A1IGIR                          WXIGIR
     I              A1KFJR                          WXKFJR
     I              A1EADT                          WXEADT
     I              A1EBDT                          WXEBDT
     I              A1ECDT                          WXECDT
     I              A1EDDT                          WXEDDT
     I              A1EEDT                          WXEEDT
     I              A1U4ST                          WXU4ST
     I              A1U5ST                          WXU5ST
     I              A1U6ST                          WXU6ST
     I              A1U7ST                          WXU7ST
     I              A1U8ST                          WXU8ST
     I              A1U9ST                          WXU9ST
     I              A1VAST                          WXVAST
     I              A1VBST                          WXVBST
     I              A1BDCD                          WXBDCD
     I              A1CSCD                          WXCSCD
     I              A1ABCD                          WXABCD
     I              A1AECD                          WXAECD
     I              A1ACCD                          WXACCD
     I              A1AGCD                          WXAGCD
     I              A1BECD                          WXBECD
     I              A1AAVN                          WXAAVN
     I              A1AADT                          WXAADT
     I              A1AMTM                          WXAMTM
     I              A1AJST                          WXAJST
     I              A1AHVN                          WXAHVN
     I              A1AGVN                          WXAGVN
     I              A1ABVN                          WXABVN
     I              A1ABDT                          WXABDT
     I              A1ABTM                          WXABTM
      *
     I@BVCPNE
      * Eval Trans                Next Eval Trans
      * Renamed input format fields
     I              BVHSNB                          WYHSNB
     I              BVA9DT                          WYA9DT
     I              BVFJNB                          WYFJNB
     I              BVHCNB                          WYHCNB
     I              BVGDNB                          WYGDNB
     I              BVFINB                          WYFINB
     I              BVLKNB                          WYLKNB
     I              BVEAST                          WYEAST
     I              BVAMPC                          WYAMPC
     I              BVAIPC                          WYAIPC
     I              BVAJPC                          WYAJPC
     I              BVAKPC                          WYAKPC
     I              BVX8NB                          WYX8NB
     I              BVFVPC                          WYFVPC
     I              BVFWPC                          WYFWPC
     I              BVFXPC                          WYFXPC
     I              BVALPC                          WYALPC
     I              BVDIST                          WYDIST
     I              BVFYST                          WYFYST
     I              BVD2ST                          WYD2ST
     I              BVEHST                          WYEHST
     I              BVG1ST                          WYG1ST
     I              BVH4ST                          WYH4ST
     I              BVJLST                          WYJLST
     I              BVUUST                          WYUUST
     I              BVVHST                          WYVHST
     I              BVVIST                          WYVIST
     I              BVVJST                          WYVJST
     I              BVVKST                          WYVKST
     I              BVVLST                          WYVLST
     I              BVHMNB                          WYHMNB
     I              BVBNNB                          WYBNNB
     I              BVBONB                          WYBONB
     I              BVCVNB                          WYCVNB
     I              BVB0DT                          WYB0DT
     I              BVAAVN                          WYAAVN
     I              BVAADT                          WYAADT
     I              BVAMTM                          WYAMTM
     I              BVAJST                          WYAJST
     I              BVAHVN                          WYAHVN
     I              BVAGVN                          WYAGVN
     I              BVABVN                          WYABVN
     I              BVABDT                          WYABDT
     I              BVABTM                          WYABTM
     I              BVB8DT                          WYB8DT
     I              BVAOTM                          WYAOTM
      *
     I@BVCPEE
      * Eval Trans                Co/Bol/Tto/KDt/Ln-d/Hw-d
      * Renamed input format fields
     I              BVHSNB                          TAHSNB
     I              BVA9DT                          TAA9DT
     I              BVFJNB                          TAFJNB
     I              BVHCNB                          TAHCNB
     I              BVGDNB                          TAGDNB
     I              BVFINB                          TAFINB
     I              BVLKNB                          TALKNB
     I              BVEAST                          TAEAST
     I              BVAMPC                          TAAMPC
     I              BVAIPC                          TAAIPC
     I              BVAJPC                          TAAJPC
     I              BVAKPC                          TAAKPC
     I              BVX8NB                          TAX8NB
     I              BVFVPC                          TAFVPC
     I              BVFWPC                          TAFWPC
     I              BVFXPC                          TAFXPC
     I              BVALPC                          TAALPC
     I              BVDIST                          TADIST
     I              BVFYST                          TAFYST
     I              BVD2ST                          TAD2ST
     I              BVEHST                          TAEHST
     I              BVG1ST                          TAG1ST
     I              BVH4ST                          TAH4ST
     I              BVJLST                          TAJLST
     I              BVUUST                          TAUUST
     I              BVVHST                          TAVHST
     I              BVVIST                          TAVIST
     I              BVVJST                          TAVJST
     I              BVVKST                          TAVKST
     I              BVVLST                          TAVLST
     I              BVHMNB                          TAHMNB
     I              BVBNNB                          TABNNB
     I              BVBONB                          TABONB
     I              BVCVNB                          TACVNB
     I              BVB0DT                          TAB0DT
     I              BVAAVN                          TAAAVN
     I              BVAADT                          TAAADT
     I              BVAMTM                          TAAMTM
     I              BVAJST                          TAAJST
     I              BVAHVN                          TAAHVN
     I              BVAGVN                          TAAGVN
     I              BVABVN                          TAABVN
     I              BVABDT                          TAABDT
     I              BVABTM                          TAABTM
     I              BVB8DT                          TAB8DT
     I              BVAOTM                          TAAOTM
      *
     I@BVCPKU
      * Eval Trans                Co/Bol/Tto/KDt/Ln-A/Hw-A
      * Renamed input format fields
     I              BVHSNB                          TBHSNB
     I              BVA9DT                          TBA9DT
     I              BVFJNB                          TBFJNB
     I              BVHCNB                          TBHCNB
     I              BVGDNB                          TBGDNB
     I              BVFINB                          TBFINB
     I              BVLKNB                          TBLKNB
     I              BVEAST                          TBEAST
     I              BVAMPC                          TBAMPC
     I              BVAIPC                          TBAIPC
     I              BVAJPC                          TBAJPC
     I              BVAKPC                          TBAKPC
     I              BVX8NB                          TBX8NB
     I              BVFVPC                          TBFVPC
     I              BVFWPC                          TBFWPC
     I              BVFXPC                          TBFXPC
     I              BVALPC                          TBALPC
     I              BVDIST                          TBDIST
     I              BVFYST                          TBFYST
     I              BVD2ST                          TBD2ST
     I              BVEHST                          TBEHST
     I              BVG1ST                          TBG1ST
     I              BVH4ST                          TBH4ST
     I              BVJLST                          TBJLST
     I              BVUUST                          TBUUST
     I              BVVHST                          TBVHST
     I              BVVIST                          TBVIST
     I              BVVJST                          TBVJST
     I              BVVKST                          TBVKST
     I              BVVLST                          TBVLST
     I              BVHMNB                          TBHMNB
     I              BVBNNB                          TBBNNB
     I              BVBONB                          TBBONB
     I              BVCVNB                          TBCVNB
     I              BVB0DT                          TBB0DT
     I              BVAAVN                          TBAAVN
     I              BVAADT                          TBAADT
     I              BVAMTM                          TBAMTM
     I              BVAJST                          TBAJST
     I              BVAHVN                          TBAHVN
     I              BVAGVN                          TBAGVN
     I              BVABVN                          TBABVN
     I              BVABDT                          TBABDT
     I              BVABTM                          TBABTM
     I              BVB8DT                          TBB8DT
     I              BVAOTM                          TBAOTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB61    E DSPKB6CPL0
      * UPD : Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     IYARDCS      DS                            143
     IQPKA41    E DSPKA4CPL0
      * UPD : Tattoo Header Comment     Update index
      * Renamed input format fields
     I              A4HMNB                          WFHMNB
     I              A4BNNB                          WFBNNB
     I              A4BONB                          WFBONB
     I              A4CVNB                          WFCVNB
     I              A4B0DT                          WFB0DT
     I              A4BETX                          WFBETX
     I              A4BFTX                          WFBFTX
     I              A4ETST                          WFETST
     I              A4AAVN                          WFAAVN
     I              A4AADT                          WFAADT
     I              A4AMTM                          WFAMTM
     I              A4AJST                          WFAJST
     I              A4AHVN                          WFAHVN
     I              A4AGVN                          WFAGVN
     I              A4ABVN                          WFABVN
     I              A4ABDT                          WFABDT
     I              A4ABTM                          WFABTM
      *
      * Outward parameters
     IPARC        DS                            110
      * RCD : Loss Trans                Retrieval index
      * I : MAP LTN Company Number
     I                                    P   1   20PAHUNB
      * I : MAP LTN Kill Date
     I                                    P   3   60PAA7DT
      * I : MAP LTN Record Number
     I                                    P   7  100PAFHNB
      * I : MAP LTN Tattoo Number
     I                                    P  11  130PAFFNB
      * I : MAP LTN Shift
     I                                       14  14 PAEBST
      * I : MAP LTN Wgt
     I                                    P  15  181PADSNB
      * I : MAP LTN Extent
     I                                       19  20 PAS3NB
      * I : MAP LTN Trim Location
     I                                       21  22 PAS4NB
      * B : MAP LTN Error Sts
     I                                       23  23 PAD1ST
      * I : MAP LTN Record Created Status
     I                                       24  24 PAH5ST
      * I : MAP LTN User Error Override
     I                                       25  25 PAJMST
      * I : MAP LTN Source Type
     I                                       26  26 PASMST
      * I : MAP LT Type Code
     I                                    P  27  280PABWCD
      * I : MAP LR Reason Code
     I                                    P  29  300PABYCD
      * I : MAP BOH Company Number
     I                                    P  31  320PAHMNB
      * I : MAP BOH Buy Order Number
     I                                    P  33  350PABNNB
      * I : MAP BOL Load Number
     I                                    P  36  380PABONB
      * I : MAP TH Tattoo Number
     I                                    P  39  410PACVNB
      * I : MAP TH Kill Date
     I                                    P  42  450PAB0DT
      * I : MAP RS User Changed
     I                                       46  55 PAAAVN
      * I : MAP RS Date Changed
     I                                    P  56  590PAAADT
      * I : MAP RS Time Changed
     I                                    P  60  630PAAMTM
      * I : MAP RS Record Status
     I                                       64  64 PAAJST
      * I : MAP RS Job
     I                                       65  74 PAAHVN
      * I : MAP RS Program
     I                                       75  84 PAAGVN
      * I : MAP RS User Added
     I                                       85  94 PAABVN
      * I : MAP RS Date Added
     I                                    P  95  980PAABDT
      * I : MAP RS Time Added
     I                                    P  99 1020PAABTM
      * I : MAP RU Date
     I                                    P 103 1060PAB8DT
      * I : MAP RU Time
     I                                    P 107 1100PAAOTM
      *
     IQPKBS1    E DSPKBSCPL0
      * UPD : Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WHHUNB
     I              BSA7DT                          WHA7DT
     I              BSFHNB                          WHFHNB
     I              BSFFNB                          WHFFNB
     I              BSEBST                          WHEBST
     I              BSDSNB                          WHDSNB
     I              BSS3NB                          WHS3NB
     I              BSS4NB                          WHS4NB
     I              BSD1ST                          WHD1ST
     I              BSH5ST                          WHH5ST
     I              BSJMST                          WHJMST
     I              BSSMST                          WHSMST
     I              BSBWCD                          WHBWCD
     I              BSBYCD                          WHBYCD
     I              BSHMNB                          WHHMNB
     I              BSBNNB                          WHBNNB
     I              BSBONB                          WHBONB
     I              BSCVNB                          WHCVNB
     I              BSB0DT                          WHB0DT
     I              BSAAVN                          WHAAVN
     I              BSAADT                          WHAADT
     I              BSAMTM                          WHAMTM
     I              BSAJST                          WHAJST
     I              BSAHVN                          WHAHVN
     I              BSAGVN                          WHAGVN
     I              BSABVN                          WHABVN
     I              BSABDT                          WHABDT
     I              BSABTM                          WHABTM
     I              BSB8DT                          WHB8DT
     I              BSAOTM                          WHAOTM
      *
     IYBRDCS      DS                            110
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WKHMNB
     I              A1BNNB                          WKBNNB
     I              A1BONB                          WKBONB
     I              A1CVNB                          WKCVNB
     I              A1B0DT                          WKB0DT
     I              A1AWDT                          WKAWDT
     I              A1BICD                          WKBICD
     I              A1CPST                          WKCPST
     I              A1ACPR                          WKACPR
     I              A1B9PR                          WKB9PR
     I              A1CAPR                          WKCAPR
     I              A1C4ST                          WKC4ST
     I              A1AIPR                          WKAIPR
     I              A1A6DT                          WKA6DT
     I              A1C2ST                          WKC2ST
     I              A1CXNB                          WKCXNB
     I              A1CWNB                          WKCWNB
     I              A1FCNB                          WKFCNB
     I              A1H9NB                          WKH9NB
     I              A1FDNB                          WKFDNB
     I              A1FENB                          WKFENB
     I              A1HENB                          WKHENB
     I              A1HFNB                          WKHFNB
     I              A1CYNB                          WKCYNB
     I              A1LRNB                          WKLRNB
     I              A1E0NB                          WKE0NB
     I              A1A5PC                          WKA5PC
     I              A1FBNB                          WKFBNB
     I              A1A4PC                          WKA4PC
     I              A1F7NB                          WKF7NB
     I              A1HDNB                          WKHDNB
     I              A1F5NB                          WKF5NB
     I              A1F4NB                          WKF4NB
     I              A1F3NB                          WKF3NB
     I              A1F2NB                          WKF2NB
     I              A1AVPC                          WKAVPC
     I              A1AWPC                          WKAWPC
     I              A1CWPC                          WKCWPC
     I              A1A8PC                          WKA8PC
     I              A1A7PC                          WKA7PC
     I              A1B8PR                          WKB8PR
     I              A1AMPR                          WKAMPR
     I              A1ANPR                          WKANPR
     I              A1AYVA                          WKAYVA
     I              A1AWVA                          WKAWVA
     I              A1AOPR                          WKAOPR
     I              A1AXVA                          WKAXVA
     I              A1APPR                          WKAPPR
     I              A1ASPR                          WKASPR
     I              A1A4VA                          WKA4VA
     I              A1ATPR                          WKATPR
     I              A1A5VA                          WKA5VA
     I              A1CBPR                          WKCBPR
     I              A1CCPR                          WKCCPR
     I              A1LPNB                          WKLPNB
     I              A1CDPR                          WKCDPR
     I              A1A7VA                          WKA7VA
     I              A1A2PR                          WKA2PR
     I              A1JWST                          WKJWST
     I              A1CWST                          WKCWST
     I              A1D7ST                          WKD7ST
     I              A1D8ST                          WKD8ST
     I              A1DWST                          WKDWST
     I              A1D6ST                          WKD6ST
     I              A1GHNB                          WKGHNB
     I              A1BYDT                          WKBYDT
     I              A1E0ST                          WKE0ST
     I              A1E1ST                          WKE1ST
     I              A1E2ST                          WKE2ST
     I              A1BSDT                          WKBSDT
     I              A1BTDT                          WKBTDT
     I              A1BUDT                          WKBUDT
     I              A1HGNB                          WKHGNB
     I              A1HHNB                          WKHHNB
     I              A1HINB                          WKHINB
     I              A1A3PR                          WKA3PR
     I              A1A4PR                          WKA4PR
     I              A1A6PR                          WKA6PR
     I              A1J9NB                          WKJ9NB
     I              A1D6PR                          WKD6PR
     I              A1D7PR                          WKD7PR
     I              A1D8PR                          WKD8PR
     I              A1D9PR                          WKD9PR
     I              A1EAPR                          WKEAPR
     I              A1EBPR                          WKEBPR
     I              A1ECPR                          WKECPR
     I              A1EDPR                          WKEDPR
     I              A1EEPR                          WKEEPR
     I              A1EFPR                          WKEFPR
     I              A1EGPR                          WKEGPR
     I              A1EHPR                          WKEHPR
     I              A1KAST                          WKKAST
     I              A1J7ST                          WKJ7ST
     I              A1J9ST                          WKJ9ST
     I              A1OXNB                          WKOXNB
     I              A1LKST                          WKLKST
     I              A1LLST                          WKLLST
     I              A1J8ST                          WKJ8ST
     I              A1LIST                          WKLIST
     I              A1LJST                          WKLJST
     I              A1NZTX                          WKNZTX
     I              A1HJCD                          WKHJCD
     I              A1R4ST                          WKR4ST
     I              A1R5ST                          WKR5ST
     I              A1R6ST                          WKR6ST
     I              A1R7ST                          WKR7ST
     I              A1THWT                          WKTHWT
     I              A1T2WT                          WKT2WT
     I              A1THHD                          WKTHHD
     I              A1T2HD                          WKT2HD
     I              A1OBPR                          WKOBPR
     I              A1KOER                          WKKOER
     I              A1OPIR                          WKOPIR
     I              A1OPEM                          WKOPEM
     I              A1IORP                          WKIORP
     I              A1OWEO                          WKOWEO
     I              A1OQET                          WKOQET
     I              A1URST                          WKURST
     I              A1USST                          WKUSST
     I              A1HHPC                          WKHHPC
     I              A1S9PR                          WKS9PR
     I              A1TAPR                          WKTAPR
     I              A1TBPR                          WKTBPR
     I              A1JFUR                          WKJFUR
     I              A1KRIF                          WKKRIF
     I              A1KORF                          WKKORF
     I              A1KAPR                          WKKAPR
     I              A1KROT                          WKKROT
     I              A1OTJG                          WKOTJG
     I              A1IRJG                          WKIRJG
     I              A1IMJF                          WKIMJF
     I              A1IRGF                          WKIRGF
     I              A1KRJF                          WKKRJF
     I              A1OJRF                          WKOJRF
     I              A1KFOR                          WKKFOR
     I              A1ORJK                          WKORJK
     I              A1OMVJ                          WKOMVJ
     I              A1MVNF                          WKMVNF
     I              A1MCNF                          WKMCNF
     I              A1NCNF                          WKNCNF
     I              A1NCHF                          WKNCHF
     I              A1IGIR                          WKIGIR
     I              A1KFJR                          WKKFJR
     I              A1EADT                          WKEADT
     I              A1EBDT                          WKEBDT
     I              A1ECDT                          WKECDT
     I              A1EDDT                          WKEDDT
     I              A1EEDT                          WKEEDT
     I              A1U4ST                          WKU4ST
     I              A1U5ST                          WKU5ST
     I              A1U6ST                          WKU6ST
     I              A1U7ST                          WKU7ST
     I              A1U8ST                          WKU8ST
     I              A1U9ST                          WKU9ST
     I              A1VAST                          WKVAST
     I              A1VBST                          WKVBST
     I              A1BDCD                          WKBDCD
     I              A1CSCD                          WKCSCD
     I              A1ABCD                          WKABCD
     I              A1AECD                          WKAECD
     I              A1ACCD                          WKACCD
     I              A1AGCD                          WKAGCD
     I              A1BECD                          WKBECD
     I              A1AAVN                          WKAAVN
     I              A1AADT                          WKAADT
     I              A1AMTM                          WKAMTM
     I              A1AJST                          WKAJST
     I              A1AHVN                          WKAHVN
     I              A1AGVN                          WKAGVN
     I              A1ABVN                          WKABVN
     I              A1ABDT                          WKABDT
     I              A1ABTM                          WKABTM
      *
     IYCRDCS      DS                            582
     IQPKDY1    E DSPKDYCPL0
      * UPD : Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WOHMNB
     I              DYBNNB                          WOBNNB
     I              DYBONB                          WOBONB
     I              DYCVNB                          WOCVNB
     I              DYB0DT                          WOB0DT
     I              DYC2NB                          WOC2NB
     I              DYP3ST                          WOP3ST
     I              DYLENB                          WOLENB
     I              DYLFNB                          WOLFNB
     I              DYLINB                          WOLINB
     I              DYP4ST                          WOP4ST
     I              DYP5ST                          WOP5ST
     I              DYAAVN                          WOAAVN
     I              DYAADT                          WOAADT
     I              DYAMTM                          WOAMTM
     I              DYAJST                          WOAJST
     I              DYAHVN                          WOAHVN
     I              DYAGVN                          WOAGVN
     I              DYABVN                          WOABVN
     I              DYABDT                          WOABDT
     I              DYABTM                          WOABTM
      *
     IYDRDCS      DS                             87
     IYERDCS      DS                            143
     IYFRDCS      DS                            143
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYGRDCS      DS                            143
     IYHRDCS      DS                            143
     IYIRDCS      DS                            143
     IYJRDCS      DS                            143
     IYKRDCS      DS                            143
     IYLRDCS      DS                            143
     IYMRDCS      DS                            143
     IYNRDCS      DS                            143
     IYORDCS      DS                            582
     IYPRDCS      DS                             87
      /EJECT
      * Parameter declarations
     IP1PARM      DS                            582
      * RCD: Tattoo Header             Retrieval index
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  BOH Buy Order Number
     I                                    P   3   50P1BNNB
      * I :  BOL Load Number
     I                                    P   6   80P1BONB
      * I :  TH Tattoo Number
     I                                    P   9  110P1CVNB
      * I :  TH Kill Date
     I                                    P  12  150P1B0DT
      * I :  TH Purchase Date
     I                                    P  16  190P1AWDT
      * I :  TH Group Reference
     I                                       20  29 P1BICD
      * I :  TH Live Purchase UOM
     I                                       30  31 P1CPST
      * I :  TH Live Purchase Price
     I                                    P  32  342P1ACPR
      * I :  TH Live Gross Amt
     I                                    P  35  382P1B9PR
      * I :  TH LIve Net Amt
     I                                    P  39  422P1CAPR
      * I :  TH Resale UOM
     I                                       43  44 P1C4ST
      * I :  TH Recalc Live Wgt Yld
     I                                    P  45  472P1AIPR
      * I :  TH Pricing Date
     I                                    P  48  510P1A6DT
      * I :  TH Resale Spread Sts
     I                                       52  52 P1C2ST
      * I :  TH Dead On Arrival
     I                                    P  53  550P1CXNB
      * I :  TH Head Received
     I                                    P  56  580P1CWNB
      * I :  TH Yard Deads
     I                                    P  59  610P1FCNB
      * I :  TH Held Over
     I                                    P  62  640P1H9NB
      * I :  TH Head Condemned
     I                                    P  65  670P1FDNB
      * I :  TH Head Killed
     I                                    P  68  700P1FENB
      * I :  TH Head Adds
     I                                    P  71  730P1HENB
      * I :  TH Head Accepted
     I                                    P  74  760P1HFNB
      * I :  TH Live Wgt
     I                                    P  77  801P1CYNB
      * I :  TH Adj Live Wgt
     I                                    P  81  841P1LRNB
      * I :  TH Hot Wgt
     I                                    P  85  881P1E0NB
      * I :  TH Tot Loin Eye Depth
     I                                    P  89  921P1A5PC
      * I :  TH Tot Backfat Inches
     I                                    P  93  961P1FBNB
      * I :  TH Tot Light Reflectance
     I                                    P  97 1001P1A4PC
      * I :  TH Avg Live Wgt
     I                                    P 101 1031P1F7NB
      * I :  TH Avg Hot Wgt
     I                                    P 104 1061P1HDNB
      * I :  TH Avg Light Reflectance
     I                                    P 107 1081P1F5NB
      * I :  TH Avg Lean Percent
     I                                    P 109 1101P1F4NB
      * I :  TH Avg Loin Eye Depth
     I                                    P 111 1121P1F3NB
      * I :  TH Avg Backfat
     I                                    P 113 1141P1F2NB
      * I :  TH Std Yield Percent
     I                                    P 115 1172P1AVPC
      * I :  TH Actual Yield %
     I                                    P 118 1202P1AWPC
      * I :  TH Adj Actual Yield %
     I                                    P 121 1232P1CWPC
      * I :  TH Yield Difference
     I                                    P 124 1262P1A8PC
      * I :  TH Recalc Live Wgt
     I                                    P 127 1281P1A7PC
      * I :  TH CM Market Price
     I                                    P 129 1312P1B8PR
      * I :  TH CM Base Mkt Price
     I                                    P 132 1342P1AMPR
      * I :  TH CM Base Mkt Price Amt
     I                                    P 135 1382P1ANPR
      * I :  TH CM Sort Discount Amt
     I                                    P 139 1422P1AYVA
      * I :  TH CM Yield Gain/Loss Amt
     I                                    P 143 1462P1AWVA
      * I :  TH CM Base Carcass Value
     I                                    P 147 1502P1AOPR
      * I :  TH CM LN AddOn/Deduct Amt
     I                                    P 151 1542P1AXVA
      * I :  TH CM Carcass Gross Amt
     I                                    P 155 1582P1APPR
      * I :  TH Deduction Amt
     I                                    P 159 1622P1ASPR
      * I :  TH Total Net WO Adds
     I                                    P 163 1662P1A4VA
      * I :  TH Carcass Net Amt
     I                                    P 167 1702P1ATPR
      * I :  TH Additions Amt
     I                                    P 171 1742P1A5VA
      * I :  TH Payment Gross
     I                                    P 175 1782P1CBPR
      * I :  Th Payment Net Amt
     I                                    P 179 1822P1CCPR
      * I :  TH AP Voucher/Document#
     I                                    P 183 1870P1LPNB
      * I :  TH Freight Amount
     I                                    P 188 1912P1CDPR
      * I :  TH Accrual Amount
     I                                    P 192 1952P1A7VA
      * I :  TH Fixed Cost Amount
     I                                    P 196 1992P1A2PR
      * I :  TH Calc Net Sts
     I                                      200 200 P1JWST
      * I :  TH Payment Sts
     I                                      201 202 P1CWST
      * N :  TH Header Error Sts
     I                                      203 203 P1D7ST
      * N :  TH Detail Error Sts
     I                                      204 204 P1D8ST
      * N :  TH Kill Balancing Sts
     I                                      205 205 P1DWST
      * I :  TH Bal to Kill Gen
     I                                      206 206 P1D6ST
      * I :  TH Commission A/P Voucher
     I                                      207 2140P1GHNB
      * I :  TH Voucher Payment Date
     I                                    P 215 2180P1BYDT
      * I :  TH User Error Override
     I                                      219 219 P1E0ST
      * I :  TH Held Over Record
     I                                      220 220 P1E1ST
      * I :  TH Sex
     I                                      221 221 P1E2ST
      * I :  TH Held/Ovr Completed Dte
     I                                    P 222 2250P1BSDT
      * I :  TH Commission Paid Date
     I                                    P 226 2290P1BTDT
      * I :  TH Actual Check Date
     I                                    P 230 2330P1BUDT
      * I :  TH Shipped Weight
     I                                    P 234 2371P1HGNB
      * I :  TH Avg Hot Wgt EXC/ADD
     I                                    P 238 2411P1HHNB
      * I :  TH FFLI
     I                                    P 242 2431P1HINB
      * I :  TH Kill Product Value
     I                                    P 244 2472P1A3PR
      * I :  TH Cut Product Value
     I                                    P 248 2512P1A4PR
      * I :  TH Render Product Value
     I                                    P 252 2552P1A6PR
      * I :  TH Head Excluded
     I                                    P 256 2580P1J9NB
      * I :  TH CM Bse Mkt Live /CWT
     I                                    P 259 2612P1D6PR
      * I :  TH CM Bse Mkt Carc /CWT
     I                                    P 262 2642P1D7PR
      * I :  TH CM Srt Dsc Live /CWT
     I                                    P 265 2672P1D8PR
      * I :  TH CM Srt Dsc Carc /CWT
     I                                    P 268 2702P1D9PR
      * I :  TH CM Yld G/L Live /CWT
     I                                    P 271 2732P1EAPR
      * I :  TH CM Yld G/L Carc /CWT
     I                                    P 274 2762P1EBPR
      * I :  TH CM Crc Val Live /CWT
     I                                    P 277 2792P1ECPR
      * I :  TH CM Crc Val Carc /CWT
     I                                    P 280 2822P1EDPR
      * I :  TH CM Lean Prem Live /CWT
     I                                    P 283 2852P1EEPR
      * I :  TH CM Lean Prem Carc /CWT
     I                                    P 286 2882P1EFPR
      * I :  TH CM Gross Live /CWT
     I                                    P 289 2912P1EGPR
      * I :  TH CM Gross Carc /CWT
     I                                    P 292 2942P1EHPR
      * I :  TH Source Type
     I                                      295 295 P1KAST
      * I :  TH Scale Ticket Sts
     I                                      296 296 P1J7ST
      * I :  TH Payment Type
     I                                      297 297 P1J9ST
      * I :  TH HPS Movement Ref #
     I                                    P 298 3010P1OXNB
      * I :  TH Source Code
     I                                      302 304 P1LKST
      * I :  TH Hog Class Type
     I                                      305 305 P1LLST
      * I :  TH Posted to HPS Flag
     I                                      306 306 P1J8ST
      * I :  TH Schedule Kill Shift
     I                                      307 307 P1LIST
      * I :  TH Shift Held Over
     I                                      308 308 P1LJST
      * I :  DF Defect Code
     I                                      491 496 P1BDCD
      * I :  THP Process Code
     I                                      497 502 P1CSCD
      * I :  PD Producer Code
     I                                      503 508 P1ABCD
      * I :  PL Location Code
     I                                      509 514 P1AECD
      * I :  HB Buyer Code
     I                                      515 517 P1ACCD
      * I :  GN Genetic Code
     I                                      518 522 P1AGCD
      * I :  HC Class Code
     I                                      523 525 P1BECD
      * I :  RS User Changed
     I                                      526 535 P1AAVN
      * I :  RS Date Changed
     I                                    P 536 5390P1AADT
      * I :  RS Time Changed
     I                                    P 540 5430P1AMTM
      * I :  RS Record Status
     I                                      544 544 P1AJST
      * I :  RS Job
     I                                      545 554 P1AHVN
      * I :  RS Program
     I                                      555 564 P1AGVN
      * I :  RS User Added
     I                                      565 574 P1ABVN
      * I :  RS Date Added
     I                                    P 575 5780P1ABDT
      * I :  RS Time Added
     I                                    P 579 5820P1ABTM
     IP2PARM      DS
      * FLD: STR Evaluation Min/Max
      * I :  Carcass Dbw Min
     I                                    P   1   41P2I7NB
      * I :  Carcass Dbw Max
     I                                    P   5   81P2I8NB
      * I :  Carcass Lgt Min
     I                                    P   9  121P2I9NB
      * I :  Carcass Lgt Max
     I                                    P  13  161P2JANB
      * I :  %Lean High Min
     I                                    P  17  201P2JBNB
      * I :  %Lean High Max
     I                                    P  21  241P2JLNB
      * I :  %Lean Low Min
     I                                    P  25  281P2JMNB
      * I :  %Lean Low Max
     I                                    P  29  321P2JCNB
      * I :  High Yield Min
     I                                    P  33  361P2JDNB
      * I :  High Yield Max
     I                                    P  37  401P2JENB
      * I :  Low Yield Min
     I                                    P  41  441P2JFNB
      * I :  Low Yield Max
     I                                    P  45  481P2JGNB
      * I :  Head < Percent Min
     I                                    P  49  521P2JHNB
      * I :  Head < Percent Max
     I                                    P  53  561P2JINB
      * I :  Head > Percent Min
     I                                    P  57  601P2JJNB
      * I :  Head > Percent Max
     I                                    P  61  641P2JKNB
      * I :  BackFat High Min
     I                                    P  65  681P2K5NB
      * I :  BackFat High Max
     I                                    P  69  721P2K6NB
      * I :  BackFat Low Min
     I                                    P  73  761P2K7NB
      * I :  Backfat Low Max
     I                                    P  77  801P2K8NB
      * I :  LoinEye High Min
     I                                    P  81  841P2K9NB
      * I :  LoinEye High Max
     I                                    P  85  881P2LANB
      * I :  LoinEye Low Min
     I                                    P  89  921P2LBNB
      * I :  LoinEye Low Max
     I                                    P  93  961P2LCNB
     IP3PARM      DS
      * I :  Requested by User to Bal
     I                                        1   1 P3G2ST
     IP4PARM      DS
      * I :  Bal w/History
     I                                        1   1 P4VRST
     IP5PARM      DS
      * FLD: Tattoo Header
      * I :  TH PHA Add Type
     I                                        1   1 P5OQET
      * I :  TH PHA Average Type
     I                                        2   4 P5URST
      * I :  TH PHA Add Reason
     I                                        5   5 P5USST
     IP6PARM      DS
      * FLD: Producer History WKLY
      * I :  PH GA Adjusted Yield%
     I                                    P   1   32P6G9PC
      * I :  PH GA Avg Lean%
     I                                    P   4   51P6HBPC
      * I :  PH GA Avg Backfat
     I                                    P   6   71P6UWOE
      * I :  PH GA Avg Loin Eye
     I                                    P   8   91P6HEPC
      * I :  PH GA Avg Light Ref
     I                                    P  10  111P6HGPC
      * I :  PH GA Lean Prm /Carc CWT
     I                                    P  12  142P6TIPR
      * I :  PH GA Avg Srt Disc Fctr
     I                                    P  15  173P6B8A1
     IP7PARM      DS
      * I :  Undo MPR USR
     I                                        1   1 P7WFST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Pay Note:LN% Used Lot Av'
      * Message data for 'Pay Note: Use Prd's HstAV'
      * PH Summary Type
     I                                        1   3 ZA0001
      * Message data for 'Pay Note: Heldover'
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note: <75% Accepted'
      * TH PHA Average Type
     I                                        1   3 ZA0002
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: Heldover'
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: >105 ID'
      * TH PHA Average Type
     I                                        1   3 ZA0003
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: <75% Accepted'
      * TH PHA Average Type
     I                                        1   3 ZA0004
      * Message data for 'Pay Note: 2WK/4WK/HST'
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      * Message data for 'Pay Note: >75% Accepted'
      * Message data for 'Pay Note: >75% Accepted2'
      * Message data for 'Pay Note: >100% <105%'
      * Message data for 'Pay Note: >100% <105% 2'
      * Message data for 'Pay Note: >100% <105% 3'
      * Message data for 'Pay Note: Yield Parm'
      * TH Yld Parm Adj Yield%
     I                                    P   1   32ZA0005
      * TH PHA Average Type
     I                                        4   6 ZA0006
      * Message data for 'Pay Note: Yield Parm 2'
      * TH Yld Parm Adj Yield%
     I                                    P   1   32ZA0007
      * TH PHA Average Type
     I                                        4   6 ZA0008
      * Message data for 'Pay Note: Yield Parm 3'
      * TH Yld Parm Adj Yield%
     I                                    P   1   32ZA0009
      * TH PHA Average Type
     I                                        4   6 ZA0010
      * Message data for 'Pay Note:HW Lot Avg'
      * Message data for 'Pay Note:HW Hst LW/Yld'
      * Message data for 'Pay Note:HW Hst LW/Yld 2'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           RCD: Tattoo Hea
     C           P2I7NB    PARM           WP0001  71       Carcass Dbw Min
     C           P2I8NB    PARM           WP0002  71       Carcass Dbw Max
     C           P2I9NB    PARM           WP0003  71       Carcass Lgt Min
     C           P2JANB    PARM           WP0004  71       Carcass Lgt Max
     C           P2JBNB    PARM           WP0005  71       %Lean High Min
     C           P2JLNB    PARM           WP0006  71       %Lean High Max
     C           P2JMNB    PARM           WP0007  71       %Lean Low Min
     C           P2JCNB    PARM           WP0008  71       %Lean Low Max
     C           P2JDNB    PARM           WP0009  71       High Yield Min
     C           P2JENB    PARM           WP0010  71       High Yield Max
     C           P2JFNB    PARM           WP0011  71       Low Yield Min
     C           P2JGNB    PARM           WP0012  71       Low Yield Max
     C           P2JHNB    PARM           WP0013  71       Head < Percent
     C           P2JINB    PARM           WP0014  71       Head < Percent
     C           P2JJNB    PARM           WP0015  71       Head > Percent
     C           P2JKNB    PARM           WP0016  71       Head > Percent
     C           P2K5NB    PARM           WP0017  71       BackFat High Mi
     C           P2K6NB    PARM           WP0018  71       BackFat High Ma
     C           P2K7NB    PARM           WP0019  71       BackFat Low Min
     C           P2K8NB    PARM           WP0020  71       Backfat Low Max
     C           P2K9NB    PARM           WP0021  71       LoinEye High Mi
     C           P2LANB    PARM           WP0022  71       LoinEye High Ma
     C           P2LBNB    PARM           WP0023  71       LoinEye Low Min
     C           P2LCNB    PARM           WP0024  71       LoinEye Low Max
     C           P3G2ST    PARM           WP0025  1        Requested by Us
     C           P4VRST    PARM           WP0026  1        Bal w/History
     C           P5OQET    PARM           WP0027  1        TH PHA Add Type
     C           P5URST    PARM           WP0028  3        TH PHA Average
     C           P5USST    PARM           WP0029  1        TH PHA Add Reas
     C           P6G9PC    PARM           WP0030  52       PH GA Adjusted
     C           P6HBPC    PARM           WP0031  31       PH GA Avg Lean%
     C           P6UWOE    PARM           WP0032  31       PH GA Avg Backf
     C           P6HEPC    PARM           WP0033  31       PH GA Avg Loin
     C           P6HGPC    PARM           WP0034  31       PH GA Avg Light
     C           P6TIPR    PARM           WP0035  52       PH GA Lean Prm
     C           P6B8A1    PARM           WP0036  53       PH GA Avg Srt D
     C           P7WFST    PARM           WP0037  1        Undo MPR USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bal/Val Tattoo copy   zz
      * Initialize
      * CASE: LCL.#Sequence Block is NULL
     C           YL0001    IFEQ *BLANK                     *IF
      * Delete All Errors for Tattoo if exists.
      * Dlt All Error's       RT - Eval/Loss Error  * 
     C                     EXSR SARVGN
      * Initialize Evaluation Transaction for re-balancing.
      * Bal Init Eval Trans   RT - Eval Trans  * 
     C                     EXSR SCRVGN
      * Delete Payment Tattoo Header Comments.
      * Del Payment Comments  RT - Tattoo Header Comment  * 
     C                     EXSR SFRVGN
      * Set Status fields to begining value
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL*BLANK    YL0004           TH Kill Balanci
     C                     MOVEL*BLANK    YL0005           THP Process Cod
     C                     MOVEL'SLG'     YL0005           THP Process Cod
      * LCL.TH Bal to Kill Gen
      * CASE: PAR.Requested by User to Bal is Yes
     C           P3G2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'U'       YL0006           TH Bal to Kill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1D6ST    YL0006           TH Bal to Kill
     C                     END                             *FI
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       BOH Company Num
     C                     PARM @CN,01    WQ0002 10        Company Value C
     C           YL0007    PARM *BLANK    WQ0003 40        System Value Al
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'N'       YL0008           Hold Over Bal S
     C                     END                             *FI
      * Tattoo Header Accumulate/Validate Loss Transaction
      * CASE: LCL.#Sequence Block is NULL
     C           YL0001    IFEQ *BLANK                     *IF
      * Rtv Bal/Tattoo Hdr    RT - Loss Trans  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * Tattoo Header Accumulate/Validate Evaluation Records
      * CASE: LCL.#Sequence Block is NULL
     C           YL0001    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           P1CWNB    SUB  P1FCNB    YL0011           Net Head Usr
     C                     SUB  YL0009    YL0011           Net Head Usr
     C           YL0009    ADD  P1FCNB    YL0012           Net Head Adjust
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ABCD' defaulted for 'PD Producer Code'.
      * Bal/Val Eval Trans    RT - Eval Trans  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
      * Calculate Percent Identified & Percent Accepted
      * CASE: LCL.Net Head Usr is Not Zero
     C           YL0011    IFNE *ZERO                      *IF
      * Percent Identified
      * LCL.TH Percent Identified =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Head Identified
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0021    DIV  YL0011    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0079           TH Percent Iden
      * Percent Analyzed
      * LCL.TH Percent Analyzed =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Head Accepted
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  YL0011    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0080           TH Percent Acce
     C                     END                             *FI
      * Calculate Tattoo Header Averages/yield
     C                     EXSR UDSUBR                     Calculate Tatto
      * Re-Calculate for Held Overs: %ID, %Anal, AvgHtWgt f/EXC, Adj Yiel
      * CASE: PAR.TH Held Over Record is Yes
     C           P1E1ST    IFEQ 'Y'                        *IF
      * ** WRK is accumulated values, LCL is for current record. **
      *    We will overlay the LCL values of current record with both
      *    days combined.
      * Combine the two days for hold over.
     E* Y2V3111 - Actual parameter(s) not found
      * Rtv Tot Hd ID/Anl/Net RT - Tattoo Header  * 
     C                     EXSR NARVGN
      * WRK.Net Head Usr
      * WRK.Net Head Usr =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : WRK.TH Head Received
      * -     : PGM.*Synon (15,0) work field
      * x2    : WRK.TH Yard Deads
      * -     : PGM.*Synon (15,0) work field
      * x3    : WRK.TH Head Condemned
     C           WUCWNB    SUB  WUFCNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WUFDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUF6NB           Net Head Usr
      * LCL.Percent Identified
      * LCL.TH Percent Identified =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Head Identified
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUKOER    DIV  WUF6NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0079           TH Percent Iden
      * LCL.Percent Analyzed
      * LCL.TH Percent Accepted =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Head Accepted
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.Net Head Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUHFNB    DIV  WUF6NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0080           TH Percent Acce
      * WRK.Adj Live Weight
      * CASE: WRK.TH Head Received EQ WRK.Net Head Usr
     C           WUCWNB    IFEQ WUF6NB                     *IF
     C                     Z-ADDWUCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: WRK.Net Head Usr EQ LCL.Zero USR
     C           WUF6NB    IFEQ YL0082                     *IF
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
      * WRK.Net Head Adjusted Usr
      * WRK.Net Head Adjusted Usr =
      *    *COMPUTE (x1 + x2)
      * x1    : WRK.TH Head Condemned
      * +     : PGM.*Synon (15,0) work field
      * x2    : WRK.TH Yard Deads
     C           WUFDNB    ADD  WUFCNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUZANB           Net Head Adjust
     C           WUZANB    MULT YL0084    YL0083           *Synon (15,2) w
     C           WUCYNB    SUB  YL0083    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     END                             *FI
      * LCL.Adj Actual Yield
      * CASE: WRK.TH Adj Live Wgt NE LCL.Zero USR
     C           WULRNB    IFNE YL0082                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  WULRNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0085           TH Adj Actual Y
     C                     END                             *FI
      * LCL.Average Hot Weight for Exclude or Add
      * CASE: WRK.TH Head Killed NE LCL.Zero USR
     C           WUFENB    IFNE YL0082                     *IF
      * Accumulated totals div by head killed
     C           WUE0NB    DIV  WUFENB    YL0087    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0087           TH Avg Hot Wgt
     C                     END                             *FI
      * LCL.Average Lean Percent for Exclude or Add
      * CASE: WRK.TH Hot Wgt is Greater then Zero
     C           WUE0NB    IFGT *ZERO                      *IF
      * LCL.TH Avg Lean % EXC/ADD
      * LCL.TH Avg Lean % EXC/ADD =
      *    *COMPUTE ((x1 + (x2 * x3)) / x4)
      * x1    : WRK.Hot Wgt/Lean % Accum Usr
      * +     : PGM.*Synon (17,7) work field
      * x2    : LCL.TH Avg Lean Percent
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x4    : WRK.TH Hot Wgt
     C           YL0088    MULT YL0016    W0WD02           *Synon (17,7) w
     C           WUJONB    ADD  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  WUE0NB    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0092           TH Avg Lean % E
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Undo MPR USR is No
     C           P7WFST    IFEQ 'N'                        *IF
      * Balance Tattoo
      * CASE: Not HO Tattoo | User Bal | Auto Bal HO
      *  - (c1 AND c2) OR c4 OR c5
      *   |- c1    : PAR.TH Held Over is *Zeros
      *   |- c2    : PAR.TH Held Over Record is Not a Held Over Ttt Rcd
      *   |- c4    : LCL.TH Bal to Kill Gen is User Requested Generated
      *   |- c5    : LCL.Auto Balance HldOvr USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1H9NB    IFEQ *ZERO                      *IF
     C           P1E1ST    IFEQ *BLANK                     *IF
     C           P1E1ST    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0006    IFEQ 'U'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0007    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Held Over Tattoo
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : PAR.TH Held Over is greater than 0
      *   |- c2    : PAR.TH Held Over Record is Yes
      *   |- c3    : LCL.Net Head Usr is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           P1H9NB    IFGT *ZERO                      *IF
     C           P1E1ST    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           YL0011    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Held Over KillDt  RT - Tattoo Header  * 
     C                     EXSR NBRVGN
      * CASE: PAR.TH Held Over Record is Yes
     C           P1E1ST    IFEQ 'Y'                        *IF
      * LCL.Day of Week USR = PAR.TH Kill Date *DAY OF WEEK
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C           XDAY1     ADD  3         XDWK1   80
     C                     DIV  7         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     Z-ADD7         XDWK1
     C                     END
     C           XDAY1     SUB  XDWK1     XDAY2   60
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0095
      * LCL.Held Over Days USR = PAR.TH Kill Date - LCL.Kill Date Usr *DA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0094    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0096
     C                     ELSE
     C           XDURR     MULT -1        YL0096
     C                     END
      * Monday or Held Over Days > 1
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Day of Week USR is Mon
      *   |- c2    : LCL.Held Over Days USR is GT 1
      *   '-
     C           YL0095    IFEQ 1                          *IF
     C           YL0096    ORGT 1                          *OR
     C                     MOVEL'E'       YL0097           TH PHA Add Type
     C                     MOVEL'4'       YL0098           TH PHA Add Reas
      * Setup message data for message
      * Retrieve message Pay Note: Heldover
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0932' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR NCRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0101    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0101    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0111           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0110    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6G9PC    YL0103           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0108           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0107           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0104           PH GA Avg Lean%
      * Setup message data for message
     C                     MOVELP5URST    ZA0002           TH PHA Average
      * Retrieve message Pay Note: <75% Accepted
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0935' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0109    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HDNB' defaulted for 'TH Avg Hot Wgt'.
      * Field '(PAR) P1A7PC' defaulted for 'TH Recalc Live Wgt'.
      *
     C                     Z-ADD*ZERO     WN0236  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0237  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0238  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0239  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0240  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0241  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0242  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0243  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0244  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0245  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0114           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0111    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0245           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0111    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0245           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0111    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0245           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ *ZERO                      *IF
     C           P1A7PC    ORGT *ZERO                      *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3)
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HDNB    IFGT *ZERO                      *IF
     C           P1OPEM    IFGE 75.00                      *IF
     C           P1OPEM    IFLE 100                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDP1HDNB    WN0236           ET Hot Wgt
     C                     MOVEL'LOT'     WN0245           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0102    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0236           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0236           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0246  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0246           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NDRVGN
     C                     MOVEL'CDB'     WN0246           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NERVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0236    IFGT *ZERO                      *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0097    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR NFRVGN
     C                     Z-ADDYL0011    YL0121           Carcass Count U
     C                     Z-ADD*ZERO     YL0013           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0097    IFEQ 'B'                        *IF
     C           YL0011    SUB  YL0013    YL0121           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0105    WN0237           ET Backfat Thic
     C                     Z-ADDYL0106    WN0238           ET Loin-Eye Dep
     C                     Z-ADDYL0107    WN0244           ET Light Reflec
     C                     Z-ADDYL0104    WN0239           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0122           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0239    WQ0020  31       CD Lean Percent
     C                     PARM WN0237    WQ0021  31       CD Backfat Thic
     C                     PARM WN0238    WQ0022  31       CD Loin-Eye Dep
     C                     PARM WN0244    WQ0023  31       CD Light Reflec
     C           WN0240    PARM WN0240    WQ0024  31       CD Backfat Thic
     C           WN0241    PARM WN0241    WQ0025  31       CD Loin-Eye Dep
     C           WN0242    PARM WN0242    WQ0026  31       CD Light Reflec
     C           WN0243    PARM WN0243    WQ0027  31       CD Lean Percent
     C           YL0122    PARM YL0122    WQ0028  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0287  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0288  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0289  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0290  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0121    WN0290           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0290    DOWGT*ZERO                      *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR NHRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR NICRRC
     C                     SUB  1         WN0290           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0121    YL0113           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UGSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR NJRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR NKCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR NMCRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR NOCRRC
     C                     END                             *FI
     C                     MOVEL'Y'       YL0008           Hold Over Bal S
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.TH Held Over is greater than 0
     C           P1H9NB    IFGT *ZERO                      *IF
      * LCL.Day of Week USR = PAR.TH Kill Date *DAY OF WEEK
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C           XDAY1     ADD  3         XDWK1   80
     C                     DIV  7         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     Z-ADD7         XDWK1
     C                     END
     C           XDAY1     SUB  XDWK1     XDAY2   60
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0095
      * LCL.Held Over Days USR = LCL.Kill Date Usr - PAR.TH Kill Date *DA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           P1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           YL0094    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0096
     C                     ELSE
     C           XDURR     MULT -1        YL0096
     C                     END
      * Friday or Saturday or Held Over Days > 1
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : LCL.Day of Week USR is Fri
      *   |- c2    : LCL.Day of Week USR is Sat
      *   |- c3    : LCL.Held Over Days USR is GT 1
      *   '-
     C           YL0095    IFEQ 5                          *IF
     C           YL0095    OREQ 6                          *OR
     C           YL0096    ORGT 1                          *OR
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0029  30       CC Company Numb
     C                     PARM P1B0DT    WQ0030  70       Kill Date Usr
     C           YL0094    PARM *ZERO     WQ0031  70       Next Kill Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * LCL.Day of Week USR = LCL.Kill Date Usr *DAY OF WEEK
     C           YL0094    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C           XDAY1     ADD  3         XDWK1   80
     C                     DIV  7         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     Z-ADD7         XDWK1
     C                     END
     C           XDAY1     SUB  XDWK1     XDAY2   60
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0095
      * CASE: LCL.Day of Week USR is Mon
     C           YL0095    IFEQ 1                          *IF
     C                     MOVEL'E'       YL0097           TH PHA Add Type
     C                     MOVEL'4'       YL0098           TH PHA Add Reas
      * Setup message data for message
      * Retrieve message Pay Note: Heldover
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0932' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR NQRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0101    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0101    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0111           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0110    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6G9PC    YL0103           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0108           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0107           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0104           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0109    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HDNB' defaulted for 'TH Avg Hot Wgt'.
      * Field '(PAR) P1A7PC' defaulted for 'TH Recalc Live Wgt'.
      *
     C                     Z-ADD*ZERO     WN0291  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0292  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0293  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0294  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0295  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0296  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0297  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0298  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0299  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0300  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0114           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0111    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0300           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0111    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0300           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0111    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0300           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ *ZERO                      *IF
     C           P1A7PC    ORGT *ZERO                      *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3)
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HDNB    IFGT *ZERO                      *IF
     C           P1OPEM    IFGE 75.00                      *IF
     C           P1OPEM    IFLE 100                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDP1HDNB    WN0291           ET Hot Wgt
     C                     MOVEL'LOT'     WN0300           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0102    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0291           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0291           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0301  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0301           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NRRVGN
     C                     MOVEL'CDB'     WN0301           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR NSRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0291    IFGT *ZERO                      *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0097    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR NTRVGN
     C                     Z-ADDYL0011    YL0121           Carcass Count U
     C                     Z-ADD*ZERO     YL0013           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0097    IFEQ 'B'                        *IF
     C           YL0011    SUB  YL0013    YL0121           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0105    WN0292           ET Backfat Thic
     C                     Z-ADDYL0106    WN0293           ET Loin-Eye Dep
     C                     Z-ADDYL0107    WN0299           ET Light Reflec
     C                     Z-ADDYL0104    WN0294           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0122           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0294    WQ0032  31       CD Lean Percent
     C                     PARM WN0292    WQ0033  31       CD Backfat Thic
     C                     PARM WN0293    WQ0034  31       CD Loin-Eye Dep
     C                     PARM WN0299    WQ0035  31       CD Light Reflec
     C           WN0295    PARM WN0295    WQ0036  31       CD Backfat Thic
     C           WN0296    PARM WN0296    WQ0037  31       CD Loin-Eye Dep
     C           WN0297    PARM WN0297    WQ0038  31       CD Light Reflec
     C           WN0298    PARM WN0298    WQ0039  31       CD Lean Percent
     C           YL0122    PARM YL0122    WQ0040  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0342  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0343  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0344  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0345  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0121    WN0345           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0345    DOWGT*ZERO                      *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR NVRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR NWCRRC
     C                     SUB  1         WN0345           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0121    YL0113           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UISUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR NXRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR NYCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR OACRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR OCCRRC
     C                     END                             *FI
     C                     MOVEL'Y'       YL0008           Hold Over Bal S
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Percent Identified & Percent Analyzed Parameter Balancing
      * CASE: LCL.Net Head Usr is GT Zero
     C           YL0011    IFGT *ZERO                      *IF
      * CASE: PAR.Bal w/History is Prior Week History
     C           P4VRST    IFEQ 'P'                        *IF
     C                     MOVELP5OQET    YL0097           TH PHA Add Type
     C                     MOVELP5USST    YL0098           TH PHA Add Reas
     C                     MOVELP5URST    YL0111           TH PHA Average
     C                     Z-ADDP6G9PC    YL0103           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0108           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0107           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0104           PH GA Avg Lean%
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HDNB' defaulted for 'TH Avg Hot Wgt'.
      * Field '(PAR) P1A7PC' defaulted for 'TH Recalc Live Wgt'.
      *
     C                     Z-ADD*ZERO     WN0346  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0347  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0348  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0349  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0350  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0351  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0352  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0353  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0354  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0355  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0114           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0111    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0355           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0111    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0355           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0111    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0355           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ *ZERO                      *IF
     C           P1A7PC    ORGT *ZERO                      *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3)
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HDNB    IFGT *ZERO                      *IF
     C           P1OPEM    IFGE 75.00                      *IF
     C           P1OPEM    IFLE 100                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDP1HDNB    WN0346           ET Hot Wgt
     C                     MOVEL'LOT'     WN0355           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0102    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0346           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0346           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0356  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0356           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR OERVGN
     C                     MOVEL'CDB'     WN0356           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR OFRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0346    IFGT *ZERO                      *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0097    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR OGRVGN
     C                     Z-ADDYL0011    YL0121           Carcass Count U
     C                     Z-ADD*ZERO     YL0013           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0097    IFEQ 'B'                        *IF
     C           YL0011    SUB  YL0013    YL0121           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0105    WN0347           ET Backfat Thic
     C                     Z-ADDYL0106    WN0348           ET Loin-Eye Dep
     C                     Z-ADDYL0107    WN0354           ET Light Reflec
     C                     Z-ADDYL0104    WN0349           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0122           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0349    WQ0041  31       CD Lean Percent
     C                     PARM WN0347    WQ0042  31       CD Backfat Thic
     C                     PARM WN0348    WQ0043  31       CD Loin-Eye Dep
     C                     PARM WN0354    WQ0044  31       CD Light Reflec
     C           WN0350    PARM WN0350    WQ0045  31       CD Backfat Thic
     C           WN0351    PARM WN0351    WQ0046  31       CD Loin-Eye Dep
     C           WN0352    PARM WN0352    WQ0047  31       CD Light Reflec
     C           WN0353    PARM WN0353    WQ0048  31       CD Lean Percent
     C           YL0122    PARM YL0122    WQ0049  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0397  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0398  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0399  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0400  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0121    WN0400           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0400    DOWGT*ZERO                      *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR OIRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR OJCRRC
     C                     SUB  1         WN0400           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0121    YL0113           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UKSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR OKRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR OLCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.TH Percent Identified is GT 105%
     C           YL0079    IFGT 105.00                     *IF
     C                     MOVEL'E'       YL0097           TH PHA Add Type
     C                     MOVEL'2'       YL0098           TH PHA Add Reas
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR ONRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0101    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0101    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0111           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Setup message data for message
     C                     MOVELYL0111    ZA0003           TH PHA Average
      * Retrieve message Pay Note: >105 ID
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0934' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0110    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6G9PC    YL0103           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0108           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0107           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0104           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0109    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HDNB' defaulted for 'TH Avg Hot Wgt'.
      * Field '(PAR) P1A7PC' defaulted for 'TH Recalc Live Wgt'.
      *
     C                     Z-ADD*ZERO     WN0401  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0402  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0403  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0404  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0405  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0406  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0407  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0408  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0409  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0410  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0114           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0111    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0410           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0111    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0410           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0111    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0410           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ *ZERO                      *IF
     C           P1A7PC    ORGT *ZERO                      *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3)
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HDNB    IFGT *ZERO                      *IF
     C           P1OPEM    IFGE 75.00                      *IF
     C           P1OPEM    IFLE 100                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDP1HDNB    WN0401           ET Hot Wgt
     C                     MOVEL'LOT'     WN0410           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0102    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0401           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0401           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0411  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0411           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR OORVGN
     C                     MOVEL'CDB'     WN0411           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR OPRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0401    IFGT *ZERO                      *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0097    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR OQRVGN
     C                     Z-ADDYL0011    YL0121           Carcass Count U
     C                     Z-ADD*ZERO     YL0013           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0097    IFEQ 'B'                        *IF
     C           YL0011    SUB  YL0013    YL0121           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0105    WN0402           ET Backfat Thic
     C                     Z-ADDYL0106    WN0403           ET Loin-Eye Dep
     C                     Z-ADDYL0107    WN0409           ET Light Reflec
     C                     Z-ADDYL0104    WN0404           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0122           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0404    WQ0050  31       CD Lean Percent
     C                     PARM WN0402    WQ0051  31       CD Backfat Thic
     C                     PARM WN0403    WQ0052  31       CD Loin-Eye Dep
     C                     PARM WN0409    WQ0053  31       CD Light Reflec
     C           WN0405    PARM WN0405    WQ0054  31       CD Backfat Thic
     C           WN0406    PARM WN0406    WQ0055  31       CD Loin-Eye Dep
     C           WN0407    PARM WN0407    WQ0056  31       CD Light Reflec
     C           WN0408    PARM WN0408    WQ0057  31       CD Lean Percent
     C           YL0122    PARM YL0122    WQ0058  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0452  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0453  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0454  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0455  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0121    WN0455           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0455    DOWGT*ZERO                      *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR OSRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR OTCRRC
     C                     SUB  1         WN0455           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0121    YL0113           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UMSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR OURVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR OVCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR OXCRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR OZCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.TH Percent Analyzed is LT 75%
     C           YL0080    IFLT 75.00                      *IF
     C                     MOVEL'B'       YL0097           TH PHA Add Type
     C                     MOVEL'1'       YL0098           TH PHA Add Reas
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR PBRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0101    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0101    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0111           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Setup message data for message
     C                     MOVELYL0111    ZA0004           TH PHA Average
      * Retrieve message Pay Note: <75% Accepted
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0935' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: 2WK/4WK/HST
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0947' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0110    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6G9PC    YL0103           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0108           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0107           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0104           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0109    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HDNB' defaulted for 'TH Avg Hot Wgt'.
      * Field '(PAR) P1A7PC' defaulted for 'TH Recalc Live Wgt'.
      *
     C                     Z-ADD*ZERO     WN0456  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0457  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0458  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0459  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0460  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0461  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0462  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0463  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0464  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0465  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0114           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0111    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0465           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0111    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0465           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0111    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0465           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ *ZERO                      *IF
     C           P1A7PC    ORGT *ZERO                      *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3)
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HDNB    IFGT *ZERO                      *IF
     C           P1OPEM    IFGE 75.00                      *IF
     C           P1OPEM    IFLE 100                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDP1HDNB    WN0456           ET Hot Wgt
     C                     MOVEL'LOT'     WN0465           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0102    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0456           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0456           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0466  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0466           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PCRVGN
     C                     MOVEL'CDB'     WN0466           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PDRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0456    IFGT *ZERO                      *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0097    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR PERVGN
     C                     Z-ADDYL0011    YL0121           Carcass Count U
     C                     Z-ADD*ZERO     YL0013           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0097    IFEQ 'B'                        *IF
     C           YL0011    SUB  YL0013    YL0121           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0105    WN0457           ET Backfat Thic
     C                     Z-ADDYL0106    WN0458           ET Loin-Eye Dep
     C                     Z-ADDYL0107    WN0464           ET Light Reflec
     C                     Z-ADDYL0104    WN0459           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0122           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0459    WQ0059  31       CD Lean Percent
     C                     PARM WN0457    WQ0060  31       CD Backfat Thic
     C                     PARM WN0458    WQ0061  31       CD Loin-Eye Dep
     C                     PARM WN0464    WQ0062  31       CD Light Reflec
     C           WN0460    PARM WN0460    WQ0063  31       CD Backfat Thic
     C           WN0461    PARM WN0461    WQ0064  31       CD Loin-Eye Dep
     C           WN0462    PARM WN0462    WQ0065  31       CD Light Reflec
     C           WN0463    PARM WN0463    WQ0066  31       CD Lean Percent
     C           YL0122    PARM YL0122    WQ0067  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0507  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0508  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0509  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0510  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0121    WN0510           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0510    DOWGT*ZERO                      *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR PGRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR PHCRRC
     C                     SUB  1         WN0510           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0121    YL0113           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UOSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR PIRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR PJCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR PLCRRC
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR PNCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE:  75% <= Pct Analyzed < 100%
      *  - c1 AND c2
      *   |- c1    : LCL.TH Percent Analyzed is GE 75%
      *   |- c2    : LCL.TH Percent Analyzed is LT 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0080    IFGE 75.00                      *IF
     C           YL0080    IFLT 100.00                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0511  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0512  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0513  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0514  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0515  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0516  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0517  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0518  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0519  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0520  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/AVG  IF
     C           YL0011    SUB  YL0013    YL0128           Carcass Count U
     C                     MOVEL'ADD'     WN0520           ET Adjust/Add T
     C                     Z-ADDYL0087    WN0511           ET Hot Wgt
     C                     Z-ADDYL0089    WN0512           ET Backfat Thic
     C                     Z-ADDYL0090    WN0513           ET Loin-Eye Dep
     C                     Z-ADDYL0091    WN0519           ET Light Reflec
     C                     Z-ADDYL0092    WN0514           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
      * * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      * *             Hot Weight range.  If the Hot Weight not within ran
      * *             then do not add carcasses and mark the tattoo with
      * *             error.
      *
     C                     MOVEL*BLANK    WN0521  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0521           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PPRVGN
     C                     MOVEL'CDB'     WN0521           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR PQRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ET Hot Wgt GE LCL.EV Minimum
      *   |- c2    : PAR.ET Hot Wgt LE LCL.EV Maximum
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0511    IFGE YL0129                     *IF
     C           WN0511    IFLE YL0130                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0131           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0514    WQ0068  31       CD Lean Percent
     C                     PARM WN0512    WQ0069  31       CD Backfat Thic
     C                     PARM WN0513    WQ0070  31       CD Loin-Eye Dep
     C                     PARM WN0519    WQ0071  31       CD Light Reflec
     C           WN0515    PARM WN0515    WQ0072  31       CD Backfat Thic
     C           WN0516    PARM WN0516    WQ0073  31       CD Loin-Eye Dep
     C           WN0517    PARM WN0517    WQ0074  31       CD Light Reflec
     C           WN0518    PARM WN0518    WQ0075  31       CD Lean Percent
     C           YL0131    PARM YL0131    WQ0076  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/28/04 SLM HPEBAL Populate the new parm on the et adjust/add
      *
     C                     MOVEL*BLANK    WN0522  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0523  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0524  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0525  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0128    WN0525           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0525    DOWGT*ZERO                      *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR PRRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR PSCRRC
     C                     SUB  1         WN0525           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0128    YL0014           TH Head Adds
      * Accumulate Totals
     C                     EXSR UPSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR PTCRRC
     C                     END                             *FI
      * Setup message data for message
      * Retrieve message Pay Note: >75% Accepted
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0938' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: >75% Accepted2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0949' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
     C                     ELSE
      * CASE: 100% < Pct Analyzed <= 105%
      *  - c1 AND c2
      *   |- c1    : LCL.TH Percent Analyzed is GT 100%
      *   |- c2    : LCL.TH Percent Analyzed is LE 105%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0080    IFGT 100.00                     *IF
     C           YL0080    IFLE 105.00                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Bal Eval Trans w/EXC  IF
     C           YL0011    SUB  YL0013    YL0135           Carcass Count U
      * CASE: LCL.Carcass Count USR is NE Zero
     C           YL0135    IFNE *ZERO                      *IF
     C                     MULT -1        YL0135           Carcass Count U
      * Bal Eval Trans w/EXC  RT - Eval Trans  * 
     C                     EXSR PVRVGN
      * 4/5/04 RMC Delete carcs in reverse order if necessary to meet car
      * CASE: LCL.Count USR LT LCL.Carcass Count USR
     C           YL0136    IFLT YL0135                     *IF
      * Bal Eval Trans w/EXC2 RT - Eval Trans  * 
     C                     EXSR PXRVGN
     C                     END                             *FI
      * Subtract from Totals
     C                     EXSR UQSUBR                     Subtract from T
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     END                             *FI
      * Setup message data for message
      * Retrieve message Pay Note: >100% <105%
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0939' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: >100% <105% 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0940' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note: >100% <105% 3
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0950' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Re-Calculate Tattoo Header Averages/yield
     C                     EXSR URSUBR                     Re-Calculate Ta
      * External:  Yield Parameter Balancing
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH Source Type is External
      *   |- c2    : LCL.Net Head Usr is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1KAST    IFEQ 'E'                        *IF
     C           YL0011    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Validate Low and High Yield.
      * CASE: High Yield Min < Adj Yield < Low Yield Max
      *  - c1 OR c2
      *   |- c1    : LCL.TH Adj Actual Yield % GT PAR.High Yield Min
      *   |- c2    : LCL.TH Adj Actual Yield % LT PAR.Low Yield Max
      *   '-
     C           YL0085    IFGT P2JDNB                     *IF
     C           YL0085    ORLT P2JGNB                     *OR
     C                     MOVEL'E'       YL0097           TH PHA Add Type
     C                     MOVEL'3'       YL0098           TH PHA Add Reas
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR PZRVGN
      * Average Type
      * CASE: LCL.PH Summary Type is 2 Week
     C           YL0101    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: LCL.PH Summary Type is 4 Week
     C           YL0101    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     YL0111           TH PHA Average
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'HST'     YL0111           TH PHA Average
     C                     END                             *FI
     C                     END                             *FI
      * Setup message data for message
     C                     Z-ADDYL0138    ZA0005           TH Yld Parm Adj
     C                     MOVELYL0111    ZA0006           TH PHA Average
      * Retrieve message Pay Note: Yield Parm
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0936' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
     C                     Z-ADDYL0138    ZA0007           TH Yld Parm Adj
     C                     MOVELYL0111    ZA0008           TH PHA Average
      * Retrieve message Pay Note: Yield Parm 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0937' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Setup message data for message
     C                     Z-ADDYL0138    ZA0009           TH Yld Parm Adj
     C                     MOVELYL0111    ZA0010           TH PHA Average
      * Retrieve message Pay Note: Yield Parm 3
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0951' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0099    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0100    WL0006           THC Comment Lin
     C                     MOVELYL0099    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0100           THC Comment Lin
      * Create Eval Trans records.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.History Avail STS USR is Yes
      *   |- c2    : PAR.Bal w/History is Available History
      *   '-
     C           YL0110    IFEQ 'Y'                        *IF
     C           P4VRST    OREQ 'A'                        *OR
      * Balance w/Available History
      * CASE: PAR.Bal w/History is Available History
     C           P4VRST    IFEQ 'A'                        *IF
     C                     Z-ADDP6G9PC    YL0103           TH PHA Yield Pe
     C                     Z-ADDP6TIPR    YL0108           TH PHA Lean Prm
     C           P6B8A1    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     Z-ADDP6UWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDP6HEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDP6HGPC    YL0107           PH GA Avg Light
     C                     Z-ADDP6HBPC    YL0104           PH GA Avg Lean%
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0109    MULT 100       YL0112    H      TH PHA Sort Dis
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1HDNB' defaulted for 'TH Avg Hot Wgt'.
      * Field '(PAR) P1A7PC' defaulted for 'TH Recalc Live Wgt'.
      *
     C                     Z-ADD*ZERO     WN0606  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0607  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0608  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0609  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0610  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0611  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0612  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0613  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0614  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0615  3        ET Adjust/Add T
      *
      * Bal Eval Trans w/PHA  IF
     C                     Z-ADDP1F7NB    YL0114           TH Avg Live Wgt
      * * 02/20/04 PKD added check for Recalc Live Weight.
      * 06/04/04 SLM HPEBAL - Remove the Calculation of Avg Live Wgt
      *                     - Moved the Adjust/Add Type as the first step
      *                     - Calculate the Et Hot Wgt, write a Pay note
      *                     - message to the tattoo header comments
      *                     - combine the calculation of ET Hot Wgt
      *                     - with the messaging
      * Adjust/Add Type
      * CASE: PAR.TH PHA Average Type is 2 Week
     C           YL0111    IFEQ '2WK'                      *IF
     C                     MOVEL'2WK'     WN0615           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is 4 Week
     C           YL0111    IFEQ '4WK'                      *IF
     C                     MOVEL'4WK'     WN0615           ET Adjust/Add T
     C                     ELSE
      * CASE: PAR.TH PHA Average Type is Available History
     C           YL0111    IFEQ 'HST'                      *IF
     C                     MOVEL'HST'     WN0615           ET Adjust/Add T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *           - Cal of ET Hot Wgt
      *                - If the Avg Live Wgt = Zero or Recalc Lv Wgt
      *                   and If the Tattoo Avg Hot Wgt > 0 then use the
      *                          the Tattoo Avg Hot Wgt
      *                       else use the GA Live Wgt to recalculate the
      *                       the ET Hot Wgt
      *                - If the Avg Live Wgt NOT = Zero or NOT Recalc Lv
      *                       use the Tattoo Header Avg Live Wgt to
      *                       calculate the ET HOT Weight.
      * Calculate Hot Weight
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Avg Live Wgt is EQ Zero
      *   |- c2    : PAR.TH Recalc Live Wgt is Greater than 0
      *   '-
     C           P1F7NB    IFEQ *ZERO                      *IF
     C           P1A7PC    ORGT *ZERO                      *OR
      * 06/04/04 SLM HPEBAL Remove the Th Source Type is Internal
      * 06/25/04 PKD Only use the Carcass Weight if the Percent Accepted
      *              is between 75 and 100 percent.
      * ET Hot Wgt
      * CASE:
      *  - c1 AND (c2 AND c3)
      *   |- c1    : PAR.TH Avg Hot Wgt is GT Zero
      *   |- c2    : PAR.TH Percent Accepted is GE 75%
      *   |- c3    : PAR.TH Percent Accepted is LE 100%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HDNB    IFGT *ZERO                      *IF
     C           P1OPEM    IFGE 75.00                      *IF
     C           P1OPEM    IFLE 100                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * The Tattoo Avg Hot Wgt (Lot) will be used
     C                     Z-ADDP1HDNB    WN0606           ET Hot Wgt
     C                     MOVEL'LOT'     WN0615           ET Adjust/Add T
      * Setup message data for message
      * Retrieve message Pay Note:HW Lot Avg
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1116' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Weight using PH GA
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.PH GA Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           YL0102    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0606           ET Hot Wgt
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1117' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
      * Setup message data for message
      * Retrieve message Pay Note:HW Hst LW/Yld 2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1118' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0115    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0116    WL0006           THC Comment Lin
     C                     MOVELYL0115    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVEL*BLANK    WL0013           RS Job
     C                     MOVEL*BLANK    WL0014           RS Program
     C                     MOVEL*BLANK    WL0015           RS User Added
     C                     Z-ADD*ZERO     WL0016           RS Date Added
     C                     Z-ADD*ZERO     WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0116           THC Comment Lin
     C                     END                             *FI
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     ELSE
      * CASE: *OTHERWISE
      * ET Hot Wgt Frm Tatto ALW
      * PAR.ET Hot Wgt =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH Avg Live Wgt
      * *     : LCL.*Synon (15,1) work field *Rounded
      * x2    : PAR.TH PHA Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0103    DIV  100       W0WB00    H      *Synon (15,5) w
     C           P1F7NB    MULT W0WB00    YL0117    H      *Synon (15,1) w
     C                     Z-ADDYL0117    WN0606           ET Hot Wgt
      * 08/13/04 PKD Moved the creating of comments out of PHA processing
      *              The comments need to be created for all types of
      *              balancing, not just @ PHA.
     C                     END                             *FI
      * 08/19/04 PKD Validate the Hot Weight with Evaluation Validation
      *              Hot Weight range.  If the Hot Weight not within rang
      *              then do not add carcasses and mark the tattoo with
      *              error.
      *
     C                     MOVEL*BLANK    WN0616  3        EV Validation C
      *
      * Rtv Hot Weight Range  IF
     C                     MOVEL'CLT'     WN0616           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR QARVGN
     C                     MOVEL'CDB'     WN0616           EV Validation C
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
     C                     EXSR QBRVGN
      * Validate Hot Weight and Balance Tattoo
      * CASE: PAR.ET Hot Wgt is GT Zero
     C           WN0606    IFGT *ZERO                      *IF
      * Number of Carcasses to Add
      * CASE: PAR.TH PHA Add Type is Entire Tattoo
     C           YL0097    IFEQ 'E'                        *IF
      * Pay Entire Tattoo w/PHA, then Purge All Transactions.
      * Bal Flag f/Purge All  RT - Eval Trans  * 
     C                     EXSR QCRVGN
     C                     Z-ADDYL0011    YL0121           Carcass Count U
     C                     Z-ADD*ZERO     YL0013           TH Head Killed
     C                     ELSE
      * CASE: PAR.TH PHA Add Type is Balance To Kill
     C           YL0097    IFEQ 'B'                        *IF
     C           YL0011    SUB  YL0013    YL0121           Carcass Count U
     C                     END                             *FI
     C                     END                             *FI
      * 06/04/04 SLM HPEBAL - * out the Adjust/add Type Move at top
      *                       and the hot wgt calc has also been chg
      *                       and moved
     C                     Z-ADDYL0105    WN0607           ET Backfat Thic
     C                     Z-ADDYL0106    WN0608           ET Loin-Eye Dep
     C                     Z-ADDYL0107    WN0614           ET Light Reflec
     C                     Z-ADDYL0104    WN0609           ET Lean Percent
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Needed to calculate the MM Values so the Competito
      * *              calculations would calculate the Lean Premium
      * *              correctly.
     C                     MOVEL'Y'       YL0122           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0609    WQ0077  31       CD Lean Percent
     C                     PARM WN0607    WQ0078  31       CD Backfat Thic
     C                     PARM WN0608    WQ0079  31       CD Loin-Eye Dep
     C                     PARM WN0614    WQ0080  31       CD Light Reflec
     C           WN0610    PARM WN0610    WQ0081  31       CD Backfat Thic
     C           WN0611    PARM WN0611    WQ0082  31       CD Loin-Eye Dep
     C           WN0612    PARM WN0612    WQ0083  31       CD Light Reflec
     C           WN0613    PARM WN0613    WQ0084  31       CD Lean Percent
     C           YL0122    PARM YL0122    WQ0085  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------------*
      * * 07/02/01 PKD Changed the parameters to pass in the PAR values
      * *              instead of zeros for the MM values.
      * * 05/27/04 SLM HPEBAL Pass in the LCL ET Adjust/Add source
      *
     C                     MOVEL*BLANK    WN0657  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0658  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0659  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0660  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADDYL0121    WN0660           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0660    DOWGT*ZERO                      *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR QERVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR QFCRRC
     C                     SUB  1         WN0660           Carcass number
     C                     END                             *ITR
      * *-------------------------------------------------------------*
     C                     Z-ADDYL0121    YL0113           TH PHA Head Add
      * Accumulate Totals
     C                     EXSR UUSUBR                     Accumulate Tota
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
     C                     EXSR QGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inval
     C                     EXSR QHCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * PHA Not Avail
     C                     EXSR QJCRRC
      * Create Kill Validation - Eval/Loss Error  * Yield Error
     C                     EXSR QLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Re-Calculate Tattoo Header Averages/yield
     C                     EXSR UVSUBR                     Re-Calculate Ta
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR QNCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Kill Balancing Status
      * CASE: LCL.TH Kill Balancing Sts is Error
     C           YL0004    IFEQ 'E'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.TH Head Killed is *Zeros
     C           YL0013    IFEQ *ZERO                      *IF
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     ELSE
      * CASE: LCL.TH Head Killed EQ LCL.Net Head Usr
     C           YL0013    IFEQ YL0011                     *IF
     C                     MOVEL'B'       YL0004           TH Kill Balanci
     C                     ELSE
      * CASE: LCL.TH Head Killed NE LCL.Net Head Usr
     C           YL0013    IFNE YL0011                     *IF
     C                     MOVEL'E'       YL0004           TH Kill Balanci
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Paid Entire Tattoo w/PHA
      * CASE: LCL.TH PHA Add Type is Entire Tattoo
     C           YL0097    IFEQ 'E'                        *IF
     C                     Z-ADD*ZERO     YL0014           TH Head Adds
     C                     Z-ADD*ZERO     YL0022           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0020           TH Head Exclude
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1AIPR' defaulted for 'TH Recalc Live Wgt Yld'.
      * Chg Val Kill Trans    CH - Tattoo Header  * 
     C                     EXSR QPCHRC
      * If Internal, and balanced change the TD Ext complete status to Ye
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.TH Kill Balancing Sts is Balance
      *   |- c2    : PAR.TH Tattoo Number is Internals
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFEQ 'B'                        *IF
     C           P1CVNB    IFGE 7000                       *IF
     C           P1CVNB    ANDLE7999
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RtvChg Td Cmpl Sts     RT - Tattoo Detail Ext  * 
     C                     EXSR QQRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv Tot Hd ID/Anl/Net RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WUCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUKOER           TH Head Identif
     C                     Z-ADD*ZERO     WUJONB           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     P3L0NB           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     P4L1NB           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     P5L2NB           Hot Wgt/LghtR A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXHMNB    WQNA01           BOH Company Num
     C           *LIKE     DEFN WXBNNB    WQNA02           BOH Buy Order N
     C           *LIKE     DEFN WXBONB    WQNA03           BOL Load Number
     C           *LIKE     DEFN WXCVNB    WQNA04           TH Tattoo Numbe
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA01           BOH Company Num
     C                     KFLD           WQNA02           BOH Buy Order N
     C                     KFLD           WQNA03           BOL Load Number
     C                     KFLD           WQNA04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNA04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNA     SETLL@A1CPC7                    *
     C           KRSNA     READE@A1CPC7                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WXCWNB    WUCWNB           TH Head Receive
     C                     ADD  WXFCNB    WUFCNB           TH Yard Deads
     C                     ADD  WXFDNB    WUFDNB           TH Head Condemn
     C                     ADD  WXFENB    WUFENB           TH Head Killed
     C                     ADD  WXHFNB    WUHFNB           TH Head Accepte
     C                     ADD  WXKOER    WUKOER           TH Head Identif
     C                     ADD  WXCYNB    WUCYNB           TH Live Wgt
     C                     ADD  WXE0NB    WUE0NB           TH Hot Wgt
      * Hot Wgt/Lean % Accum USR
      * PAR.Hot Wgt/Lean % Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Lean % Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Lean Percent
     C           WXE0NB    MULT WXF4NB    W0WA01           *Synon (15,2) w
     C           WUJONB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUJONB           Hot Wgt/Lean %
      * Hot Wgt/Backf Accum USR
      * PAR.Hot Wgt/Backf Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Backf Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Backfat
     C           WXE0NB    MULT WXF2NB    W0WA01           *Synon (15,2) w
     C           P3L0NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P3L0NB           Hot Wgt/Backf A
      * Hot Wgt/Loine Accum Usr
      * PAR.Hot Wgt/Loine Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/Loine Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Loin Eye Depth
     C           WXE0NB    MULT WXF3NB    W0WA01           *Synon (15,2) w
     C           P4L1NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P4L1NB           Hot Wgt/Loine A
      * Hot Wgt/LghtR Accum Usr
      * PAR.Hot Wgt/LghtR Accum Usr =
      *    *COMPUTE (x3 + (x1 * x2))
      * x3    : PAR.Hot Wgt/LghtR Accum Usr
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Avg Light Reflectance
     C           WXE0NB    MULT WXF5NB    W0WA01           *Synon (15,2) w
     C           P5L2NB    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P5L2NB           Hot Wgt/LghtR A
     C           KRSNA     READE@A1CPC7                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv Held Over KillDt  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQNB01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQNB02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQNB03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQNB04           TH Tattoo Numbe
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           BOH Company Num
     C                     KFLD           WQNB02           BOH Buy Order N
     C                     KFLD           WQNB03           BOL Load Number
     C                     KFLD           WQNB04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNB01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNB02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNB03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNB04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNB     SETLL@A1CPC4                    *
     C           KRSNB     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date NE PAR.Kill Date 1 Usr
     C           WIB0DT    IFNE P1B0DT                     *IF
     C                     Z-ADDWIB0DT    YL0094           Kill Date Usr
     C                     GOTO NBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNB     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0101           PH Summary Type
     C                     Z-ADD*ZERO     YL0102           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0103           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0104           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0105           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0106           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0107           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0108           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0109           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0110           History Avail S
     C                     MOVEL'N'       YL0110           History Avail S
     C                     MOVEL'Y'       YL0067           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTABCD    WQNC01           PD Producer Cod
      * Define keylist
     C           KPSNC     KLIST
     C                     KFLD           WQNC01           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQNC01           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSNC     SETLL@CGCPEJ                    *
     C           KRSNC     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0068           PH Week Ending
     C                     MOVEL'N'       YL0067           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0068                     *IF
     C                     GOTO NCEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO NCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT *ZERO                      *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO NCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNC     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0246    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSND     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0118           EV Maximum
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0118           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0246    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNE     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0119           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0119           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQNF01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQNF02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQNF03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQNF04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQNF05           TH Kill Date
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           BOH Company Num
     C                     KFLD           WQNF02           BOH Buy Order N
     C                     KFLD           WQNF03           BOL Load Number
     C                     KFLD           WQNF04           TH Tattoo Numbe
     C                     KFLD           WQNF05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNF01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNF02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNF03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNF04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQNF05           TH Kill Date
      * Establish starting position
     C           KRSNF     SETLL@BVCPQ9                    *
     C           KRSNF     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR NGCHRC
      * Subtract from Totals
     C                     EXSR UFSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSNF     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0247  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0248  50       ET Lot
     C                     MOVEL*BLANK    WN0249  1        ET Shift
     C                     Z-ADD*ZERO     WN0250  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0251  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0252  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0253  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0254  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0255  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0256  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0257  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0258  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0259  1        ET Trim Area
     C                     MOVEL*BLANK    WN0260  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0261  1        ET Error Sts
     C                     MOVEL*BLANK    WN0262  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0263  1        ET Record Creat
     C                     MOVEL*BLANK    WN0264  1        ET Record Creat
     C                     MOVEL*BLANK    WN0265  1        ET User Error O
     C                     MOVEL*BLANK    WN0266  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0267  1        ET Broken Back
     C                     MOVEL*BLANK    WN0268  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0269  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0270  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0271  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0272  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0273  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0274  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0275  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0276  70       TH Kill Date
     C                     MOVEL*BLANK    WN0277 10        RS User Changed
     C                     Z-ADD*ZERO     WN0278  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0279  60       RS Time Changed
     C                     MOVEL*BLANK    WN0280 10        RS Job
     C                     MOVEL*BLANK    WN0281 10        RS Program
     C                     MOVEL*BLANK    WN0282 10        RS User Added
     C                     Z-ADD*ZERO     WN0283  70       RS Date Added
     C                     Z-ADD*ZERO     WN0284  60       RS Time Added
     C                     Z-ADD*ZERO     WN0285  70       RU Date
     C                     Z-ADD*ZERO     WN0286  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHNG    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHNG    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YGRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQNH01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQNH02           ET Kill Date
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           ET Company Numb
     C                     KFLD           WQNH02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNH01           ET Company Numb
     C                     Z-ADDP1B0DT    WQNH02           ET Kill Date
      * Establish starting position
     C           KRSNH     SETLL@BVCPNE                    *
     C           KRSNH     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0123           ET Scale Sequen
     C                     GOTO NHEXIT                     *QUIT
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0123           ET Scale Sequen
     C                     GOTO NHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNH     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NICRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0123    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0123    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0236    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0237    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0238    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0239    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0240    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0241    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0242    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0243    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0244    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0245    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0287    WDVIST           ET Unused Sts 2
     C                     MOVELYL0124    WDVJST           ET Adjust/Add S
     C                     MOVELWN0288    WDVKST           ET Unused Sts 4
     C                     MOVELWN0289    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRNI    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRNI    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQNJ01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQNJ02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQNJ03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQNJ04           TH Tattoo Numbe
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           WQNJ01           BOH Company Num
     C                     KFLD           WQNJ02           BOH Buy Order N
     C                     KFLD           WQNJ03           BOL Load Number
     C                     KFLD           WQNJ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNJ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNJ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNJ03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNJ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNJ     SETLL@A1CPC4                    *
     C           KRSNJ     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,03    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0126    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,03    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR NLRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRNK    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRNK    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNL     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNL     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,04    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,04    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR NNRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRNM    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRNM    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNN     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PID'     WBDXST           KV Error Code
     C                     MOVEL@CN,05    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,05    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR NPRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRNO    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRNO    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NOEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PID'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNP     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0101           PH Summary Type
     C                     Z-ADD*ZERO     YL0102           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0103           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0104           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0105           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0106           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0107           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0108           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0109           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0110           History Avail S
     C                     MOVEL'N'       YL0110           History Avail S
     C                     MOVEL'Y'       YL0067           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTABCD    WQNQ01           PD Producer Cod
      * Define keylist
     C           KPSNQ     KLIST
     C                     KFLD           WQNQ01           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WQNQ01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQNQ01           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSNQ     SETLL@CGCPEJ                    *
     C           KRSNQ     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0068           PH Week Ending
     C                     MOVEL'N'       YL0067           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0068                     *IF
     C                     GOTO NQEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO NQEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT *ZERO                      *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO NQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNQ     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0301    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNR     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0118           EV Maximum
     C                     GOTO NREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0118           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0301    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNS     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0119           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0119           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQNT01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQNT02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQNT03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQNT04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQNT05           TH Kill Date
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT01           BOH Company Num
     C                     KFLD           WQNT02           BOH Buy Order N
     C                     KFLD           WQNT03           BOL Load Number
     C                     KFLD           WQNT04           TH Tattoo Numbe
     C                     KFLD           WQNT05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNT01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNT02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNT03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNT04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQNT05           TH Kill Date
      * Establish starting position
     C           KRSNT     SETLL@BVCPQ9                    *
     C           KRSNT     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR NUCHRC
      * Subtract from Totals
     C                     EXSR UHSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSNT     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NUCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0302  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0303  50       ET Lot
     C                     MOVEL*BLANK    WN0304  1        ET Shift
     C                     Z-ADD*ZERO     WN0305  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0306  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0307  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0308  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0309  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0310  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0311  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0312  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0313  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0314  1        ET Trim Area
     C                     MOVEL*BLANK    WN0315  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0316  1        ET Error Sts
     C                     MOVEL*BLANK    WN0317  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0318  1        ET Record Creat
     C                     MOVEL*BLANK    WN0319  1        ET Record Creat
     C                     MOVEL*BLANK    WN0320  1        ET User Error O
     C                     MOVEL*BLANK    WN0321  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0322  1        ET Broken Back
     C                     MOVEL*BLANK    WN0323  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0324  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0325  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0326  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0327  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0328  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0329  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0330  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0331  70       TH Kill Date
     C                     MOVEL*BLANK    WN0332 10        RS User Changed
     C                     Z-ADD*ZERO     WN0333  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0334  60       RS Time Changed
     C                     MOVEL*BLANK    WN0335 10        RS Job
     C                     MOVEL*BLANK    WN0336 10        RS Program
     C                     MOVEL*BLANK    WN0337 10        RS User Added
     C                     Z-ADD*ZERO     WN0338  70       RS Date Added
     C                     Z-ADD*ZERO     WN0339  60       RS Time Added
     C                     Z-ADD*ZERO     WN0340  70       RU Date
     C                     Z-ADD*ZERO     WN0341  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHNU    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHNU    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YHRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQNV01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQNV02           ET Kill Date
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           WQNV01           ET Company Numb
     C                     KFLD           WQNV02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQNV01           ET Company Numb
     C                     Z-ADDP1B0DT    WQNV02           ET Kill Date
      * Establish starting position
     C           KRSNV     SETLL@BVCPNE                    *
     C           KRSNV     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0123           ET Scale Sequen
     C                     GOTO NVEXIT                     *QUIT
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0123           ET Scale Sequen
     C                     GOTO NVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNV     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0123    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0123    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0291    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0292    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0293    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0294    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0295    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0296    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0297    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0298    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0299    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0300    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0342    WDVIST           ET Unused Sts 2
     C                     MOVELYL0124    WDVJST           ET Adjust/Add S
     C                     MOVELWN0343    WDVKST           ET Unused Sts 4
     C                     MOVELWN0344    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRNW    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRNW    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQNX01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQNX02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQNX03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQNX04           TH Tattoo Numbe
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           WQNX01           BOH Company Num
     C                     KFLD           WQNX02           BOH Buy Order N
     C                     KFLD           WQNX03           BOL Load Number
     C                     KFLD           WQNX04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQNX01           BOH Company Num
     C                     Z-ADDP1BNNB    WQNX02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQNX03           BOL Load Number
     C                     Z-ADDP1CVNB    WQNX04           TH Tattoo Numbe
      * Establish starting position
     C           KRSNX     SETLL@A1CPC4                    *
     C           KRSNX     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,03    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0126    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,03    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR NZRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRNY    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRNY    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSNZ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OACRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,04    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,04    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OBRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROA    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROA    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OAEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOB     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOB     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PID'     WBDXST           KV Error Code
     C                     MOVEL@CN,05    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,05    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR ODRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROC    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROC    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OCEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOD     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PID'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOD     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OERVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOE     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0356    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOE     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0118           EV Maximum
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0118           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0356    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOF     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0119           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0119           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQOG01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQOG02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQOG03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQOG04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQOG05           TH Kill Date
      * Define keylist
     C           KRSOG     KLIST
     C                     KFLD           WQOG01           BOH Company Num
     C                     KFLD           WQOG02           BOH Buy Order N
     C                     KFLD           WQOG03           BOL Load Number
     C                     KFLD           WQOG04           TH Tattoo Numbe
     C                     KFLD           WQOG05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOG01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOG02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOG03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOG04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQOG05           TH Kill Date
      * Establish starting position
     C           KRSOG     SETLL@BVCPQ9                    *
     C           KRSOG     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR OHCHRC
      * Subtract from Totals
     C                     EXSR UJSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSOG     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0357  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0358  50       ET Lot
     C                     MOVEL*BLANK    WN0359  1        ET Shift
     C                     Z-ADD*ZERO     WN0360  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0361  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0362  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0363  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0364  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0365  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0366  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0367  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0368  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0369  1        ET Trim Area
     C                     MOVEL*BLANK    WN0370  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0371  1        ET Error Sts
     C                     MOVEL*BLANK    WN0372  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0373  1        ET Record Creat
     C                     MOVEL*BLANK    WN0374  1        ET Record Creat
     C                     MOVEL*BLANK    WN0375  1        ET User Error O
     C                     MOVEL*BLANK    WN0376  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0377  1        ET Broken Back
     C                     MOVEL*BLANK    WN0378  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0379  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0380  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0381  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0382  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0383  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0384  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0385  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0386  70       TH Kill Date
     C                     MOVEL*BLANK    WN0387 10        RS User Changed
     C                     Z-ADD*ZERO     WN0388  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0389  60       RS Time Changed
     C                     MOVEL*BLANK    WN0390 10        RS Job
     C                     MOVEL*BLANK    WN0391 10        RS Program
     C                     MOVEL*BLANK    WN0392 10        RS User Added
     C                     Z-ADD*ZERO     WN0393  70       RS Date Added
     C                     Z-ADD*ZERO     WN0394  60       RS Time Added
     C                     Z-ADD*ZERO     WN0395  70       RU Date
     C                     Z-ADD*ZERO     WN0396  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHOH    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHOH    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YIRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQOI01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQOI02           ET Kill Date
      * Define keylist
     C           KRSOI     KLIST
     C                     KFLD           WQOI01           ET Company Numb
     C                     KFLD           WQOI02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOI01           ET Company Numb
     C                     Z-ADDP1B0DT    WQOI02           ET Kill Date
      * Establish starting position
     C           KRSOI     SETLL@BVCPNE                    *
     C           KRSOI     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0123           ET Scale Sequen
     C                     GOTO OIEXIT                     *QUIT
     C                     GOTO OIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0123           ET Scale Sequen
     C                     GOTO OIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOI     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0123    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0123    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0346    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0347    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0348    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0349    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0350    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0351    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0352    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0353    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0354    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0355    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0397    WDVIST           ET Unused Sts 2
     C                     MOVELYL0124    WDVJST           ET Adjust/Add S
     C                     MOVELWN0398    WDVKST           ET Unused Sts 4
     C                     MOVELWN0399    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCROJ    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCROJ    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OJEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQOK01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQOK02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQOK03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQOK04           TH Tattoo Numbe
      * Define keylist
     C           KRSOK     KLIST
     C                     KFLD           WQOK01           BOH Company Num
     C                     KFLD           WQOK02           BOH Buy Order N
     C                     KFLD           WQOK03           BOL Load Number
     C                     KFLD           WQOK04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQOK01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOK02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOK03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOK04           TH Tattoo Numbe
      * Establish starting position
     C           KRSOK     SETLL@A1CPC4                    *
     C           KRSOK     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,03    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0126    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,03    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OMRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROL    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROL    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OLEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOM     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOM     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0101           PH Summary Type
     C                     Z-ADD*ZERO     YL0102           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0103           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0104           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0105           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0106           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0107           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0108           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0109           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0110           History Avail S
     C                     MOVEL'N'       YL0110           History Avail S
     C                     MOVEL'Y'       YL0067           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTABCD    WQON01           PD Producer Cod
      * Define keylist
     C           KPSON     KLIST
     C                     KFLD           WQON01           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSON     KLIST
     C                     KFLD           WQON01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQON01           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSON     SETLL@CGCPEJ                    *
     C           KRSON     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0068           PH Week Ending
     C                     MOVEL'N'       YL0067           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0068                     *IF
     C                     GOTO ONEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO ONEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT *ZERO                      *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO ONEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSON     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OORVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOO     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0411    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOO     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0118           EV Maximum
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0118           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOP     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0411    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOP     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0119           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO OPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0119           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQOQ01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQOQ02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQOQ03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQOQ04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQOQ05           TH Kill Date
      * Define keylist
     C           KRSOQ     KLIST
     C                     KFLD           WQOQ01           BOH Company Num
     C                     KFLD           WQOQ02           BOH Buy Order N
     C                     KFLD           WQOQ03           BOL Load Number
     C                     KFLD           WQOQ04           TH Tattoo Numbe
     C                     KFLD           WQOQ05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOQ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOQ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOQ03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOQ04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQOQ05           TH Kill Date
      * Establish starting position
     C           KRSOQ     SETLL@BVCPQ9                    *
     C           KRSOQ     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR ORCHRC
      * Subtract from Totals
     C                     EXSR ULSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSOQ     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0412  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0413  50       ET Lot
     C                     MOVEL*BLANK    WN0414  1        ET Shift
     C                     Z-ADD*ZERO     WN0415  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0416  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0417  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0418  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0419  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0420  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0421  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0422  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0423  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0424  1        ET Trim Area
     C                     MOVEL*BLANK    WN0425  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0426  1        ET Error Sts
     C                     MOVEL*BLANK    WN0427  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0428  1        ET Record Creat
     C                     MOVEL*BLANK    WN0429  1        ET Record Creat
     C                     MOVEL*BLANK    WN0430  1        ET User Error O
     C                     MOVEL*BLANK    WN0431  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0432  1        ET Broken Back
     C                     MOVEL*BLANK    WN0433  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0434  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0435  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0436  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0437  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0438  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0439  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0440  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0441  70       TH Kill Date
     C                     MOVEL*BLANK    WN0442 10        RS User Changed
     C                     Z-ADD*ZERO     WN0443  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0444  60       RS Time Changed
     C                     MOVEL*BLANK    WN0445 10        RS Job
     C                     MOVEL*BLANK    WN0446 10        RS Program
     C                     MOVEL*BLANK    WN0447 10        RS User Added
     C                     Z-ADD*ZERO     WN0448  70       RS Date Added
     C                     Z-ADD*ZERO     WN0449  60       RS Time Added
     C                     Z-ADD*ZERO     WN0450  70       RU Date
     C                     Z-ADD*ZERO     WN0451  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHOR    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHOR    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YJRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQOS01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQOS02           ET Kill Date
      * Define keylist
     C           KRSOS     KLIST
     C                     KFLD           WQOS01           ET Company Numb
     C                     KFLD           WQOS02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQOS01           ET Company Numb
     C                     Z-ADDP1B0DT    WQOS02           ET Kill Date
      * Establish starting position
     C           KRSOS     SETLL@BVCPNE                    *
     C           KRSOS     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0123           ET Scale Sequen
     C                     GOTO OSEXIT                     *QUIT
     C                     GOTO OSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0123           ET Scale Sequen
     C                     GOTO OSEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOS     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0123    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0123    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0401    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0402    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0403    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0404    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0405    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0406    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0407    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0408    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0409    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0410    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0452    WDVIST           ET Unused Sts 2
     C                     MOVELYL0124    WDVJST           ET Adjust/Add S
     C                     MOVELWN0453    WDVKST           ET Unused Sts 4
     C                     MOVELWN0454    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCROT    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCROT    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OTEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OURVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQOU01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQOU02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQOU03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQOU04           TH Tattoo Numbe
      * Define keylist
     C           KRSOU     KLIST
     C                     KFLD           WQOU01           BOH Company Num
     C                     KFLD           WQOU02           BOH Buy Order N
     C                     KFLD           WQOU03           BOL Load Number
     C                     KFLD           WQOU04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQOU01           BOH Company Num
     C                     Z-ADDP1BNNB    WQOU02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQOU03           BOL Load Number
     C                     Z-ADDP1CVNB    WQOU04           TH Tattoo Numbe
      * Establish starting position
     C           KRSOU     SETLL@A1CPC4                    *
     C           KRSOU     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,03    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0126    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,03    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OWRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROV    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROV    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OVEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOW     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOW     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,04    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,04    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR OYRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROX    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROX    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OXEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         OYRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOY     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSOY     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         OYEXIT    ENDSR
      /EJECT
     CSR         OZCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PID'     WBDXST           KV Error Code
     C                     MOVEL@CN,05    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,05    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PARVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCROZ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCROZ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OZEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OZEXIT    ENDSR
      /EJECT
     CSR         PARVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPA     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PID'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPA     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PAEXIT    ENDSR
      /EJECT
     CSR         PBRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0101           PH Summary Type
     C                     Z-ADD*ZERO     YL0102           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0103           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0104           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0105           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0106           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0107           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0108           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0109           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0110           History Avail S
     C                     MOVEL'N'       YL0110           History Avail S
     C                     MOVEL'Y'       YL0067           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTABCD    WQPB01           PD Producer Cod
      * Define keylist
     C           KPSPB     KLIST
     C                     KFLD           WQPB01           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSPB     KLIST
     C                     KFLD           WQPB01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQPB01           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSPB     SETLL@CGCPEJ                    *
     C           KRSPB     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0068           PH Week Ending
     C                     MOVEL'N'       YL0067           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0068                     *IF
     C                     GOTO PBEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO PBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT *ZERO                      *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO PBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSPB     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         PBEXIT    ENDSR
      /EJECT
     CSR         PCRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPC     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0466    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPC     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0118           EV Maximum
     C                     GOTO PCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0118           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PCEXIT    ENDSR
      /EJECT
     CSR         PDRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPD     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0466    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPD     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0119           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO PDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0119           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PDEXIT    ENDSR
      /EJECT
     CSR         PERVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQPE01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQPE02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQPE03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQPE04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQPE05           TH Kill Date
      * Define keylist
     C           KRSPE     KLIST
     C                     KFLD           WQPE01           BOH Company Num
     C                     KFLD           WQPE02           BOH Buy Order N
     C                     KFLD           WQPE03           BOL Load Number
     C                     KFLD           WQPE04           TH Tattoo Numbe
     C                     KFLD           WQPE05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPE01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPE02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPE03           BOL Load Number
     C                     Z-ADDP1CVNB    WQPE04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQPE05           TH Kill Date
      * Establish starting position
     C           KRSPE     SETLL@BVCPQ9                    *
     C           KRSPE     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR PFCHRC
      * Subtract from Totals
     C                     EXSR UNSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSPE     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         PEEXIT    ENDSR
      /EJECT
     CSR         PFCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0467  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0468  50       ET Lot
     C                     MOVEL*BLANK    WN0469  1        ET Shift
     C                     Z-ADD*ZERO     WN0470  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0471  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0472  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0473  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0474  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0475  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0476  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0477  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0478  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0479  1        ET Trim Area
     C                     MOVEL*BLANK    WN0480  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0481  1        ET Error Sts
     C                     MOVEL*BLANK    WN0482  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0483  1        ET Record Creat
     C                     MOVEL*BLANK    WN0484  1        ET Record Creat
     C                     MOVEL*BLANK    WN0485  1        ET User Error O
     C                     MOVEL*BLANK    WN0486  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0487  1        ET Broken Back
     C                     MOVEL*BLANK    WN0488  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0489  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0490  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0491  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0492  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0493  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0494  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0495  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0496  70       TH Kill Date
     C                     MOVEL*BLANK    WN0497 10        RS User Changed
     C                     Z-ADD*ZERO     WN0498  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0499  60       RS Time Changed
     C                     MOVEL*BLANK    WN0500 10        RS Job
     C                     MOVEL*BLANK    WN0501 10        RS Program
     C                     MOVEL*BLANK    WN0502 10        RS User Added
     C                     Z-ADD*ZERO     WN0503  70       RS Date Added
     C                     Z-ADD*ZERO     WN0504  60       RS Time Added
     C                     Z-ADD*ZERO     WN0505  70       RU Date
     C                     Z-ADD*ZERO     WN0506  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHPF    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHPF    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YKRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PFEXIT    ENDSR
      /EJECT
     CSR         PGRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQPG01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQPG02           ET Kill Date
      * Define keylist
     C           KRSPG     KLIST
     C                     KFLD           WQPG01           ET Company Numb
     C                     KFLD           WQPG02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPG01           ET Company Numb
     C                     Z-ADDP1B0DT    WQPG02           ET Kill Date
      * Establish starting position
     C           KRSPG     SETLL@BVCPNE                    *
     C           KRSPG     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0123           ET Scale Sequen
     C                     GOTO PGEXIT                     *QUIT
     C                     GOTO PGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0123           ET Scale Sequen
     C                     GOTO PGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSPG     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         PGEXIT    ENDSR
      /EJECT
     CSR         PHCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0123    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0123    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0456    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0457    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0458    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0459    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0460    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0461    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0462    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0463    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0464    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0465    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0507    WDVIST           ET Unused Sts 2
     C                     MOVELYL0124    WDVJST           ET Adjust/Add S
     C                     MOVELWN0508    WDVKST           ET Unused Sts 4
     C                     MOVELWN0509    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRPH    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRPH    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PHEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PHEXIT    ENDSR
      /EJECT
     CSR         PIRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQPI01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQPI02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQPI03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQPI04           TH Tattoo Numbe
      * Define keylist
     C           KRSPI     KLIST
     C                     KFLD           WQPI01           BOH Company Num
     C                     KFLD           WQPI02           BOH Buy Order N
     C                     KFLD           WQPI03           BOL Load Number
     C                     KFLD           WQPI04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQPI01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPI02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPI03           BOL Load Number
     C                     Z-ADDP1CVNB    WQPI04           TH Tattoo Numbe
      * Establish starting position
     C           KRSPI     SETLL@A1CPC4                    *
     C           KRSPI     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         PIEXIT    ENDSR
      /EJECT
     CSR         PJCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,03    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0126    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,03    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PKRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPJ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPJ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PJEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PJEXIT    ENDSR
      /EJECT
     CSR         PKRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPK     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPK     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PKEXIT    ENDSR
      /EJECT
     CSR         PLCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999998    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,04    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,04    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PMRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPL    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPL    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PLEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PLEXIT    ENDSR
      /EJECT
     CSR         PMRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPM     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPM     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PMEXIT    ENDSR
      /EJECT
     CSR         PNCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PAN'     WBDXST           KV Error Code
     C                     MOVEL@CN,06    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,06    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PORVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPN    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPN    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PNEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PNEXIT    ENDSR
      /EJECT
     CSR         PORVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPO     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PAN'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPO     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         POEXIT    ENDSR
      /EJECT
     CSR         PPRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPP     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0521    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPP     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0129           EV Maximum
     C                     GOTO PPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0129           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PPEXIT    ENDSR
      /EJECT
     CSR         PQRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPQ     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0521    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPQ     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0130           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO PQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0130           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         PQEXIT    ENDSR
      /EJECT
     CSR         PRRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQPR01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQPR02           ET Kill Date
      * Define keylist
     C           KRSPR     KLIST
     C                     KFLD           WQPR01           ET Company Numb
     C                     KFLD           WQPR02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPR01           ET Company Numb
     C                     Z-ADDP1B0DT    WQPR02           ET Kill Date
      * Establish starting position
     C           KRSPR     SETLL@BVCPNE                    *
     C           KRSPR     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0132           ET Scale Sequen
     C                     GOTO PREXIT                     *QUIT
     C                     GOTO PREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0132           ET Scale Sequen
     C                     GOTO PREXIT                     *QUIT
     C                     END                             *FI
     C           KRSPR     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         PREXIT    ENDSR
      /EJECT
     CSR         PSCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0132    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0132    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0511    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0512    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0513    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0514    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0515    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0516    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0517    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0518    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0519    WDALPC           ET Light Reflec
     C                     MOVEL*BLANK    WDDIST           ET Trim Area
     C                     MOVEL'U'       WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0520    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0522    WDVIST           ET Unused Sts 2
     C                     MOVEL*BLANK    WDVJST           ET Adjust/Add S
     C                     MOVELWN0523    WDVKST           ET Unused Sts 4
     C                     MOVELWN0524    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRPS    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRPS    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PSEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PSEXIT    ENDSR
      /EJECT
     CSR         PTCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,03    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0134    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,03    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR PURVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRPT    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRPT    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PTEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PTEXIT    ENDSR
      /EJECT
     CSR         PURVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPU     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSPU     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         PUEXIT    ENDSR
      /EJECT
     CSR         PVRVGN    BEGSR
      *================================================================
      * Bal Eval Trans w/EXC  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0136           Count USR
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAHMNB    WQPV01           BOH Company Num
     C           *LIKE     DEFN TABNNB    WQPV02           BOH Buy Order N
     C           *LIKE     DEFN TABONB    WQPV03           BOL Load Number
     C           *LIKE     DEFN TACVNB    WQPV04           TH Tattoo Numbe
     C           *LIKE     DEFN TAB0DT    WQPV05           TH Kill Date
      * Define keylist
     C           KPSPV     KLIST
     C                     KFLD           WQPV01           BOH Company Num
     C                     KFLD           WQPV02           BOH Buy Order N
     C                     KFLD           WQPV03           BOL Load Number
     C                     KFLD           WQPV04           TH Tattoo Numbe
     C                     KFLD           WQPV05           TH Kill Date
     C                     KFLD           TAAKPC           ET Lean Percent
     C                     KFLD           TAAMPC           ET Hot Wgt
      * Define keylist
     C           KRSPV     KLIST
     C                     KFLD           WQPV01           BOH Company Num
     C                     KFLD           WQPV02           BOH Buy Order N
     C                     KFLD           WQPV03           BOL Load Number
     C                     KFLD           WQPV04           TH Tattoo Numbe
     C                     KFLD           WQPV05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPV01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPV02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPV03           BOL Load Number
     C                     Z-ADDP1CVNB    WQPV04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQPV05           TH Kill Date
     C                     Z-ADDYL0092    TAAKPC           ET Lean Percent
     C                     Z-ADDYL0087    TAAMPC           ET Hot Wgt
      * Establish starting position
     C           KPSPV     SETLL@BVCPEE                    *
     C           KRSPV     READE@BVCPEE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'K'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
     C                     GOTO PVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0136           Count USR
      * CASE: PAR.Count USR GT PAR.Carcass Count USR
     C           YL0136    IFGT YL0135                     *IF
     C                     GOTO PVEXIT                     *QUIT
     C                     END                             *FI
      * Chg Add/Del Status    CH - Eval Trans  * 
     C                     EXSR PWCHRC
     C                     ADD  1         YL0020           TH Head Exclude
     C                     SUB  1         YL0013           TH Head Killed
     C           KRSPV     READE@BVCPEE                  90*
     C                     ENDDO
      *================================================================
     CSR         PVEXIT    ENDSR
      /EJECT
     CSR         PWCHRC    BEGSR
      *================================================================
      * Chg Add/Del Status    CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0526  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0527  50       ET Lot
     C                     MOVEL*BLANK    WN0528  1        ET Shift
     C                     Z-ADD*ZERO     WN0529  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0530  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0531  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0532  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0533  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0534  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0535  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0536  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0537  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0538  1        ET Trim Area
     C                     MOVEL*BLANK    WN0539  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0540  1        ET Error Sts
     C                     MOVEL*BLANK    WN0541  1        ET Record Creat
     C                     MOVEL*BLANK    WN0542  1        ET Record Creat
     C                     MOVEL*BLANK    WN0543  1        ET User Error O
     C                     MOVEL*BLANK    WN0544  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0545  1        ET Broken Back
     C                     MOVEL*BLANK    WN0546  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0547  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0548  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0549  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0550  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0551  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0552  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0553  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0554  70       TH Kill Date
     C                     MOVEL*BLANK    WN0555 10        RS User Changed
     C                     Z-ADD*ZERO     WN0556  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0557  60       RS Time Changed
     C                     MOVEL*BLANK    WN0558  1        RS Record Statu
     C                     MOVEL*BLANK    WN0559 10        RS Job
     C                     MOVEL*BLANK    WN0560 10        RS Program
     C                     MOVEL*BLANK    WN0561 10        RS User Added
     C                     Z-ADD*ZERO     WN0562  70       RS Date Added
     C                     Z-ADD*ZERO     WN0563  60       RS Time Added
     C                     Z-ADD*ZERO     WN0564  70       RU Date
     C                     Z-ADD*ZERO     WN0565  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDTAHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDTAA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDTAFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDTAHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDTAGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHPW    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHPW    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YLRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDEHST    P      ET Record Add/D
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PWEXIT    ENDSR
      /EJECT
     CSR         PXRVGN    BEGSR
      *================================================================
      * Bal Eval Trans w/EXC2 RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL'N'       YL0003           TH Detail Error
     C                     MOVEL'B'       YL0004           TH Kill Balanci
      * Declare restrictor key work fields
     C           *LIKE     DEFN TBHMNB    WQPX01           BOH Company Num
     C           *LIKE     DEFN TBBNNB    WQPX02           BOH Buy Order N
     C           *LIKE     DEFN TBBONB    WQPX03           BOL Load Number
     C           *LIKE     DEFN TBCVNB    WQPX04           TH Tattoo Numbe
     C           *LIKE     DEFN TBB0DT    WQPX05           TH Kill Date
      * Define keylist
     C           KPSPX     KLIST
     C                     KFLD           WQPX01           BOH Company Num
     C                     KFLD           WQPX02           BOH Buy Order N
     C                     KFLD           WQPX03           BOL Load Number
     C                     KFLD           WQPX04           TH Tattoo Numbe
     C                     KFLD           WQPX05           TH Kill Date
     C                     KFLD           TBAKPC           ET Lean Percent
     C                     KFLD           TBAMPC           ET Hot Wgt
      * Define keylist
     C           KRSPX     KLIST
     C                     KFLD           WQPX01           BOH Company Num
     C                     KFLD           WQPX02           BOH Buy Order N
     C                     KFLD           WQPX03           BOL Load Number
     C                     KFLD           WQPX04           TH Tattoo Numbe
     C                     KFLD           WQPX05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQPX01           BOH Company Num
     C                     Z-ADDP1BNNB    WQPX02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQPX03           BOL Load Number
     C                     Z-ADDP1CVNB    WQPX04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQPX05           TH Kill Date
     C                     Z-ADDYL0092    TBAKPC           ET Lean Percent
     C                     Z-ADDYL0087    TBAMPC           ET Hot Wgt
      * Establish starting position
     C           KPSPX     SETLL@BVCPKU                    *
     C           KRSPX     READE@BVCPKU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'K'       YL0002           TH Header Error
     C                     MOVEL'Y'       YL0003           TH Detail Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
     C                     GOTO PXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0136           Count USR
      * CASE: PAR.Count USR GT PAR.Carcass Count USR
     C           YL0136    IFGT YL0135                     *IF
     C                     GOTO PXEXIT                     *QUIT
     C                     END                             *FI
      * Chg Add/Del Status    CH - Eval Trans  * 
     C                     EXSR PYCHRC
     C                     ADD  1         YL0020           TH Head Exclude
     C                     SUB  1         YL0013           TH Head Killed
     C           KRSPX     READE@BVCPKU                  90*
     C                     ENDDO
      *================================================================
     CSR         PXEXIT    ENDSR
      /EJECT
     CSR         PYCHRC    BEGSR
      *================================================================
      * Chg Add/Del Status    CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0566  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0567  50       ET Lot
     C                     MOVEL*BLANK    WN0568  1        ET Shift
     C                     Z-ADD*ZERO     WN0569  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0570  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0571  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0572  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0573  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0574  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0575  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0576  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0577  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0578  1        ET Trim Area
     C                     MOVEL*BLANK    WN0579  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0580  1        ET Error Sts
     C                     MOVEL*BLANK    WN0581  1        ET Record Creat
     C                     MOVEL*BLANK    WN0582  1        ET Record Creat
     C                     MOVEL*BLANK    WN0583  1        ET User Error O
     C                     MOVEL*BLANK    WN0584  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0585  1        ET Broken Back
     C                     MOVEL*BLANK    WN0586  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0587  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0588  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0589  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0590  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0591  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0592  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0593  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0594  70       TH Kill Date
     C                     MOVEL*BLANK    WN0595 10        RS User Changed
     C                     Z-ADD*ZERO     WN0596  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0597  60       RS Time Changed
     C                     MOVEL*BLANK    WN0598  1        RS Record Statu
     C                     MOVEL*BLANK    WN0599 10        RS Job
     C                     MOVEL*BLANK    WN0600 10        RS Program
     C                     MOVEL*BLANK    WN0601 10        RS User Added
     C                     Z-ADD*ZERO     WN0602  70       RS Date Added
     C                     Z-ADD*ZERO     WN0603  60       RS Time Added
     C                     Z-ADD*ZERO     WN0604  70       RU Date
     C                     Z-ADD*ZERO     WN0605  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDTBHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDTBA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDTBFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDTBHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDTBGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHPY    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHPY    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YMRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDEHST    P      ET Record Add/D
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PYEXIT    ENDSR
      /EJECT
     CSR         PZRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0101           PH Summary Type
     C                     Z-ADD*ZERO     YL0102           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0103           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0104           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0105           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0106           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0107           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0108           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0109           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0110           History Avail S
     C                     MOVEL'N'       YL0110           History Avail S
     C                     MOVEL'Y'       YL0067           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTABCD    WQPZ01           PD Producer Cod
      * Define keylist
     C           KPSPZ     KLIST
     C                     KFLD           WQPZ01           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSPZ     KLIST
     C                     KFLD           WQPZ01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQPZ01           PD Producer Cod
     C                     Z-ADDP1AWDT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSPZ     SETLL@CGCPEJ                    *
     C           KRSPZ     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0068           PH Week Ending
     C                     MOVEL'N'       YL0067           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0068                     *IF
     C                     GOTO PZEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO PZEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT *ZERO                      *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0101           PH Summary Type
     C                     Z-ADDWTORMB    YL0102           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0103           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0104           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0105           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0106           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0107           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0108           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0109           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0110           History Avail S
     C                     GOTO PZEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSPZ     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         PZEXIT    ENDSR
      /EJECT
     CSR         QARVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQA     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0616    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQA     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     YL0118           EV Maximum
     C                     GOTO QAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    WUAFPC           EV Minimum
     C                     Z-ADDWRAGPC    YL0118           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         QAEXIT    ENDSR
      /EJECT
     CSR         QBRVGN    BEGSR
      *================================================================
      * Rtv Min/Max Values    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQB     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELWN0616    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQB     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0119           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     GOTO QBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAFPC    YL0119           EV Minimum
     C                     Z-ADDWRAGPC    WUAGPC           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         QBEXIT    ENDSR
      /EJECT
     CSR         QCRVGN    BEGSR
      *================================================================
      * Bal Flag f/Purge All  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQQC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQQC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQQC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQQC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQQC05           TH Kill Date
      * Define keylist
     C           KRSQC     KLIST
     C                     KFLD           WQQC01           BOH Company Num
     C                     KFLD           WQQC02           BOH Buy Order N
     C                     KFLD           WQQC03           BOL Load Number
     C                     KFLD           WQQC04           TH Tattoo Numbe
     C                     KFLD           WQQC05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQC01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQC02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQC03           BOL Load Number
     C                     Z-ADDP1CVNB    WQQC04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQQC05           TH Kill Date
      * Establish starting position
     C           KRSQC     SETLL@BVCPQ9                    *
     C           KRSQC     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Chg Record Status     CH - Eval Trans  * 
     C                     EXSR QDCHRC
      * Subtract from Totals
     C                     EXSR UTSUBR                     Subtract from T
     C                     END                             *FI
     C           KRSQC     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         QCEXIT    ENDSR
      /EJECT
     CSR         QDCHRC    BEGSR
      *================================================================
      * Chg Record Status     CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0617  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0618  50       ET Lot
     C                     MOVEL*BLANK    WN0619  1        ET Shift
     C                     Z-ADD*ZERO     WN0620  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0621  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0622  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0623  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0624  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0625  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0626  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0627  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0628  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0629  1        ET Trim Area
     C                     MOVEL*BLANK    WN0630  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0631  1        ET Error Sts
     C                     MOVEL*BLANK    WN0632  1        ET Record Add/D
     C                     MOVEL*BLANK    WN0633  1        ET Record Creat
     C                     MOVEL*BLANK    WN0634  1        ET Record Creat
     C                     MOVEL*BLANK    WN0635  1        ET User Error O
     C                     MOVEL*BLANK    WN0636  3        ET Adjust/Add T
     C                     MOVEL*BLANK    WN0637  1        ET Broken Back
     C                     MOVEL*BLANK    WN0638  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0639  2        ET Adjust/Add S
     C                     MOVEL*BLANK    WN0640  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0641  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0642  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0643  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0644  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0645  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0646  70       TH Kill Date
     C                     MOVEL*BLANK    WN0647 10        RS User Changed
     C                     Z-ADD*ZERO     WN0648  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0649  60       RS Time Changed
     C                     MOVEL*BLANK    WN0650 10        RS Job
     C                     MOVEL*BLANK    WN0651 10        RS Program
     C                     MOVEL*BLANK    WN0652 10        RS User Added
     C                     Z-ADD*ZERO     WN0653  70       RS Date Added
     C                     Z-ADD*ZERO     WN0654  60       RS Time Added
     C                     Z-ADD*ZERO     WN0655  70       RU Date
     C                     Z-ADD*ZERO     WN0656  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHQD    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHQD    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YNRDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL'D'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QDEXIT    ENDSR
      /EJECT
     CSR         QERVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHSNB    WQQE01           ET Company Numb
     C           *LIKE     DEFN WYA9DT    WQQE02           ET Kill Date
      * Define keylist
     C           KRSQE     KLIST
     C                     KFLD           WQQE01           ET Company Numb
     C                     KFLD           WQQE02           ET Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQE01           ET Company Numb
     C                     Z-ADDP1B0DT    WQQE02           ET Kill Date
      * Establish starting position
     C           KRSQE     SETLL@BVCPNE                    *
     C           KRSQE     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0123           ET Scale Sequen
     C                     GOTO QEEXIT                     *QUIT
     C                     GOTO QEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WYFJNB    IFGE 000001                     *IF
     C           WYFJNB    ANDLE699999
     C           WYFJNB    ADD  1         YL0123           ET Scale Sequen
     C                     GOTO QEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSQE     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         QEEXIT    ENDSR
      /EJECT
     CSR         QFCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP1HMNB    WDHSNB           ET Company Numb
     C                     Z-ADDP1B0DT    WDA9DT           ET Kill Date
     C                     Z-ADDYL0123    WDFJNB           ET Scale Sequen
     C                     Z-ADDYL0123    WDHCNB           ET Carcass Numb
     C                     Z-ADD000001    WDGDNB           ET Carcass Numb
     C                     Z-ADDP1CVNB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDP1CVNB    WDLKNB           ET Lot
     C                     MOVELP1LIST    WDEAST           ET Shift
     C                     Z-ADDWN0606    WDAMPC           ET Hot Wgt
     C                     Z-ADDWN0607    WDAIPC           ET Backfat Thic
     C                     Z-ADDWN0608    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDWN0609    WDAKPC           ET Lean Percent
     C                     Z-ADDWN0610    WDX8NB           ET Backfat Thic
     C                     Z-ADDWN0611    WDFVPC           ET Loineye Dept
     C                     Z-ADDWN0612    WDFWPC           ET Light Reflec
     C                     Z-ADDWN0613    WDFXPC           ET Lean Percent
     C                     Z-ADDWN0614    WDALPC           ET Light Reflec
     C                     MOVELWUDIST    WDDIST           ET Trim Area
     C                     MOVELWUFYST    WDFYST           ET Carcass Sex
     C                     MOVEL'B'       WDD2ST           ET Error Sts
     C                     MOVEL'A'       WDEHST           ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST           ET Record Creat
     C                     MOVEL'A'       WDH4ST           ET Record Creat
     C                     MOVEL*BLANK    WDJLST           ET User Error O
     C                     MOVELWN0615    WDUUST           ET Adjust/Add T
     C                     MOVEL*BLANK    WDVHST           ET Broken Back
     C                     MOVELWN0657    WDVIST           ET Unused Sts 2
     C                     MOVELYL0124    WDVJST           ET Adjust/Add S
     C                     MOVELWN0658    WDVKST           ET Unused Sts 4
     C                     MOVELWN0659    WDVLST           ET Unused Sts 5
     C                     Z-ADDP1HMNB    WDHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WDBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WDB0DT           TH Kill Date
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL*BLANK    WDAHVN           RS Job
     C                     MOVEL*BLANK    WDAGVN           RS Program
     C                     MOVEL*BLANK    WDABVN           RS User Added
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     Z-ADD*ZERO     WDB8DT           RU Date
     C                     Z-ADD*ZERO     WDAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRQF    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRQF    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QFEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QFEXIT    ENDSR
      /EJECT
     CSR         QGRVGN    BEGSR
      *================================================================
      * Upd PHA Yld/LeanPrm   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQQG01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQQG02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQQG03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQQG04           TH Tattoo Numbe
      * Define keylist
     C           KRSQG     KLIST
     C                     KFLD           WQQG01           BOH Company Num
     C                     KFLD           WQQG02           BOH Buy Order N
     C                     KFLD           WQQG03           BOL Load Number
     C                     KFLD           WQQG04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQQG01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQG02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQG03           BOL Load Number
     C                     Z-ADDP1CVNB    WQQG04           TH Tattoo Numbe
      * Establish starting position
     C           KRSQG     SETLL@A1CPC4                    *
     C           KRSQG     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
      *================================================================
     CSR         QGEXIT    ENDSR
      /EJECT
     CSR         QHCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Hot Wgt for Add Inva
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HWA'     WBDXST           KV Error Code
     C                     MOVEL@CN,03    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0126    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,03    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QIRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQH    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQH    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QHEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QHEXIT    ENDSR
      /EJECT
     CSR         QIRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQI     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HWA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQI     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QIEXIT    ENDSR
      /EJECT
     CSR         QJCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * PHA Not Avail
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'PHA'     WBDXST           KV Error Code
     C                     MOVEL@CN,04    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,04    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QKRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQJ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQJ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QJEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QJEXIT    ENDSR
      /EJECT
     CSR         QKRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQK     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'PHA'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQK     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QKEXIT    ENDSR
      /EJECT
     CSR         QLCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * Yield Error
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'YLD'     WBDXST           KV Error Code
     C                     MOVEL@CN,07    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,07    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QMRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQL    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQL    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QLEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QLEXIT    ENDSR
      /EJECT
     CSR         QMRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQM     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'YLD'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQM     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QMEXIT    ENDSR
      /EJECT
     CSR         QNCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HLD'     WBDXST           KV Error Code
     C                     MOVEL@CN,08    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVELYL0127    WBAJST           RS Record Statu
     C                     MOVEL*BLANK    WBAHVN           RS Job
     C                     MOVEL*BLANK    WBAGVN           RS Program
     C                     MOVEL*BLANK    WBABVN           RS User Added
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,08    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR QORVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRQN    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRQN    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO QNEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         QNEXIT    ENDSR
      /EJECT
     CSR         QORVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSQO     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HLD'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSQO     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         QOEXIT    ENDSR
      /EJECT
     CSR         QPCHRC    BEGSR
      *================================================================
      * Chg Val Kill Trans    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0661  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0662 10        TH Group Refere
     C                     MOVEL*BLANK    WN0663  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0664  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0665  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0666  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0667  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0668  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0669  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0670  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0671  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0672  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0673  50       TH Held Over
     C                     Z-ADD*ZERO     WN0674  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0675  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0676  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0677  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0678  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0679  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0680  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0681  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0682  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0683  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0684  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0685  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0686  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0687  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0688  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0689  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0690  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0691  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0692  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0693  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0694  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0695  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0696  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0697  2        TH Payment Sts
     C                     Z-ADD*ZERO     WN0698  80       TH Commission A
     C                     Z-ADD*ZERO     WN0699  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0700  1        TH User Error O
     C                     MOVEL*BLANK    WN0701  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0702  1        TH Sex
     C                     Z-ADD*ZERO     WN0703  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0704  70       TH Commission P
     C                     Z-ADD*ZERO     WN0705  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0706  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0707  31       TH FFLI
     C                     Z-ADD*ZERO     WN0708  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0709  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0710  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0711  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0712  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0713  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0714  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0715  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0716  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0717  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0718  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0719  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0720  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0721  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0722  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0723  1        TH Source Type
     C                     MOVEL*BLANK    WN0724  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0725  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0726  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0727  3        TH Source Code
     C                     MOVEL*BLANK    WN0728  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0729  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0730  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0731  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0732  3        TH State
     C                     MOVEL*BLANK    WN0733  3        TH Unused Code
     C                     MOVEL*BLANK    WN0734  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0735  1        TH Commission S
     C                     MOVEL*BLANK    WN0736  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0737  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0738  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0739  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0740  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0741  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0742  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0743  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0744  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0745  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0746  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0747  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0748  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0749  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0750  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0751  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0752 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0753 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0754 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0755 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0756  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0757  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0758  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0759  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0760  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0761  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0762  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0763  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0764  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0765  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0766  70       TH Unused Date
     C                     MOVEL*BLANK    WN0767  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0768  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0769  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0770  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0771  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0772  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0773  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0774  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0775  6        DF Defect Code
     C                     MOVEL*BLANK    WN0776  6        THP Process Cod
     C                     MOVEL*BLANK    WN0777  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0778  6        PL Location Cod
     C                     MOVEL*BLANK    WN0779  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0780  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0781  3        HC Class Code
     C                     MOVEL*BLANK    WN0782 10        RS User Changed
     C                     Z-ADD*ZERO     WN0783  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0784  60       RS Time Changed
     C                     MOVEL*BLANK    WN0785  1        RS Record Statu
     C                     MOVEL*BLANK    WN0786 10        RS Job
     C                     MOVEL*BLANK    WN0787 10        RS Program
     C                     MOVEL*BLANK    WN0788 10        RS User Added
     C                     Z-ADD*ZERO     WN0789  70       RS Date Added
     C                     Z-ADD*ZERO     WN0790  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDP1HMNB    WKHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WKBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WKB0DT           TH Kill Date
      *
     C           KLCHQP    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C           KLCHQP    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YORDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDP1AIPR    WKAIPR           TH Recalc Live
     C                     Z-ADDYL0009    WKFDNB           TH Head Condemn
     C                     Z-ADDYL0013    WKFENB           TH Head Killed
     C                     Z-ADDYL0014    WKHENB           TH Head Adds
     C                     Z-ADDYL0015    WKHFNB           TH Head Accepte
     C                     Z-ADDYL0081    WKLRNB           TH Adj Live Wgt
     C                     Z-ADDYL0016    WKE0NB           TH Hot Wgt
     C                     Z-ADDYL0017    WKA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0018    WKFBNB           TH Tot Backfat
     C                     Z-ADDYL0019    WKA4PC           TH Tot Light Re
     C                     Z-ADDYL0086    WKHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0091    WKF5NB           TH Avg Light Re
     C                     Z-ADDYL0088    WKF4NB           TH Avg Lean Per
     C                     Z-ADDYL0090    WKF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0089    WKF2NB           TH Avg Backfat
     C                     Z-ADDYL0093    WKAWPC           TH Actual Yield
     C                     Z-ADDYL0085    WKCWPC           TH Adj Actual Y
     C                     Z-ADDYL0139    WKA2PR           TH Fixed Cost A
     C                     MOVELYL0002    WKD7ST    P      TH Header Error
     C                     MOVELYL0003    WKD8ST    P      TH Detail Error
     C                     MOVELYL0004    WKDWST    P      TH Kill Balanci
     C                     MOVELYL0006    WKD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0087    WKHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0020    WKJ9NB           TH Head Exclude
     C                     Z-ADDYL0092    WKT2WT           TH Avg Lean % E
     C                     Z-ADDYL0021    WKKOER           TH Head Identif
     C                     Z-ADDYL0079    WKOPIR           TH Percent Iden
     C                     Z-ADDYL0080    WKOPEM           TH Percent Acce
     C                     Z-ADDYL0022    WKIORP           TH Head Adjuste
     C                     Z-ADDYL0113    WKOWEO           TH PHA Head Add
     C                     MOVELYL0097    WKOQET    P      TH PHA Add Type
     C                     MOVELYL0111    WKURST    P      TH PHA Average
     C                     MOVELYL0098    WKUSST    P      TH PHA Add Reas
     C                     Z-ADDYL0103    WKHHPC           TH PHA Yield Pe
     C                     Z-ADDYL0108    WKS9PR           TH PHA Lean Prm
     C                     Z-ADDYL0138    WKORJK           TH Yld Parm Adj
     C                     Z-ADDYL0112    WKOMVJ           TH PHA Sort Dis
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WKAAVN           RS User Changed
     C                     Z-ADD##JDT     WKAADT           RS Date Changed
     C                     Z-ADD##JTM     WKAMTM           RS Time Changed
     C                     MOVEL##JOB     WKAHVN           RS Job
     C                     MOVEL##PGM     WKAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QPEXIT    ENDSR
      /EJECT
     CSR         QQRVGN    BEGSR
      *================================================================
      * RtvChg Td Cmpl Sts     RT - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMHMNB    WQQQ01           BOH Company Num
     C           *LIKE     DEFN WMBNNB    WQQQ02           BOH Buy Order N
     C           *LIKE     DEFN WMBONB    WQQQ03           BOL Load Number
     C           *LIKE     DEFN WMCVNB    WQQQ04           TH Tattoo Numbe
     C           *LIKE     DEFN WMB0DT    WQQQ05           TH Kill Date
      * Define keylist
     C           KRSQQ     KLIST
     C                     KFLD           WQQQ01           BOH Company Num
     C                     KFLD           WQQQ02           BOH Buy Order N
     C                     KFLD           WQQQ03           BOL Load Number
     C                     KFLD           WQQQ04           TH Tattoo Numbe
     C                     KFLD           WQQQ05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQQQ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQQQ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQQQ03           BOL Load Number
     C                     Z-ADDP1CVNB    WQQQ04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQQQ05           TH Kill Date
      * Establish starting position
     C           KRSQQ     SETLL@DYCPXX                    *
     C           KRSQQ     READE@DYCPXX                  90*
      * Data record not found
     C   90                MOVEL'PRK0733' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
     C                     EXSR QRCHRC
     C           KRSQQ     READE@DYCPXX                  90*
     C                     ENDDO
      *================================================================
     CSR         QQEXIT    ENDSR
      /EJECT
     CSR         QRCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWMHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDWMBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDWMBONB    WOBONB           BOL Load Number
     C                     Z-ADDWMCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDWMB0DT    WOB0DT           TH Kill Date
     C                     Z-ADDWMC2NB    WOC2NB           TD Sequence Num
      *
     C           KLCHQR    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOC2NB           TD Sequence Num
     C           KLCHQR    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO QREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO QREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YPRDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WOAAVN           RS User Changed
     C                     Z-ADD##JDT     WOAADT           RS Date Changed
     C                     Z-ADD##JTM     WOAMTM           RS Time Changed
     C                     MOVEL##JOB     WOAHVN           RS Job
     C                     MOVEL##PGM     WOAGVN           RS Program
      * Move non-key fields to @DYCPXW
     C                     MOVEL'Y'       WOP3ST    P      Completed Statu
     C                     Z-ADDWMLENB    WOLENB           Hot Head
     C                     Z-ADDWMLFNB    WOLFNB           TDE Head Condem
     C                     Z-ADDWMLINB    WOLINB           Head 2
     C                     MOVELWMP4ST    WOP4ST    P      Status 1
     C                     MOVELWMP5ST    WOP5ST    P      Status 2
     C                     MOVELWMAAVN    WOAAVN    P      RS User Changed
     C                     Z-ADDWMAADT    WOAADT           RS Date Changed
     C                     Z-ADDWMAMTM    WOAMTM           RS Time Changed
     C                     MOVELWMAJST    WOAJST    P      RS Record Statu
     C                     MOVELWMAHVN    WOAHVN    P      RS Job
     C                     MOVELWMAGVN    WOAGVN    P      RS Program
     C                     MOVELWMABVN    WOABVN    P      RS User Added
     C                     Z-ADDWMABDT    WOABDT           RS Date Added
     C                     Z-ADDWMABTM    WOABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         QREXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Dlt All Error's       RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHRNB    WQSA01           KV Company Numb
     C           *LIKE     DEFN WABPDT    WQSA02           KV Kill Date
     C           *LIKE     DEFN WAIRNB    WQSA03           KV TATTOO NUMBE
     C           *LIKE     DEFN WABONM    WQSA04           KV Buy Order Nu
     C           *LIKE     DEFN WALDNM    WQSA05           KV Load Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           KV Company Numb
     C                     KFLD           WQSA02           KV Kill Date
     C                     KFLD           WQSA03           KV TATTOO NUMBE
     C                     KFLD           WQSA04           KV Buy Order Nu
     C                     KFLD           WQSA05           KV Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           KV Company Numb
     C                     Z-ADDP1B0DT    WQSA02           KV Kill Date
     C                     Z-ADDP1CVNB    WQSA03           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WQSA04           KV Buy Order Nu
     C                     Z-ADDP1BONB    WQSA05           KV Load Number
      * Establish starting position
     C           KRSSA     SETLL@B6CPGX                    *
     C           KRSSA     READE@B6CPGX                  90*
      * Data record not found
     C   90                MOVEL'PRK0150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WABONM' defaulted for 'KV Buy Order Number'.
      * Field '(DB1) WALDNM' defaulted for 'KV Load Number'.
      * Delete Kill Validation - Eval/Loss Error  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@B6CPGX                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Delete Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPGW
     C                     Z-ADDWAHRNB    WBHRNB           KV Company Numb
     C                     Z-ADDWABPDT    WBBPDT           KV Kill Date
     C                     Z-ADDWAIRNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWABONM    WBBONM           KV Buy Order Nu
     C                     Z-ADDWALDNM    WBLDNM           KV Load Number
     C                     Z-ADDWAFPNB    WBFPNB           KV Record Numbe
     C                     MOVELWADYST    WBDYST           KV Record Type
     C                     MOVELWADXST    WBDXST           KV Error Code
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
     C           KLDLSB    CHAIN@B6CPGW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB6CPL0'MDACP
     C                     MOVEL'@B6CPGW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPGW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Bal Init Eval Trans   RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSC05           TH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
     C                     KFLD           WQSC05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSC01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSC03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSC04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSC05           TH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@BVCPQ9                    *
     C           KRSSC     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           WCEHST    IFEQ 'A'                        *IF
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SDDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * 060104 SLM  HPEBAL Add the ET Adjust/Add Source Initial to *none
      * Bal Init Eval Trans   CH - Eval Trans  * 
     C                     EXSR SECHRC
     C                     END                             *FI
     C           KRSSC     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLDLSD    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Bal Init Eval Trans   CH - Eval Trans  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       ET Tattoo Numbe
     C                     Z-ADD*ZERO     WN0002  50       ET Lot
     C                     MOVEL*BLANK    WN0003  1        ET Shift
     C                     Z-ADD*ZERO     WN0004  51       ET Hot Wgt
     C                     Z-ADD*ZERO     WN0005  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0006  31       ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0007  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0008  31       ET Backfat Thic
     C                     Z-ADD*ZERO     WN0009  31       ET Loineye Dept
     C                     Z-ADD*ZERO     WN0010  31       ET Light Reflec
     C                     Z-ADD*ZERO     WN0011  31       ET Lean Percent
     C                     Z-ADD*ZERO     WN0012  31       ET Light Reflec
     C                     MOVEL*BLANK    WN0013  1        ET Trim Area
     C                     MOVEL*BLANK    WN0014  1        ET Carcass Sex
     C                     MOVEL*BLANK    WN0015  1        ET Record Creat
     C                     MOVEL*BLANK    WN0016  1        ET Broken Back
     C                     MOVEL*BLANK    WN0017  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0018  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0019  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0020  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0021  50       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0022  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0023  50       TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0024  70       TH Kill Date
     C                     MOVEL*BLANK    WN0025 10        RS User Changed
     C                     Z-ADD*ZERO     WN0026  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0027  60       RS Time Changed
     C                     MOVEL*BLANK    WN0028 10        RS Job
     C                     MOVEL*BLANK    WN0029 10        RS Program
     C                     MOVEL*BLANK    WN0030 10        RS User Added
     C                     Z-ADD*ZERO     WN0031  70       RS Date Added
     C                     Z-ADD*ZERO     WN0032  60       RS Time Added
     C                     Z-ADD*ZERO     WN0033  70       RU Date
     C                     Z-ADD*ZERO     WN0034  60       RU Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHSE    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHSE    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YARDCS
      * Move non-key fields to @BVCPF0
     C                     MOVEL*BLANK    WDD2ST    P      ET Error Sts
     C                     MOVEL*BLANK    WDEHST    P      ET Record Add/D
     C                     MOVEL*BLANK    WDG1ST    P      ET Record Creat
     C                     MOVEL*BLANK    WDJLST    P      ET User Error O
     C                     MOVEL*BLANK    WDUUST    P      ET Adjust/Add T
     C                     MOVEL*BLANK    WDVJST    P      ET Adjust/Add S
     C                     MOVEL'A'       WDAJST    P      RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Del Payment Comments  RT - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WEBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN WEBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN WECVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN WEB0DT    WQSF05           TH Kill Date
     C           *LIKE     DEFN WEETST    WQSF06           THC Comment Typ
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
     C                     KFLD           WQSF06           THC Comment Typ
      * Setup key
     C                     Z-ADDP1HMNB    WQSF01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSF03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSF05           TH Kill Date
     C                     MOVEL'P'       WQSF06           THC Comment Typ
      * Establish starting position
     C           KRSSF     SETLL@A4CPL4                    *
     C           KRSSF     READE@A4CPL4                  90*
      * Data record not found
     C   90                MOVEL'PRK0067' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Tattoo Header Comm - Tattoo Header Comment  * 
     C                     EXSR SGDLRC
     C           KRSSF     READE@A4CPL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Delete Tattoo Header Comm - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @A4CPC3
     C                     Z-ADDWEHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWEBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWEBONB    WFBONB           BOL Load Number
     C                     Z-ADDWECVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWEB0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWEBETX    WFBETX           THC Comment Lin
      *
     C           KLDLSG    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBETX           THC Comment Lin
     C           KLDLSG    CHAIN@A4CPC3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA4CPL0'MDACP
     C                     MOVEL'@A4CPC3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@A4CPC3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Bal/Tattoo Hdr    RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSH03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQSH04           TH Tattoo Numbe
     C           *LIKE     DEFN WGB0DT    WQSH05           TH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
     C                     KFLD           WQSH04           TH Tattoo Numbe
     C                     KFLD           WQSH05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSH01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSH03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSH04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSH05           TH Kill Date
      * Establish starting position
     C           KRSSH     SETLL@BSCPLV                    *
     C           KRSSH     READE@BSCPLV                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.LT Type Code is Carcass Loss
      *   |- c2    : DB1.LTN Wgt is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WGBWCD    IFEQ 02                         *IF
     C           WGDSNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP1F7NB    WUDSNB           LTN Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWGDSNB    WUDSNB           LTN Wgt
     C                     END                             *FI
      * Val Loss Trans        XF - Loss Trans  * 
     C                     CLEARPARC
     C                     Z-ADDWGHUNB    PAHUNB           LTN Company Num
     C                     Z-ADDWGA7DT    PAA7DT           LTN Kill Date
     C                     Z-ADDWGFHNB    PAFHNB           LTN Record Numb
     C                     Z-ADDWGFFNB    PAFFNB           LTN Tattoo Numb
     C                     MOVELWGEBST    PAEBST    P      LTN Shift
     C                     Z-ADDWUDSNB    PADSNB           LTN Wgt
     C                     MOVELWGS3NB    PAS3NB    P      LTN Extent
     C                     MOVELWGS4NB    PAS4NB    P      LTN Trim Locati
     C                     MOVELWUD1ST    PAD1ST    P      LTN Error Sts
     C                     MOVELWGH5ST    PAH5ST    P      LTN Record Crea
     C                     MOVELWGJMST    PAJMST    P      LTN User Error
     C                     MOVELWGSMST    PASMST    P      LTN Source Type
     C                     Z-ADDWGBWCD    PABWCD           LT Type Code
     C                     Z-ADDWGBYCD    PABYCD           LR Reason Code
     C                     Z-ADDWGHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    PABONB           BOL Load Number
     C                     Z-ADDWGCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    PAB0DT           TH Kill Date
     C                     MOVELWGAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWGAADT    PAAADT           RS Date Changed
     C                     Z-ADDWGAMTM    PAAMTM           RS Time Changed
     C                     MOVELWGAJST    PAAJST    P      RS Record Statu
     C                     MOVELWGAHVN    PAAHVN    P      RS Job
     C                     MOVELWGAGVN    PAAGVN    P      RS Program
     C                     MOVELWGABVN    PAABVN    P      RS User Added
     C                     Z-ADDWGABDT    PAABDT           RS Date Added
     C                     Z-ADDWGABTM    PAABTM           RS Time Added
     C                     Z-ADDWGB8DT    PAB8DT           RU Date
     C                     Z-ADDWGAOTM    PAAOTM           RU Time
      *
     C                     CALL 'PKPJXFR'              90  Val Loss Trans
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Loss Trans
     C           YL0009    PARM YL0009    WQ0004  50       TH Head Condemn
     C           WUH9ST    PARM WUH9ST    WQ0005  1        Loss Error 1 Us
     C           WUIAST    PARM WUIAST    WQ0006  1        Loss Error 2 Us
     C           WUIBST    PARM WUIBST    WQ0007  1        Loss Error 3 Us
     C           WUICST    PARM WUICST    WQ0008  1        Loss Error 4 Us
     C           WULRST    PARM WULRST    WQ0009  1        Loss Error 5 Us
     C           YL0003    PARM YL0003    WQ0010  1        TH Detail Error
      *
     C                     MOVELPAD1ST    WUD1ST           LTN Error Sts
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Loss Transaction  CH - Loss Trans  * 
     C                     EXSR SICHRC
     C           KRSSH     READE@BSCPLV                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Loss Transaction  CH - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BSCPFS
     C                     Z-ADDWGHUNB    WHHUNB           LTN Company Num
     C                     Z-ADDWGA7DT    WHA7DT           LTN Kill Date
     C                     Z-ADDWGFHNB    WHFHNB           LTN Record Numb
      *
     C           KLCHSI    KLIST
     C                     KFLD           WHHUNB           LTN Company Num
     C                     KFLD           WHA7DT           LTN Kill Date
     C                     KFLD           WHFHNB           LTN Record Numb
     C           KLCHSI    CHAIN@BSCPFS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBSCPL0'MDACP
     C                     MOVEL'@BSCPFS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBS1    YBRDCS
      * Move non-key fields to @BSCPFS
     C                     Z-ADDWGFFNB    WHFFNB           LTN Tattoo Numb
     C                     MOVELWGEBST    WHEBST    P      LTN Shift
     C                     Z-ADDWUDSNB    WHDSNB           LTN Wgt
     C                     MOVELWGS3NB    WHS3NB    P      LTN Extent
     C                     MOVELWGS4NB    WHS4NB    P      LTN Trim Locati
     C                     MOVELWUD1ST    WHD1ST    P      LTN Error Sts
     C                     MOVELWGH5ST    WHH5ST    P      LTN Record Crea
     C                     MOVELWGJMST    WHJMST    P      LTN User Error
     C                     MOVELWGSMST    WHSMST    P      LTN Source Type
     C                     Z-ADDWGBWCD    WHBWCD           LT Type Code
     C                     Z-ADDWGBYCD    WHBYCD           LR Reason Code
     C                     Z-ADDWGHMNB    WHHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    WHBONB           BOL Load Number
     C                     Z-ADDWGCVNB    WHCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    WHB0DT           TH Kill Date
     C                     MOVEL##USR     WHAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WHAADT           RS Date Changed
     C                     Z-ADD##JTM     WHAMTM           RS Time Changed
     C                     MOVELWGAJST    WHAJST    P      RS Record Statu
     C                     MOVELWGAHVN    WHAHVN    P      RS Job
     C                     MOVELWGAGVN    WHAGVN    P      RS Program
     C                     MOVELWGABVN    WHABVN    P      RS User Added
     C                     Z-ADDWGABDT    WHABDT           RS Date Added
     C                     Z-ADDWGABTM    WHABTM           RS Time Added
     C                     Z-ADDWGB8DT    WHB8DT           RU Date
     C                     Z-ADDWGAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WHAGVN' defaulted for 'RS Program'.
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WHAAVN           RS User Changed
     C                     Z-ADD##JDT     WHAADT           RS Date Changed
     C                     Z-ADD##JTM     WHAMTM           RS Time Changed
     C                     MOVEL##JOB     WHAHVN           RS Job
     C                     MOVEL##PGM     WHAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BSCPFS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Head Condemn      RT - Tattoo Header  * 
     C                     EXSR SJRVGN
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Upd Head Condemn      RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0035  50       TH Head Condemn
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWHHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
     C                     Z-ADDWHCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWHB0DT    WIB0DT           TH Kill Date
      * Establish starting position
     C           KRSSJ     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Head Condemned    RT - Loss Trans  * 
     C                     EXSR SKRVGN
      * Chg Head Condemned    CH - Tattoo Header  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Head Condemned    RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0035           TH Head Condemn
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJBWCD    WQSK01           LT Type Code
     C           *LIKE     DEFN WJHMNB    WQSK02           BOH Company Num
     C           *LIKE     DEFN WJBNNB    WQSK03           BOH Buy Order N
     C           *LIKE     DEFN WJBONB    WQSK04           BOL Load Number
     C           *LIKE     DEFN WJCVNB    WQSK05           TH Tattoo Numbe
     C           *LIKE     DEFN WJB0DT    WQSK06           TH Kill Date
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           LT Type Code
     C                     KFLD           WQSK02           BOH Company Num
     C                     KFLD           WQSK03           BOH Buy Order N
     C                     KFLD           WQSK04           BOL Load Number
     C                     KFLD           WQSK05           TH Tattoo Numbe
     C                     KFLD           WQSK06           TH Kill Date
      * Setup key
     C                     Z-ADD02        WQSK01           LT Type Code
     C                     Z-ADDWIHMNB    WQSK02           BOH Company Num
     C                     Z-ADDWIBNNB    WQSK03           BOH Buy Order N
     C                     Z-ADDWIBONB    WQSK04           BOL Load Number
     C                     Z-ADDWICVNB    WQSK05           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WQSK06           TH Kill Date
      * Establish starting position
     C           KRSSK     SETLL@BSCPEM                    *
     C           KRSSK     READE@BSCPEM                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0035           TH Head Condemn
     C           KRSSK     READE@BSCPEM                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Head Condemned    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0036  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0037 10        TH Group Refere
     C                     MOVEL*BLANK    WN0038  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0039  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0040  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0041  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0042  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0043  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0044  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0045  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0046  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0047  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0048  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0049  50       TH Held Over
     C                     Z-ADD*ZERO     WN0050  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0051  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0052  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0053  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0054  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0055  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0056  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0057  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0058  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0059  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0060  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0061  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0062  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0063  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0064  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0065  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0066  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0067  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0068  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0069  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0070  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0071  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0072  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0073  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0074  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0075  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0076  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0077  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0078  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0079  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0080  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0081  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0082  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0083  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0084  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0085  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0086  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0087  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0088  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0089  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0090  1        TH Header Error
     C                     MOVEL*BLANK    WN0091  1        TH Detail Error
     C                     MOVEL*BLANK    WN0092  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0093  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0094  80       TH Commission A
     C                     Z-ADD*ZERO     WN0095  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0096  1        TH User Error O
     C                     MOVEL*BLANK    WN0097  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0098  1        TH Sex
     C                     Z-ADD*ZERO     WN0099  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0100  70       TH Commission P
     C                     Z-ADD*ZERO     WN0101  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0102  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0103  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0104  31       TH FFLI
     C                     Z-ADD*ZERO     WN0105  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0106  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0107  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0108  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0109  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0110  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0111  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0112  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0113  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0114  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0115  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0116  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0117  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0118  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0119  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0120  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0121  1        TH Source Type
     C                     MOVEL*BLANK    WN0122  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0123  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0124  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0125  3        TH Source Code
     C                     MOVEL*BLANK    WN0126  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0127  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0128  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0129  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0130  3        TH State
     C                     MOVEL*BLANK    WN0131  3        TH Unused Code
     C                     MOVEL*BLANK    WN0132  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0133  1        TH Commission S
     C                     MOVEL*BLANK    WN0134  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0135  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0136  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0137  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0138  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0139  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0140  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0141  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0142  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0143  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0144  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0145  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0146  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0147  3        TH PHA Average
     C                     MOVEL*BLANK    WN0148  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0149  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0150  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0151  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0152  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0153  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0154  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0155  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0156  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0157  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0158  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0159  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0160  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0161 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0162 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0163 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0164 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0165  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0166  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0167  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0168  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0169  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0170  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0171  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0172  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0173  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0174  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0175  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0176  70       TH Unused Date
     C                     Z-ADD*ZERO     WN0177  70       TH Unused Date
     C                     MOVEL*BLANK    WN0178  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0179  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0180  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0181  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0182  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0183  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0184  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0185  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0186  6        DF Defect Code
     C                     MOVEL*BLANK    WN0187  6        THP Process Cod
     C                     MOVEL*BLANK    WN0188  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0189  6        PL Location Cod
     C                     MOVEL*BLANK    WN0190  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0191  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0192  3        HC Class Code
     C                     MOVEL*BLANK    WN0193 10        RS User Changed
     C                     Z-ADD*ZERO     WN0194  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0195  60       RS Time Changed
     C                     MOVEL*BLANK    WN0196  1        RS Record Statu
     C                     MOVEL*BLANK    WN0197 10        RS Job
     C                     MOVEL*BLANK    WN0198 10        RS Program
     C                     MOVEL*BLANK    WN0199 10        RS User Added
     C                     Z-ADD*ZERO     WN0200  70       RS Date Added
     C                     Z-ADD*ZERO     WN0201  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWIHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWIBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWIBONB    WKBONB           BOL Load Number
     C                     Z-ADDWICVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WKB0DT           TH Kill Date
      *
     C           KLCHSL    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C           KLCHSL    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWN0035    WKFDNB           TH Head Condemn
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * CASE: PAR.TH Head Condemned NE DB1.TH Head Condemned
     C           WN0035    IFNE WKFDNB                     *IF
      * When Condemns are created we update the tattoo header
      * with the balancing = E,
     C                     MOVEL'E'       WKDWST           TH Kill Balanci
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Head Condemned    RT - Tattoo Detail  * 
     C                     EXSR SMRVGN
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Upd Head Condemned    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN WLBNNB    WQSM02           BOH Buy Order N
     C           *LIKE     DEFN WLBONB    WQSM03           BOL Load Number
     C           *LIKE     DEFN WLCVNB    WQSM04           TH Tattoo Numbe
     C           *LIKE     DEFN WLB0DT    WQSM05           TH Kill Date
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           BOH Buy Order N
     C                     KFLD           WQSM03           BOL Load Number
     C                     KFLD           WQSM04           TH Tattoo Numbe
     C                     KFLD           WQSM05           TH Kill Date
      * Setup key
     C                     Z-ADDWKHMNB    WQSM01           BOH Company Num
     C                     Z-ADDWKBNNB    WQSM02           BOH Buy Order N
     C                     Z-ADDWKBONB    WQSM03           BOL Load Number
     C                     Z-ADDWKCVNB    WQSM04           TH Tattoo Numbe
     C                     Z-ADDWKB0DT    WQSM05           TH Kill Date
      * Establish starting position
     C           KRSSM     SETLL@A2CPDG                    *
     C           KRSSM     READE@A2CPDG                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WLC0NB    SUB  WLD8NB    YL0010           Net Head Usr
      * CASE: DB1.Pen Number is Stress Pen
     C           WLCMCD    IFEQ 'ST1'                      *IF
     C                     ELSE
      * CASE: LCL.Net Head Usr is *Zeros
     C           YL0010    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Head Condemned    RT - Tattoo Detail Ext  * 
     C                     EXSR SNRVGN
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@A2CPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Upd Head Condemned    RT - Tattoo Detail Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0202  1        Completed Statu
     C                     Z-ADD*ZERO     WN0203  50       Hot Head
     C                     Z-ADD*ZERO     WN0204  50       Head 2
     C                     MOVEL*BLANK    WN0205  1        Status 1
     C                     MOVEL*BLANK    WN0206  1        Status 2
     C                     MOVEL*BLANK    WN0207 10        RS User Changed
     C                     Z-ADD*ZERO     WN0208  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0209  60       RS Time Changed
     C                     MOVEL*BLANK    WN0210  1        RS Record Statu
     C                     MOVEL*BLANK    WN0211 10        RS Job
     C                     MOVEL*BLANK    WN0212 10        RS Program
     C                     MOVEL*BLANK    WN0213 10        RS User Added
     C                     Z-ADD*ZERO     WN0214  70       RS Date Added
     C                     Z-ADD*ZERO     WN0215  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
     C                     KFLD           WMBONB           BOL Load Number
     C                     KFLD           WMCVNB           TH Tattoo Numbe
     C                     KFLD           WMB0DT           TH Kill Date
     C                     KFLD           WMC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDWLHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWLBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WMBONB           BOL Load Number
     C                     Z-ADDWLCVNB    WMCVNB           TH Tattoo Numbe
     C                     Z-ADDWLB0DT    WMB0DT           TH Kill Date
     C                     Z-ADDWLC2NB    WMC2NB           TD Sequence Num
      * Establish starting position
     C           KRSSN     CHAIN@DYCPXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0733' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
     C                     EXSR SOCRRC
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Head Condemned    CH - Tattoo Detail Ext  * 
     C                     EXSR SPCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DYCPXW
     C                     Z-ADDWLHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDWLBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WOBONB           BOL Load Number
     C                     Z-ADDWLCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDWLB0DT    WOB0DT           TH Kill Date
     C                     Z-ADDWLC2NB    WOC2NB           TD Sequence Num
     C                     MOVEL'N'       WOP3ST           Completed Statu
     C                     Z-ADD*ZERO     WOLENB           Hot Head
     C                     Z-ADDWKFDNB    WOLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WOLINB           Head 2
     C                     MOVEL'N'       WOP4ST           Status 1
     C                     MOVEL'N'       WOP5ST           Status 2
     C                     MOVELWN0207    WOAAVN           RS User Changed
     C                     Z-ADDWN0208    WOAADT           RS Date Changed
     C                     Z-ADDWN0209    WOAMTM           RS Time Changed
     C                     MOVELWN0210    WOAJST           RS Record Statu
     C                     MOVELWN0211    WOAHVN           RS Job
     C                     MOVELWN0212    WOAGVN           RS Program
     C                     MOVELWN0213    WOABVN           RS User Added
     C                     Z-ADDWN0214    WOABDT           RS Date Added
     C                     Z-ADDWN0215    WOABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WOAJST           RS Record Statu
     C                     MOVEL##USR     WOABVN           RS User Added
     C                     Z-ADD##JDT     WOABDT           RS Date Added
     C                     Z-ADD##JTM     WOABTM           RS Time Added
     C                     MOVEL##PGM     WOAGVN           RS Program
     C                     MOVEL##JOB     WOAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOC2NB           TD Sequence Num
      * Check for duplicate primary key
     C           KLCRSO    SETLL@DYCPXW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0734' W0RTN   7
      * Send message 'Tattoo Detail Ext      EX'
     C                     MOVEL'PRK0734' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@DYCPXW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Head Condemned    CH - Tattoo Detail Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0216  1        Completed Statu
     C                     Z-ADD*ZERO     WN0217  50       Hot Head
     C                     Z-ADD*ZERO     WN0218  50       Head 2
     C                     MOVEL*BLANK    WN0219  1        Status 1
     C                     MOVEL*BLANK    WN0220  1        Status 2
     C                     MOVEL*BLANK    WN0221 10        RS User Changed
     C                     Z-ADD*ZERO     WN0222  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0223  60       RS Time Changed
     C                     MOVEL*BLANK    WN0224  1        RS Record Statu
     C                     MOVEL*BLANK    WN0225 10        RS Job
     C                     MOVEL*BLANK    WN0226 10        RS Program
     C                     MOVEL*BLANK    WN0227 10        RS User Added
     C                     Z-ADD*ZERO     WN0228  70       RS Date Added
     C                     Z-ADD*ZERO     WN0229  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWMHMNB    WOHMNB           BOH Company Num
     C                     Z-ADDWMBNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDWMBONB    WOBONB           BOL Load Number
     C                     Z-ADDWMCVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDWMB0DT    WOB0DT           TH Kill Date
     C                     Z-ADDWMC2NB    WOC2NB           TD Sequence Num
      *
     C           KLCHSP    KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
     C                     KFLD           WOC2NB           TD Sequence Num
     C           KLCHSP    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YDRDCS
      * Move non-key fields to @DYCPXW
     C                     Z-ADDWKFDNB    WOLFNB           TDE Head Condem
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Bal/Val Eval Trans    RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       and Balancing with Producer's History Avera
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0013           TH Head Killed
     C                     Z-ADD*ZERO     YL0014           TH Head Adds
     C                     Z-ADD*ZERO     YL0015           TH Head Accepte
     C                     Z-ADD*ZERO     YL0016           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0017           TH Tot Loin Eye
     C                     Z-ADD*ZERO     YL0018           TH Tot Backfat
     C                     Z-ADD*ZERO     YL0019           TH Tot Light Re
     C                     MOVEL*BLANK    YL0002           TH Header Error
     C                     MOVEL*BLANK    YL0003           TH Detail Error
     C                     MOVEL*BLANK    YL0004           TH Kill Balanci
     C                     Z-ADD*ZERO     YL0020           TH Head Exclude
     C                     Z-ADD*ZERO     YL0021           TH Head Identif
     C                     Z-ADD*ZERO     YL0022           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0023           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     YL0024           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     YL0025           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     YL0026           Hot Wgt/LghtR A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSQ02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSQ03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSQ04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSQ05           TH Kill Date
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
     C                     KFLD           WQSQ03           BOL Load Number
     C                     KFLD           WQSQ04           TH Tattoo Numbe
     C                     KFLD           WQSQ05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSQ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSQ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSQ03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSQ04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSQ05           TH Kill Date
      * Establish starting position
     C           KRSSQ     SETLL@BVCPQ9                    *
     C           KRSSQ     READE@BVCPQ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Net Head Usr is *Zeros
     C           YL0011    IFEQ *ZERO                      *IF
      * Net head is zeros if there are no transaction then this is ok
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'K'       YL0002           TH Header Error
     C                     MOVEL'E'       YL0004           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SRCRRC
     C                     END                             *FI
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * TH Head Identified.
      * CASE: DB1.ET Record Add/Del Sts is Uploaded Records
     C           WCEHST    IFEQ *BLANK                     *IF
     C           WCEHST    OREQ 'D'
     C                     ADD  1         YL0021           TH Head Identif
     C                     END                             *FI
      * CASE: DB1.RS Record Status is Active
     C           WCAJST    IFEQ 'A'                        *IF
      * Initialize
      * CASE: LCL.#Sequence Block is NULL
     C           YL0027    IFEQ *BLANK                     *IF
     C                     MOVEL'B'       YL0028           ET Error Sts
     C                     Z-ADDWCAKPC    YL0029           ET Lean Percent
     C                     Z-ADDWCFXPC    YL0030           ET Lean Percent
     C                     Z-ADDWCX8NB    YL0031           ET Backfat Thic
     C                     Z-ADDWCFVPC    YL0032           ET Loineye Dept
     C                     Z-ADDWCFWPC    YL0033           ET Light Reflec
     C                     MOVELWCAJST    YL0034           RS Record Statu
     C                     MOVEL*BLANK    YL0035           ET Adjust/Add T
     C                     MOVEL*BLANK    YL0036           ET Adjust/Add S
     C                     END                             *FI
      * Process Carcass
      * CASE: No FOM Reading
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.ET Backfat Thickness MM is Zero
      *   |- c2    : DB1.ET Loineye Depth MM is zero
      *   |- c3    : DB1.ET Light Reflectance MM is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCX8NB    IFEQ *ZERO                      *IF
     C           WCFVPC    IFEQ *ZERO                      *IF
     C           WCFWPC    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'LN%'     YL0035           ET Adjust/Add T
     C                     MOVEL'E'       YL0028           ET Error Sts
      * The reading cannot be replaced with averages because all of the
      * carcasses have not been processed.  (See Exit Program)
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate Lean % FOM
      * CASE: LCL.#Sequence Block is NULL
     C           YL0027    IFEQ *BLANK                     *IF
      * LEAN % FOM
     C                     MOVEL'N'       YL0037           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0011  31       CD Lean Percent
     C                     PARM WCAIPC    WQ0012  31       CD Backfat Thic
     C                     PARM WCAJPC    WQ0013  31       CD Loin-Eye Dep
     C                     PARM WCALPC    WQ0014  31       CD Light Reflec
     C           YL0031    PARM YL0031    WQ0015  31       CD Backfat Thic
     C           YL0032    PARM YL0032    WQ0016  31       CD Loin-Eye Dep
     C           YL0033    PARM YL0033    WQ0017  31       CD Light Reflec
     C           YL0030    PARM YL0030    WQ0018  31       CD Lean Percent
     C           YL0037    PARM YL0037    WQ0019  1        Calculate All U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UASUBR                     COMPUTE LEAN %
      * Validate Hot Weight
      * CASE: DB1.ET Hot Wgt LE PAR.Carcass Lgt Max
     C           WCAMPC    IFLE P2JANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR STCRRC
     C                     ELSE
      * CASE: DB1.ET Hot Wgt GE PAR.Carcass Dbw Min
     C           WCAMPC    IFGE P2I7NB                     *IF
      * Carcass Double Weight Error
     C                     MOVEL'CDB'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SVCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.ET Backfat Thickness Inch LE PAR.Backfat Low Max
     C           WCAIPC    IFLE P2K8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SXCRRC
     C                     ELSE
      * CASE: DB1.ET Backfat Thickness Inch GE PAR.BackFat High Min
     C           WCAIPC    IFGE P2K5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SZCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.ET Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           WCAJPC    IFLE P2LCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TBCRRC
     C                     ELSE
      * CASE: DB1.ET Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           WCAJPC    IFGE P2K9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TDCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: LCL.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           YL0029    IFLE P2JCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TFCRRC
     C                     ELSE
      * CASE: LCL.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           YL0029    IFGE P2JBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     YL0048           KV Error Code
     C                     MOVEL'E'       YL0028           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR THCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Process Balanced or Error
      * CASE: LCL.ET Error Sts is Balance
     C           YL0028    IFEQ 'B'                        *IF
     C                     ADD  1         YL0015           TH Head Accepte
      * Accumulate Totals
     C                     EXSR UBSUBR                     Accumulate Tota
     C                     ELSE
      * CASE: LCL.ET Error Sts is Error
     C           YL0028    IFEQ 'E'                        *IF
     C                     MOVEL'D'       YL0034           RS Record Statu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg Eval Transac      CH - Eval Trans  * 
     C                     EXSR TJCHRC
     C                     END                             *FI
     C           KRSSQ     READE@BVCPQ9                  90*
     C                     ENDDO
      * USER: Exit processing
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       add Producer to the parms
      * Bal Eval Trans wo/FOM RT - Eval Trans  * 
     C                     EXSR TKRVGN
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HNE'     WBDXST           KV Error Code
     C                     MOVEL@CN,02    WBB7TX           KV Error Descri
     C                     MOVE *BLANK    WBAAVN           RS User Changed
     C                     MOVEL'*BLANKS' WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,02    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSR    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSR    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HNE'     WRBVCD           EV Validation C
      * Establish starting position
     C           KRSSS     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SURVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRST    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRST    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSSU     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSV    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSV    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSSW     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSX    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSX    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSSY     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TARVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSZ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTA     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTB    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTB    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTC     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TERVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTD    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTD    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTE     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTF    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTF    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTG     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWCHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWCA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWCFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWCBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWCBONB    WBLDNM           KV Load Number
     C                     Z-ADDWCFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0048    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWCAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWCAADT    WBAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WBAMTM           RS Time Changed
     C                     MOVELWCAJST    WBAJST           RS Record Statu
     C                     MOVELWCAHVN    WBAHVN           RS Job
     C                     MOVELWCAGVN    WBAGVN           RS Program
     C                     MOVELWCABVN    WBABVN           RS User Added
     C                     Z-ADDWCABDT    WBABDT           RS Date Added
     C                     Z-ADDWCABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TIRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTH    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTH    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0048    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTI     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * Chg Eval Transac      CH - Eval Trans  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0230  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0231  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0232  3        ET Unused Sts 5
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHTJ    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YERDCS
      * Move non-key fields to @BVCPF0
     C                     Z-ADDWCFINB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDWCLKNB    WDLKNB           ET Lot
     C                     MOVELWCEAST    WDEAST    P      ET Shift
     C                     Z-ADDWCAMPC    WDAMPC           ET Hot Wgt
     C                     Z-ADDWCAIPC    WDAIPC           ET Backfat Thic
     C                     Z-ADDWCAJPC    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDYL0029    WDAKPC           ET Lean Percent
     C                     Z-ADDYL0031    WDX8NB           ET Backfat Thic
     C                     Z-ADDYL0032    WDFVPC           ET Loineye Dept
     C                     Z-ADDYL0033    WDFWPC           ET Light Reflec
     C                     Z-ADDYL0030    WDFXPC           ET Lean Percent
     C                     Z-ADDWCALPC    WDALPC           ET Light Reflec
     C                     MOVELWCDIST    WDDIST    P      ET Trim Area
     C                     MOVELWCFYST    WDFYST    P      ET Carcass Sex
     C                     MOVELYL0028    WDD2ST    P      ET Error Sts
     C                     MOVELWCEHST    WDEHST    P      ET Record Add/D
     C                     MOVELWCG1ST    WDG1ST    P      ET Record Creat
     C                     MOVELWCH4ST    WDH4ST    P      ET Record Creat
     C                     MOVELWCJLST    WDJLST    P      ET User Error O
     C                     MOVELYL0035    WDUUST    P      ET Adjust/Add T
     C                     MOVELWCVHST    WDVHST    P      ET Broken Back
     C                     MOVELYL0036    WDVJST    P      ET Adjust/Add S
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELYL0034    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
     C                     Z-ADDWCB8DT    WDB8DT           RU Date
     C                     Z-ADDWCAOTM    WDAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Bal Eval Trans wo/FOM RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       Add the New Sts ET adjust/add source
      *                       ET adjust/add source = blanks is the initia
      *                       ET adjust/add source = L is Lots Avg
      *                       ET adjust/add source = H is History Avg
      * Flag - To allow us to know if this process went through
      *        the change processing
     C                     MOVEL'N'       YL0050           Process Flag Us
      * Average Backfat, Loin Eye, Light Ref, & Lean % of Balanced Carcas
      * CASE: PAR.TH Hot Wgt NE LCL.Zero USR
     C           YL0016    IFNE YL0051                     *IF
      * Weighted average
      * 05/27/04 SLM HPEBAL   ET adjust/add source = L is Lots Avg
     C                     MOVEL*BLANK    YL0052           ET Adjust/Add S
     C                     MOVEL'L'       YL0052           ET Adjust/Add S
      * 02/06/02 PKD Change all of the calculations with *Rounded.
     C           YL0023    DIV  YL0016    YL0053    H      TH Avg Lean Per
     C           YL0024    DIV  YL0016    YL0054    H      TH Avg Backfat
     C           YL0025    DIV  YL0016    YL0055    H      TH Avg Loin Eye
     C           YL0026    DIV  YL0016    YL0056    H      TH Avg Light Re
     C                     ELSE
      * CASE: *OTHERWISE
      * 05/27/04 SLM HPEBAL   ET adjust/add source = *NONE set to blank
     C                     MOVEL*BLANK    YL0052           ET Adjust/Add S
     C                     Z-ADD*ZERO     YL0053           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0054           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0055           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0056           TH Avg Light Re
      * 05/27/04 SLM HPEBAL - RTV Producer History, if found then used
      *                       the Producer History, else the LCL
      *                       fields have been init.
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR TLRVGN
      * CASE: LCL.History Avail STS USR is Yes
     C           YL0066    IFEQ 'Y'                        *IF
      * 05/27/04 SLM HPEBAL - History Avail STS USR = Yes Hst was sel.
      *                       ET adjust/add source = H is History Avg
     C                     MOVEL*BLANK    YL0052           ET Adjust/Add S
     C                     MOVEL'H'       YL0052           ET Adjust/Add S
     C                     Z-ADDYL0060    YL0053           TH Avg Lean Per
     C                     Z-ADDYL0061    YL0054           TH Avg Backfat
     C                     Z-ADDYL0062    YL0055           TH Avg Loin Eye
     C                     Z-ADDYL0063    YL0056           TH Avg Light Re
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSHMNB    WQTK01           BOH Company Num
     C           *LIKE     DEFN WSBNNB    WQTK02           BOH Buy Order N
     C           *LIKE     DEFN WSBONB    WQTK03           BOL Load Number
     C           *LIKE     DEFN WSCVNB    WQTK04           TH Tattoo Numbe
     C           *LIKE     DEFN WSB0DT    WQTK05           TH Kill Date
     C           *LIKE     DEFN WSUUST    WQTK06           ET Adjust/Add T
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           BOH Company Num
     C                     KFLD           WQTK02           BOH Buy Order N
     C                     KFLD           WQTK03           BOL Load Number
     C                     KFLD           WQTK04           TH Tattoo Numbe
     C                     KFLD           WQTK05           TH Kill Date
     C                     KFLD           WQTK06           ET Adjust/Add T
      * Setup key
     C                     Z-ADDP1HMNB    WQTK01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTK02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTK03           BOL Load Number
     C                     Z-ADDP1CVNB    WQTK04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTK05           TH Kill Date
     C                     MOVEL'LN%'     WQTK06           ET Adjust/Add T
      * Establish starting position
     C           KRSTK     SETLL@BVCPEC                    *
     C           KRSTK     READE@BVCPEC                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDYL0054    YL0069           ET Backfat Thic
     C                     Z-ADDYL0055    YL0070           ET Loin-Eye Dep
     C                     Z-ADDYL0056    YL0071           ET Light Reflec
     C                     Z-ADDYL0053    YL0072           ET Lean Percent
     C                     MOVEL'B'       YL0073           ET Error Sts
     C                     MOVELWSAJST    YL0074           RS Record Statu
      * Validate Hot Weight
      * CASE: DB1.ET Hot Wgt LE PAR.Carcass Lgt Max
     C           WSAMPC    IFLE P2JANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     YL0075           KV Error Code
     C                     MOVEL'E'       YL0073           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TMCRRC
     C                     ELSE
      * CASE: DB1.ET Hot Wgt GE PAR.Carcass Dbw Min
     C           WSAMPC    IFGE P2I7NB                     *IF
      * Carcass Double Weight Error
     C                     MOVEL'CDB'     YL0075           KV Error Code
     C                     MOVEL'E'       YL0073           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TOCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: LCL.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           YL0072    IFLE P2JCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     YL0075           KV Error Code
     C                     MOVEL'E'       YL0073           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TQCRRC
     C                     ELSE
      * CASE: LCL.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           YL0072    IFGE P2JBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     YL0075           KV Error Code
     C                     MOVEL'E'       YL0073           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TSCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Process Balanced or Error
      * CASE: LCL.ET Error Sts is Balance
     C           YL0073    IFEQ 'B'                        *IF
     C                     ADD  1         YL0015           TH Head Accepte
     C                     ADD  1         YL0022           TH Head Adjuste
      * Accumulate Totals
     C                     EXSR UCSUBR                     Accumulate Tota
      * Dlt Tto Eval Rec Err  RT - Eval/Loss Error  * 
     C                     EXSR TURVGN
     C                     MOVEL'Y'       YL0050           Process Flag Us
     C                     ELSE
      * CASE: LCL.ET Error Sts is Error
     C           YL0073    IFEQ 'E'                        *IF
     C                     MOVEL'D'       YL0074           RS Record Statu
     C                     END                             *FI
     C                     END                             *FI
      * Chg Eval Transac      CH - Eval Trans  * 
     C                     EXSR TWCHRC
     C           KRSTK     READE@BVCPEC                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Process Flag User is Yes
     C           YL0050    IFEQ 'Y'                        *IF
      * 05/27/04 SLM HPEBAL - Changes to the No Fat-O-Meater calculations
      *                       Write a message to the Tattoo Hdr Comments
      *                       If Lots Avg, or Producer Hst was used.
      *                       ** All new
      * CASE: LCL.ET Adjust/Add Source is LOT - Lot Average
     C           YL0052    IFEQ 'L'                        *IF
      * Setup message data for message
      * Retrieve message Pay Note:LN% Used Lot Av
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1112' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0077    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0078    WL0006           THC Comment Lin
     C                     MOVELYL0077    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVELWSAHVN    WL0013    P      RS Job
     C                     MOVELWSAGVN    WL0014    P      RS Program
     C                     MOVELWSABVN    WL0015    P      RS User Added
     C                     Z-ADDWSABDT    WL0016           RS Date Added
     C                     Z-ADDWSABTM    WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0078           THC Comment Lin
     C                     ELSE
      * CASE: LCL.ET Adjust/Add Source is HST - History Average
     C           YL0052    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     MOVELYL0057    ZA0001           PH Summary Type
      * Retrieve message Pay Note: Use Prd's HstAV
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1113' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0077    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1HMNB    WL0001           BOH Company Num
     C                     Z-ADDP1BNNB    WL0002           BOH Buy Order N
     C                     Z-ADDP1BONB    WL0003           BOL Load Number
     C                     Z-ADDP1CVNB    WL0004           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WL0005           TH Kill Date
     C                     Z-ADDYL0078    WL0006           THC Comment Lin
     C                     MOVELYL0077    WL0007    P      THC Comment
     C                     MOVEL'P'       WL0008    P      THC Comment Typ
     C                     MOVEL*BLANK    WL0009           RS User Changed
     C                     Z-ADD*ZERO     WL0010           RS Date Changed
     C                     Z-ADD*ZERO     WL0011           RS Time Changed
     C                     MOVEL'A'       WL0012    P      RS Record Statu
     C                     MOVELWSAHVN    WL0013    P      RS Job
     C                     MOVELWSAGVN    WL0014    P      RS Program
     C                     MOVELWSABVN    WL0015    P      RS User Added
     C                     Z-ADDWSABDT    WL0016           RS Date Added
     C                     Z-ADDWSABTM    WL0017           RS Time Added
     C                     EXSR TXINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0078           THC Comment Lin
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0057           PH Summary Type
     C                     Z-ADD*ZERO     YL0058           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0059           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0060           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0061           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0062           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0063           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0064           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0065           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0066           History Avail S
     C                     MOVEL'N'       YL0066           History Avail S
     C                     MOVEL'Y'       YL0067           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTABCD    WQTL01           PD Producer Cod
      * Define keylist
     C           KPSTL     KLIST
     C                     KFLD           WQTL01           PD Producer Cod
     C                     KFLD           WTDZDT           PH Week Ending
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQTL01           PD Producer Cod
     C                     Z-ADDP1B0DT    WTDZDT           PH Week Ending
      * Establish starting position
     C           KPSTL     SETLL@CGCPEJ                    *
     C           KRSTL     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C                     Z-ADDWTDZDT    YL0068           PH Week Ending
     C                     MOVEL'N'       YL0067           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WTDZDT    IFNE YL0068                     *IF
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WTUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WTOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0057           PH Summary Type
     C                     Z-ADDWTORMB    YL0058           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0059           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0060           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0061           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0062           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0063           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0064           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0065           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0066           History Avail S
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WTUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WTOWUI    IFGT *ZERO                      *IF
      * PAR = DB1 By name
     C                     MOVELWTUVST    YL0057           PH Summary Type
     C                     Z-ADDWTORMB    YL0058           PH GA Avg Live
     C                     Z-ADDWTG9PC    YL0059           PH GA Adjusted
     C                     Z-ADDWTHBPC    YL0060           PH GA Avg Lean%
     C                     Z-ADDWTUWOE    YL0061           PH GA Avg Backf
     C                     Z-ADDWTHEPC    YL0062           PH GA Avg Loin
     C                     Z-ADDWTHGPC    YL0063           PH GA Avg Light
     C                     Z-ADDWTTIPR    YL0064           PH GA Lean Prm
     C                     Z-ADDWTB8A1    YL0065           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0066           History Avail S
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTL     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0075    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TNRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTM    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTM    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0075    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTN     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0075    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TPRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTO    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTO    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0075    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTP     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0075    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTQ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0075    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTR     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWSHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWSA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWSFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWSBONB    WBLDNM           KV Load Number
     C                     Z-ADDWSFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELYL0075    WBDXST           KV Error Code
     C                     MOVEL*BLANK    WBB7TX           KV Error Descri
     C                     MOVELWSAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWSAADT    WBAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WBAMTM           RS Time Changed
     C                     MOVELWSAJST    WBAJST           RS Record Statu
     C                     MOVELWSAHVN    WBAHVN           RS Job
     C                     MOVELWSAGVN    WBAGVN           RS Program
     C                     MOVELWSABVN    WBABVN           RS User Added
     C                     Z-ADDWSABDT    WBABDT           RS Date Added
     C                     Z-ADDWSABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           *BLANK    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TTRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTS    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTS    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WRBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0075    WRBVCD           EV Validation C
      * Establish starting position
     C           KRSTT     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWRCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Dlt Tto Eval Rec Err  RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVHRNB    WQTU01           KV Company Numb
     C           *LIKE     DEFN WVBPDT    WQTU02           KV Kill Date
     C           *LIKE     DEFN WVIRNB    WQTU03           KV TATTOO NUMBE
     C           *LIKE     DEFN WVBONM    WQTU04           KV Buy Order Nu
     C           *LIKE     DEFN WVLDNM    WQTU05           KV Load Number
     C           *LIKE     DEFN WVFPNB    WQTU06           KV Record Numbe
     C           *LIKE     DEFN WVDYST    WQTU07           KV Record Type
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           KV Company Numb
     C                     KFLD           WQTU02           KV Kill Date
     C                     KFLD           WQTU03           KV TATTOO NUMBE
     C                     KFLD           WQTU04           KV Buy Order Nu
     C                     KFLD           WQTU05           KV Load Number
     C                     KFLD           WQTU06           KV Record Numbe
     C                     KFLD           WQTU07           KV Record Type
      * Setup key
     C                     Z-ADDWSHSNB    WQTU01           KV Company Numb
     C                     Z-ADDWSA9DT    WQTU02           KV Kill Date
     C                     Z-ADDWSFINB    WQTU03           KV TATTOO NUMBE
     C                     Z-ADDWSBNNB    WQTU04           KV Buy Order Nu
     C                     Z-ADDWSBONB    WQTU05           KV Load Number
     C                     Z-ADDWSFJNB    WQTU06           KV Record Numbe
     C                     MOVEL'E'       WQTU07           KV Record Type
      * Establish starting position
     C           KRSTU     SETLL@B6CPLW                    *
     C           KRSTU     READE@B6CPLW                  90*
      * Data record not found
     C   90                MOVEL'PRK0150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Kill Validation - Eval/Loss Error  * 
     C                     EXSR TVDLRC
     C           KRSTU     READE@B6CPLW                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVDLRC    BEGSR
      *================================================================
      * Delete Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPGW
     C                     Z-ADDWVHRNB    WBHRNB           KV Company Numb
     C                     Z-ADDWVBPDT    WBBPDT           KV Kill Date
     C                     Z-ADDWVIRNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWVBONM    WBBONM           KV Buy Order Nu
     C                     Z-ADDWVLDNM    WBLDNM           KV Load Number
     C                     Z-ADDWVFPNB    WBFPNB           KV Record Numbe
     C                     MOVELWVDYST    WBDYST           KV Record Type
     C                     MOVELWVDXST    WBDXST           KV Error Code
      *
     C           KLDLTV    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
     C           KLDLTV    CHAIN@B6CPGW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB6CPL0'MDACP
     C                     MOVEL'@B6CPGW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPGW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * Chg Eval Transac      CH - Eval Trans  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0233  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0234  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0235  3        ET Unused Sts 5
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWSHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWSA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWSFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWSHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWSGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLCHTW    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLCHTW    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YFRDCS
      * Move non-key fields to @BVCPF0
     C                     Z-ADDWSFINB    WDFINB           ET Tattoo Numbe
     C                     Z-ADDWSLKNB    WDLKNB           ET Lot
     C                     MOVELWSEAST    WDEAST    P      ET Shift
     C                     Z-ADDWSAMPC    WDAMPC           ET Hot Wgt
     C                     Z-ADDYL0069    WDAIPC           ET Backfat Thic
     C                     Z-ADDYL0070    WDAJPC           ET Loin-Eye Dep
     C                     Z-ADDYL0072    WDAKPC           ET Lean Percent
     C                     Z-ADDWSX8NB    WDX8NB           ET Backfat Thic
     C                     Z-ADDWSFVPC    WDFVPC           ET Loineye Dept
     C                     Z-ADDWSFWPC    WDFWPC           ET Light Reflec
     C                     Z-ADDWSFXPC    WDFXPC           ET Lean Percent
     C                     Z-ADDYL0071    WDALPC           ET Light Reflec
     C                     MOVELWSDIST    WDDIST    P      ET Trim Area
     C                     MOVELWSFYST    WDFYST    P      ET Carcass Sex
     C                     MOVELYL0073    WDD2ST    P      ET Error Sts
     C                     MOVELWSEHST    WDEHST    P      ET Record Add/D
     C                     MOVELWSG1ST    WDG1ST    P      ET Record Creat
     C                     MOVELWSH4ST    WDH4ST    P      ET Record Creat
     C                     MOVELWSJLST    WDJLST    P      ET User Error O
     C                     MOVELWSUUST    WDUUST    P      ET Adjust/Add T
     C                     MOVELWSVHST    WDVHST    P      ET Broken Back
     C                     MOVELYL0052    WDVJST    P      ET Adjust/Add S
     C                     Z-ADDWSHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWSBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWSBONB    WDBONB           BOL Load Number
     C                     Z-ADDWSCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWSB0DT    WDB0DT           TH Kill Date
     C                     MOVELWSAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWSAADT    WDAADT           RS Date Changed
     C                     Z-ADDWSAMTM    WDAMTM           RS Time Changed
     C                     MOVELYL0074    WDAJST    P      RS Record Statu
     C                     MOVELWSAHVN    WDAHVN    P      RS Job
     C                     MOVELWSAGVN    WDAGVN    P      RS Program
     C                     MOVELWSABVN    WDABVN    P      RS User Added
     C                     Z-ADDWSABDT    WDABDT           RS Date Added
     C                     Z-ADDWSABTM    WDABTM           RS Time Added
     C                     Z-ADDWSB8DT    WDB8DT           RU Date
     C                     Z-ADDWSAOTM    WDAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXINFN    BEGSR
      *================================================================
      * Crt Tattoo Hdr Cmnt   IF - Tattoo Header Comment  * 
      *================================================================
      * Crt Tattoo Hdr Cmnt   IF
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WL0005' defaulted for 'TH Kill Date'.
      * Rtv Next Line Nbr     RT - Tattoo Header Comment  * 
     C                     EXSR TYRVGN
      * Crt Tattoo Hdr Cmnt   CR - Tattoo Header Comment  * 
     C                     EXSR TZCRRC
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv Next Line Nbr     RT - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWHMNB    WQTY01           BOH Company Num
     C           *LIKE     DEFN WWBNNB    WQTY02           BOH Buy Order N
     C           *LIKE     DEFN WWBONB    WQTY03           BOL Load Number
     C           *LIKE     DEFN WWCVNB    WQTY04           TH Tattoo Numbe
     C           *LIKE     DEFN WWB0DT    WQTY05           TH Kill Date
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WQTY01           BOH Company Num
     C                     KFLD           WQTY02           BOH Buy Order N
     C                     KFLD           WQTY03           BOL Load Number
     C                     KFLD           WQTY04           TH Tattoo Numbe
     C                     KFLD           WQTY05           TH Kill Date
      * Setup key
     C                     Z-ADDWL0001    WQTY01           BOH Company Num
     C                     Z-ADDWL0002    WQTY02           BOH Buy Order N
     C                     Z-ADDWL0003    WQTY03           BOL Load Number
     C                     Z-ADDWL0004    WQTY04           TH Tattoo Numbe
     C                     Z-ADDWL0005    WQTY05           TH Kill Date
      * Establish starting position
     C           KRSTY     SETLL@A4CPL3                    *
     C           KRSTY     READE@A4CPL3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0067' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0006           THC Comment Lin
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WWBETX    ADD  1         WL0006           THC Comment Lin
     C                     GOTO TYEXIT                     *QUIT
     C           KRSTY     READE@A4CPL3                  90*
     C                     ENDDO
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCRRC    BEGSR
      *================================================================
      * Crt Tattoo Hdr Cmnt   CR - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A4CPC3
     C                     Z-ADDWL0001    WFHMNB           BOH Company Num
     C                     Z-ADDWL0002    WFBNNB           BOH Buy Order N
     C                     Z-ADDWL0003    WFBONB           BOL Load Number
     C                     Z-ADDWL0004    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWL0005    WFB0DT           TH Kill Date
     C                     Z-ADDWL0006    WFBETX           THC Comment Lin
     C                     MOVELWL0007    WFBFTX           THC Comment
     C                     MOVELWL0008    WFETST           THC Comment Typ
     C                     MOVELWL0009    WFAAVN           RS User Changed
     C                     Z-ADDWL0010    WFAADT           RS Date Changed
     C                     Z-ADDWL0011    WFAMTM           RS Time Changed
     C                     MOVELWL0012    WFAJST           RS Record Statu
     C                     MOVELWL0013    WFAHVN           RS Job
     C                     MOVELWL0014    WFAGVN           RS Program
     C                     MOVELWL0015    WFABVN           RS User Added
     C                     Z-ADDWL0016    WFABDT           RS Date Added
     C                     Z-ADDWL0017    WFABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WFAJST           RS Record Statu
     C                     MOVEL##USR     WFABVN           RS User Added
     C                     Z-ADD##JDT     WFABDT           RS Date Added
     C                     Z-ADD##JTM     WFABTM           RS Time Added
     C                     MOVEL##PGM     WFAGVN           RS Program
     C                     MOVEL##JOB     WFAHVN           RS Job
     C           KLCRTZ    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBETX           THC Comment Lin
      * Check for duplicate primary key
     C           KLCRTZ    SETLL@A4CPC3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0068' W0RTN   7
      * Send message 'Tattoo Header Comment  EX'
     C                     MOVEL'PRK0068' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C                     WRITE@A4CPC3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     YL0038           Lean % Fld 1 Us
     C           1         MULT 0.469     YL0039           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 YL0040           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 YL0041           Lean % Fld 4 Us
      * CASE: DB1.ET Hot Wgt NE WRK.Zero USR
     C           WCAMPC    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * LCL.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : LCL.Lean % Fld 1 Usr
      * +     : LCL.Lean @ Ext 4 Usr
      * x2    : LCL.Lean % Fld 2 Usr
      * *     : LCL.Lean @ Ext 1 Usr *
      * x5    : DB1.ET Hot Wgt
      * -     : LCL.Lean @ Ext 4 Usr
      * x3    : LCL.Lean % Fld 3 Usr
      * *     : LCL.Lean @ Ext 2 Usr *
      * x6    : DB1.ET Backfat Thickness MM
      * +     : LCL.Lean @ Ext 4 Usr
      * x4    : LCL.Lean % Fld 4 Usr
      * *     : LCL.Lean @ Ext 3 Usr *
      * x7    : DB1.ET Loineye Depth MM
      * /     : LCL.Lean % Fld 5 Usr *
      * x5    : DB1.ET Hot Wgt
      * *     : LCL.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           YL0039    MULT WCAMPC    YL0042           Lean @ Ext 1 Us
     C           YL0038    ADD  YL0042    YL0043           Lean @ Ext 4 Us
     C           YL0040    MULT WCX8NB    YL0044           Lean @ Ext 2 Us
     C                     SUB  YL0044    YL0043           Lean @ Ext 4 Us
     C           YL0041    MULT WCFVPC    YL0045           Lean @ Ext 3 Us
     C                     ADD  YL0045    YL0043           Lean @ Ext 4 Us
     C           YL0043    DIV  WCAMPC    YL0046           Lean % Fld 5 Us
     C           YL0046    MULT 100       YL0047           Lean @ Ext 5 Us
     C                     Z-ADDYL0047    YL0046           Lean % Fld 5 Us
     C                     END                             *FI
     C           YL0046    MULT 1         YL0029    H      ET Lean Percent
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  1         YL0013           TH Head Killed
     C                     ADD  WCAJPC    YL0017           TH Tot Loin Eye
     C                     ADD  WCAIPC    YL0018           TH Tot Backfat
     C                     ADD  WCALPC    YL0019           TH Tot Light Re
     C                     ADD  WCAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           YL0029    MULT WCAMPC    YL0049           Hot Wgt/Weight
     C                     ADD  YL0049    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0049           Hot Wgt/Weight
     C                     ADD  YL0049    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0049           Hot Wgt/Weight
     C                     ADD  YL0049    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0049           Hot Wgt/Weight
     C                     ADD  YL0049    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  1         YL0013           TH Head Killed
     C                     ADD  YL0070    YL0017           TH Tot Loin Eye
     C                     ADD  YL0069    YL0018           TH Tot Backfat
     C                     ADD  YL0071    YL0019           TH Tot Light Re
     C                     ADD  WSAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           YL0072    MULT WSAMPC    YL0076           Hot Wgt/Weight
     C                     ADD  YL0076    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           YL0069    MULT WSAMPC    YL0076           Hot Wgt/Weight
     C                     ADD  YL0076    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           YL0070    MULT WSAMPC    YL0076           Hot Wgt/Weight
     C                     ADD  YL0076    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           YL0071    MULT WSAMPC    YL0076           Hot Wgt/Weight
     C                     ADD  YL0076    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Calculate Tattoo Header Averages/yield
      *================================================================
      * Calculate Adj Live Weight
      * CASE: PAR.TH Head Received EQ LCL.Net Head Usr
     C           P1CWNB    IFEQ YL0011                     *IF
     C                     Z-ADDP1CYNB    YL0081           TH Adj Live Wgt
     C                     ELSE
      * CASE: LCL.Net Head Usr EQ LCL.Zero USR
     C           YL0011    IFEQ YL0082                     *IF
     C                     Z-ADD*ZERO     YL0081           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0012    MULT YL0084    YL0083           *Synon (15,2) w
     C           P1CYNB    SUB  YL0083    YL0081           TH Adj Live Wgt
     C                     END                             *FI
     C                     END                             *FI
      * Calculate Adj Actual Yield
     C                     EXSR UESUBR                     Calculate Adj A
      * Calculate Hot Weight
      * CASE: LCL.TH Head Killed NE LCL.Zero USR
     C           YL0013    IFNE YL0082                     *IF
      * Accumulated totals div by head killed
     C           YL0016    DIV  YL0013    YL0086    H      TH Avg Hot Wgt
     C                     Z-ADDYL0086    YL0087           TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0086           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0087           TH Avg Hot Wgt
     C                     END                             *FI
      * Weighted Averages
      * CASE: LCL.TH Hot Wgt NE LCL.Zero USR
     C           YL0016    IFNE YL0082                     *IF
      * Weighted average
     C           YL0023    DIV  YL0016    YL0088    H      TH Avg Lean Per
     C           YL0024    DIV  YL0016    YL0089    H      TH Avg Backfat
     C           YL0025    DIV  YL0016    YL0090    H      TH Avg Loin Eye
     C           YL0026    DIV  YL0016    YL0091    H      TH Avg Light Re
     C                     Z-ADDYL0088    YL0092           TH Avg Lean % E
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0088           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0089           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0090           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0091           TH Avg Light Re
     C                     Z-ADD*ZERO     YL0092           TH Avg Lean % E
     C                     END                             *FI
      * Actual Yield Percent
      * CASE: PAR.TH Live Wgt NE LCL.Zero USR
     C           P1CYNB    IFNE YL0082                     *IF
      * actual yield percent: hot w / live wgt * 100
      * TH Actual Yield Percent
      * LCL.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  P1CYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0093           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0093           TH Actual Yield
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Calculate Adj Actual Yield
      *================================================================
      * CASE: LCL.TH Adj Live Wgt NE LCL.Zero USR
     C           YL0081    IFNE YL0082                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  YL0081    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0085           TH Adj Actual Y
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0013           TH Head Killed
     C                     SUB  WCAJPC    YL0017           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0018           TH Tot Backfat
     C                     SUB  WCALPC    YL0019           TH Tot Light Re
     C                     SUB  WCAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0121    YL0013           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0236    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0016    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0238    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0017    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0237    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0018    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0244    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0239    MULT WN0236    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0237    MULT WN0236    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0238    MULT WN0236    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0244    MULT WN0236    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0013           TH Head Killed
     C                     SUB  WCAJPC    YL0017           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0018           TH Tot Backfat
     C                     SUB  WCALPC    YL0019           TH Tot Light Re
     C                     SUB  WCAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0121    YL0013           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0291    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0016    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0293    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0017    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0292    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0018    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0299    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0294    MULT WN0291    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0292    MULT WN0291    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0293    MULT WN0291    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0299    MULT WN0291    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0013           TH Head Killed
     C                     SUB  WCAJPC    YL0017           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0018           TH Tot Backfat
     C                     SUB  WCALPC    YL0019           TH Tot Light Re
     C                     SUB  WCAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0121    YL0013           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0346    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0016    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0348    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0017    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0347    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0018    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0354    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0349    MULT WN0346    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0347    MULT WN0346    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0348    MULT WN0346    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0354    MULT WN0346    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0013           TH Head Killed
     C                     SUB  WCAJPC    YL0017           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0018           TH Tot Backfat
     C                     SUB  WCALPC    YL0019           TH Tot Light Re
     C                     SUB  WCAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0121    YL0013           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0401    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0016    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0403    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0017    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0402    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0018    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0409    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0404    MULT WN0401    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0402    MULT WN0401    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0403    MULT WN0401    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0409    MULT WN0401    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0013           TH Head Killed
     C                     SUB  WCAJPC    YL0017           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0018           TH Tot Backfat
     C                     SUB  WCALPC    YL0019           TH Tot Light Re
     C                     SUB  WCAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0121    YL0013           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0456    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0016    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0458    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0017    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0457    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0018    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0464    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0459    MULT WN0456    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0457    MULT WN0456    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0458    MULT WN0456    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0464    MULT WN0456    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0128    YL0013           TH Head Killed
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0513    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0017    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0512    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0018    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0519    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0511    MULT YL0128    W0WA01           *Synon (15,2) w
     C           YL0016    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0514    MULT WN0511    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0133           Hot Wgt/Weight
     C                     ADD  YL0133    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0512    MULT WN0511    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0133           Hot Wgt/Weight
     C                     ADD  YL0133    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0513    MULT WN0511    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0133           Hot Wgt/Weight
     C                     ADD  YL0133    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0519    MULT WN0511    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0128    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0133           Hot Wgt/Weight
     C                     ADD  YL0133    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
      * Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Loin Eye Depth
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0090    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0017    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Backfat
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0089    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0018    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Light Reflectance
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0091    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0019    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Avg Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0087    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0016    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           YL0087    MULT YL0092    YL0137           Hot Wgt/Weight
      * Hot Wgt/Lean % Accum Usr
      * PAR.Hot Wgt/Lean % Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/Lean % Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0137    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0023    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           YL0087    MULT YL0089    YL0137           Hot Wgt/Weight
      * Hot Wgt/Backf Accum Usr
      * PAR.Hot Wgt/Backf Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/Backf Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0137    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0024    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           YL0087    MULT YL0090    YL0137           Hot Wgt/Weight
      * Hot Wgt/Loine Accum Usr
      * PAR.Hot Wgt/Loine Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/Loine Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0137    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0025    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           YL0087    MULT YL0091    YL0137           Hot Wgt/Weight
      * Hot Wgt/LghtR Accum Usr
      * PAR.Hot Wgt/LghtR Accum Usr =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Hot Wgt/LghtR Accum Usr
      * -     : PGM.*Synon (15,2) work field
      * x2    : LCL.Hot Wgt/Weight Ext Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Carcass Count USR
     C           YL0137    MULT YL0135    W0WA01           *Synon (15,2) w
     C           YL0026    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Re-Calculate Tattoo Header Averages/yield
      *================================================================
      * Calculate Adj Actual Yield
     C                     EXSR USSUBR                     Calculate Adj A
      * Calculate Hot Weight
      * CASE: LCL.TH Head Killed NE LCL.Zero USR
     C           YL0013    IFNE YL0082                     *IF
      * Accumulated totals div by head killed
     C           YL0016    DIV  YL0013    YL0086    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0086           TH Avg Hot Wgt
     C                     END                             *FI
      * Weighted Averages
      * CASE: LCL.TH Hot Wgt NE LCL.Zero USR
     C           YL0016    IFNE YL0082                     *IF
      * Weighted average
     C           YL0023    DIV  YL0016    YL0088    H      TH Avg Lean Per
     C           YL0024    DIV  YL0016    YL0089    H      TH Avg Backfat
     C           YL0025    DIV  YL0016    YL0090    H      TH Avg Loin Eye
     C           YL0026    DIV  YL0016    YL0091    H      TH Avg Light Re
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0088           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0089           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0090           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0091           TH Avg Light Re
     C                     END                             *FI
      * Actual Yield Percent
      * CASE: PAR.TH Live Wgt NE LCL.Zero USR
     C           P1CYNB    IFNE YL0082                     *IF
      * actual yield percent: hot w / live wgt * 100
      * TH Actual Yield Percent
      * LCL.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  P1CYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0093           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0093           TH Actual Yield
     C                     END                             *FI
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Calculate Adj Actual Yield
      *================================================================
      * CASE: LCL.TH Adj Live Wgt NE LCL.Zero USR
     C           YL0081    IFNE YL0082                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  YL0081    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0085           TH Adj Actual Y
     C                     Z-ADDYL0085    YL0138           TH Yld Parm Adj
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Subtract from Totals
      *================================================================
      * Accumulate totals
     C                     SUB  1         YL0013           TH Head Killed
     C                     SUB  WCAJPC    YL0017           TH Tot Loin Eye
     C                     SUB  WCAIPC    YL0018           TH Tot Backfat
     C                     SUB  WCALPC    YL0019           TH Tot Light Re
     C                     SUB  WCAMPC    YL0016           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WCAKPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WCAIPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WCAJPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WCALPC    MULT WCAMPC    YL0120           Hot Wgt/Weight
     C                     SUB  YL0120    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  YL0121    YL0013           TH Head Killed
      * TH Hot Wgt
      * PAR.TH Hot Wgt =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0606    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0016    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0016           TH Hot Wgt
      * TH Tot Loin Eye Depth
      * PAR.TH Tot Loin Eye Depth =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Loin Eye Depth
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0608    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0017    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           TH Tot Loin Eye
      * TH Tot Backfat Inches
      * PAR.TH Tot Backfat Inches =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Backfat Inches
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0607    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0018    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           TH Tot Backfat
      * TH Tot Light Reflectance
      * PAR.TH Tot Light Reflectance =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.TH Tot Light Reflectance
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0614    MULT YL0121    W0WA01           *Synon (15,2) w
     C           YL0019    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0019           TH Tot Light Re
      * Weighted accumulated Lean%
      * Lean Percent
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Lean Percent NPPC
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0609    MULT WN0606    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0023           Hot Wgt/Lean %
      * Weighted accumulated Backfat
      * Backfat Thickness Inch
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Backfat Thickness Inch
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0607    MULT WN0606    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0024           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
      * Loin-Eye Depth Inches
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Loin-Eye Depth Inches
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0608    MULT WN0606    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0025           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
      * Light Reflectances
      * LCL.Hot Wgt/Weight Ext Usr =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : PAR.ET Light Reflectance
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.ET Hot Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x3    : LCL.Carcass Count USR
     C           WN0614    MULT WN0606    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT YL0121    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0125           Hot Wgt/Weight
     C                     ADD  YL0125    YL0026           Hot Wgt/LghtR A
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Re-Calculate Tattoo Header Averages/yield
      *================================================================
      * Calculate Adj Actual Yield
     C                     EXSR UWSUBR                     Calculate Adj A
      * Calculate Hot Weight
      * CASE: LCL.TH Head Killed NE LCL.Zero USR
     C           YL0013    IFNE YL0082                     *IF
      * Accumulated totals div by head killed
     C           YL0016    DIV  YL0013    YL0086    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0086           TH Avg Hot Wgt
     C                     END                             *FI
      * Weighted Averages
      * CASE: LCL.TH Hot Wgt NE LCL.Zero USR
     C           YL0016    IFNE YL0082                     *IF
      * Weighted average
     C           YL0023    DIV  YL0016    YL0088    H      TH Avg Lean Per
     C           YL0024    DIV  YL0016    YL0089    H      TH Avg Backfat
     C           YL0025    DIV  YL0016    YL0090    H      TH Avg Loin Eye
     C           YL0026    DIV  YL0016    YL0091    H      TH Avg Light Re
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0088           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0089           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0090           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0091           TH Avg Light Re
     C                     END                             *FI
      * Actual Yield Percent
      * CASE: PAR.TH Live Wgt NE LCL.Zero USR
     C           P1CYNB    IFNE YL0082                     *IF
      * actual yield percent: hot w / live wgt * 100
      * TH Actual Yield Percent
      * LCL.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  P1CYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0093           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0093           TH Actual Yield
     C                     END                             *FI
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Calculate Adj Actual Yield
      *================================================================
      * CASE: LCL.TH Adj Live Wgt NE LCL.Zero USR
     C           YL0081    IFNE YL0082                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * LCL.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0016    DIV  YL0081    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0085           TH Adj Actual Y
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1D7ST           TH Header Error
     C                     MOVEL*BLANK    P1D8ST           TH Detail Error
     C                     MOVEL*BLANK    P1DWST           TH Kill Balanci
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHRNB           KV Company Numb
     C                     Z-ADD*ZERO     WABPDT           KV Kill Date
     C                     Z-ADD*ZERO     WAIRNB           KV TATTOO NUMBE
     C                     Z-ADD*ZERO     WABONM           KV Buy Order Nu
     C                     Z-ADD*ZERO     WALDNM           KV Load Number
     C                     Z-ADD*ZERO     WAFPNB           KV Record Numbe
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WCA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WCFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WCHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WCLKNB           ET Lot
     C                     Z-ADD*ZERO     WCAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WCAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WCAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WCAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WCFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WCFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
     C                     Z-ADD*ZERO     WCB8DT           RU Date
     C                     Z-ADD*ZERO     WCAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEBETX           THC Comment Lin
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHUNB           LTN Company Num
     C                     Z-ADD*ZERO     WGA7DT           LTN Kill Date
     C                     Z-ADD*ZERO     WGFHNB           LTN Record Numb
     C                     Z-ADD*ZERO     WGFFNB           LTN Tattoo Numb
     C                     Z-ADD*ZERO     WGDSNB           LTN Wgt
     C                     Z-ADD*ZERO     WGBWCD           LT Type Code
     C                     Z-ADD*ZERO     WGBYCD           LR Reason Code
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
     C                     Z-ADD*ZERO     WGB8DT           RU Date
     C                     Z-ADD*ZERO     WGAOTM           RU Time
      * Define work field LTN Wgt
     C                     Z-ADD*ZERO     WUDSNB  71
      * Define work field LTN Error Sts
     C                     MOVEL*BLANK    WUD1ST  1
      * Define work field Loss Error 1 Usr
     C                     MOVEL*BLANK    WUH9ST  1
      * Define work field Loss Error 2 Usr
     C                     MOVEL*BLANK    WUIAST  1
      * Define work field Loss Error 3 Usr
     C                     MOVEL*BLANK    WUIBST  1
      * Define work field Loss Error 4 Usr
     C                     MOVEL*BLANK    WUICST  1
      * Define work field Loss Error 5 Usr
     C                     MOVEL*BLANK    WULRST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WIBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WIBONB           BOL Load Number
     C                     Z-ADD*ZERO     WICVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WIB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WIAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WIACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WIB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WICAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WIAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WIA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WICXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WICWNB           TH Head Receive
     C                     Z-ADD*ZERO     WIFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WIH9NB           TH Held Over
     C                     Z-ADD*ZERO     WIFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WIFENB           TH Head Killed
     C                     Z-ADD*ZERO     WIHENB           TH Head Adds
     C                     Z-ADD*ZERO     WIHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WICYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WILRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WIE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WIA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WIFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WIA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WIF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WIHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WIF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WIF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WIF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WIF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WIAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WIAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WICWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WIA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WIA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WIB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WIAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WIANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WIAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WIAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WIAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WIAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WIAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WIASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WIA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WIATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WIA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WICBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WICCPR           Th Payment Net
     C                     Z-ADD*ZERO     WILPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WICDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WIA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WIA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WIGHNB           TH Commission A
     C                     Z-ADD*ZERO     WIBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WIBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WIBTDT           TH Commission P
     C                     Z-ADD*ZERO     WIBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WIHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WIHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WIHINB           TH FFLI
     C                     Z-ADD*ZERO     WIA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WIA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WIA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WIJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WID6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WID7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WID8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WID9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WIEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WIEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WIECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WIEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WIEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WIEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WIEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WIEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WIOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WITHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WIT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WITHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WIT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WIOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WIKOER           TH Head Identif
     C                     Z-ADD*ZERO     WIOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WIOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WIIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WIOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WIHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WIS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WITAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WITBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WIJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WIKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WIKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WIKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WIKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WIOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WIIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WIIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WIIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WIKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WIOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WIKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WIORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WIOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WIMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WIMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WINCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WINCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WIIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WIKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WIEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WIEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WIECDT           TH Unused Date
     C                     Z-ADD*ZERO     WIEDDT           TH Unused Date
     C                     Z-ADD*ZERO     WIEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLBONB           BOL Load Number
     C                     Z-ADD*ZERO     WLCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WLB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WLC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WLCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WLC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WLD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WLH7NB           TD Held Over
     C                     Z-ADD*ZERO     WLAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WLJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WLB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WLD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WLBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WLBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WLBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WLHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WLH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WMBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WMBONB           BOL Load Number
     C                     Z-ADD*ZERO     WMCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WMB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WMC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WMLENB           Hot Head
     C                     Z-ADD*ZERO     WMLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WMLINB           Head 2
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAFPC           EV Minimum
     C                     Z-ADD*ZERO     WRAGPC           EV Maximum
     C                     Z-ADD*ZERO     WRAADT           RS Date Changed
     C                     Z-ADD*ZERO     WRAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WRABDT           RS Date Added
     C                     Z-ADD*ZERO     WRABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTDZDT           PH Week Ending
     C                     Z-ADD*ZERO     WTOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     WTALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     WTKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     WTKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     WTJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     WTOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     WTIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     WTJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     WTUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     WTO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     WTJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     WTG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     WTHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     WTORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     WTHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     WTHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WTS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     WTTCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     WTS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WTTDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WTS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WTTEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WTS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     WTTFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     WTB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     WTJKOS           PH GA DOA
     C                     Z-ADD*ZERO     WTALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     WTKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     WTJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     WTOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     WTIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     WTORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     WTJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     WTPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     WTG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     WTIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     WTG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     WTHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     WTUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     WTHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     WTHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     WTS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     WTTGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     WTS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WTTHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WTS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WTTIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WTS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     WTTJPR           PH GA Gross /Ca
     C                     Z-ADD*ZERO     WTB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Head Accepted
     C                     Z-ADD*ZERO     WUHFNB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH Head Identified
     C                     Z-ADD*ZERO     WUKOER  50
      * Define work field Hot Wgt/Lean % Accum Usr
     C                     Z-ADD*ZERO     WUJONB  91
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field Net Head Adjusted Usr
     C                     Z-ADD*ZERO     WUZANB  50
      * Define work field EV Minimum
     C                     Z-ADD*ZERO     WUAFPC  71
      * Define work field EV Maximum
     C                     Z-ADD*ZERO     WUAGPC  71
      * Define work field ET Trim Area
     C                     MOVEL*BLANK    WUDIST  1
      * Define work field ET Carcass Sex
     C                     MOVEL*BLANK    WUFYST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine TXINFN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  50
     C                     Z-ADD*ZERO     WL0003  50
     C                     Z-ADD*ZERO     WL0004  50
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007 60
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009 10
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013 10
     C                     MOVEL*BLANK    WL0014 10
     C                     MOVEL*BLANK    WL0015 10
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  60
      * Define local work field #Sequence Block
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field TH Header Error Sts
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field TH Detail Error Sts
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0005  6
      * Define local work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Auto Balance HldOvr USR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Hold Over Bal Sts USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0010  50
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field Net Head Adjusted Usr
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field TH Head Accepted
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0016  71
      * Define local work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YL0017  61
      * Define local work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YL0018  61
      * Define local work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YL0019  61
      * Define local work field TH Head Excluded
     C                     Z-ADD*ZERO     YL0020  50
      * Define local work field TH Head Identified
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field TH Head Adjusted-LN%
     C                     Z-ADD*ZERO     YL0022  50
      * Define local work field Hot Wgt/Lean % Accum Usr
     C                     Z-ADD*ZERO     YL0023  91
      * Define local work field Hot Wgt/Backf Accum Usr
     C                     Z-ADD*ZERO     YL0024  91
      * Define local work field Hot Wgt/Loine Accum Usr
     C                     Z-ADD*ZERO     YL0025  91
      * Define local work field Hot Wgt/LghtR Accum Usr
     C                     Z-ADD*ZERO     YL0026  91
      * Define local work field #Sequence Block
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field ET Error Sts
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     YL0029  31
      * Define local work field ET Lean Percent FOM
     C                     Z-ADD*ZERO     YL0030  31
      * Define local work field ET Backfat Thickness MM
     C                     Z-ADD*ZERO     YL0031  31
      * Define local work field ET Loineye Depth MM
     C                     Z-ADD*ZERO     YL0032  31
      * Define local work field ET Light Reflectance MM
     C                     Z-ADD*ZERO     YL0033  31
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field ET Adjust/Add Type
     C                     MOVEL*BLANK    YL0035  3
      * Define local work field ET Adjust/Add Source
     C                     MOVEL*BLANK    YL0036  2
      * Define local work field Calculate All Usr
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Lean % Fld 1 Usr
     C                     Z-ADD*ZERO     YL0038 177
      * Define local work field Lean % Fld 2 Usr
     C                     Z-ADD*ZERO     YL0039 177
      * Define local work field Lean % Fld 3 Usr
     C                     Z-ADD*ZERO     YL0040 177
      * Define local work field Lean % Fld 4 Usr
     C                     Z-ADD*ZERO     YL0041 177
      * Define local work field Lean @ Ext 1 Usr
     C                     Z-ADD*ZERO     YL0042 177
      * Define local work field Lean @ Ext 4 Usr
     C                     Z-ADD*ZERO     YL0043 177
      * Define local work field Lean @ Ext 2 Usr
     C                     Z-ADD*ZERO     YL0044 177
      * Define local work field Lean @ Ext 3 Usr
     C                     Z-ADD*ZERO     YL0045 177
      * Define local work field Lean % Fld 5 Usr
     C                     Z-ADD*ZERO     YL0046 177
      * Define local work field Lean @ Ext 5 Usr
     C                     Z-ADD*ZERO     YL0047 177
      * Define local work field KV Error Code
     C                     MOVEL*BLANK    YL0048  3
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0049  91
      * Define local work field Process Flag User
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field Zero USR
     C                     Z-ADD*ZERO     YL0051  10
      * Define local work field ET Adjust/Add Source
     C                     MOVEL*BLANK    YL0052  2
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0053  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0054  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0055  31
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0056  31
      * Define local work field PH Summary Type
     C                     MOVEL*BLANK    YL0057  3
      * Define local work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YL0058  51
      * Define local work field PH GA Adjusted Yield%
     C                     Z-ADD*ZERO     YL0059  52
      * Define local work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0060  31
      * Define local work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YL0061  31
      * Define local work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YL0062  31
      * Define local work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YL0063  31
      * Define local work field PH GA Lean Prm /Carc CWT
     C                     Z-ADD*ZERO     YL0064  52
      * Define local work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YL0065  53
      * Define local work field History Avail STS USR
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field PH Week Ending Date
     C                     Z-ADD*ZERO     YL0068  70
      * Define local work field ET Backfat Thickness Inch
     C                     Z-ADD*ZERO     YL0069  31
      * Define local work field ET Loin-Eye Depth Inches
     C                     Z-ADD*ZERO     YL0070  31
      * Define local work field ET Light Reflectance
     C                     Z-ADD*ZERO     YL0071  31
      * Define local work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     YL0072  31
      * Define local work field ET Error Sts
     C                     MOVEL*BLANK    YL0073  1
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0074  1
      * Define local work field KV Error Code
     C                     MOVEL*BLANK    YL0075  3
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0076  91
      * Define local work field THC Comment
     C                     MOVEL*BLANK    YL0077 60
      * Define local work field THC Comment Line
     C                     Z-ADD*ZERO     YL0078  30
      * Define local work field TH Percent Identified
     C                     Z-ADD*ZERO     YL0079  52
      * Define local work field TH Percent Accepted
     C                     Z-ADD*ZERO     YL0080  52
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0081  71
      * Define local work field Zero USR
     C                     Z-ADD*ZERO     YL0082  10
      * Define local work field *Synon (15,2) work field
     C                     Z-ADD*ZERO     YL0083 152
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0084  51
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0085  52
      * Define local work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0086  51
      * Define local work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YL0087  71
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0088  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0089  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0090  31
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0091  31
      * Define local work field TH Avg Lean % EXC/ADD
     C                     Z-ADD*ZERO     YL0092  71
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0093  52
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0094  70
      * Define local work field Day of Week USR
     C                     Z-ADD*ZERO     YL0095  10
      * Define local work field Held Over Days USR
     C                     Z-ADD*ZERO     YL0096  50
      * Define local work field TH PHA Add Type
     C                     MOVEL*BLANK    YL0097  1
      * Define local work field TH PHA Add Reason
     C                     MOVEL*BLANK    YL0098  1
      * Define local work field THC Comment
     C                     MOVEL*BLANK    YL0099 60
      * Define local work field THC Comment Line
     C                     Z-ADD*ZERO     YL0100  30
      * Define local work field PH Summary Type
     C                     MOVEL*BLANK    YL0101  3
      * Define local work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YL0102  51
      * Define local work field TH PHA Yield Percent
     C                     Z-ADD*ZERO     YL0103  52
      * Define local work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0104  31
      * Define local work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YL0105  31
      * Define local work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YL0106  31
      * Define local work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YL0107  31
      * Define local work field TH PHA Lean Prm /Crc CWT
     C                     Z-ADD*ZERO     YL0108  52
      * Define local work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YL0109  53
      * Define local work field History Avail STS USR
     C                     MOVEL*BLANK    YL0110  1
      * Define local work field TH PHA Average Type
     C                     MOVEL*BLANK    YL0111  3
      * Define local work field TH PHA Sort Disc Fctr %
     C                     Z-ADD*ZERO     YL0112  52
      * Define local work field TH PHA Head Adds
     C                     Z-ADD*ZERO     YL0113  50
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0114  51
      * Define local work field THC Comment
     C                     MOVEL*BLANK    YL0115 60
      * Define local work field THC Comment Line
     C                     Z-ADD*ZERO     YL0116  30
      * Define local work field *Synon (15,1) work field
     C                     Z-ADD*ZERO     YL0117 151
      * Define local work field EV Minimum
     C                     Z-ADD*ZERO     YL0118  71
      * Define local work field EV Maximum
     C                     Z-ADD*ZERO     YL0119  71
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0120  91
      * Define local work field Carcass Count USR
     C                     Z-ADD*ZERO     YL0121  30
      * Define local work field Calculate All Usr
     C                     MOVEL*BLANK    YL0122  1
      * Define local work field ET Scale Sequence Number
     C                     Z-ADD*ZERO     YL0123  60
      * Define local work field ET Adjust/Add Source
     C                     MOVEL*BLANK    YL0124  2
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0125  91
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0126  1
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0127  1
      * Define local work field Carcass Count USR
     C                     Z-ADD*ZERO     YL0128  30
      * Define local work field EV Minimum
     C                     Z-ADD*ZERO     YL0129  71
      * Define local work field EV Maximum
     C                     Z-ADD*ZERO     YL0130  71
      * Define local work field Calculate All Usr
     C                     MOVEL*BLANK    YL0131  1
      * Define local work field ET Scale Sequence Number
     C                     Z-ADD*ZERO     YL0132  60
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0133  91
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0134  1
      * Define local work field Carcass Count USR
     C                     Z-ADD*ZERO     YL0135  30
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0136  30
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0137  91
      * Define local work field TH Yld Parm Adj Yield%
     C                     Z-ADD*ZERO     YL0138  52
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0139  72
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 BALHLDOVR
00002 Header No Evaluation Recs
00003 Hot Wgt for Adds Invalid
00004 Producer Hist Not Avail
00005 % Identified > 105%
00006 % Analyzed < 75%
00007 Yield Parameter Error
00008 Held Over Not Balanced
