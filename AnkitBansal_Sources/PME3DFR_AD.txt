// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PME3DFR
// ?Date: 14.08.2025 Time: 03:44:53
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR *****
//?***** Change Log and Comments
DO;

//?R15115 RMC 08/23/19 - Chg OPBGWKN3 TO HAVE KEY 3 OF REQ SHIP DATE INSTEAD
//? OF SCHEDULED SHIP DATE. CHANGE SCREEN & change places using sched to
//?  use REQ -- that werent already using REQ
//?** 08/03/17 DN  T10731 - Inventory Visibility Enhancement-Intake Req 29
//?- Undo OPBGWKN3 access path SELECT criteria.
//?** 06/06/17 DN  T10731 - Inventory Visibility Enhancement-Intake Req 29
//?- Recompile due to OPBGWKN3 access path was changed to Select
//?  Detail Line Status=R (Confirmed). No logic change.
//?** 05/19/16 RMC E4119 remove live with tpm check
EXECUTE FUNCTION(FP1309 Inventory Age  IF) TYPE(EXCINTFUN)                      AC1981251;
{
 //?Execute internal function

 //?FP1309 Inventory Age Code Description
}


//?age on the screen and remove the clc pa age date routine
//?allow user to change the age by selection funtion 7
//?*****
//?** 09/30/2009 LJB E00495 Use Carr appt dt/tm, if entered, to recalc DDD/T
//?**   in option 90 (IS function, only)
//?** 01/20/2009 SLM FP1054 Pass Production Whse to WW Production
//?** 01/20/2009 RMC FP1054 use production whse for righthand box of data.
//?  For Sched as Ord option: chk user profile field before allowing
//?Remove from screen: 16=Ship Off Cut  AND  18=Sched As Ord
//?Added to screen:   19=Deallocate
//?Added to subfile: If ord dtl sch rcd doesnt exist, sched ship date=YLW;
//?        production numbers are now output for all. they cant chg any more.
//?        Chg Age Code to be cond on Output Only 3 usr. Sales can chg here
//?        And create load order change log rcd AGECDE
//?        If Release ord:  Crt load order change log rlsord
//?        If Dealloc ord:  Crt load order change log dlcord
//?        If Realloc ord:  Crt load order change log rlcord
//?Chg 14=Release to 14=Release Ln item option-- user can release line items
//? which will let them ship short.  the reallc process wont try to re-sched
//?** 11/19/2008 RMC S00562 allow PORKSCHE2 to update
//?** 10/29/2008 RMC FP1054 display oe date/time and sales route in fold
//?** 11/19/2007 LJB FP1251 The DDD/T routine resets the DDD/T fields to
//?** zeros if there is no Miles To Next Stop or Miles Between Cities
//?** record
//?** F90 & F91 are for IS personnel only (Not PORKSCHE)
//?*****
//?** Just a note - The PFS Load Header for Carlisle gets the export
//?** info from OHE not the Load Header
//?*****
//?** 09/01/2006 LJB L60831A  Pass Co# & Whse code from the CTL
//?** record to the Product Availability program
//?05/12/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
//?                                    from Logical View
ENDDO;

// LCL.First Time Flag = CND.Yes
LCL.First_Time_Flag = 'Y';

EXECUTE FUNCTION(VAL Set Inter. Access  IF) TYPE(EXCINTFUN)                     AC1144606;
PARAMETER('OMS');
PARAMETER(LCL.Company_Number);
PARAMETER(LCL.Warehouse_Code);
PARAMETER(PAR.Allow_Multi_Company);
PARAMETER(PAR.Default_Printer);
PARAMETER(PAR.Salesperson_Code);
{
 //?Execute internal function

 // PAR.User Profile Name = JOB.*USER
 PAR.User_Profile_Name = JOB.*USER;

 EXECUTE FUNCTION(VAL User/Application   IF) TYPE(EXCINTFUN)                     AC1144188;
 PARAMETER(PAR.User_Profile_Name);
 PARAMETER(PAR.Application_Code);
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Warehouse_Code);
 PARAMETER(PAR.Allow_Multi_Company);
 PARAMETER(PAR.Default_Printer);
 PARAMETER(PAR.Salesperson_Code);
 {
  //?Execute internal function

  //?RMC 5/11/09 Rtv default company from user profile --
  //?  Override user code model company if it exists
  EXECUTE FUNCTION(RTV Program Setup w/Co RT) TYPE(RTVOBJ) FILE(CADRREP)          AC1935572;
  PARAMETER(PAR.User_Profile_Name);
  PARAMETER(PAR.Allow_Multi_Company);
  PARAMETER(PAR.Default_Printer);
  PARAMETER(PAR.Salesperson_Code);
  PARAMETER(LCL.Company_Number);
  PARAMETER(PAR.User_Code_Model);
  {
   //?USER: Processing if Data record not found

   // PGM.*Return code = CND.*Record does not exist
   PGM.*Return_code = 'Y2U0005';

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?User Profile Record Not found
  CASE;

  // IF PGM.*Return code is *Record does not exist
  IF PGM.*Return_code = 'Y2U0005';

  // Execute function SET Message Queue Dest US.
  EXECUTE FUNCTION(SET Message Queue Dest US) TYPE(EXCUSRSRC) ('USNCUFR');
  {
   C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
  }

  // Send completion message - 'Application access denied for user &1 in application area &2'
  MESSAGE(USR0810 *COMPLETION);
  MSGPARM(PAR.User_Profile_Name);
  MSGPARM(PAR.Application_Code);

  PGM.*Return_code = 'Y2U9999';

  RETURN;

  ENDIF;

  CASE;

  // IF PAR.User Code Model is equal to blank
  IF PAR.User_Code_Model = *BLANK;

  EXECUTE FUNCTION(RTV Appl. Profile      RT) TYPE(RTVOBJ) FILE(CADTREP)          AC1143177;
  PARAMETER(PAR.User_Profile_Name);
  PARAMETER(PAR.Application_Code);
  PARAMETER(PAR.Company_Number);
  PARAMETER(LCL.Warehouse_Code);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  // IF *OTHERWISE
  IF *OTHERWISE;

  EXECUTE FUNCTION(RTV Appl. Profile      RT) TYPE(RTVOBJ) FILE(CADTREP)          AC1143177;
  PARAMETER(PAR.User_Code_Model);
  PARAMETER(PAR.Application_Code);
  PARAMETER(PAR.Company_Number);
  PARAMETER(LCL.Warehouse_Code);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  ENDIF;

  // PAR.Warehouse Code = LCL.Warehouse Code
  PAR.Warehouse_Code = LCL.Warehouse_Code;

  //?Return code when not normal for Application Profile
  CASE;

  // IF PGM.*Return code is *Normal
  IF PGM.*Return_code = *BLANK;

  //?Return code when not normal for Application Profile
  // IF *OTHERWISE
  IF *OTHERWISE;

  // Execute function SET Message Queue Dest US.
  EXECUTE FUNCTION(SET Message Queue Dest US) TYPE(EXCUSRSRC) ('USNCUFR');
  {
   C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
  }

  // Send completion message - 'Application access denied for user &1 in application area &2'
  MESSAGE(USR0810 *COMPLETION);
  MSGPARM(PAR.User_Profile_Name);
  MSGPARM(PAR.Application_Code);

  PGM.*Return_code = 'Y2U9999';

  RETURN;

  ENDIF;

  //?Override company with User profile control's company if found
  CASE;

  // IF LCL.Company Number is not equal to zero
  IF LCL.Company_Number <> *ZERO;

  // PAR.Company Number = LCL.Company Number
  PAR.Company_Number = LCL.Company_Number;

  //?Get prod warehouse, if the appl got a warehouse
  CASE;

  // IF LCL.Warehouse Code is Not Blanks
  IF LCL.Warehouse_Code <> *BLANK;

  // Call program RTV Prod Whse for Co  XF.
  CALL PROGRAM(RTV Prod Whse for Co  XF) ('PNKDXFR');
  PARAMETER(PAR.Warehouse_Code);
  PARAMETER(LCL.Company_Number);

  ENDIF;

  ENDIF;

 }

 EXECUTE FUNCTION(SET Screen Headings    IF) TYPE(EXCINTFUN)                     AC1248058;
 PARAMETER(PAR.Application_Code);
 {
  //?Execute internal function

  EXECUTE FUNCTION(RTV Applic. Group Desc RT) TYPE(RTVOBJ) FILE(CADNREP)          AC1274118;
  PARAMETER(PAR.Application_Code);
  PARAMETER(WRK.Description);
  {
   //?USER: Process Data record

   CASE;

   // IF DB1.Application Group is Blank
   IF DB1.Application_Group = *BLANK;

   MOVE *ALL (To: PAR From: DB1);

   // IF *OTHERWISE
   IF *OTHERWISE;

   EXECUTE FUNCTION(RTV Application Desc   RT) TYPE(RTVOBJ) FILE(CADNREP)          AC1249881;
   PARAMETER(DB1.Application_Group);
   PARAMETER(PAR.Description);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    // PGM.*Return code = CND.*Record does not exist
    PGM.*Return_code = 'Y2U0005';

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   ENDIF;

  }

  // WRK.USR Description 40 = WRK.Description
  WRK.USR_Description_40 = WRK.Description;

  // Execute function CLC Center Txt Str 40  US.
  EXECUTE FUNCTION(CLC Center Txt Str 40  US) TYPE(EXCUSRSRC) ('PDYJUFR');
  PARAMETER(WRK.USR_Description_40);
  PARAMETER(WRK.USR_Description_40_2);
  {
   E                    UCT        40  1               CENTER TABLE
   C                     MOVEA#IDSC4    UCT              LOAD ARRAY
   C                     Z-ADD40        UX      20       SET COUNTER
   C           UX        DOWGT0
   C           UCT,UX    IFEQ ' '
   C                     SUB  1         UX
   C                     ELSE
   C                     Z-ADDUX        UXH     20
   C                     Z-ADD0         UX
   C                     END
   C                     END
   C           40        SUB  UXH       UX
   C           UX        DIV  2         UX
   C           UX        IFGT 0
   C                     MOVE *BLANKS   UCT
   C                     MOVEA#IDSC4    UCT,UX
   C                     END
   C                     MOVEAUCT       #ODE40           LOAD OUTPUT
  }

  // Execute function MOV Appl Desc-Co Head  US.
  EXECUTE FUNCTION(MOV Appl Desc-Co Head  US) TYPE(EXCUSRSRC) ('PDYKUFR');
  PARAMETER(WRK.USR_Description_40_2);
  {
   C                     MOVE #IDE40    ##CMP
  }

 }

}


EXECUTE FUNCTION(Rtv Profile Model     RT) TYPE(RTVOBJ) FILE(CADRREP)           AC1445577;
PARAMETER(JOB.*USER);
PARAMETER(LCL.User_Code_Model);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// PAR.Display Prt Opt Pmt USR = CND.*YES
PAR.Display_Prt_Opt_Pmt_USR = *YES;

// LCL.Item Code = CON.*ZERO
LCL.Item_Code = *ZERO;

// LCL.Production Date = JOB.*Job date
LCL.Production_Date = JOB.*Job_date;

// PGM.*Subfile mode = CND.Truncated
PGM.*Subfile_mode = 1;

//?USER: Initialize subfile control

//?FP1054
EXECUTE FUNCTION(Rtv Acct Co          RT) TYPE(RTVOBJ) FILE(CAADREP)            AC1802492;
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.Accounting_Company);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?Production Date
DO;

CASE;

// IF LCL.Production Date USR LT JOB.*Job date
IF LCL.Production_Date_USR < JOB.*Job_date;

// LCL.Production Date USR = JOB.*Job date
LCL.Production_Date_USR = JOB.*Job_date;

ENDIF;

EXECUTE FUNCTION(Rtv ProdDte-6         RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1648632;
PARAMETER(CTL.Accounting_Company);
PARAMETER(LCL.Production_Date_USR);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
{
 //?USER: Initialize routine

 // WRK.Count USR = CON.1
 WRK.Count_USR = 1;

 //?USER: Process Data record

 CASE;

 // IF WRK.Count USR is GT 6
 IF WRK.Count_USR > 6;

 QUIT;

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Production Day Status is yes
 IF DB1.Production_Day_Status = 'Y';

 //?Move Date & Day of Week
 CASE;

 // IF WRK.Count USR is One
 IF WRK.Count_USR = 1;

 // PAR.USR Day 1 = DB1.Post to G/L Date
 PAR.USR_Day_1 = DB1.Post_to_G_L_Date;

 //?Move Date & Day of Week
 // IF WRK.Count USR is Two
 IF WRK.Count_USR = 2;

 // PAR.USR Day 2 = DB1.Post to G/L Date
 PAR.USR_Day_2 = DB1.Post_to_G_L_Date;

 //?Move Date & Day of Week
 // IF WRK.Count USR is Three
 IF WRK.Count_USR = 3;

 // PAR.USR Day 3 = DB1.Post to G/L Date
 PAR.USR_Day_3 = DB1.Post_to_G_L_Date;

 //?Move Date & Day of Week
 // IF WRK.Count USR is Four
 IF WRK.Count_USR = 4;

 // PAR.USR Day 4 = DB1.Post to G/L Date
 PAR.USR_Day_4 = DB1.Post_to_G_L_Date;

 //?Move Date & Day of Week
 // IF WRK.Count USR is Five
 IF WRK.Count_USR = 5;

 // PAR.USR Day 5 = DB1.Post to G/L Date
 PAR.USR_Day_5 = DB1.Post_to_G_L_Date;

 //?Move Date & Day of Week
 // IF WRK.Count USR is Six
 IF WRK.Count_USR = 6;

 // PAR.USR Day 6 = DB1.Post to G/L Date
 PAR.USR_Day_6 = DB1.Post_to_G_L_Date;

 ENDIF;

 // WRK.Count USR = WRK.Count USR + CON.1
 WRK.Count_USR = WRK.Count_USR + 1;

 ENDIF;

 ENDIF;

}


ENDDO;

//?First Time
CASE;

// IF LCL.First Time Flag is Yes
IF LCL.First_Time_Flag = 'Y';

EXECUTE FUNCTION(Item Desc DRV) TYPE(DRVFLD)                                    AC1505592;
PARAMETER(CTL.Item_Desc_DRV);
PARAMETER(CTL.Consumed_Item_Code);
{
 //?Calculate derived field

 EXECUTE FUNCTION(Rtv Item Descriptions  RT) TYPE(RTVOBJ) FILE(OMBYREP)          AC1341279;
 PARAMETER(PAR.Item_Code);
 PARAMETER(PAR.Item_Desc_DRV);
 PARAMETER(WRK.Description_Line_Two);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


EXECUTE FUNCTION(Rtv Base Values PA    RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1416510;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(WRK.Description_Line_One);
PARAMETER(WRK.Description_Line_Two);
PARAMETER(WRK.UOM_Primary);
PARAMETER(WRK.Conversion_Factor_1);
PARAMETER(WRK.Operation_Factor_1);
PARAMETER(WRK.UOM_Second);
PARAMETER(WRK.Conversion_Factor_2);
PARAMETER(WRK.Operation_Factor_2);
PARAMETER(WRK.UOM_Third);
PARAMETER(WRK.UOM_Pricing);
PARAMETER(LCL.Unit_Weight);
PARAMETER(WRK.Production_Date_Control);
PARAMETER(WRK.Catch_Weight_Status);
PARAMETER(WRK.Fresh_Chilling_Time);
PARAMETER(WRK.Base_Conv_Loss_Item);
PARAMETER(LCL.Piece_Count_Item);
PARAMETER(LCL.Pieces_Per_Bag);
PARAMETER(LCL.Bags_Per_Unit);
PARAMETER(WRK.Record_Status);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// LCL.First Time Flag = CND.NO
LCL.First_Time_Flag = 'N';

//?* Used for F9=All/Converted
// LCL.Select 1 or 2 = CND.One
LCL.Select_1_or_2 = 1;

//?* Used for F10=All/Hold
// LCL.Hold Order = CND.no
LCL.Hold_Order = 'N';

// LCL.USR Display 1 = CND.Yes
LCL.USR_Display_1 = 'Y';

SET CURSOR;

ENDIF;

//?FP1054 Init to zero
// CTL.Qty Std Prod 1 USR = CON.*ZERO
CTL.Qty_Std_Prod_1_USR = *ZERO;

// CTL.Qty Std Prod 2 USR = CON.*ZERO
CTL.Qty_Std_Prod_2_USR = *ZERO;

// CTL.Qty Std Prod 3 USR = CON.*ZERO
CTL.Qty_Std_Prod_3_USR = *ZERO;

// CTL.Qty Std Prod 4 USR = CON.*ZERO
CTL.Qty_Std_Prod_4_USR = *ZERO;

// CTL.Qty Std Prod 5 USR = CON.*ZERO
CTL.Qty_Std_Prod_5_USR = *ZERO;

// CTL.Qty Std Prod 6 USR = CON.*ZERO
CTL.Qty_Std_Prod_6_USR = *ZERO;

//?FP1054 Rtv base avail from production warehouse
EXECUTE FUNCTION(Rtv Base Availability RT) TYPE(RTVOBJ) FILE(PDI8CPP)           AC1648124;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
PARAMETER(CTL.Qty_Sched_Prod_1_USR);
PARAMETER(CTL.Qty_Sched_Prod_2_USR);
PARAMETER(CTL.Qty_Sched_Prod_3_USR);
PARAMETER(CTL.Qty_Sched_Prod_4_USR);
PARAMETER(CTL.Qty_Sched_Prod_5_USR);
PARAMETER(CTL.Qty_Sched_Prod_6_USR);
PARAMETER(CTL.Qty_Converted_1_USR);
PARAMETER(CTL.Qty_Converted_2_USR);
PARAMETER(CTL.Qty_Converted_3_USR);
PARAMETER(CTL.Qty_Converted_4_USR);
PARAMETER(CTL.Qty_Converted_5_USR);
PARAMETER(CTL.Qty_Converted_6_USR);
PARAMETER(CTL.Qty_Sched_Ord_1_USR);
PARAMETER(CTL.Qty_Sched_Ord_2_USR);
PARAMETER(CTL.Qty_Sched_Ord_3_USR);
PARAMETER(CTL.Qty_Sched_Ord_4_USR);
PARAMETER(CTL.Qty_Sched_Ord_5_USR);
PARAMETER(CTL.Qty_Sched_Ord_6_USR);
PARAMETER(CTL.Quantity_Avail_USR_1);
PARAMETER(CTL.Quantity_Avail_USR_2);
PARAMETER(CTL.Quantity_Avail_USR_3);
PARAMETER(CTL.Quantity_Avail_USR_4);
PARAMETER(CTL.Quantity_Avail_USR_5);
PARAMETER(CTL.Quantity_Avail_USR_6);
PARAMETER(CTL.Qty_Std_Prod_1_USR);
PARAMETER(CTL.Qty_Std_Prod_2_USR);
PARAMETER(CTL.Qty_Std_Prod_3_USR);
PARAMETER(CTL.Qty_Std_Prod_4_USR);
PARAMETER(CTL.Qty_Std_Prod_5_USR);
PARAMETER(CTL.Qty_Std_Prod_6_USR);
PARAMETER(CTL.Day_1_Inventory_50_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_1_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_2_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_3_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_4_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_5_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_6_USR);
PARAMETER(LCL.Unit_Weight);
PARAMETER(LCL.Piece_Count_Item);
PARAMETER(LCL.Pieces_Per_Bag);
PARAMETER(LCL.Bags_Per_Unit);
{
 //?USER: Initialize routine

 CASE;

 // IF PAR.Unit Weight is Equal to zero
 IF PAR.Unit_Weight = *ZERO;

 EXECUTE FUNCTION(Rtv Base Values PA    RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1416510;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Code);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Unit_Weight);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Piece_Count_Item);
 PARAMETER(LCL.Pieces_Per_Bag);
 PARAMETER(LCL.Bags_Per_Unit);
 PARAMETER(WRK.BLANK);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Unit Weight = PAR.Unit Weight
 LCL.Unit_Weight = PAR.Unit_Weight;

 // LCL.Piece Count Item = PAR.Piece Count Item
 LCL.Piece_Count_Item = PAR.Piece_Count_Item;

 // LCL.Pieces Per Bag = PAR.Pieces Per Bag
 LCL.Pieces_Per_Bag = PAR.Pieces_Per_Bag;

 // LCL.Bags Per Unit = PAR.Bags Per Unit
 LCL.Bags_Per_Unit = PAR.Bags_Per_Unit;

 ENDIF;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?QUIT:  Production Date > Usr Day 6
 CASE;

 // IF DB1.Production Date GT PAR.USR Day 6
 IF DB1.Production_Date > PAR.USR_Day_6;

 QUIT;

 ENDIF;

 //?SEL:  Schedule for Job Date
 CASE;

 // IF DB1.Production Date EQ JOB.*Job date
 IF DB1.Production_Date = JOB.*Job_date;

 CASE;

 // IF DB1.Production Type is Plan
 IF DB1.Production_Type = 'P';

 // OR DB1.Production Type is Schedule Saved in the am
 OR DB1.Production_Type = 'X';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?Process Record
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 CASE;

 // IF LCL.Piece Count Item is yes
 IF LCL.Piece_Count_Item = 'Y';

 CASE;

 // IF PAR.Production Date EQ PAR.USR Day 1
 IF PAR.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Pieces_Inv_On_Hand + DB1.PS_Pieces_Inv_Adj )
 - DB1.PS_Pieces_Inv_Allocated ) / ( LCL.Pieces_Per_Bag * LCL.Bags_Per_Unit 'H' ) 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Pieces_Standard / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Planned:fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Pieces_Planned_Prod / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched whse txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Pieces_Whs_Tfr_Adj / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Pieces_Converted / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Pieces_Prod_Allocated / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 also add ps pieces planned prod
 // Quantity Production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Pieces_Standard + DB1.PS_Pieces_Prod_Adj )
 - DB1.PS_Pieces_Converted ) + DB1.PS_Pieces_Planned_Prod ) / ( LCL.Pieces_Per_Bag                 +
 * LCL.Bags_Per_Unit );

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Weight_Inv_On_Hand + DB1.PS_Weight_Inv_Adj )
 - DB1.PS_Weight_Inv_Allocated ) / LCL.Unit_Weight 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Weight_Standard / LCL.Unit_Weight;

 // Quantity Planned-fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Weight_Planned_Prod / LCL.Unit_Weight;

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched Whse Txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Weight_Whs_Tfr_Adj / LCL.Unit_Weight;

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Weight_Converted / LCL.Unit_Weight;

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Weight_Prod_Allocated / LCL.Unit_Weight;

 //?FP1054 also add ps weight planned prod
 // Quantity production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Weight_Standard + DB1.PS_Weight_Prod_Adj )
 - DB1.PS_Weight_Converted ) + DB1.PS_Weight_Planned_Prod ) / LCL.Unit_Weight;

 ENDIF;

 // Quantity Available
 LCL.Quantity_Avail_7_0_USR = ( ( LCL.Quantity_Standard_USR - LCL.Quantity_Converted_USR )
 - LCL.Qty_Ordered_USR ) - LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // PAR.Qty Sched Prod 1 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_1_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 1 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_1_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 1 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_1_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 1 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_1 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 1 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_1_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 1 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_1_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 2
 IF DB1.Production_Date = PAR.USR_Day_2;

 // PAR.Qty Sched Prod 2 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_2_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 2 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_2_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 2 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_2_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 2 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_2 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 2 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_2_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 2 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_2_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 3
 IF DB1.Production_Date = PAR.USR_Day_3;

 // PAR.Qty Sched Prod 3 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_3_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 3 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_3_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 3 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_3_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 3 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_3 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 3 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_3_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 3 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_3_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 4
 IF DB1.Production_Date = PAR.USR_Day_4;

 // PAR.Qty Sched Prod 4 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_4_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 4 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_4_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 4 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_4_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 4 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_4 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 4 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_4_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 4 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_4_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 5
 IF DB1.Production_Date = PAR.USR_Day_5;

 // PAR.Qty Sched Prod 5 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_5_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 5 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_5_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 5 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_5_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 5 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_5 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 5 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_5_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 5 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_5_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 6
 IF DB1.Production_Date = PAR.USR_Day_6;

 // PAR.Qty Sched Prod 6 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_6_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 6 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_6_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 6 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_6_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 6 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_6 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 6 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_6_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 6 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_6_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 ENDIF;

 ENDIF;

}


CASE;

// IF CTL.Item Code is Entered
IF CTL.Item_Code <> *ZERO;

// AND CTL.Warehouse Code is Warehouse Code not Blank
AND CTL.Warehouse_Code <> *BLANK;

EXECUTE FUNCTION(Rtv Base Availability RT) TYPE(RTVOBJ) FILE(PDI8CPP)           AC1648124;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Item_Code);
PARAMETER(CTL.Warehouse_Code);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(CTL.Qty_Std_Prod_1_USR);
PARAMETER(CTL.Qty_Std_Prod_2_USR);
PARAMETER(CTL.Qty_Std_Prod_3_USR);
PARAMETER(CTL.Qty_Std_Prod_4_USR);
PARAMETER(CTL.Qty_Std_Prod_5_USR);
PARAMETER(CTL.Qty_Std_Prod_6_USR);
PARAMETER(CTL.Day_1_Inventory_50_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_1_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_2_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_3_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_4_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_5_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_6_USR);
PARAMETER(*ZERO);
PARAMETER(LCL.BLANK);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
{
 //?USER: Initialize routine

 CASE;

 // IF PAR.Unit Weight is Equal to zero
 IF PAR.Unit_Weight = *ZERO;

 EXECUTE FUNCTION(Rtv Base Values PA    RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1416510;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Code);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Unit_Weight);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Piece_Count_Item);
 PARAMETER(LCL.Pieces_Per_Bag);
 PARAMETER(LCL.Bags_Per_Unit);
 PARAMETER(WRK.BLANK);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Unit Weight = PAR.Unit Weight
 LCL.Unit_Weight = PAR.Unit_Weight;

 // LCL.Piece Count Item = PAR.Piece Count Item
 LCL.Piece_Count_Item = PAR.Piece_Count_Item;

 // LCL.Pieces Per Bag = PAR.Pieces Per Bag
 LCL.Pieces_Per_Bag = PAR.Pieces_Per_Bag;

 // LCL.Bags Per Unit = PAR.Bags Per Unit
 LCL.Bags_Per_Unit = PAR.Bags_Per_Unit;

 ENDIF;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?QUIT:  Production Date > Usr Day 6
 CASE;

 // IF DB1.Production Date GT PAR.USR Day 6
 IF DB1.Production_Date > PAR.USR_Day_6;

 QUIT;

 ENDIF;

 //?SEL:  Schedule for Job Date
 CASE;

 // IF DB1.Production Date EQ JOB.*Job date
 IF DB1.Production_Date = JOB.*Job_date;

 CASE;

 // IF DB1.Production Type is Plan
 IF DB1.Production_Type = 'P';

 // OR DB1.Production Type is Schedule Saved in the am
 OR DB1.Production_Type = 'X';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?Process Record
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 CASE;

 // IF LCL.Piece Count Item is yes
 IF LCL.Piece_Count_Item = 'Y';

 CASE;

 // IF PAR.Production Date EQ PAR.USR Day 1
 IF PAR.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Pieces_Inv_On_Hand + DB1.PS_Pieces_Inv_Adj )
 - DB1.PS_Pieces_Inv_Allocated ) / ( LCL.Pieces_Per_Bag * LCL.Bags_Per_Unit 'H' ) 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Pieces_Standard / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Planned:fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Pieces_Planned_Prod / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched whse txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Pieces_Whs_Tfr_Adj / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Pieces_Converted / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Pieces_Prod_Allocated / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 also add ps pieces planned prod
 // Quantity Production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Pieces_Standard + DB1.PS_Pieces_Prod_Adj )
 - DB1.PS_Pieces_Converted ) + DB1.PS_Pieces_Planned_Prod ) / ( LCL.Pieces_Per_Bag                 +
 * LCL.Bags_Per_Unit );

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Weight_Inv_On_Hand + DB1.PS_Weight_Inv_Adj )
 - DB1.PS_Weight_Inv_Allocated ) / LCL.Unit_Weight 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Weight_Standard / LCL.Unit_Weight;

 // Quantity Planned-fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Weight_Planned_Prod / LCL.Unit_Weight;

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched Whse Txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Weight_Whs_Tfr_Adj / LCL.Unit_Weight;

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Weight_Converted / LCL.Unit_Weight;

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Weight_Prod_Allocated / LCL.Unit_Weight;

 //?FP1054 also add ps weight planned prod
 // Quantity production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Weight_Standard + DB1.PS_Weight_Prod_Adj )
 - DB1.PS_Weight_Converted ) + DB1.PS_Weight_Planned_Prod ) / LCL.Unit_Weight;

 ENDIF;

 // Quantity Available
 LCL.Quantity_Avail_7_0_USR = ( ( LCL.Quantity_Standard_USR - LCL.Quantity_Converted_USR )
 - LCL.Qty_Ordered_USR ) - LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // PAR.Qty Sched Prod 1 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_1_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 1 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_1_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 1 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_1_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 1 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_1 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 1 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_1_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 1 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_1_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 2
 IF DB1.Production_Date = PAR.USR_Day_2;

 // PAR.Qty Sched Prod 2 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_2_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 2 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_2_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 2 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_2_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 2 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_2 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 2 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_2_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 2 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_2_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 3
 IF DB1.Production_Date = PAR.USR_Day_3;

 // PAR.Qty Sched Prod 3 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_3_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 3 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_3_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 3 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_3_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 3 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_3 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 3 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_3_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 3 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_3_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 4
 IF DB1.Production_Date = PAR.USR_Day_4;

 // PAR.Qty Sched Prod 4 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_4_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 4 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_4_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 4 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_4_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 4 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_4 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 4 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_4_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 4 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_4_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 5
 IF DB1.Production_Date = PAR.USR_Day_5;

 // PAR.Qty Sched Prod 5 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_5_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 5 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_5_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 5 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_5_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 5 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_5 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 5 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_5_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 5 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_5_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 6
 IF DB1.Production_Date = PAR.USR_Day_6;

 // PAR.Qty Sched Prod 6 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_6_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 6 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_6_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 6 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_6_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 6 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_6 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 6 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_6_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 6 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_6_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 ENDIF;

 ENDIF;

}


ENDIF;

//?Check if Adjustments exists for the Base Item
DO;

//?FP1054 use ctl.prod warehouse instead of  ctl.warehouse code
EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Display_1);
PARAMETER(CTL.Base_Adj_Sts_1_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Display_2);
PARAMETER(CTL.Base_Adj_Sts_2_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Display_3);
PARAMETER(CTL.Base_Adj_Sts_3_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Display_4);
PARAMETER(CTL.Base_Adj_Sts_4_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Display_5);
PARAMETER(CTL.Base_Adj_Sts_5_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_6);
PARAMETER(CTL.USR_Display_6);
PARAMETER(CTL.Base_Adj_Sts_6_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


ENDDO;

// LCL.Load ID = CTL.Load ID
LCL.Load_ID = CTL.Load_ID;

// LCL.Load Status = CTL.Load Status
LCL.Load_Status = CTL.Load_Status;

// LCL.Sel Value 1 USR = CTL.Sel Value 1 USR
LCL.Sel_Value_1_USR = CTL.Sel_Value_1_USR;

// LCL.Sel Value 2 USR = CTL.Sel Value 2 USR
LCL.Sel_Value_2_USR = CTL.Sel_Value_2_USR;

// LCL.Sel Value 3 USR = CTL.Sel Value 3 USR
LCL.Sel_Value_3_USR = CTL.Sel_Value_3_USR;

// LCL.Sel Value 4 USR = CTL.Sel Value 4 USR
LCL.Sel_Value_4_USR = CTL.Sel_Value_4_USR;

// LCL.Sel Value 5 USR = CTL.Sel Value 5 USR
LCL.Sel_Value_5_USR = CTL.Sel_Value_5_USR;

// LCL.Sel Value 6 USR = CTL.Sel Value 6 USR
LCL.Sel_Value_6_USR = CTL.Sel_Value_6_USR;

//?All/Converted Text
CASE;

// IF LCL.Select 1 or 2 is Two
IF LCL.Select_1_or_2 = '2';

// CTL.Text 9                USR = CON.CONVERTED
CTL.Text_9_USR = 'CONVERTED';

//?All/Converted Text
// IF *OTHERWISE
IF *OTHERWISE;

// CTL.Text 9                USR = CON.*BLANK
CTL.Text_9_USR = *BLANK;

ENDIF;

//?All/Hold Text
CASE;

// IF LCL.Hold Order is yes
IF LCL.Hold_Order = 'Y';

// CTL.Text USR 4 = CON.HOLD
CTL.Text_USR_4 = 'HOLD';

//?All/Hold Text
// IF *OTHERWISE
IF *OTHERWISE;

// CTL.Text USR 4 = CON.*BLANK
CTL.Text_USR_4 = *BLANK;

ENDIF;

CASE;

// IF LCL.Status Flag 17 Y/N is Yes
IF LCL.Status_Flag_17_Y_N = 'Y';

// Execute function SFL Maintain Subfil PosUS.
EXECUTE FUNCTION(SFL Maintain Subfil PosUS) TYPE(EXCUSRSRC) ('PNG7UFR');
{
 C*   MAINTAIN SUBFILE POSITION WHERE POSSIBLE
 C           W1SFRC    IFGT *ZERO
 C                     Z-ADDW1SFRC    ##SFRC
 C                     Z-ADD##SFRC    @#SFRC
 C                     Z-ADD##SFRC    W0RR0
 C                     END
}


// LCL.Status Flag 17 Y/N = CND.No
LCL.Status_Flag_17_Y_N = 'N';

ENDIF;

//?USER: Initialize subfile record from DBF record

// RCD.Quantity Ordered 5.0 USR = RCD.Quantity Ordered
RCD.Quantity_Ordered_5_0_USR = RCD.Quantity_Ordered;

// RCD.Quantity Sched 5.0 USR = RCD.Quantity Scheduled
RCD.Quantity_Sched_5_0_USR = RCD.Quantity_Scheduled;

// RCD.USR Age Code = RCD.Age Code
RCD.USR_Age_Code = RCD.Age_Code;

EXECUTE FUNCTION(Rtv Load/LdSts        IF) TYPE(EXCINTFUN)                      AC1648393;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Type_Sales);
PARAMETER(NLL.Ship_To_Customer);
PARAMETER(RCD.Ship_To_Name);
PARAMETER(RCD.Ship_To_City);
PARAMETER(RCD.Ship_To_State_Code);
PARAMETER(RCD.Order_Date);
PARAMETER(RCD.Actual_Shipped_Date);
PARAMETER(RCD.Order_in_Use);
PARAMETER(RCD.Header_Status);
PARAMETER(RCD.Credit_Hold);
PARAMETER(RCD.Production_Hold);
PARAMETER(RCD.Requested_Delivery_Date);
PARAMETER(RCD.Requested_Delivery_Time);
PARAMETER(RCD.Load_ID);
PARAMETER(RCD.Billing_Activity_Type);
PARAMETER(RCD.Block_Order_Flag);
PARAMETER(RCD.Load_Status);
PARAMETER(RCD.Carrier_Code);
PARAMETER(RCD.Export_Status);
PARAMETER(RCD.Load_Acceptance_Flag);
PARAMETER(LCL.Deadline_Departure_Date);
PARAMETER(LCL.Deadline_Departure_Time);
{
 //?Execute internal function

 //?** 05/19/16   RMC E4119  remove live with tpm check
 EXECUTE FUNCTION(RTV LdId/OrdDt/ShpDt  RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1648395;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Order_Number);
 PARAMETER(PAR.Order_Type_Sales);
 PARAMETER(PAR.Ship_To_Customer);
 PARAMETER(PAR.Ship_To_Name);
 PARAMETER(PAR.Ship_To_City);
 PARAMETER(PAR.Ship_To_State_Code);
 PARAMETER(PAR.Order_Date);
 PARAMETER(PAR.Actual_Shipped_Date);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(PAR.Order_in_Use);
 PARAMETER(PAR.Header_Status);
 PARAMETER(PAR.Credit_Hold);
 PARAMETER(PAR.Production_Hold);
 PARAMETER(PAR.Requested_Delivery_Date);
 PARAMETER(PAR.Requested_Delivery_Time);
 PARAMETER(LCL.Load_ID);
 PARAMETER(PAR.Export_Status);
 PARAMETER(PAR.Billing_Activity_Type);
 PARAMETER(PAR.Block_Order_Flag);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // PAR.Load ID = LCL.Load ID
 PAR.Load_ID = LCL.Load_ID;

 CASE;

 // IF LCL.Load ID is NE Blank
 IF LCL.Load_ID <> *ZERO;

 EXECUTE FUNCTION(RTV LoadSts/Carrier    RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1648402;
 PARAMETER(LCL.Load_ID);
 PARAMETER(PAR.Load_Status);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(PAR.Export_Status);
 PARAMETER(PAR.Load_Acceptance_Flag);
 PARAMETER(PAR.Deadline_Departure_Date);
 PARAMETER(PAR.Deadline_Departure_Time);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

}


EXECUTE FUNCTION(RTV Sales Route/OE Dt  RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1905592;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Date_of_Original_Entry);
PARAMETER(RCD.Sales_Route_Code);
PARAMETER(RCD.Time_of_Original_Entry);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

}


//?SEL:  Load ID
CASE;

// IF CTL.Load ID is NE Blank
IF CTL.Load_ID <> *ZERO;

CASE;

// IF RCD.Load ID NE CTL.Load ID
IF RCD.Load_ID <> CTL.Load_ID;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?SEL:  Load Status
CASE;

// IF CTL.Load Status is *Blank
IF CTL.Load_Status = *BLANK;

//?SEL:  Load Status
// IF *OTHERWISE
IF *OTHERWISE;

CASE;

// IF RCD.Load Status NE CTL.Load Status
IF RCD.Load_Status <> CTL.Load_Status;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?SEL:  Order Type - Sales    - only sel "OR" FP1054
CASE;

// IF RCD.Order Type - Sales is Regular Order
IF RCD.Order_Type_Sales = 'OR';

//?SEL:  Order Type - Sales    - only sel "OR" FP1054
// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?SEL:  All/Converted Item Toggle
CASE;

// IF LCL.Select 1 or 2 is One
IF LCL.Select_1_or_2 = '1';

//?SEL:  All/Converted Item Toggle
// IF LCL.Select 1 or 2 is Two
IF LCL.Select_1_or_2 = '2';

CASE;

// IF DB1.Item Code EQ DB1.Consumed Item Code
IF DB1.Item_Code = DB1.Consumed_Item_Code;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?Record Selected
CASE;

// IF PGM.*Record selected is *YES
IF PGM.*Record_selected = 'Y';

EXECUTE FUNCTION(Rtv Order Prod Sched  RT) TYPE(RTVOBJ) FILE(PDKNCPP)           AC1648127;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
PARAMETER(RCD.Qty_Sched_Ord_1_USR);
PARAMETER(RCD.Qty_Sched_Ord_2_USR);
PARAMETER(RCD.Qty_Sched_Ord_3_USR);
PARAMETER(RCD.Qty_Sched_Ord_4_USR);
PARAMETER(RCD.Qty_Sched_Ord_5_USR);
PARAMETER(RCD.Qty_Sched_Ord_6_USR);
PARAMETER(RCD.OD_Added_to_Sched_Today);
PARAMETER(RCD.Production_USR);
PARAMETER(RCD.Inv_Total_USR);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 //?Production
 CASE;

 // IF DB1.OD Production Date EQ PAR.USR Day 1
 IF DB1.OD_Production_Date = PAR.USR_Day_1;

 // PAR.Qty Sched Ord 1 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_1_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 2
 IF DB1.OD_Production_Date = PAR.USR_Day_2;

 // PAR.Qty Sched Ord 2 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_2_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 3
 IF DB1.OD_Production_Date = PAR.USR_Day_3;

 // PAR.Qty Sched Ord 3 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_3_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 4
 IF DB1.OD_Production_Date = PAR.USR_Day_4;

 // PAR.Qty Sched Ord 4 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_4_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 5
 IF DB1.OD_Production_Date = PAR.USR_Day_5;

 // PAR.Qty Sched Ord 5 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_5_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 6
 IF DB1.OD_Production_Date = PAR.USR_Day_6;

 // PAR.Qty Sched Ord 6 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_6_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 ENDIF;

 // PAR.OD Quantity Scheduled = PAR.OD Quantity Scheduled + DB1.OD Quantity Scheduled
 PAR.OD_Qty_Cnsmd_Pieces_Sched = PAR.OD_Qty_Cnsmd_Pieces_Sched
 + DB1.OD_Qty_Cnsmd_Pieces_Sched;

 // PAR.OD Quantity Inv Sched = PAR.OD Quantity Inv Sched + DB1.OD Quantity Inv Sched
 PAR.OD_Quantity_Inv_Sched = PAR.OD_Quantity_Inv_Sched + DB1.OD_Quantity_Inv_Sched;

}


// LCL.Date From             USR = RCD.Requested Ship Date + CON.-3 *DAYS
LCL.Date_From_USR = DATEINCR(RCD.Requested_Ship_Date '-3' 'DY' 1111111 'NONE' 'N' 1);

//?REQ   Ship Date display in YLW if order older than 3 days  FP1054
CASE;

// IF RCD.Requested Ship Date LT LCL.Date From             USR
IF RCD.Requested_Ship_Date < LCL.Date_From_USR;

// RCD.Record Found -OrdDtlUSR = CND.Record Not Found
RCD.Record_Found_OrdDtlUSR = 'N';

//?REQ   Ship Date display in YLW if order older than 3 days  FP1054
// IF *OTHERWISE
IF *OTHERWISE;

// RCD.Record Found -OrdDtlUSR = CND.Record Found
RCD.Record_Found_OrdDtlUSR = 'Y';

ENDIF;

//?4/15/09 was passing in ctl.warehouse
EXECUTE FUNCTION(UPS Rtv Company/Item  IF) TYPE(EXCINTFUN)                      AC1423844;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Item_Code);
PARAMETER(WRK.Description_Line_One);
PARAMETER(RCD.UOM_Primary);
PARAMETER(RCD.Unit_Weight);
PARAMETER(WRK.Item_Structure_Class_Code);
PARAMETER(WRK.Item_Structure_Group_Code);
PARAMETER(WRK.Item_Structure_Type_Code);
PARAMETER(WRK.Item_Type_Code);
PARAMETER(WRK.Default_Warehouse);
PARAMETER(RCD.Fresh_Chilling_Time);
PARAMETER(RCD.Base_Conv_Loss_Item);
PARAMETER(WRK.Variety_Rendered_Cut);
PARAMETER(WRK.Credit_Item_Status);
PARAMETER(WRK.Std_Weight_Head_Var_Ren);
PARAMETER(WRK.Pieces_Per_Head);
PARAMETER(RCD.Department_Code);
PARAMETER(WRK.Group_for_Packaging);
PARAMETER(WRK.Seconds_Item);
PARAMETER(RCD.Piece_Count_Item);
PARAMETER(RCD.Pieces_Per_Bag);
PARAMETER(RCD.Bags_Per_Unit);
PARAMETER(RCD.Export_Domestic);
PARAMETER(RCD.Print_On_Schedule);
PARAMETER(RCD.Fresh_Inv_Allocation_Seq);
PARAMETER(RCD.Fresh_Sched_As_Ordered);
PARAMETER(RCD.Frozen_Inv_Allocation_Seq);
PARAMETER(RCD.Primal_Group_Code);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.Warehouse_Type);
PARAMETER(WRK.Trans_Contol_AS400_Plant);
PARAMETER(WRK.Warehouse_Location);
PARAMETER(RCD.Warehouse_Std_Chill_Time);
PARAMETER(RCD.Warehouse_Chill_Time);
{
 //?Execute internal function

 EXECUTE FUNCTION(Rtv Prd Sch Info   PS RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1294543;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Code);
 PARAMETER(PAR.Description_Line_One);
 PARAMETER(PAR.UOM_Primary);
 PARAMETER(PAR.Unit_Weight);
 PARAMETER(PAR.Item_Structure_Class_Code);
 PARAMETER(PAR.Item_Structure_Group_Code);
 PARAMETER(PAR.Item_Structure_Type_Code);
 PARAMETER(PAR.Item_Type_Code);
 PARAMETER(PAR.Default_Warehouse);
 PARAMETER(PAR.Fresh_Chilling_Time);
 PARAMETER(PAR.Base_Conv_Loss_Item);
 PARAMETER(PAR.Variety_Rendered_Cut);
 PARAMETER(PAR.Credit_Item_Status);
 PARAMETER(PAR.Std_Weight_Head_Var_Ren);
 PARAMETER(PAR.Pieces_Per_Head);
 PARAMETER(PAR.Department_Code);
 PARAMETER(PAR.Group_for_Packaging);
 PARAMETER(PAR.Seconds_Item);
 PARAMETER(PAR.Piece_Count_Item);
 PARAMETER(PAR.Pieces_Per_Bag);
 PARAMETER(PAR.Bags_Per_Unit);
 PARAMETER(PAR.Export_Domestic);
 PARAMETER(PAR.Print_On_Schedule);
 PARAMETER(PAR.Fresh_Inv_Allocation_Seq);
 PARAMETER(PAR.Fresh_Sched_As_Ordered);
 PARAMETER(PAR.Frozen_Inv_Allocation_Seq);
 PARAMETER(PAR.Primal_Group_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(BPS Rtv Whs Info      RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1475289;
 PARAMETER(PAR.Warehouse_Code);
 PARAMETER(PAR.Warehouse_Type);
 PARAMETER(PAR.Trans_Contol_AS400_Plant);
 PARAMETER(PAR.Warehouse_Location);
 PARAMETER(PAR.Warehouse_Std_Chill_Time);
 PARAMETER(PAR.Warehouse_Chill_Time);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


CASE;

// IF RCD.Warehouse Std Chill Time is yes
IF RCD.Warehouse_Std_Chill_Time = 'Y';

// LCL.Chilling Time USR = RCD.Warehouse Chill Time
LCL.Chilling_Time_USR = RCD.Warehouse_Chill_Time;

// IF *OTHERWISE
IF *OTHERWISE;

// LCL.Chilling Time USR = RCD.Fresh Chilling Time
LCL.Chilling_Time_USR = RCD.Fresh_Chilling_Time;

ENDIF;

//?Pass requested Ship Date instead of sched
// Call program CLC PA Age FrmToDates XF.
CALL PROGRAM(CLC PA Age FrmToDates XF) ('PNO7XFR');
PARAMETER(RCD.Company_Number);
PARAMETER(LCL.Chilling_Time_USR);
PARAMETER(RCD.Requested_Ship_Date);
PARAMETER(RCD.Requested_Delivery_Date);
PARAMETER(RCD.Item_Age_Days);
PARAMETER(RCD.Production_Ovr_AgeDte_Fr);
PARAMETER(RCD.Production_Ovr_AgeDte_To);
PARAMETER(RCD.Production_Date_RGF);
PARAMETER(RCD.Production_Date_RGT);

// RCD.Qty Sched Prod 1 USR = RCD.Qty Sched Ord 1 USR
RCD.Qty_Sched_Prod_1_USR = RCD.Qty_Sched_Ord_1_USR;

// RCD.Qty Sched Prod 2 USR = RCD.Qty Sched Ord 2 USR
RCD.Qty_Sched_Prod_2_USR = RCD.Qty_Sched_Ord_2_USR;

// RCD.Qty Sched Prod 3 USR = RCD.Qty Sched Ord 3 USR
RCD.Qty_Sched_Prod_3_USR = RCD.Qty_Sched_Ord_3_USR;

// RCD.Qty Sched Prod 4 USR = RCD.Qty Sched Ord 4 USR
RCD.Qty_Sched_Prod_4_USR = RCD.Qty_Sched_Ord_4_USR;

// RCD.Qty Sched Prod 5 USR = RCD.Qty Sched Ord 5 USR
RCD.Qty_Sched_Prod_5_USR = RCD.Qty_Sched_Ord_5_USR;

// RCD.Qty Sched Prod 6 USR = RCD.Qty Sched Ord 6 USR
RCD.Qty_Sched_Prod_6_USR = RCD.Qty_Sched_Ord_6_USR;

// RCD.Qty 5.0 USR = RCD.Inv Total             USR
RCD.Qty_5_0_USR = RCD.Inv_Total_USR;

// RCD.Qty Prod Adj Hold 1 USR = RCD.Qty Prod Adjusted 1 USR
RCD.Qty_Prod_Adj_Hold_1_USR = RCD.Qty_Prod_Adjusted_1_USR;

// RCD.Qty Prod Adj Hold 2 USR = RCD.Qty Prod Adjusted 2 USR
RCD.Qty_Prod_Adj_Hold_2_USR = RCD.Qty_Prod_Adjusted_2_USR;

// RCD.Qty Prod Adj Hold 3 USR = RCD.Qty Prod Adjusted 3 USR
RCD.Qty_Prod_Adj_Hold_3_USR = RCD.Qty_Prod_Adjusted_3_USR;

// RCD.Qty Prod Adj Hold 4 USR = RCD.Qty Prod Adjusted 4 USR
RCD.Qty_Prod_Adj_Hold_4_USR = RCD.Qty_Prod_Adjusted_4_USR;

// RCD.Qty Prod Adj Hold 5 USR = RCD.Qty Prod Adjusted 5 USR
RCD.Qty_Prod_Adj_Hold_5_USR = RCD.Qty_Prod_Adjusted_5_USR;

// RCD.Qty Prod Adj Hold 6 USR = RCD.Qty Prod Adjusted 6 USR
RCD.Qty_Prod_Adj_Hold_6_USR = RCD.Qty_Prod_Adjusted_6_USR;

// Quantity Variance
RCD.ODS_Quantity_Short = ( RCD.Production_USR + RCD.Inv_Total_USR ) - RCD.Quantity_Ordered;

CASE;

// IF RCD.Record Found -OrdDtlUSR is Record Found
IF RCD.Record_Found_OrdDtlUSR = 'Y';

//?RI:  Order Number
CASE;

// IF RCD.ODS Quantity Short is NE Zero
IF RCD.ODS_Quantity_Short <> *ZERO;

CASE;

// IF RCD.Released by User Sts Y/N is yes
IF RCD.Released_by_User_Sts_Y_N = 'Y';

//?if user has released the line, dont show short qty or change to RED
// RCD.Reverse Image Flag USR = CND.No
RCD.Reverse_Image_Flag_USR = 'N';

// RCD.ODS Quantity Short = CON.*ZERO
RCD.ODS_Quantity_Short = *ZERO;

// IF *OTHERWISE
IF *OTHERWISE;

// RCD.Reverse Image Flag USR = CND.Yes
RCD.Reverse_Image_Flag_USR = 'Y';

ENDIF;

//?RI:  Order Number
// IF *OTHERWISE
IF *OTHERWISE;

// RCD.Reverse Image Flag USR = CND.No
RCD.Reverse_Image_Flag_USR = 'N';

ENDIF;

// IF *OTHERWISE
IF *OTHERWISE;

//?Short  and Prod Hold (RED)
CASE;

// IF RCD.ODS Quantity Short is NE Zero
IF RCD.ODS_Quantity_Short <> *ZERO;

// AND RCD.Production Hold is Yes
AND RCD.Production_Hold = 'Y';

// RCD.Reverse Image Flag USR = CND.Yes
RCD.Reverse_Image_Flag_USR = 'Y';

//?Short  and Prod Hold (RED)
// IF *OTHERWISE
IF *OTHERWISE;

// RCD.Reverse Image Flag USR = CND.No
RCD.Reverse_Image_Flag_USR = 'N';

// RCD.ODS Quantity Short = CON.*ZERO
RCD.ODS_Quantity_Short = *ZERO;

ENDIF;

ENDIF;

//?CLR:  Item Code
CASE;

// IF LCL.Item Code NE RCD.Item Code
IF LCL.Item_Code <> RCD.Item_Code;

CASE;

// IF LCL.USR Display 1 is Yes
IF LCL.USR_Display_1 = 'Y';

// RCD.USR Display 1 = CND.No
RCD.USR_Display_1 = 'N';

// LCL.USR Display 1 = CND.No
LCL.USR_Display_1 = 'N';

// IF LCL.USR Display 1 is No
IF LCL.USR_Display_1 = 'N';

// RCD.USR Display 1 = CND.Yes
RCD.USR_Display_1 = 'Y';

// LCL.USR Display 1 = CND.Yes
LCL.USR_Display_1 = 'Y';

ENDIF;

// LCL.Item Code = RCD.Item Code
LCL.Item_Code = RCD.Item_Code;

//?CLR:  Item Code
// IF *OTHERWISE
IF *OTHERWISE;

// RCD.USR Display 1 = LCL.USR Display 1
RCD.USR_Display_1 = LCL.USR_Display_1;

ENDIF;

CASE;

// IF RCD.Load ID is Blank
IF RCD.Load_ID = *ZERO;

// RCD.Pick Status USR = CND.Not Picked
RCD.Pick_Status_USR = 'N';

// IF *OTHERWISE
IF *OTHERWISE;

// Call program RTV Load Order Picked  XF.
CALL PROGRAM(RTV Load Order Picked  XF) ('PDQVXFR');
PARAMETER(RCD.Load_ID);
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Pick_Status_USR);

ENDIF;

ENDIF;

//?SEL:  Production Date
CASE;

// IF CTL.Sel Value 1 USR is Select
IF CTL.Sel_Value_1_USR = 'X';

CASE;

// IF RCD.Qty Sched Ord 1 USR is EQ Zero
IF RCD.Qty_Sched_Ord_1_USR = *ZERO;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?SEL:  Production Date
// IF CTL.Sel Value 2 USR is Select
IF CTL.Sel_Value_2_USR = 'X';

CASE;

// IF RCD.Qty Sched Ord 2 USR is EQ Zero
IF RCD.Qty_Sched_Ord_2_USR = *ZERO;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?SEL:  Production Date
// IF CTL.Sel Value 3 USR is Select
IF CTL.Sel_Value_3_USR = 'X';

CASE;

// IF RCD.Qty Sched Ord 3 USR is EQ Zero
IF RCD.Qty_Sched_Ord_3_USR = *ZERO;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?SEL:  Production Date
// IF CTL.Sel Value 4 USR is Select
IF CTL.Sel_Value_4_USR = 'X';

CASE;

// IF RCD.Qty Sched Ord 4 USR is EQ Zero
IF RCD.Qty_Sched_Ord_4_USR = *ZERO;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?SEL:  Production Date
// IF CTL.Sel Value 5 USR is Select
IF CTL.Sel_Value_5_USR = 'X';

CASE;

// IF RCD.Qty Sched Ord 5 USR is EQ Zero
IF RCD.Qty_Sched_Ord_5_USR = *ZERO;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?SEL:  Production Date
// IF CTL.Sel Value 6 USR is Select
IF CTL.Sel_Value_6_USR = 'X';

CASE;

// IF RCD.Qty Sched Ord 6 USR is EQ Zero
IF RCD.Qty_Sched_Ord_6_USR = *ZERO;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?FP1054 - output for all now
// RCD.Output Only 1 USR = CND.yes
RCD.Output_Only_1_USR = 'Y';

// RCD.Output Only 2 USR = CND.yes
RCD.Output_Only_2_USR = 'Y';

//?OUTPUT:  Sched Qty & Adj Qty (User Model Code = Blank)
CASE;

// IF LCL.User Code Model is equal to blank
IF LCL.User_Code_Model = *BLANK;

//?Scheduled Quantity
// RCD.Output Only 1 USR = CND.yes
RCD.Output_Only_1_USR = 'Y';

//?Adjustment Quantity
// RCD.Output Only 2 USR = CND.yes
RCD.Output_Only_2_USR = 'Y';

ENDIF;

//?OUTPUT:  Sched Qty (Load Status = Shipped or Invoiced)
CASE;

// IF RCD.Load Status is Shipped or Invoiced
IF RCD.Load_Status = 'I'/'S';

// OR RCD.Pick Status USR is Picked
OR RCD.Pick_Status_USR = 'Y';

// OR RCD.Order in Use is yes
OR RCD.Order_in_Use = 'Y';

// OR RCD.Event Code is Picked Thru History
OR RCD.Event_Code >= '03';
AND RCD.Event_Code <= '07';

//?Scheduled Quantity
// RCD.Output Only 1 USR = CND.yes
RCD.Output_Only_1_USR = 'Y';

//?Age code - it was on output only 1 usr - now on output only 3 usr
// RCD.Output Only 3 USR = CND.yes
RCD.Output_Only_3_USR = 'Y';

ENDIF;

//?Reverse on the Item Age Days
CASE;

// IF DB1.Production Ovr AgeDte Fr is not equal zero
IF DB1.Production_Ovr_AgeDte_Fr <> *ZERO;

// RCD.Override Age Dates StsUsr = CND.Age Dates are Entered
RCD.Override_Age_Dates_StsUsr = 'O';

//?Reverse on the Item Age Days
// IF *OTHERWISE
IF *OTHERWISE;

// RCD.Override Age Dates StsUsr = CND.No Override Age Dates
RCD.Override_Age_Dates_StsUsr = *BLANK;

ENDIF;

//?USER: Process subfile control (Pre-confirm)

// LCL.Status Flag 17 Y/N = CND.No
LCL.Status_Flag_17_Y_N = 'N';

// LCL.Error Status = CND.no
LCL.Error_Status = 'N';

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

//?F5=Refresh
CASE;

// IF CTL.*CMD key is *Refresh
IF CTL.*CMD_key = '05';

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

QUIT;

ENDIF;

//?F7=Previous
CASE;

// IF CTL.*CMD key is CF07
IF CTL.*CMD_key = '07';

EXECUTE FUNCTION(CLC Inc/Dec Date PrdDt IF) TYPE(EXCINTFUN)                     AC1649084;
PARAMETER(LCL.Production_Date_USR);
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.USR_Day_1);
PARAMETER('-6');
{
 //?Execute internal function

 CASE;

 // IF PAR.*Duration (factor) is LT Zero
 IF PAR.*Duration_factor < *ZERO;

 // WRK.*Duration (factor) = PAR.*Duration (factor) * CON.-1 *
 WRK.*Duration_factor = PAR.*Duration_factor * -1;

 EXECUTE FUNCTION(CLC Date (desc) PrdDte RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1649087;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(PAR.*Date1_ending);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(WRK.*Duration_factor);
 {
  //?USER: Initialize routine

  // WRK.Count USR = CON.*ZERO
  WRK.Count_USR = *ZERO;

  //?USER: Process Data record

  CASE;

  // IF PAR.Post to G/L Date EQ DB1.Post to G/L Date
  IF PAR.Post_to_G_L_Date = DB1.Post_to_G_L_Date;

  // OR DB1.Production Day Status is no
  OR DB1.Production_Day_Status = 'N';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // WRK.Count USR = WRK.Count USR + CON.1
  WRK.Count_USR = WRK.Count_USR + 1;

  ENDIF;

  CASE;

  // IF WRK.Count USR EQ PAR.*Duration (factor)
  IF WRK.Count_USR = PAR.*Duration_factor;

  // PAR.*Date1 (ending) = DB1.Post to G/L Date
  PAR.*Date1_ending = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

 }

 // IF PAR.*Duration (factor) is GT Zero
 IF PAR.*Duration_factor > *ZERO;

 EXECUTE FUNCTION(CLC Date (asce) PrdDte RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1649088;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(PAR.*Date1_ending);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(PAR.*Duration_factor);
 {
  //?USER: Initialize routine

  // WRK.Count USR = CON.*ZERO
  WRK.Count_USR = *ZERO;

  //?USER: Process Data record

  CASE;

  // IF PAR.Post to G/L Date EQ DB1.Post to G/L Date
  IF PAR.Post_to_G_L_Date = DB1.Post_to_G_L_Date;

  // OR DB1.Production Day Status is no
  OR DB1.Production_Day_Status = 'N';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // WRK.Count USR = WRK.Count USR + CON.1
  WRK.Count_USR = WRK.Count_USR + 1;

  ENDIF;

  CASE;

  // IF WRK.Count USR EQ PAR.*Duration (factor)
  IF WRK.Count_USR = PAR.*Duration_factor;

  // PAR.*Date1 (ending) = DB1.Post to G/L Date
  PAR.*Date1_ending = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

 }

 // IF PAR.*Duration (factor) is EQ Zero
 IF PAR.*Duration_factor = *ZERO;

 // PAR.*Date1 (ending) = PAR.*Date2 (beginning)
 PAR.*Date1_ending = PAR.*Date2_beginning;

 ENDIF;

}


// LCL.Status Flag 17 Y/N = CND.Yes
LCL.Status_Flag_17_Y_N = 'Y';

// Execute function SFL Save subfile pos   US.
EXECUTE FUNCTION(SFL Save subfile pos   US) TYPE(EXCUSRSRC) ('PNG8UFR');
{
 C*   MAINTAIN SUBFILE POSITION WHERE POSSIBLE
 C           ##SFRC    IFGT *ZERO
 C                     Z-ADD##SFRC    W1SFRC  40
 C                     Z-ADD##SFRC    W0RR0
 C                     END
}


// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

QUIT;

ENDIF;

//?F8=Next
CASE;

// IF CTL.*CMD key is CF08
IF CTL.*CMD_key = '08';

EXECUTE FUNCTION(CLC Inc/Dec Date PrdDt IF) TYPE(EXCINTFUN)                     AC1649084;
PARAMETER(LCL.Production_Date_USR);
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.USR_Day_1);
PARAMETER(6);
{
 //?Execute internal function

 CASE;

 // IF PAR.*Duration (factor) is LT Zero
 IF PAR.*Duration_factor < *ZERO;

 // WRK.*Duration (factor) = PAR.*Duration (factor) * CON.-1 *
 WRK.*Duration_factor = PAR.*Duration_factor * -1;

 EXECUTE FUNCTION(CLC Date (desc) PrdDte RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1649087;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(PAR.*Date1_ending);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(WRK.*Duration_factor);
 {
  //?USER: Initialize routine

  // WRK.Count USR = CON.*ZERO
  WRK.Count_USR = *ZERO;

  //?USER: Process Data record

  CASE;

  // IF PAR.Post to G/L Date EQ DB1.Post to G/L Date
  IF PAR.Post_to_G_L_Date = DB1.Post_to_G_L_Date;

  // OR DB1.Production Day Status is no
  OR DB1.Production_Day_Status = 'N';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // WRK.Count USR = WRK.Count USR + CON.1
  WRK.Count_USR = WRK.Count_USR + 1;

  ENDIF;

  CASE;

  // IF WRK.Count USR EQ PAR.*Duration (factor)
  IF WRK.Count_USR = PAR.*Duration_factor;

  // PAR.*Date1 (ending) = DB1.Post to G/L Date
  PAR.*Date1_ending = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

 }

 // IF PAR.*Duration (factor) is GT Zero
 IF PAR.*Duration_factor > *ZERO;

 EXECUTE FUNCTION(CLC Date (asce) PrdDte RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1649088;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(PAR.*Date1_ending);
 PARAMETER(PAR.*Date2_beginning);
 PARAMETER(PAR.*Duration_factor);
 {
  //?USER: Initialize routine

  // WRK.Count USR = CON.*ZERO
  WRK.Count_USR = *ZERO;

  //?USER: Process Data record

  CASE;

  // IF PAR.Post to G/L Date EQ DB1.Post to G/L Date
  IF PAR.Post_to_G_L_Date = DB1.Post_to_G_L_Date;

  // OR DB1.Production Day Status is no
  OR DB1.Production_Day_Status = 'N';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // WRK.Count USR = WRK.Count USR + CON.1
  WRK.Count_USR = WRK.Count_USR + 1;

  ENDIF;

  CASE;

  // IF WRK.Count USR EQ PAR.*Duration (factor)
  IF WRK.Count_USR = PAR.*Duration_factor;

  // PAR.*Date1 (ending) = DB1.Post to G/L Date
  PAR.*Date1_ending = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

 }

 // IF PAR.*Duration (factor) is EQ Zero
 IF PAR.*Duration_factor = *ZERO;

 // PAR.*Date1 (ending) = PAR.*Date2 (beginning)
 PAR.*Date1_ending = PAR.*Date2_beginning;

 ENDIF;

}


// Execute function SFL Save subfile pos   US.
EXECUTE FUNCTION(SFL Save subfile pos   US) TYPE(EXCUSRSRC) ('PNG8UFR');
{
 C*   MAINTAIN SUBFILE POSITION WHERE POSSIBLE
 C           ##SFRC    IFGT *ZERO
 C                     Z-ADD##SFRC    W1SFRC  40
 C                     Z-ADD##SFRC    W0RR0
 C                     END
}


// LCL.Status Flag 17 Y/N = CND.Yes
LCL.Status_Flag_17_Y_N = 'Y';

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

QUIT;

ENDIF;

//?CHG:  CTL.Load ID -- Refresh
CASE;

// IF CTL.Load ID NE LCL.Load ID
IF CTL.Load_ID <> LCL.Load_ID;

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

QUIT;

ENDIF;

//?CHG:  CTL.Load Status -- Refresh
CASE;

// IF LCL.Load Status NE CTL.Load Status
IF LCL.Load_Status <> CTL.Load_Status;

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

QUIT;

ENDIF;

//?USER: Process subfile record (Pre-confirm)

// LCL.Post Flag USR = CND.No
LCL.Post_Flag_USR = 'N';

// LCL.*Reload subfile = CND.*NO
LCL.*Reload_subfile = 'N';

//?5=Display Order
CASE;

// IF RCD.*SFLSEL is Option 5
IF RCD.*SFLSEL = '5'/'5';

// Call program DSP Ord Inquiry Detail DF.
CALL PROGRAM(DSP Ord Inquiry Detail DF) ('PDPZDFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(LCL.Order_Sequence_Number);
PARAMETER(LCL.Order_Secondary_Line_Seq);
PARAMETER(LCL.Application_Code);

// RCD.*SFLSEL = CND.*Reset to blank
RCD.*SFLSEL = *BLANK;

ENDIF;

//?10=Work With Inventory Allocation
CASE;

// IF RCD.*SFLSEL is Option 10
IF RCD.*SFLSEL = '10';

// Call program WW Inv Allocation     DF.
CALL PROGRAM(WW Inv Allocation     DF) ('POP5DFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Item_Code);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.Order_Number);

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

ENDIF;

//?F90 & F91 are for IS personnel only (Not PORKSCHE)
//?** 11/19/2007 LJB FP1251 This routine resets the DDD/T fields to
//?** zeros if there is no Miles To Next Stop or Miles Between Cities rcd
//?90=Calculate Deadline Departure Date/Time (Testing only)
CASE;

// IF RCD.*SFLSEL is Option 90
IF RCD.*SFLSEL = '90';

//?** RTV Carr appt dt/tm                                E00495
// Call program RTV Carrier Appt Dt/Tm XF.
CALL PROGRAM(RTV Carrier Appt Dt/Tm XF) ('PNLVXFR');
PARAMETER(RCD.Load_ID);
PARAMETER(WRK.LD_Carrier_Appt_Date);
PARAMETER(WRK.LD_Carrier_Appt_Time);

//?** Use Carr appt dt/tm, if entered, to recalc DDD/T   E00495
CASE;

// IF WRK.LD Carrier Appt Date is Entered
IF WRK.LD_Carrier_Appt_Date > 0;

//?** Defaults DDD/T to SSD & 8:00am if export w/no state W288
// WRK.USR Time 4.0 = WRK.LD Carrier Appt Time / CON.100 *
WRK.USR_Time_4_0 = WRK.LD_Carrier_Appt_Time / 100;

// Call program CLC Deadln Depart Dt  XF.
CALL PROGRAM(CLC Deadln Depart Dt  XF) ('POSCXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Ship_To_City);
PARAMETER(RCD.Ship_To_State_Code);
PARAMETER(WRK.LD_Carrier_Appt_Date);
PARAMETER(WRK.USR_Time_4_0);
PARAMETER(RCD.Deadline_Depart_Date_LH);
PARAMETER(RCD.Deadline_Depart_Time_LH);

//?** Use Carr appt dt/tm, if entered, to recalc DDD/T   E00495
// IF *OTHERWISE
IF *OTHERWISE;

//?** Defaults DDD/T to SSD & 8:00am if export w/no state W288
// Call program CLC Deadln Depart Dt  XF.
CALL PROGRAM(CLC Deadln Depart Dt  XF) ('POSCXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Ship_To_City);
PARAMETER(RCD.Ship_To_State_Code);
PARAMETER(RCD.Requested_Delivery_Date);
PARAMETER(RCD.Requested_Delivery_Time);
PARAMETER(RCD.Deadline_Depart_Date_LH);
PARAMETER(RCD.Deadline_Depart_Time_LH);

ENDIF;

EXECUTE FUNCTION(Upd Deadline Dte/Tme  RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC1648968;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Deadline_Depart_Date_LH);
PARAMETER(RCD.Deadline_Depart_Time_LH);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Chg Deadline Dte/Tme  CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC1648969;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(PAR.Deadline_Depart_Date_LH);
 PARAMETER(PAR.Deadline_Depart_Time_LH);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

}


CASE;

// IF RCD.Deadline Depart Date LH is not entered
IF RCD.Deadline_Depart_Date_LH = *ZERO;

// Send information message - 'Mileages not found.'
MESSAGE(USR2818 *INFO);

ENDIF;

// RCD.*SFLSEL = CND.*Reset to blank
RCD.*SFLSEL = *BLANK;

ENDIF;

//?9=Display Sched
CASE;

// IF RCD.*SFLSEL is Option 91
IF RCD.*SFLSEL = '91';

// Call program Dsp Order Sched Pdctn DF.
CALL PROGRAM(Dsp Order Sched Pdctn DF) ('PDFMDFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.Item_Code);

ENDIF;

// Call program RTV Salesprsn Author.  XF.
CALL PROGRAM(RTV Salesprsn Author.  XF) ('PDNQXFR');
PARAMETER(RCD.Sales_Route_Code);
PARAMETER(PAR.Access_Denied_Y_N);
PARAMETER(PAR.Salesperson_Code);
PARAMETER('MO');

CASE;

// IF LCL.User Code Model is IS
IF LCL.User_Code_Model = 'ISBGUTI';

// PAR.Access Denied (Y/N) = CND.no
PAR.Access_Denied_Y_N = 'N';

ENDIF;

//?Update Options
CASE;

// IF RCD.*SFLSEL is PPS Update
IF RCD.*SFLSEL = '16'/'21'/'22'/'2'/'2'/'23'/'6'/'6';

// AND PAR.Access Denied (Y/N) is yes
AND PAR.Access_Denied_Y_N = 'Y';

// Send error message - 'Option is not allowed.'
ERROR(USR2262);
MSGPARM(RCD.*SFLSEL);

//?Update Options
// IF *OTHERWISE
IF *OTHERWISE;

//?14=Release Order
CASE;

// IF RCD.*SFLSEL is Option 14
IF RCD.*SFLSEL = '14';

EXECUTE FUNCTION(RTV Order in Use       RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1646052;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(LCL.Order_in_Use);
PARAMETER(LCL.Header_Status);
PARAMETER(RCD.Load_ID);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


CASE;

// IF LCL.Order in Use is yes
IF LCL.Order_in_Use = 'Y';

// Send error message - 'Order &2 in use by another user.'
ERROR(USR0664);
MSGPARM(RCD.*SFLSEL);
MSGPARM(RCD.Order_Number);

// LCL.Error Status = CND.yes
LCL.Error_Status = 'Y';

// IF LCL.Header Status is Cancelled
IF LCL.Header_Status = 'X';

// Send error message - 'Order has been cancelled, refresh screen.'
ERROR(USR2341);
MSGPARM(RCD.*SFLSEL);

// LCL.Error Status = CND.yes
LCL.Error_Status = 'Y';

// IF RCD.Production Hold is No
IF RCD.Production_Hold = 'N';

// Send error message - 'Order &1 not on Production Hold--will not be released.'
ERROR(USR1922);
MSGPARM(RCD.Order_Number);
MSGPARM(RCD.*SFLSEL);

// LCL.Error Status = CND.yes
LCL.Error_Status = 'Y';

// IF *OTHERWISE
IF *OTHERWISE;

// RCD.Production Hold = CND.No
RCD.Production_Hold = 'N';

// PGM.*Defer confirm = CND.Proceed to confirm
PGM.*Defer_confirm = 'N';

// PGM.*Reload subfile = CND.*NO
PGM.*Reload_subfile = 'N';

ENDIF;

ENDIF;

//?17=Reallocate
CASE;

// IF RCD.*SFLSEL is Option 17
IF RCD.*SFLSEL = '17';

// Send status message - 'Processing...'
MESSAGE(USR2303 *STATUS);

//?Deallocate
// LCL.Quantity Ordered = CON.*ZERO
LCL.Quantity_Ordered = *ZERO;

// LCL.Weight Ordered = CON.*ZERO
LCL.Weight_Ordered = *ZERO;

// LCL.Quantity Scheduled = RCD.Quantity Scheduled
LCL.Quantity_Scheduled = RCD.Quantity_Scheduled;

// LCL.Weight Scheduled = RCD.Weight Scheduled
LCL.Weight_Scheduled = RCD.Weight_Scheduled;

// Call program UPD Avail-To-Sell  ORD XF.
CALL PROGRAM(UPD Avail-To-Sell  ORD XF) ('PDQNXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(RCD.Item_Code);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.Requested_Ship_Date);
PARAMETER(LCL.Quantity_Ordered);
PARAMETER(LCL.Weight_Ordered);
PARAMETER(LCL.Quantity_Scheduled);
PARAMETER(LCL.Weight_Scheduled);
PARAMETER('OD');
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Item_Age_Days);
PARAMETER(RCD.Production_Ovr_AgeDte_Fr);
PARAMETER(RCD.Production_Ovr_AgeDte_To);

EXECUTE FUNCTION(Chg Qty/Wgt Scheduled CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC1425232;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(LCL.Quantity_Scheduled);
PARAMETER(LCL.Weight_Scheduled);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


EXECUTE FUNCTION(CHG Released by User  CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC1920658;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER('N');
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*JOB
  PAR.Job_Name = JOB.*JOB;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


//?Allocate
// LCL.Quantity Ordered = RCD.Quantity Ordered
LCL.Quantity_Ordered = RCD.Quantity_Ordered;

// LCL.Weight Ordered = RCD.Weight Ordered
LCL.Weight_Ordered = RCD.Weight_Ordered;

// LCL.Quantity Scheduled = CON.*ZERO
LCL.Quantity_Scheduled = *ZERO;

// LCL.Weight Scheduled = CON.*ZERO
LCL.Weight_Scheduled = *ZERO;

// Call program UPD Avail-To-Sell  ORD XF.
CALL PROGRAM(UPD Avail-To-Sell  ORD XF) ('PDQNXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(RCD.Item_Code);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.Requested_Ship_Date);
PARAMETER(LCL.Quantity_Ordered);
PARAMETER(LCL.Weight_Ordered);
PARAMETER(LCL.Quantity_Scheduled);
PARAMETER(LCL.Weight_Scheduled);
PARAMETER('OA');
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Item_Age_Days);
PARAMETER(RCD.Production_Ovr_AgeDte_Fr);
PARAMETER(RCD.Production_Ovr_AgeDte_To);

EXECUTE FUNCTION(Chg Qty/Wgt Scheduled CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC1425232;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(LCL.Quantity_Scheduled);
PARAMETER(LCL.Weight_Scheduled);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


//?* FP1054 Create rcd * RLCORD
// Call program CRT Load/Order Chg Log XF.
CALL PROGRAM(CRT Load/Order Chg Log XF) ('PDADXFR');
PARAMETER(RCD.Load_ID);
PARAMETER(*ZERO);
PARAMETER('RLCORD');
PARAMETER('SLS');
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(JOB.*USER);
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Carrier_Code);
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);

//?*
// LCL.*Reload subfile = CND.*YES
LCL.*Reload_subfile = 'Y';

// LCL.Post Flag USR = CND.Yes
LCL.Post_Flag_USR = 'Y';

ENDIF;

//?18=Edt Age Days
CASE;

// IF RCD.*SFLSEL is Option 18
IF RCD.*SFLSEL = '18';

// PAR.Access Denied (Y/N) = CND.no
PAR.Access_Denied_Y_N = 'N';

//?Update Function
DO;

//?FP1309 add the aging fields
EXECUTE FUNCTION(RTV for PA update val2RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC1993258;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(LCL.Warehouse_Code_SavUsr);
PARAMETER(LCL.OD_Production_Plan_Sts);
PARAMETER(LCL.Quantity_Scheduled_1_USR);
PARAMETER(LCL.Weight_Scheduled_USR);
PARAMETER(LCL.OD_Schedule_Override_Sts);
PARAMETER(LCL.OD_Adj_Type_Override);
PARAMETER(LCL.Item_age_days_usr);
PARAMETER(LCL.Prod_Ovr_AgeDte_Fr_Usr);
PARAMETER(LCL.Prod_Ovr_AgeDte_To_Usr);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?If something has changed, dont allow option
CASE;

// IF RCD.Warehouse Code NE LCL.Warehouse Code SavUsr
IF RCD.Warehouse_Code <> LCL.Warehouse_Code_SavUsr;

// OR RCD.Weight Scheduled NE LCL.Weight Scheduled USR
OR RCD.Weight_Scheduled <> LCL.Weight_Scheduled_USR;

// OR RCD.Quantity Scheduled NE LCL.Quantity Scheduled 1 USR
OR RCD.Quantity_Scheduled <> LCL.Quantity_Scheduled_1_USR;

// OR RCD.OD Schedule Override Sts NE LCL.OD Schedule Override Sts
OR RCD.OD_Schedule_Override_Sts <> LCL.OD_Schedule_Override_Sts;

// OR RCD.OD Adj Type Override NE LCL.OD Adj Type Override
OR RCD.OD_Adj_Type_Override <> LCL.OD_Adj_Type_Override;

// OR RCD.Item Age Days NE LCL.Item age days usr
OR RCD.Item_Age_Days <> LCL.Item_age_days_usr;

// OR RCD.Production Ovr AgeDte Fr NE LCL.Prod Ovr AgeDte Fr Usr
OR RCD.Production_Ovr_AgeDte_Fr <> LCL.Prod_Ovr_AgeDte_Fr_Usr;

// OR RCD.Production Ovr AgeDte To NE LCL.Prod Ovr AgeDte To Usr
OR RCD.Production_Ovr_AgeDte_To <> LCL.Prod_Ovr_AgeDte_To_Usr;

// Send error message - 'Order has changed since display, option not allowed. Refresh screen.'
ERROR(USR4173);
MSGPARM(RCD.*SFLSEL);

//?If something has changed, dont allow option
// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(RTV Order in Use       RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1646052;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(LCL.Order_in_Use);
PARAMETER(LCL.Header_Status);
PARAMETER(RCD.Load_ID);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// LCL.Job Date Usr = JOB.*Job date + CON.7 *DAYS
LCL.Job_Date_Usr = DATEINCR(JOB.*Job_date 7 'DY' 1111111 'NONE' 'N' 1);

//?val order stuff and load stuff
CASE;

// IF LCL.Order in Use is yes
IF LCL.Order_in_Use = 'Y';

// Send error message - 'Order &2 in use by another user.'
ERROR(USR0664);
MSGPARM(RCD.*SFLSEL);
MSGPARM(RCD.Order_Number);

// LCL.Error Status = CND.yes
LCL.Error_Status = 'Y';

//?val order stuff and load stuff
// IF LCL.Header Status is Cancelled
IF LCL.Header_Status = 'X';

// Send error message - 'Order has been cancelled, refresh screen.'
ERROR(USR2341);
MSGPARM(RCD.*SFLSEL);

// LCL.Error Status = CND.yes
LCL.Error_Status = 'Y';

//?val order stuff and load stuff
// IF *OTHERWISE
IF *OTHERWISE;

//?val load stuff
CASE;

// IF RCD.Load ID is GT Zero
IF RCD.Load_ID > *ZERO;

//?Validate
CASE;

// IF RCD.Load Status is Shipped or Invoiced
IF RCD.Load_Status = 'I'/'S';

// Send error message - 'The Load is Locked.  Option is invalid.'
ERROR(USR2308);
MSGPARM(RCD.*SFLSEL);

// LCL.Error Status = CND.yes
LCL.Error_Status = 'Y';

//?Validate
// IF RCD.Load Status is Lock
IF RCD.Load_Status = 'L';

// AND RCD.Requested Ship Date LE LCL.Job Date Usr
AND RCD.Requested_Ship_Date <= LCL.Job_Date_Usr;

//?RMC 8/23/19 compare to REQ instead of Scheduled ship date
//?if ship date is within 7 days, then dont allow
// Send error message - 'The Load is Locked.  Option is invalid.'
ERROR(USR2308);
MSGPARM(RCD.*SFLSEL);

// LCL.Error Status = CND.yes
LCL.Error_Status = 'Y';

//?Validate
// IF RCD.Load Status is Lock
IF RCD.Load_Status = 'L';

EXECUTE FUNCTION(EDT Unlock Load Edit   IF) TYPE(EXCINTFUN)                     AC1419445;
PARAMETER(RCD.Load_ID);
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.*SFLSEL);
PARAMETER(LCL.Error_Status);
{
 //?Execute internal function

 EXECUTE FUNCTION(RTV Load Status        RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1297640;
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Load_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Any Ord/Blk  on Ld RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1448300;
 PARAMETER(PAR.Load_ID);
 PARAMETER(WRK.USR_Check_Y_N_Status);
 PARAMETER(PAR.Block_Order_Flag);
 {
  //?USER: Initialize routine

  //?05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST or Pos
  // PAR.USR Check Y/N Status = CND.blank
  PAR.USR_Check_Y_N_Status = *BLANK;

  //?OMS203:  need to know if there are any Block orders on load
  // PAR.Block Order Flag = CND.Firm Order
  PAR.Block_Order_Flag = 'F';

  //?USER: Process Data record

  // PAR.USR Check Y/N Status = CND.yes
  PAR.USR_Check_Y_N_Status = 'Y';

  CASE;

  // IF DB1.Block Order Flag is Block Order
  IF DB1.Block_Order_Flag = 'B';

  // PAR.Block Order Flag = DB1.Block Order Flag
  PAR.Block_Order_Flag = DB1.Block_Order_Flag;

  QUIT;

  ENDIF;

 }

 //?RMC PFS017 6/5/6 new par.allow unlock if picked = N
 EXECUTE FUNCTION(EDT Unlock Load Edits  IF) TYPE(EXCINTFUN)                     AC1419437;
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Load_Status);
 PARAMETER(PAR.*SFLSEL);
 PARAMETER(PAR.Error_Status);
 PARAMETER(PAR.Block_Order_Flag);
 PARAMETER('N');
 {
  //?Execute internal function

  //?assume will have error
  // PAR.Error Status = CND.yes
  PAR.Error_Status = 'Y';

  EXECUTE FUNCTION(VAL Set Int.Acc No Hdg IF) TYPE(EXCINTFUN)                     AC1460523;
  PARAMETER('LOCKLD');
  PARAMETER(WRK.Numeric_Field_Not_Needed);
  PARAMETER(WRK.TXT_field_not_needed);
  PARAMETER(WRK.TXT_field_not_needed);
  PARAMETER(WRK.TXT_field_not_needed);
  PARAMETER(WRK.TXT_field_not_needed);
  PARAMETER(WRK.TXT_field_not_needed);
  PARAMETER(WRK.TXT_field_not_needed);
  PARAMETER(PAR.Access_Denied_Y_N);
  {
   //?Execute internal function

   // PAR.User Profile Name = JOB.*USER
   PAR.User_Profile_Name = JOB.*USER;

   EXECUTE FUNCTION(VAL User/Appl No Exit  IF) TYPE(EXCINTFUN)                     AC1460535;
   PARAMETER(PAR.User_Profile_Name);
   PARAMETER(PAR.Application_Code);
   PARAMETER(WRK.Company_Number);
   PARAMETER(PAR.Warehouse_Code);
   PARAMETER(PAR.Allow_Multi_Company);
   PARAMETER(PAR.Default_Printer);
   PARAMETER(PAR.Salesperson_Code);
   PARAMETER(WRK.Access_Denied_Y_N);
   {
    //?Execute internal function

    //?RMC 5/11/09 Rtv default company from user profile --
    //?  Override user code model company if it exists
    EXECUTE FUNCTION(RTV Program Setup w/Co RT) TYPE(RTVOBJ) FILE(CADRREP)          AC1935572;
    PARAMETER(PAR.User_Profile_Name);
    PARAMETER(PAR.Allow_Multi_Company);
    PARAMETER(PAR.Default_Printer);
    PARAMETER(PAR.Salesperson_Code);
    PARAMETER(LCL.Company_Number);
    PARAMETER(PAR.User_Code_Model);
    {
     //?USER: Processing if Data record not found

     // PGM.*Return code = CND.*Record does not exist
     PGM.*Return_code = 'Y2U0005';

     //?USER: Process Data record

     MOVE *ALL (To: PAR From: DB1);

    }

    //?User Profile Record Not found
    CASE;

    // IF PGM.*Return code is *Record does not exist
    IF PGM.*Return_code = 'Y2U0005';

    // PAR.Access Denied (Y/N) = CND.yes
    PAR.Access_Denied_Y_N = 'Y';

    //?User Profile Record Not found
    // IF *OTHERWISE
    IF *OTHERWISE;

    // PAR.Access Denied (Y/N) = CND.no
    PAR.Access_Denied_Y_N = 'N';

    ENDIF;

    CASE;

    // IF PAR.User Code Model is equal to blank
    IF PAR.User_Code_Model = *BLANK;

    EXECUTE FUNCTION(RTV Appl. Profile      RT) TYPE(RTVOBJ) FILE(CADTREP)          AC1143177;
    PARAMETER(PAR.User_Profile_Name);
    PARAMETER(PAR.Application_Code);
    PARAMETER(PAR.Company_Number);
    PARAMETER(LCL.Warehouse_Code);
    {
     //?USER: Process Data record

     MOVE *ALL (To: PAR From: DB1);

    }

    // IF *OTHERWISE
    IF *OTHERWISE;

    EXECUTE FUNCTION(RTV Appl. Profile      RT) TYPE(RTVOBJ) FILE(CADTREP)          AC1143177;
    PARAMETER(PAR.User_Code_Model);
    PARAMETER(PAR.Application_Code);
    PARAMETER(PAR.Company_Number);
    PARAMETER(LCL.Warehouse_Code);
    {
     //?USER: Process Data record

     MOVE *ALL (To: PAR From: DB1);

    }

    ENDIF;

    // PAR.Warehouse Code = LCL.Warehouse Code
    PAR.Warehouse_Code = LCL.Warehouse_Code;

    //?Return code when not normal for Application Profile
    CASE;

    // IF PGM.*Return code is *Normal
    IF PGM.*Return_code = *BLANK;

    // PAR.Access Denied (Y/N) = CND.no
    PAR.Access_Denied_Y_N = 'N';

    //?Return code when not normal for Application Profile
    // IF *OTHERWISE
    IF *OTHERWISE;

    // PAR.Access Denied (Y/N) = CND.yes
    PAR.Access_Denied_Y_N = 'Y';

    ENDIF;

    CASE;

    // IF LCL.Company Number is greater than zero
    IF LCL.Company_Number > *ZERO;

    // PAR.Company Number = LCL.Company Number
    PAR.Company_Number = LCL.Company_Number;

    CASE;

    // IF LCL.Warehouse Code is Not Blanks
    IF LCL.Warehouse_Code <> *BLANK;

    EXECUTE FUNCTION(RTV Prod Whse for Co  RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1757887;
    PARAMETER(PAR.Warehouse_Code);
    PARAMETER(LCL.Shipping_Company);
    {
     //?USER: Processing if Data record not found

     MOVE *ALL (To: PAR From: CON);

     //?USER: Process Data record

     CASE;

     // IF DB1.Record Status is Active
     IF DB1.Record_Status = 'A';

     CASE;

     // IF DB1.Production Warehouse Code is Warehouse Code not Blank
     IF DB1.Production_Warehouse_Code <> *BLANK;

     // PAR.Warehouse Code = DB1.Production Warehouse Code
     PAR.Warehouse_Code = DB1.Production_Warehouse_Code;

     QUIT;

     ENDIF;

     ENDIF;

    }

    ENDIF;

    ENDIF;

   }

   // PAR.Company Number = WRK.Company Number
   PAR.Company_Number = WRK.Company_Number;

   // PAR.Access Denied (Y/N) = WRK.Access Denied (Y/N)
   PAR.Access_Denied_Y_N = WRK.Access_Denied_Y_N;

   //?If access denied is no, rtv co. name
   CASE;

   // IF WRK.Access Denied (Y/N) is no
   IF WRK.Access_Denied_Y_N = 'N';

   EXECUTE FUNCTION(RTV Company Name       RT) TYPE(RTVOBJ) FILE(CAABREP)          AC1255767;
   PARAMETER(WRK.Company_Number);
   PARAMETER(PAR.Name);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   ENDIF;

  }

  //?check the entry control field too.  4/28/05 so christa can do.
  EXECUTE FUNCTION(Rtv Unlock Load Authr RT) TYPE(RTVOBJ) FILE(OPC0REP)           AC1736002;
  PARAMETER(JOB.*USER);
  PARAMETER('O/P');
  PARAMETER(PAR.Company_Number);
  PARAMETER(WRK.Unlock_Load_Authority);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF PAR.Access Denied (Y/N) is yes
  IF PAR.Access_Denied_Y_N = 'Y';

  // AND WRK.Unlock Load Authority is Blank
  AND WRK.Unlock_Load_Authority = *BLANK;

  // Send error message - 'User not allowed to  Lock/Unlock Loads.'
  ERROR(USR2468);

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?If load has been shipped, can't unlock. RMC Chg for picked 5/31/06
  CASE;

  // IF PAR.Block Order Flag is Block Order
  IF PAR.Block_Order_Flag = 'B';

  //?  (load contains a block order)
  // Send error message - 'Load &2 contains Block Orders--no update allowed.'
  ERROR(USR2441);
  MSGPARM(PAR.*SFLSEL);
  MSGPARM(PAR.Load_ID);

  //?If load has been shipped, can't unlock. RMC Chg for picked 5/31/06
  // IF PAR.Load Status is Shipped or Invoiced
  IF PAR.Load_Status = 'I'/'S';

  // Send error message - 'Load has been shipped can not unlock it'
  ERROR(USR1272);
  MSGPARM(PAR.Load_Status);

  //?If load has been shipped, can't unlock. RMC Chg for picked 5/31/06
  // IF *OTHERWISE
  IF *OTHERWISE;

  //?**** Determine if Load has been picked, if yes do not allow unlock
  //?**** This function checks OP Order Events & AS Picked Acknowledgment
  CASE;

  // IF PAR.Allow Unlock if Picked St is No
  IF PAR.Allow_Unlock_if_Picked_St = 'N';

  //?Do this one if par is NO. We dont want an UNLOCK if there are XOx
  //?  and it isnt shipping doing it.
  // Call program RTV Load Order Picked  XF.
  CALL PROGRAM(RTV Load Order Picked  XF) ('PDQVXFR');
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Company_Number);
  PARAMETER(WRK.Pick_Status_USR);

  // IF *OTHERWISE
  IF *OTHERWISE;

  EXECUTE FUNCTION(PFS Val Order Picked  RT) TYPE(RTVOBJ) FILE(PPBKCPP)           AC1754282;
  PARAMETER(PAR.Load_ID);
  PARAMETER(WRK.Pick_Status_USR);
  {
   //?USER: Processing if Data record not found

   // PAR.Pick Status USR = CND.Not Picked
   PAR.Pick_Status_USR = 'N';

   //?USER: Process Data record

   // PAR.Pick Status USR = CND.Picked
   PAR.Pick_Status_USR = 'Y';

   QUIT;

  }

  ENDIF;

  //?Allow if picked but not Close Order or Close Truck  5/31/06
  CASE;

  // IF WRK.Pick Status USR is Picked
  IF WRK.Pick_Status_USR = 'Y';

  CASE;

  // IF PAR.Allow Unlock if Picked St is No
  IF PAR.Allow_Unlock_if_Picked_St = 'N';

  // Send error message - 'Unlocking of Load is not allowed for a Load which has been picked.'
  ERROR(USR1999);
  MSGPARM(PAR.Load_Status);

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Call program PFS Val Close Ord/Trk XF.
  CALL PROGRAM(PFS Val Close Ord/Trk XF) ('PPYIXFR');
  PARAMETER(PAR.Load_ID);
  PARAMETER(WRK.Status_Y_or_N);

  CASE;

  // IF WRK.Status - Y or N is yes
  IF WRK.Status_Y_or_N = 'Y';

  // Send error message - 'Unlock Load not allowed for Load with a Closed Order or Closed Truck.'
  ERROR(USR3629);
  MSGPARM(PAR.*SFLSEL);

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Send information message - 'Unlock Load Pending'
  MESSAGE(USR1274 *INFO);

  // PAR.Error Status = CND.no
  PAR.Error_Status = 'N';

  ENDIF;

  ENDIF;

  //?Allow if picked but not Close Order or Close Truck  5/31/06
  // IF *OTHERWISE
  IF *OTHERWISE;

  // Send information message - 'Unlock Load Pending'
  MESSAGE(USR1274 *INFO);

  // PAR.Error Status = CND.no
  PAR.Error_Status = 'N';

  ENDIF;

  ENDIF;

  ENDIF;

 }

}


// Execute function Clr Program Message Q  US.
EXECUTE FUNCTION(Clr Program Message Q  US) TYPE(EXCUSRSRC) ('USGDUFR');
{
 * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
 C                     CALL 'Y2CLMSC'
 C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
 C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
 * RESET FIRST MESSAGE ONLY FLAG.
 C                     MOVEL'Y'       ZAFSMS           ALREADY DEFINED
}


ENDIF;

CASE;

// IF LCL.Error Status is no
IF LCL.Error_Status = 'N';

//?Auto Unlock after validations are passed
CASE;

// IF RCD.Load Status is Lock
IF RCD.Load_Status = 'L';

EXECUTE FUNCTION(UPD Unlock Load Update IF) TYPE(EXCINTFUN)                     AC1454814;
PARAMETER(RCD.Load_ID);
PARAMETER(RCD.Company_Number);
{
 //?Execute internal function

 EXECUTE FUNCTION(CHG Ld Sts,Rated Frts  CH) TYPE(CHGOBJ) FILE(OMFJCPP)          AC1371002;
 PARAMETER(PAR.Load_ID);
 PARAMETER('U');
 PARAMETER(*ZERO);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 EXECUTE FUNCTION(EDT Unlock Load        IF) TYPE(EXCINTFUN)                     AC1419468;
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Company_Number);
 {
  //?Execute internal function

  //?*** Return Plant Code from first Order Header
  EXECUTE FUNCTION(zzV for Accusort Load  RT) TYPE(RTVOBJ) FILE(OMFLCPP)          AC1322485;
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Trans_Contol_AS400_Plant);
  {
   //?USER: Process Data record

   EXECUTE FUNCTION(RTV Trans Control      RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1305919;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(WRK.Trans_Contol_AS400_Plant);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    //?USER: Process Data record

    EXECUTE FUNCTION(RTV Trans Control      RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1428569;
    PARAMETER(DB1.Company_Number);
    PARAMETER(DB1.Order_Number);
    PARAMETER(WRK.Trans_Contol_AS400_Plant);
    {
     //?USER: Process Data record

     CASE;

     // IF DB1.Detail Line Status is Not cancelled
     IF DB1.Detail_Line_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

     EXECUTE FUNCTION(Rtv Desc/Trans Control RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1304130;
     PARAMETER(DB1.Warehouse_Code);
     PARAMETER(WRK.Warehouse_Description);
     PARAMETER(PAR.Trans_Contol_AS400_Plant);
     {
      //?USER: Processing if Data record not found

      MOVE *ALL (To: PAR From: CON);

      //?USER: Process Data record

      MOVE *ALL (To: PAR From: DB1);

     }

     QUIT;

     ENDIF;

    }

    CASE;

    // IF WRK.Trans Contol AS400/Plant is Plant
    IF WRK.Trans_Contol_AS400_Plant = 'P';

    // PAR.Trans Contol AS400/Plant = WRK.Trans Contol AS400/Plant
    PAR.Trans_Contol_AS400_Plant = WRK.Trans_Contol_AS400_Plant;

    QUIT;

    ENDIF;

   }

   CASE;

   // IF WRK.Trans Contol AS400/Plant is Plant
   IF WRK.Trans_Contol_AS400_Plant = 'P';

   // PAR.Trans Contol AS400/Plant = WRK.Trans Contol AS400/Plant
   PAR.Trans_Contol_AS400_Plant = WRK.Trans_Contol_AS400_Plant;

   QUIT;

   ENDIF;

  }

  EXECUTE FUNCTION(RTV System Value Alpha RT) TYPE(RTVOBJ) FILE(CADPREP)          AC1530745;
  PARAMETER('PLTFLRSYS');
  PARAMETER(LCL.Plant_Floor_System_USR);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  EXECUTE FUNCTION(Rtv Active Status     RT) TYPE(RTVOBJ) FILE(PPBUREP)           AC1740339;
  PARAMETER(PAR.Company_Number);
  PARAMETER('LDORDD');
  PARAMETER(LCL.PFS_AccuSort_Active);
  PARAMETER(LCL.PFS_Carlisle_Active);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?UPD:  AccuSort
  CASE;

  // IF LCL.PFS AccuSort Active is Yes
  IF LCL.PFS_AccuSort_Active = 'Y';

  //?Notify Accusort if locked load
  CASE;

  // IF PAR.Trans Contol AS400/Plant is Plant
  IF PAR.Trans_Contol_AS400_Plant = 'P';

  // Call program Zzz Lock/Unlock Box ID XF.
  CALL PROGRAM(Zzz Lock/Unlock Box ID XF) ('PDXFXFR');
  PARAMETER('L');

  // Call program DEL AS Order Hdr/Dtl   XF.
  CALL PROGRAM(DEL AS Order Hdr/Dtl   XF) ('PDQ0XFR');
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Company_Number);

  // Call program Zzz Lock/Unlock Box ID XF.
  CALL PROGRAM(Zzz Lock/Unlock Box ID XF) ('PDXFXFR');
  PARAMETER('U');

  ENDIF;

  ENDIF;

  //?UPD:  Carlisle
  CASE;

  // IF LCL.PFS Carlisle Active is Yes
  IF LCL.PFS_Carlisle_Active = 'Y';

  // Call program PFS Unlock Load/Order XF.
  CALL PROGRAM(PFS Unlock Load/Order XF) ('PPNQXFR');
  PARAMETER(PAR.Load_ID);

  // Call program PFS Lock Load/Order   XF.
  CALL PROGRAM(PFS Lock Load/Order   XF) ('PPNLXFR');
  PARAMETER(PAR.Load_ID);

  ENDIF;

  //?** 09/23/2011 RMC E1607  if load had a whs with edi wso interchange, then
  //?   delete it if Unproc, else change it to "D"elete/and reprocess
  // Call program Exc ChgDel EDI f/UnlckXF.
  CALL PROGRAM(Exc ChgDel EDI f/UnlckXF) ('PBAEXFR');
  PARAMETER(PAR.Load_ID);

 }

 EXECUTE FUNCTION(CHG Clear Rated Frt    RT) TYPE(RTVOBJ) FILE(OMFLCPP)          AC1399763;
 PARAMETER(PAR.Load_ID);
 PARAMETER(*ZERO);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(CHG Recovery Freight   CH) TYPE(CHGOBJ) FILE(OMFLCPP)          AC1292118;
  PARAMETER(DB1.Load_ID);
  PARAMETER(DB1.Stop_Drop_Sequence_Number);
  PARAMETER(DB1.Miles_to_next_stop);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  EXECUTE FUNCTION(CHG Clear Rated Frt    RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1399729;
  PARAMETER(DB1.Load_ID);
  PARAMETER(DB1.Order_Number);
  {
   //?USER: Initialize routine

   //?05/12/04 SLM PKTR01 Multi-Company - Function was changed
   //?                                    to remove Company RST or Pos
   //?USER: Process Data record

   EXECUTE FUNCTION(CHG Rated Freight      CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1293468;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(*ZERO);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
    PARAMETER(DB1.Job_Time);
    PARAMETER(DB1.User_Id);
    PARAMETER(DB1.Job_Name);
    PARAMETER(DB1.Job_Date);
    {
     //?Execute internal function

     // PAR.Job Time = JOB.*Job time
     PAR.Job_Time = JOB.*Job_time;

     // PAR.User Id = JOB.*USER
     PAR.User_Id = JOB.*USER;

     // PAR.Job Name = JOB.*PROGRAM
     PAR.Job_Name = JOB.*PROGRAM;

     // PAR.Job Date = JOB.*Job date
     PAR.Job_Date = JOB.*Job_date;

    }

    // Call program TRG Order Hdr CHG Trig XT.
    CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
    PARAMETER(DB1.Company_Number);
    PARAMETER(DB1.Order_Number);
    PARAMETER(DB1.Order_Type_Sales);
    PARAMETER(DB1.AR_Customer_Number);
    PARAMETER(DB1.Ship_To_Customer);
    PARAMETER(DB1.Ship_To_Name);
    PARAMETER(DB1.Ship_To_Address_Line_1);
    PARAMETER(DB1.Ship_To_Address_Line_2);
    PARAMETER(DB1.Ship_To_Address_Line_3);
    PARAMETER(DB1.Ship_To_City);
    PARAMETER(DB1.Ship_To_State_Code);
    PARAMETER(DB1.Ship_To_Zip_Postal_Code);
    PARAMETER(DB1.Bill_to_Customer);
    PARAMETER(DB1.Bill_to_Name);
    PARAMETER(DB1.Bill_to_Address_Line_1);
    PARAMETER(DB1.Bill_to_Address_Line_2);
    PARAMETER(DB1.Bill_to_Address_Line_3);
    PARAMETER(DB1.Bill_to_City);
    PARAMETER(DB1.Bill_to_State_Code);
    PARAMETER(DB1.Bill_to_Zip_Postal_Code);
    PARAMETER(DB1.Customer_Purchase_Order_#);
    PARAMETER(DB1.Order_Date);
    PARAMETER(DB1.Requested_Ship_Date);
    PARAMETER(DB1.Actual_Shipped_Date);
    PARAMETER(DB1.Cancel_Date);
    PARAMETER(DB1.Terms_Code);
    PARAMETER(DB1.Special_Instructions);
    PARAMETER(DB1.Special_Instructions_2);
    PARAMETER(DB1.Carrier_Code);
    PARAMETER(DB1.Comment_Print_Acknowledge);
    PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
    PARAMETER(DB1.Comment_Print_Pick_Slip);
    PARAMETER(DB1.Comment_Print_Ship_Doc);
    PARAMETER(DB1.Reason_Code);
    PARAMETER(DB1.Order_in_Use);
    PARAMETER(DB1.Header_Status);
    PARAMETER(DB1.Header_Status_Last);
    PARAMETER(DB1.Order_Type_Print_Status);
    PARAMETER(DB1.Scheduled_Ship_Date);
    PARAMETER(DB1.User_Original_Entry);
    PARAMETER(DB1.Date_of_Original_Entry);
    PARAMETER(DB1.Order_Value_Total);
    PARAMETER(DB1.Order_Weight_Total);
    PARAMETER(DB1.Credit_Hold);
    PARAMETER(DB1.Production_Hold);
    PARAMETER(DB1.New_Customer_Hold);
    PARAMETER(DB1.Requested_Delivery_Date);
    PARAMETER(DB1.Requested_Delivery_Time);
    PARAMETER(DB1.Accounts_Receiv_Ent_1);
    PARAMETER(DB1.Accounts_Receiv_Ent_2);
    PARAMETER(DB1.Load_ID);
    PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
    PARAMETER(DB1.Rated_Freight);
    PARAMETER(DB1.LTL_Flag);
    PARAMETER(DB1.Price_Audit);
    PARAMETER(DB1.Price_Status);
    PARAMETER(DB1.Shipping_Method);
    PARAMETER(DB1.Export_Status);
    PARAMETER(DB1.Palletize);
    PARAMETER(DB1.Shrink_Wrap);
    PARAMETER(DB1.Slip_Sheet);
    PARAMETER(DB1.Age_Code);
    PARAMETER(DB1.Reefer_Temperature);
    PARAMETER(DB1.Load_Type);
    PARAMETER(DB1.Attach_to_Invoice_Number);
    PARAMETER(DB1.Load_Plan_Order);
    PARAMETER(DB1.Print_Pick_Slip);
    PARAMETER(DB1.Resell_Reference_Number);
    PARAMETER(DB1.Special_Comment_1);
    PARAMETER(DB1.Special_Comment_2);
    PARAMETER(DB1.Affect_Auto_Accruals);
    PARAMETER(DB1.Sales_Route_Code);
    PARAMETER(DB1.Manager_Level_Code);
    PARAMETER(DB1.VP_Level_Code);
    PARAMETER(DB1.Attach_to_Order_Number);
    PARAMETER(DB1.Reason_for_Price_Audit);
    PARAMETER(DB1.Invoice_Number);
    PARAMETER(DB1.Invoice_Suffix);
    PARAMETER(DB1.Invoice_Date);
    PARAMETER(DB1.Event_Code);
    PARAMETER(DB1.Trans_Contol_AS400_Plant);
    PARAMETER(DB1.Modified_Flag);
    PARAMETER(DB1.A_R_order_Value_Total);
    PARAMETER(DB1.Billing_Activity_Type);
    PARAMETER(DB1.Block_Order_Flag);
    PARAMETER(DB1.Order_Certification_Flag);
    PARAMETER(DB1.Invoice_Order_Value_Tot);
    PARAMETER(DB1.Process_Sts_for_3C);
    PARAMETER(DB1.Order_Conf_Fax_Sts);
    PARAMETER(DB1.Manifest_Fax_Sts);
    PARAMETER(DB1.Invoice_Fax_Sts);
    PARAMETER(DB1.Transfer_in_Storage_Ind);
    PARAMETER(DB1.Email_Cust_On_Order_Ship);
    PARAMETER(DB1.Order_Emailed);
    PARAMETER(DB1.Export_Docs_Go_w_Driver);
    PARAMETER(DB1.Shipping_Temp_Code_C_F);
    PARAMETER(DB1.Broker_Order_Status);
    PARAMETER(DB1.Air_Freight_Order);
    PARAMETER(DB1.Order_Requires_Review);
    PARAMETER(DB1.OH_Load_Plan_Ready);
    PARAMETER(DB1.Export_USDA_Approved);
    PARAMETER(DB1.HPB_Ship_to_Warehouse);
    PARAMETER(DB1.OH_TF_Exempt_Code);
    PARAMETER(DB1.OH_Appt_Confirmation_Dt);
    PARAMETER(DB1.JPN_Invoice_Issuance_Date);
    PARAMETER(DB1.Load_Actual_Shipped_Date);
    PARAMETER(DB1.Load_BOL_Complete_Date);
    PARAMETER(DB1.Load_Truck_Departure_Date);
    PARAMETER(DB1.Maximum_Gross_Weight);
    PARAMETER(DB1.Time_of_Original_Entry);
    PARAMETER(DB1.OH_Appt_Confirmation_Tm);
    PARAMETER(DB1.Load_BOL_Complete_Time);
    PARAMETER(DB1.Load_Truck_Departure_Time);
    PARAMETER(DB1.Act_Frt_Reference_Amount);
    PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
    PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
    PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
    PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
    PARAMETER(DB1.Claim_Number);
    PARAMETER(DB1.EDI_Status_1);
    PARAMETER(DB1.EDI_Status_2);
    PARAMETER(DB1.EDI_Status_3);
    PARAMETER(DB1.Job_Time);
    PARAMETER(DB1.User_Id);
    PARAMETER(DB1.Job_Name);
    PARAMETER(DB1.Job_Date);

   }

   //?05/13/04 slm Multi-Company - Order Header lv remove co must use db1
   //?                              was using the par replace with db1
   EXECUTE FUNCTION(UPD Rated Freight      RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1396132;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(DB1.Order_Weight_Total);
   PARAMETER(*ZERO);
   {
    //?USER: Initialize routine

    //?par.@rated freight is the sum of all the detail rated frt, for adjusting
    // PAR.@Rated Freight = CON.*ZERO
    PAR.@Rated_Freight = *ZERO;

    //?par.usr process status is used to indicate if there are detail present
    // PAR.USR Process status = CND.no
    PAR.USR_Process_status = 'N';

    //?USER: Process Data record

    CASE;

    // IF DB1.Detail Line Status is Cancelled
    IF DB1.Detail_Line_Status = 'X';

    EXECUTE FUNCTION(CHG Rated Freight      CH) TYPE(CHGOBJ) FILE(OPBGWKP)          AC1400066;
    PARAMETER(DB1.Company_Number);
    PARAMETER(DB1.Order_Number);
    PARAMETER(DB1.Order_Sequence_Number);
    PARAMETER(DB1.Order_Secondary_Line_Seq);
    PARAMETER(*ZERO);
    {
     //?USER: Processing before Data update

     EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
     PARAMETER(DB1.Job_Time);
     PARAMETER(DB1.User_Id);
     PARAMETER(DB1.Job_Name);
     PARAMETER(DB1.Job_Date);
     {
      //?Execute internal function

      // PAR.Job Time = JOB.*Job time
      PAR.Job_Time = JOB.*Job_time;

      // PAR.User Id = JOB.*USER
      PAR.User_Id = JOB.*USER;

      // PAR.Job Name = JOB.*JOB
      PAR.Job_Name = JOB.*JOB;

      // PAR.Job Date = JOB.*Job date
      PAR.Job_Date = JOB.*Job_date;

     }

    }

    // IF *OTHERWISE
    IF *OTHERWISE;

    // PAR.USR Process status = CND.yes
    PAR.USR_Process_status = 'Y';

    CASE;

    // IF PAR.Order Weight Total is Equal to zero
    IF PAR.Order_Weight_Total = *ZERO;

    // OR PAR.Total Rated Freight is Zero
    OR PAR.Total_Rated_Freight = *ZERO;

    // PAR.Rated Freight = CON.*ZERO
    PAR.Rated_Freight = *ZERO;

    // IF *OTHERWISE
    IF *OTHERWISE;

    CASE;

    // IF DB1.Detail Line Status is Confirmed & Complete
    IF DB1.Detail_Line_Status = 'C'/'R';

    // Synon (17,9) work field =       * Compute Dtl Rated Freight
    PGM.*Synon_179_work_field = ( DB1.Weight_Shipped_Total / PAR.Order_Weight_Total 'H' )
    * PAR.Total_Rated_Freight 'H';

    // IF *OTHERWISE
    IF *OTHERWISE;

    // Synon (17,9) work field =       * Compute Dtl Rated Freight
    PGM.*Synon_179_work_field = ( ( DB1.Quantity_Ordered * DB1.Unit_Weight_Ordered_U_M 'H' )
    / PAR.Order_Weight_Total 'H' ) * PAR.Total_Rated_Freight 'H';

    ENDIF;

    // PAR.Rated Freight = PGM.*Synon (17,9) work field * CON.1 *Rounded
    PAR.Rated_Freight = PGM.*Synon_179_work_field * 1 'H';

    ENDIF;

    EXECUTE FUNCTION(CHG Rated Freight      CH) TYPE(CHGOBJ) FILE(OPBGWKP)          AC1400066;
    PARAMETER(DB1.Company_Number);
    PARAMETER(DB1.Order_Number);
    PARAMETER(DB1.Order_Sequence_Number);
    PARAMETER(DB1.Order_Secondary_Line_Seq);
    PARAMETER(PAR.Rated_Freight);
    {
     //?USER: Processing before Data update

     EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
     PARAMETER(DB1.Job_Time);
     PARAMETER(DB1.User_Id);
     PARAMETER(DB1.Job_Name);
     PARAMETER(DB1.Job_Date);
     {
      //?Execute internal function

      // PAR.Job Time = JOB.*Job time
      PAR.Job_Time = JOB.*Job_time;

      // PAR.User Id = JOB.*USER
      PAR.User_Id = JOB.*USER;

      // PAR.Job Name = JOB.*JOB
      PAR.Job_Name = JOB.*JOB;

      // PAR.Job Date = JOB.*Job date
      PAR.Job_Date = JOB.*Job_date;

     }

    }

    // PAR.@Rated Freight = PAR.@Rated Freight + PAR.Rated Freight
    PAR.@Rated_Freight = PAR.@Rated_Freight + PAR.Rated_Freight;

    // PAR.Order Sequence Number = DB1.Order Sequence Number
    PAR.Order_Sequence_Number = DB1.Order_Sequence_Number;

    // PAR.Order Secondary Line Seq = DB1.Order Secondary Line Seq
    PAR.Order_Secondary_Line_Seq = DB1.Order_Secondary_Line_Seq;

    ENDIF;

    //?USER: Exit processing

    //?Adjust totals
    CASE;

    // IF PAR.@Rated Freight NE PAR.Total Rated Freight
    IF PAR.@Rated_Freight <> PAR.Total_Rated_Freight;

    // AND PAR.USR Process status is yes
    AND PAR.USR_Process_status = 'Y';

    // WRK.USR Adjustment Amount 1 = PAR.Total Rated Freight - PAR.@Rated Freight
    WRK.USR_Adjustment_Amount_1 = PAR.Total_Rated_Freight - PAR.@Rated_Freight;

    // PAR.Rated Freight = PAR.Rated Freight + WRK.USR Adjustment Amount 1
    PAR.Rated_Freight = PAR.Rated_Freight + WRK.USR_Adjustment_Amount_1;

    //?Update last detail line processed
    EXECUTE FUNCTION(CHG Rated Freight      CH) TYPE(CHGOBJ) FILE(OPBGWKP)          AC1400066;
    PARAMETER(PAR.Company_Number);
    PARAMETER(PAR.Order_Number);
    PARAMETER(PAR.Order_Sequence_Number);
    PARAMETER(PAR.Order_Secondary_Line_Seq);
    PARAMETER(PAR.Rated_Freight);
    {
     //?USER: Processing before Data update

     EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
     PARAMETER(DB1.Job_Time);
     PARAMETER(DB1.User_Id);
     PARAMETER(DB1.Job_Name);
     PARAMETER(DB1.Job_Date);
     {
      //?Execute internal function

      // PAR.Job Time = JOB.*Job time
      PAR.Job_Time = JOB.*Job_time;

      // PAR.User Id = JOB.*USER
      PAR.User_Id = JOB.*USER;

      // PAR.Job Name = JOB.*JOB
      PAR.Job_Name = JOB.*JOB;

      // PAR.Job Date = JOB.*Job date
      PAR.Job_Date = JOB.*Job_date;

     }

    }

    ENDIF;

   }

  }

 }

 // Execute function Clr Program Message Q  US.
 EXECUTE FUNCTION(Clr Program Message Q  US) TYPE(EXCUSRSRC) ('USGDUFR');
 {
  * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
  C                     CALL 'Y2CLMSC'
  C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
  C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
  * RESET FIRST MESSAGE ONLY FLAG.
  C                     MOVEL'Y'       ZAFSMS           ALREADY DEFINED
 }

}


// WRK.Load Change Type = CND.Unlock Load
WRK.Load_Change_Type = 'UNLOCK';

// WRK.Department Control Code = CND.Traffic Dept
WRK.Department_Control_Code = 'TRF';

// Call program CRT Load/Order Chg Log XF.
CALL PROGRAM(CRT Load/Order Chg Log XF) ('PDADXFR');
PARAMETER(RCD.Load_ID);
PARAMETER(*ZERO);
PARAMETER(WRK.Load_Change_Type);
PARAMETER(WRK.Department_Control_Code);
PARAMETER(RCD.Load_Status);
PARAMETER('U');
PARAMETER(JOB.*USER);
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Carrier_Code);
PARAMETER(RCD.Company_Number);
PARAMETER(*ZERO);

ENDIF;

ENDIF;

ENDIF;

ENDIF;

//?allow edit Age Information if Error Sts = N
CASE;

// IF LCL.Error Status is no
IF LCL.Error_Status = 'N';

EXECUTE FUNCTION(CHG Order in Use       CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1316259;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER('Y');
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

 // Call program TRG Order Hdr CHG Trig XT.
 CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Type_Sales);
 PARAMETER(DB1.AR_Customer_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.Ship_To_Name);
 PARAMETER(DB1.Ship_To_Address_Line_1);
 PARAMETER(DB1.Ship_To_Address_Line_2);
 PARAMETER(DB1.Ship_To_Address_Line_3);
 PARAMETER(DB1.Ship_To_City);
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(DB1.Ship_To_Zip_Postal_Code);
 PARAMETER(DB1.Bill_to_Customer);
 PARAMETER(DB1.Bill_to_Name);
 PARAMETER(DB1.Bill_to_Address_Line_1);
 PARAMETER(DB1.Bill_to_Address_Line_2);
 PARAMETER(DB1.Bill_to_Address_Line_3);
 PARAMETER(DB1.Bill_to_City);
 PARAMETER(DB1.Bill_to_State_Code);
 PARAMETER(DB1.Bill_to_Zip_Postal_Code);
 PARAMETER(DB1.Customer_Purchase_Order_#);
 PARAMETER(DB1.Order_Date);
 PARAMETER(DB1.Requested_Ship_Date);
 PARAMETER(DB1.Actual_Shipped_Date);
 PARAMETER(DB1.Cancel_Date);
 PARAMETER(DB1.Terms_Code);
 PARAMETER(DB1.Special_Instructions);
 PARAMETER(DB1.Special_Instructions_2);
 PARAMETER(DB1.Carrier_Code);
 PARAMETER(DB1.Comment_Print_Acknowledge);
 PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
 PARAMETER(DB1.Comment_Print_Pick_Slip);
 PARAMETER(DB1.Comment_Print_Ship_Doc);
 PARAMETER(DB1.Reason_Code);
 PARAMETER(DB1.Order_in_Use);
 PARAMETER(DB1.Header_Status);
 PARAMETER(DB1.Header_Status_Last);
 PARAMETER(DB1.Order_Type_Print_Status);
 PARAMETER(DB1.Scheduled_Ship_Date);
 PARAMETER(DB1.User_Original_Entry);
 PARAMETER(DB1.Date_of_Original_Entry);
 PARAMETER(DB1.Order_Value_Total);
 PARAMETER(DB1.Order_Weight_Total);
 PARAMETER(DB1.Credit_Hold);
 PARAMETER(DB1.Production_Hold);
 PARAMETER(DB1.New_Customer_Hold);
 PARAMETER(DB1.Requested_Delivery_Date);
 PARAMETER(DB1.Requested_Delivery_Time);
 PARAMETER(DB1.Accounts_Receiv_Ent_1);
 PARAMETER(DB1.Accounts_Receiv_Ent_2);
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
 PARAMETER(DB1.Rated_Freight);
 PARAMETER(DB1.LTL_Flag);
 PARAMETER(DB1.Price_Audit);
 PARAMETER(DB1.Price_Status);
 PARAMETER(DB1.Shipping_Method);
 PARAMETER(DB1.Export_Status);
 PARAMETER(DB1.Palletize);
 PARAMETER(DB1.Shrink_Wrap);
 PARAMETER(DB1.Slip_Sheet);
 PARAMETER(DB1.Age_Code);
 PARAMETER(DB1.Reefer_Temperature);
 PARAMETER(DB1.Load_Type);
 PARAMETER(DB1.Attach_to_Invoice_Number);
 PARAMETER(DB1.Load_Plan_Order);
 PARAMETER(DB1.Print_Pick_Slip);
 PARAMETER(DB1.Resell_Reference_Number);
 PARAMETER(DB1.Special_Comment_1);
 PARAMETER(DB1.Special_Comment_2);
 PARAMETER(DB1.Affect_Auto_Accruals);
 PARAMETER(DB1.Sales_Route_Code);
 PARAMETER(DB1.Manager_Level_Code);
 PARAMETER(DB1.VP_Level_Code);
 PARAMETER(DB1.Attach_to_Order_Number);
 PARAMETER(DB1.Reason_for_Price_Audit);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Invoice_Date);
 PARAMETER(DB1.Event_Code);
 PARAMETER(DB1.Trans_Contol_AS400_Plant);
 PARAMETER(DB1.Modified_Flag);
 PARAMETER(DB1.A_R_order_Value_Total);
 PARAMETER(DB1.Billing_Activity_Type);
 PARAMETER(DB1.Block_Order_Flag);
 PARAMETER(DB1.Order_Certification_Flag);
 PARAMETER(DB1.Invoice_Order_Value_Tot);
 PARAMETER(DB1.Process_Sts_for_3C);
 PARAMETER(DB1.Order_Conf_Fax_Sts);
 PARAMETER(DB1.Manifest_Fax_Sts);
 PARAMETER(DB1.Invoice_Fax_Sts);
 PARAMETER(DB1.Transfer_in_Storage_Ind);
 PARAMETER(DB1.Email_Cust_On_Order_Ship);
 PARAMETER(DB1.Order_Emailed);
 PARAMETER(DB1.Export_Docs_Go_w_Driver);
 PARAMETER(DB1.Shipping_Temp_Code_C_F);
 PARAMETER(DB1.Broker_Order_Status);
 PARAMETER(DB1.Air_Freight_Order);
 PARAMETER(DB1.Order_Requires_Review);
 PARAMETER(DB1.OH_Load_Plan_Ready);
 PARAMETER(DB1.Export_USDA_Approved);
 PARAMETER(DB1.HPB_Ship_to_Warehouse);
 PARAMETER(DB1.OH_TF_Exempt_Code);
 PARAMETER(DB1.OH_Appt_Confirmation_Dt);
 PARAMETER(DB1.JPN_Invoice_Issuance_Date);
 PARAMETER(DB1.Load_Actual_Shipped_Date);
 PARAMETER(DB1.Load_BOL_Complete_Date);
 PARAMETER(DB1.Load_Truck_Departure_Date);
 PARAMETER(DB1.Maximum_Gross_Weight);
 PARAMETER(DB1.Time_of_Original_Entry);
 PARAMETER(DB1.OH_Appt_Confirmation_Tm);
 PARAMETER(DB1.Load_BOL_Complete_Time);
 PARAMETER(DB1.Load_Truck_Departure_Time);
 PARAMETER(DB1.Act_Frt_Reference_Amount);
 PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
 PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
 PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
 PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
 PARAMETER(DB1.Claim_Number);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);

}


// Call program Edt Age Information   E1.
CALL PROGRAM(Edt Age Information   E1) ('PNO3E1R');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER('Y');

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

EXECUTE FUNCTION(CHG Order in Use       CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1316259;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER('N');
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

 // Call program TRG Order Hdr CHG Trig XT.
 CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Type_Sales);
 PARAMETER(DB1.AR_Customer_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.Ship_To_Name);
 PARAMETER(DB1.Ship_To_Address_Line_1);
 PARAMETER(DB1.Ship_To_Address_Line_2);
 PARAMETER(DB1.Ship_To_Address_Line_3);
 PARAMETER(DB1.Ship_To_City);
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(DB1.Ship_To_Zip_Postal_Code);
 PARAMETER(DB1.Bill_to_Customer);
 PARAMETER(DB1.Bill_to_Name);
 PARAMETER(DB1.Bill_to_Address_Line_1);
 PARAMETER(DB1.Bill_to_Address_Line_2);
 PARAMETER(DB1.Bill_to_Address_Line_3);
 PARAMETER(DB1.Bill_to_City);
 PARAMETER(DB1.Bill_to_State_Code);
 PARAMETER(DB1.Bill_to_Zip_Postal_Code);
 PARAMETER(DB1.Customer_Purchase_Order_#);
 PARAMETER(DB1.Order_Date);
 PARAMETER(DB1.Requested_Ship_Date);
 PARAMETER(DB1.Actual_Shipped_Date);
 PARAMETER(DB1.Cancel_Date);
 PARAMETER(DB1.Terms_Code);
 PARAMETER(DB1.Special_Instructions);
 PARAMETER(DB1.Special_Instructions_2);
 PARAMETER(DB1.Carrier_Code);
 PARAMETER(DB1.Comment_Print_Acknowledge);
 PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
 PARAMETER(DB1.Comment_Print_Pick_Slip);
 PARAMETER(DB1.Comment_Print_Ship_Doc);
 PARAMETER(DB1.Reason_Code);
 PARAMETER(DB1.Order_in_Use);
 PARAMETER(DB1.Header_Status);
 PARAMETER(DB1.Header_Status_Last);
 PARAMETER(DB1.Order_Type_Print_Status);
 PARAMETER(DB1.Scheduled_Ship_Date);
 PARAMETER(DB1.User_Original_Entry);
 PARAMETER(DB1.Date_of_Original_Entry);
 PARAMETER(DB1.Order_Value_Total);
 PARAMETER(DB1.Order_Weight_Total);
 PARAMETER(DB1.Credit_Hold);
 PARAMETER(DB1.Production_Hold);
 PARAMETER(DB1.New_Customer_Hold);
 PARAMETER(DB1.Requested_Delivery_Date);
 PARAMETER(DB1.Requested_Delivery_Time);
 PARAMETER(DB1.Accounts_Receiv_Ent_1);
 PARAMETER(DB1.Accounts_Receiv_Ent_2);
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
 PARAMETER(DB1.Rated_Freight);
 PARAMETER(DB1.LTL_Flag);
 PARAMETER(DB1.Price_Audit);
 PARAMETER(DB1.Price_Status);
 PARAMETER(DB1.Shipping_Method);
 PARAMETER(DB1.Export_Status);
 PARAMETER(DB1.Palletize);
 PARAMETER(DB1.Shrink_Wrap);
 PARAMETER(DB1.Slip_Sheet);
 PARAMETER(DB1.Age_Code);
 PARAMETER(DB1.Reefer_Temperature);
 PARAMETER(DB1.Load_Type);
 PARAMETER(DB1.Attach_to_Invoice_Number);
 PARAMETER(DB1.Load_Plan_Order);
 PARAMETER(DB1.Print_Pick_Slip);
 PARAMETER(DB1.Resell_Reference_Number);
 PARAMETER(DB1.Special_Comment_1);
 PARAMETER(DB1.Special_Comment_2);
 PARAMETER(DB1.Affect_Auto_Accruals);
 PARAMETER(DB1.Sales_Route_Code);
 PARAMETER(DB1.Manager_Level_Code);
 PARAMETER(DB1.VP_Level_Code);
 PARAMETER(DB1.Attach_to_Order_Number);
 PARAMETER(DB1.Reason_for_Price_Audit);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Invoice_Date);
 PARAMETER(DB1.Event_Code);
 PARAMETER(DB1.Trans_Contol_AS400_Plant);
 PARAMETER(DB1.Modified_Flag);
 PARAMETER(DB1.A_R_order_Value_Total);
 PARAMETER(DB1.Billing_Activity_Type);
 PARAMETER(DB1.Block_Order_Flag);
 PARAMETER(DB1.Order_Certification_Flag);
 PARAMETER(DB1.Invoice_Order_Value_Tot);
 PARAMETER(DB1.Process_Sts_for_3C);
 PARAMETER(DB1.Order_Conf_Fax_Sts);
 PARAMETER(DB1.Manifest_Fax_Sts);
 PARAMETER(DB1.Invoice_Fax_Sts);
 PARAMETER(DB1.Transfer_in_Storage_Ind);
 PARAMETER(DB1.Email_Cust_On_Order_Ship);
 PARAMETER(DB1.Order_Emailed);
 PARAMETER(DB1.Export_Docs_Go_w_Driver);
 PARAMETER(DB1.Shipping_Temp_Code_C_F);
 PARAMETER(DB1.Broker_Order_Status);
 PARAMETER(DB1.Air_Freight_Order);
 PARAMETER(DB1.Order_Requires_Review);
 PARAMETER(DB1.OH_Load_Plan_Ready);
 PARAMETER(DB1.Export_USDA_Approved);
 PARAMETER(DB1.HPB_Ship_to_Warehouse);
 PARAMETER(DB1.OH_TF_Exempt_Code);
 PARAMETER(DB1.OH_Appt_Confirmation_Dt);
 PARAMETER(DB1.JPN_Invoice_Issuance_Date);
 PARAMETER(DB1.Load_Actual_Shipped_Date);
 PARAMETER(DB1.Load_BOL_Complete_Date);
 PARAMETER(DB1.Load_Truck_Departure_Date);
 PARAMETER(DB1.Maximum_Gross_Weight);
 PARAMETER(DB1.Time_of_Original_Entry);
 PARAMETER(DB1.OH_Appt_Confirmation_Tm);
 PARAMETER(DB1.Load_BOL_Complete_Time);
 PARAMETER(DB1.Load_Truck_Departure_Time);
 PARAMETER(DB1.Act_Frt_Reference_Amount);
 PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
 PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
 PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
 PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
 PARAMETER(DB1.Claim_Number);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);

}


//?*
// LCL.*Reload subfile = CND.*YES
LCL.*Reload_subfile = 'Y';

// LCL.Post Flag USR = CND.Yes
LCL.Post_Flag_USR = 'Y';

ENDIF;

ENDIF;

ENDDO;

ENDIF;

//?19=Deallocate  FP1054 - new option
CASE;

// IF RCD.*SFLSEL is Option 19
IF RCD.*SFLSEL = '19';

// Send status message - 'Processing...'
MESSAGE(USR2303 *STATUS);

//?Deallocate
// LCL.Quantity Ordered = CON.*ZERO
LCL.Quantity_Ordered = *ZERO;

// LCL.Weight Ordered = CON.*ZERO
LCL.Weight_Ordered = *ZERO;

// LCL.Quantity Scheduled = RCD.Quantity Scheduled
LCL.Quantity_Scheduled = RCD.Quantity_Scheduled;

// LCL.Weight Scheduled = RCD.Weight Scheduled
LCL.Weight_Scheduled = RCD.Weight_Scheduled;

// Call program UPD Avail-To-Sell  ORD XF.
CALL PROGRAM(UPD Avail-To-Sell  ORD XF) ('PDQNXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(RCD.Item_Code);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.Requested_Ship_Date);
PARAMETER(LCL.Quantity_Ordered);
PARAMETER(LCL.Weight_Ordered);
PARAMETER(LCL.Quantity_Scheduled);
PARAMETER(LCL.Weight_Scheduled);
PARAMETER('OD');
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Item_Age_Days);
PARAMETER(RCD.Production_Ovr_AgeDte_Fr);
PARAMETER(RCD.Production_Ovr_AgeDte_To);

EXECUTE FUNCTION(Chg Qty/Wgt Scheduled CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC1425232;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(LCL.Quantity_Scheduled);
PARAMETER(LCL.Weight_Scheduled);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


EXECUTE FUNCTION(CHG Released by User  CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC1920658;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER('N');
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*JOB
  PAR.Job_Name = JOB.*JOB;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


//?* FP1054 Create rcd * DLCORD
// Call program CRT Load/Order Chg Log XF.
CALL PROGRAM(CRT Load/Order Chg Log XF) ('PDADXFR');
PARAMETER(RCD.Load_ID);
PARAMETER(*ZERO);
PARAMETER('DLCORD');
PARAMETER('SLS');
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(JOB.*USER);
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Carrier_Code);
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);

//?* FP1054 Hold order * HLDORD
// LCL.Header Status Last = RCD.Header Status
LCL.Header_Status_Last = RCD.Header_Status;

// RCD.Header Status = CND.Hold
RCD.Header_Status = 'H';

// LCL.USR Production Hold = RCD.Production Hold
LCL.USR_Production_Hold = RCD.Production_Hold;

EXECUTE FUNCTION(CHG Prd Hld, Sts,Rsn   CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1342647;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Reason_Code);
PARAMETER(RCD.Header_Status);
PARAMETER(LCL.Header_Status_Last);
PARAMETER('Y');
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*PROGRAM
  PAR.Job_Name = JOB.*PROGRAM;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

 // Call program TRG Order Hdr CHG Trig XT.
 CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Type_Sales);
 PARAMETER(DB1.AR_Customer_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.Ship_To_Name);
 PARAMETER(DB1.Ship_To_Address_Line_1);
 PARAMETER(DB1.Ship_To_Address_Line_2);
 PARAMETER(DB1.Ship_To_Address_Line_3);
 PARAMETER(DB1.Ship_To_City);
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(DB1.Ship_To_Zip_Postal_Code);
 PARAMETER(DB1.Bill_to_Customer);
 PARAMETER(DB1.Bill_to_Name);
 PARAMETER(DB1.Bill_to_Address_Line_1);
 PARAMETER(DB1.Bill_to_Address_Line_2);
 PARAMETER(DB1.Bill_to_Address_Line_3);
 PARAMETER(DB1.Bill_to_City);
 PARAMETER(DB1.Bill_to_State_Code);
 PARAMETER(DB1.Bill_to_Zip_Postal_Code);
 PARAMETER(DB1.Customer_Purchase_Order_#);
 PARAMETER(DB1.Order_Date);
 PARAMETER(DB1.Requested_Ship_Date);
 PARAMETER(DB1.Actual_Shipped_Date);
 PARAMETER(DB1.Cancel_Date);
 PARAMETER(DB1.Terms_Code);
 PARAMETER(DB1.Special_Instructions);
 PARAMETER(DB1.Special_Instructions_2);
 PARAMETER(DB1.Carrier_Code);
 PARAMETER(DB1.Comment_Print_Acknowledge);
 PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
 PARAMETER(DB1.Comment_Print_Pick_Slip);
 PARAMETER(DB1.Comment_Print_Ship_Doc);
 PARAMETER(DB1.Reason_Code);
 PARAMETER(DB1.Order_in_Use);
 PARAMETER(DB1.Header_Status);
 PARAMETER(DB1.Header_Status_Last);
 PARAMETER(DB1.Order_Type_Print_Status);
 PARAMETER(DB1.Scheduled_Ship_Date);
 PARAMETER(DB1.User_Original_Entry);
 PARAMETER(DB1.Date_of_Original_Entry);
 PARAMETER(DB1.Order_Value_Total);
 PARAMETER(DB1.Order_Weight_Total);
 PARAMETER(DB1.Credit_Hold);
 PARAMETER(DB1.Production_Hold);
 PARAMETER(DB1.New_Customer_Hold);
 PARAMETER(DB1.Requested_Delivery_Date);
 PARAMETER(DB1.Requested_Delivery_Time);
 PARAMETER(DB1.Accounts_Receiv_Ent_1);
 PARAMETER(DB1.Accounts_Receiv_Ent_2);
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
 PARAMETER(DB1.Rated_Freight);
 PARAMETER(DB1.LTL_Flag);
 PARAMETER(DB1.Price_Audit);
 PARAMETER(DB1.Price_Status);
 PARAMETER(DB1.Shipping_Method);
 PARAMETER(DB1.Export_Status);
 PARAMETER(DB1.Palletize);
 PARAMETER(DB1.Shrink_Wrap);
 PARAMETER(DB1.Slip_Sheet);
 PARAMETER(DB1.Age_Code);
 PARAMETER(DB1.Reefer_Temperature);
 PARAMETER(DB1.Load_Type);
 PARAMETER(DB1.Attach_to_Invoice_Number);
 PARAMETER(DB1.Load_Plan_Order);
 PARAMETER(DB1.Print_Pick_Slip);
 PARAMETER(DB1.Resell_Reference_Number);
 PARAMETER(DB1.Special_Comment_1);
 PARAMETER(DB1.Special_Comment_2);
 PARAMETER(DB1.Affect_Auto_Accruals);
 PARAMETER(DB1.Sales_Route_Code);
 PARAMETER(DB1.Manager_Level_Code);
 PARAMETER(DB1.VP_Level_Code);
 PARAMETER(DB1.Attach_to_Order_Number);
 PARAMETER(DB1.Reason_for_Price_Audit);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Invoice_Date);
 PARAMETER(DB1.Event_Code);
 PARAMETER(DB1.Trans_Contol_AS400_Plant);
 PARAMETER(DB1.Modified_Flag);
 PARAMETER(DB1.A_R_order_Value_Total);
 PARAMETER(DB1.Billing_Activity_Type);
 PARAMETER(DB1.Block_Order_Flag);
 PARAMETER(DB1.Order_Certification_Flag);
 PARAMETER(DB1.Invoice_Order_Value_Tot);
 PARAMETER(DB1.Process_Sts_for_3C);
 PARAMETER(DB1.Order_Conf_Fax_Sts);
 PARAMETER(DB1.Manifest_Fax_Sts);
 PARAMETER(DB1.Invoice_Fax_Sts);
 PARAMETER(DB1.Transfer_in_Storage_Ind);
 PARAMETER(DB1.Email_Cust_On_Order_Ship);
 PARAMETER(DB1.Order_Emailed);
 PARAMETER(DB1.Export_Docs_Go_w_Driver);
 PARAMETER(DB1.Shipping_Temp_Code_C_F);
 PARAMETER(DB1.Broker_Order_Status);
 PARAMETER(DB1.Air_Freight_Order);
 PARAMETER(DB1.Order_Requires_Review);
 PARAMETER(DB1.OH_Load_Plan_Ready);
 PARAMETER(DB1.Export_USDA_Approved);
 PARAMETER(DB1.HPB_Ship_to_Warehouse);
 PARAMETER(DB1.OH_TF_Exempt_Code);
 PARAMETER(DB1.OH_Appt_Confirmation_Dt);
 PARAMETER(DB1.JPN_Invoice_Issuance_Date);
 PARAMETER(DB1.Load_Actual_Shipped_Date);
 PARAMETER(DB1.Load_BOL_Complete_Date);
 PARAMETER(DB1.Load_Truck_Departure_Date);
 PARAMETER(DB1.Maximum_Gross_Weight);
 PARAMETER(DB1.Time_of_Original_Entry);
 PARAMETER(DB1.OH_Appt_Confirmation_Tm);
 PARAMETER(DB1.Load_BOL_Complete_Time);
 PARAMETER(DB1.Load_Truck_Departure_Time);
 PARAMETER(DB1.Act_Frt_Reference_Amount);
 PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
 PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
 PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
 PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
 PARAMETER(DB1.Claim_Number);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);

}


//?FP1054 Create HLDORD
// Call program CRT Load/Order Chg Log XF.
CALL PROGRAM(CRT Load/Order Chg Log XF) ('PDADXFR');
PARAMETER(RCD.Load_ID);
PARAMETER(*ZERO);
PARAMETER('HLDORD');
PARAMETER('SLS');
PARAMETER('N');
PARAMETER('Y');
PARAMETER(JOB.*USER);
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Carrier_Code);
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);

//?*
// LCL.*Reload subfile = CND.*YES
LCL.*Reload_subfile = 'Y';

// LCL.Post Flag USR = CND.Yes
LCL.Post_Flag_USR = 'Y';

ENDIF;

//?Refresh record
CASE;

// IF LCL.*Reload subfile is *YES
IF LCL.*Reload_subfile = 'Y';

// RCD.Quantity Sched 5.0 USR = LCL.Quantity Scheduled
RCD.Quantity_Sched_5_0_USR = LCL.Quantity_Scheduled;

// RCD.Quantity Scheduled = LCL.Quantity Scheduled
RCD.Quantity_Scheduled = LCL.Quantity_Scheduled;

// RCD.Weight Scheduled = LCL.Weight Scheduled
RCD.Weight_Scheduled = LCL.Weight_Scheduled;

//?Refresh Record
// Call program WW OrdPrdSch Refresh  XF.
CALL PROGRAM(WW OrdPrdSch Refresh  XF) ('POUFXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.OD_Production_Plan_Sts);
PARAMETER(RCD.Quantity_Ordered);
PARAMETER(RCD.Requested_Ship_Date);
PARAMETER(RCD.Scheduled_Ship_Date);
PARAMETER(RCD.OD_Schedule_Override_Sts);
PARAMETER(RCD.OD_Adj_Type_Override);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
PARAMETER(RCD.Qty_Sched_Prod_1_USR);
PARAMETER(RCD.Qty_Sched_Prod_2_USR);
PARAMETER(RCD.Qty_Sched_Prod_3_USR);
PARAMETER(RCD.Qty_Sched_Prod_4_USR);
PARAMETER(RCD.Qty_Sched_Prod_5_USR);
PARAMETER(RCD.Qty_Sched_Prod_6_USR);
PARAMETER(RCD.Qty_Sched_Ord_1_USR);
PARAMETER(RCD.Qty_Sched_Ord_2_USR);
PARAMETER(RCD.Qty_Sched_Ord_3_USR);
PARAMETER(RCD.Qty_Sched_Ord_4_USR);
PARAMETER(RCD.Qty_Sched_Ord_5_USR);
PARAMETER(RCD.Qty_Sched_Ord_6_USR);
PARAMETER(RCD.OD_Added_to_Sched_Today);
PARAMETER(RCD.Qty_5_0_USR);
PARAMETER(RCD.Production_USR);
PARAMETER(RCD.Inv_Total_USR);
PARAMETER(RCD.ODS_Quantity_Short);
PARAMETER(LCL.Post_Flag_USR);
PARAMETER(RCD.Reverse_Image_Flag_USR);
PARAMETER(RCD.Credit_Hold);
PARAMETER(RCD.Production_Hold);
PARAMETER(RCD.Load_ID);
PARAMETER(RCD.Record_Found_OrdDtlUSR);
PARAMETER(RCD.Load_Status);

ENDIF;

ENDIF;

//?Post Order & Refresh order's status'- refresh status is new for FP1054
CASE;

// IF LCL.Post Flag USR is Yes
IF LCL.Post_Flag_USR = 'Y';

// Call program EDT Post Open Orders   XF.
CALL PROGRAM(EDT Post Open Orders   XF) ('PDHRXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Ship_To_Customer);
PARAMETER(WRK.Unused_Parm_Value_USR);
PARAMETER(WRK.Order_Weight_Total);
PARAMETER('PS');

//?Refresh Record
// Call program WW OrdPrdSch Refresh  XF.
CALL PROGRAM(WW OrdPrdSch Refresh  XF) ('POUFXFR');
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER(RCD.Warehouse_Code);
PARAMETER(RCD.OD_Production_Plan_Sts);
PARAMETER(RCD.Quantity_Ordered);
PARAMETER(RCD.Requested_Ship_Date);
PARAMETER(RCD.Scheduled_Ship_Date);
PARAMETER(RCD.OD_Schedule_Override_Sts);
PARAMETER(RCD.OD_Adj_Type_Override);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
PARAMETER(RCD.Qty_Sched_Prod_1_USR);
PARAMETER(RCD.Qty_Sched_Prod_2_USR);
PARAMETER(RCD.Qty_Sched_Prod_3_USR);
PARAMETER(RCD.Qty_Sched_Prod_4_USR);
PARAMETER(RCD.Qty_Sched_Prod_5_USR);
PARAMETER(RCD.Qty_Sched_Prod_6_USR);
PARAMETER(RCD.Qty_Sched_Ord_1_USR);
PARAMETER(RCD.Qty_Sched_Ord_2_USR);
PARAMETER(RCD.Qty_Sched_Ord_3_USR);
PARAMETER(RCD.Qty_Sched_Ord_4_USR);
PARAMETER(RCD.Qty_Sched_Ord_5_USR);
PARAMETER(RCD.Qty_Sched_Ord_6_USR);
PARAMETER(RCD.OD_Added_to_Sched_Today);
PARAMETER(RCD.Qty_5_0_USR);
PARAMETER(RCD.Production_USR);
PARAMETER(RCD.Inv_Total_USR);
PARAMETER(RCD.ODS_Quantity_Short);
PARAMETER(LCL.Post_Flag_USR);
PARAMETER(RCD.Reverse_Image_Flag_USR);
PARAMETER(RCD.Credit_Hold);
PARAMETER(RCD.Production_Hold);
PARAMETER(RCD.Load_ID);
PARAMETER(RCD.Record_Found_OrdDtlUSR);
PARAMETER(RCD.Load_Status);

// RCD.*SFLSEL = CND.*Reset to blank
RCD.*SFLSEL = *BLANK;

ENDIF;

//?USER: Final processing (Pre-confirm)

CASE;

// IF LCL.Error Status is yes
IF LCL.Error_Status = 'Y';

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

ENDIF;

// PAR.Display Prt Opt Pmt USR = CND.*YES
PAR.Display_Prt_Opt_Pmt_USR = *YES;

//?FP1054 chg to use CTL.production Warehouse Code
EXECUTE FUNCTION(Rtv Base Availability RT) TYPE(RTVOBJ) FILE(PDI8CPP)           AC1648124;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
PARAMETER(CTL.Qty_Sched_Prod_1_USR);
PARAMETER(CTL.Qty_Sched_Prod_2_USR);
PARAMETER(CTL.Qty_Sched_Prod_3_USR);
PARAMETER(CTL.Qty_Sched_Prod_4_USR);
PARAMETER(CTL.Qty_Sched_Prod_5_USR);
PARAMETER(CTL.Qty_Sched_Prod_6_USR);
PARAMETER(CTL.Qty_Converted_1_USR);
PARAMETER(CTL.Qty_Converted_2_USR);
PARAMETER(CTL.Qty_Converted_3_USR);
PARAMETER(CTL.Qty_Converted_4_USR);
PARAMETER(CTL.Qty_Converted_5_USR);
PARAMETER(CTL.Qty_Converted_6_USR);
PARAMETER(CTL.Qty_Sched_Ord_1_USR);
PARAMETER(CTL.Qty_Sched_Ord_2_USR);
PARAMETER(CTL.Qty_Sched_Ord_3_USR);
PARAMETER(CTL.Qty_Sched_Ord_4_USR);
PARAMETER(CTL.Qty_Sched_Ord_5_USR);
PARAMETER(CTL.Qty_Sched_Ord_6_USR);
PARAMETER(CTL.Quantity_Avail_USR_1);
PARAMETER(CTL.Quantity_Avail_USR_2);
PARAMETER(CTL.Quantity_Avail_USR_3);
PARAMETER(CTL.Quantity_Avail_USR_4);
PARAMETER(CTL.Quantity_Avail_USR_5);
PARAMETER(CTL.Quantity_Avail_USR_6);
PARAMETER(CTL.Qty_Std_Prod_1_USR);
PARAMETER(CTL.Qty_Std_Prod_2_USR);
PARAMETER(CTL.Qty_Std_Prod_3_USR);
PARAMETER(CTL.Qty_Std_Prod_4_USR);
PARAMETER(CTL.Qty_Std_Prod_5_USR);
PARAMETER(CTL.Qty_Std_Prod_6_USR);
PARAMETER(CTL.Day_1_Inventory_50_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_1_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_2_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_3_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_4_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_5_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_6_USR);
PARAMETER(LCL.Unit_Weight);
PARAMETER(LCL.Piece_Count_Item);
PARAMETER(LCL.Pieces_Per_Bag);
PARAMETER(LCL.Bags_Per_Unit);
{
 //?USER: Initialize routine

 CASE;

 // IF PAR.Unit Weight is Equal to zero
 IF PAR.Unit_Weight = *ZERO;

 EXECUTE FUNCTION(Rtv Base Values PA    RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1416510;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Code);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Unit_Weight);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Piece_Count_Item);
 PARAMETER(LCL.Pieces_Per_Bag);
 PARAMETER(LCL.Bags_Per_Unit);
 PARAMETER(WRK.BLANK);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Unit Weight = PAR.Unit Weight
 LCL.Unit_Weight = PAR.Unit_Weight;

 // LCL.Piece Count Item = PAR.Piece Count Item
 LCL.Piece_Count_Item = PAR.Piece_Count_Item;

 // LCL.Pieces Per Bag = PAR.Pieces Per Bag
 LCL.Pieces_Per_Bag = PAR.Pieces_Per_Bag;

 // LCL.Bags Per Unit = PAR.Bags Per Unit
 LCL.Bags_Per_Unit = PAR.Bags_Per_Unit;

 ENDIF;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?QUIT:  Production Date > Usr Day 6
 CASE;

 // IF DB1.Production Date GT PAR.USR Day 6
 IF DB1.Production_Date > PAR.USR_Day_6;

 QUIT;

 ENDIF;

 //?SEL:  Schedule for Job Date
 CASE;

 // IF DB1.Production Date EQ JOB.*Job date
 IF DB1.Production_Date = JOB.*Job_date;

 CASE;

 // IF DB1.Production Type is Plan
 IF DB1.Production_Type = 'P';

 // OR DB1.Production Type is Schedule Saved in the am
 OR DB1.Production_Type = 'X';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?Process Record
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 CASE;

 // IF LCL.Piece Count Item is yes
 IF LCL.Piece_Count_Item = 'Y';

 CASE;

 // IF PAR.Production Date EQ PAR.USR Day 1
 IF PAR.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Pieces_Inv_On_Hand + DB1.PS_Pieces_Inv_Adj )
 - DB1.PS_Pieces_Inv_Allocated ) / ( LCL.Pieces_Per_Bag * LCL.Bags_Per_Unit 'H' ) 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Pieces_Standard / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Planned:fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Pieces_Planned_Prod / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched whse txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Pieces_Whs_Tfr_Adj / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Pieces_Converted / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Pieces_Prod_Allocated / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 also add ps pieces planned prod
 // Quantity Production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Pieces_Standard + DB1.PS_Pieces_Prod_Adj )
 - DB1.PS_Pieces_Converted ) + DB1.PS_Pieces_Planned_Prod ) / ( LCL.Pieces_Per_Bag                 +
 * LCL.Bags_Per_Unit );

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Weight_Inv_On_Hand + DB1.PS_Weight_Inv_Adj )
 - DB1.PS_Weight_Inv_Allocated ) / LCL.Unit_Weight 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Weight_Standard / LCL.Unit_Weight;

 // Quantity Planned-fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Weight_Planned_Prod / LCL.Unit_Weight;

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched Whse Txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Weight_Whs_Tfr_Adj / LCL.Unit_Weight;

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Weight_Converted / LCL.Unit_Weight;

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Weight_Prod_Allocated / LCL.Unit_Weight;

 //?FP1054 also add ps weight planned prod
 // Quantity production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Weight_Standard + DB1.PS_Weight_Prod_Adj )
 - DB1.PS_Weight_Converted ) + DB1.PS_Weight_Planned_Prod ) / LCL.Unit_Weight;

 ENDIF;

 // Quantity Available
 LCL.Quantity_Avail_7_0_USR = ( ( LCL.Quantity_Standard_USR - LCL.Quantity_Converted_USR )
 - LCL.Qty_Ordered_USR ) - LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // PAR.Qty Sched Prod 1 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_1_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 1 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_1_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 1 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_1_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 1 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_1 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 1 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_1_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 1 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_1_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 2
 IF DB1.Production_Date = PAR.USR_Day_2;

 // PAR.Qty Sched Prod 2 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_2_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 2 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_2_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 2 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_2_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 2 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_2 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 2 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_2_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 2 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_2_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 3
 IF DB1.Production_Date = PAR.USR_Day_3;

 // PAR.Qty Sched Prod 3 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_3_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 3 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_3_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 3 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_3_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 3 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_3 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 3 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_3_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 3 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_3_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 4
 IF DB1.Production_Date = PAR.USR_Day_4;

 // PAR.Qty Sched Prod 4 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_4_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 4 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_4_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 4 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_4_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 4 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_4 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 4 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_4_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 4 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_4_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 5
 IF DB1.Production_Date = PAR.USR_Day_5;

 // PAR.Qty Sched Prod 5 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_5_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 5 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_5_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 5 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_5_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 5 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_5 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 5 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_5_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 5 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_5_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 6
 IF DB1.Production_Date = PAR.USR_Day_6;

 // PAR.Qty Sched Prod 6 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_6_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 6 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_6_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 6 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_6_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 6 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_6 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 6 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_6_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 6 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_6_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 ENDIF;

 ENDIF;

}


CASE;

// IF CTL.Item Code is Entered
IF CTL.Item_Code <> *ZERO;

EXECUTE FUNCTION(Rtv Base Availability RT) TYPE(RTVOBJ) FILE(PDI8CPP)           AC1648124;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Item_Code);
PARAMETER(CTL.Warehouse_Code);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Day_6);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(LCL.ZERO);
PARAMETER(CTL.Qty_Std_Prod_1_USR);
PARAMETER(CTL.Qty_Std_Prod_2_USR);
PARAMETER(CTL.Qty_Std_Prod_3_USR);
PARAMETER(CTL.Qty_Std_Prod_4_USR);
PARAMETER(CTL.Qty_Std_Prod_5_USR);
PARAMETER(CTL.Qty_Std_Prod_6_USR);
PARAMETER(CTL.Day_1_Inventory_50_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_1_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_2_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_3_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_4_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_5_USR);
PARAMETER(LCL.Qty_Sched_Whs_Txfr_6_USR);
PARAMETER(*ZERO);
PARAMETER(LCL.BLANK);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
{
 //?USER: Initialize routine

 CASE;

 // IF PAR.Unit Weight is Equal to zero
 IF PAR.Unit_Weight = *ZERO;

 EXECUTE FUNCTION(Rtv Base Values PA    RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1416510;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Item_Code);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Unit_Weight);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.BLANK);
 PARAMETER(WRK.ZERO);
 PARAMETER(WRK.BLANK);
 PARAMETER(LCL.Piece_Count_Item);
 PARAMETER(LCL.Pieces_Per_Bag);
 PARAMETER(LCL.Bags_Per_Unit);
 PARAMETER(WRK.BLANK);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Unit Weight = PAR.Unit Weight
 LCL.Unit_Weight = PAR.Unit_Weight;

 // LCL.Piece Count Item = PAR.Piece Count Item
 LCL.Piece_Count_Item = PAR.Piece_Count_Item;

 // LCL.Pieces Per Bag = PAR.Pieces Per Bag
 LCL.Pieces_Per_Bag = PAR.Pieces_Per_Bag;

 // LCL.Bags Per Unit = PAR.Bags Per Unit
 LCL.Bags_Per_Unit = PAR.Bags_Per_Unit;

 ENDIF;

 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?QUIT:  Production Date > Usr Day 6
 CASE;

 // IF DB1.Production Date GT PAR.USR Day 6
 IF DB1.Production_Date > PAR.USR_Day_6;

 QUIT;

 ENDIF;

 //?SEL:  Schedule for Job Date
 CASE;

 // IF DB1.Production Date EQ JOB.*Job date
 IF DB1.Production_Date = JOB.*Job_date;

 CASE;

 // IF DB1.Production Type is Plan
 IF DB1.Production_Type = 'P';

 // OR DB1.Production Type is Schedule Saved in the am
 OR DB1.Production_Type = 'X';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?Process Record
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 CASE;

 // IF LCL.Piece Count Item is yes
 IF LCL.Piece_Count_Item = 'Y';

 CASE;

 // IF PAR.Production Date EQ PAR.USR Day 1
 IF PAR.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Pieces_Inv_On_Hand + DB1.PS_Pieces_Inv_Adj )
 - DB1.PS_Pieces_Inv_Allocated ) / ( LCL.Pieces_Per_Bag * LCL.Bags_Per_Unit 'H' ) 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Pieces_Standard / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Planned:fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Pieces_Planned_Prod / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched whse txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Pieces_Whs_Tfr_Adj / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Pieces_Converted / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Pieces_Prod_Allocated / ( LCL.Pieces_Per_Bag
 * LCL.Bags_Per_Unit );

 //?FP1054 also add ps pieces planned prod
 // Quantity Production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Pieces_Standard + DB1.PS_Pieces_Prod_Adj )
 - DB1.PS_Pieces_Converted ) + DB1.PS_Pieces_Planned_Prod ) / ( LCL.Pieces_Per_Bag                 +
 * LCL.Bags_Per_Unit );

 //?CLC:  Quantity Standard, Converted, Scheduled Orders
 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // Quantity Inventory
 LCL.Day_1_Inventory_50_USR = ( ( DB1.PS_Weight_Inv_On_Hand + DB1.PS_Weight_Inv_Adj )
 - DB1.PS_Weight_Inv_Allocated ) / LCL.Unit_Weight 'H';

 ENDIF;

 // Quantity Standard
 LCL.Quantity_Standard_USR = DB1.PS_Weight_Standard / LCL.Unit_Weight;

 // Quantity Planned-fp1054
 LCL.Quantity_Planned_USR = DB1.PS_Weight_Planned_Prod / LCL.Unit_Weight;

 //?FP1054 add these together for display on the screen
 // LCL.Quantity Standard USR = LCL.Quantity Standard USR + LCL.Quantity Planned USR
 LCL.Quantity_Standard_USR = LCL.Quantity_Standard_USR + LCL.Quantity_Planned_USR;

 // Quantity Sched Whse Txfr
 LCL.Quantity_Sched_Whs_Tx_USR = DB1.PS_Weight_Whs_Tfr_Adj / LCL.Unit_Weight;

 // Quantity Converted
 LCL.Quantity_Converted_USR = DB1.PS_Weight_Converted / LCL.Unit_Weight;

 // Quantity Scheduled Orders
 LCL.Qty_Ordered_USR = DB1.PS_Weight_Prod_Allocated / LCL.Unit_Weight;

 //?FP1054 also add ps weight planned prod
 // Quantity production
 LCL.Quantity_Production_USR = ( ( ( DB1.PS_Weight_Standard + DB1.PS_Weight_Prod_Adj )
 - DB1.PS_Weight_Converted ) + DB1.PS_Weight_Planned_Prod ) / LCL.Unit_Weight;

 ENDIF;

 // Quantity Available
 LCL.Quantity_Avail_7_0_USR = ( ( LCL.Quantity_Standard_USR - LCL.Quantity_Converted_USR )
 - LCL.Qty_Ordered_USR ) - LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 CASE;

 // IF DB1.Production Date EQ PAR.USR Day 1
 IF DB1.Production_Date = PAR.USR_Day_1;

 // PAR.Qty Sched Prod 1 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_1_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 1 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_1_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 1 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_1_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 1 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_1 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 1 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_1_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 1 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_1_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 2
 IF DB1.Production_Date = PAR.USR_Day_2;

 // PAR.Qty Sched Prod 2 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_2_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 2 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_2_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 2 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_2_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 2 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_2 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 2 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_2_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 2 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_2_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 3
 IF DB1.Production_Date = PAR.USR_Day_3;

 // PAR.Qty Sched Prod 3 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_3_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 3 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_3_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 3 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_3_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 3 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_3 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 3 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_3_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 3 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_3_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 4
 IF DB1.Production_Date = PAR.USR_Day_4;

 // PAR.Qty Sched Prod 4 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_4_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 4 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_4_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 4 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_4_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 4 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_4 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 4 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_4_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 4 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_4_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 5
 IF DB1.Production_Date = PAR.USR_Day_5;

 // PAR.Qty Sched Prod 5 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_5_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 5 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_5_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 5 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_5_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 5 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_5 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 5 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_5_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 5 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_5_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 //?Move to appropriate day
 // IF DB1.Production Date EQ PAR.USR Day 6
 IF DB1.Production_Date = PAR.USR_Day_6;

 // PAR.Qty Sched Prod 6 USR = LCL.Quantity Standard USR
 PAR.Qty_Sched_Prod_6_USR = LCL.Quantity_Standard_USR;

 // PAR.Qty Converted 6 USR = LCL.Quantity Converted USR
 PAR.Qty_Converted_6_USR = LCL.Quantity_Converted_USR;

 // PAR.Qty Sched Ord 6 USR = LCL.Qty Ordered USR
 PAR.Qty_Sched_Ord_6_USR = LCL.Qty_Ordered_USR;

 // PAR.Quantity Avail USR 6 = LCL.Quantity Avail  7.0  USR
 PAR.Quantity_Avail_USR_6 = LCL.Quantity_Avail_7_0_USR;

 // PAR.Qty Std Prod 6 USR = LCL.Quantity Production USR
 PAR.Qty_Std_Prod_6_USR = LCL.Quantity_Production_USR;

 // PAR.Qty Sched Whs Txfr 6 USR = LCL.Quantity Sched Whs Tx USR
 PAR.Qty_Sched_Whs_Txfr_6_USR = LCL.Quantity_Sched_Whs_Tx_USR;

 ENDIF;

 ENDIF;

}


ENDIF;

//?Check if Adjustments exists for the Base Item
DO;

//?FP1054 chg to use CTL.production Warehouse Code
EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_1);
PARAMETER(CTL.USR_Display_1);
PARAMETER(CTL.Base_Adj_Sts_1_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_2);
PARAMETER(CTL.USR_Display_2);
PARAMETER(CTL.Base_Adj_Sts_2_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_3);
PARAMETER(CTL.USR_Display_3);
PARAMETER(CTL.Base_Adj_Sts_3_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_4);
PARAMETER(CTL.USR_Display_4);
PARAMETER(CTL.Base_Adj_Sts_4_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_5);
PARAMETER(CTL.USR_Display_5);
PARAMETER(CTL.Base_Adj_Sts_5_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


EXECUTE FUNCTION(Rtv Adjustment Sts    RT) TYPE(RTVOBJ) FILE(PDI9CPP)           AC1654273;
PARAMETER(CTL.Accounting_Company);
PARAMETER(CTL.Consumed_Item_Code);
PARAMETER(CTL.Production_Warehouse);
PARAMETER(CTL.USR_Day_6);
PARAMETER(CTL.USR_Display_6);
PARAMETER(CTL.Base_Adj_Sts_6_USR);
{
 //?USER: Initialize routine

 // PAR.USR Display field = CND.blank
 PAR.USR_Display_field = *BLANK;

 // PAR.Status - Y or N = CND.blank
 PAR.Status_Y_or_N = *BLANK;

 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code NE DB1.PS Consumed Item Code
 IF DB1.Item_Code <> DB1.PS_Consumed_Item_Code;

 // PAR.USR Display field = CND.yes
 PAR.USR_Display_field = 'Y';

 // IF DB1.Item Code EQ DB1.PS Consumed Item Code
 IF DB1.Item_Code = DB1.PS_Consumed_Item_Code;

 // PAR.Status - Y or N = CND.yes
 PAR.Status_Y_or_N = 'Y';

 ENDIF;

}


ENDDO;

//?USER: Process subfile record (Post-confirm)

//?14=Release Order is now Release Line item-FP1054
CASE;

// IF RCD.*SFLSEL is Option 14
IF RCD.*SFLSEL = '14';

CASE;

// IF RCD.Released by User Sts Y/N is Not Yes
IF RCD.Released_by_User_Sts_Y_N = *BLANK/'N';

//? Let the order ship short.
EXECUTE FUNCTION(CHG Released by User  CH) TYPE(CHGOBJ) FILE(OPBGWKP)           AC1920658;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
PARAMETER(RCD.Order_Sequence_Number);
PARAMETER(RCD.Order_Secondary_Line_Seq);
PARAMETER('Y');
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*JOB
  PAR.Job_Name = JOB.*JOB;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

}


//?FP1054 chg prod hold status if orders line pass test
EXECUTE FUNCTION(RTV Chg Sts/Prd Sts   RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1920663;
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(RTV Check Sch/not Rlsd RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1920664;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(LCL.USR_Production);
 {
  //?USER: Initialize routine

  // PAR.USR Production = CND.No
  PAR.USR_Production = 'N';

  //?USER: Process Data record

  CASE;

  // IF DB1.Quantity Ordered EQ DB1.Quantity Scheduled
  IF DB1.Quantity_Ordered = DB1.Quantity_Scheduled;

  // OR DB1.Released by User Sts Y/N is yes
  OR DB1.Released_by_User_Sts_Y_N = 'Y';

  // OR DB1.Detail Line Status is Cancelled
  OR DB1.Detail_Line_Status = 'X';

  //?if all line items are either sched or released by user or cncled,
  //?then order is not to be on prod hold
  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.USR Production = CND.Yes
  PAR.USR_Production = 'Y';

  ENDIF;

 }

 // LCL.Header Status Last = DB1.Header Status Last
 LCL.Header_Status_Last = DB1.Header_Status_Last;

 // LCL.Header Status = DB1.Header Status
 LCL.Header_Status = DB1.Header_Status;

 CASE;

 // IF DB1.Credit Hold is Yes
 IF DB1.Credit_Hold = 'Y';

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF LCL.USR Production is No
 IF LCL.USR_Production = 'N';

 // LCL.Header Status Last = DB1.Header Status
 LCL.Header_Status_Last = DB1.Header_Status;

 // LCL.Header Status = CND.Available
 LCL.Header_Status = 'A';

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(CHG Prd Hld, Sts,Rsn   CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1342647;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Reason_Code);
 PARAMETER(LCL.Header_Status);
 PARAMETER(LCL.Header_Status_Last);
 PARAMETER(LCL.USR_Production);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

  // Call program TRG Order Hdr CHG Trig XT.
  CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Type_Sales);
  PARAMETER(DB1.AR_Customer_Number);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(DB1.Ship_To_Name);
  PARAMETER(DB1.Ship_To_Address_Line_1);
  PARAMETER(DB1.Ship_To_Address_Line_2);
  PARAMETER(DB1.Ship_To_Address_Line_3);
  PARAMETER(DB1.Ship_To_City);
  PARAMETER(DB1.Ship_To_State_Code);
  PARAMETER(DB1.Ship_To_Zip_Postal_Code);
  PARAMETER(DB1.Bill_to_Customer);
  PARAMETER(DB1.Bill_to_Name);
  PARAMETER(DB1.Bill_to_Address_Line_1);
  PARAMETER(DB1.Bill_to_Address_Line_2);
  PARAMETER(DB1.Bill_to_Address_Line_3);
  PARAMETER(DB1.Bill_to_City);
  PARAMETER(DB1.Bill_to_State_Code);
  PARAMETER(DB1.Bill_to_Zip_Postal_Code);
  PARAMETER(DB1.Customer_Purchase_Order_#);
  PARAMETER(DB1.Order_Date);
  PARAMETER(DB1.Requested_Ship_Date);
  PARAMETER(DB1.Actual_Shipped_Date);
  PARAMETER(DB1.Cancel_Date);
  PARAMETER(DB1.Terms_Code);
  PARAMETER(DB1.Special_Instructions);
  PARAMETER(DB1.Special_Instructions_2);
  PARAMETER(DB1.Carrier_Code);
  PARAMETER(DB1.Comment_Print_Acknowledge);
  PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
  PARAMETER(DB1.Comment_Print_Pick_Slip);
  PARAMETER(DB1.Comment_Print_Ship_Doc);
  PARAMETER(DB1.Reason_Code);
  PARAMETER(DB1.Order_in_Use);
  PARAMETER(DB1.Header_Status);
  PARAMETER(DB1.Header_Status_Last);
  PARAMETER(DB1.Order_Type_Print_Status);
  PARAMETER(DB1.Scheduled_Ship_Date);
  PARAMETER(DB1.User_Original_Entry);
  PARAMETER(DB1.Date_of_Original_Entry);
  PARAMETER(DB1.Order_Value_Total);
  PARAMETER(DB1.Order_Weight_Total);
  PARAMETER(DB1.Credit_Hold);
  PARAMETER(DB1.Production_Hold);
  PARAMETER(DB1.New_Customer_Hold);
  PARAMETER(DB1.Requested_Delivery_Date);
  PARAMETER(DB1.Requested_Delivery_Time);
  PARAMETER(DB1.Accounts_Receiv_Ent_1);
  PARAMETER(DB1.Accounts_Receiv_Ent_2);
  PARAMETER(DB1.Load_ID);
  PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
  PARAMETER(DB1.Rated_Freight);
  PARAMETER(DB1.LTL_Flag);
  PARAMETER(DB1.Price_Audit);
  PARAMETER(DB1.Price_Status);
  PARAMETER(DB1.Shipping_Method);
  PARAMETER(DB1.Export_Status);
  PARAMETER(DB1.Palletize);
  PARAMETER(DB1.Shrink_Wrap);
  PARAMETER(DB1.Slip_Sheet);
  PARAMETER(DB1.Age_Code);
  PARAMETER(DB1.Reefer_Temperature);
  PARAMETER(DB1.Load_Type);
  PARAMETER(DB1.Attach_to_Invoice_Number);
  PARAMETER(DB1.Load_Plan_Order);
  PARAMETER(DB1.Print_Pick_Slip);
  PARAMETER(DB1.Resell_Reference_Number);
  PARAMETER(DB1.Special_Comment_1);
  PARAMETER(DB1.Special_Comment_2);
  PARAMETER(DB1.Affect_Auto_Accruals);
  PARAMETER(DB1.Sales_Route_Code);
  PARAMETER(DB1.Manager_Level_Code);
  PARAMETER(DB1.VP_Level_Code);
  PARAMETER(DB1.Attach_to_Order_Number);
  PARAMETER(DB1.Reason_for_Price_Audit);
  PARAMETER(DB1.Invoice_Number);
  PARAMETER(DB1.Invoice_Suffix);
  PARAMETER(DB1.Invoice_Date);
  PARAMETER(DB1.Event_Code);
  PARAMETER(DB1.Trans_Contol_AS400_Plant);
  PARAMETER(DB1.Modified_Flag);
  PARAMETER(DB1.A_R_order_Value_Total);
  PARAMETER(DB1.Billing_Activity_Type);
  PARAMETER(DB1.Block_Order_Flag);
  PARAMETER(DB1.Order_Certification_Flag);
  PARAMETER(DB1.Invoice_Order_Value_Tot);
  PARAMETER(DB1.Process_Sts_for_3C);
  PARAMETER(DB1.Order_Conf_Fax_Sts);
  PARAMETER(DB1.Manifest_Fax_Sts);
  PARAMETER(DB1.Invoice_Fax_Sts);
  PARAMETER(DB1.Transfer_in_Storage_Ind);
  PARAMETER(DB1.Email_Cust_On_Order_Ship);
  PARAMETER(DB1.Order_Emailed);
  PARAMETER(DB1.Export_Docs_Go_w_Driver);
  PARAMETER(DB1.Shipping_Temp_Code_C_F);
  PARAMETER(DB1.Broker_Order_Status);
  PARAMETER(DB1.Air_Freight_Order);
  PARAMETER(DB1.Order_Requires_Review);
  PARAMETER(DB1.OH_Load_Plan_Ready);
  PARAMETER(DB1.Export_USDA_Approved);
  PARAMETER(DB1.HPB_Ship_to_Warehouse);
  PARAMETER(DB1.OH_TF_Exempt_Code);
  PARAMETER(DB1.OH_Appt_Confirmation_Dt);
  PARAMETER(DB1.JPN_Invoice_Issuance_Date);
  PARAMETER(DB1.Load_Actual_Shipped_Date);
  PARAMETER(DB1.Load_BOL_Complete_Date);
  PARAMETER(DB1.Load_Truck_Departure_Date);
  PARAMETER(DB1.Maximum_Gross_Weight);
  PARAMETER(DB1.Time_of_Original_Entry);
  PARAMETER(DB1.OH_Appt_Confirmation_Tm);
  PARAMETER(DB1.Load_BOL_Complete_Time);
  PARAMETER(DB1.Load_Truck_Departure_Time);
  PARAMETER(DB1.Act_Frt_Reference_Amount);
  PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
  PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
  PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
  PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
  PARAMETER(DB1.Claim_Number);
  PARAMETER(DB1.EDI_Status_1);
  PARAMETER(DB1.EDI_Status_2);
  PARAMETER(DB1.EDI_Status_3);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);

 }

}


//?* FP1054 Create rcd * RLSLIN
// WRK.Item Code Txt = CVTVAR(RCD.Item Code)
WRK.Item_Code_Txt = CVTVAR(RCD.Item_Code);

// Call program CRT Load/Order Chg Log XF.
CALL PROGRAM(CRT Load/Order Chg Log XF) ('PDADXFR');
PARAMETER(RCD.Load_ID);
PARAMETER(*ZERO);
PARAMETER('RLSLIN');
PARAMETER('SLS');
PARAMETER(WRK.Item_Code_Txt);
PARAMETER('Released');
PARAMETER(JOB.*USER);
PARAMETER(JOB.*PROGRAM);
PARAMETER(RCD.Carrier_Code);
PARAMETER(RCD.Company_Number);
PARAMETER(RCD.Order_Number);

//?*
ENDIF;

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

ENDIF;

