     H/TITLE PMT Payment Process   PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJMIST
     H* Date          : 01/18/24  Time  : 08:11:40
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKXAPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: PMT Payment Process   PV  Prompt & validate record
      *
     FPKAXCPLCIF  E           K        DISK
      * RSQ : Buy Order Load            Co/KillDt, Sel BOL SclSt
      *
     FPLBAREL3IF  E           K        DISK
      * RSQ : Eval Trans UPL Comment    Rtv Eval Trns RSPrcess
      *
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPWAWCPL2IF  E           K        DISK
      * RSQ : Tattoo Repayment Header   Repayment ID (descend)
      *
     FPKAXCPL4IF  E           K        DISK
      * RSQ : Buy Order Load           Co/Trk/BO/Ld/NtPd/ActOnly
      *
     FPKBAREL0IF  E           K        DISK
      * RTV : Trucker                   Retrieval index
      *
     FPKA1CPNLIF  E           K        DISK
      * RSQ : Tattoo Header             Co/KillDt(D)/Tat/Sel=Unp
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPKA1CPK3IF  E           K        DISK
      * RSQ : Tattoo Header             KDt(d)/Co/BO/Ld/Tt-Unpd
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPWAIREL1IF  E           K        DISK
      * RTV : Source/Buy Order Typ XREF Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 015  5 0A
     E                    W0END   7 015  5 0A
     E                    W0NAM   7 015 10
      * Long constants
     E                    @CN#    1  12  6   @CN    25
     I@AXCPB1
      * Buy Order Load            Co/KillDt, Sel BOL SclSt
      * Renamed input format fields
     I              AXHMNB                          WAHMNB
     I              AXBNNB                          WABNNB
     I              AXBONB                          WABONB
     I              AXCQDT                          WACQDT
     I              AXABTH                          WAABTH
     I              AXACTH                          WAACTH
     I              AXBPNB                          WABPNB
     I              AXCSNB                          WACSNB
     I              AXAUDT                          WAAUDT
     I              AXCMST                          WACMST
     I              AXAGPR                          WAAGPR
     I              AXATVA                          WAATVA
     I              AXI1ST                          WAI1ST
     I              AXDHNB                          WADHNB
     I              AXDINB                          WADINB
     I              AXCNST                          WACNST
     I              AXGINB                          WAGINB
     I              AXBZDT                          WABZDT
     I              AXLSNB                          WALSNB
     I              AXF3TX                          WAF3TX
     I              AXO8ST                          WAO8ST
     I              AXO9ST                          WAO9ST
     I              AXPAST                          WAPAST
     I              AXLDSH                          WALDSH
     I              AXPBST                          WAPBST
     I              AXPCST                          WAPCST
     I              AXPDST                          WAPDST
     I              AXUWST                          WAUWST
     I              AXUXST                          WAUXST
     I              AXUYST                          WAUYST
     I              AXJKRU                          WAJKRU
     I              AXKEOR                          WAKEOR
     I              AXIOEW                          WAIOEW
     I              AXKJIO                          WAKJIO
     I              AXIOJR                          WAIOJR
     I              AXEIRR                          WAEIRR
     I              AXITMF                          WAITMF
     I              AXODJE                          WAODJE
     I              AXRJIF                          WARJIF
     I              AXOEJF                          WAOEJF
     I              AXD0DT                          WAD0DT
     I              AXD1DT                          WAD1DT
     I              AXD2DT                          WAD2DT
     I              AXD3DT                          WAD3DT
     I              AXD4DT                          WAD4DT
     I              AXBNCD                          WABNCD
     I              AXABCD                          WAABCD
     I              AXAECD                          WAAECD
     I              AXAAVN                          WAAAVN
     I              AXAADT                          WAAADT
     I              AXAMTM                          WAAMTM
     I              AXAJST                          WAAJST
     I              AXAHVN                          WAAHVN
     I              AXAGVN                          WAAGVN
     I              AXABVN                          WAABVN
     I              AXABDT                          WAABDT
     I              AXABTM                          WAABTM
      *
     I@BAREQF
      * Eval Trans UPL Comment    Rtv Eval Trns RSPrcess
      * Renamed input format fields
     I              BAHKST                          WBHKST
     I              BAB7DT                          WBB7DT
     I              BAKINB                          WBKINB
     I              BASUA1                          WBSUA1
     I              BAV9TX                          WBV9TX
     I              BAEBSS                          WBEBSS
     I              BAEESS                          WBEESS
     I              BASWA1                          WBSWA1
     I              BAGHDT                          WBGHDT
     I              BASXA1                          WBSXA1
     I              BASZA1                          WBSZA1
     I              BAGIDT                          WBGIDT
     I              BASYA1                          WBSYA1
     I              BAAAVN                          WBAAVN
     I              BAAADT                          WBAADT
     I              BAAMTM                          WBAMTM
     I              BAAJST                          WBAJST
     I              BAAHVN                          WBAHVN
     I              BAAGVN                          WBAGVN
     I              BAABVN                          WBABVN
     I              BAABDT                          WBABDT
     I              BAABTM                          WBABTM
      *
     I@C4REO7
      * Payment Processing Parms  Retrieval index
      * Renamed input format fields
     I              C4HONB                          WCHONB
     I              C4CKDT                          WCCKDT
     I              C4M1NB                          WCM1NB
     I              C4KHST                          WCKHST
     I              C4KJST                          WCKJST
     I              C4PINB                          WCPINB
     I              C4KKST                          WCKKST
     I              C4AAVN                          WCAAVN
     I              C4AADT                          WCAADT
     I              C4AMTM                          WCAMTM
     I              C4AJST                          WCAJST
     I              C4AHVN                          WCAHVN
     I              C4AGVN                          WCAGVN
     I              C4ABVN                          WCABVN
     I              C4ABDT                          WCABDT
     I              C4ABTM                          WCABTM
      *
     I@AWCPA0
      * Tattoo Repayment Header   Repayment ID (descend)
      * Renamed input format fields
     I              AWHONB                          WDHONB
     I              AWCDNZ                          WDCDNZ
     I              AWMASS                          WDMASS
     I              AWIDDT                          WDIDDT
     I              AWCATM                          WDCATM
     I              AWIEDT                          WDIEDT
     I              AWCBTM                          WDCBTM
     I              AWIFDT                          WDIFDT
     I              AWCTNZ                          WDCTNZ
     I              AWHOT1                          WDHOT1
     I              AWAAVN                          WDAAVN
     I              AWAADT                          WDAADT
     I              AWAMTM                          WDAMTM
     I              AWAJST                          WDAJST
     I              AWAHVN                          WDAHVN
     I              AWAGVN                          WDAGVN
     I              AWABVN                          WDABVN
     I              AWABDT                          WDABDT
     I              AWABTM                          WDABTM
      *
     I@AXCPDV
      * Buy Order Load           Co/Trk/BO/Ld/NtPd/ActOnly
      * Renamed input format fields
     I              AXHMNB                          WEHMNB
     I              AXBNNB                          WEBNNB
     I              AXBONB                          WEBONB
     I              AXCQDT                          WECQDT
     I              AXABTH                          WEABTH
     I              AXACTH                          WEACTH
     I              AXBPNB                          WEBPNB
     I              AXCSNB                          WECSNB
     I              AXAUDT                          WEAUDT
     I              AXCMST                          WECMST
     I              AXAGPR                          WEAGPR
     I              AXATVA                          WEATVA
     I              AXI1ST                          WEI1ST
     I              AXDHNB                          WEDHNB
     I              AXDINB                          WEDINB
     I              AXCNST                          WECNST
     I              AXGINB                          WEGINB
     I              AXBZDT                          WEBZDT
     I              AXLSNB                          WELSNB
     I              AXF3TX                          WEF3TX
     I              AXO8ST                          WEO8ST
     I              AXO9ST                          WEO9ST
     I              AXPAST                          WEPAST
     I              AXLDSH                          WELDSH
     I              AXPBST                          WEPBST
     I              AXPCST                          WEPCST
     I              AXPDST                          WEPDST
     I              AXUWST                          WEUWST
     I              AXUXST                          WEUXST
     I              AXUYST                          WEUYST
     I              AXJKRU                          WEJKRU
     I              AXKEOR                          WEKEOR
     I              AXIOEW                          WEIOEW
     I              AXKJIO                          WEKJIO
     I              AXIOJR                          WEIOJR
     I              AXEIRR                          WEEIRR
     I              AXITMF                          WEITMF
     I              AXODJE                          WEODJE
     I              AXRJIF                          WERJIF
     I              AXOEJF                          WEOEJF
     I              AXD0DT                          WED0DT
     I              AXD1DT                          WED1DT
     I              AXD2DT                          WED2DT
     I              AXD3DT                          WED3DT
     I              AXD4DT                          WED4DT
     I              AXBNCD                          WEBNCD
     I              AXABCD                          WEABCD
     I              AXAECD                          WEAECD
     I              AXAAVN                          WEAAVN
     I              AXAADT                          WEAADT
     I              AXAMTM                          WEAMTM
     I              AXAJST                          WEAJST
     I              AXAHVN                          WEAHVN
     I              AXAGVN                          WEAGVN
     I              AXABVN                          WEABVN
     I              AXABDT                          WEABDT
     I              AXABTM                          WEABTM
      *
     I@BAREDS
      * Trucker                   Retrieval index
      * Renamed input format fields
     I              BABNCD                          WFBNCD
     I              BABJTX                          WFBJTX
     I              BAB6ST                          WFB6ST
     I              BAGMNB                          WFGMNB
     I              BAC3TX                          WFC3TX
     I              BAAAVN                          WFAAVN
     I              BAAADT                          WFAADT
     I              BAAMTM                          WFAMTM
     I              BAAJST                          WFAJST
     I              BAAHVN                          WFAHVN
     I              BAAGVN                          WFAGVN
     I              BAABVN                          WFABVN
     I              BAABDT                          WFABDT
     I              BAABTM                          WFABTM
      *
     I@A1CPXX
      * Tattoo Header             Co/KillDt(D)/Tat/Sel=Unp
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WHABCD
     I              ACAGTX                          WHAGTX
     I              ACALNB                          WHALNB
     I              ACAATH                          WHAATH
     I              ACAMNB                          WHAMNB
     I              ACIWST                          WHIWST
     I              ACAPST                          WHAPST
     I              ACGCNB                          WHGCNB
     I              ACGJNB                          WHGJNB
     I              ACC2TX                          WHC2TX
     I              ACAACD                          WHAACD
     I              ACACCD                          WHACCD
     I              ACADCD                          WHADCD
     I              ACAAVN                          WHAAVN
     I              ACAADT                          WHAADT
     I              ACAMTM                          WHAMTM
     I              ACAJST                          WHAJST
     I              ACAHVN                          WHAHVN
     I              ACAGVN                          WHAGVN
     I              ACABVN                          WHABVN
     I              ACABDT                          WHABDT
     I              ACABTM                          WHABTM
      *
     I@B4RET4
      * Producer EXT2             Retrieval index
      * Renamed input format fields
     I              B4ABCD                          WIABCD
     I              B4QHCD                          WIQHCD
     I              B4AAVN                          WIAAVN
     I              B4AADT                          WIAADT
     I              B4AMTM                          WIAMTM
     I              B4AJST                          WIAJST
     I              B4AHVN                          WIAHVN
     I              B4AGVN                          WIAGVN
     I              B4ABVN                          WIABVN
     I              B4ABDT                          WIABDT
     I              B4ABTM                          WIABTM
      *
     I@A1CPQX
      * Tattoo Header             KDt(d)/Co/BO/Ld/Tt-Unpd
      * Renamed input format fields
     I              A1HMNB                          WJHMNB
     I              A1BNNB                          WJBNNB
     I              A1BONB                          WJBONB
     I              A1CVNB                          WJCVNB
     I              A1B0DT                          WJB0DT
     I              A1AWDT                          WJAWDT
     I              A1BICD                          WJBICD
     I              A1CPST                          WJCPST
     I              A1ACPR                          WJACPR
     I              A1B9PR                          WJB9PR
     I              A1CAPR                          WJCAPR
     I              A1C4ST                          WJC4ST
     I              A1AIPR                          WJAIPR
     I              A1A6DT                          WJA6DT
     I              A1C2ST                          WJC2ST
     I              A1CXNB                          WJCXNB
     I              A1CWNB                          WJCWNB
     I              A1FCNB                          WJFCNB
     I              A1H9NB                          WJH9NB
     I              A1FDNB                          WJFDNB
     I              A1FENB                          WJFENB
     I              A1HENB                          WJHENB
     I              A1HFNB                          WJHFNB
     I              A1CYNB                          WJCYNB
     I              A1LRNB                          WJLRNB
     I              A1E0NB                          WJE0NB
     I              A1A5PC                          WJA5PC
     I              A1FBNB                          WJFBNB
     I              A1A4PC                          WJA4PC
     I              A1F7NB                          WJF7NB
     I              A1HDNB                          WJHDNB
     I              A1F5NB                          WJF5NB
     I              A1F4NB                          WJF4NB
     I              A1F3NB                          WJF3NB
     I              A1F2NB                          WJF2NB
     I              A1AVPC                          WJAVPC
     I              A1AWPC                          WJAWPC
     I              A1CWPC                          WJCWPC
     I              A1A8PC                          WJA8PC
     I              A1A7PC                          WJA7PC
     I              A1B8PR                          WJB8PR
     I              A1AMPR                          WJAMPR
     I              A1ANPR                          WJANPR
     I              A1AYVA                          WJAYVA
     I              A1AWVA                          WJAWVA
     I              A1AOPR                          WJAOPR
     I              A1AXVA                          WJAXVA
     I              A1APPR                          WJAPPR
     I              A1ASPR                          WJASPR
     I              A1A4VA                          WJA4VA
     I              A1ATPR                          WJATPR
     I              A1A5VA                          WJA5VA
     I              A1CBPR                          WJCBPR
     I              A1CCPR                          WJCCPR
     I              A1LPNB                          WJLPNB
     I              A1CDPR                          WJCDPR
     I              A1A7VA                          WJA7VA
     I              A1A2PR                          WJA2PR
     I              A1JWST                          WJJWST
     I              A1CWST                          WJCWST
     I              A1D7ST                          WJD7ST
     I              A1D8ST                          WJD8ST
     I              A1DWST                          WJDWST
     I              A1D6ST                          WJD6ST
     I              A1GHNB                          WJGHNB
     I              A1BYDT                          WJBYDT
     I              A1E0ST                          WJE0ST
     I              A1E1ST                          WJE1ST
     I              A1E2ST                          WJE2ST
     I              A1BSDT                          WJBSDT
     I              A1BTDT                          WJBTDT
     I              A1BUDT                          WJBUDT
     I              A1HGNB                          WJHGNB
     I              A1HHNB                          WJHHNB
     I              A1HINB                          WJHINB
     I              A1A3PR                          WJA3PR
     I              A1A4PR                          WJA4PR
     I              A1A6PR                          WJA6PR
     I              A1J9NB                          WJJ9NB
     I              A1D6PR                          WJD6PR
     I              A1D7PR                          WJD7PR
     I              A1D8PR                          WJD8PR
     I              A1D9PR                          WJD9PR
     I              A1EAPR                          WJEAPR
     I              A1EBPR                          WJEBPR
     I              A1ECPR                          WJECPR
     I              A1EDPR                          WJEDPR
     I              A1EEPR                          WJEEPR
     I              A1EFPR                          WJEFPR
     I              A1EGPR                          WJEGPR
     I              A1EHPR                          WJEHPR
     I              A1KAST                          WJKAST
     I              A1J7ST                          WJJ7ST
     I              A1J9ST                          WJJ9ST
     I              A1OXNB                          WJOXNB
     I              A1LKST                          WJLKST
     I              A1LLST                          WJLLST
     I              A1J8ST                          WJJ8ST
     I              A1LIST                          WJLIST
     I              A1LJST                          WJLJST
     I              A1NZTX                          WJNZTX
     I              A1HJCD                          WJHJCD
     I              A1R4ST                          WJR4ST
     I              A1R5ST                          WJR5ST
     I              A1R6ST                          WJR6ST
     I              A1R7ST                          WJR7ST
     I              A1THWT                          WJTHWT
     I              A1T2WT                          WJT2WT
     I              A1THHD                          WJTHHD
     I              A1T2HD                          WJT2HD
     I              A1OBPR                          WJOBPR
     I              A1KOER                          WJKOER
     I              A1OPIR                          WJOPIR
     I              A1OPEM                          WJOPEM
     I              A1IORP                          WJIORP
     I              A1OWEO                          WJOWEO
     I              A1OQET                          WJOQET
     I              A1URST                          WJURST
     I              A1USST                          WJUSST
     I              A1HHPC                          WJHHPC
     I              A1S9PR                          WJS9PR
     I              A1TAPR                          WJTAPR
     I              A1TBPR                          WJTBPR
     I              A1JFUR                          WJJFUR
     I              A1KRIF                          WJKRIF
     I              A1KORF                          WJKORF
     I              A1KAPR                          WJKAPR
     I              A1KROT                          WJKROT
     I              A1OTJG                          WJOTJG
     I              A1IRJG                          WJIRJG
     I              A1IMJF                          WJIMJF
     I              A1IRGF                          WJIRGF
     I              A1KRJF                          WJKRJF
     I              A1OJRF                          WJOJRF
     I              A1KFOR                          WJKFOR
     I              A1ORJK                          WJORJK
     I              A1OMVJ                          WJOMVJ
     I              A1MVNF                          WJMVNF
     I              A1MCNF                          WJMCNF
     I              A1NCNF                          WJNCNF
     I              A1NCHF                          WJNCHF
     I              A1IGIR                          WJIGIR
     I              A1KFJR                          WJKFJR
     I              A1EADT                          WJEADT
     I              A1EBDT                          WJEBDT
     I              A1ECDT                          WJECDT
     I              A1EDDT                          WJEDDT
     I              A1EEDT                          WJEEDT
     I              A1U4ST                          WJU4ST
     I              A1U5ST                          WJU5ST
     I              A1U6ST                          WJU6ST
     I              A1U7ST                          WJU7ST
     I              A1U8ST                          WJU8ST
     I              A1U9ST                          WJU9ST
     I              A1VAST                          WJVAST
     I              A1VBST                          WJVBST
     I              A1BDCD                          WJBDCD
     I              A1CSCD                          WJCSCD
     I              A1ABCD                          WJABCD
     I              A1AECD                          WJAECD
     I              A1ACCD                          WJACCD
     I              A1AGCD                          WJAGCD
     I              A1BECD                          WJBECD
     I              A1AAVN                          WJAAVN
     I              A1AADT                          WJAADT
     I              A1AMTM                          WJAMTM
     I              A1AJST                          WJAJST
     I              A1AHVN                          WJAHVN
     I              A1AGVN                          WJAGVN
     I              A1ABVN                          WJABVN
     I              A1ABDT                          WJABDT
     I              A1ABTM                          WJABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WKHMNB
     I              AWBNNB                          WKBNNB
     I              AWARDT                          WKARDT
     I              AWASDT                          WKASDT
     I              AWA4ST                          WKA4ST
     I              AWA5ST                          WKA5ST
     I              AWAAPR                          WKAAPR
     I              AWA6ST                          WKA6ST
     I              AWA7ST                          WKA7ST
     I              AWB3ST                          WKB3ST
     I              AWALPR                          WKALPR
     I              AWETCD                          WKETCD
     I              AWEUCD                          WKEUCD
     I              AWJ5TX                          WKJ5TX
     I              AWD5DT                          WKD5DT
     I              AWD6DT                          WKD6DT
     I              AWD7DT                          WKD7DT
     I              AWD8DT                          WKD8DT
     I              AWD9DT                          WKD9DT
     I              AWJOEJ                          WKJOEJ
     I              AWKOFF                          WKKOFF
     I              AWKWPE                          WKKWPE
     I              AWIMBF                          WKIMBF
     I              AWOPTR                          WKOPTR
     I              AWOEJD                          WKOEJD
     I              AWIRMF                          WKIRMF
     I              AWJIRM                          WKJIRM
     I              AWJRKF                          WKJRKF
     I              AWKFIR                          WKKFIR
     I              AWUZST                          WKUZST
     I              AWU0ST                          WKU0ST
     I              AWU1ST                          WKU1ST
     I              AWU2ST                          WKU2ST
     I              AWU3ST                          WKU3ST
     I              AWHXNB                          WKHXNB
     I              AWGANB                          WKGANB
     I              AWGBNB                          WKGBNB
     I              AWABCD                          WKABCD
     I              AWAECD                          WKAECD
     I              AWAKCD                          WKAKCD
     I              AWALCD                          WKALCD
     I              AWAGCD                          WKAGCD
     I              AWAICD                          WKAICD
     I              AWAMCD                          WKAMCD
     I              AWACCD                          WKACCD
     I              AWAAVN                          WKAAVN
     I              AWAADT                          WKAADT
     I              AWAMTM                          WKAMTM
     I              AWAJST                          WKAJST
     I              AWAHVN                          WKAHVN
     I              AWAGVN                          WKAGVN
     I              AWABVN                          WKABVN
     I              AWABDT                          WKABDT
     I              AWABTM                          WKABTM
      *
     I@AIREX2
      * Source/Buy Order Typ XREF Retrieval index
      * Renamed input format fields
     I              AIAACD                          WLAACD
     I              AIA5ST                          WLA5ST
     I              AIAAVN                          WLAAVN
     I              AIAADT                          WLAADT
     I              AIAMTM                          WLAMTM
     I              AIAJST                          WLAJST
     I              AIAHVN                          WLAHVN
     I              AIAGVN                          WLAGVN
     I              AIABVN                          WLABVN
     I              AIABDT                          WLABDT
     I              AIABTM                          WLABTM
      *
     I@DNCPUY
      * Tattoo Header EXT         Retrieval index
      * Renamed input format fields
     I              DNHMNB                          WMHMNB
     I              DNBNNB                          WMBNNB
     I              DNBONB                          WMBONB
     I              DNCVNB                          WMCVNB
     I              DNB0DT                          WMB0DT
     I              DNI5PR                          WMI5PR
     I              DNJBPR                          WMJBPR
     I              DNI6PR                          WMI6PR
     I              DNI7PR                          WMI7PR
     I              DNI8PR                          WMI8PR
     I              DNI9PR                          WMI9PR
     I              DNJAPR                          WMJAPR
     I              DNJCPR                          WMJCPR
     I              DNJDPR                          WMJDPR
     I              DNJEPR                          WMJEPR
     I              DNJFPR                          WMJFPR
     I              DNJGPR                          WMJGPR
     I              DNJHPR                          WMJHPR
     I              DNJIPR                          WMJIPR
     I              DNJJPR                          WMJJPR
     I              DNJKPR                          WMJKPR
     I              DNJLPR                          WMJLPR
     I              DNJMPR                          WMJMPR
     I              DNJNPR                          WMJNPR
     I              DNJOPR                          WMJOPR
     I              DNLTBF                          WMLTBF
     I              DNHZPC                          WMHZPC
     I              DNLTHW                          WMLTHW
     I              DNH0PC                          WMH0PC
     I              DNGTBF                          WMGTBF
     I              DNH1PC                          WMH1PC
     I              DNGTHW                          WMGTHW
     I              DNH2PC                          WMH2PC
     I              DNHLBF                          WMHLBF
     I              DNHLLE                          WMHLLE
     I              DNHLHW                          WMHLHW
     I              DNHLLP                          WMHLLP
     I              DNHGBF                          WMHGBF
     I              DNHGLE                          WMHGLE
     I              DNHGHW                          WMHGHW
     I              DNHFLP                          WMHFLP
     I              DNSNA1                          WMSNA1
     I              DNSOA1                          WMSOA1
     I              DNSPA1                          WMSPA1
     I              DNDGSS                          WMDGSS
     I              DNDHSS                          WMDHSS
     I              DNDISS                          WMDISS
     I              DNABCD                          WMABCD
     I              DNNYCD                          WMNYCD
     I              DNOVCD                          WMOVCD
     I              DNAAVN                          WMAAVN
     I              DNAADT                          WMAADT
     I              DNAMTM                          WMAMTM
     I              DNAJST                          WMAJST
     I              DNAHVN                          WMAHVN
     I              DNAGVN                          WMAGVN
     I              DNABVN                          WMABVN
     I              DNABDT                          WMABDT
     I              DNABTM                          WMABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N : MAP Oms Warehouse Code
     I                                        1   3 P1J8NB
      * N : MAP CC Company Number
     I                                    P   4   50P1HONB
      * N : MAP Oms Application Code
     I                                        6  11 P1C7CD
      * N : MAP Oms SalesPerson Code
     I                                       12  14 P1C8CD
      * N : MAP Oms Allow Multi-Company
     I                                       15  15 P1G8ST
      * N : MAP Oms Default Printer
     I                                       16  25 P1G9ST
      * N : MAP Oms Name
     I                                       26  55 P1EUTX
      * N : MAP Oms System Value Alpha
     I                                       56  95 P1EVTX
      * N : MAP Oms Access Denied (Y/N)
     I                                       96  96 P1HAST
     IP2PARM      DS
      * FLD: Company Control HPE
      * N : MAP Next Buy Order Number
     I                                    P   1   40P2BSNB
     IP3PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P3ETTX
      * N : MAP PRT Printer Device
     I                                       26  35 P3ACVN
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P3AKST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P3AMST
      * N : MAP PRT Copies
     I                                       44  450P3AKNB
      * N : MAP PRT Night Queue Run Sts
     I                                       46  46 P3ALST
      * N : MAP PRT Night Queue
     I                                       47  56 P3AIVN
     IP4PARM      DS
      * N :  System Value Alpha    USR
     I                                        1  40 P4KBTX
     IP5PARM      DS
      * I :  TRH Repayment ID
     I                                    P   1   30P5CDNZ
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(EXPRT-    1 256 #S0001
     I              'HPESM) LOG(4 00 *SEC-
     I              'LVL)                '
     I            DS
     I I            'SBMJOB     JOB(HEADK-    1 256 #S0002
     I              'ILLSM) LOG(4 00 *SEC-
     I              'LVL)                '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'SBM Pay Prd Edit'
      * PRT Printer Device
     I                                        1  10 ZA0001
      * PRT Hold Output Sts
     I                                       11  14 ZA0002
      * PRT Save Output Sts
     I                                       15  18 ZA0003
      * PRT Copies
     I                                    P  19  200ZA0004
      * PRT Night Queue
     I                                       21  30 ZA0005
      * CC Company Number
     I                                    P  31  320ZA0006
      * Oms System Value Alpha
     I                                       33  72 ZA0007
      * Message data for 'Payment Process not Allow'
      * Sel Processing
     I                                        1   1 ZA0008
      * Message data for 'Cannot Run Pymt Post-Bal'
      * Sel Processing
     I                                        1   1 ZA0009
      * Message data for 'SBM Pay Prd Post'
      * PRT Printer Device
     I                                        1  10 ZA0010
      * PRT Hold Output Sts
     I                                       11  14 ZA0011
      * PRT Save Output Sts
     I                                       15  18 ZA0012
      * PRT Copies
     I                                    P  19  200ZA0013
      * PRT Night Queue
     I                                       21  30 ZA0014
      * CC Company Number
     I                                    P  31  320ZA0015
      * Oms System Value Alpha
     I                                       33  72 ZA0016
      * Message data for 'SBM Pay Competitor Prcss'
      * PRT Printer Device
     I                                        1  10 ZA0017
      * PRT Hold Output Sts
     I                                       11  14 ZA0018
      * PRT Save Output Sts
     I                                       15  18 ZA0019
      * PRT Copies
     I                                    P  19  200ZA0020
      * PRT Night Queue
     I                                       21  30 ZA0021
      * CC Company Number
     I                                    P  31  320ZA0022
      * Date Alpha USR
     I                                       33  39 ZA0023
      * Oms System Value Alpha
     I                                       40  79 ZA0024
      * Message data for 'Cannot Run Pymt Post-Errs'
      * Sel Processing
     I                                        1   1 ZA0025
      * Message data for 'Must run Payment First'
      * Sel Processing
     I                                        1   1 ZA0026
      * Message data for 'Cannot Run Pymt Post-Repy'
      * Sel Processing
     I                                        1   1 ZA0027
      * Message data for 'Payment Post is Active'
      * Payment Sel Prcssng Usr
     I                                        1   1 ZA0028
      * Message data for 'Payment Post Date Error'
      * Payment Sel Prcssng Usr
     I                                        1   1 ZA0029
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0030
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P5CDNZ    PARM           WP0001  50       TRH Repayment I
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
     C                     MOVELWUCRTX    #DYVTX           Text Hdr 1 Usr
      * CASE: DTL.Payment Sel Prcssng Usr is Payment Edit
     C           #DMBST    IFEQ '1'                        *IF
      * Payment Edit
      * CASE: DTL.Pmt Current Payment Step is Less or Equal to Step 5
     C           #DM1NB    IFLE 00005                      *IF
      * Pmt Print Options Size XF - STR Order Management Sys  * 
     C                     CALL 'PDV8PVR'              90  Pmt Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,001   WQ0001 25        PRT Description
     C           P3ACVN    PARM P3ACVN    WQ0002 10        PRT Printer Dev
     C           P3AKST    PARM P3AKST    WQ0003  4        PRT Hold Output
     C           P3AMST    PARM P3AMST    WQ0004  4        PRT Save Output
     C           P3AKNB    PARM P3AKNB    WQ0005  20       PRT Copies
     C                     PARM 'N'       WQ0006  1        PRT Night Queue
     C           P3AIVN    PARM P3AIVN    WQ0007 10        PRT Night Queue
     C                     PARM 'P/S'     WQ0008  6        Oms Application
     C                     PARM '2'       WQ0009  1        Paper Type Usr-
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: PAR.TRH Repayment ID is Entered
     C           P5CDNZ    IFNE *ZERO                      *IF
      * Dlt Crc Dtl & Tat D/A XF - Tattoo Repayment Detail  * 
     C                     CALL 'PWOGXFR'              90  Dlt Crc Dtl & T
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0010  30       CC Company Numb
     C                     PARM P5CDNZ    WQ0011  50       TRH Repayment I
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWOGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Setup message data for message
     C                     MOVELP3ACVN    ZA0001           PRT Printer Dev
     C                     MOVELP3AKST    ZA0002           PRT Hold Output
     C                     MOVELP3AMST    ZA0003           PRT Save Output
     C                     Z-ADDP3AKNB    ZA0004           PRT Copies
     C                     MOVELP3AIVN    ZA0005           PRT Night Queue
     C                     Z-ADD#1HONB    ZA0006           CC Company Numb
     C                     MOVEL#PEVTX    ZA0007           Oms System Valu
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0456' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMBST    ZA0008           Payment Sel Prc
      * Send message 'Payment Process not Allow'
     C                     MOVEL'PRK0453' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Payment Sel Prcssng Usr is Payment Posting
     C           #DMBST    IFEQ '2'                        *IF
      * Payment Post
      * CASE: DTL.Pmt Current Payment Step is Greater then or Equal 5
     C           #DM1NB    IFGE 00005                      *IF
      * E12610 - Add Tattoo Balancing Error
      * Post if No errors were found during the Payment Edit
      * CASE: No Errors - Pymt, Cmsn, Trucker, Producer, Triumph
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : DTL.Pmt Payment Error is No Errors
      *   |- c2    : DTL.PP Commission Paym Error is No Errors
      *   |- c3    : DTL.PP Trucker Error is No Errors
      *   |- c4    : DTL.PP Producer Error is No Errors
      *   |- c5    : DTL.PP Triumph Owned Error is No Errors
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DKLST    IFEQ 'N'                        *IF
     C           #DKHST    IFEQ 'N'                        *IF
     C           #DIYSS    IFEQ 'N'                        *IF
     C           #DIZSS    IFEQ 'N'                        *IF
     C           #DJNSS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Balance errors are checked and errors exist, do not post
      * CASE: Check for Bal Errors is Yes AND Bal Errors exist
      *  - c1 AND c2
      *   |- c1    : LCL.Check for Balance Errors is Yes
      *   |- c2    : DTL.PP Tattoo Balance Error is Errors
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'Y'                        *IF
     C           #DKCSS    IFEQ 'E'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DMBST    ZA0009           Payment Sel Prc
      * Send message 'Cannot Run Pymt Post-Bal'
     C                     MOVEL'PRK1494' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Pmt Print Options Size XF - STR Order Management Sys  * 
     C                     CALL 'PDV8PVR'              90  Pmt Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,002   WQ0012 25        PRT Description
     C           P3ACVN    PARM P3ACVN    WQ0013 10        PRT Printer Dev
     C           P3AKST    PARM P3AKST    WQ0014  4        PRT Hold Output
     C           P3AMST    PARM P3AMST    WQ0015  4        PRT Save Output
     C           P3AKNB    PARM P3AKNB    WQ0016  20       PRT Copies
     C                     PARM 'N'       WQ0017  1        PRT Night Queue
     C           P3AIVN    PARM P3AIVN    WQ0018 10        PRT Night Queue
     C                     PARM 'P/S'     WQ0019  6        Oms Application
     C                     PARM '1'       WQ0020  1        Paper Type Usr-
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVELP3ACVN    ZA0010           PRT Printer Dev
     C                     MOVELP3AKST    ZA0011           PRT Hold Output
     C                     MOVELP3AMST    ZA0012           PRT Save Output
     C                     Z-ADDP3AKNB    ZA0013           PRT Copies
     C                     MOVELP3AIVN    ZA0014           PRT Night Queue
     C                     Z-ADD#1HONB    ZA0015           CC Company Numb
     C                     MOVEL#PEVTX    ZA0016           Oms System Valu
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0457' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     MOVEL*BLANK    WUCZCD           Date Alpha USR
     C                     MOVEL#DCKDT    WUCZCD           Date Alpha USR
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0021  30       BOH Company Num
     C                     PARM @CN,003   WQ0022 10        Company Value C
     C           P4KBTX    PARM *BLANK    WQ0023 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELP4KBTX    P3ACVN           PRT Printer Dev
      * Setup message data for message
     C                     MOVELP3ACVN    ZA0017           PRT Printer Dev
     C                     MOVELP3AKST    ZA0018           PRT Hold Output
     C                     MOVELP3AMST    ZA0019           PRT Save Output
     C                     Z-ADDP3AKNB    ZA0020           PRT Copies
     C                     MOVEL@CN,004   ZA0021           PRT Night Queue
     C                     Z-ADD#1HONB    ZA0022           CC Company Numb
     C                     MOVELWUCZCD    ZA0023           Date Alpha USR
     C                     MOVEL#PEVTX    ZA0024           Oms System Valu
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0732' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      * SBMJOB: Bld Exp Rate HPE Sum  XF - Export Rate HPE Summary  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PKX5XFR '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELW0RTN     #SSTR     P      *Return code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1HONB    #SPAK  309       CC Company Numb
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#DCKDT    #SPAK  309       TH Kill Date
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Export Rate Cal
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PKX5XFR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * SBMJOB: Bld Head Kill/Cut Wk  XF - Head Killed & Cut Summary  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0002    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PLAIXFR '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELW0RTN     #SSTR     P      *Return code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1HONB    #SPAK  309       CC Company Numb
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#DCKDT    #SPAK  309       TH Kill Date
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PLAIXFR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLAIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMBST    ZA0025           Payment Sel Prc
      * Send message 'Cannot Run Pymt Post-Errs'
     C                     MOVEL'PRK1493' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DMBST    ZA0026           Payment Sel Prc
      * Send message 'Must run Payment First'
     C                     MOVEL'PRK0465' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Payment Sel Prcssng Usr
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DMBST'  IFEQ YPMTFD
      * Payment Sel Prcssng Usr
     C                     MOVEL#DMBST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHMBST
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZHMBST
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZHMBST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHMBST
     C                     ENDSL
     C                     EXFMTZGMBST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHMBST    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZHMBST    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C           ZHMBST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DMBST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * F4 = Prompt for Cutout Matrix
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * SEL: Cutout Matrix
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Cutout Matrix Code USR
      *   |- c2    : PGM.*Cursor field <IS> DTL.Effective Month/Day USR
      *   '-
     C           W0CFL     IFEQ '#DC9CD'                   *IF
     C           W0CFL     OREQ '#DKLNB'                   *OR
      * Sel Cutout Matrix     SR - STR Order Management Sys  * 
     C                     CALL 'PDAZSRR'              90  Sel Cutout Matr
     C                     PARM *BLANK    W0RTN   7
     C           #1HONB    PARM #1HONB    WQ0024  30       Company Number
     C           #DC9CD    PARM #DC9CD    WQ0025  6        Cutout Matrix C
     C           #DKLNB    PARM #DKLNB    WQ0026  40       Effective Month
     C           #DKKTX    PARM *BLANK    WQ0027 30        Description 30
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAZSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993233*
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Cutout Matrix     XF - STR Order Management Sys  * 
     C                     CALL 'PDLGXFR'              90  Val Cutout Matr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0028  30       Company Number
     C                     PARM #DC9CD    WQ0029  6        Cutout Matrix C
     C                     PARM #DKLNB    WQ0030  40       Effective Month
     C           #DKKTX    PARM *BLANK    WQ0031 30        Description 30
     C           WUH7ST    PARM *BLANK    WQ0032  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993233*
     C                     END
     C                     END                             *FI
      * F5 = Display Market Prices for WCB or HOG CUTOUT
      * CASE: DTL.*CMD key is CF05
     C           *IN05     IFEQ '1'                        *IF
      * Dsp Market PricesWCB/HOGC - STR Order Management Sys  * 
     C                     CALL 'PPV6DFR'              90  Dsp Market Pric
     C           WULMST    PARM *BLANK    WQ0033  7        Return Code USR
     C                     PARM #DCKDT    WQ0034  70       Pmt Current Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPV6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
      *  2/21/2019 JBB E14234 - Repayment Enhancements Phase 2
      *  8/01/2019 JBB E15279 - Stop Payment Post if Repayment
      * If selection value is 2 for Post, check if Repay Flag is Yes
      * CASE: Payment Process is Post AND Repay Flag is Yes
      *  - c1 AND c2
      *   |- c1    : DTL.Payment Sel Prcssng Usr is Payment Posting
      *   |- c2    : LCL.PP Repayment Status is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DMBST    IFEQ '2'                        *IF
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DMBST    ZA0027           Payment Sel Prc
      * Send message 'Cannot Run Pymt Post-Repy'
     C                     MOVEL'PRK1546' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * CASE: DTL.Payment Sel Prcssng Usr is Payment Edit
     C           #DMBST    IFEQ '1'                        *IF
      * 8/29/2007 slm
      * Get this validation out of the way for TF and will come back
      * to not hard code -- Gate Security system does not need this valid
      * 8/29/2007 slm This is the 2nd time to get the company value loade
      * The Buy Order Load information with IN/OUT/R  on the Gate Securit
      * does not need the following validation - due to no OUT nor Weight
      * This is not hard coded for company 360
     C                     MOVEL*BLANK    WUABST           @Status (Yes/No
      * CASE: LCL.Valadate Wgt IN/OUT/R USR is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * Rtv BOL Scale Sts Err RT - Buy Order Load  * 
     C                     EXSR SARVGN
      * CASE: WRK.@Status (Yes/No) is Yes
     C           WUABST    IFEQ 'Y'                        *IF
      * Send message 'Buy Order Load Weight inc'
     C                     MOVEL'PRK0867' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      *  1/09/2019 JBB E14281 - Pricing Error Report processing
      * Rtv Price Err Comp Val IF
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Rtv Company Values    XF - STR Order Management Sys  * HPEPYPRERR
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0035  30       BOH Company Num
     C                     PARM @CN,005   WQ0036 10        Company Value C
     C           YL0007    PARM *BLANK    WQ0037 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Break out individual values from the Company Value record
      * CASE: *OTHERWISE
     C                     Z-ADD1         YRSW00
     C                     Z-ADD7         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0007:ZQ YL0004    P  90  Co Chks for Pri
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD1         YRSW00
     C                     Z-ADD18        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0007:ZQ YL0005    P  90  Error Level - W
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD1         YRSW00
     C                     Z-ADD26        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0007:ZQ YL0006    P  90  Error Level - P
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * If Company runs Price Error Report, check for Pricing Error
      * CASE: LCL.Co Chks for Price Errors is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * Determine is error based on Error Level - Pricing
      * CASE: Error Level-Warn/Hard=H AND Error Level-Pricing=H
      *  - c1 AND c2
      *   |- c1    : LCL.Error Level - Warn/Hard is Hard
      *   |- c2    : LCL.Error Level - Pricing is Hard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ 'H'                        *IF
     C           YL0006    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Pymt Price Error exists'
     C                     MOVEL'PRK1523' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val EvalTrnUplComProc RT - Eval Trans UPL Comment  * 
     C                     EXSR SBRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0008    IFEQ 'Y'                        *IF
      * Send message 'Eval Trans Upl Com Found'
     C                     MOVEL'PRK1243' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
      * 11/08/2021 JBB HD86845 - Don't Submit Post if already running
      * Rtv Payment Processing RT - Payment Processing Parms  * Rtv Step
     C                     EXSR SCRVGN
      * If Payment Step > 5, Payment Post is running for Payment Date
      * CASE: Payment Step 6 to 99999 AND Payment Date matches
      *  - c1 AND c2
      *   |- c1    : LCL.Pmt Current Payment Step is Payment Post Process
      *   |- c2    : LCL.Pmt Current Payment Date EQ DTL.Pmt Current Paym
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFGE 6                          *IF
     C           YL0010    ANDLE99999
     C           YL0009    IFEQ #DCKDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DMBST    ZA0028           Payment Sel Prc
      * Send message 'Payment Post is Active'
     C                     MOVEL'PRK1617' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: LCL.Pmt Current Payment Date NE DTL.Pmt Current Payment Dat
     C           YL0009    IFNE #DCKDT                     *IF
      * Setup message data for message
     C                     MOVEL#DMBST    ZA0029           Payment Sel Prc
      * Send message 'Payment Post Date Error'
     C                     MOVEL'PRK1618' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Payment Sel Prcssng Usr required
     C           #DMBST    IFEQ *BLANK                     IF
     C           *IN79     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #DKLST    IFEQ 'N'                        *IF
     C           #DKLST    OREQ *BLANK
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #DKHST    IFEQ 'N'                        *IF
     C           #DKHST    OREQ *BLANK
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #1HONB    IFNE 440                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C                     MOVEL'0'       *IN72
     C           #DMBST    IFEQ *BLANK                     *IF
     C           #DMBST    OREQ '1'
     C                     MOVEL'1'       *IN73
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVELP3ETTX    #PETTX           PRT Description
     C                     MOVELP3ACVN    #PACVN           PRT Printer Dev
     C                     MOVELP3AKST    #PAKST           PRT Hold Output
     C                     MOVELP3AMST    #PAMST           PRT Save Output
     C                     Z-ADDP3AKNB    #PAKNB           PRT Copies
     C                     MOVELP3ALST    #PALST           PRT Night Queue
     C                     MOVELP3AIVN    #PAIVN           PRT Night Queue
     C                     MOVELP1J8NB    #PJ8NB           Oms Warehouse C
     C                     MOVELP1C7CD    #PC7CD           Oms Application
     C                     Z-ADDP2BSNB    #1BSNB           Next Buy Order
     C                     MOVELP1C8CD    #PC8CD           Oms SalesPerson
     C                     MOVELP1G8ST    #PG8ST           Oms Allow Multi
     C                     MOVELP1G9ST    #PG9ST           Oms Default Pri
     C                     MOVELP1EUTX    #PEUTX           Oms Name
     C                     Z-ADD*ZERO     #1B1DT           Current Kill Da
     C                     MOVELP1EVTX    #PEVTX           Oms System Valu
     C                     Z-ADD*ZERO     #1B2DT           Next Kill Date
     C                     MOVELP1HAST    #PHAST           Oms Access Deni
     C                     Z-ADD*ZERO     #1H4NB           Last Drive Card
     C                     Z-ADD*ZERO     #1K3NB           Last Tattoo Nbr
     C                     Z-ADD*ZERO     #1CDDT           Current Product
     C                     Z-ADD*ZERO     #1CEDT           Next Production
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     MOVEL*BLANK    #DMBST           Payment Sel Prc
     C                     MOVEL*BLANK    #DIDT1           Producer Pymt T
     C                     Z-ADD*ZERO     #DCKDT           Pmt Current Pay
      * Clear external version also
     C                     Z-ADD*ZERO     VDCKDT
     C                     Z-ADD*ZERO     #DM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    #DKLST           Pmt Payment Err
     C                     MOVEL*BLANK    #DKHST           PP Commission P
     C                     MOVEL*BLANK    #DIYSS           PP Trucker Erro
     C                     MOVEL*BLANK    #DIZSS           PP Producer Err
     C                     MOVEL*BLANK    #DKCSS           PP Tattoo Balan
     C                     MOVEL*BLANK    #DJNSS           PP Triumph Owne
     C                     MOVEL*BLANK    #DC9CD           Cutout Matrix C
     C                     MOVEL*BLANK    #DKKTX           Description 30
     C                     Z-ADD*ZERO     #DKLNB           Effective Month
     C                     MOVEL*BLANK    #DYVTX           Text Hdr 1 Usr
      * USER: Load screen
      * CASE: WRK.First Time Flag Usr EQ WRK.Blank USR
     C           WUHBST    IFEQ WUCRTX                     *IF
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     MOVEL'Y'       WUHJST           Display Print P
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Rtv Dflt Cut Mtx 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDKHXFR'              90  Rtv Dflt Cut Mt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0043  30       BOH Company Num
     C           #DC9CD    PARM *BLANK    WQ0044  6        Cutout Matrix C
     C           #DKLNB    PARM *ZERO     WQ0045  40       Effective Month
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993233*
     C                     END
      * Val Cutout Matrix     XF - STR Order Management Sys  * 
     C                     CALL 'PDLGXFR'              90  Val Cutout Matr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0046  30       Company Number
     C                     PARM #DC9CD    WQ0047  6        Cutout Matrix C
     C                     PARM #DKLNB    WQ0048  40       Effective Month
     C           #DKKTX    PARM *BLANK    WQ0049 30        Description 30
     C           WUH7ST    PARM *BLANK    WQ0050  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993233*
     C                     END
     C                     MOVEL@CN,006   #DIDT1           Producer Pymt T
     C                     END                             *FI
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0051  30       CC Company Numb
     C           P1EUTX    PARM *BLANK    WQ0052 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0053  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HONB    ZA0030           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
      * Rtv Payment Processing RT - Payment Processing Parms  * Repayment
     C                     EXSR SDRVGN
      * If Repayment flag = Y, this is a repayment
      * CASE: LCL.PP Repayment Status is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,007   #DIDT1           Producer Pymt T
      * Rtv Repayment Date    RT - Tattoo Repayment Header  * 
     C                     EXSR SERVGN
      * If new Repayment method is being used, update PPP with date/step
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.TRH Payment Date is Entered
      *   |- c2    : LCL.TRH Payment Step NE WRK.Zero USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFNE *ZERO                      *IF
     C           YL0012    IFNE WUE9NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * check for these being 0 before updating
      * Chg Payment Date/Step  XF - Payment Processing Parms  * 
     C                     CALL 'PKXAXFR'              90  Chg Payment Dat
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0054  30       CC Company Numb
     C                     PARM YL0011    WQ0055  70       Pmt Current Pay
     C                     PARM YL0012    WQ0056  50       Pmt Current Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'1'       #DMBST           Payment Sel Prc
     C                     END                             *FI
      * E7519 JJH 06/26/17 - Only print Trucker/Producer Error reports
      *   when there are errors.
      * E7519 Val Trk & also the Producer for a Missing m3 supplier
     C                     EXSR UBSUBR                     E7519 Val Trk &
      * E9904 JBB 07/31/17 - Only print Triumph Owned Error reports when
      *   there are errors.
      * E9904 Validate Src/BO Type and Site ID's for TO records. Company
     C                     EXSR UCSUBR                     E9904 Validate
      * E12610 JJH 02/21/18 - Tattoo Balance Error
      * Validate each Tattoo Header is Balanced
      * CASE: *OTHERWISE
      * Val Tattoo Balance    RT - Tattoo Header  * 
     C                     EXSR SPRVGN
      * CASE: DTL.PP Tattoo Balance Error is Errors
     C           #DKCSS    IFEQ 'E'                        *IF
      * Prt Tattoo Balance Val CL - STR Batch Processing  * 
     C                     CALL 'PWF7UPC'              90  Prt Tattoo Bala
     C                     PARM @CN,008   WQ0107 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0108  4        PRT Hold Output
     C                     PARM '*YES'    WQ0109  4        PRT Save Output
     C                     PARM 01        WQ0110  20       PRT Copies
     C                     PARM #1HONB    WQ0111  30       CC Company Numb
     C                     PARM P1EUTX    WQ0112 30        Oms Name
     C                     PARM P1EVTX    WQ0113 40        Oms System Valu
     C                     PARM #DCKDT    WQ0114  70       Pmt Current Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF7UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Pmt Current Payment Date to display format
      * Convert date
     C           1000000   ADD  #DCKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDCKDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv BOL Scale Sts Err RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUABST           @Status (Yes/No
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WACQDT    WQSA02           BOL Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOL Kill Date
      * Setup key
     C                     Z-ADD#1HONB    WQSA01           BOH Company Num
     C                     Z-ADD#DCKDT    WQSA02           BOL Kill Date
      * Establish starting position
     C           KRSSA     SETLL@AXCPB1                    *
     C           KRSSA     READE@AXCPB1                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUABST           @Status (Yes/No
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@AXCPB1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val EvalTrnUplComProc RT - Eval Trans UPL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHKST    WQSB01           EA Company Numb
     C           *LIKE     DEFN WBB7DT    WQSB02           EA Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           EA Company Numb
     C                     KFLD           WQSB02           EA Kill Date
      * Setup key
     C                     Z-ADD#1HONB    WQSB01           EA Company Numb
     C                     Z-ADD#1B1DT    WQSB02           EA Kill Date
      * Establish starting position
     C           KRSSB     SETLL@BAREQF                    *
     C           KRSSB     READE@BAREQF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1233' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0008           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Event Process is Completed
     C           WBEESS    IFEQ 'C'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0008           Record Found US
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@BAREQF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * Rtv Step
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCHONB           CC Company Numb
      * Setup key
     C                     Z-ADD#1HONB    WCHONB           CC Company Numb
      * Establish starting position
     C           KRSSC     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0009           Pmt Current Pay
     C                     Z-ADD*ZERO     YL0010           Pmt Current Pay
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCCKDT    YL0009           Pmt Current Pay
     C                     Z-ADDWCM1NB    YL0010           Pmt Current Pay
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * Repaymen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCHONB           CC Company Numb
      * Setup key
     C                     Z-ADD#1HONB    WCHONB           CC Company Numb
      * Establish starting position
     C           KRSSD     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DCKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     #DM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    #DKHST           PP Commission P
     C                     MOVEL*BLANK    #DKLST           PP Payment Erro
     C                     Z-ADD*ZERO     WUPINB           PP Unused Nbr 1
     C                     MOVEL*BLANK    YL0002           PP Repayment St
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCCKDT    #DCKDT           Pmt Current Pay
     C                     Z-ADDWCM1NB    #DM1NB           Pmt Current Pay
     C                     MOVELWCKHST    #DKHST           PP Commission P
     C                     MOVELWCKJST    #DKLST           PP Payment Erro
     C                     Z-ADDWCPINB    WUPINB           PP Unused Nbr 1
     C                     MOVELWCKKST    YL0002           PP Repayment St
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Repayment Date    RT - Tattoo Repayment Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHONB    WQSE01           CC Company Numb
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CC Company Numb
      * Setup key
     C                     Z-ADD#1HONB    WQSE01           CC Company Numb
      * Establish starting position
     C           KRSSE     SETLL@AWCPA0                    *
     C           KRSSE     READE@AWCPA0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1564' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0011           TRH Payment Dat
     C                     Z-ADD*ZERO     YL0012           TRH Payment Ste
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * rmc  added Created sts here
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.TRH Repayment Status is In Progress
      *   |- c2    : DB1.TRH Repayment Status is Created
      *   '-
     C           WDMASS    IFEQ 'I'                        *IF
     C           WDMASS    OREQ 'C'                        *OR
     C                     Z-ADDWDIFDT    YL0011           TRH Payment Dat
     C                     Z-ADDWDCTNZ    YL0012           TRH Payment Ste
     C                     END                             *FI
     C           KRSSE     READE@AWCPA0                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Trucker M3/E1 Vnd RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * SDN440 RMC 5/20/21  if E1 is live , validate VND
     C                     MOVEL'N'       #DIYSS           PP Trucker Erro
      * get live with M3
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0057  30       BOH Company Num
     C                     PARM 'M3LIVE'  WQ0058 10        Company Value C
     C           WUG4SS    PARM *BLANK    WQ0059 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0060  30       BOH Company Num
     C                     PARM 'E1LIVE'  WQ0061 10        Company Value C
     C           WUMESS    PARM *BLANK    WQ0062 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSF01           BOH Company Num
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
      * Setup key
     C                     Z-ADD#1HONB    WQSF01           BOH Company Num
      * Establish starting position
     C           KRSSF     SETLL@AXCPDV                    *
     C           KRSSF     READE@AXCPDV                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOL Kill Date LE PAR.Pmt Current Payment Date
     C           WECQDT    IFLE #DCKDT                     *IF
      * Rtv Trucker Vnd Add#M3RT - Trucker  * 
     C                     EXSR SGRVGN
      * Check for  M3
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.TRK M3 Supplier Id is Not Entered
      *   |- c2    : WRK.Live with M3   USR is Live or Parallel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0014    IFEQ *BLANK                     *IF
     C           WUG4SS    IFEQ 'P'                        *IF
     C           WUG4SS    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       #DIYSS           PP Trucker Erro
     C                     END                             *FI
      * Check E1 Vendor -- added for SDN440
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.TRK VND Address Number is Zero
      *   |- c2    : WRK.Live with E1 is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0013    IFEQ 0                          *IF
     C           WUMESS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       #DIYSS           PP Trucker Erro
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@AXCPDV                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Trucker Vnd Add#M3RT - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFBNCD           TRK Trucker Cod
      * Setup key
     C                     MOVELWEBNCD    WFBNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSG     CHAIN@BAREDS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0079' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0013           TRK VND Address
     C                     MOVEL*BLANK    YL0014           TRK M3 Supplier
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFGMNB    YL0013           TRK VND Address
     C                     MOVELWFC3TX    YL0014           TRK M3 Supplier
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'999'     W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Producer M3/E1 Vnd RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Initialize Errros
     C                     MOVEL'N'       #DIZSS           PP Producer Err
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSH01           BOH Company Num
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WGB0DT           TH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
      * Setup key
     C                     Z-ADD#1HONB    WQSH01           BOH Company Num
     C                     Z-ADD#DCKDT    WGB0DT           TH Kill Date
      * Establish starting position
     C           KPSSH     SETLL@A1CPXX                    *
     C           KRSSH     READE@A1CPXX                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGHMNB    WQ0073  30       BOH Company Num
     C                     PARM 'M3LIVE'  WQ0074 10        Company Value C
     C           YL0015    PARM *BLANK    WQ0075 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGHMNB    WQ0076  30       BOH Company Num
     C                     PARM 'E1LIVE'  WQ0077 10        Company Value C
     C           YL0016    PARM *BLANK    WQ0078 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Get Producer M3 Supplier ID
      * Rtv Prdcr Vendor#,M3  RT - Producer  * 
     C                     EXSR SIRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.M3 Supplier ID is Not found
      *   |- c2    : LCL.Live with M3   USR is Live or Parallel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0018    IFEQ *BLANK                     *IF
     C           YL0015    IFEQ 'P'                        *IF
     C           YL0015    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       #DIZSS           PP Producer Err
     C                     END                             *FI
      * SDN 440 -- added for E1
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Live with E1 is Yes
      *   |- c2    : LCL.PD VND Address Number is Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0016    IFEQ 'Y'                        *IF
     C           YL0017    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       #DIZSS           PP Producer Err
     C                     END                             *FI
     C           KRSSH     READE@A1CPXX                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,M3  RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHABCD           PD Producer Cod
      * Setup key
     C                     MOVELWGABCD    WHABCD           PD Producer Cod
      * Establish starting position
     C           KRSSI     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           PD VND Address
     C                     MOVEL*BLANK    YL0018           M3 Supplier ID
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHGCNB    YL0017           PD VND Address
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR SJRVGN
     C                     GOTO SIEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIABCD           PD Producer Cod
      * Setup key
     C                     MOVELWHABCD    WIABCD           PD Producer Cod
      * Establish starting position
     C           KRSSJ     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0018           M3 Supplier ID
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIQHCD    YL0018           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Source/BO Type    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0019           PP Source/BO Ty
      * Currently, only process for Sioux City
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.BOH Company Number is Sioux City
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HONB    IFEQ 440                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJB0DT    WQSK01           TH Kill Date
     C           *LIKE     DEFN WJHMNB    WQSK02           BOH Company Num
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           TH Kill Date
     C                     KFLD           WQSK02           BOH Company Num
      * Setup key
     C                     Z-ADD#DCKDT    WQSK01           TH Kill Date
     C                     Z-ADD#1HONB    WQSK02           BOH Company Num
      * Establish starting position
     C           KRSSK     SETLL@A1CPQX                    *
     C           KRSSK     READE@A1CPQX                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Validate for Sioux City (440) only
      * CASE: DB1.BOH Company Number is Sioux City
     C           WJHMNB    IFEQ 440                        *IF
      * If Producer Source is Triumph Owned (TO)
      * CASE: DB1.TH Source Code is Triumph Member (Owner)
     C           WJLKST    IFEQ 'TO'                       *IF
      * Rtv Buy Order Type - Buy Order Header  * 
     C                     EXSR SLRVGN
      * Chk Src/BO Type XREF  RT - Source/Buy Order Typ XREF  * 
     C                     EXSR SMRVGN
      * If record not found, signal error and quit reading records
      * CASE:
      *  - NOTc1
      *   |- c1    : PGM.*Return code is *Normal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       YL0019           PP Source/BO Ty
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@A1CPQX                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Type - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWJHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWJBNNB    WKBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSL     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKA5ST    YL0020           BOH Buy Order T
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Chk Src/BO Type XREF  RT - Source/Buy Order Typ XREF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLAACD           SR Source Code
     C                     KFLD           WLA5ST           BOH Buy Order T
      * Setup key
     C                     MOVELWJLKST    WLAACD           SR Source Code
     C                     MOVELYL0020    WLA5ST           BOH Buy Order T
      * Establish starting position
     C           KRSSM     CHAIN@AIREX2              90    *
      * Data record not found
     C   90                MOVEL'PRK1454' W0RTN   7
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Tattoo Site ID    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0022           PP Site ID Erro
      * Currently, only process for Sioux City
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.BOH Company Number is Sioux City
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HONB    IFEQ 440                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJB0DT    WQSN01           TH Kill Date
     C           *LIKE     DEFN WJHMNB    WQSN02           BOH Company Num
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           TH Kill Date
     C                     KFLD           WQSN02           BOH Company Num
      * Setup key
     C                     Z-ADD#DCKDT    WQSN01           TH Kill Date
     C                     Z-ADD#1HONB    WQSN02           BOH Company Num
      * Establish starting position
     C           KRSSN     SETLL@A1CPQX                    *
     C           KRSSN     READE@A1CPQX                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Only process Source Code = TO
      * CASE: DB1.TH Source Code is Triumph Member (Owner)
     C           WJLKST    IFEQ 'TO'                       *IF
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SORVGN
      * If Site ID is blank, signal error and quit reading records
      * CASE: LCL.PS Site ID is *Blank
     C           YL0023    IFEQ *BLANK                     *IF
      * Only an error if Hog Classification is not Resale
      * CASE:
      *  - NOTc1
      *   |- c1    : DB1.HC Class Code is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WJBECD    IFEQ 'RSL'                      *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'E'       YL0022           PP Site ID Erro
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@A1CPQX                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
     C                     KFLD           WMBONB           BOL Load Number
     C                     KFLD           WMCVNB           TH Tattoo Numbe
     C                     KFLD           WMB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWJHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWJBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDWJBONB    WMBONB           BOL Load Number
     C                     Z-ADDWJCVNB    WMCVNB           TH Tattoo Numbe
     C                     Z-ADDWJB0DT    WMB0DT           TH Kill Date
      * Establish starting position
     C           KRSSO     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0023           PS Site ID
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMNYCD    YL0023           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Val Tattoo Balance    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Initialize Errros
     C                     MOVEL'N'       #DKCSS           PP Tattoo Balan
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSP01           BOH Company Num
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WGB0DT           TH Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
      * Setup key
     C                     Z-ADD#1HONB    WQSP01           BOH Company Num
     C                     Z-ADD#DCKDT    WGB0DT           TH Kill Date
      * Establish starting position
     C           KPSSP     SETLL@A1CPXX                    *
     C           KRSSP     READE@A1CPXX                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Check for balance error if not a held over
      * CASE: Held Over Qty > 0 OR Held Over Completion Date > 0
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is Greater than 0
      *   '-
     C           WGH9NB    IFGT 0                          *IF
     C           WGBSDT    ORGT 0                          *OR
      * Never flag a Held Over record as an Error
     C                     ELSE
      * CASE: DB1.TH Kill Balancing Sts is Error
     C           WGDWST    IFEQ 'E'                        *IF
     C                     MOVEL'E'       #DKCSS           PP Tattoo Balan
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@A1CPXX                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * Repaymen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WCHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WCHONB           CC Company Numb
      * Establish starting position
     C           KRSSQ     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           PP Repayment St
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCKKST    YL0002           PP Repayment St
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  2/07/2019 JBB E14281 - Zero Prices on BOL
      *                         Function created.  This function retrieve
      *                         the Company Value record for HPEPYPRCERR.
      *                         Within the retrieved record, there are
      *                         three fields.  This function passes back
      *                         the three values.
      *                         Position  7 - Does the Company print the
      *                                       Price Errors report during
      *                                       the Payment Edit process.
      *                         Position 18 - What is the highest error
      *                                       level that will be checked.
      *                         Position 26 - What is the highest error
      *                                       level found during the
      *                                       Payment Edit process.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * E7519 Val Trk & also the Producer for a Missing m3 supplier
      *================================================================
      * Trucker validated for missing M3 Supplier
      * SDN 440 - RMC 5/20/21 E1-Trucker validated for missing  TRK VND a
      * Val Trucker M3/E1 Vnd RT - Buy Order Load  * 
     C                     EXSR SFRVGN
      * CASE: DTL.PP Trucker Error is Errors
     C           #DIYSS    IFEQ 'E'                        *IF
      * Prt Trucker PaymentVal CL - STR Batch Processing  * 
     C                     CALL 'PWBKUPC'              90  Prt Trucker Pay
     C                     PARM @CN,008   WQ0063 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0064  4        PRT Hold Output
     C                     PARM '*YES'    WQ0065  4        PRT Save Output
     C                     PARM 01        WQ0066  20       PRT Copies
     C                     PARM #1HONB    WQ0067  30       CC Company Numb
     C                     PARM P1EUTX    WQ0068 30        Oms Name
     C                     PARM P1EVTX    WQ0069 40        Oms System Valu
     C                     PARM #DCKDT    WQ0070  70       Pmt Current Pay
     C           WULMST    PARM WULMST    WQ0071  7        Return Code USR
     C           #DIYSS    PARM #DIYSS    WQ0072  1        PP Trucker Erro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBKUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Producer validated for missing M3 Supplier
      * SDN 440 - RMC 5/20/21 Producer validated for missing PD VND addre
      * Val Producer M3/E1 Vnd RT - Tattoo Header  * 
     C                     EXSR SHRVGN
      * CASE: DTL.PP Producer Error is Errors
     C           #DIZSS    IFEQ 'E'                        *IF
      * Prt Pre-Chk EditPrdM3EdPF - Tattoo Header  * 
     C                     CALL 'PWCQPFR'              90  Prt Pre-Chk Edi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0079  30       BOH Company Num
     C                     PARM #DCKDT    WQ0080  70       TH Kill Date
     C                     PARM 'E'       WQ0081  1        TH Source Type
     C                     PARM 'E'       WQ0082  1        @Status Edit/Po
     C                     PARM P1EVTX    WQ0083 40        Oms System Valu
     C                     PARM 'U'       WQ0084  1        @Status Unpaid/
     C           WUKLST    PARM WUKLST    WQ0085  1        Pmt Payment Err
     C           #DIZSS    PARM #DIZSS    WQ0086  1        PP Producer Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWCQPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * E9904 Validate Src/BO Type and Site ID's for TO records. Company
      *================================================================
      * Currently, this check is made for Company 440 only
      * CASE: DTL.CC Company Number is Sioux City
     C           #1HONB    IFEQ 440                        *IF
     C                     MOVEL'N'       #DJNSS           PP Triumph Owne
      * Tatto Header validated for invalid Source/Buy Order Type
      * Val Source/BO Type    RT - Tattoo Header  * 
     C                     EXSR SKRVGN
      * If Source/BO Type error found, print error report
      * CASE: LCL.PP Source/BO Type Error is Errors
     C           YL0019    IFEQ 'E'                        *IF
     C                     MOVEL'E'       #DJNSS           PP Triumph Owne
      * Prt Src/BO Type Val   CL - STR Batch Processing  * 
     C                     CALL 'PWEEUPC'              90  Prt Src/BO Type
     C                     PARM @CN,008   WQ0087 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0088  4        PRT Hold Output
     C                     PARM '*YES'    WQ0089  4        PRT Save Output
     C                     PARM 01        WQ0090  20       PRT Copies
     C                     PARM #1HONB    WQ0091  30       CC Company Numb
     C                     PARM P1EUTX    WQ0092 30        Oms Name
     C                     PARM P1EVTX    WQ0093 40        Oms System Valu
     C                     PARM #DCKDT    WQ0094  70       Pmt Current Pay
     C           WULMST    PARM WULMST    WQ0095  7        Return Code USR
     C           YL0021    PARM YL0021    WQ0096  1        PP Triumph Owne
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWEEUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Buy Order Header validated for missing Site ID
      * Val Tattoo Site ID    RT - Tattoo Header  * 
     C                     EXSR SNRVGN
      * If Site ID error, print error report
      * CASE: LCL.PP Site ID Error is Errors
     C           YL0022    IFEQ 'E'                        *IF
     C                     MOVEL'E'       #DJNSS           PP Triumph Owne
      * Prt Site ID Val       CL - STR Batch Processing  * 
     C                     CALL 'PWEFUPC'              90  Prt Site ID Val
     C                     PARM @CN,008   WQ0097 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0098  4        PRT Hold Output
     C                     PARM '*YES'    WQ0099  4        PRT Save Output
     C                     PARM 01        WQ0100  20       PRT Copies
     C                     PARM #1HONB    WQ0101  30       CC Company Numb
     C                     PARM P1EUTX    WQ0102 30        Oms Name
     C                     PARM P1EVTX    WQ0103 40        Oms System Valu
     C                     PARM #DCKDT    WQ0104  70       Pmt Current Pay
     C           WULMST    PARM WULMST    WQ0105  7        Return Code USR
     C           #DJNSS    PARM #DJNSS    WQ0106  1        PP Triumph Owne
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWEFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DJNSS           PP Triumph Owne
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * S000219 JM 12/28/23   - Fix unintentional deletion of Carcass Det
      *                         Tattoo Ded/Add.
      * WHD86845 RMC 01/27/22 -  before updating paym parms,
      * check for the lcl.thr payment date/sts nE blanks
      * WHD86845 JBB 11/08/21 - Stop Pymt Post from executing twice daily
      * - Jerry Lehenbauer said the Payment Post executed twice for a
      *   Payment Date causing issues.  Modified Payment Processing scree
      *   to check for the current Payment Step being in a range of 6 to
      *   99999.  If Payment Step is within that range, then the Payment
      *   Post is currently running and cannot be submitted a second time
      * WHD83659 JBB 6/01/21 - Fix to allow Repayment on previous day
      * - Found an issue where the user was unable to perform a repayment
      *   on the previous day.  Removed error check and message.
      * SDD619 JBB  6/01/21 - Repayments by Business User
      * - Found an issue when using the old version of repayments where t
      *   Payment Date and Step were cleared.  If the Payment Date/Step i
      *   not found in the Tattoo Repayment Header, then leave the values
      *   on the screen as they currently are.
      * SDD619 JBB  6/01/21 - Repayments by Business User
      * - If PP Repayment Status field 'Y', then protect Selection field
      *   so the user cannot enter a '2' to run the Payment Post.
      *   Also update the Payment Date and Step to Repayment Date.
      * E15279 JBB  8/01/19 - Do not allow Post if doing a Repayment
      * - Check the Repayment flag in the Payment Processing Parms file.
      *   If it is a 'Y', send error message that Post cannot be run.
      * E14234 JBB  2/21/19 - Repayment Enhancements Phase 2
      * - Do not allow a payment edit or payment post to run if the
      *   Repayment Status on the Payment Process Parms file is 'Y'.
      * E14281 JBB  1/08/19 - Print Pricing Errors
      * - In the validations section, if the Company checks for Pricing
      *   Errors, and the user Selection is Post (2), and the PYMTPRCERR
      *   Company Value is 'Y', then send error message and do not allow
      *   the user to select the Post Process.
      * E12610 Jbb 04/17/18 - Tattoo Balancing Errors
      * - Modified to not be an error if there are Held Overs, and the
      *   Held Over Completion Date = 0
      * E12610 JJH 02/21/18 - Tattoo Balancing Errors
      * - Add logic to determine if there are any Tattoo that is Not
      *   Balanced prior to running the Payment Edit or Payment Post.
      * - Add a Company Value to determine if the Post process should
      *   include Balance Error checking.
      * E12054 JJH 11/13/17 - Payment Edit Messages
      * - No logic changes.  Temporaily Called PKPXXFR for debugging.
      *   Reset to Submit job.
      * E9904  JBB 08/24/17 - Push Payments from 440 to 961
      * - Fixed Site ID check to not flag as an error if the Hog
      *   Classification is Resale.
      * E9904  JJH 08/09/17 - Push Payments from 440 to 961
      * - Add Execute 'CALL Pay Prd Edit' which is to be used when
      *   debugging the Payment Edit process.
      * - Normally we use the  Execute 'SBM Pay Prd Edit'
      * - Currently set back to  Execute 'SBM Pay Prd Edit'
      * E9904  JBB 07/31/17 - Push Payments from 440 to 961
      * - Read through the records to be processed and validate the
      *   the Source Code and Buy Order Type against the Source/Buy Order
      *   Type XREF file (PWAIREL0) for all Triumph Owned records.  Also,
      *   validate that every Triumph Owned record has a Site ID.
      * E7519  JJH 06/27/17 - Trucker/Producer Address
      * - Change Company to be Output only.
      * - This will force users in Production to use the proper User ID
      *   to access the proper Company to process.
      * - In TEST environment, you will have to change the User Profile
      *   Applications HPE and HPERCV for User Profile ISBGUTI.
      * - This will also insure that the Payment Date and Step is for the
      *   correct Company
      * - This will also insure that logic to test for Missing M3 Supplie
      *   for Truckers and Producers is applied to the correct company.
      * E7519  JJH 06/26/17 - Trucker/Producer Address
      * - Only Prt Trucker Validation Error's report if there is 1 or
      *   more Trucker Error.
      * - Only Prt Pre-Chk Producer Missing Supplier report if there is
      *   1 or more Producer Errors
      * H16853 ISE 11/02/2020 CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HONB' defaulted for 'CC Company Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BSNB' defaulted for 'Next Buy Order Number'.
      * Field '(DTL) #1B1DT' defaulted for 'Current Kill Date'.
      * Field '(DTL) #1B2DT' defaulted for 'Next Kill Date'.
      * Field '(DTL) #1H4NB' defaulted for 'Last Drive Card Number'.
     C                     CALL 'PKLFSRR'              90  Sel Company Con
     C                     PARM *BLANK    W0RTN   7
     C           #1HONB    PARM #1HONB    WQ0038  30       CC Company Numb
     C           #1BSNB    PARM *ZERO     WQ0039  70       Next Buy Order
     C           #1B1DT    PARM *ZERO     WQ0040  70       Current Kill Da
     C           #1B2DT    PARM *ZERO     WQ0041  70       Next Kill Date
     C           #1H4NB    PARM *ZERO     WQ0042  30       Last Drive Card
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HONB    IFNE *ZERO                      CC Company Numb
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDEQ040
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#DMBST'  YPMTFD           Payment Sel Prc
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PKXAPVRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * If F3 pressed, set return code to
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' W0RTN            *Return code
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P1HONB           CC Company Numb
     C                     MOVEL*BLANK    P1C7CD           Oms Application
     C                     MOVEL*BLANK    P1C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P1G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P1G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P1EUTX           Oms Name
     C                     MOVEL*BLANK    P1EVTX           Oms System Valu
     C                     MOVEL*BLANK    P1HAST           Oms Access Deni
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2BSNB           Next Buy Order
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3ETTX           PRT Description
     C                     MOVEL*BLANK    P3ACVN           PRT Printer Dev
     C                     MOVEL*BLANK    P3AKST           PRT Hold Output
     C                     MOVEL*BLANK    P3AMST           PRT Save Output
     C                     Z-ADD*ZERO     P3AKNB           PRT Copies
     C                     MOVEL*BLANK    P3ALST           PRT Night Queue
     C                     MOVEL*BLANK    P3AIVN           PRT Night Queue
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4KBTX           System Value Al
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Date Alpha USR
     C                     MOVEL*BLANK    WUCZCD  7
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUH7ST  1
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WAABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WAACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WABPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WACSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WAAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WAAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WAATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WADHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WADINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WAGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WABZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WALSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WALDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WAJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WAKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WAIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WAKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WAIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WAEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WARJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WAD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHKST           EA Company Numb
     C                     Z-ADD*ZERO     WBB7DT           EA Kill Date
     C                     Z-ADD*ZERO     WBKINB           EA Scale Sequen
     C                     Z-ADD*ZERO     WBSUA1           EV Comment Line
     C                     Z-ADD*ZERO     WBSWA1           Previous Compan
     C                     Z-ADD*ZERO     WBGHDT           Previous Kill D
     C                     Z-ADD*ZERO     WBSXA1           Previous Tattoo
     C                     Z-ADD*ZERO     WBSZA1           Move To Company
     C                     Z-ADD*ZERO     WBGIDT           Move To Kill Da
     C                     Z-ADD*ZERO     WBSYA1           Move To Tattoo
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCCKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WCM1NB           Pmt Current Pay
     C                     Z-ADD*ZERO     WCPINB           PP Unused Nbr 1
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field Display Print Prompt  Usr
     C                     MOVEL*BLANK    WUHJST  1
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Define work field PP Unused Nbr 1
     C                     Z-ADD*ZERO     WUPINB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDCDNZ           TRH Repayment I
     C                     Z-ADD*ZERO     WDIDDT           TRH Date Start
     C                     Z-ADD*ZERO     WDCATM           TRH Time Start
     C                     Z-ADD*ZERO     WDIEDT           TRH Date Comple
     C                     Z-ADD*ZERO     WDCBTM           TRH Time Comple
     C                     Z-ADD*ZERO     WDIFDT           TRH Payment Dat
     C                     Z-ADD*ZERO     WDCTNZ           TRH Payment Ste
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Live with M3   USR
     C                     MOVEL*BLANK    WUG4SS  1
      * Define work field Live with E1
     C                     MOVEL*BLANK    WUMESS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WGACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WGB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WGCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WGAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WGA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WGCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WGCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WGFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WGH9NB           TH Held Over
     C                     Z-ADD*ZERO     WGFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WGFENB           TH Head Killed
     C                     Z-ADD*ZERO     WGHENB           TH Head Adds
     C                     Z-ADD*ZERO     WGHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WGCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WGLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WGE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WGA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WGFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WGA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WGF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WGHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WGF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WGF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WGAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WGAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WGCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WGA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WGA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WGB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WGAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WGAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WGAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WGAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WGAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WGASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WGA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WGATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WGA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WGCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WGCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WGLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WGCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WGA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WGA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WGGHNB           TH Commission A
     C                     Z-ADD*ZERO     WGBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WGBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WGBTDT           TH Commission P
     C                     Z-ADD*ZERO     WGBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WGHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WGHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGHINB           TH FFLI
     C                     Z-ADD*ZERO     WGA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WGA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WGA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WGJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WGD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WGD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WGD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WGD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WGEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WGEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WGECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WGEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WGEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WGEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WGOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WGTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WGT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WGTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WGT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WGOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WGKOER           TH Head Identif
     C                     Z-ADD*ZERO     WGOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WGOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WGIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WGOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WGHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WGS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WGTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WGTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WGJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WGKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WGKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WGKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WGKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WGOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WGIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WGIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WGIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WGKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WGKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WGORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WGOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WGMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WGNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WGNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WGIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WGEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGECDT           TH Head LFT
     C                     Z-ADD*ZERO     WGEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WGEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHALNB           PD Production C
     C                     Z-ADD*ZERO     WHAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WHAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WHGCNB           PD VND Address
     C                     Z-ADD*ZERO     WHGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field Pmt Payment Error
     C                     MOVEL*BLANK    WUKLST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WMBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WMBONB           BOL Load Number
     C                     Z-ADD*ZERO     WMCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WMB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WMI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WMJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WMI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WMI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WMI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WMI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WMJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WMJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WMJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WMJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WMJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WMJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WMJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WMJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WMJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WMJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WMJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WMJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WMJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WMJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WMLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WMHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WMLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WMH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WMGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WMH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WMGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WMH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WMHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WMHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WMHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WMHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WMHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WMHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WMHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WMHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WMSNA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WMSOA1           TE UnUsed Numbe
     C                     Z-ADD*ZERO     WMSPA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local work field Check for Balance Errors
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PP Repayment Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Valadate Wgt IN/OUT/R USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Co Chks for Price Errors
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Error Level - Warn/Hard
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Error Level - Pricing
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0007 40
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Pmt Current Payment Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     YL0010  50
      * Define null work field PP Commission Paym Error
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field PP Payment Error
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field PP Unused Nbr 1
     C                     Z-ADD*ZERO     YN0003  50
      * Define null work field PP Repayment Status
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field TRH Payment Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field TRH Payment Step
     C                     Z-ADD*ZERO     YL0012  50
      * Define null work field TRK Name
     C                     MOVEL*BLANK    YN0005 40
      * Define local work field TRK VND Address Number
     C                     Z-ADD*ZERO     YL0013  80
      * Define local work field TRK M3 Supplier Id
     C                     MOVEL*BLANK    YL0014 10
      * Define local work field Live with M3   USR
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Live with E1
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field PD VND Address Number
     C                     Z-ADD*ZERO     YL0017  80
      * Define local work field M3 Supplier ID
     C                     MOVEL*BLANK    YL0018 10
      * Define local work field PP Source/BO Type Error
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field BOH Buy Order Type
     C                     MOVEL*BLANK    YL0020  1
      * Define null work field PC Contract Code
     C                     MOVEL*BLANK    YN0006  5
      * Define null work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    YN0007  5
      * Define local work field PP Triumph Owned Error
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field PP Site ID Error
     C                     MOVEL*BLANK    YL0022  1
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0008  6
      * Define local work field PS Site ID
     C                     MOVEL*BLANK    YL0023 10
      * Define null work field Pmt Current Payment Date
     C                     Z-ADD*ZERO     YN0009  70
      * Define null work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     YN0010  50
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0024 40
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UDSUBR                     Modifications a
      * Val Application/User  IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P1J8NB    PARM *BLANK    WQ0115  3        Oms Warehouse C
     C           P1HONB    PARM *ZERO     WQ0116  30       CC Company Numb
     C                     PARM 'HPE'     WQ0117  6        Oms Application
     C           P1C8CD    PARM *BLANK    WQ0118  3        Oms SalesPerson
     C           P1G8ST    PARM *BLANK    WQ0119  1        Oms Allow Multi
     C           P1G9ST    PARM *BLANK    WQ0120 10        Oms Default Pri
     C           P1EUTX    PARM *BLANK    WQ0121 30        Oms Name
     C           P1EVTX    PARM *BLANK    WQ0122 40        Oms System Valu
     C           P1HAST    PARM *BLANK    WQ0123  1        Oms Access Deni
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P1HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP1EVTX    ##CMP
     C                     END                             *FI
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P1HAST    IFEQ 'Y'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * 08/29/2007 FT379 Gate Security - Remove validation on IN/OUT/R
      * 08/29/2007 slm see validation
     C                     MOVEL'N'       YL0003           Valadate Wgt IN
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0124  30       BOH Company Num
     C                     PARM @CN,009   WQ0125 10        Company Value C
     C           YL0003    PARM *BLANK    WQ0126 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 7/30/2021 JBB SDN619 - Repayment by Business User
      * Check if this is a repayment.  If it is a repayment, then the
      * Gate security check will not be performed later in the program.
      * Rtv Payment Processing RT - Payment Processing Parms  * Repayment
     C                     EXSR SQRVGN
      * If this is a repayment, skip the IN/OUT/Respread check
      * CASE: LCL.PP Repayment Status is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0003           Valadate Wgt IN
     C                     END                             *FI
      * 04/12/2018 JBB T12610 - Check for Balancing Errors Y/N
      * Rtv Company Values    XF - STR Order Management Sys  * HPECHKBALE
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0127  30       BOH Company Num
     C                     PARM @CN,010   WQ0128 10        Company Value C
     C           YL0001    PARM *BLANK    WQ0129 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0024    WUKBTX           System Value Al
      * 04/11/2017 slm M3 LIVE or parallel
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0130  30       BOH Company Num
     C                     PARM @CN,011   WQ0131 10        Company Value C
     C           YL0024    PARM *BLANK    WQ0132 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0024    WUKBTX           System Value Al
      *  1/09/2019 JBB E14281 - Pricing Error Report processing
      * Rtv Company Values    XF - STR Order Management Sys  * HPEPRCERPT
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0133  30       BOH Company Num
     C                     PARM @CN,012   WQ0134 10        Company Value C
     C           YL0004    PARM *BLANK    WQ0135 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01064015760159802111023670285603112
03368036240388004136043920440104648
05128
** W0END
01066015760161202118023710285603112
03368036240388004136043970443004651
05187
** W0NAM
#1HONB    #DMBST    #DIDT1    VDCKDT    #DM1NB    #DKLST    #DKHST
#DIYSS    #DIZSS    #DKCSS    #DJNSS    #DC9CD    #DKKTX    #DKLNB
#DYVTX
** @CN
00001 Payment Edit
00002 Post: Crc Sum/Crc Dtl
00003 HPECMPRPT
00004 GUYNIGHTQ
00005 HPEPYPRERR
00006 Daily Payment
00007 Repayment
00008 QPRINT2
00009 HPEWGTVLD
00010 HPECHKBALE
00011 M3VEND
00012 HPEPRCERPT
