     H/TITLE WW Load Plans          DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/27/23  Time  : 13:59:03
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FOMPVDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Load Plans          DF Display file
      *
     FOMFJCPLAIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Header               SchShp(d)/Seq SEL ECU
      *
     FPNFOREL1IF  E           K        DISK
      * RTV : User Application Whs      Retrieval index
      *
     FPMAMREL2IF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPBGWKLXIF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Whs
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FPUC1REL1IF  E           K        DISK
      * RTV : Shipping Line/Port Extsn  Retrieval index
      *
     FPUCRREL2IF  E           K        DISK
      * RSQ : Country Port of Unlading  Country/POU
      *
     FOPEYCPL5IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event   N
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPNGNREL1IF  E           K        DISK
      * RTV : EDI Interchange           Retrieval index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOPEYCPL0UF  E           K        DISK
      * UPD : Order Events              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 047  5 0A
     E                    W0END   7 047  5 0A
     E                    W0NAM   7 047 10
      * Long constants
     E                    @CN#    1  18  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WDRMNB
     I              FLRUNB                          WDRUNB
     I              FLRVNB                          WDRVNB
     I              FLDQTX                          WDDQTX
     I              FLRWNB                          WDRWNB
     I              FLRXNB                          WDRXNB
     I              FLSQNB                          WDSQNB
     I              FLT0NB                          WDT0NB
     I              FLT1NB                          WDT1NB
     I              FLR1NB                          WDR1NB
     I              FLAIC3                          WDAIC3
     I              FLC4NB                          WDC4NB
     I              FLVCST                          WDVCST
     I              FLKEDT                          WDKEDT
     I              FLSXNB                          WDSXNB
     I              FLKFDT                          WDKFDT
     I              FLACTM                          WDACTM
     I              FLK5TX                          WDK5TX
     I              FLW5CD                          WDW5CD
     I              FLEJDT                          WDEJDT
     I              FLAGTM                          WDAGTM
     I              FLKJDT                          WDKJDT
     I              FLATTM                          WDATTM
     I              FLHDDT                          WDHDDT
     I              FLAUTM                          WDAUTM
     I              FLKKDT                          WDKKDT
     I              FLAVTM                          WDAVTM
     I              FLZ4NB                          WDZ4NB
     I              FLY7ST                          WDY7ST
     I              FLY2ST                          WDY2ST
     I              FLWHTX                          WDWHTX
     I              FLWITX                          WDWITX
     I              FLWJTX                          WDWJTX
     I              FLWKTX                          WDWKTX
     I              FLWLTX                          WDWLTX
     I              FLN7DT                          WDN7DT
     I              FLN8DT                          WDN8DT
     I              FLN9DT                          WDN9DT
     I              FLB3TM                          WDB3TM
     I              FLB4TM                          WDB4TM
     I              FLB5TM                          WDB5TM
     I              FLIASX                          WDIASX
     I              FLIBSX                          WDIBSX
     I              FLICSX                          WDICSX
     I              FLWVTX                          WDWVTX
     I              FLWWTX                          WDWWTX
     I              FLWXTX                          WDWXTX
     I              FLUVST                          WDUVST
     I              FLUWST                          WDUWST
     I              FLUXST                          WDUXST
     I              FLAATM                          WDAATM
     I              FLAYNA                          WDAYNA
     I              FLA0NA                          WDA0NA
     I              FLAXDT                          WDAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@BGWKDA
      * Order Detail              Co/Order/Whs
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@ADREWA
      * Warehouse Codes           ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     I@EYCPZR
      * Order Events              Customer/Order/Event   N
      * Renamed input format fields
     I              EYAIC3                          WJAIC3
     I              EYC4NB                          WJC4NB
     I              EYQ2NB                          WJQ2NB
     I              EYJPCD                          WJJPCD
     I              EYAUC3                          WJAUC3
     I              EYQ7NB                          WJQ7NB
     I              EYOMST                          WJOMST
     I              EYD2DT                          WJD2DT
     I              EYONST                          WJONST
     I              EYOOST                          WJOOST
     I              EYOPST                          WJOPST
     I              EYAWC3                          WJAWC3
     I              EYQ8NB                          WJQ8NB
     I              EYQ9NB                          WJQ9NB
     I              EYBKC7                          WJBKC7
     I              EYUVST                          WJUVST
     I              EYUWST                          WJUWST
     I              EYUXST                          WJUXST
     I              EYAATM                          WJAATM
     I              EYAYNA                          WJAYNA
     I              EYA0NA                          WJA0NA
     I              EYAXDT                          WJAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WMAIC3
     I              OMC4NB                          WMC4NB
     I              OMDPNB                          WMDPNB
     I              OMUENB                          WMUENB
     I              OMHGCD                          WMHGCD
     I              OMAJCD                          WMAJCD
     I              OMBKC7                          WMBKC7
     I              OMCFC7                          WMCFC7
     I              OMGMST                          WMGMST
     I              OMGNST                          WMGNST
     I              OMMAVA                          WMMAVA
     I              OMKDVA                          WMKDVA
     I              OML8VA                          WML8VA
     I              OML9VA                          WML9VA
     I              OMGTST                          WMGTST
     I              OMGVST                          WMGVST
     I              OMGUST                          WMGUST
     I              OMQFST                          WMQFST
     I              OMAYVA                          WMAYVA
     I              OMEXDT                          WMEXDT
     I              OMLQCD                          WMLQCD
     I              OMRDCD                          WMRDCD
     I              OMQ7CD                          WMQ7CD
     I              OMBZPR                          WMBZPR
     I              OML6NB                          WML6NB
     I              OMU1ST                          WMU1ST
     I              OMGIDT                          WMGIDT
     I              OMCRCD                          WMCRCD
     I              OMAGCD                          WMAGCD
     I              OMRZST                          WMRZST
     I              OMR0ST                          WMR0ST
     I              OMR1ST                          WMR1ST
     I              OMG7NA                          WMG7NA
     I              OMG8NA                          WMG8NA
     I              OMRPCD                          WMRPCD
     I              OMVEST                          WMVEST
     I              OMVGST                          WMVGST
     I              OMAVST                          WMAVST
     I              OMU0ST                          WMU0ST
     I              OMRFCD                          WMRFCD
     I              OMFZST                          WMFZST
     I              OMR1NB                          WMR1NB
     I              OMAVQT                          WMAVQT
     I              OMD0WG                          WMD0WG
     I              OMCCQT                          WMCCQT
     I              OMAUWG                          WMAUWG
     I              OMCBQT                          WMCBQT
     I              OMATWG                          WMATWG
     I              OMAQCS                          WMAQCS
     I              OMAGCS                          WMAGCS
     I              OMAKPR                          WMAKPR
     I              OMALPR                          WMALPR
     I              OMAUPR                          WMAUPR
     I              OMAVWG                          WMAVWG
     I              OMA4WG                          WMA4WG
     I              OMA5DT                          WMA5DT
     I              OMAODT                          WMAODT
     I              OMGNDT                          WMGNDT
     I              OMAMST                          WMAMST
     I              OMANST                          WMANST
     I              OMVAST                          WMVAST
     I              OMRGNB                          WMRGNB
     I              OMRHNB                          WMRHNB
     I              OMRINB                          WMRINB
     I              OMRBCD                          WMRBCD
     I              OMHICD                          WMHICD
     I              OMRNCD                          WMRNCD
     I              OMROCD                          WMROCD
     I              OMCXDT                          WMCXDT
     I              OMAJVN                          WMAJVN
     I              OMKXCD                          WMKXCD
     I              OMJPCD                          WMJPCD
     I              OMCQCD                          WMCQCD
     I              OMR4CD                          WMR4CD
     I              OMZ1ST                          WMZ1ST
     I              OMZ3ST                          WMZ3ST
     I              OMZ4ST                          WMZ4ST
     I              OMDUPR                          WMDUPR
     I              OMB6VL                          WMB6VL
     I              OMA1AA                          WMA1AA
     I              OMFZSX                          WMFZSX
     I              OMF0SX                          WMF0SX
     I              OMF1SX                          WMF1SX
     I              OMF2SX                          WMF2SX
     I              OMF3SX                          WMF3SX
     I              OMF4SX                          WMF4SX
     I              OMF5SX                          WMF5SX
     I              OMF6SX                          WMF6SX
     I              OMF7SX                          WMF7SX
     I              OMNTDT                          WMNTDT
     I              OMNUDT                          WMNUDT
     I              OMNVDT                          WMNVDT
     I              OMNWDT                          WMNWDT
     I              OMNXDT                          WMNXDT
     I              OMBUTM                          WMBUTM
     I              OMBVTM                          WMBVTM
     I              OMBWTM                          WMBWTM
     I              OMBXTM                          WMBXTM
     I              OMBYTM                          WMBYTM
     I              OMH5NX                          WMH5NX
     I              OMH6NX                          WMH6NX
     I              OMH7NX                          WMH7NX
     I              OMH8NX                          WMH8NX
     I              OMH9NX                          WMH9NX
     I              OMDVPR                          WMDVPR
     I              OMDWPR                          WMDWPR
     I              OMDXPR                          WMDXPR
     I              OMDYPR                          WMDYPR
     I              OMDZPR                          WMDZPR
     I              OMGSPR                          WMGSPR
     I              OMGTPR                          WMGTPR
     I              OMGUPR                          WMGUPR
     I              OMHOST                          WMHOST
     I              OMHPST                          WMHPST
     I              OMIOST                          WMIOST
     I              OMPEWG                          WMPEWG
     I              OMRINY                          WMRINY
     I              OMTIDT                          WMTIDT
     I              OMTJDT                          WMTJDT
     I              OMH2ST                          WMH2ST
     I              OMH0ST                          WMH0ST
     I              OMH1ST                          WMH1ST
     I              OMTKDT                          WMTKDT
     I              OMTLDT                          WMTLDT
     I              OMTMDT                          WMTMDT
     I              OMUVST                          WMUVST
     I              OMUWST                          WMUWST
     I              OMUXST                          WMUXST
     I              OMAATM                          WMAATM
     I              OMAYNA                          WMAYNA
     I              OMA0NA                          WMA0NA
     I              OMAXDT                          WMAXDT
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WOAIC3
     I              BEC4NB                          WOC4NB
     I              BEJNCD                          WOJNCD
     I              BEANC7                          WOANC7
     I              BEBKC7                          WOBKC7
     I              BEBRTX                          WOBRTX
     I              BEHMNA                          WOHMNA
     I              BEHONA                          WOHONA
     I              BEHPNA                          WOHPNA
     I              BEHNNA                          WOHNNA
     I              BEDBCD                          WODBCD
     I              BECKTX                          WOCKTX
     I              BEB0C7                          WOB0C7
     I              BEAETX                          WOAETX
     I              BEB1NA                          WOB1NA
     I              BEB3NA                          WOB3NA
     I              BEB4NA                          WOB4NA
     I              BEB2NA                          WOB2NA
     I              BEBHCD                          WOBHCD
     I              BEC8TX                          WOC8TX
     I              BEBCNA                          WOBCNA
     I              BEA0DT                          WOA0DT
     I              BEA5DT                          WOA5DT
     I              BEGNDT                          WOGNDT
     I              BEACDT                          WOACDT
     I              BEAQCD                          WOAQCD
     I              BEB6NA                          WOB6NA
     I              BEBYNA                          WOBYNA
     I              BEBZNA                          WOBZNA
     I              BEGTST                          WOGTST
     I              BEGVST                          WOGVST
     I              BEGUST                          WOGUST
     I              BEQFST                          WOQFST
     I              BECQCD                          WOCQCD
     I              BEGJST                          WOGJST
     I              BEGWST                          WOGWST
     I              BEGXST                          WOGXST
     I              BEGYST                          WOGYST
     I              BEAODT                          WOAODT
     I              BEAIVN                          WOAIVN
     I              BECXDT                          WOCXDT
     I              BEJZVA                          WOJZVA
     I              BEA1WG                          WOA1WG
     I              BEXIST                          WOXIST
     I              BEXJST                          WOXJST
     I              BEXKST                          WOXKST
     I              BEEIDT                          WOEIDT
     I              BEAFTM                          WOAFTM
     I              BEE8CD                          WOE8CD
     I              BEE9CD                          WOE9CD
     I              BERMNB                          WORMNB
     I              BETBNB                          WOTBNB
     I              BER1NB                          WOR1NB
     I              BEPJST                          WOPJST
     I              BEU0ST                          WOU0ST
     I              BEU1ST                          WOU1ST
     I              BEQ2CD                          WOQ2CD
     I              BEU2ST                          WOU2ST
     I              BEVEST                          WOVEST
     I              BEVFST                          WOVFST
     I              BEVGST                          WOVGST
     I              BERPCD                          WORPCD
     I              BERNNB                          WORNNB
     I              BEVDST                          WOVDST
     I              BEATIN                          WOATIN
     I              BEU4ST                          WOU4ST
     I              BEU5ST                          WOU5ST
     I              BERSRN                          WORSRN
     I              BEMHNA                          WOMHNA
     I              BEMINA                          WOMINA
     I              BEWBST                          WOWBST
     I              BER4CD                          WOR4CD
     I              BEBFCD                          WOBFCD
     I              BEQ4CD                          WOQ4CD
     I              BET3NB                          WOT3NB
     I              BESICD                          WOSICD
     I              BECONB                          WOCONB
     I              BECEST                          WOCEST
     I              BEAWDT                          WOAWDT
     I              BEJPCD                          WOJPCD
     I              BEXUST                          WOXUST
     I              BEZ1ST                          WOZ1ST
     I              BEVRVA                          WOVRVA
     I              BEOBST                          WOOBST
     I              BEBCST                          WOBCST
     I              BEBDST                          WOBDST
     I              BEB7VL                          WOB7VL
     I              BEGASX                          WOGASX
     I              BEGBSX                          WOGBSX
     I              BEGCSX                          WOGCSX
     I              BEGDSX                          WOGDSX
     I              BEFNSX                          WOFNSX
     I              BEFOSX                          WOFOSX
     I              BEFPSX                          WOFPSX
     I              BEFQSX                          WOFQSX
     I              BEFRSX                          WOFRSX
     I              BEFSSX                          WOFSSX
     I              BEFTSX                          WOFTSX
     I              BEFUSX                          WOFUSX
     I              BEFVSX                          WOFVSX
     I              BEFWSX                          WOFWSX
     I              BEFXSX                          WOFXSX
     I              BEFYSX                          WOFYSX
     I              BENODT                          WONODT
     I              BENPDT                          WONPDT
     I              BENQDT                          WONQDT
     I              BENRDT                          WONRDT
     I              BENSDT                          WONSDT
     I              BEBPTM                          WOBPTM
     I              BEBQTM                          WOBQTM
     I              BEBRTM                          WOBRTM
     I              BEBSTM                          WOBSTM
     I              BEBTTM                          WOBTTM
     I              BEH0NX                          WOH0NX
     I              BEH1NX                          WOH1NX
     I              BEH2NX                          WOH2NX
     I              BEH3NX                          WOH3NX
     I              BEH4NX                          WOH4NX
     I              BEC0C7                          WOC0C7
     I              BEUVST                          WOUVST
     I              BEUWST                          WOUWST
     I              BEUXST                          WOUXST
     I              BEAATM                          WOAATM
     I              BEAYNA                          WOAYNA
     I              BEA0NA                          WOA0NA
     I              BEAXDT                          WOAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WSAIC3
     I              BEC4NB                          WSC4NB
     I              BEJNCD                          WSJNCD
     I              BEANC7                          WSANC7
     I              BEBKC7                          WSBKC7
     I              BEBRTX                          WSBRTX
     I              BEHMNA                          WSHMNA
     I              BEHONA                          WSHONA
     I              BEHPNA                          WSHPNA
     I              BEHNNA                          WSHNNA
     I              BEDBCD                          WSDBCD
     I              BECKTX                          WSCKTX
     I              BEB0C7                          WSB0C7
     I              BEAETX                          WSAETX
     I              BEB1NA                          WSB1NA
     I              BEB3NA                          WSB3NA
     I              BEB4NA                          WSB4NA
     I              BEB2NA                          WSB2NA
     I              BEBHCD                          WSBHCD
     I              BEC8TX                          WSC8TX
     I              BEBCNA                          WSBCNA
     I              BEA0DT                          WSA0DT
     I              BEA5DT                          WSA5DT
     I              BEGNDT                          WSGNDT
     I              BEACDT                          WSACDT
     I              BEAQCD                          WSAQCD
     I              BEB6NA                          WSB6NA
     I              BEBYNA                          WSBYNA
     I              BEBZNA                          WSBZNA
     I              BEGTST                          WSGTST
     I              BEGVST                          WSGVST
     I              BEGUST                          WSGUST
     I              BEQFST                          WSQFST
     I              BECQCD                          WSCQCD
     I              BEGJST                          WSGJST
     I              BEGWST                          WSGWST
     I              BEGXST                          WSGXST
     I              BEGYST                          WSGYST
     I              BEAODT                          WSAODT
     I              BEAIVN                          WSAIVN
     I              BECXDT                          WSCXDT
     I              BEJZVA                          WSJZVA
     I              BEA1WG                          WSA1WG
     I              BEXIST                          WSXIST
     I              BEXJST                          WSXJST
     I              BEXKST                          WSXKST
     I              BEEIDT                          WSEIDT
     I              BEAFTM                          WSAFTM
     I              BEE8CD                          WSE8CD
     I              BEE9CD                          WSE9CD
     I              BERMNB                          WSRMNB
     I              BETBNB                          WSTBNB
     I              BER1NB                          WSR1NB
     I              BEPJST                          WSPJST
     I              BEU0ST                          WSU0ST
     I              BEU1ST                          WSU1ST
     I              BEQ2CD                          WSQ2CD
     I              BEU2ST                          WSU2ST
     I              BEVEST                          WSVEST
     I              BEVFST                          WSVFST
     I              BEVGST                          WSVGST
     I              BERPCD                          WSRPCD
     I              BERNNB                          WSRNNB
     I              BEVDST                          WSVDST
     I              BEATIN                          WSATIN
     I              BEU4ST                          WSU4ST
     I              BEU5ST                          WSU5ST
     I              BERSRN                          WSRSRN
     I              BEMHNA                          WSMHNA
     I              BEMINA                          WSMINA
     I              BEWBST                          WSWBST
     I              BER4CD                          WSR4CD
     I              BEBFCD                          WSBFCD
     I              BEQ4CD                          WSQ4CD
     I              BET3NB                          WST3NB
     I              BESICD                          WSSICD
     I              BECONB                          WSCONB
     I              BECEST                          WSCEST
     I              BEAWDT                          WSAWDT
     I              BEJPCD                          WSJPCD
     I              BEXUST                          WSXUST
     I              BEZ1ST                          WSZ1ST
     I              BEVRVA                          WSVRVA
     I              BEOBST                          WSOBST
     I              BEBCST                          WSBCST
     I              BEBDST                          WSBDST
     I              BEB7VL                          WSB7VL
     I              BEGASX                          WSGASX
     I              BEGBSX                          WSGBSX
     I              BEGCSX                          WSGCSX
     I              BEGDSX                          WSGDSX
     I              BEFNSX                          WSFNSX
     I              BEFOSX                          WSFOSX
     I              BEFPSX                          WSFPSX
     I              BEFQSX                          WSFQSX
     I              BEFRSX                          WSFRSX
     I              BEFSSX                          WSFSSX
     I              BEFTSX                          WSFTSX
     I              BEFUSX                          WSFUSX
     I              BEFVSX                          WSFVSX
     I              BEFWSX                          WSFWSX
     I              BEFXSX                          WSFXSX
     I              BEFYSX                          WSFYSX
     I              BENODT                          WSNODT
     I              BENPDT                          WSNPDT
     I              BENQDT                          WSNQDT
     I              BENRDT                          WSNRDT
     I              BENSDT                          WSNSDT
     I              BEBPTM                          WSBPTM
     I              BEBQTM                          WSBQTM
     I              BEBRTM                          WSBRTM
     I              BEBSTM                          WSBSTM
     I              BEBTTM                          WSBTTM
     I              BEH0NX                          WSH0NX
     I              BEH1NX                          WSH1NX
     I              BEH2NX                          WSH2NX
     I              BEH3NX                          WSH3NX
     I              BEH4NX                          WSH4NX
     I              BEC0C7                          WSC0C7
     I              BEUVST                          WSUVST
     I              BEUWST                          WSUWST
     I              BEUXST                          WSUXST
     I              BEAATM                          WSAATM
     I              BEAYNA                          WSAYNA
     I              BEA0NA                          WSA0NA
     I              BEAXDT                          WSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I : RST Load ID
     I                                    P   1   40PARMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPBRC        DS                             18
      * KEY : Load Order Change Log     Ld Id,Dte/Tm/Seq/Ord
      * I :  Load ID
     I                                    P   1   40PBRMNB
      *
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     IYBRDCS      DS                            525
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     IYCRDCS      DS                            779
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type - Sales
     I                                        7   8 PCJNCD
      * I :  AR Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Order Requires Review
     I                                      663 664 PCFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PCNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PCNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PCNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PCBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
     IYDRDCS      DS                            525
      * Outward parameters
     IPDRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PDDXNB
      * I :  Load ID
     I                                    P  11  140PDRMNB
      * I :  Stop_Drop
     I                                    P  15  170PDRVNB
      * I :  Load Change Type
     I                                       18  23 PDRVST
      * I :  Department Control Code
     I                                       24  26 PDUJST
      * I :  Change Log Prior Value
     I                                       27  38 PDMNTX
      * I :  Change Log New Value
     I                                       39  50 PDMOTX
      * I :  User Id
     I                                       51  60 PDAYNA
      * I :  Job Name
     I                                       61  70 PDA0NA
      * I :  Carrier Code
     I                                       71  73 PDBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PDXMCD
      * I :  Company Number
     I                                    P  77  780PDAIC3
      * I :  Order Number
     I                                    P  79  820PDC4NB
      *
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     IYERDCS      DS                            793
     IYFRDCS      DS                            367
     IYGRDCS      DS                            779
     IYHRDCS      DS                            525
      * Outward parameters
     IPERC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PERMNB
      *
     IYIRDCS      DS                            793
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYJRDCS      DS                            793
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P1DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P1DRCD
      * N :  Salesperson Code
     I                                       22  24 P1BCCD
      * N :  System Date Format
     I                                       25  27 P1B8NA
      * N :  User Profile Name
     I                                       28  37 P1AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P1I6ST
      * N :  Default Printer
     I                                       39  48 P1MPNA
      * N :  First Time Flag
     I                                       49  49 P1TAST
      * N :  Requested Delivery Date
     I                                    P  50  530P1EIDT
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * N :  PRT Printer Device
     I                                       26  35 P2WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * N :  PRT Number of Copies
     I                                       44  450P2DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P2WUST
      * N :  PRT Night Queue
     I                                       47  56 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P2AJAA
      * N :  Date 1          PASS  USR
     I                                    P  65  725P2AJAB
      * N :  Order Number 1  PASS  USR
     I                                    P  73  805P2AJAE
      * N :  System Value Numeric
     I                                    P  81  885P2M8NB
      * N :  Status - Y or N
     I                                       89  89 P2B8ST
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Display Prt Opt Pmt USR
     I                                        1   4 P3XFST
      * N :  USR Output Only Status
     I                                        5   5 P3E5ST
      * N :  USR Print Detail
     I                                        6   6 P3E7ST
      * N :  Seq No 1  PASS        USR
     I                                    P   7  145P3SEQ1
      * N :  USR Update Flag
     I                                       15  15 P3R4ST
      * N :  Error Status
     I                                       16  16 P3ECST
      * N :  USR Weight Accumulated
     I                                    P  17  222P3CDWG
     IP4PARM      DS
      * N :  USR Flag 1
     I                                        1   1 P4D4ST
     IP5PARM      DS
      * N :  Job Name CDE
     I                                        1  10 P5B2VN
     IP6PARM      DS
      * FLD: Load Header
      * N :  Load ID
     I                                    P   1   40P6RMNB
      * N :  Carrier Code
     I                                        5   7 P6BZNA
     IP7PARM      DS
      * N :  Job Name
     I                                        1  10 P7A0NA
     IP8PARM      DS
      * N : MAP Stop_Drop
     I                                    P   1   30P8RVNB
     IP9PARM      DS
      * N :  Numeric 4,0           USR
     I                                    P   1   30P9G0NX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Live TMS Function Invalid'
      * *CMD key
     I                                        1   2 ZA0001
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0002
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0003
      * Warehouse Code
     I                                       11  13 ZA0004
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0005
      * Message data for 'Company Number Req'
      * Company Number
     I                                        1   3 ZA0006
      * Message data for 'OM Load Header not found'
      * Load ID
     I                                    P   1   40ZA0007
      * Message data for 'Live TMS Option Invalid'
      * SH Order Sales Channel
     I                                        1   2 ZA0008
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0009
      * Load ID
     I                                    P   2   50ZA0010
      * Message data for 'Load Status inv for Chg'
      * *SFLSEL
     I                                        1   1 ZA0011
      * Load ID
     I                                    P   2   50ZA0012
      * Message data for 'Load Locked Can't Delete'
      * Load Status
     I                                        1   1 ZA0013
      * USR Stop
     I                                    P   2   30ZA0014
      * Message data for 'Order Picked/Confirmed'
      * *SFLSEL
     I                                        1   1 ZA0015
      * Load ID
     I                                    P   2   50ZA0016
      * Message data for 'Order in Use;cant unlock'
      * *SFLSEL
     I                                        1   1 ZA0017
      * Load ID
     I                                    P   2   50ZA0018
      * Message data for 'Load Shipped Can't Delete'
      * Load Status
     I                                        1   1 ZA0019
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0020
      * Load ID
     I                                    P   4   70ZA0021
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0022
      * Load ID
     I                                    P   2   50ZA0023
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0024
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0025
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0026
      * Message data for 'No Orders Assigned'
      * Load ID
     I                                    P   1   40ZA0027
      * *SFLSEL
     I                                        5   5 ZA0028
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0029
      * Load ID
     I                                    P   2   50ZA0030
      * Message data for 'Load Cant be Locked'
      * *SFLSEL
     I                                        1   1 ZA0031
      * Load ID
     I                                    P   2   50ZA0032
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0033
      * Load ID
     I                                    P   4   70ZA0034
      * Message data for 'Truck size must be enter'
      * Truck Size
     I                                        1   7 ZA0035
      * Load ID
     I                                    P   8  110ZA0036
      * Message data for 'Shipping Method required'
      * Shipping Method
     I                                        1   2 ZA0037
      * Message data for 'Load has orders w/o stop'
      * Load ID
     I                                    P   1   40ZA0038
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0039
      * Message data for 'Load has Orders on Hold'
      * Load ID
     I                                    P   1   40ZA0040
      * *SFLSEL
     I                                        5   5 ZA0041
      * Message data for 'Load has Cancelled Orders'
      * Load ID
     I                                    P   1   40ZA0042
      * *SFLSEL
     I                                        5   5 ZA0043
      * Message data for 'Load has Orders in Use'
      * *SFLSEL
     I                                        1   1 ZA0044
      * Load ID
     I                                    P   2   50ZA0045
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0046
      * Load ID
     I                                    P   2   50ZA0047
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0048
      * Message data for 'Ship From Whs required'
      * Ship From Warehouse
     I                                        1   3 ZA0049
      * Message data for 'Ship to State required'
      * Ship To State Code
     I                                        1   2 ZA0050
      * Message data for 'Option invalid-not locked'
      * *SFLSEL
     I                                        1   1 ZA0051
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0052
      * Load ID
     I                                    P   2   50ZA0053
      * Message data for 'Load Status inv for Chg'
      * *SFLSEL
     I                                        1   1 ZA0054
      * Load ID
     I                                    P   2   50ZA0055
      * Message data for 'Load Status inv for Chg'
      * *SFLSEL
     I                                        1   1 ZA0056
      * Load ID
     I                                    P   2   50ZA0057
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0058
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0059
      * Message data for 'Carrier entered to Fax'
      * *SFLSEL
     I                                        1   1 ZA0060
      * Carrier Code
     I                                        2   4 ZA0061
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0062
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0063
      * USR CDE Parm 1
     I                                        4   6 ZA0064
      * USR CDE Parm 2
     I                                        7   9 ZA0065
      * USR CDE Parm 3
     I                                       10  12 ZA0066
      * USR CDE Parm 4
     I                                       13  15 ZA0067
      * USR CDE Parm 5
     I                                       16  18 ZA0068
      * USR CDE Parm 6
     I                                       19  21 ZA0069
      * USR CDE Parm 7
     I                                       22  24 ZA0070
      * USR CDE Parm 8
     I                                       25  27 ZA0071
      * USR CDE Parm 9
     I                                       28  30 ZA0072
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0073
      * Application Code
     I                                       11  16 ZA0074
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0075
      * Application Code
     I                                       11  16 ZA0076
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First time
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
      * RMC 3/1/06 dont dft ctl.company
      * CASE: PAR.Allow Multi-Company is no
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     END                             *FI
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     MOVEL'N'       P1TAST           First Time Flag
     C                     Z-ADD*ZERO     P9G0NX           Numeric 4,0
      * 11/04/09 PKD E00519 Access by Warehouse
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Rtv 1st Warehouse     RT - User Application Whs  * 
     C                     EXSR SARVGN
     C                     END                             *FI
     C                     END                             *FI
      * ** Ship line is no longer the land carrier           P000737
     C                     MOVEL#CZUCD    WUZUCD           Warehouse 1 USR
     C                     MOVEL#C        YL0002           Ship Method Typ
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           FJAODT           Scheduled Ship
     C                     KFLD           FJT4NB           Schedule Sequen
      * Setup key
     C           #2AODT    IFEQ *ZERO
     C                     MOVEL*HIVAL    FJAODT           Scheduled Ship
     C                     ELSE
     C                     Z-ADD#2AODT    FJAODT
     C                     ENDIF
     C                     Z-ADD#2T4NB    FJT4NB
     C           KPOS      SETLL@FJCPJ1
     C                     READ @FJCPJ1                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2P1DT    WZP1DT
     C                     MOVEL#2P1DT    WZP1DT           TPM Planned Shi
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2TLMI    WZTLMI
     C                     MOVEL#2TLMI    WZTLMI           Total Load Mile
     C           *LIKE     DEFN #2RPNB    WZRPNB
     C                     MOVEL#2RPNB    WZRPNB           Total Load Orde
     C           *LIKE     DEFN #2DXTX    WZDXTX
     C                     MOVEL#2DXTX    WZDXTX           Trailer Id
     C           *LIKE     DEFN #2AXTM    WZAXTM
     C                     MOVEL#2AXTM    WZAXTM           Deadline Depart
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2T4NB    WZT4NB
     C                     MOVEL#2T4NB    WZT4NB           Schedule Sequen
     C           *LIKE     DEFN #2PKST    WZPKST
     C                     MOVEL#2PKST    WZPKST           Load Status
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
     C           *LIKE     DEFN #2RMST    WZRMST
     C                     MOVEL#2RMST    WZRMST           Load Acceptance
     C           *LIKE     DEFN #2KZDT    WZKZDT
     C                     MOVEL#2KZDT    WZKZDT           Deadline Depart
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPJ1                  90*
     C  N82                READ @FJCPJ1                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,45
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2P1DT    IFNE *ZERO                      TPM Planned Shi
     C           FJP1DT    CABNE#2P1DT    BB020            TPM Planned Shi
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           FJVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2RPNB    IFNE *ZERO                      Total Load Orde
     C           FJRPNB    CABGT#2RPNB    BB020            Total Load Orde
     C                     END
     C           #2AXTM    IFNE *ZERO                      Deadline Depart
     C           FJAXTM    CABNE#2AXTM    BB020            Deadline Depart
     C                     END
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           FJAJCD    CABNE#2AJCD    BB020            Warehouse Code
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           FJRMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           FJAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C           #2EIDT    IFNE *ZERO                      Requested Deliv
     C           FJEIDT    CABNE#2EIDT    BB020            Requested Deliv
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2T4NB    IFNE *ZERO                      Schedule Sequen
     C           FJT4NB    CABLT#2T4NB    BB020            Schedule Sequen
     C                     END
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           FJQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2RMST    IFNE *BLANK                     Load Acceptance
     C           FJRMST    CABNE#2RMST    BB020            Load Acceptance
     C                     END
     C           #2KZDT    IFNE *ZERO                      Deadline Depart
     C           FJKZDT    CABNE#2KZDT    BB020            Deadline Depart
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * If company selection is made, then select only that company
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Accounting Company Number is not equal to zero
      *   |- c2    : DB1.Accounting Company Number NE CTL.Accounting Comp
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFNE *ZERO                      *IF
     C           FJAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If carrier selection is made, then select only that carrier
      * CASE: CTL.Carrier Code is entered
     C           #2BZNA    IFNE *BLANK                     *IF
      * CASE: CTL.Carrier Code is Select Blank Carriers
     C           #2BZNA    IFEQ '*'                        *IF
      * CASE: DB1.Carrier Code is entered
     C           FJBZNA    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Carrier Code NE DB1.Carrier Code
     C           #2BZNA    IFNE FJBZNA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
     C                     EXSR SBRVGN
      * If Ship Line selection is made, then select only that Shipping Li
      * CASE: CTL.USR Carrier Code is entered
     C           #CR6CD    IFNE *BLANK                     *IF
      * CASE: RCD.USR Carrier Code NE CTL.USR Carrier Code
     C           #RR6CD    IFNE #CR6CD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process INC/EXC option
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: CTL.Load Status EQ WRK.BLANK
     C           #2PKST    IFEQ WUGSTX                     *IF
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
      * Select only records which match CTL load status
      * CASE: DB1.Load Status NE CTL.Load Status
     C           FJPKST    IFNE #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
      * Select only records which do NOT match CTL load status
      * CASE: DB1.Load Status EQ CTL.Load Status
     C           FJPKST    IFEQ #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELFJDXTX    #RS2TX           Trailer ID USR
     C                     END                             *FI
      * Get Last Stop on Order       -- TRF011 scan for ctl.last stop cit
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0001           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUBKC7           Ship To Custome
     C                     MOVELWL0003    WUBRTX    P      Ship To Name
     C                     MOVELWL0004    WUHMNA    P      Ship To Address
     C                     MOVELWL0005    WUHONA    P      Ship To Address
     C                     MOVELWL0006    WUHPNA    P      Ship To Address
     C                     MOVELWL0007    WUHNNA    P      Ship To City
     C                     MOVELWL0008    #RV9CD    P      Ship To State C
     C                     MOVELWL0009    WUCKTX    P      Ship To Zip/Pos
     C                     MOVELWUHNNA    #RLINA           USR Load/Stop 1
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Ship To State Code is State code not Blanks
      *   |- c2    : RCD.USR State Code NE CTL.Ship To State Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2DBCD    IFNE *BLANK                     *IF
     C           #RV9CD    IFNE #2DBCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Scan for Ctl.last stop city         TRF011 RMC 7/28/06
      * CASE: CTL.USR Load/Stop 10 Alpha is Entered
     C           #CLINA    IFNE *BLANK                     *IF
      * CLC Call Qclscan       UP - /UT User Source  * 
     C                     CALL 'QCLSCAN'              90  CLC Call Qclsca
     C                     PARM WUHNNA    WQ0001256        USR Qclscan fie
     C                     PARM 20        WQ0002  30       USR Qclscan Len
     C                     PARM 1         WQ0003  30       USR Qclscan Sta
     C                     PARM #CLINA    WQ0004256        USR Qclscan Mas
     C                     PARM 10        WQ0005  30       USR Qclscan Mas
     C                     PARM '1'       WQ0006  1        USR Qclscan Tra
     C                     PARM '1'       WQ0007  1        USR Qclscan Tri
     C                     PARM *BLANK    WQ0008  1        USR Qclscan Wil
     C           WUY8NB    PARM WUY8NB    WQ0009  30       USR Qclscan Res
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'QCLSCAN' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
     C                     END
      * CASE: WRK.USR Qclscan Result ? is Does contain
     C           WUY8NB    IFGT 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RST: Scheduled Ship Date
      * CASE: CTL.Scheduled Ship Date is entered
     C           #2AODT    IFNE *ZERO                      *IF
      * CASE: DB1.Scheduled Ship Date NE CTL.Scheduled Ship Date
     C           FJAODT    IFNE #2AODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Setup Delivery Checked field, according to On Time Y/N
      * CASE: DB1.On Time - (Y/N) is Y/N Values
     C           FJONTM    IFEQ 'N'                        *IF
     C           FJONTM    OREQ 'Y'
     C                     MOVEL'Y'       #RB8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RB8ST           Status - Y or N
     C                     END                             *FI
      * Restrict on Delivery Checked field
      * CASE: CTL.Status - Y or N is Y/N Values
     C           #CB8ST    IFEQ 'N'                        *IF
     C           #CB8ST    OREQ 'Y'
      * CASE: RCD.Status - Y or N NE CTL.Status - Y or N
     C           #RB8ST    IFNE #CB8ST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0010           Load ID
     C                     Z-ADD*ZERO     WL0011           Stop_Drop Seque
     C                     Z-ADDP3CDWG    WL0012           USR Weight Accu
     C                     MOVEL#1PKST    WL0013    P      Load Status
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P3CDWG           USR Weight Accu
     C                     Z-ADDP3CDWG    #RG2NX           Weight Adjust 6
      * Highlight load number if traffic comments exist
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
     C                     EXSR SGRVGN
      * Set Highlight Flag
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       #RKOST           Include Todays
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RKOST           Include Todays
     C                     END                             *FI
     C           FJAXTM    DIV  100       WUT4TM           USR Time 4.0
      * Set Highlight Flag - Sched Ship Date   7/10/01 RMC
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : DB1.Actual Departure Date GT DB1.Deadline Departure
      *   |- c2    : DB1.Actual Departure Date EQ DB1.Deadline Departure
      *   |- c3    : DB1.Departure Time GT WRK.USR Time 4.0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           FJAQDT    IFGT FJKZDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           FJAQDT    IFEQ FJKZDT                     *IF
     C           FJS6NB    IFGT WUT4TM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     END                             *FI
      * ** Set highlight flag, Override Total Load Miles entered   E00207
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     END                             *FI
      * OMS203:  no updates will be allowed if load contains block orders
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0018           Load ID
     C                     MOVEL#RBCST    WL0020    P      Block Order Fla
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    WUG0TX    P      USR Check Y/N S
     C                     MOVELWL0020    #RBCST    P      Block Order Fla
     C                     Z-ADD#1T4NB    #RG0NX           Numeric 4,0
     C                     MOVEL'N'       P4D4ST           USR Flag 1
      * RTV Chk Ord on Hld-Pr/Cr - Load Detail  * 
     C                     EXSR SIRVGN
      * RTV First Order Whse   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0021           Load ID
     C                     Z-ADD1         WL0022           Stop_Drop
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    #RZUCD    P      Warehouse Code
      * Val Appt confirm     RT - Load Detail  * (RI) rq delv date
     C                     EXSR SNRVGN
      * RTV Num Multi-Whs Ords RT - Load Detail  * trf011
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0024           Load ID
     C                     Z-ADD#RMCNB    WL0026           Number of Order
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0025    #1RVSX    P      Multi Company L
     C                     Z-ADDWL0026    #RMCNB           Number of Order
      * CASE: RCD.Number of Orders is Greater Than 1
     C           #RMCNB    IFGT 1                          *IF
     C                     MOVEL'Y'       #1RVSX           Multi Company L
     C                     END                             *FI
      * PK0141
      * Select Records for the Warehouse entered on the control level
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Select Records for the Warehouse entered on the control level
      * CASE: CTL.Warehouse 1 USR is EQ Blank
     C           #CZUCD    IFEQ *BLANK                     *IF
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Warehouse 1 USR EQ RCD.Warehouse 1 USR
     C           #CZUCD    IFEQ #RZUCD                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Load flat amount - to be passed if F9 is pressed   DLY029 07/1
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C           FJAXTM    DIV  100       #RYBNB           Deadline Depart
      * RCD.Deadline Departure MM/DD = DB1.Deadline Departure Date
     C                     Z-ADDFJKZDT    #RYANB           Deadline Depart
     C           FJCMTM    DIV  100       #RT4TM           USR Time 4.0
      * RCD.Month/Day Display     USR = DB1.LPT Load Plan Start Dt
     C                     Z-ADDFJP0DT    #RMDDI           Month/Day Displ
      * -----------------------------------
      * 01/22/08 PKD Added Ship Method Type
      * 02/27/08 PKD Gary Martin wants the regular shipping method
      *              instead of the ship method type. Made the Ship Metho
      *              Type field and description hidden. Leaving the code
      *              to populate it. Just incase they want it back.
     C                     Z-ADD1         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00002
     C           ZQ        ORGT 00002
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#1Q2CD:ZQ #R        P  90  Ship Method Typ
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * RCD.Text USR 5 = Condition name of RCD.Ship Method Type USR
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1864398   Y2LSNO  70       List number
     C                     PARM #R        W0INVL 25        Ship Method Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RY7TX    PARM           W0CNNM 25        Text USR 5
      *
      * SEL:  Ship Method Type
      * CASE: CTL.Ship Method Type USR NE WRK.BLANK
     C           #C        IFNE WUGSTX                     *IF
      * CASE: CTL.Ship Method Type USR NE RCD.Ship Method Type USR
     C           #C        IFNE #R                         *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Check for < ctl.Weight Adjust 6.0     USR  -E00180 8/07/08
      * CASE: CTL.Weight Adjust 6.0     USR is Not equal to zero
     C           #CG2NX    IFNE *ZERO                      *IF
      * CASE: CTL.Weight Adjust 6.0     USR GT RCD.Weight Adjust 6.0
     C           #CG2NX    IFGT #RG2NX                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * -----------------------------------
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @FJCPJ1                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV2EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #2EIDT
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2PKST'  IFEQ YPMTFD
      * Load Status
     C                     MOVEL#2PKST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFPKST
     C                     SELEC
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD1         ZFPKST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZFPKST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFPKST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD4         ZFPKST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD5         ZFPKST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD6         ZFPKST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD7         ZFPKST
     C                     ENDSL
     C                     EXFMTZEPKST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFPKST    WHEQ 1
     C                     MOVEL'U'       W0INVL           U
     C           ZFPKST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C           ZFPKST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFPKST    WHEQ 4
     C                     MOVEL'E'       W0INVL           E
     C           ZFPKST    WHEQ 5
     C                     MOVEL'C'       W0INVL           C
     C           ZFPKST    WHEQ 6
     C                     MOVEL'I'       W0INVL           I
     C           ZFPKST    WHEQ 7
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2PKST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Shipping Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2Q2CD'  IFEQ YPMTFD
      * Shipping Method
     C                     MOVEL#2Q2CD    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFQ2CD
     C                     SELEC
     C           W0INVL    WHEQ 'CR'                       CR
     C                     Z-ADD1         ZFQ2CD
     C           W0INVL    WHEQ 'CT'                       CT
     C                     Z-ADD2         ZFQ2CD
     C           W0INVL    WHEQ 'PR'                       PR
     C                     Z-ADD3         ZFQ2CD
     C           W0INVL    WHEQ 'PT'                       PT
     C                     Z-ADD4         ZFQ2CD
     C                     ENDSL
     C                     EXFMTZEQ2CD
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFQ2CD    WHEQ 1
     C                     MOVEL'CR'      W0INVL           CR
     C           ZFQ2CD    WHEQ 2
     C                     MOVEL'CT'      W0INVL           CT
     C           ZFQ2CD    WHEQ 3
     C                     MOVEL'PR'      W0INVL           PR
     C           ZFQ2CD    WHEQ 4
     C                     MOVEL'PT'      W0INVL           PT
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2Q2CD
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Credit Hold
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CXIST    W0NSRQ  1        Credit Hold
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CXIST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1289031   Y2LSNO  70
     C           #CXIST    PARM #CXIST    W0EXVL 25        Credit Hold
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * F5=Refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Format seq#
      * CASE: CTL.Numeric 4,0           USR is *Zero
     C           #CG0NX    IFEQ *ZERO                      *IF
      * CASE: CTL.Numeric 4,0           USR NE PAR.Numeric 4,0
     C           #CG0NX    IFNE P9G0NX                     *IF
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     P9G0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#CG0NX    #2T4NB           Schedule Sequen
     C                     Z-ADD#CG0NX    P9G0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZEIDT    CASNE#2EIDT    FBRQRL
     C           WZT4NB    CASNE#2T4NB    FBRQRL
     C           WZPKST    CASNE#2PKST    FBRQRL
     C           WZQ2CD    CASNE#2Q2CD    FBRQRL
     C           WZDBCD    CASNE#2DBCD    FBRQRL
     C           WZBZNA    CASNE#2BZNA    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL'N'       P3E7ST           USR Print Detai
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * E4119  LIVE WITH TMS RESTRICTED FUNCTION KEYS
      * CASE: LCL.Live with TPM is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CASE: CTL.*CMD key is CF06
     C           *IN06     IFEQ '1'                        *IF
      * can create loads for intl orders
      * CASE: LCL.PFS AccuSort Active is No
     C           YL0012    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL'06'      ZA0001           *CMD key
      * Send message 'Live TMS Function Invalid'
     C                     MOVEL'USR4602' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.*CMD key is CF14
     C           *IN14     IFEQ '1'                        *IF
      * allow.. need for as400 created loads
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 11/04/09 PKD E00519 Access by Warehouse
      * F4=Prompt
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Warehouse 1 USR
     C           W0CFL     IFEQ '#CZUCD'                   *IF
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0017 10        User Profile Na
     C                     PARM 'TRF'     WQ0018  6        Application Cod
     C           #CZUCD    PARM #CZUCD    WQ0019  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CZUCD    PARM #CZUCD    WQ0020  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           #CZUCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CZUCD    ZA0002           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0021 10        User Profile Na
     C                     PARM 'TRF'     WQ0022  6        Application Cod
     C                     PARM #CZUCD    WQ0023  3        Warehouse Code
     C                     PARM *ZERO     WQ0024  70       Item Code
     C           YL0013    PARM *BLANK    WQ0025  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0013    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0003           *USER
     C                     MOVEL#CZUCD    ZA0004           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           #CZUCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#CZUCD    ZA0005           Warehouse Code
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * F7=Display Unbooked Orders
      * CASE: CTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * DSP Unbooked Orders    DF - PD Order Header  * 
     C                     CALL 'PDCNDFR'              90  DSP Unbooked Or
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0026  30       Company Number
     C           WUBNVN    PARM WUBNVN    WQ0027 10        USR Program nam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCNDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F8=Toggle Include/Exclude
      * CASE: CTL.*CMD key is *Option Toggle
     C           *IN08     IFEQ '1'                        *IF
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
     C                     MOVEL'EXC'     #CVQCD           Include/Exclude
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F9=WW Order Appointments      (New E4195)
      * CASE: CTL.*CMD key is CF09
     C           *IN09     IFEQ '1'                        *IF
      * WW Order Appointments DF - Order Header TRG  * 
     C                     CALL 'PNXJDFR'              90  WW Order Appoin
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNXJDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F6=Process create load
      * CASE: CTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * CASE: CTL.Accounting Company Number is not equal to zero
     C           #2AIC3    IFNE *ZERO                      *IF
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVELWUGSTX    #2PKST           Load Status
      * Edt Load Plan          DF - Order Header TRG  * 
     C                     CALL 'OMQ6DFR'              90  Edt Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0028  30       Company Number
     C           #2RMNB    PARM #2RMNB    WQ0029  70       Load ID
     C                     PARM #2PKST    WQ0030  1        Load Status
     C           P3R4ST    PARM P3R4ST    WQ0031  1        USR Update Flag
     C                     PARM 'Y'       WQ0032  1        Access Limited
     C           P5B2VN    PARM P5B2VN    WQ0033 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMQ6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     SETON                     36    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0006           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company Number Req'
     C                     MOVEL'USR2183' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F13=Work with All Loads
      * CASE: CTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * WW Load Plans ALL      DF - OM Load Header  * 
     C                     CALL 'PDNUDFR'              90  WW Load Plans A
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNUDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F14=Accept Loads
      * CASE: CTL.*CMD key is CF14
     C           *IN14     IFEQ '1'                        *IF
      * CASE: CTL.Company Number EQ WRK.ZERO
     C           #2AIC3    IFEQ WUW0NB                     *IF
     C                     Z-ADD*ZERO     WUAIC3           Company Number
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           WUAIC3    PARM WUAIC3    WQ0034  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#2AIC3    WUAIC3           Company Number
     C                     END                             *FI
      * DSP Control Chg Log    XF - Load Header  * 
     C                     CALL 'PDAOXFR'              90  DSP Control Chg
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0035  30       Load Start Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F18=Sweep Orders - Load Planning to Mercury Gate      E004119
      * CASE: CTL.*CMD key is CF18
     C           *IN18     IFEQ '1'                        *IF
      * WW TMS Order Sweep     DF - Order Header TRG  * 
     C                     CALL 'PBTHDFR'              90  WW TMS Order Sw
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBTHDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Reload subfile if DC control field, carrier changes.
      * CASE: PAR.Status - Y or N NE CTL.Status - Y or N
     C           P2B8ST    IFNE #CB8ST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * ** 04/20/2012 LJB E002057
      * RTV Num Multi-Whs Ords RT - Load Detail  * trf011
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0024           Load ID
     C                     Z-ADD#RMCNB    WL0026           Number of Order
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0025    #1RVSX    P      Multi Company L
     C                     Z-ADDWL0026    #RMCNB           Number of Order
      * CASE: RCD.Number of Orders is Greater Than 1
     C           #RMCNB    IFGT 1                          *IF
     C                     MOVEL'Y'       #1RVSX           Multi Company L
     C                     END                             *FI
     C                     MOVEL#CB8ST    P2B8ST           Status - Y or N
     C                     END                             *FI
      * Reload If Warehouse is entered
      * CASE: CTL.Warehouse 1 USR EQ WRK.Warehouse 1 USR
     C           #CZUCD    IFEQ WUZUCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#CZUCD    WUZUCD           Warehouse 1 USR
      * ** 04/20/2012 LJB E002057
      * RTV Num Multi-Whs Ords RT - Load Detail  * trf011
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0024           Load ID
     C                     Z-ADD#RMCNB    WL0026           Number of Order
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0025    #1RVSX    P      Multi Company L
     C                     Z-ADDWL0026    #RMCNB           Number of Order
      * CASE: RCD.Number of Orders is Greater Than 1
     C           #RMCNB    IFGT 1                          *IF
     C                     MOVEL'Y'       #1RVSX           Multi Company L
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Reload If LastStopCity is entered       trf011 7/28/06
      * CASE: CTL.USR Load/Stop 10 Alpha EQ WRK.USR Load/Stop 10 Alpha
     C           #CLINA    IFEQ WULINA                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#CLINA    WULINA           USR Load/Stop 1
      * ** 04/20/2012 LJB E002057
      * RTV Num Multi-Whs Ords RT - Load Detail  * trf011
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0024           Load ID
     C                     Z-ADD#RMCNB    WL0026           Number of Order
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0025    #1RVSX    P      Multi Company L
     C                     Z-ADDWL0026    #RMCNB           Number of Order
      * CASE: RCD.Number of Orders is Greater Than 1
     C           #RMCNB    IFGT 1                          *IF
     C                     MOVEL'Y'       #1RVSX           Multi Company L
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * RELOAD: Ship Method Type
      * CASE: CTL.Ship Method Type USR NE LCL.Ship Method Type USR
     C           #C        IFNE YL0002                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * ** 04/20/2012 LJB E002057
      * RTV Num Multi-Whs Ords RT - Load Detail  * trf011
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0024           Load ID
     C                     Z-ADD#RMCNB    WL0026           Number of Order
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0025    #1RVSX    P      Multi Company L
     C                     Z-ADDWL0026    #RMCNB           Number of Order
      * CASE: RCD.Number of Orders is Greater Than 1
     C           #RMCNB    IFGT 1                          *IF
     C                     MOVEL'Y'       #1RVSX           Multi Company L
     C                     END                             *FI
     C                     MOVEL#C        YL0002           Ship Method Typ
     C                     END                             *FI
      * RELOAD: change in ctl.Weight Adjust 6.0     USR    e00180 8/07/08
      * CASE: CTL.Weight Adjust 6.0     USR NE LCL.Weight Adjust 6.0
     C           #CG2NX    IFNE YL0014                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * ** 04/20/2012 LJB E002057
      * RTV Num Multi-Whs Ords RT - Load Detail  * trf011
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0024           Load ID
     C                     Z-ADD#RMCNB    WL0026           Number of Order
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0025    #1RVSX    P      Multi Company L
     C                     Z-ADDWL0026    #RMCNB           Number of Order
      * CASE: RCD.Number of Orders is Greater Than 1
     C           #RMCNB    IFGT 1                          *IF
     C                     MOVEL'Y'       #1RVSX           Multi Company L
     C                     END                             *FI
     C                     Z-ADD#CG2NX    YL0014           Weight Adjust 6
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     MOVEL'N'       P3E7ST           USR Print Detai
     C                     MOVEL'N'       P4D4ST           USR Flag 1
      * if USR Update Flag = Y
      * CASE: PAR.USR Update Flag is No
     C           P3R4ST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     MOVEL'*YES'    P3XFST           Display Prt Opt
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,45
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * OMS203: 1/97  no updates allowed if load contains block orders
      * * Ensure have current data
      * ** Put miles into wrk context. Use Override Miles if entered.  E0
      * RTV WW Screen Fields   RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    #1AODT           Scheduled Ship
     C                     MOVELWL0029    #1PKST    P      Load Status
     C                     Z-ADDWL0030    #1RPNB           Total Load Orde
     C                     Z-ADDWL0031    #1FLAM           Flat Amount
     C                     MOVELWL0032    #1XQST    P      Allocate Pounds
     C                     MOVELWL0033    #1DXTX    P      Trailer Id
     C                     MOVELWL0034    #1BZNA    P      Carrier Code
     C                     MOVELWL0035    #1RONB    P      Truck Size
     C                     MOVELWL0036    #1VDST    P      Load Type
     C                     Z-ADDWL0037    #1T4NB           Schedule Sequen
     C                     Z-ADDWL0038    WUTLMI           Total Load Mile
     C                     MOVELWL0039    #1Q2CD    P      Shipping Method
     C                     MOVELWL0040    #1VPCD    P      Ship From Wareh
     C                     MOVELWL0041    #1DBCD    P      Ship To State C
     C                     MOVELWL0042    #1RMST    P      Load Acceptance
     C                     Z-ADDWL0043    #1IDWG           Tot Pallet Tare
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0044           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YN0001    P      Load Status
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     Z-ADDWL0047    WUK2DT           Override Total
      * ** Set highlight flag, Override Total Load Miles entered   E00207
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     END                             *FI
      * Error if Load Header Not Found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0007           Load ID
      * Send message 'OM Load Header not found'
     C                     MOVEL'USR2313' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0018           Load ID
     C                     MOVEL#RBCST    WL0020    P      Block Order Fla
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    WUG0TX    P      USR Check Y/N S
     C                     MOVELWL0020    #RBCST    P      Block Order Fla
     C                     MOVEL#1DXTX    #RS2TX           Trailer ID USR
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * E4119  LIVE WITH TMS RESTRICTED OPTIONS
      * CASE: RCD.MG Created Load is Yes
     C           #1RYSX    IFEQ 'Y'                        *IF
      * CASE:
      *  - c2ORc3ORc4ORc6
      *   |- c2    : RCD.*SFLSEL is *Delete
      *   |- c3    : RCD.*SFLSEL is Option 9
      *   |- c4    : RCD.*SFLSEL is Option 10
      *   |- c6    : RCD.*SFLSEL is Option 12
      *   '-
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C           #1SEL     OREQ '9'                        *OR
     C           #1SEL     OREQ ' 9'
     C           #1SEL     OREQ '10'                       *OR
     C           #1SEL     OREQ '12'                       *OR
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'Live TMS Option Invalid'
     C                     MOVEL'USR4601' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * 2=Process change load request
      * CASE: RCD.*SFLSEL is *Change Status
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * CASE: RCD.Block Order Flag is Block Order
     C           #RBCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0009           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0010           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0011           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0012           Load ID
      * Send message 'Load Status inv for Chg'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If Usr Flag 1 = Y then it will send to Fax routine
      * EDT Load Header        E1 - Load Header  * 
     C                     CALL 'PDCIE1R'              90  EDT Load Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0036  70       Load ID
     C           P4D4ST    PARM P4D4ST    WQ0037  1        USR Flag 1
     C           #RB8ST    PARM *BLANK    WQ0038  1        STATUS
     C           #RE6ST    PARM *BLANK    WQ0039  1        USR Status (Y/N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCIE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1RMNB    P2AJAE           Order Number 1
     C                     Z-ADD#1RMNB    P6RMNB           Load ID
      * ** Put miles into wrk context. Use Override Miles if entered.  E0
      * RTV WW Screen Fields   RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    #1AODT           Scheduled Ship
     C                     MOVELWL0029    #1PKST    P      Load Status
     C                     Z-ADDWL0030    #1RPNB           Total Load Orde
     C                     Z-ADDWL0031    #1FLAM           Flat Amount
     C                     MOVELWL0032    #1XQST    P      Allocate Pounds
     C                     MOVELWL0033    #RS2TX    P      Trailer Id
     C                     MOVELWL0034    #1BZNA    P      Carrier Code
     C                     MOVELWL0035    #1RONB    P      Truck Size
     C                     MOVELWL0036    #1VDST    P      Load Type
     C                     Z-ADDWL0037    #1T4NB           Schedule Sequen
     C                     Z-ADDWL0038    WUTLMI           Total Load Mile
     C                     MOVELWL0039    #1Q2CD    P      Shipping Method
     C                     MOVELWL0040    #1VPCD    P      Ship From Wareh
     C                     MOVELWL0041    WUDBCD    P      Ship To State C
     C                     MOVELWL0042    #1RMST    P      Load Acceptance
     C                     Z-ADDWL0043    #1IDWG           Tot Pallet Tare
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0044           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YN0001    P      Load Status
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     Z-ADDWL0047    WUK2DT           Override Total
     C                     MOVEL#1BZNA    P6BZNA           Carrier Code
      * ** Set highlight flag, Override Total Load Miles entered   E00207
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     END                             *FI
     C                     Z-ADD#1T4NB    #RG0NX           Numeric 4,0
      * *----------------------------------------------------------------
      * * 05/15/00 PKD OMS336 Replaced with routine that will include
      * *              the Pallet Tare Weight.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1PKST' defaulted for 'Load Status'.
      * RTV GrsWgt w/PltTr Ld RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0010           Load ID
     C                     Z-ADD*ZERO     WL0011           Stop_Drop Seque
     C                     Z-ADDP3CDWG    WL0012           USR Weight Accu
     C                     MOVEL#1PKST    WL0013    P      Load Status
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P3CDWG           USR Weight Accu
      * *----------------------------------------------------------------
     C                     Z-ADDP3CDWG    #RG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
      * CASE: RCD.Load Status is Locked or Shipped
     C           #1PKST    IFEQ 'L'                        *IF
     C           #1PKST    OREQ 'S'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0048           PFS Company Num
     C                     MOVEL'LDORDD'  WL0049    P      PFS Interface C
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YN0002    P      PFS AccuSort Ac
     C                     MOVELWL0051    YL0015    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0015    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0040  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 4=If delete request display pending message
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * CASE: RCD.Load Status is Lock
     C           #1PKST    IFEQ 'L'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0013           *SFLSEL
     C                     Z-ADDWUTENB    ZA0014           USR Stop
      * Send message 'Load Locked Can't Delete'
     C                     MOVEL'USR1269' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If an order assigned to this load is confirmed, then can't delete
      * Val Order for Load Dl RT - OP Order Header  * 
     C                     EXSR SURVGN
      * If confirmed/picked order exists, can't delete
      * CASE: PGM.*Return code is Order on load can't unlck
     C           W0RTN     IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0015           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0016           Load ID
      * Send message 'Order Picked/Confirmed'
     C                     MOVEL'USR1247' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: PGM.*Return code is Order in use
     C           W0RTN     IFEQ @CN,005                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0017           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0018           Load ID
      * Send message 'Order in Use;cant unlock'
     C                     MOVEL'USR2279' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't delete
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0019           Load Status
      * Send message 'Load Shipped Can't Delete'
     C                     MOVEL'USR1275' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Delete pending'
     C                     MOVEL'USR0597' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 5=Process display orders on load request
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * used to call WW DSP ORDERS ON LOAD DF (Order Header) (PDJ6DFR)
      * WW Orders on Load      DF - OM Load Detail  * 
     C                     CALL 'PDODDFR'              90  WW Orders on Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0041  70       Load ID
     C           P3CDWG    PARM P3CDWG    WQ0042 112       USR Weight Accu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDODDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * 6=Print Load Confirmation
      * CASE: RCD.*SFLSEL is *Print
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * CASE: RCD.Carrier Code EQ WRK.BLANK
     C           #1BZNA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0020           Carrier Code
     C                     Z-ADD#1RMNB    ZA0021           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1RMNB    P2AJAE           Order Number 1
     C                     MOVEL#1BZNA    P6BZNA           Carrier Code
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
      * prompt for printer specs
      * CASE: PAR.USR Print Detail is Not Yes
     C           P3E7ST    IFEQ *BLANK                     *IF
     C           P3E7ST    OREQ 'N'
     C                     MOVEL*BLANK    YL0016           Hold On Jobq
     C                     MOVEL'*NO'     YL0016           Hold On Jobq
     C                     MOVEL*BLANK    YL0017           Job Log Create
     C                     MOVEL'*NO'     YL0017           Job Log Create
     C                     MOVEL@CN,006   P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL'*NO'     P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     MOVEL'*NO'     P2WTST           PRT Save Output
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     MOVELP1MPNA    P2WRST           PRT Printer Dev
      * ** pass 1 for number of copies to print options       P000737
     C                     Z-ADD1         P2DYNB           PRT Number of C
      * PMT Print Option  SHR  PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2G3TX    WQ0043 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0044 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0045  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0046  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WQ0047  20       PRT Number of C
     C           P2WUST    PARM P2WUST    WQ0048  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0049 10        PRT Night Queue
     C                     PARM 'O/M'     WQ0050  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDP2DYNB    P2M8NB           System Value Nu
     C                     MOVEL'Y'       P3E7ST           USR Print Detai
     C                     END                             *FI
      * print
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** default # of copies to 1 if it is zeros      P000737
      * CASE: PAR.System Value Numeric is Equal to zero
     C           P2M8NB    IFEQ *ZERO                      *IF
     C                     Z-ADD1         P2M8NB           System Value Nu
     C                     END                             *FI
     C                     MOVEL'P'       WUE6ST           USR Status (Y/N
     C                     MOVEL@CN,008   WUNMTX           Status Descript
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'N'       WUAJTX           Status Flag 5
      * EXC Load Confirm Fax   IF - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AJAA    WL0052           Company Number
     C                     Z-ADDP2AJAE    WL0053           Order Number 1
     C                     MOVEL*BLANK    WL0054           Transloader Car
     C                     MOVELP6BZNA    WL0055    P      Carrier Code
     C                     MOVEL*BLANK    WL0056           Shipping Line
     C                     MOVEL*BLANK    WL0057           OHE Carrier SCA
     C                     MOVELWUQ1ST    WL0058    P      Status Flag 1
     C                     MOVELWUQ2ST    WL0059    P      Status Flag 2
     C                     MOVELWUQ3ST    WL0060    P      Status Flag 3
     C                     MOVELWUFMST    WL0061    P      Status Flag 4
     C                     MOVELWUAJTX    WL0062    P      Status Flag 5
     C                     MOVELWUB8ST    WL0063    P      Status - Y or N
     C                     MOVELWUNMTX    WL0064    P      Status Descript
     C                     MOVELWUE6ST    WL0065    P      USR Status (Y/N
     C                     MOVELP2G3TX    WL0066    P      PRT Description
     C                     MOVELP2WRST    WL0067    P      PRT Printer Dev
     C                     MOVELP2WSST    WL0068    P      PRT Hold Output
     C                     MOVELP2WTST    WL0069    P      PRT Save Output
     C                     MOVELP2WUST    WL0070    P      PRT Night Queue
     C                     MOVELP2BVVN    WL0071    P      PRT Night Queue
     C                     Z-ADDP2M8NB    WL0072           System Value Nu
     C                     MOVEL*BLANK    WL0073           Email Address
     C                     EXSR SWINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    P2AJAA           Company Number
     C                     Z-ADDWL0053    P2AJAE           Order Number 1
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     END                             *FI
      * 7=If process unlock request, check for errors
      * CASE: RCD.*SFLSEL is *Unlock Load
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * RMC 6/5/6 dont allow unlock if picked from this pgm
      *
     C                     MOVEL*BLANK    WN0002  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       P3ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0003 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0003           User Profile Na
      *
     C                     MOVEL*BLANK    WN0004 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0003    WL0074    P      User Profile Na
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0075    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0076    WUG0TX    P      Default Printer
     C                     MOVELWL0077    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0078    YL0018           Company Number
     C                     MOVELWL0079    WN0004    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0004    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0003    WL0080    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0081    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WUAIC3           Company Number
     C                     MOVELWL0083    YL0019    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0004    WL0080    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0081    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WUAIC3           Company Number
     C                     MOVELWL0083    YL0019    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0019    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0018    IFGT 0                          *IF
     C                     Z-ADDYL0018    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0019    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0020    WL0085           Shipping Compan
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0002           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0086           Company Number
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
     C                     EXSR TBRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0002    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           #RBCST    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0022           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0023           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0024           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0071  70       Load ID
     C                     PARM #1AIC3    WQ0072  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0073  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0025           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0074  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0075  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0026           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P3ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
      * 8=If process lock request, check for errors
      * CASE: RCD.*SFLSEL is *Lock Load
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * ** Don't allow lock if errors pending in Order Detail   P001251
      *
     C                     Z-ADD*ZERO     WN0005  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0006  70       Minimum pounds
     C                     MOVEL*BLANK    WN0007  1        USR Orders on L
     C                     MOVEL*BLANK    WN0008  1        Order in Use
     C                     MOVEL*BLANK    WN0009  1        Header Status
     C                     MOVEL*BLANK    WN0010  1        Access Denied (
      *
      * EDT Lock Load Edits    IF
      * assume will have error
     C                     MOVEL'Y'       P3ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0011 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0011           User Profile Na
      *
     C                     MOVEL*BLANK    WN0012 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0011    WL0074    P      User Profile Na
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0075    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0076    WUG0TX    P      Default Printer
     C                     MOVELWL0077    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0078    YL0018           Company Number
     C                     MOVELWL0079    WN0012    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0012    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0011    WL0080    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0081    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WUAIC3           Company Number
     C                     MOVELWL0083    YL0019    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0080    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0081    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WUAIC3           Company Number
     C                     MOVELWL0083    YL0019    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0019    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0018    IFGT 0                          *IF
     C                     Z-ADDYL0018    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0019    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0020    WL0085           Shipping Compan
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0010           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0086           Company Number
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0010    IFEQ 'Y'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
     C                     EXSR TDRVGN
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0027           Load ID
     C                     MOVEL#1SEL     ZA0028           *SFLSEL
      * Send message 'No Orders Assigned'
     C                     MOVEL'USR1276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           #RBCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0029           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0030           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0031           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0032           Load ID
      * Send message 'Load Cant be Locked'
     C                     MOVEL'USR2189' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: PAR.Carrier Code EQ WRK.BLANK
     C           #1BZNA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0033           Carrier Code
     C                     Z-ADD#1RMNB    ZA0034           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           #1RONB    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1RONB    ZA0035           Truck Size
     C                     Z-ADD#1RMNB    ZA0036           Load ID
      * Send message 'Truck size must be enter'
     C                     MOVEL'USR1255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           #1Q2CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1Q2CD    ZA0037           Shipping Method
      * Send message 'Shipping Method required'
     C                     MOVEL'USR2197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0007    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0038           Load ID
      * Send message 'Load has orders w/o stop'
     C                     MOVEL'USR2196' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           #1RMST    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0039           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - OP Order Header  * 
     C                     EXSR TERVGN
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0009    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0040           Load ID
     C                     MOVEL#1SEL     ZA0041           *SFLSEL
      * Send message 'Load has Orders on Hold'
     C                     MOVEL'USR1921' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0009    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0042           Load ID
     C                     MOVEL#1SEL     ZA0043           *SFLSEL
      * Send message 'Load has Cancelled Orders'
     C                     MOVEL'USR2236' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0008    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0044           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0045           Load ID
      * Send message 'Load has Orders in Use'
     C                     MOVEL'USR2280' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check if Export Order Automation Upload had errors  P001251
      * RTV Ord Requires Revw RT - Order Header TRG  * 
     C                     EXSR TFRVGN
      * ** Cannot lock if Upload had errors                  P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0021    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0046           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0047           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
     C                     EXSR TGRVGN
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           #1RPNB    IFLT WN0006                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0048           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           #1RPNB    IFGT WN0005                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P3ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
      * 9 = If process calc rated freight, check for errors
      * CASE: RCD.*SFLSEL is *Calc Rated Freight
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Find errors or send msg
      * CASE: RCD.Load Status is Lock
     C           #1PKST    IFEQ 'L'                        *IF
      * Warehouse, state required
      * CASE: RCD.Ship From Warehouse EQ WRK.BLANK
     C           #1VPCD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0049           *SFLSEL
      * Send message 'Ship From Whs required'
     C                     MOVEL'USR2228' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: RCD.Ship To State Code EQ WRK.BLANK
     C           #1DBCD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0050           *SFLSEL
      * Send message 'Ship to State required'
     C                     MOVEL'USR2229' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Put miles into wrk context. Use Override Miles if entered.  E0
      * RTV Name, Status       RT - OM Carrier  * 
     C                     EXSR THRVGN
      * EDT Calc Rated Freight ET - Load Header  * 
     C                     CALL 'PDYLETR'              90  EDT Calc Rated
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0076  70       Load ID
     C                     PARM #1RPNB    WQ0077  70       Total Load Orde
     C           #1FLAM    PARM #1FLAM    WQ0078 112       Flat Amount
     C           #1XQST    PARM #1XQST    WQ0079  1        Allocate Pounds
     C                     PARM #1BZNA    WQ0080  3        Carrier Code
     C           #1R1NB    PARM #1R1NB    WQ0081 112       Rated Freight
     C           WUTLMI    PARM WUTLMI    WQ0082  70       Total Load Mile
     C                     PARM #1VPCD    WQ0083  3        Ship From Wareh
     C                     PARM #1DBCD    WQ0084  2        Ship To State C
     C                     PARM #1XCCD    WQ0085  3        Carrier Broker
     C           WUK2DT    PARM WUK2DT    WQ0086  70       Override Total
     C                     PARM WUGVTX    WQ0087 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYLETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV WW Screen Fields   RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    #1AODT           Scheduled Ship
     C                     MOVELWL0029    #1PKST    P      Load Status
     C                     Z-ADDWL0030    #1RPNB           Total Load Orde
     C                     Z-ADDWL0031    #1FLAM           Flat Amount
     C                     MOVELWL0032    #1XQST    P      Allocate Pounds
     C                     MOVELWL0033    #1DXTX    P      Trailer Id
     C                     MOVELWL0034    #1BZNA    P      Carrier Code
     C                     MOVELWL0035    #1RONB    P      Truck Size
     C                     MOVELWL0036    #1VDST    P      Load Type
     C                     Z-ADDWL0037    #1T4NB           Schedule Sequen
     C                     Z-ADDWL0038    WUTLMI           Total Load Mile
     C                     MOVELWL0039    #1Q2CD    P      Shipping Method
     C                     MOVELWL0040    #1VPCD    P      Ship From Wareh
     C                     MOVELWL0041    #1DBCD    P      Ship To State C
     C                     MOVELWL0042    #1RMST    P      Load Acceptance
     C                     Z-ADDWL0043    #1IDWG           Tot Pallet Tare
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0044           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YN0001    P      Load Status
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     Z-ADDWL0047    WUK2DT           Override Total
      * ** Set highlight flag, Override Total Load Miles entered   E00207
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL#1DXTX    #RS2TX           Trailer ID USR
     C                     END                             *FI
      * *----------------------------------------------------------------
      * * 05/15/00 PKD OMS336 Replaced with routine that will include
      * *              the Pallet Tare Weight.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1PKST' defaulted for 'Load Status'.
      * RTV GrsWgt w/PltTr Ld RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0010           Load ID
     C                     Z-ADD*ZERO     WL0011           Stop_Drop Seque
     C                     Z-ADDP3CDWG    WL0012           USR Weight Accu
     C                     MOVEL#1PKST    WL0013    P      Load Status
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P3CDWG           USR Weight Accu
      * *----------------------------------------------------------------
     C                     Z-ADDP3CDWG    #RG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0051           *SFLSEL
      * Send message 'Option invalid-not locked'
     C                     MOVEL'USR2109' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 10=Process change load orders request    Edit Load Plan
      * CASE: RCD.*SFLSEL is *Work with Orders
     C           #1SEL     IFEQ '10'                       *IF
      * CASE: RCD.Block Order Flag is Block Order
     C           #RBCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0052           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0053           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0054           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0055           Load ID
      * Send message 'Load Status inv for Chg'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: RCD.Load Status is Lock
     C           #1PKST    IFEQ 'L'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0056           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0057           Load ID
      * Send message 'Load Status inv for Chg'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Pass Access Limited parm                   W288
      * Edt Load Plan          DF - Order Header TRG  * 
     C                     CALL 'OMQ6DFR'              90  Edt Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0088  30       Company Number
     C           #1RMNB    PARM #1RMNB    WQ0089  70       Load ID
     C                     PARM #1PKST    WQ0090  1        Load Status
     C           WUD4ST    PARM WUD4ST    WQ0091  1        USR Update Flag
     C                     PARM 'Y'       WQ0092  1        Access Limited
     C           P5B2VN    PARM P5B2VN    WQ0093 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMQ6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set USR Flag 1
      * CASE: WRK.USR Flag 1 is Yes
     C           WUD4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P4D4ST           USR Flag 1
     C                     END                             *FI
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1RMNB    P2AJAE           Order Number 1
     C                     Z-ADD#1RMNB    P6RMNB           Load ID
      * ** Put miles into wrk context. Use Override Miles if entered.  E0
      * RTV WW Screen Fields   RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0027           Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    #1AODT           Scheduled Ship
     C                     MOVELWL0029    #1PKST    P      Load Status
     C                     Z-ADDWL0030    #1RPNB           Total Load Orde
     C                     Z-ADDWL0031    #1FLAM           Flat Amount
     C                     MOVELWL0032    #1XQST    P      Allocate Pounds
     C                     MOVELWL0033    #1DXTX    P      Trailer Id
     C                     MOVELWL0034    #1BZNA    P      Carrier Code
     C                     MOVELWL0035    #1RONB    P      Truck Size
     C                     MOVELWL0036    #1VDST    P      Load Type
     C                     Z-ADDWL0037    #1T4NB           Schedule Sequen
     C                     Z-ADDWL0038    WUTLMI           Total Load Mile
     C                     MOVELWL0039    #1Q2CD    P      Shipping Method
     C                     MOVELWL0040    #1VPCD    P      Ship From Wareh
     C                     MOVELWL0041    WUDBCD    P      Ship To State C
     C                     MOVELWL0042    #1RMST    P      Load Acceptance
     C                     Z-ADDWL0043    #1IDWG           Tot Pallet Tare
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0044           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YN0001    P      Load Status
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     Z-ADDWL0047    WUK2DT           Override Total
      * ** Set highlight flag, Override Total Load Miles entered   E00207
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     MOVEL#1BZNA    P6BZNA           Carrier Code
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL#1DXTX    #RS2TX           Trailer ID USR
     C                     END                             *FI
      * *----------------------------------------------------------------
      * * 05/15/00 PKD OMS336 Replaced with routine that will include
      * *              the Pallet Tare Weight.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1PKST' defaulted for 'Load Status'.
      * RTV GrsWgt w/PltTr Ld RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0010           Load ID
     C                     Z-ADD*ZERO     WL0011           Stop_Drop Seque
     C                     Z-ADDP3CDWG    WL0012           USR Weight Accu
     C                     MOVEL#1PKST    WL0013    P      Load Status
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P3CDWG           USR Weight Accu
      * *----------------------------------------------------------------
     C                     Z-ADDP3CDWG    #RG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 11=Edit Traffic Comments
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * EDT PD Traffic Comment EF - PD Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0094  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * 12=Calc Total Load Miles Option
      * CASE: RCD.*SFLSEL is *Calc Total Load Miles
     C           #1SEL     IFEQ '12'                       *IF
      * CASE: LCL.Application WHS Restrict is no
     C           YL0001    IFEQ 'N'                        *IF
      * EDT Stop Miles         EF - OM Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW7EFR'              90  EDT Stop Miles
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW7EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Retrieve both total miles and override miles    E00207
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0044           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YN0001    P      Load Status
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     Z-ADDWL0047    WUK2DT           Override Total
      * ** Use Override miles, if entered                 E00207
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0058           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 14 = Edit Export Instructions
      * CASE: RCD.*SFLSEL is Option 14
     C           #1SEL     IFEQ '14'                       *IF
      * CASE: RCD.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * ** First select which order is to be processed. Then pass the
      * ** order number to the Edit Export Instructions program
     C                     MOVEL'N'       WUG8SX           Exit Selection
      * ** Loop until the Select receives an <F3> to exit
      * DO WHILE: Loop till F3 from Select pgm or Edit pgm
      *  - c1 OR c2
      *   |- c1    : WRK.Exit Selection USR is No
      *   |- c2    : WRK.USR Exit Program is yes
      *   '-
     C                     DO   *HIVAL                     *DOW
     C           WUG8SX    IFEQ 'N'                        *IF
     C           WUSTYN    OREQ 'Y'                        *OR
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * 11/23/22 DN DO4595-Replaced PMFXSRR with PUXRSRR.
      * SEL Order/Load/Exp Sts2SR - Order Header TRG  * 
     C                     CALL 'PUXRSRR'              90  SEL Order/Load/
     C                     PARM *BLANK    W0RTN   7
     C           WUG8SX    PARM WUG8SX    WQ0095  1        Exit Selection
     C           WUMPNB    PARM *ZERO     WQ0096  70       Order Number
     C                     PARM #1RMNB    WQ0097  70       Load ID
     C           WUFKNB    PARM *ZERO     WQ0098  30       USR Company Num
     C           YL0022    PARM YL0022    WQ0099  1        Orders have Sam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUXRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Process record if not <F3> to exit
      * CASE: WRK.Exit Selection USR is No
     C           WUG8SX    IFEQ 'N'                        *IF
      * CASE: RCD.MG Created Load is Yes
     C           #1RYSX    IFEQ 'Y'                        *IF
      * DSP Cust Ord Export    D1 - Order Header Extension  * 
     C                     CALL 'PMFWD1R'              90  DSP Cust Ord Ex
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUFKNB    WQ0100  30       Company Number
     C                     PARM WUMPNB    WQ0101  70       Order Number
     C                     PARM #1RMNB    WQ0102  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFWD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * 11/23/22 DN DO4595-Passed in Parm 'Orders have Same Booking#'.
      * EDT Export Order Instr E2 - Order Header Extension  * 
     C                     CALL 'PNVZE2R'              90  EDT Export Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUFKNB    WQ0103  30       Company Number
     C                     PARM WUMPNB    WQ0104  70       Order Number
     C           #1RMNB    PARM #1RMNB    WQ0105  70       Load ID
     C           WUSTYN    PARM WUSTYN    WQ0106  1        USR Exit Progra
     C                     PARM YL0022    WQ0107  1        Orders have Sam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNVZE2R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *ITR
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
      * CASE: RCD.Load Status is Unlocked thru Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'S'
     C           #1PKST    OREQ 'U'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0048           PFS Company Num
     C                     MOVEL'LDORDD'  WL0049    P      PFS Interface C
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YN0002    P      PFS AccuSort Ac
     C                     MOVELWL0051    YL0015    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0015    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0108  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0059           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 18 = Flag to Fax load confirmation, send to SSI PowerPro, if appl
      * CASE: RCD.*SFLSEL is Option 18
     C           #1SEL     IFEQ '18'                       *IF
      * ** interactive - can take a while if several are selected
      * CASE: RCD.Carrier Code is not entered
     C           #1BZNA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0060           *SFLSEL
     C                     MOVEL#1BZNA    ZA0061           Carrier Code
      * Send message 'Carrier entered to Fax'
     C                     MOVEL'USR2444' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1RMNB    P2AJAE           Order Number 1
     C                     Z-ADD#1RMNB    P6RMNB           Load ID
     C                     MOVEL#1BZNA    P6BZNA           Carrier Code
     C                     Z-ADD#1RMNB    WURMNB           Load ID
      * ** Check SSI download flag. If Yes, send info to PowerPro  FP1166
      * RTV SSI Carrier flag   RT - Carrier  * 
     C                     EXSR TIRVGN
      * RTV SSI Fax'd Flag     RT - Load Header  * 
     C                     EXSR TJRVGN
      * CASE: RCD.MG Created Load is Not MG Created Load
     C           #1RYSX    IFEQ *BLANK                     *IF
      * ** See if carrier has already received a fax, if yes, send Change
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * CASE: WRK.Fax Sent to SSI Carrier is Not Fax'd to Carrier
     C           WURUSX    IFEQ *BLANK                     *IF
     C           WURUSX    OREQ 'N'
     C                     MOVEL'00'      WUAHST           SSI Add, Chg, D
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Send "Changed" record to SSI PowerPro
     C                     MOVEL'04'      WUAHST           SSI Add, Chg, D
     C                     END                             *FI
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0109  70       Load ID
     C                     PARM #1BZNA    WQ0110  3        Carrier Code
     C                     PARM WUAHST    WQ0111  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Fax'd to SSI flag  CH - Load Header  * 
     C                     EXSR TKCHRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * if USR Flag 1 is not yes
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.USR Flag 1 is No
      *   |- c2    : PAR.USR Flag 1 is Blank
      *   '-
     C           P4D4ST    IFEQ 'N'                        *IF
     C           P4D4ST    OREQ *BLANK                     *OR
      * ** Fax/Email Documentation                        P000737
     C                     EXSR UDSUBR                     ** Fax/Email Do
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'N'       WUAJTX           Status Flag 5
     C                     MOVEL'F'       WUE6ST           USR Status (Y/N
     C                     MOVEL@CN,008   WUNMTX           Status Descript
     C                     MOVEL@CN,006   P2G3TX           PRT Description
     C                     MOVELP1MPNA    P2WRST           PRT Printer Dev
     C                     MOVEL'*YES'    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     MOVEL'*NO'     P2WTST           PRT Save Output
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD1         P2DYNB           PRT Number of C
      * PMT Print Option  SHR  PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2G3TX    WQ0112 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0113 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0114  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0115  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WQ0116  20       PRT Number of C
     C           P2WUST    PARM P2WUST    WQ0117  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0118 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0119  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDP2DYNB    P2M8NB           System Value Nu
     C                     MOVEL'Y'       P4D4ST           USR Flag 1
     C                     END                             *FI
      * ** Fax Load Confirmation - Cancel if F3 is pressed   C1921
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,007                    *IF
      * Send message 'Fax/Email cancelled'
     C                     MOVEL'USR4484' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * EXC Load Confirm Fax   IF - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AJAA    WL0052           Company Number
     C                     Z-ADDP2AJAE    WL0053           Order Number 1
     C                     MOVEL*BLANK    WL0054           Transloader Car
     C                     MOVELP6BZNA    WL0055    P      Carrier Code
     C                     MOVEL*BLANK    WL0056           Shipping Line
     C                     MOVEL*BLANK    WL0057           OHE Carrier SCA
     C                     MOVELWUQ1ST    WL0058    P      Status Flag 1
     C                     MOVELWUQ2ST    WL0059    P      Status Flag 2
     C                     MOVELWUQ3ST    WL0060    P      Status Flag 3
     C                     MOVELWUFMST    WL0061    P      Status Flag 4
     C                     MOVELWUAJTX    WL0062    P      Status Flag 5
     C                     MOVELWUB8ST    WL0063    P      Status - Y or N
     C                     MOVELWUNMTX    WL0064    P      Status Descript
     C                     MOVELWUE6ST    WL0065    P      USR Status (Y/N
     C                     MOVELP2G3TX    WL0066    P      PRT Description
     C                     MOVELP2WRST    WL0067    P      PRT Printer Dev
     C                     MOVELP2WSST    WL0068    P      PRT Hold Output
     C                     MOVELP2WTST    WL0069    P      PRT Save Output
     C                     MOVELP2WUST    WL0070    P      PRT Night Queue
     C                     MOVELP2BVVN    WL0071    P      PRT Night Queue
     C                     Z-ADDP2M8NB    WL0072           System Value Nu
     C                     MOVEL*BLANK    WL0073           Email Address
     C                     EXSR SWINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    P2AJAA           Company Number
     C                     Z-ADDWL0053    P2AJAE           Order Number 1
      * Send message 'Fax Load Conf sent to car'
     C                     MOVEL'USR2445' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     END                             *FI
      * 19=Display Load
      * CASE: RCD.*SFLSEL is Option 19
     C           #1SEL     IFEQ '19'                       *IF
      * DSP Load Plan          DF - OM Load Detail  * 
     C                     CALL 'PDSLDFR'              90  DSP Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0120  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSLDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 20=Display Change Log
      * CASE: RCD.*SFLSEL is Option 20
     C           #1SEL     IFEQ '20'                       *IF
      * DSP Chg Log Entries-Ld DF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDCRDFR'              90  DSP Chg Log Ent
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCRDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * screen displays state of last stop on load, so get that field aga
      * do this @end of validate, so that processing will use REAL ship t
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0001           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUBKC7           Ship To Custome
     C                     MOVELWL0003    WUBRTX    P      Ship To Name
     C                     MOVELWL0004    WUHMNA    P      Ship To Address
     C                     MOVELWL0005    WUHONA    P      Ship To Address
     C                     MOVELWL0006    WUHPNA    P      Ship To Address
     C                     MOVELWL0007    #RLINA    P      Ship To City
     C                     MOVELWL0008    #RV9CD    P      Ship To State C
     C                     MOVELWL0009    WUCKTX    P      Ship To Zip/Pos
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,45
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Process delete load request
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * 12/14/22 DN DO4595-Cancel EDI 601 Transaction Processing.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Export Status is yes
      *   |- c2    : LCL.EDI Interchange Active U is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'Y'                        *IF
     C           YL0023    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Cancel EDI 601    RT - Order Header Extension  * 
     C                     EXSR TLRVGN
      * CASE: LCL.Cancel EDI 601 USR is Yes
     C           YL0031    IFEQ 'Y'                        *IF
      * RTV Country Code only  RT - Order Detail  * 
     C                     EXSR TMRVGN
      * Rtv CBP Info f/EDI 601 RT - Shipping Line/Port Extsn  * 
     C                     EXSR TNRVGN
      * Rtv Port of Unlading  RT - Country Port of Unlading  * 
     C                     EXSR TORVGN
      * Crt EDI 601 Exp Shp InfXF - EDI Export Shpmnt Inf HDR  * 
     C                     CALL 'PUXSXFR'              90  Crt EDI 601 Exp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0121  70       Order Number
     C                     PARM #1RMNB    WQ0122  70       Load ID
     C                     PARM YL0025    WQ0123  3        Shipping Line
     C                     PARM YL0026    WQ0124 20        Port Delv Termi
     C                     PARM YL0027    WQ0125 30        OHE Vessel/Airl
     C                     PARM YL0029    WQ0126  70       OHE Sail/Flight
     C                     PARM YL0030    WQ0127 15        OHE EDI 824 AES
     C                     PARM YL0032    WQ0128  6        Country Code
     C                     PARM YL0033    WQ0129  50       CBP Export Port
     C                     PARM YL0034    WQ0130  4        CBP Std Carrier
     C                     PARM YL0035    WQ0131  50       CBP Foreign Por
     C                     PARM 'D'       WQ0132  1        Add/Change/Dele
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUXSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ** Rtv ship to cust# for change log record            E000722
      * CHG Load Number        RT - Order Header TRG  * 
     C                     EXSR TPRVGN
      * *------------------------------------------------------*
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0133  30       Company Number
     C                     PARM *BLANK    WQ0134  1        Plant Company S
     C           YL0036    PARM *BLANK    WQ0135  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0036    IFEQ 'H'                        *IF
      * RTV First Order on LoadRT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0088           Load ID
     C                     EXSR TZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    #RC4NB           Order Number
     C                     END                             *FI
      * *------------------------------------------------------*
      * ** Write a group of Log recs for the deleted load     E000722
     C                     EXSR UESUBR                     ** Write a grou
      * DLT Load Detail       RT - Load Detail  * 
     C                     EXSR NBRVGN
      * DLT Load Header        DL - Load Header  * 
     C                     EXSR NDDLRC
      * Clear Program Message Q - UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Process unlock load
      * CASE: RCD.*SFLSEL is *Unlock Load
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      *
     C                     MOVEL*BLANK    WN0542  3        Shipping Line
     C                     MOVEL*BLANK    WN0543 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0544  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0545  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
     C                     EXSR NECHRC
      *
     C                     MOVEL*BLANK    WN0689  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0690  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN0691  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN0692  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0090           Load ID
     C                     EXSR NFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0091    WN0689    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
     C                     EXSR NJRVGN
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0048           PFS Company Num
     C                     MOVEL'LDORDD'  WL0049    P      PFS Interface C
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0039    P      PFS AccuSort Ac
     C                     MOVELWL0051    YL0040    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0039    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0689    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0136  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0137  70       Load ID
     C                     PARM #1AIC3    WQ0138  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0139  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0040    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0140  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0141  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0142  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
     C                     EXSR NKRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD#PRVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL#1PKST    PDMNTX    P      Change Log Prio
     C                     MOVEL'U'       PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * Process lock load
      * CASE: RCD.*SFLSEL is *Lock Load
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * CASE: RCD.Load Acceptance Flag is Load not Accepted
     C           #1RMST    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0062           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0996  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0997 112       Flat Amount
     C                     Z-ADD*ZERO     WN0998  50       Total Stops
     C                     Z-ADD*ZERO     WN0999  70       Total Load Mile
     C                     MOVEL*BLANK    WN1000  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1001  2        Ship To State C
     C                     MOVEL*BLANK    WN1002  3        Carrier Broker
     C                     MOVEL*BLANK    WN1003  1        Export Status
     C                     MOVEL*BLANK    WN1004  3        Shipping Line
     C                     MOVEL*BLANK    WN1005 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN1006  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1007  60       Deadline Depart
     C                     MOVEL*BLANK    WN1008  1        MG Created Load
     C                     MOVEL*BLANK    WN1009  2        Load U_M
     C                     MOVEL*BLANK    WN1010  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1011 20        Destination Cit
     C                     MOVEL*BLANK    WN1012  2        State Code
     C                     MOVEL*BLANK    WN1013  3        USR Warehouse C
     C                     MOVEL*BLANK    WN1014  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN1015  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN1016  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN1017  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN1018  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN1019  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN1020  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN1021  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN1022  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN1023 155       Company Number
     C                     Z-ADD*ZERO     WN1024 155       Date 1
     C                     Z-ADD*ZERO     WN1025 155       Order Number 1
     C                     Z-ADD*ZERO     WN1026  40       Requested Deliv
     C                     MOVEL*BLANK    WN1027  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
     C                     EXSR NQRVGN
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN1000    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR NRRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN1008    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
     C                     EXSR NTRVGN
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN1006           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
     C                     EXSR NURVGN
     C           WN1026    MULT 100       WN1007           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN1173  51       Hours Required
     C                     Z-ADD*ZERO     WN1174  50       Miles to next s
     C                     Z-ADD*ZERO     WN1175  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN1176  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN1177  50       @Days 5
     C                     Z-ADD*ZERO     WN1178  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1179  20       USR Period
     C                     Z-ADD*ZERO     WN1180  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1181  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UFSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR NWRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0041    IFEQ 'CT'                       *IF
     C           YL0041    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0097           Load ID
     C                     Z-ADD*ZERO     WL0098           Stop_Drop
     C                     Z-ADD*ZERO     WL0099           Order Number
     C                     EXSR NXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0100    WN1174           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN1174    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPERC
     C                     Z-ADD#1RMNB    PERMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0145  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0146  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0097           Load ID
     C                     Z-ADD*ZERO     WL0098           Stop_Drop
     C                     Z-ADD*ZERO     WL0099           Order Number
     C                     EXSR NXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0100    WN1174           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN1174    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN1006           Scheduled Deliv
     C                     Z-ADD*ZERO     WN1007           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN1173           Hours Required
     C                     Z-ADD*ZERO     YL0042           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR NYRVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0147  70       Load ID
     C           YL0043    PARM YL0043    WQ0148  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0042    ADD  YL0043    WN1173           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN1173    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN1173    DIV  24        WN1177           @Days 5
     C           WN1177    MULT 24        WU               USR Hours 5.0
     C           WN1173    SUB  WU        WN1175           USR Hours 5.0
     C           WN1175    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN1177    IFGT 0                          *IF
     C                     MULT -1        WN1177           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN1006    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN1177    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN1006
     C                     ELSE
     C           XDINDT    SUB  1000000   WN1006
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN1007                     *IF
     C                     SUB  WN1007    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN1177           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN1006    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN1177    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN1006
     C                     ELSE
     C           XDINDT    SUB  1000000   WN1006
     C                     END
     C           240000    SUB  WUPINB    WN1007           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN1007           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0044           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    WUG0TX    P      Load Status
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     Z-ADDWL0047    WUK2DT           Override Total
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0001           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUBKC7           Ship To Custome
     C                     MOVELWL0003    WUBRTX    P      Ship To Name
     C                     MOVELWL0004    WUHMNA    P      Ship To Address
     C                     MOVELWL0005    WUHONA    P      Ship To Address
     C                     MOVELWL0006    WUHPNA    P      Ship To Address
     C                     MOVELWL0007    WUHNNA    P      Ship To City
     C                     MOVELWL0008    WN1001    P      Ship To State C
     C                     MOVELWL0009    WUCKTX    P      Ship To Zip/Pos
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0998    IFEQ 1                          *IF
     C           WN0997    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
     C                     EXSR NZRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN1011    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN1011           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
     C                     EXSR OARVGN
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UGSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
     C                     EXSR OBCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0996    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR OCRVGN
     C                     Z-ADD#1AIC3    WN1023           Company Number
     C                     Z-ADD#1RMNB    WN1025           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0996    WN1024           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN1013    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN1027    PARM *BLANK    WQ0151  7        Return Code Usr
     C                     PARM 'OMS'     WQ0152  6        Application Cod
     C                     PARM @CN,016   WQ0153 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0154  1        USR Detail or S
     C                     PARM @CN,017   WQ0155 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0156 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0157  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0158  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0159  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0160 10        PRT Night Queue
     C           WN1023    PARM WN1023    WQ0161 155       Company Number
     C           WN1024    PARM WN1024    WQ0162 155       Date 1
     C           WN1025    PARM WN1025    WQ0163 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0164 155       System Value Nu
     C           WN1013    PARM WN1013    WQ0165  3        USR Warehouse C
     C           WN1014    PARM WN1014    WQ0166  3        USR CDE Parm 1
     C           WN1015    PARM WN1015    WQ0167  3        USR CDE Parm 2
     C           WN1016    PARM WN1016    WQ0168  3        USR CDE Parm 3
     C           WN1017    PARM WN1017    WQ0169  3        USR CDE Parm 4
     C           WN1018    PARM WN1018    WQ0170  3        USR CDE Parm 5
     C           WN1019    PARM WN1019    WQ0171  3        USR CDE Parm 6
     C           WN1020    PARM WN1020    WQ0172  3        USR CDE Parm 7
     C           WN1021    PARM WN1021    WQ0173  3        USR CDE Parm 8
     C           WN1022    PARM WN1022    WQ0174  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0175  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0176  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN1319  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0090           Load ID
     C                     EXSR NFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0091    WN1319    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0048           PFS Company Num
     C                     MOVEL'LDORDD'  WL0049    P      PFS Interface C
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0044    P      PFS AccuSort Ac
     C                     MOVELWL0051    YL0045    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0044    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1319    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0177  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0178  70       Load ID
     C                     PARM #1AIC3    WQ0179  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0180  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0045    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0181  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0182  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,018                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0996    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN1013    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN1013    WQ0183  3        Warehouse Code
     C                     PARM *BLANK    WQ0184 10        Default Printer
     C           YL0046    PARM *BLANK    WQ0185  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0046    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN1013    ZA0063           USR Warehouse C
     C                     MOVELWN1014    ZA0064           USR CDE Parm 1
     C                     MOVELWN1015    ZA0065           USR CDE Parm 2
     C                     MOVELWN1016    ZA0066           USR CDE Parm 3
     C                     MOVELWN1017    ZA0067           USR CDE Parm 4
     C                     MOVELWN1018    ZA0068           USR CDE Parm 5
     C                     MOVELWN1019    ZA0069           USR CDE Parm 6
     C                     MOVELWN1020    ZA0070           USR CDE Parm 7
     C                     MOVELWN1021    ZA0071           USR CDE Parm 8
     C                     MOVELWN1022    ZA0072           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UHSUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD#PRVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL#1PKST    PDMNTX    P      Change Log Prio
     C                     MOVEL'L'       PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN78
     C           #RKOST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUE6ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #RN8DT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #RHWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #1RVSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPJ1 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time (Y_N)
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh. Initia
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVEL*BLANK    #RE6ST           USR Status (Y/N
     C                     MOVEL*BLANK    #RHPNA           Ship To Address
     C                     MOVEL*BLANK    #RHONA           Ship To Address
     C                     MOVEL*BLANK    #RHMNA           Ship To Address
     C                     Z-ADD*ZERO     #RBKC7           Ship To Custome
     C                     Z-ADD*ZERO     #RC4NB           Order Number
     C                     MOVEL*BLANK    #RKOST           Include Todays
     C                     MOVEL*BLANK    #RBCST           Block Order Fla
     C                     MOVEL*BLANK    #RXBCD           Sail Port State
     C                     Z-ADD*ZERO     #RN8DT           LD Unused Date
     C                     Z-ADD*ZERO     #RG0NX           Numeric 4,0
     C                     MOVEL*BLANK    #RHWSX           Change Flag USR
     C                     MOVEL*BLANK    #R               Ship Method Typ
     C                     MOVEL*BLANK    #RY7TX           Text USR 5
     C                     MOVEL*BLANK    #RHNNA           Ship To City
     C                     MOVEL*BLANK    #RB8ST           Status - Y or N
     C                     Z-ADD*ZERO     #RXX45           Month
     C                     Z-ADD*ZERO     #RDNBU           Day NBR USR
     C                     Z-ADD*ZERO     #RIJNX           Hour 1 USR
     C                     Z-ADD*ZERO     #RIKNX           Hour 2 usr
     C                     Z-ADD*ZERO     #RMCNB           Number of Order
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RMDDI           Month/Day Displ
     C                     Z-ADD*ZERO     #RT4TM           USR Time 4.0
     C                     Z-ADD*ZERO     #RG1NX           Total Miles 4,0
     C                     Z-ADD*ZERO     #RG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #RLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #RV9CD           USR State Code
     C                     MOVEL*BLANK    #RS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #RR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #RXIST           Credit Hold
     C                     MOVEL*BLANK    #RZUCD           Warehouse 1 USR
     C                     MOVEL*BLANK    #RD4ST           USR Flag 1
     C                     Z-ADD*ZERO     #RYANB           Deadline Depart
     C                     Z-ADD*ZERO     #RYBNB           Deadline Depart
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP8RVNB    #PRVNB           Stop_Drop
     C                     Z-ADD*ZERO     #2P1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     #CG0NX           Numeric 4,0
     C                     MOVEL*BLANK    #C               Ship Method Typ
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     Z-ADD*ZERO     #2TLMI           Total Load Mile
     C                     Z-ADD*ZERO     #2RPNB           Total Load Orde
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     MOVEL*BLANK    #2DXTX           Trailer Id
     C                     MOVEL*BLANK    #CB8ST           Status - Y or N
     C                     Z-ADD*ZERO     #2AXTM           Deadline Depart
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     MOVEL*BLANK    #CVQCD           Include/Exclude
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #CMDDI           Month/Day Displ
     C                     Z-ADD*ZERO     #CT4TM           USR Time 4.0
     C                     MOVEL*BLANK    #2PKST           Load Status
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     Z-ADD*ZERO     #CG1NX           Total Miles 4,0
     C                     Z-ADD*ZERO     #CG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #CLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     MOVEL*BLANK    #CS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #CR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #CXIST           Credit Hold
     C                     MOVEL*BLANK    #CZUCD           Warehouse 1 USR
     C                     MOVEL*BLANK    #2RMST           Load Acceptance
     C                     MOVEL*BLANK    #CD4ST           USR Flag 1
     C                     Z-ADD*ZERO     #2KZDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V2KZDT
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  #2KZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2KZDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOC4NB    WQNA01           Order Number
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA01           Order Number
      * Setup key
     C                     Z-ADD#RC4NB    WQNA01           Order Number
      * Establish starting position
     C           KRSNA     SETLL@BFCPY2                    *
     C           KRSNA     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOBKC7    #RBKC7           Ship To Custome
     C           KRSNA     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * DLT Load Detail       RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQNB01           Load ID
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNB01           Load ID
      * Establish starting position
     C           KRSNB     SETLL@FLCPBW                    *
     C           KRSNB     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Load Detail        DL - Load Detail  * 
     C                     EXSR NCDLRC
     C           KRSNB     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCDLRC    BEGSR
      *================================================================
      * DLT Load Detail        DL - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADD#1RMNB    WRRMNB           Load ID
     C                     Z-ADDWARUNB    WRRUNB           Stop_Drop Seque
      *
     C           KLDLNC    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop_Drop Seque
     C           KLDLNC    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDDLRC    BEGSR
      *================================================================
      * DLT Load Header        DL - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      *
     C           KLDLND    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLDLND    CHAIN@FJCPBO              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FJCPBO                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NECHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0546  30       Company Number
     C                     Z-ADD*ZERO     WN0547  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0548  1        LTL Flag
     C                     Z-ADD*ZERO     WN0549  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0550 15        Seal 1
     C                     MOVEL*BLANK    WN0551 15        Seal 2
     C                     MOVEL*BLANK    WN0552 15        Seal 3
     C                     MOVEL*BLANK    WN0553 15        Seal 4
     C                     MOVEL*BLANK    WN0554 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0555  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0556 112       Flat Amount
     C                     MOVEL*BLANK    WN0557  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0558  50       Total Stops
     C                     MOVEL*BLANK    WN0559 20        Trailer Id
     C                     MOVEL*BLANK    WN0560  3        Transloader Car
     C                     Z-ADD*ZERO     WN0561  40       BOL Time
     C                     MOVEL*BLANK    WN0562  3        Carrier Code
     C                     MOVEL*BLANK    WN0563  7        Truck Size
     C                     Z-ADD*ZERO     WN0564  70       Ld Hdr_Ld Dtl U
     C                     MOVEL*BLANK    WN0565  1        Ship Status
     C                     MOVEL*BLANK    WN0566  1        Load Type
     C                     Z-ADD*ZERO     WN0567  50       Number Pallets
     C                     Z-ADD*ZERO     WN0568  50       Number Pallets
     C                     Z-ADD*ZERO     WN0569 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0570  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0571  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0572  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0573 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0574 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0575  70       Actual Departur
     C                     Z-ADD*ZERO     WN0576  40       Departure Time
     C                     Z-ADD*ZERO     WN0577  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0578  52       Product Tempera
     C                     Z-ADD*ZERO     WN0579  50       Number Spacers
     C                     MOVEL*BLANK    WN0580 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0581  70       Total Load Mile
     C                     MOVEL*BLANK    WN0582 12        Recorder ID
     C                     MOVEL*BLANK    WN0583  2        Shipping Method
     C                     MOVEL*BLANK    WN0584  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0585  2        Ship To State C
     C                     Z-ADD*ZERO     WN0586  70       Gross Weight
     C                     MOVEL*BLANK    WN0587  3        Carrier Broker
     C                     MOVEL*BLANK    WN0588  1        Export Status
     C                     Z-ADD*ZERO     WN0589  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0590  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0591  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0592  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0593  70       Spotted Date
     C                     Z-ADD*ZERO     WN0594  60       Spotted Time
     C                     Z-ADD*ZERO     WN0595  70       Load Finished D
     C                     Z-ADD*ZERO     WN0596  60       Load Finished T
     C                     Z-ADD*ZERO     WN0597  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0598  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0599  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0600  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0601  70       Truck Departure
     C                     Z-ADD*ZERO     WN0602  60       Truck Departure
     C                     Z-ADD*ZERO     WN0603  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0604  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0605  3        Shipping Line
     C                     MOVEL*BLANK    WN0606 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0607 30        Vessel Name
     C                     Z-ADD*ZERO     WN0608  50       Voyage
     C                     Z-ADD*ZERO     WN0609  70       Sail Date
     C                     MOVEL*BLANK    WN0610 12        Booking Number
     C                     MOVEL*BLANK    WN0611 20        Discharge Port
     C                     Z-ADD*ZERO     WN0612  70       Arrival Date
     C                     MOVEL*BLANK    WN0613 12        Container Numbe
     C                     Z-ADD*ZERO     WN0614  70       Date In
     C                     Z-ADD*ZERO     WN0615  60       Time In
     C                     Z-ADD*ZERO     WN0616  70       Date Out
     C                     Z-ADD*ZERO     WN0617  60       Time Out
     C                     Z-ADD*ZERO     WN0618 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0619  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0620  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0621  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0622  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0623  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0624  70       Requested Deliv
     C                     MOVEL*BLANK    WN0625  1        Load Acceptance
     C                     MOVEL*BLANK    WN0626  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0627  70       On Yard Date
     C                     Z-ADD*ZERO     WN0628  60       On Yard Time
     C                     Z-ADD*ZERO     WN0629  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0630  60       Deadline Depart
     C                     MOVEL*BLANK    WN0631  1        Load Held Over
     C                     MOVEL*BLANK    WN0632  1        Load Held Over
     C                     MOVEL*BLANK    WN0633 15        Load Held Over
     C                     MOVEL*BLANK    WN0634 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0635 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0636  70       Express Mail Da
     C                     MOVEL*BLANK    WN0637  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0638  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0639  70       Product Complet
     C                     Z-ADD*ZERO     WN0640  60       Product Complet
     C                     Z-ADD*ZERO     WN0641  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0642  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0643  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0644  1        Load Confirmed
     C                     MOVEL*BLANK    WN0645 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0646  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0647  60       Load Door 1
     C                     Z-ADD*ZERO     WN0648  70       Override Total
     C                     Z-ADD*ZERO     WN0649  60       Load Door 2
     C                     MOVEL*BLANK    WN0650  1        Partial Load
     C                     MOVEL*BLANK    WN0651  1        Load Confirmati
     C                     MOVEL*BLANK    WN0652  1        Export Load USD
     C                     MOVEL*BLANK    WN0653  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0654 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0655 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0656 15        Late Billing Em
     C                     MOVEL*BLANK    WN0657 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0658 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0659  1        Multi Company L
     C                     MOVEL*BLANK    WN0660  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0661  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0662  1        LH Power Only L
     C                     MOVEL*BLANK    WN0663  1        MG Created Load
     C                     MOVEL*BLANK    WN0664  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0665  2        Load U_M
     C                     MOVEL*BLANK    WN0666  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0667  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0668  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0669  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0670  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0671  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0672  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0673  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0674  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0675  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0676  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0677  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0678  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0679  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0680  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0681  60       LH Unused Time
     C                     MOVEL*BLANK    WN0682  1        EDI Status 1
     C                     MOVEL*BLANK    WN0683  1        EDI Status 2
     C                     MOVEL*BLANK    WN0684  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0685  60       Job Time
     C                     MOVEL*BLANK    WN0686 10        User Id
     C                     MOVEL*BLANK    WN0687 10        Job Name
     C                     Z-ADD*ZERO     WN0688  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      *
     C           KLCHNE    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHNE    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YERDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WHPKST    P      Load Status
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQNF01           Load ID
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           Load ID
      * Setup key
     C                     Z-ADDWL0090    WQNF01           Load ID
      * Establish starting position
     C           KRSNF     SETLL@FLCPBW                    *
     C           KRSNF     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR NGRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WL0091           Trans Contol AS
     C                     GOTO NFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNF     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    BEAIC3           Company Number
     C                     Z-ADDWAC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSNG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR NHRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO NGEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQNH01           Company Number
     C           *LIKE     DEFN WMC4NB    WQNH02           Order Number
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQNH01           Company Number
     C                     Z-ADDBEC4NB    WQNH02           Order Number
      * Establish starting position
     C           KRSNH     SETLL@BGWKL1                    *
     C           KRSNH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WMGMST    IFEQ 'L'                        *IF
     C           WMGMST    OREQ 'A'
     C           WMGMST    OREQ 'C'
     C           WMGMST    OREQ 'R'
     C           WMGMST    OREQ 'E'
     C           WMGMST    OREQ 'H'
     C           WMGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR NIRVGN
     C                     GOTO NHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSNI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WUF8NA           Warehouse Descr
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,015   DPDOCD           System Value Co
      * Establish starting position
     C           KRSNJ     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0038           System Value Al
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    YL0038           System Value Al
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQNK02           Load ID
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WQNK02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNK02           Load ID
      * Establish starting position
     C           KRSNK     SETLL@FLCPEB                    *
     C           KRSNK     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR NLCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR NMRVGN
     C           KRSNK     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0693  50       Stop_Drop
     C                     MOVEL*BLANK    WN0694 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0695  72       Freight Charge
     C                     Z-ADD*ZERO     WN0696  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0697  30       Company Number
     C                     Z-ADD*ZERO     WN0698  70       Order Number
     C                     MOVEL*BLANK    WN0699  1        Ship Status
     C                     Z-ADD*ZERO     WN0700  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0701  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0702  70       Appointment Con
     C                     Z-ADD*ZERO     WN0703  60       Appointment Con
     C                     MOVEL*BLANK    WN0704 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0705 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0706  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0707  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0708  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0709  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0710  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0711  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0712  70       On Yard Date
     C                     Z-ADD*ZERO     WN0713  60       On Yard Time
     C                     Z-ADD*ZERO     WN0714  70       MPC Number
     C                     MOVEL*BLANK    WN0715  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0716  1        On Time Addl Rs
     C                     MOVEL*BLANK    WN0717 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0718 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0719 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0720 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0721 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0722  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0723  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0724  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0725  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0726  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0727  60       LD Unused Time
     C                     MOVEL*BLANK    WN0728  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0729  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0730  2        HPB Transload S
     C                     MOVEL*BLANK    WN0731 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0732 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0733 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0734  1        EDI Status 1
     C                     MOVEL*BLANK    WN0735  1        EDI Status 2
     C                     MOVEL*BLANK    WN0736  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0737  60       Job Time
     C                     MOVEL*BLANK    WN0738 10        User Id
     C                     MOVEL*BLANK    WN0739 10        Job Name
     C                     Z-ADD*ZERO     WN0740  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWDRMNB    WRRMNB           Load ID
     C                     Z-ADDWDRUNB    WRRUNB           Stop_Drop Seque
      *
     C           KLCHNL    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop_Drop Seque
     C           KLCHNL    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YFRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWDRWNB    WRRWNB           Miles to next s
     C                     Z-ADD*ZERO     WRT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WRT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WRR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WRAATM' defaulted for 'Job Time'.
      * Field '(DB1) WRAYNA' defaulted for 'User Id'.
      * Field '(DB1) WRA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WRAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQNM02           Load ID
     C           *LIKE     DEFN WSC4NB    WQNM03           Order Number
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WQNM02           Load ID
     C                     KFLD           WQNM03           Order Number
      * Setup key
     C                     Z-ADDWDRMNB    WQNM02           Load ID
     C                     Z-ADDWDC4NB    WQNM03           Order Number
      * Establish starting position
     C           KRSNM     SETLL@BFCPNQ                    *
     C           KRSNM     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR NNCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR NORVGN
     C           KRSNM     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0741  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0742  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0743  70       Ship To Custome
     C                     MOVEL*BLANK    WN0744 30        Ship To Name
     C                     MOVEL*BLANK    WN0745 30        Ship To Address
     C                     MOVEL*BLANK    WN0746 30        Ship To Address
     C                     MOVEL*BLANK    WN0747 30        Ship To Address
     C                     MOVEL*BLANK    WN0748 20        Ship To City
     C                     MOVEL*BLANK    WN0749  2        Ship To State C
     C                     MOVEL*BLANK    WN0750 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0751  70       Bill to Custome
     C                     MOVEL*BLANK    WN0752 30        Bill to Name
     C                     MOVEL*BLANK    WN0753 30        Bill to Address
     C                     MOVEL*BLANK    WN0754 30        Bill to Address
     C                     MOVEL*BLANK    WN0755 30        Bill to Address
     C                     MOVEL*BLANK    WN0756 20        Bill to City
     C                     MOVEL*BLANK    WN0757  2        Bill to State C
     C                     MOVEL*BLANK    WN0758 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0759 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0760  70       Order Date
     C                     Z-ADD*ZERO     WN0761  70       Requested Ship
     C                     Z-ADD*ZERO     WN0762  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0763  70       Cancel Date
     C                     MOVEL*BLANK    WN0764  2        Terms Code
     C                     MOVEL*BLANK    WN0765 40        Special Instruc
     C                     MOVEL*BLANK    WN0766 40        Special Instruc
     C                     MOVEL*BLANK    WN0767  3        Carrier Code
     C                     MOVEL*BLANK    WN0768  1        Comment Print A
     C                     MOVEL*BLANK    WN0769  1        Comment Print I
     C                     MOVEL*BLANK    WN0770  1        Comment Print P
     C                     MOVEL*BLANK    WN0771  1        Comment Print S
     C                     MOVEL*BLANK    WN0772  3        Reason Code
     C                     MOVEL*BLANK    WN0773  1        Order in Use
     C                     MOVEL*BLANK    WN0774  1        Header Status
     C                     MOVEL*BLANK    WN0775  1        Header Status L
     C                     MOVEL*BLANK    WN0776  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0777  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0778 10        User Original E
     C                     Z-ADD*ZERO     WN0779  70       Date of Origina
     C                     Z-ADD*ZERO     WN0780 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0781 112       Order Weight To
     C                     MOVEL*BLANK    WN0782  1        Credit Hold
     C                     MOVEL*BLANK    WN0783  1        Production Hold
     C                     MOVEL*BLANK    WN0784  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0785  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0786  40       Requested Deliv
     C                     MOVEL*BLANK    WN0787  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0788 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0789  70       Load ID
     C                     Z-ADD*ZERO     WN0790  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0791  1        LTL Flag
     C                     MOVEL*BLANK    WN0792  1        Price Audit
     C                     MOVEL*BLANK    WN0793  1        Price Status
     C                     MOVEL*BLANK    WN0794  2        Shipping Method
     C                     MOVEL*BLANK    WN0795  1        Export Status
     C                     MOVEL*BLANK    WN0796  1        Palletize
     C                     MOVEL*BLANK    WN0797  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0798  1        Slip Sheet
     C                     MOVEL*BLANK    WN0799  1        Age Code
     C                     Z-ADD*ZERO     WN0800  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0801  1        Load Type
     C                     Z-ADD*ZERO     WN0802  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0803  1        Load Plan Order
     C                     MOVEL*BLANK    WN0804  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0805  70       Resell Referenc
     C                     MOVEL*BLANK    WN0806 30        Special Comment
     C                     MOVEL*BLANK    WN0807 30        Special Comment
     C                     MOVEL*BLANK    WN0808  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0809  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0810  2        Manager Level C
     C                     MOVEL*BLANK    WN0811  3        VP Level Code
     C                     Z-ADD*ZERO     WN0812  70       Attach to Order
     C                     MOVEL*BLANK    WN0813  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0814  70       Invoice Number
     C                     MOVEL*BLANK    WN0815  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0816  70       Invoice Date
     C                     MOVEL*BLANK    WN0817  2        Event Code
     C                     MOVEL*BLANK    WN0818  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0819  1        Modified Flag
     C                     Z-ADD*ZERO     WN0820 112       A/R order Value
     C                     MOVEL*BLANK    WN0821  1        Billing Activit
     C                     MOVEL*BLANK    WN0822  1        Block Order Fla
     C                     MOVEL*BLANK    WN0823  1        Order Certifica
     C                     Z-ADD*ZERO     WN0824 112       Invoice Order V
     C                     MOVEL*BLANK    WN0825  1        Process Sts for
     C                     MOVEL*BLANK    WN0826  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0827  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0828  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0829  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0830  1        Email Cust On O
     C                     MOVEL*BLANK    WN0831  1        Order Emailed
     C                     MOVEL*BLANK    WN0832  1        Export Docs Go
     C                     MOVEL*BLANK    WN0833  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0834  1        Broker Order St
     C                     MOVEL*BLANK    WN0835  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0836  2        Order Requires
     C                     MOVEL*BLANK    WN0837  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0838  2        Export USDA App
     C                     MOVEL*BLANK    WN0839  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0840  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0841  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0842  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0843  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0844  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0845  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0846  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0847  60       Time of Origina
     C                     Z-ADD*ZERO     WN0848  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0849  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0850  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0851 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0852 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0853 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0854 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0855 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0856  70       Claim Number
     C                     MOVEL*BLANK    WN0857  1        EDI Status 1
     C                     MOVEL*BLANK    WN0858  1        EDI Status 2
     C                     MOVEL*BLANK    WN0859  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0860  60       Job Time
     C                     MOVEL*BLANK    WN0861 10        User Id
     C                     MOVEL*BLANK    WN0862 10        Job Name
     C                     Z-ADD*ZERO     WN0863  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWSAIC3    WLAIC3           Company Number
     C                     Z-ADDWSC4NB    WLC4NB           Order Number
      *
     C           KLCHNN    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHNN    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YGRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWLAIC3    PCAIC3           Company Number
     C                     Z-ADDWLC4NB    PCC4NB           Order Number
     C                     MOVELWLJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWLANC7    PCANC7           AR Customer Num
     C                     Z-ADDWLBKC7    PCBKC7           Ship To Custome
     C                     MOVELWLBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWLHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWLHONA    PCHONA    P      Ship To Address
     C                     MOVELWLHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PCHNNA    P      Ship To City
     C                     MOVELWLDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWLCKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWLB0C7    PCB0C7           Bill to Custome
     C                     MOVELWLAETX    PCAETX    P      Bill to Name
     C                     MOVELWLB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PCB2NA    P      Bill to City
     C                     MOVELWLBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWLC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWLBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PCA0DT           Order Date
     C                     Z-ADDWLA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PCACDT           Cancel Date
     C                     MOVELWLAQCD    PCAQCD    P      Terms Code
     C                     MOVELWLB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWLBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWLGTST    PCGTST    P      Comment Print A
     C                     MOVELWLGVST    PCGVST    P      Comment Print I
     C                     MOVELWLGUST    PCGUST    P      Comment Print P
     C                     MOVELWLQFST    PCQFST    P      Comment Print S
     C                     MOVELWLCQCD    PCCQCD    P      Reason Code
     C                     MOVELWLGJST    PCGJST    P      Order in Use
     C                     MOVELWLGWST    PCGWST    P      Header Status
     C                     MOVELWLGXST    PCGXST    P      Header Status L
     C                     MOVELWLGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PCAODT           Scheduled Ship
     C                     MOVELWLAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWLJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PCA1WG           Order Weight To
     C                     MOVELWLXIST    PCXIST    P      Credit Hold
     C                     MOVELWLXJST    PCXJST    P      Production Hold
     C                     MOVELWLXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PCAFTM           Requested Deliv
     C                     MOVELWLE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PCRMNB           Load ID
     C                     Z-ADDWLTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PCR1NB           Rated Freight
     C                     MOVELWLPJST    PCPJST    P      LTL Flag
     C                     MOVELWLU0ST    PCU0ST    P      Price Audit
     C                     MOVELWLU1ST    PCU1ST    P      Price Status
     C                     MOVELWLQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PCU2ST    P      Export Status
     C                     MOVELWLVEST    PCVEST    P      Palletize
     C                     MOVELWLVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PCVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWLRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWLVDST    PCVDST    P      Load Type
     C                     Z-ADDWLATIN    PCATIN           Attach to Invoi
     C                     MOVELWLU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PCRSRN           Resell Referenc
     C                     MOVELWLMHNA    PCMHNA    P      Special Comment
     C                     MOVELWLMINA    PCMINA    P      Special Comment
     C                     MOVELWLWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PCT3NB           Attach to Order
     C                     MOVELWLSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PCCONB           Invoice Number
     C                     MOVELWLCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PCAWDT           Invoice Date
     C                     MOVELWLJPCD    PCJPCD    P      Event Code
     C                     MOVELWLXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PCVRVA           A/R order Value
     C                     MOVELWLOBST    PCOBST    P      Billing Activit
     C                     MOVELWLBCST    PCBCST    P      Block Order Fla
     C                     MOVELWLBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PCB7VL           Invoice Order V
     C                     MOVELWLGASX    PCGASX    P      Process Sts for
     C                     MOVELWLGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PCFUSX    P      Order Requires
     C                     MOVELWLFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWLBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWLH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWLH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PCC0C7           Claim Number
     C                     MOVELWLUVST    PCUVST    P      EDI Status 1
     C                     MOVELWLUWST    PCUWST    P      EDI Status 2
     C                     MOVELWLUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PCAATM           Job Time
     C                     MOVELWLAYNA    PCAYNA    P      User Id
     C                     MOVELWLA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0864  30       Order Sequence
     C                     Z-ADD*ZERO     WN0865  30       Order Secondary
     C                     Z-ADD*ZERO     WN0866 112       Rated Freight
     C                     Z-ADD*ZERO     WN0867 112       @Rated Freight
     C                     MOVEL*BLANK    WN0868  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN0867           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN0868           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQNO01           Company Number
     C           *LIKE     DEFN WMC4NB    WQNO02           Order Number
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WQNO01           Company Number
     C                     KFLD           WQNO02           Order Number
      * Setup key
     C                     Z-ADDWSAIC3    WQNO01           Company Number
     C                     Z-ADDWSC4NB    WQNO02           Order Number
      * Establish starting position
     C           KRSNO     SETLL@BGWKL1                    *
     C           KRSNO     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WMGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0092           Company Number
     C                     Z-ADDWMC4NB    WL0093           Order Number
     C                     Z-ADDWMDPNB    WL0094           Order Sequence
     C                     Z-ADDWMUENB    WL0095           Order Secondary
     C                     Z-ADD*ZERO     WL0096           Rated Freight
     C                     EXSR NPCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0868           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WSA1WG    IFEQ 0                          *IF
     C           *ZERO     OREQ 0                          *OR
     C                     Z-ADD*ZERO     WN0866           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           WMGMST    IFEQ 'C'                        *IF
     C           WMGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WMATWG    DIV  WSA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WMAVQT    MULT WMAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WSA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN0866    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0092           Company Number
     C                     Z-ADDWMC4NB    WL0093           Order Number
     C                     Z-ADDWMDPNB    WL0094           Order Sequence
     C                     Z-ADDWMUENB    WL0095           Order Secondary
     C                     Z-ADDWN0866    WL0096           Rated Freight
     C                     EXSR NPCHRC
     C                     ADD  WN0866    WN0867           @Rated Freight
     C                     Z-ADDWMDPNB    WN0864           Order Sequence
     C                     Z-ADDWMUENB    WN0865           Order Secondary
     C                     END                             *FI
     C           KRSNO     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0867    IFNE *ZERO                      *IF
     C           WN0868    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN0867    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN0866           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0092           Company Number
     C                     Z-ADDWSC4NB    WL0093           Order Number
     C                     Z-ADDWN0864    WL0094           Order Sequence
     C                     Z-ADDWN0865    WL0095           Order Secondary
     C                     Z-ADDWN0866    WL0096           Rated Freight
     C                     EXSR NPCHRC
     C                     END                             *FI
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0869  70       Item Code
     C                     MOVEL*BLANK    WN0870  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0871  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0872  70       Order Group Cod
     C                     MOVEL*BLANK    WN0873  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0874  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0875 112       Billing Detail
     C                     Z-ADD*ZERO     WN0876 112       Billing Detail
     C                     Z-ADD*ZERO     WN0877 112       Billing Detail
     C                     Z-ADD*ZERO     WN0878 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0879  1        Comment Print A
     C                     MOVEL*BLANK    WN0880  1        Comment Print I
     C                     MOVEL*BLANK    WN0881  1        Comment Print P
     C                     MOVEL*BLANK    WN0882  1        Comment Print S
     C                     Z-ADD*ZERO     WN0883 112       Extended Amount
     C                     Z-ADD*ZERO     WN0884  70       Market Pricing
     C                     MOVEL*BLANK    WN0885  3        Commodity Marke
     C                     MOVEL*BLANK    WN0886  3        Date Method Cod
     C                     MOVEL*BLANK    WN0887  3        Price Method Co
     C                     Z-ADD*ZERO     WN0888 114       Price Overage O
     C                     Z-ADD*ZERO     WN0889  70       Contract Number
     C                     MOVEL*BLANK    WN0890  1        Price Status
     C                     Z-ADD*ZERO     WN0891  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0892  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0893  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0894  1        Work Confirm St
     C                     MOVEL*BLANK    WN0895  1        Work Over/Short
     C                     MOVEL*BLANK    WN0896  1        OD Production P
     C                     MOVEL*BLANK    WN0897 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0898 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0899  1        Age Code
     C                     MOVEL*BLANK    WN0900  1        Palletize
     C                     MOVEL*BLANK    WN0901  1        Slip Sheet
     C                     MOVEL*BLANK    WN0902  1        Catch Weight St
     C                     MOVEL*BLANK    WN0903  1        Price Audit
     C                     MOVEL*BLANK    WN0904  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0905  1        Production Date
     C                     Z-ADD*ZERO     WN0906 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0907 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0908 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0909 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0910 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0911 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0912 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0913 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0914 114       Unit Price
     C                     Z-ADD*ZERO     WN0915 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0916 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0917 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0918 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0919  70       Requested Ship
     C                     Z-ADD*ZERO     WN0920  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0921  70       Actual Shipped
     C                     MOVEL*BLANK    WN0922  1        Affect Inventor
     C                     MOVEL*BLANK    WN0923  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0924  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0925  30       Item Structure
     C                     Z-ADD*ZERO     WN0926  30       Item Structure
     C                     Z-ADD*ZERO     WN0927  30       Item Structure
     C                     MOVEL*BLANK    WN0928  2        Item Level
     C                     MOVEL*BLANK    WN0929  2        Quality Level
     C                     MOVEL*BLANK    WN0930  2        Pricing Product
     C                     MOVEL*BLANK    WN0931  2        Season Product
     C                     Z-ADD*ZERO     WN0932  70       Date of Origina
     C                     MOVEL*BLANK    WN0933 10        User Profile Na
     C                     MOVEL*BLANK    WN0934  6        Country Code
     C                     MOVEL*BLANK    WN0935  2        Event Code
     C                     MOVEL*BLANK    WN0936  3        Reason Code
     C                     MOVEL*BLANK    WN0937  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0938  1        Modified Flag
     C                     MOVEL*BLANK    WN0939  1        Substituted Fla
     C                     MOVEL*BLANK    WN0940  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0941 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0942 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0943  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0944  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0945  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0946  1        Affect Commissi
     C                     MOVEL*BLANK    WN0947  1        Affect Pricing
     C                     MOVEL*BLANK    WN0948  1        Released by Use
     C                     MOVEL*BLANK    WN0949  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0950  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0951  3        Production Ware
     C                     MOVEL*BLANK    WN0952  3        OD Price Type
     C                     Z-ADD*ZERO     WN0953  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0954  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0955  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0956  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0957  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0958  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0959  60       Price Code
     C                     Z-ADD*ZERO     WN0960  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0961  60       Substitution Li
     C                     Z-ADD*ZERO     WN0962  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0963 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0964 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0965 112       OD Item Target
     C                     Z-ADD*ZERO     WN0966 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0967 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0968 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0969 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0970 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0971 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0972 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0973 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0974 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0975 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0976  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0977  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0978  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0979 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0980  40       Item Age Days
     C                     Z-ADD*ZERO     WN0981  70       Production Ovr
     C                     Z-ADD*ZERO     WN0982  70       Production Ovr
     C                     MOVEL*BLANK    WN0983  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0984  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0985  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0986  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0987  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0988  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0989  1        EDI Status 1
     C                     MOVEL*BLANK    WN0990  1        EDI Status 2
     C                     MOVEL*BLANK    WN0991  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0992  60       Job Time
     C                     MOVEL*BLANK    WN0993 10        User Id
     C                     MOVEL*BLANK    WN0994 10        Job Name
     C                     Z-ADD*ZERO     WN0995  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0092    WKAIC3           Company Number
     C                     Z-ADDWL0093    WKC4NB           Order Number
     C                     Z-ADDWL0094    WKDPNB           Order Sequence
     C                     Z-ADDWL0095    WKUENB           Order Secondary
      *
     C           KLCHNP    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHNP    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YHRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0096    WKR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSNQ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAODT    WN0996           Scheduled Ship
     C                     MOVELWBPJST    WUG0TX           LTL Flag
     C                     MOVELWBPKST    WUG0TX           Load Status
     C                     Z-ADDWBRNNB    WUNFNN           Reefer Temperat
     C                     MOVELWBDMTX    WUG0TX           Seal 1
     C                     MOVELWBDNTX    WUG0TX           Seal 2
     C                     MOVELWBDOTX    WUG0TX           Seal 3
     C                     Z-ADDWBRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDWBFLAM    WN0997           Flat Amount
     C                     MOVELWBXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDWBRRNB    WN0998           Total Stops
     C                     MOVELWBDXTX    WUG0TX           Trailer Id
     C                     MOVELWBDYTX    WUG0TX           Transloader Car
     C                     Z-ADDWBSBNB    WUNFNN           BOL Time
     C                     MOVELWBBZNA    WUG0TX           Carrier Code
     C                     MOVELWBRONB    WUG0TX           Truck Size
     C                     Z-ADDWBSQNB    WUNFNN           Ld Hdr_Ld Dtl U
     C                     Z-ADDWBR1NB    WUNFNN           Rated Freight
     C                     MOVELWBVCST    WUG0TX           Ship Status
     C                     MOVELWBVDST    WUG0TX           Load Type
     C                     Z-ADDWBSDNB    WUNFNN           Number Pallets
     C                     Z-ADDWBPAOU    WUNFNN           Number Pallets
     C                     Z-ADDWBDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDWBSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDWBHADT    WUNFNN           Actual Arrival
     C                     Z-ADDWBAART    WUNFNN           Actual Arrival
     C                     Z-ADDWBDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDWBDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWBAQDT    WUNFNN           Actual Departur
     C                     Z-ADDWBS6NB    WUNFNN           Departure Time
     C                     Z-ADDWBT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDWBPRTM    WUNFNN           Product Tempera
     C                     Z-ADDWBNPSV    WUNFNN           Number Spacers
     C                     MOVELWBJ8TX    WUG0TX           Car_Veh. Initia
     C                     Z-ADDWBTLMI    WN0999           Total Load Mile
     C                     MOVELWBJ9TX    WUG0TX           Recorder ID
     C                     MOVELWBQ2CD    WUG0TX           Shipping Method
     C                     MOVELWBVPCD    WN1000           Ship From Wareh
     C                     MOVELWBDBCD    WN1001           Ship To State C
     C                     Z-ADDWBGRWE    WUNFNN           Gross Weight
     C                     MOVELWBXCCD    WN1002           Carrier Broker
     C                     MOVELWBU2ST    WN1003           Export Status
     C                     Z-ADDWBF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELWBONTM    WUG0TX           On Time (Y_N)
     C                     Z-ADDWBJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDWBTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDWBJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDWBSPTM    WUNFNN           Spotted Time
     C                     Z-ADDWBJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDWBLFTM    WUNFNN           Load Finished T
     C                     Z-ADDWBJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDWBBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDWBJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDWBBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDWBKIDT    WUNFNN           Truck Departure
     C                     Z-ADDWBASTM    WUNFNN           Truck Departure
     C                     Z-ADDWBKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDWBAJCM    WUNFNN           Adjusted Depart
     C                     MOVELWBXACD    WUG0TX           Shipping Line
     C                     MOVELWBOANA    WUG0TX           Port Delv Termi
     C                     MOVELWBK4TX    WUG0TX           Vessel Name
     C                     Z-ADDWBVOAG    WUNFNN           Voyage
     C                     Z-ADDWBKBDT    WUNFNN           Sail Date
     C                     MOVELWBNBBO    WUG0TX           Booking Number
     C                     MOVELWBW4CD    WUG0TX           Discharge Port
     C                     Z-ADDWBEFDT    WUNFNN           Arrival Date
     C                     MOVELWBCNTN    WUG0TX           Container Numbe
     C                     Z-ADDWBKCDT    WUNFNN           Date In
     C                     Z-ADDWBTMIN    WUNFNN           Time In
     C                     Z-ADDWBKDDT    WUNFNN           Date Out
     C                     Z-ADDWBVMNB    WUNFNN           Time Out
     C                     Z-ADDWBOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDWBKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDWBATTM    WUNFNN           Scheduled Deliv
     C                     MOVELWBOTRS    WUG0TX           LH Unused Sts
     C                     Z-ADDWBKKDT    WUNFNN           On Yard Date
     C                     Z-ADDWBAVTM    WUNFNN           On Yard Time
     C                     Z-ADDWBKZDT    WN1006           Deadline Depart
     C                     Z-ADDWBAXTM    WN1007           Deadline Depart
     C                     MOVELWBRYSX    WN1008           MG Created Load
     C                     GOTO NQEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1028  70       Total Load Mile
     C                     MOVEL*BLANK    WN1029  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1030  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1031  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSNR     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBRMNB    WL0021           Load ID
     C                     Z-ADD1         WL0022           Stop_Drop
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    WN1029    P      Warehouse Code
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           WBAJCD    IFEQ WN1029                     *IF
     C                     MOVEL*BLANK    WN1030           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBAJCD    WN1030           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           WBRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDWBTLMI    WN1028           Total Load Mile
     C                     Z-ADDWBK2DT    WN1031           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPERC
     C                     Z-ADDWBRMNB    PERMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Load Detai
     C           WN1028    PARM WN1028    WQ0143  70       Total Load Mile
     C           WN1031    PARM WN1031    WQ0144  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR NSCHRC
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1032  30       Company Number
     C                     Z-ADD*ZERO     WN1033  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1034  1        LTL Flag
     C                     MOVEL*BLANK    WN1035  1        Load Status
     C                     Z-ADD*ZERO     WN1036  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1037 15        Seal 1
     C                     MOVEL*BLANK    WN1038 15        Seal 2
     C                     MOVEL*BLANK    WN1039 15        Seal 3
     C                     MOVEL*BLANK    WN1040 15        Seal 4
     C                     MOVEL*BLANK    WN1041 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1042  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1043 112       Flat Amount
     C                     MOVEL*BLANK    WN1044  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1045  50       Total Stops
     C                     MOVEL*BLANK    WN1046 20        Trailer Id
     C                     MOVEL*BLANK    WN1047  3        Transloader Car
     C                     Z-ADD*ZERO     WN1048  40       BOL Time
     C                     MOVEL*BLANK    WN1049  3        Carrier Code
     C                     MOVEL*BLANK    WN1050  7        Truck Size
     C                     Z-ADD*ZERO     WN1051  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN1052 112       Rated Freight
     C                     MOVEL*BLANK    WN1053  1        Ship Status
     C                     MOVEL*BLANK    WN1054  1        Load Type
     C                     Z-ADD*ZERO     WN1055  50       Number Pallets
     C                     Z-ADD*ZERO     WN1056  50       Number Pallets
     C                     Z-ADD*ZERO     WN1057 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1058  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1059  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1060  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1061 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1062 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1063  70       Actual Departur
     C                     Z-ADD*ZERO     WN1064  40       Departure Time
     C                     Z-ADD*ZERO     WN1065  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1066  52       Product Tempera
     C                     Z-ADD*ZERO     WN1067  50       Number Spacers
     C                     MOVEL*BLANK    WN1068 12        Car_Veh. Initia
     C                     MOVEL*BLANK    WN1069 12        Recorder ID
     C                     MOVEL*BLANK    WN1070  2        Shipping Method
     C                     MOVEL*BLANK    WN1071  2        Ship To State C
     C                     Z-ADD*ZERO     WN1072  70       Gross Weight
     C                     MOVEL*BLANK    WN1073  3        Carrier Broker
     C                     MOVEL*BLANK    WN1074  1        Export Status
     C                     Z-ADD*ZERO     WN1075  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1076  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN1077  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1078  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1079  70       Spotted Date
     C                     Z-ADD*ZERO     WN1080  60       Spotted Time
     C                     Z-ADD*ZERO     WN1081  70       Load Finished D
     C                     Z-ADD*ZERO     WN1082  60       Load Finished T
     C                     Z-ADD*ZERO     WN1083  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1084  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1085  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1086  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1087  70       Truck Departure
     C                     Z-ADD*ZERO     WN1088  60       Truck Departure
     C                     Z-ADD*ZERO     WN1089  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1090  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1091  3        Shipping Line
     C                     MOVEL*BLANK    WN1092 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1093 30        Vessel Name
     C                     Z-ADD*ZERO     WN1094  50       Voyage
     C                     Z-ADD*ZERO     WN1095  70       Sail Date
     C                     MOVEL*BLANK    WN1096 12        Booking Number
     C                     MOVEL*BLANK    WN1097 20        Discharge Port
     C                     Z-ADD*ZERO     WN1098  70       Arrival Date
     C                     MOVEL*BLANK    WN1099 12        Container Numbe
     C                     Z-ADD*ZERO     WN1100  70       Date In
     C                     Z-ADD*ZERO     WN1101  60       Time In
     C                     Z-ADD*ZERO     WN1102  70       Date Out
     C                     Z-ADD*ZERO     WN1103  60       Time Out
     C                     Z-ADD*ZERO     WN1104 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1105  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1106  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1107  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1108  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1109  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1110  70       Requested Deliv
     C                     MOVEL*BLANK    WN1111  1        Load Acceptance
     C                     Z-ADD*ZERO     WN1112  70       On Yard Date
     C                     Z-ADD*ZERO     WN1113  60       On Yard Time
     C                     Z-ADD*ZERO     WN1114  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1115  60       Deadline Depart
     C                     MOVEL*BLANK    WN1116  1        Load Held Over
     C                     MOVEL*BLANK    WN1117  1        Load Held Over
     C                     MOVEL*BLANK    WN1118 15        Load Held Over
     C                     MOVEL*BLANK    WN1119 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1120 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1121  70       Express Mail Da
     C                     MOVEL*BLANK    WN1122  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1123  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1124  70       Product Complet
     C                     Z-ADD*ZERO     WN1125  60       Product Complet
     C                     Z-ADD*ZERO     WN1126  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1127  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1128  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1129  1        Load Confirmed
     C                     MOVEL*BLANK    WN1130 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1131  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1132  60       Load Door 1
     C                     Z-ADD*ZERO     WN1133  60       Load Door 2
     C                     MOVEL*BLANK    WN1134  1        Partial Load
     C                     MOVEL*BLANK    WN1135  1        Load Confirmati
     C                     MOVEL*BLANK    WN1136  1        Export Load USD
     C                     MOVEL*BLANK    WN1137  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1138 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1139 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1140 15        Late Billing Em
     C                     MOVEL*BLANK    WN1141 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1142 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1143  1        Multi Company L
     C                     MOVEL*BLANK    WN1144  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1145  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1146  1        LH Power Only L
     C                     MOVEL*BLANK    WN1147  1        MG Created Load
     C                     MOVEL*BLANK    WN1148  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1149  2        Load U_M
     C                     MOVEL*BLANK    WN1150  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1151  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1152  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1153  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1154  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1155  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1156  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1157  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1158  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1159  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1160  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1161  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1162  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1163  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1164  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1165  60       LH Unused Time
     C                     MOVEL*BLANK    WN1166  1        EDI Status 1
     C                     MOVEL*BLANK    WN1167  1        EDI Status 2
     C                     MOVEL*BLANK    WN1168  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1169  60       Job Time
     C                     MOVEL*BLANK    WN1170 10        User Id
     C                     MOVEL*BLANK    WN1171 10        Job Name
     C                     Z-ADD*ZERO     WN1172  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWBRMNB    WHRMNB           Load ID
      *
     C           KLCHNS    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHNS    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YIRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN1028    WHTLMI           Total Load Mile
     C                     MOVELWN1029    WHVPCD    P      Ship From Wareh
     C                     MOVELWN1030    WHAJCD    P      Warehouse Code
     C                     Z-ADDWN1031    WHK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQNT02           Load ID
      * Define keylist
     C           KPSNT     KLIST
     C                     KFLD           WQNT02           Load ID
     C                     KFLD           WDRVNB           Stop_Drop
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNT02           Load ID
     C                     Z-ADD*ZERO     WDRVNB           Stop_Drop
      * Establish starting position
     C           KPSNT     SETLL@FLCPEB                    *
     C           KRSNT     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWDN7DT    WUN7DT           LD Carrier Appt
     C                     Z-ADDWDB3TM    WN1007           LD Carrier Appt
     C                     GOTO NTEXIT                     *QUIT
     C           KRSNT     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQNU02           Load ID
      * Define keylist
     C           KPSNU     KLIST
     C                     KFLD           WQNU02           Load ID
     C                     KFLD           WDRVNB           Stop_Drop
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           WQNU02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNU02           Load ID
     C                     Z-ADD*ZERO     WDRVNB           Stop_Drop
      * Establish starting position
     C           KPSNU     SETLL@FLCPEB                    *
     C           KRSNU     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR NVRVGN
     C                     GOTO NUEXIT                     *QUIT
     C           KRSNU     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    BEAIC3           Company Number
     C                     Z-ADDWDC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSNV     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WN1006           Requested Deliv
     C                     Z-ADD*ZERO     WN1026           Requested Deliv
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBRTX    WUBRTX           Ship To Name
     C                     MOVELBEHNNA    WUHNNA           Ship To City
     C                     Z-ADDBEEIDT    WN1006           Requested Deliv
     C                     Z-ADDBEAFTM    WN1026           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSNW     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBQ2CD    YL0041           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQNX02           Load ID
      * Define keylist
     C           KPSNX     KLIST
     C                     KFLD           WQNX02           Load ID
     C                     KFLD           WDRVNB           Stop_Drop
     C                     KFLD           WDC4NB           Order Number
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           WQNX02           Load ID
      * Setup key
     C                     Z-ADDWL0097    WQNX02           Load ID
     C                     Z-ADDWL0098    WDRVNB           Stop_Drop
     C                     Z-ADDWL0099    WDC4NB           Order Number
      * Establish starting position
     C           KPSNX     SETLL@FLCPEB                    *
     C           KRSNX     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDRWNB    WL0100           Miles to next s
     C                     GOTO NXEXIT                     *QUIT
     C           KRSNX     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSNY     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWN1174    LGMILE           Miles to First
      * Establish starting position
     C           KPSNY     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    YL0042           Hours Required
     C                     GOTO NYEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQNZ02           Load ID
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WQNZ02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNZ02           Load ID
      * Establish starting position
     C           KRSNZ     SETLL@BFCPD9                    *
     C           KRSNZ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCHNNA    WN1011           Ship To City
     C                     MOVELWCDBCD    WN1012           Ship To State C
     C                     GOTO NZEXIT                     *QUIT
     C           KRSNZ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           LEBZNA           Carrier Code
     C                     KFLD           LEAJCD           Warehouse Code
     C                     KFLD           LEXECD           Destination Cit
     C                     KFLD           LEBGCD           State Code
      * Setup key
     C                     MOVELWN1002    LEBZNA           Carrier Code
     C                     MOVELWN1000    LEAJCD           Warehouse Code
     C                     MOVELWN1011    LEXECD           Destination Cit
     C                     MOVELWN1012    LEBGCD           State Code
      * Establish starting position
     C           KRSOA     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           LEAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDLENMVA    WN0997           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1182  30       Company Number
     C                     MOVEL*BLANK    WN1183  1        LTL Flag
     C                     Z-ADD*ZERO     WN1184  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1185 15        Seal 1
     C                     MOVEL*BLANK    WN1186 15        Seal 2
     C                     MOVEL*BLANK    WN1187 15        Seal 3
     C                     MOVEL*BLANK    WN1188 15        Seal 4
     C                     MOVEL*BLANK    WN1189 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1190  70       Total Load Orde
     C                     MOVEL*BLANK    WN1191  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1192  50       Total Stops
     C                     MOVEL*BLANK    WN1193 20        Trailer Id
     C                     MOVEL*BLANK    WN1194  3        Transloader Car
     C                     Z-ADD*ZERO     WN1195  40       BOL Time
     C                     MOVEL*BLANK    WN1196  3        Carrier Code
     C                     MOVEL*BLANK    WN1197  7        Truck Size
     C                     Z-ADD*ZERO     WN1198  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN1199 112       Rated Freight
     C                     MOVEL*BLANK    WN1200  1        Ship Status
     C                     MOVEL*BLANK    WN1201  1        Load Type
     C                     Z-ADD*ZERO     WN1202  50       Number Pallets
     C                     Z-ADD*ZERO     WN1203  50       Number Pallets
     C                     Z-ADD*ZERO     WN1204 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1205  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1206  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1207  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1208 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1209 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1210  70       Actual Departur
     C                     Z-ADD*ZERO     WN1211  40       Departure Time
     C                     Z-ADD*ZERO     WN1212  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1213  52       Product Tempera
     C                     Z-ADD*ZERO     WN1214  50       Number Spacers
     C                     MOVEL*BLANK    WN1215 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN1216  70       Total Load Mile
     C                     MOVEL*BLANK    WN1217 12        Recorder ID
     C                     MOVEL*BLANK    WN1218  2        Shipping Method
     C                     Z-ADD*ZERO     WN1219  70       Gross Weight
     C                     MOVEL*BLANK    WN1220  3        Carrier Broker
     C                     MOVEL*BLANK    WN1221  1        Export Status
     C                     Z-ADD*ZERO     WN1222  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1223  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN1224  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1225  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1226  70       Spotted Date
     C                     Z-ADD*ZERO     WN1227  60       Spotted Time
     C                     Z-ADD*ZERO     WN1228  70       Load Finished D
     C                     Z-ADD*ZERO     WN1229  60       Load Finished T
     C                     Z-ADD*ZERO     WN1230  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1231  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1232  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1233  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1234  70       Truck Departure
     C                     Z-ADD*ZERO     WN1235  60       Truck Departure
     C                     Z-ADD*ZERO     WN1236  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1237  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1238  3        Shipping Line
     C                     MOVEL*BLANK    WN1239 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1240 30        Vessel Name
     C                     Z-ADD*ZERO     WN1241  50       Voyage
     C                     Z-ADD*ZERO     WN1242  70       Sail Date
     C                     MOVEL*BLANK    WN1243 12        Booking Number
     C                     MOVEL*BLANK    WN1244 20        Discharge Port
     C                     Z-ADD*ZERO     WN1245  70       Arrival Date
     C                     MOVEL*BLANK    WN1246 12        Container Numbe
     C                     Z-ADD*ZERO     WN1247  70       Date In
     C                     Z-ADD*ZERO     WN1248  60       Time In
     C                     Z-ADD*ZERO     WN1249  70       Date Out
     C                     Z-ADD*ZERO     WN1250  60       Time Out
     C                     Z-ADD*ZERO     WN1251 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1252  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1253  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1254  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1255  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1256  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1257  70       Requested Deliv
     C                     MOVEL*BLANK    WN1258  1        Load Acceptance
     C                     MOVEL*BLANK    WN1259  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1260  70       On Yard Date
     C                     Z-ADD*ZERO     WN1261  60       On Yard Time
     C                     MOVEL*BLANK    WN1262  1        Load Held Over
     C                     MOVEL*BLANK    WN1263  1        Load Held Over
     C                     MOVEL*BLANK    WN1264 15        Load Held Over
     C                     MOVEL*BLANK    WN1265 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1266 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1267  70       Express Mail Da
     C                     MOVEL*BLANK    WN1268  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1269  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1270  70       Product Complet
     C                     Z-ADD*ZERO     WN1271  60       Product Complet
     C                     Z-ADD*ZERO     WN1272  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1273  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1274  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1275  1        Load Confirmed
     C                     MOVEL*BLANK    WN1276 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1277  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1278  60       Load Door 1
     C                     Z-ADD*ZERO     WN1279  70       Override Total
     C                     Z-ADD*ZERO     WN1280  60       Load Door 2
     C                     MOVEL*BLANK    WN1281  1        Partial Load
     C                     MOVEL*BLANK    WN1282  1        Load Confirmati
     C                     MOVEL*BLANK    WN1283  1        Export Load USD
     C                     MOVEL*BLANK    WN1284  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1285 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1286 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1287 15        Late Billing Em
     C                     MOVEL*BLANK    WN1288 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1289 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1290  1        Multi Company L
     C                     MOVEL*BLANK    WN1291  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1292  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1293  1        LH Power Only L
     C                     MOVEL*BLANK    WN1294  1        MG Created Load
     C                     MOVEL*BLANK    WN1295  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1296  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1297  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1298  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1299  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1300  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1301  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1302  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1303  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1304  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1305  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1306  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1307  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1308  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1309  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1310  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1311  60       LH Unused Time
     C                     MOVEL*BLANK    WN1312  1        EDI Status 1
     C                     MOVEL*BLANK    WN1313  1        EDI Status 2
     C                     MOVEL*BLANK    WN1314  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1315  60       Job Time
     C                     MOVEL*BLANK    WN1316 10        User Id
     C                     MOVEL*BLANK    WN1317 10        Job Name
     C                     Z-ADD*ZERO     WN1318  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      *
     C           KLCHOB    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHOB    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YJRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0996    WHAODT           Scheduled Ship
     C                     MOVEL'L'       WHPKST    P      Load Status
     C                     Z-ADDWN0997    WHFLAM           Flat Amount
     C                     MOVELWN1000    WHVPCD    P      Ship From Wareh
     C                     MOVELWN1001    WHDBCD    P      Ship To State C
     C                     Z-ADDWN1006    WHKZDT           Deadline Depart
     C                     Z-ADDWN1007    WHAXTM           Deadline Depart
     C                     MOVELWN1009    WHR0SX    P      Load U_M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN1013           USR Warehouse C
     C                     MOVEL*BLANK    WN1014           USR CDE Parm 1
     C                     MOVEL*BLANK    WN1015           USR CDE Parm 2
     C                     MOVEL*BLANK    WN1016           USR CDE Parm 3
     C                     MOVEL*BLANK    WN1017           USR CDE Parm 4
     C                     MOVEL*BLANK    WN1018           USR CDE Parm 5
     C                     MOVEL*BLANK    WN1019           USR CDE Parm 6
     C                     MOVEL*BLANK    WN1020           USR CDE Parm 7
     C                     MOVEL*BLANK    WN1021           USR CDE Parm 8
     C                     MOVEL*BLANK    WN1022           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQOC02           Load ID
      * Define keylist
     C           KRSOC     KLIST
     C                     KFLD           WQOC02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQOC02           Load ID
      * Establish starting position
     C           KRSOC     SETLL@FLCPKF                    *
     C           KRSOC     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR ODRVGN
     C           KRSOC     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODRVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQOD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQOD02           Order Number
      * Define keylist
     C           KPSOD     KLIST
     C                     KFLD           WQOD01           Company Number
     C                     KFLD           WQOD02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSOD     KLIST
     C                     KFLD           WQOD01           Company Number
     C                     KFLD           WQOD02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQOD01           Company Number
     C                     Z-ADDWEC4NB    WQOD02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSOD     SETLL@BGWKAE                    *
     C           KRSOD     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           OMAJCD    IFEQ WN1013                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           OMAJCD    IFEQ WN1014                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           OMAJCD    IFEQ WN1015                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           OMAJCD    IFEQ WN1016                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           OMAJCD    IFEQ WN1017                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           OMAJCD    IFEQ WN1018                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           OMAJCD    IFEQ WN1019                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           OMAJCD    IFEQ WN1020                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           OMAJCD    IFEQ WN1021                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           OMAJCD    IFEQ WN1022                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WN1013    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1013           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WN1014    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1014           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WN1015    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1015           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WN1016    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1016           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WN1017    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1017           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WN1018    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1018           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WN1019    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1019           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WN1020    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1020           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WN1021    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1021           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WN1022    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN1022           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSOD     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OERVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQOE01           Application Cod
      * Define keylist
     C           KRSOE     KLIST
     C                     KFLD           WQOE01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQOE01           Application Cod
     C                     MOVEL'OMS'     WQOE01           Application Cod
      * Establish starting position
     C           KRSOE     SETLL@DNRESF                    *
     C           KRSOE     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR OFRVGN
     C                     END                             *FI
     C           KRSOE     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQOF01           Application Cod
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           WQOF01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQOF01           Application Cod
      * Establish starting position
     C           KRSOF     SETLL@DNRESF                    *
     C           KRSOF     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSOF     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGRVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOG     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSOG     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Application WHS
     C                     GOTO OGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0001           Application WHS
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHRVGN    BEGSR
      *================================================================
      * RTV Record Status     RT - EDI Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0049           Record Status
      * Define keylist
     C           KRSOH     KLIST
     C                     KFLD           GNM4AA           Interchange Cod
      * Setup key
     C                     MOVEL'SHPEXP'  GNM4AA           Interchange Cod
      * Establish starting position
     C           KRSOH     CHAIN@GNREHW              90    *
      * Data record not found
     C   90                MOVEL'USR4367' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELGNVSST    YL0049           Record Status
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv 1st Warehouse     RT - User Application Whs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FOAJVN    WQSA01           User Profile Na
     C           *LIKE     DEFN FODNCD    WQSA02           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           User Profile Na
     C                     KFLD           WQSA02           Application Cod
      * Setup key
     C                     MOVEL##USR     WQSA01           User Profile Na
     C                     MOVE *BLANK    WQSA02           Application Cod
     C                     MOVEL'TRF'     WQSA02           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@FOREDD                    *
     C           KRSSA     READE@FOREDD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4200' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CZUCD           Warehouse Code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFOAJCD    #CZUCD           Warehouse Code
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@FOREDD                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQSB01           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSB01           Load ID
      * Establish starting position
     C           KRSSB     SETLL@AMREJM                    *
     C           KRSSB     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RR6CD           Shipping Line
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** pass back the first record found with a shipping line
      * CASE: DB1.Shipping Line is not entered
     C           AMXACD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELAMXACD    #RR6CD           Shipping Line
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDWL0001    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@FLCPE8                    *
     C           KRSSC     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR SDRVGN
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WL0002           Ship To Custome
     C                     MOVELBEBRTX    WL0003           Ship To Name
     C                     MOVELBEHMNA    WL0004           Ship To Address
     C                     MOVELBEHONA    WL0005           Ship To Address
     C                     MOVELBEHPNA    WL0006           Ship To Address
     C                     MOVELBEHNNA    WL0007           Ship To City
     C                     MOVELBEDBCD    WL0008           Ship To State C
     C                     MOVELBECKTX    WL0009           Ship To Zip/Pos
     C                     MOVELBEBCNA    WUG0TX           Customer Purcha
     C                     MOVELBEB6NA    WUG0TX           Special Instruc
     C                     MOVELBEBYNA    WUG0TX           Special Instruc
     C                     Z-ADDBEEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDBEAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0012           USR Weight Accu
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WL0013    IFEQ 'I'                        *IF
     C           WL0013    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0010    WL0014           Load ID
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    YL0003           Pallets Loaded
     C                     Z-ADDWL0016    YL0004           Avg Pallet Tare
     C                     Z-ADDWL0017    YL0005           Tot Pallet Tare
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSE01           Load ID
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Load ID
     C                     KFLD           WARUNB           Stop_Drop Seque
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Load ID
      * Setup key
     C                     Z-ADDWL0010    WQSE01           Load ID
     C                     Z-ADDWL0011    WARUNB           Stop_Drop Seque
      * Establish starting position
     C           KPSSE     SETLL@FLCPBW                    *
     C           KRSSE     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 01/18/10 PKD E000261 SEND in LCL.Avg Pallet Tare
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0010  30       Company Number
     C                     PARM WAC4NB    WQ0011  70       Order Number
     C                     PARM *ZERO     WQ0012  30       Order Sequence
     C                     PARM *ZERO     WQ0013  30       Order Secondary
     C           WL0012    PARM WL0012    WQ0014 112       USR Weight Accu
     C           YL0006    PARM YL0006    WQ0015 112       Order Quantity
     C                     PARM YL0004    WQ0016  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           KRSSE     READE@FLCPBW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WL0013    IFEQ 'I'                        *IF
     C           WL0013    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0014           Load ID
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    YL0003           Pallets Loaded
     C                     Z-ADDWL0016    YL0004           Avg Pallet Tare
     C                     Z-ADDWL0017    YL0005           Tot Pallet Tare
     C                     ADD  YL0005    WL0012           USR Weight Accu
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0014    WBRMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBKNNX    WL0015           Pallets Loaded
     C                     Z-ADDWBICWG    WL0016           Avg Pallet Tare
     C                     Z-ADDWBIDWG    WL0017           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQSG01           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSG01           Load ID
      * Establish starting position
     C           KRSSG     SETLL@KECPGI                    *
     C           KRSSG     READE@KECPGI                  90*
      * Data record not found
     C   90                MOVEL'USR2199' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@KECPGI                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0019           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0020           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSH02           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH02           Load ID
      * Setup key
     C                     Z-ADDWL0018    WQSH02           Load ID
      * Establish starting position
     C           KRSSH     SETLL@BFCPD9                    *
     C           KRSSH     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0019           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WCBCST    IFEQ 'B'                        *IF
     C                     MOVELWCBCST    WL0020           Block Order Fla
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Chk Ord on Hld-Pr/Cr - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       #RD4ST           USR Flag 1
     C                     MOVEL'N'       #RXIST           Credit Hold
     C                     MOVEL'N'       YL0007           Production Hold
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSI01           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSI01           Load ID
      * Establish starting position
     C           KRSSI     SETLL@FLCPBW                    *
     C           KRSSI     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hold/Status        RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * CASE: LCL.Production Hold is Yes
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0007           Production Hold
     C                     MOVEL'Y'       #RD4ST           USR Flag 1
     C                     END                             *FI
      * CASE: LCL.Credit Hold is Yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #RXIST           Credit Hold
     C                     MOVEL'Y'       #RD4ST           USR Flag 1
     C                     END                             *FI
     C           KRSSI     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Hold/Status        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    BEAIC3           Company Number
     C                     Z-ADDWAC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    WUJNCD           Order Type - Sa
     C                     MOVELBEGWST    WUGWST           Header Status
     C                     MOVELBEGXST    WUGXST           Header Status L
     C                     MOVELBEXIST    YL0008           Credit Hold
     C                     MOVELBEXJST    YL0009           Production Hold
     C                     MOVELBEXKST    WUXKST           New Customer Ho
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSK02           Load ID
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK02           Load ID
     C                     KFLD           WDRVNB           Stop_Drop
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
      * Setup key
     C                     Z-ADDWL0021    WQSK02           Load ID
     C                     Z-ADDWL0022    WDRVNB           Stop_Drop
      * Establish starting position
     C           KPSSK     SETLL@FLCPEB                    *
     C           KRSSK     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SLRVGN
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSL01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSL02           Order Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSL01           Company Number
     C                     Z-ADDWDC4NB    WQSL02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSL     SETLL@BGWKAE                    *
     C           KRSSL     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0023           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SMRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0023           Warehouse Code
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Appt confirm     RT - Load Detail  * (RI) rq delv date
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     #RN8DT           LD Unused Date
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSN02           Load ID
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSN02           Load ID
      * Establish starting position
     C           KRSSN     SETLL@FLCPKF                    *
     C           KRSSN     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LD Sls Appt Confirm Dt is Entered
     C           WEN8DT    IFGT 0                          *IF
     C                     Z-ADDWEN8DT    #RN8DT           LD Unused Date
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Num Multi-Whs Ords RT - Load Detail  * trf011
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  3        Warehouse Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0026           Number of Order
     C                     MOVEL*BLANK    WN0001           Warehouse Code
     C                     MOVEL'N'       WL0025           Multi Company L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSO01           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Load ID
      * Setup key
     C                     Z-ADDWL0024    WQSO01           Load ID
      * Establish starting position
     C           KRSSO     SETLL@FLCPBW                    *
     C           KRSSO     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Number of Orders is Greater Than 1
     C           WL0026    IFGT 1                          *IF
     C                     GOTO SOEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Warehouse wo/Quit RT - Order Detail  * 
     C                     EXSR SPRVGN
      * CASE: PAR.Warehouse Code NE LCL.Warehouse Code
     C           WN0001    IFNE YL0010                     *IF
     C                     MOVELYL0010    WN0001           Warehouse Code
     C                     ADD  1         WL0026           Number of Order
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Warehouse wo/Quit RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSP01           Company Number
     C                     Z-ADDWAC4NB    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKDA                    *
     C           KRSSP     READE@BGWKDA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Warehouse Code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWFAJCD    YL0010           Warehouse Code
     C                     END                             *FI
     C           KRSSP     READE@BGWKDA                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CZUCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0027    WBRMNB           Load ID
      * Establish starting position
     C           KRSSR     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAODT    WL0028           Scheduled Ship
     C                     MOVELWBPKST    WL0029           Load Status
     C                     Z-ADDWBRPNB    WL0030           Total Load Orde
     C                     Z-ADDWBFLAM    WL0031           Flat Amount
     C                     MOVELWBXQST    WL0032           Allocate Pounds
     C                     MOVELWBDXTX    WL0033           Trailer Id
     C                     MOVELWBBZNA    WL0034           Carrier Code
     C                     MOVELWBRONB    WL0035           Truck Size
     C                     MOVELWBVDST    WL0036           Load Type
     C                     Z-ADDWBT4NB    WL0037           Schedule Sequen
     C                     Z-ADDWBTLMI    WL0038           Total Load Mile
     C                     MOVELWBQ2CD    WL0039           Shipping Method
     C                     MOVELWBVPCD    WL0040           Ship From Wareh
     C                     MOVELWBDBCD    WL0041           Ship To State C
     C                     MOVELWBRMST    WL0042           Load Acceptance
     C                     Z-ADDWBIDWG    WL0043           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0044    WBRMNB           Load ID
      * Establish starting position
     C           KRSSS     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBPKST    WL0045           Load Status
     C                     Z-ADDWBTLMI    WL0046           Total Load Mile
     C                     Z-ADDWBK2DT    WL0047           Override Total
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0048    BUY1NX           PFS Company Num
     C                     MOVELWL0049    BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSST     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0050           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0051           PFS Carlisle Ac
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    WL0050           PFS AccuSort Ac
     C                     MOVELBUWUSX    WL0051           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Val Order for Load Dl RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSU02           Load ID
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSU02           Load ID
      * Establish starting position
     C           KRSSU     SETLL@BFCPD9                    *
     C           KRSSU     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order in Use is yes
     C           WCGJST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ORDUSE'  W0RTN            *Return code
     C                     GOTO SUEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Confirmed & Complete
     C           WCGWST    IFEQ 'C'                        *IF
     C           WCGWST    OREQ 'R'
     C                     MOVEL'NOUNLCK' W0RTN            *Return code
     C                     GOTO SUEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Picked Event       RT - OP Order Events  * 
     C                     EXSR SVRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'NOUNLCK' W0RTN            *Return code
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSU     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Picked Event       RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSV01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSV02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSV03           Event Code
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
     C                     KFLD           WQSV03           Event Code
      * Setup key
     C                     Z-ADDWCAIC3    WQSV01           Company Number
     C                     Z-ADDWCC4NB    WQSV02           Order Number
     C                     MOVEL'03'      WQSV03           Event Code
      * Establish starting position
     C           KRSSV     SETLL@EYCPZE                    *
     C           KRSSV     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSV     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWINFN    BEGSR
      *================================================================
      * EXC Load Confirm Fax   IF - Load Header  * 
      *================================================================
      * EXC Load Confirm Fax   IF
      * ** See comments for explanation of parms.
      * PRC Submit Fax Load Cn UP - /UT User Programs  * 
     C                     CALL 'PDVVUPC'              90  PRC Submit Fax
     C                     PARM WUH3TX    WQ0051  7        Return Code Usr
     C           WL0052    PARM WL0052    WQ0052 155       Company Number
     C           WL0053    PARM WL0053    WQ0053 155       Order Number 1
     C                     PARM WL0054    WQ0054  3        Transloader Car
     C                     PARM WL0055    WQ0055  3        Carrier Code
     C                     PARM WL0056    WQ0056  3        Shipping Line
     C                     PARM WL0057    WQ0057  4        OHE Carrier SCA
     C                     PARM WL0058    WQ0058  1        Status Flag 1
     C                     PARM WL0059    WQ0059  1        Status Flag 2
     C                     PARM WL0060    WQ0060  1        Status Flag 3
     C                     PARM WL0061    WQ0061  1        Status Flag 4
     C                     PARM WL0062    WQ0062  1        Status Flag 5
     C                     PARM WL0063    WQ0063  1        Status - Y or N
     C                     PARM WL0064    WQ0064 10        Status Descript
     C                     PARM WL0065    WQ0065  1        USR Status (Y/N
     C                     PARM WL0067    WQ0066 10        PRT Printer Dev
     C                     PARM WL0068    WQ0067  4        PRT Hold Output
     C                     PARM WL0069    WQ0068  4        PRT Save Output
     C                     PARM WL0072    WQ0069 155       System Value Nu
     C                     PARM WL0073    WQ0070 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVVUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0074    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSX     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0075           Allow Multi-Com
     C                     MOVELDRMPNA    WL0076           Default Printer
     C                     MOVELDRBCCD    WL0077           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0078           Company Number
     C                     MOVELDRBUVN    WL0079           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0080    DTAJVN           User Profile Na
     C                     MOVELWL0081    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSY     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0082           Company Number
     C                     MOVELDTAJCD    WL0083           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGBWC3    WQSZ01           Shipping Compan
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0085    WQSZ01           Shipping Compan
      * Establish starting position
     C           KRSSZ     SETLL@ADREWA                    *
     C           KRSSZ     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0084           Warehouse Code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WGVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WGAOCD    IFNE *BLANK                     *IF
     C                     MOVELWGAOCD    WL0084           Warehouse Code
     C                     GOTO SZEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSZ     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0086    ABAIC3           Company Number
      * Establish starting position
     C           KRSTA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0087           Name
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0087           Name
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Unlock Load Authr RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADD#1AIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSTB     CHAIN@C0REO4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0527' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUHTST           Unlock Load Aut
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0HTST    WUHTST           Unlock Load Aut
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQTC01           PFS Load ID
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           PFS Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTC01           PFS Load ID
      * Establish starting position
     C           KRSTC     SETLL@BKCPEK                    *
     C           KRSTC     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUZMST           Pick Status USR
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUZMST           Pick Status USR
     C                     GOTO TCEXIT                     *QUIT
     C           KRSTC     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0007           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQTD02           Load ID
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTD02           Load ID
      * Establish starting position
     C           KRSTD     SETLL@FLCPEB                    *
     C           KRSTD     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           WDRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WN0007           Status - Y or N
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTD     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0008           Order in Use
     C                     MOVEL*BLANK    WN0009           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQTE02           Load ID
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTE02           Load ID
      * Establish starting position
     C           KRSTE     SETLL@BFCPD9                    *
     C           KRSTE     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WCGWST    IFEQ 'H'                        *IF
     C                     MOVELWCGWST    WN0009           Header Status
     C                     GOTO TEEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WCGWST    IFEQ 'X'                        *IF
     C                     MOVELWCGWST    WN0009           Header Status
     C                     GOTO TEEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WCGJST    IFEQ 'Y'                        *IF
     C                     MOVELWCGJST    WN0008           Order in Use
     C                     GOTO TEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTE     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQTF02           Load ID
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTF02           Load ID
      * Establish starting position
     C           KRSTF     SETLL@BFCPD9                    *
     C           KRSTF     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0021           Order Requires
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCFUSX    YL0021           Order Requires
     C           KRSTF     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVEL#1RONB    FKRONB           Truck Size
      * Establish starting position
     C           KRSTG     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0005           Maximum pounds
     C                     Z-ADD*ZERO     WN0006           Minimum pounds
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WN0005           Maximum pounds
     C                     Z-ADDFKTANB    WN0006           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSTH     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUGVTX           Name
     C                     MOVEL*BLANK    WUG0TX           Record Status
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WUGVTX           Name
     C                     MOVELFFVSST    WUG0TX           Record Status
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV SSI Carrier flag   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSTI     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUUNUS           SSI Download Fl
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFUNUS    WUUNUS           SSI Download Fl
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV SSI Fax'd Flag     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSTJ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBRUSX    WURUSX           Fax Sent to SSI
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * CHG Fax'd to SSI flag  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  30       Company Number
     C                     Z-ADD*ZERO     WN0014  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0015  1        LTL Flag
     C                     MOVEL*BLANK    WN0016  1        Load Status
     C                     Z-ADD*ZERO     WN0017  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0018 15        Seal 1
     C                     MOVEL*BLANK    WN0019 15        Seal 2
     C                     MOVEL*BLANK    WN0020 15        Seal 3
     C                     MOVEL*BLANK    WN0021 15        Seal 4
     C                     MOVEL*BLANK    WN0022 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0023  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0024 112       Flat Amount
     C                     MOVEL*BLANK    WN0025  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0026  50       Total Stops
     C                     MOVEL*BLANK    WN0027 20        Trailer Id
     C                     MOVEL*BLANK    WN0028  3        Transloader Car
     C                     Z-ADD*ZERO     WN0029  40       BOL Time
     C                     MOVEL*BLANK    WN0030  3        Carrier Code
     C                     MOVEL*BLANK    WN0031  7        Truck Size
     C                     Z-ADD*ZERO     WN0032  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0033 112       Rated Freight
     C                     MOVEL*BLANK    WN0034  1        Ship Status
     C                     MOVEL*BLANK    WN0035  1        Load Type
     C                     Z-ADD*ZERO     WN0036  50       Number Pallets
     C                     Z-ADD*ZERO     WN0037  50       Number Pallets
     C                     Z-ADD*ZERO     WN0038 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0039  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0040  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0041  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0042 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0043 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0044  70       Actual Departur
     C                     Z-ADD*ZERO     WN0045  40       Departure Time
     C                     Z-ADD*ZERO     WN0046  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0047  52       Product Tempera
     C                     Z-ADD*ZERO     WN0048  50       Number Spacers
     C                     MOVEL*BLANK    WN0049 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0050  70       Total Load Mile
     C                     MOVEL*BLANK    WN0051 12        Recorder ID
     C                     MOVEL*BLANK    WN0052  2        Shipping Method
     C                     MOVEL*BLANK    WN0053  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0054  2        Ship To State C
     C                     Z-ADD*ZERO     WN0055  70       Gross Weight
     C                     MOVEL*BLANK    WN0056  3        Carrier Broker
     C                     MOVEL*BLANK    WN0057  1        Export Status
     C                     Z-ADD*ZERO     WN0058  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0059  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0060  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0061  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0062  70       Spotted Date
     C                     Z-ADD*ZERO     WN0063  60       Spotted Time
     C                     Z-ADD*ZERO     WN0064  70       Load Finished D
     C                     Z-ADD*ZERO     WN0065  60       Load Finished T
     C                     Z-ADD*ZERO     WN0066  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0067  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0068  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0069  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0070  70       Truck Departure
     C                     Z-ADD*ZERO     WN0071  60       Truck Departure
     C                     Z-ADD*ZERO     WN0072  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0073  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0074  3        Shipping Line
     C                     MOVEL*BLANK    WN0075 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0076 30        Vessel Name
     C                     Z-ADD*ZERO     WN0077  50       Voyage
     C                     Z-ADD*ZERO     WN0078  70       Sail Date
     C                     MOVEL*BLANK    WN0079 12        Booking Number
     C                     MOVEL*BLANK    WN0080 20        Discharge Port
     C                     Z-ADD*ZERO     WN0081  70       Arrival Date
     C                     MOVEL*BLANK    WN0082 12        Container Numbe
     C                     Z-ADD*ZERO     WN0083  70       Date In
     C                     Z-ADD*ZERO     WN0084  60       Time In
     C                     Z-ADD*ZERO     WN0085  70       Date Out
     C                     Z-ADD*ZERO     WN0086  60       Time Out
     C                     Z-ADD*ZERO     WN0087 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0088  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0089  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0090  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0091  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0092  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0093  70       Requested Deliv
     C                     MOVEL*BLANK    WN0094  1        Load Acceptance
     C                     MOVEL*BLANK    WN0095  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0096  70       On Yard Date
     C                     Z-ADD*ZERO     WN0097  60       On Yard Time
     C                     Z-ADD*ZERO     WN0098  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0099  60       Deadline Depart
     C                     MOVEL*BLANK    WN0100  1        Load Held Over
     C                     MOVEL*BLANK    WN0101  1        Load Held Over
     C                     MOVEL*BLANK    WN0102 15        Load Held Over
     C                     MOVEL*BLANK    WN0103 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0104 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0105  70       Express Mail Da
     C                     MOVEL*BLANK    WN0106  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0107  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0108  70       Product Complet
     C                     Z-ADD*ZERO     WN0109  60       Product Complet
     C                     Z-ADD*ZERO     WN0110  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0111  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0112  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0113  1        Load Confirmed
     C                     MOVEL*BLANK    WN0114 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0115  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0116  60       Load Door 1
     C                     Z-ADD*ZERO     WN0117  70       Override Total
     C                     Z-ADD*ZERO     WN0118  60       Load Door 2
     C                     MOVEL*BLANK    WN0119  1        Partial Load
     C                     MOVEL*BLANK    WN0120  1        Load Confirmati
     C                     MOVEL*BLANK    WN0121  1        Export Load USD
     C                     MOVEL*BLANK    WN0122  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0123 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0124 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0125 15        Late Billing Em
     C                     MOVEL*BLANK    WN0126 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0127 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0128  1        Multi Company L
     C                     MOVEL*BLANK    WN0129  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0130  1        LH Power Only L
     C                     MOVEL*BLANK    WN0131  1        MG Created Load
     C                     MOVEL*BLANK    WN0132  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0133  2        Load U_M
     C                     MOVEL*BLANK    WN0134  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0135  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0136  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0137  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0138  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0139  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0140  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0141  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0142  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0143  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0144  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0145  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0146  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0147  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0148  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0149  60       LH Unused Time
     C                     MOVEL*BLANK    WN0150  1        EDI Status 1
     C                     MOVEL*BLANK    WN0151  1        EDI Status 2
     C                     MOVEL*BLANK    WN0152  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0153  60       Job Time
     C                     MOVEL*BLANK    WN0154 10        User Id
     C                     MOVEL*BLANK    WN0155 10        Job Name
     C                     Z-ADD*ZERO     WN0156  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      *
     C           KLCHTK    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHTK    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'Y'       WHRUSX    P      Fax Sent to SSI
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Val Cancel EDI 601    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0024           Order Number
     C                     MOVEL*BLANK    YL0025           Shipping Line
     C                     MOVEL*BLANK    YL0026           Port Delv Termi
     C                     MOVEL*BLANK    YL0027           OHE Vessel/Airl
     C                     MOVEL*BLANK    YL0028           OHE Discharge P
     C                     Z-ADD*ZERO     YL0029           OHE Sail/Flight
     C                     MOVEL*BLANK    YL0030           OHE EDI 824 AES
     C                     MOVEL*BLANK    YL0031           Cancel EDI 601
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQTL01           Load ID
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTL01           Load ID
      * Establish starting position
     C           KRSTL     SETLL@AMREJM                    *
     C           KRSTL     READE@AMREJM                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * EDI 601 has been sent before.
      * CASE: DB1.OHE EDI 601 Action is Sent
     C           AMJZSC    IFEQ 'S'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDAMC4NB    YL0024           Order Number
     C                     MOVELAMXACD    YL0025           Shipping Line
     C                     MOVELAMOANA    YL0026           Port Delv Termi
     C                     MOVELAMJ0T1    YL0027           OHE Vessel/Airl
     C                     MOVELAMHCAA    YL0028           OHE Discharge P
     C                     Z-ADDAMQWDT    YL0029           OHE Sail/Flight
     C                     MOVELAMM2U1    YL0030           OHE EDI 824 AES
     C                     MOVEL'Y'       YL0031           Cancel EDI 601
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTL     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTM02           Order Number
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           Company Number
     C                     KFLD           WQTM02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTM01           Company Number
     C                     Z-ADDYL0024    WQTM02           Order Number
      * Establish starting position
     C           KRSTM     SETLL@BGWKAE                    *
     C           KRSTM     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0032           Country Code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELOMKXCD    YL0032           Country Code
     C                     GOTO TMEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTM     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv CBP Info f/EDI 601 RT - Shipping Line/Port Extsn  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0033           CBP Export Port
     C                     MOVEL*BLANK    YL0034           CBP Std Carrier
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           C1XACD           Shipping Line
     C                     KFLD           C1OANA           Port Delv Termi
      * Setup key
     C                     MOVELYL0025    C1XACD           Shipping Line
     C                     MOVELYL0026    C1OANA           Port Delv Termi
      * Establish starting position
     C           KRSTN     CHAIN@C1REL2              90    *
      * Data record not found
     C   90                MOVEL'USR5297' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC1B1AB    YL0033           CBP Export Port
     C                     MOVELC1BYAB    YL0034           CBP Std Carrier
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Port of Unlading  RT - Country Port of Unlading  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0035           CBP Foreign Por
      * Declare restrictor key work fields
     C           *LIKE     DEFN CRKXCD    WQTO01           Country Code
     C           *LIKE     DEFN CRBVAB    WQTO02           Port of Unladin
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Country Code
     C                     KFLD           WQTO02           Port of Unladin
      * Setup key
     C                     MOVELYL0032    WQTO01           Country Code
     C                     MOVELYL0028    WQTO02           Port of Unladin
      * Establish starting position
     C           KRSTO     SETLL@CRRELE                    *
     C           KRSTO     READE@CRRELE                  90*
      * Data record not found
     C   90                MOVEL'USR5273' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCRHFNZ    YL0035           CBP Foreign Por
     C           KRSTO     READE@CRRELE                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * CHG Load Number        RT - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0157  50       Event Number
     C                     MOVEL*BLANK    WN0158  2        Event Code
     C                     Z-ADD*ZERO     WN0159  70       Event Date
     C                     MOVEL*BLANK    WN0160  1        Activity Hold
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Function was changed
      *                                    to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQTP02           Load ID
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTP02           Load ID
      * Establish starting position
     C           KRSTP     SETLL@BFCPD9                    *
     C           KRSTP     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Specific Event Cde RT - OP Order Events  * 
     C                     EXSR TQRVGN
      * RTV Latest Event/Date  RT - OP Order Events  * 
     C                     EXSR TSRVGN
      * UPD Load Information   RT - PD Order Header  * 
     C                     EXSR TTRVGN
      * *------------------------------------------------------*
      * * 07/18/02 PKP When the Order is removed from the Load, change
      * *              the Deadline Departure Date and Time to zero.
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                     EXSR TXRVGN
      * *------------------------------------------------------*
     C           KRSTP     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * DLT Specific Event Cde RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQTQ01           Company Number
     C           *LIKE     DEFN EYC4NB    WQTQ02           Order Number
     C           *LIKE     DEFN EYJPCD    WQTQ03           Event Code
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Company Number
     C                     KFLD           WQTQ02           Order Number
     C                     KFLD           WQTQ03           Event Code
      * Setup key
     C                     Z-ADDWCAIC3    WQTQ01           Company Number
     C                     Z-ADDWCC4NB    WQTQ02           Order Number
     C                     MOVEL'02'      WQTQ03           Event Code
      * Establish starting position
     C           KRSTQ     SETLL@EYCPZE                    *
     C           KRSTQ     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT OP Order Events    DL - OP Order Events  * 
     C                     EXSR TRDLRC
     C           KRSTQ     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRDLRC    BEGSR
      *================================================================
      * DLT OP Order Events    DL - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDEYAIC3    WIAIC3           Company Number
     C                     Z-ADDEYC4NB    WIC4NB           Order Number
     C                     Z-ADDEYQ2NB    WIQ2NB           Event Number
      *
     C           KLDLTR    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIQ2NB           Event Number
     C           KLDLTR    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Latest Event/Date  RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQTS01           Company Number
     C           *LIKE     DEFN WJC4NB    WQTS02           Order Number
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Company Number
     C                     KFLD           WQTS02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQTS01           Company Number
     C                     Z-ADDWCC4NB    WQTS02           Order Number
      * Establish starting position
     C           KRSTS     SETLL@EYCPZR                    *
     C           KRSTS     READE@EYCPZR                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJQ2NB    WN0157           Event Number
     C                     MOVELWJJPCD    WN0158           Event Code
     C                     Z-ADDWJD2DT    WN0159           Event Date
     C                     MOVELWJOOST    WN0160           Activity Hold
     C           KRSTS     READE@EYCPZR                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * UPD Load Information   RT - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0161  1        Header Status
     C                     MOVEL*BLANK    WN0162  1        Header Status L
     C                     Z-ADD*ZERO     WN0163 112       Order Weight To
     C                     MOVEL*BLANK    WN0164  1        Credit Hold
     C                     MOVEL*BLANK    WN0165  1        Production Hold
     C                     Z-ADD*ZERO     WN0166 112       Total Freight
     C                     Z-ADD*ZERO     WN0167  70       Total Load Orde
     C                     MOVEL*BLANK    WN0168  1        Affect Sales Do
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    BEAIC3           Company Number
     C                     Z-ADDWCC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSTT     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * UPD Event: Ship Detail RT - Order Detail  * 
     C                     EXSR TURVGN
      * Chg Load Information   CH - PD Order Header  * 
     C                     EXSR TWCHRC
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * UPD Event: Ship Detail RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTU01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTU02           Order Number
      * Define keylist
     C           KPSTU     KLIST
     C                     KFLD           WQTU01           Company Number
     C                     KFLD           WQTU02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           Company Number
     C                     KFLD           WQTU02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQTU01           Company Number
     C                     Z-ADDWCC4NB    WQTU02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSTU     SETLL@BGWKAE                    *
     C           KRSTU     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Shipping Event     CH - PD Order Detail  * 
     C                     EXSR TVCHRC
     C           KRSTU     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * CHG Shipping Event     CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0169  70       Item Code
     C                     MOVEL*BLANK    WN0170  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0171  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0172  70       Order Group Cod
     C                     MOVEL*BLANK    WN0173  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0174  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0175 112       Billing Detail
     C                     Z-ADD*ZERO     WN0176 112       Billing Detail
     C                     Z-ADD*ZERO     WN0177 112       Billing Detail
     C                     Z-ADD*ZERO     WN0178 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0179  1        Comment Print A
     C                     MOVEL*BLANK    WN0180  1        Comment Print I
     C                     MOVEL*BLANK    WN0181  1        Comment Print P
     C                     MOVEL*BLANK    WN0182  1        Comment Print S
     C                     Z-ADD*ZERO     WN0183 112       Extended Amount
     C                     Z-ADD*ZERO     WN0184  70       Market Pricing
     C                     MOVEL*BLANK    WN0185  3        Commodity Marke
     C                     MOVEL*BLANK    WN0186  3        Date Method Cod
     C                     MOVEL*BLANK    WN0187  3        Price Method Co
     C                     Z-ADD*ZERO     WN0188 114       Price Overage O
     C                     Z-ADD*ZERO     WN0189  70       Contract Number
     C                     MOVEL*BLANK    WN0190  1        Price Status
     C                     Z-ADD*ZERO     WN0191  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0192  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0193  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0194  1        Work Confirm St
     C                     MOVEL*BLANK    WN0195  1        Work Over/Short
     C                     MOVEL*BLANK    WN0196  1        OD Production P
     C                     MOVEL*BLANK    WN0197 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0198 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0199  1        Age Code
     C                     MOVEL*BLANK    WN0200  1        Palletize
     C                     MOVEL*BLANK    WN0201  1        Slip Sheet
     C                     MOVEL*BLANK    WN0202  1        Catch Weight St
     C                     MOVEL*BLANK    WN0203  1        Price Audit
     C                     MOVEL*BLANK    WN0204  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0205  1        Production Date
     C                     Z-ADD*ZERO     WN0206 112       Rated Freight
     C                     Z-ADD*ZERO     WN0207 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0208 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0209 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0210 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0211 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0212 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0213 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0214 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0215 114       Unit Price
     C                     Z-ADD*ZERO     WN0216 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0217 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0218 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0219 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0220  70       Requested Ship
     C                     Z-ADD*ZERO     WN0221  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0222  70       Actual Shipped
     C                     MOVEL*BLANK    WN0223  1        Affect Inventor
     C                     MOVEL*BLANK    WN0224  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0225  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0226  30       Item Structure
     C                     Z-ADD*ZERO     WN0227  30       Item Structure
     C                     Z-ADD*ZERO     WN0228  30       Item Structure
     C                     MOVEL*BLANK    WN0229  2        Item Level
     C                     MOVEL*BLANK    WN0230  2        Quality Level
     C                     MOVEL*BLANK    WN0231  2        Pricing Product
     C                     MOVEL*BLANK    WN0232  2        Season Product
     C                     Z-ADD*ZERO     WN0233  70       Date of Origina
     C                     MOVEL*BLANK    WN0234 10        User Profile Na
     C                     MOVEL*BLANK    WN0235  6        Country Code
     C                     MOVEL*BLANK    WN0236  3        Reason Code
     C                     MOVEL*BLANK    WN0237  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0238  1        Modified Flag
     C                     MOVEL*BLANK    WN0239  1        Substituted Fla
     C                     MOVEL*BLANK    WN0240  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0241 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0242 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0243  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0244  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0245  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0246  1        Affect Commissi
     C                     MOVEL*BLANK    WN0247  1        Affect Pricing
     C                     MOVEL*BLANK    WN0248  1        Released by Use
     C                     MOVEL*BLANK    WN0249  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0250  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0251  3        Production Ware
     C                     MOVEL*BLANK    WN0252  3        OD Price Type
     C                     Z-ADD*ZERO     WN0253  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0254  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0255  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0256  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0257  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0258  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0259  60       Price Code
     C                     Z-ADD*ZERO     WN0260  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0261  60       Substitution Li
     C                     Z-ADD*ZERO     WN0262  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0263 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0264 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0265 112       OD Item Target
     C                     Z-ADD*ZERO     WN0266 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0267 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0268 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0269 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0270 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0271 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0272 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0273 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0274 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0275 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0276  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0277  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0278  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0279 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0280  40       Item Age Days
     C                     Z-ADD*ZERO     WN0281  70       Production Ovr
     C                     Z-ADD*ZERO     WN0282  70       Production Ovr
     C                     MOVEL*BLANK    WN0283  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0284  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0285  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0286  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0287  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0288  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0289  1        EDI Status 1
     C                     MOVEL*BLANK    WN0290  1        EDI Status 2
     C                     MOVEL*BLANK    WN0291  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0292  60       Job Time
     C                     MOVEL*BLANK    WN0293 10        User Id
     C                     MOVEL*BLANK    WN0294 10        Job Name
     C                     Z-ADD*ZERO     WN0295  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WKAIC3           Company Number
     C                     Z-ADDOMC4NB    WKC4NB           Order Number
     C                     Z-ADDOMDPNB    WKDPNB           Order Sequence
     C                     Z-ADDOMUENB    WKUENB           Order Secondary
      *
     C           KLCHTV    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHTV    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWN0158    WKJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * Chg Load Information   CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0296  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0297  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0298  70       Ship To Custome
     C                     MOVEL*BLANK    WN0299 30        Ship To Name
     C                     MOVEL*BLANK    WN0300 30        Ship To Address
     C                     MOVEL*BLANK    WN0301 30        Ship To Address
     C                     MOVEL*BLANK    WN0302 30        Ship To Address
     C                     MOVEL*BLANK    WN0303 20        Ship To City
     C                     MOVEL*BLANK    WN0304  2        Ship To State C
     C                     MOVEL*BLANK    WN0305 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0306  70       Bill to Custome
     C                     MOVEL*BLANK    WN0307 30        Bill to Name
     C                     MOVEL*BLANK    WN0308 30        Bill to Address
     C                     MOVEL*BLANK    WN0309 30        Bill to Address
     C                     MOVEL*BLANK    WN0310 30        Bill to Address
     C                     MOVEL*BLANK    WN0311 20        Bill to City
     C                     MOVEL*BLANK    WN0312  2        Bill to State C
     C                     MOVEL*BLANK    WN0313 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0314 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0315  70       Order Date
     C                     Z-ADD*ZERO     WN0316  70       Requested Ship
     C                     Z-ADD*ZERO     WN0317  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0318  70       Cancel Date
     C                     MOVEL*BLANK    WN0319  2        Terms Code
     C                     MOVEL*BLANK    WN0320 40        Special Instruc
     C                     MOVEL*BLANK    WN0321 40        Special Instruc
     C                     MOVEL*BLANK    WN0322  1        Comment Print A
     C                     MOVEL*BLANK    WN0323  1        Comment Print I
     C                     MOVEL*BLANK    WN0324  1        Comment Print P
     C                     MOVEL*BLANK    WN0325  1        Comment Print S
     C                     MOVEL*BLANK    WN0326  3        Reason Code
     C                     MOVEL*BLANK    WN0327  1        Order in Use
     C                     MOVEL*BLANK    WN0328  1        Header Status
     C                     MOVEL*BLANK    WN0329  1        Header Status L
     C                     MOVEL*BLANK    WN0330  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0331  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0332 10        User Original E
     C                     Z-ADD*ZERO     WN0333  70       Date of Origina
     C                     Z-ADD*ZERO     WN0334 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0335 112       Order Weight To
     C                     MOVEL*BLANK    WN0336  1        Credit Hold
     C                     MOVEL*BLANK    WN0337  1        Production Hold
     C                     MOVEL*BLANK    WN0338  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0339  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0340  40       Requested Deliv
     C                     MOVEL*BLANK    WN0341  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0342 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0343  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0344  1        LTL Flag
     C                     MOVEL*BLANK    WN0345  1        Price Audit
     C                     MOVEL*BLANK    WN0346  1        Price Status
     C                     MOVEL*BLANK    WN0347  2        Shipping Method
     C                     MOVEL*BLANK    WN0348  1        Export Status
     C                     MOVEL*BLANK    WN0349  1        Palletize
     C                     MOVEL*BLANK    WN0350  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0351  1        Slip Sheet
     C                     MOVEL*BLANK    WN0352  1        Age Code
     C                     Z-ADD*ZERO     WN0353  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0354  1        Load Type
     C                     Z-ADD*ZERO     WN0355  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0356  1        Load Plan Order
     C                     MOVEL*BLANK    WN0357  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0358  70       Resell Referenc
     C                     MOVEL*BLANK    WN0359 30        Special Comment
     C                     MOVEL*BLANK    WN0360 30        Special Comment
     C                     MOVEL*BLANK    WN0361  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0362  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0363  2        Manager Level C
     C                     MOVEL*BLANK    WN0364  3        VP Level Code
     C                     Z-ADD*ZERO     WN0365  70       Attach to Order
     C                     MOVEL*BLANK    WN0366  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0367  70       Invoice Number
     C                     MOVEL*BLANK    WN0368  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0369  70       Invoice Date
     C                     MOVEL*BLANK    WN0370  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0371  1        Modified Flag
     C                     Z-ADD*ZERO     WN0372 112       A/R order Value
     C                     MOVEL*BLANK    WN0373  1        Billing Activit
     C                     MOVEL*BLANK    WN0374  1        Block Order Fla
     C                     MOVEL*BLANK    WN0375  1        Order Certifica
     C                     Z-ADD*ZERO     WN0376 112       Invoice Order V
     C                     MOVEL*BLANK    WN0377  1        Process Sts for
     C                     MOVEL*BLANK    WN0378  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0379  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0380  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0381  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0382  1        Email Cust On O
     C                     MOVEL*BLANK    WN0383  1        Order Emailed
     C                     MOVEL*BLANK    WN0384  1        Export Docs Go
     C                     MOVEL*BLANK    WN0385  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0386  1        Broker Order St
     C                     MOVEL*BLANK    WN0387  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0388  2        Order Requires
     C                     MOVEL*BLANK    WN0389  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0390  2        Export USDA App
     C                     MOVEL*BLANK    WN0391  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0392  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0393  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0394  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0395  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0396  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0397  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0398  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0399  60       Time of Origina
     C                     Z-ADD*ZERO     WN0400  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0401  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0402  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0403 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0404 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0405 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0406 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0407 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0408  70       Claim Number
     C                     MOVEL*BLANK    WN0409  1        EDI Status 1
     C                     MOVEL*BLANK    WN0410  1        EDI Status 2
     C                     MOVEL*BLANK    WN0411  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0412  60       Job Time
     C                     MOVEL*BLANK    WN0413 10        User Id
     C                     MOVEL*BLANK    WN0414 10        Job Name
     C                     Z-ADD*ZERO     WN0415  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWCAIC3    WLAIC3           Company Number
     C                     Z-ADDWCC4NB    WLC4NB           Order Number
      *
     C           KLCHTW    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHTW    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL*BLANK    WLBZNA    P      Carrier Code
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
     C                     MOVELWN0158    WLJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWLAIC3    PCAIC3           Company Number
     C                     Z-ADDWLC4NB    PCC4NB           Order Number
     C                     MOVELWLJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWLANC7    PCANC7           AR Customer Num
     C                     Z-ADDWLBKC7    PCBKC7           Ship To Custome
     C                     MOVELWLBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWLHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWLHONA    PCHONA    P      Ship To Address
     C                     MOVELWLHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PCHNNA    P      Ship To City
     C                     MOVELWLDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWLCKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWLB0C7    PCB0C7           Bill to Custome
     C                     MOVELWLAETX    PCAETX    P      Bill to Name
     C                     MOVELWLB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PCB2NA    P      Bill to City
     C                     MOVELWLBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWLC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWLBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PCA0DT           Order Date
     C                     Z-ADDWLA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PCACDT           Cancel Date
     C                     MOVELWLAQCD    PCAQCD    P      Terms Code
     C                     MOVELWLB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWLBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWLGTST    PCGTST    P      Comment Print A
     C                     MOVELWLGVST    PCGVST    P      Comment Print I
     C                     MOVELWLGUST    PCGUST    P      Comment Print P
     C                     MOVELWLQFST    PCQFST    P      Comment Print S
     C                     MOVELWLCQCD    PCCQCD    P      Reason Code
     C                     MOVELWLGJST    PCGJST    P      Order in Use
     C                     MOVELWLGWST    PCGWST    P      Header Status
     C                     MOVELWLGXST    PCGXST    P      Header Status L
     C                     MOVELWLGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PCAODT           Scheduled Ship
     C                     MOVELWLAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWLJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PCA1WG           Order Weight To
     C                     MOVELWLXIST    PCXIST    P      Credit Hold
     C                     MOVELWLXJST    PCXJST    P      Production Hold
     C                     MOVELWLXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PCAFTM           Requested Deliv
     C                     MOVELWLE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PCRMNB           Load ID
     C                     Z-ADDWLTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PCR1NB           Rated Freight
     C                     MOVELWLPJST    PCPJST    P      LTL Flag
     C                     MOVELWLU0ST    PCU0ST    P      Price Audit
     C                     MOVELWLU1ST    PCU1ST    P      Price Status
     C                     MOVELWLQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PCU2ST    P      Export Status
     C                     MOVELWLVEST    PCVEST    P      Palletize
     C                     MOVELWLVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PCVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWLRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWLVDST    PCVDST    P      Load Type
     C                     Z-ADDWLATIN    PCATIN           Attach to Invoi
     C                     MOVELWLU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PCRSRN           Resell Referenc
     C                     MOVELWLMHNA    PCMHNA    P      Special Comment
     C                     MOVELWLMINA    PCMINA    P      Special Comment
     C                     MOVELWLWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PCT3NB           Attach to Order
     C                     MOVELWLSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PCCONB           Invoice Number
     C                     MOVELWLCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PCAWDT           Invoice Date
     C                     MOVELWLJPCD    PCJPCD    P      Event Code
     C                     MOVELWLXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PCVRVA           A/R order Value
     C                     MOVELWLOBST    PCOBST    P      Billing Activit
     C                     MOVELWLBCST    PCBCST    P      Block Order Fla
     C                     MOVELWLBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PCB7VL           Invoice Order V
     C                     MOVELWLGASX    PCGASX    P      Process Sts for
     C                     MOVELWLGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PCFUSX    P      Order Requires
     C                     MOVELWLFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWLBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWLH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWLH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PCC0C7           Claim Number
     C                     MOVELWLUVST    PCUVST    P      EDI Status 1
     C                     MOVELWLUWST    PCUWST    P      EDI Status 2
     C                     MOVELWLUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PCAATM           Job Time
     C                     MOVELWLAYNA    PCAYNA    P      User Id
     C                     MOVELWLA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQTX01           Company Number
     C           *LIKE     DEFN WMC4NB    WQTX02           Order Number
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           Company Number
     C                     KFLD           WQTX02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQTX01           Company Number
     C                     Z-ADDWCC4NB    WQTX02           Order Number
      * Establish starting position
     C           KRSTX     SETLL@BGWKL1                    *
     C           KRSTX     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR TYCHRC
     C           KRSTX     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0416  70       Item Code
     C                     MOVEL*BLANK    WN0417  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0418  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0419  70       Order Group Cod
     C                     MOVEL*BLANK    WN0420  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0421  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0422 112       Billing Detail
     C                     Z-ADD*ZERO     WN0423 112       Billing Detail
     C                     Z-ADD*ZERO     WN0424 112       Billing Detail
     C                     Z-ADD*ZERO     WN0425 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0426  1        Comment Print A
     C                     MOVEL*BLANK    WN0427  1        Comment Print I
     C                     MOVEL*BLANK    WN0428  1        Comment Print P
     C                     MOVEL*BLANK    WN0429  1        Comment Print S
     C                     Z-ADD*ZERO     WN0430 112       Extended Amount
     C                     Z-ADD*ZERO     WN0431  70       Market Pricing
     C                     MOVEL*BLANK    WN0432  3        Commodity Marke
     C                     MOVEL*BLANK    WN0433  3        Date Method Cod
     C                     MOVEL*BLANK    WN0434  3        Price Method Co
     C                     Z-ADD*ZERO     WN0435 114       Price Overage O
     C                     Z-ADD*ZERO     WN0436  70       Contract Number
     C                     MOVEL*BLANK    WN0437  1        Price Status
     C                     Z-ADD*ZERO     WN0438  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0439  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0440  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0441  1        Work Confirm St
     C                     MOVEL*BLANK    WN0442  1        Work Over/Short
     C                     MOVEL*BLANK    WN0443  1        OD Production P
     C                     MOVEL*BLANK    WN0444 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0445 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0446  1        Age Code
     C                     MOVEL*BLANK    WN0447  1        Palletize
     C                     MOVEL*BLANK    WN0448  1        Slip Sheet
     C                     MOVEL*BLANK    WN0449  1        Catch Weight St
     C                     MOVEL*BLANK    WN0450  1        Price Audit
     C                     MOVEL*BLANK    WN0451  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0452  1        Production Date
     C                     Z-ADD*ZERO     WN0453 112       Rated Freight
     C                     Z-ADD*ZERO     WN0454 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0455 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0456 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0457 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0458 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0459 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0460 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0461 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0462 114       Unit Price
     C                     Z-ADD*ZERO     WN0463 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0464 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0465 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0466 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0467  70       Requested Ship
     C                     Z-ADD*ZERO     WN0468  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0469  70       Actual Shipped
     C                     MOVEL*BLANK    WN0470  1        Affect Inventor
     C                     MOVEL*BLANK    WN0471  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0472  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0473  30       Item Structure
     C                     Z-ADD*ZERO     WN0474  30       Item Structure
     C                     Z-ADD*ZERO     WN0475  30       Item Structure
     C                     MOVEL*BLANK    WN0476  2        Item Level
     C                     MOVEL*BLANK    WN0477  2        Quality Level
     C                     MOVEL*BLANK    WN0478  2        Pricing Product
     C                     MOVEL*BLANK    WN0479  2        Season Product
     C                     Z-ADD*ZERO     WN0480  70       Date of Origina
     C                     MOVEL*BLANK    WN0481 10        User Profile Na
     C                     MOVEL*BLANK    WN0482  6        Country Code
     C                     MOVEL*BLANK    WN0483  2        Event Code
     C                     MOVEL*BLANK    WN0484  3        Reason Code
     C                     MOVEL*BLANK    WN0485  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0486  1        Modified Flag
     C                     MOVEL*BLANK    WN0487  1        Substituted Fla
     C                     MOVEL*BLANK    WN0488  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0489 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0490 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0491  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0492  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0493  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0494  1        Affect Commissi
     C                     MOVEL*BLANK    WN0495  1        Affect Pricing
     C                     MOVEL*BLANK    WN0496  1        Released by Use
     C                     MOVEL*BLANK    WN0497  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0498  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0499  3        Production Ware
     C                     MOVEL*BLANK    WN0500  3        OD Price Type
     C                     Z-ADD*ZERO     WN0501  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0502  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0503  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0504  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0505  60       Price Code
     C                     Z-ADD*ZERO     WN0506  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0507  60       Substitution Li
     C                     Z-ADD*ZERO     WN0508  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0509 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0510 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0511 112       OD Item Target
     C                     Z-ADD*ZERO     WN0512 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0513 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0514 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0515 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0516 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0517 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0518 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0519 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0520 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0521 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0522  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0523  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0524  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0525 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0526  40       Item Age Days
     C                     Z-ADD*ZERO     WN0527  70       Production Ovr
     C                     Z-ADD*ZERO     WN0528  70       Production Ovr
     C                     MOVEL*BLANK    WN0529  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0530  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0531  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0532  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0533  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0534  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0535  1        EDI Status 1
     C                     MOVEL*BLANK    WN0536  1        EDI Status 2
     C                     MOVEL*BLANK    WN0537  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0538  60       Job Time
     C                     MOVEL*BLANK    WN0539 10        User Id
     C                     MOVEL*BLANK    WN0540 10        Job Name
     C                     Z-ADD*ZERO     WN0541  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWMAIC3    WKAIC3           Company Number
     C                     Z-ADDWMC4NB    WKC4NB           Order Number
     C                     Z-ADDWMDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWMUENB    WKUENB           Order Secondary
      *
     C           KLCHTY    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHTY    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD*ZERO     WKNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WKBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * RTV First Order on LoadRT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTZ02           Load ID
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WQTZ02           Load ID
      * Setup key
     C                     Z-ADDWL0088    WQTZ02           Load ID
      * Establish starting position
     C           KRSTZ     SETLL@FLCPE8                    *
     C           KRSTZ     READE@FLCPE8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0089           Order Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLC4NB    WL0089           Order Number
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TZEXIT                     *QUIT
     C           KRSTZ     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 01/18/2010 PKD E000261 Pass the Average Pallet Tare
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 04/24/2011 LJB P000737
      * ** Pgm PODPUPR replaced with PDVVUPC. Parms changed to either
      * ** Print Only or Fax/Email to all carriers that are passed in.
      * ** *** Parms are:
      * ** Status-Y or N = Fax Carrier, Status Flag 1 Y/N=Fax Dispatcher,
      * ** Status Flag 2 Y/N=Fax Transloader, Status Flag 3 Y/N=Fax Mexic
      * ** Status Flag 4 Y/N=Fax Exp Coordn, Status Flag 5 Y/N=Fax Ocean
      * ** Usr Status (Y/N)=Print Only/Fax, Status Description 3=Printer
      * *****
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 09/20/2011 LJB P001251 Export Order Automation
      * ** Cannot lock if Export Order Automation Upload had errors
      * ** that have not been cleared up
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ** Fax/Email Documentation                        P000737
      *================================================================
      * ** PDVVUPC which calls PDVVPCLP which calls
      * ** PDAMXFR which calls PODYUPR to send any faxes and then calls
      * ** PLAMUPC to send any emails
      * ** Set Fax Carrier=Yes, Fax dispatch=No, Fax/Print=Fax
      * ** Fax Mexican Carrier=No, Fax Ship Line=No, Fax Transloader=No
      * ** Default reporting parms, so no popup window for print options
      * ** Always include Carrier Code. It is used for the subject
      * ** line of the emailed confirmation
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ** Write a group of Log recs for the deleted load     E000722
      *================================================================
     C                     MOVEL'DELOAD'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     Z-ADD1         P8RVNB           Stop_Drop
      * RTV First Order on LoadRT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0088           Load ID
     C                     EXSR TZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    #RC4NB           Order Number
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADDP8RVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL#1PKST    PDMNTX    P      Change Log Prio
     C                     MOVEL@CN,009   PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Write a record for the deleted carrier code
      * CASE: RCD.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
     C                     MOVEL'DELCAR'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     Z-ADD1         P8RVNB           Stop_Drop
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADDP8RVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL#1BZNA    PDMNTX    P      Change Log Prio
     C                     MOVEL@CN,010   PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Write a record for the deleted Scheduled Ship Date
     C                     MOVEL'DELSSD'  WURVST           Load Change Typ
     C                     MOVEL*BLANK    YL0037           Text USR 7
     C                     MOVEL*BLANK    YL0037           Text USR 7
     C                     MOVEL#1AODT    YL0037           Text USR 7
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     Z-ADD1         P8RVNB           Stop_Drop
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADDP8RVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELYL0037    PDMNTX    P      Change Log Prio
     C                     MOVEL@CN,011   PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Write a record for the deleted Trailer ID, if entered
      * CASE: RCD.Trailer Id is Entered
     C           #1DXTX    IFNE *BLANK                     *IF
     C                     MOVEL'DELTRL'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     Z-ADD1         P8RVNB           Stop_Drop
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADDP8RVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL#RS2TX    PDMNTX    P      Change Log Prio
     C                     MOVEL@CN,012   PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Write a record for the deleted Customer Number
     C                     MOVEL'DELCST'  WURVST           Load Change Typ
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
     C                     EXSR NARVGN
     C                     MOVEL*BLANK    YL0037           Text USR 7
     C                     MOVEL*BLANK    YL0037           Text USR 7
     C                     MOVEL#RBKC7    YL0037           Text USR 7
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     Z-ADD1         P8RVNB           Stop_Drop
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADDP8RVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELYL0037    PDMNTX    P      Change Log Prio
     C                     MOVEL@CN,013   PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Write a record for DELODA Delete load accepted if NO carrier 7
      * CASE: RCD.Carrier Code is not entered
     C           #1BZNA    IFEQ *BLANK                     *IF
     C                     MOVEL'DELODA'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     Z-ADD1         P8RVNB           Stop_Drop
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADDP8RVNB    PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL*BLANK    PDMNTX    P      Change Log Prio
     C                     MOVEL@CN,014   PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#RC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0149  70       Load ID
     C           WN1009    PARM *BLANK    WQ0150  2        Load U_M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03072
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  12        W0CSRR  50
     C           03072     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD12        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ053
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2PKST'  YPMTFD           Load Status
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE055
     C           ZHCSCL    ANDLE056
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2Q2CD'  YPMTFD           Shipping Method
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ106
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CXIST'  YPMTFD           Credit Hold
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'OMPVDFRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     Z-ADD*ZERO     P2DYNB           PRT Number of C
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     P2AJAE           Order Number 1
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     MOVEL*BLANK    P2B8ST           Status - Y or N
     C                     MOVEL*BLANK    P3XFST           Display Prt Opt
     C                     MOVEL*BLANK    P3E5ST           USR Output Only
     C                     MOVEL*BLANK    P3E7ST           USR Print Detai
     C                     Z-ADD*ZERO     P3SEQ1           Seq No 1  PASS
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    P3ECST           Error Status
     C                     Z-ADD*ZERO     P3CDWG           USR Weight Accu
     C                     MOVEL*BLANK    P4D4ST           USR Flag 1
     C                     MOVEL*BLANK    P5B2VN           Job Name CDE
     C                     Z-ADD*ZERO     P6RMNB           Load ID
     C                     MOVEL*BLANK    P6BZNA           Carrier Code
     C                     MOVEL*BLANK    P7A0NA           Job Name
     C                     Z-ADD*ZERO     P8RVNB           Stop_Drop
     C                     Z-ADD*ZERO     P9G0NX           Numeric 4,0
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Warehouse 1 USR
     C                     MOVEL*BLANK    WUZUCD  3
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field USR Qclscan Result ?
     C                     Z-ADD*ZERO     WUY8NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop_Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Time 4.0
     C                     Z-ADD*ZERO     WUT4TM  40
      * Define work field USR Status (Y/N)
     C                     MOVEL*BLANK    WUE6ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           AR Customer Num
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Order Type - Sales
     C                     MOVEL*BLANK    WUJNCD  2
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Header Status Last
     C                     MOVEL*BLANK    WUGXST  1
      * Define work field New Customer Hold
     C                     MOVEL*BLANK    WUXKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WFGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR Program name
     C                     MOVEL*BLANK    WUBNVN 10
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field USR Load/Stop 10 Alpha
     C                     MOVEL*BLANK    WULINA 10
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field USR Stop
     C                     Z-ADD*ZERO     WUTENB  30
      * Define work field Status Description 3  USR
     C                     MOVEL*BLANK    WUNMTX 10
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    WUQ1ST  1
      * Define work field Status Flag 2  Y/N
     C                     MOVEL*BLANK    WUQ2ST  1
      * Define work field Status Flag 3  Y/N
     C                     MOVEL*BLANK    WUQ3ST  1
      * Define work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    WUFMST  1
      * Define work field Status Flag 5  Y/N
     C                     MOVEL*BLANK    WUAJTX  1
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WGBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Unlock Load Authority
     C                     MOVEL*BLANK    WUHTST  1
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field USR Carrier Name
     C                     MOVEL*BLANK    WUGVTX 30
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Exit Selection USR
     C                     MOVEL*BLANK    WUG8SX  1
      * Define work field USR Exit Program
     C                     MOVEL*BLANK    WUSTYN  1
      * Define work field USR Order Number
     C                     Z-ADD*ZERO     WUMPNB  70
      * Define work field USR Company Number
     C                     Z-ADD*ZERO     WUFKNB  30
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field SSI Download Flag
     C                     MOVEL*BLANK    WUUNUS  1
      * Define work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    WURUSX  1
      * Define work field SSI Add, Chg, Delete flag
     C                     MOVEL*BLANK    WUAHST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIQ2NB           Event Number
     C                     Z-ADD*ZERO     WIAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WIQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WID2DT           Event Date
     C                     Z-ADD*ZERO     WIAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WIQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WIQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 30
     C                     MOVEL*BLANK    WL0007 20
     C                     MOVEL*BLANK    WL0008  2
     C                     MOVEL*BLANK    WL0009 11
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  50
     C                     Z-ADD*ZERO     WL0012 112
     C                     MOVEL*BLANK    WL0013  1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  50
     C                     Z-ADD*ZERO     WL0016  92
     C                     Z-ADD*ZERO     WL0017  92
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  50
     C                     MOVEL*BLANK    WL0023  3
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026  50
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031 112
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033 20
     C                     MOVEL*BLANK    WL0034  3
     C                     MOVEL*BLANK    WL0035  7
     C                     MOVEL*BLANK    WL0036  1
     C                     Z-ADD*ZERO     WL0037  50
     C                     Z-ADD*ZERO     WL0038  70
     C                     MOVEL*BLANK    WL0039  2
     C                     MOVEL*BLANK    WL0040  3
     C                     MOVEL*BLANK    WL0041  2
     C                     MOVEL*BLANK    WL0042  1
     C                     Z-ADD*ZERO     WL0043  92
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0044  70
     C                     MOVEL*BLANK    WL0045  1
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  70
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0048  30
     C                     MOVEL*BLANK    WL0049  6
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
      * Define local variables for subroutine SWINFN.
     C                     Z-ADD*ZERO     WL0052 155
     C                     Z-ADD*ZERO     WL0053 155
     C                     MOVEL*BLANK    WL0054  3
     C                     MOVEL*BLANK    WL0055  3
     C                     MOVEL*BLANK    WL0056  3
     C                     MOVEL*BLANK    WL0057  4
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     MOVEL*BLANK    WL0061  1
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064 10
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066 25
     C                     MOVEL*BLANK    WL0067 10
     C                     MOVEL*BLANK    WL0068  4
     C                     MOVEL*BLANK    WL0069  4
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071 10
     C                     Z-ADD*ZERO     WL0072 155
     C                     MOVEL*BLANK    WL0073 50
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0074 10
     C                     MOVEL*BLANK    WL0075  1
     C                     MOVEL*BLANK    WL0076 10
     C                     MOVEL*BLANK    WL0077  3
     C                     Z-ADD*ZERO     WL0078  30
     C                     MOVEL*BLANK    WL0079 10
      * Define local variables for subroutine SYRVGN.
     C                     MOVEL*BLANK    WL0080 10
     C                     MOVEL*BLANK    WL0081  6
     C                     Z-ADD*ZERO     WL0082  30
     C                     MOVEL*BLANK    WL0083  3
      * Define local variables for subroutine SZRVGN.
     C                     MOVEL*BLANK    WL0084  3
     C                     Z-ADD*ZERO     WL0085  30
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0086  30
     C                     MOVEL*BLANK    WL0087 30
      * Define local variables for subroutine TZRVGN.
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  70
      * Define local variables for subroutine NFRVGN.
     C                     Z-ADD*ZERO     WL0090  70
     C                     MOVEL*BLANK    WL0091  1
      * Define local variables for subroutine NPCHRC.
     C                     Z-ADD*ZERO     WL0092  30
     C                     Z-ADD*ZERO     WL0093  70
     C                     Z-ADD*ZERO     WL0094  30
     C                     Z-ADD*ZERO     WL0095  30
     C                     Z-ADD*ZERO     WL0096 112
      * Define local variables for subroutine NXRVGN.
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  50
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  50
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Ship Method Type USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0004  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0005  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Weight Adjust 6.0     USR
     C                     Z-ADD*ZERO     YL0014  60
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field PFS AccuSort Active
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Hold On Jobq
     C                     MOVEL*BLANK    YL0016  4
      * Define local work field Job Log Create
     C                     MOVEL*BLANK    YL0017  4
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0018  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0019  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0020  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0021  2
      * Define local work field Orders have Same Booking#
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field EDI Interchange Active U
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0026 20
      * Define local work field OHE Vessel/Airline
     C                     MOVEL*BLANK    YL0027 30
      * Define local work field OHE Discharge Port/Airprt
     C                     MOVEL*BLANK    YL0028 20
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field OHE EDI 824 AES ITN #
     C                     MOVEL*BLANK    YL0030 15
      * Define local work field Cancel EDI 601 USR
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0032  6
      * Define local work field CBP Export Port Code
     C                     Z-ADD*ZERO     YL0033  50
      * Define local work field CBP Std Carrier Alpha Cde
     C                     MOVEL*BLANK    YL0034  4
      * Define local work field CBP Foreign Port Code
     C                     Z-ADD*ZERO     YL0035  50
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0037  7
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0005  30
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field AR Customer Number
     C                     Z-ADD*ZERO     YN0007  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0009 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0011 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0012 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0013  2
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0014 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0015  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0016 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0017 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0018 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0019 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0020 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0021  2
      * Define null work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YN0022 11
      * Define null work field Customer Purchase Order #
     C                     MOVEL*BLANK    YN0023 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0024  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0025  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0026  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0028  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0029 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0030 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0031  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0036  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0041  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0042 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0043  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0044 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0045 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0049  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0050  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0051  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0052 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0053  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0054  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0055 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0056  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0058  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0059  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0065  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0067  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0070  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0071 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0072 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0074  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0075  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0076  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0077  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0078  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0079  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0080  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0081  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0082  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0083  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0085 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0091  1
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0040  1
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0092  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0041  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0042  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0043  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0045  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0093 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0047  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0048  3
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0049  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD12        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     Z-ADD999999    W0SLM            *Scan limit
      *
     C                     MOVEL*BLANK    WN1320 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN1320           User Profile Na
      *
     C                     MOVEL*BLANK    WN1321 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1320    WL0074    P      User Profile Na
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0075    P1I6ST    P      Allow Multi-Com
     C                     MOVELWL0076    P1MPNA    P      Default Printer
     C                     MOVELWL0077    P1BCCD    P      Salesperson Cod
     C                     Z-ADDWL0078    YL0047           Company Number
     C                     MOVELWL0079    WN1321    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1320    ZA0073           User Profile Na
     C                     MOVEL'OMS'     ZA0074           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN1321    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1320    WL0080    P      User Profile Na
     C                     MOVEL'OMS'     WL0081    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    P1AIC3           Company Number
     C                     MOVELWL0083    YL0048    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1321    WL0080    P      User Profile Na
     C                     MOVEL'OMS'     WL0081    P      Application Cod
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    P1AIC3           Company Number
     C                     MOVELWL0083    YL0048    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0048    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1320    ZA0075           User Profile Na
     C                     MOVEL'OMS'     ZA0076           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0047    IFNE 0                          *IF
     C                     Z-ADDYL0047    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0048    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0186  3        Warehouse Code
     C                     PARM YL0047    WQ0187  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR OERVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVELP1MPNA    P2WRST           PRT Printer Dev
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL'*YES'    P3XFST           Display Prt Opt
     C                     MOVEL'Y'       P3E7ST           USR Print Detai
     C                     MOVEL'Y'       P1TAST           First Time Flag
     C                     MOVEL##JOB     P5B2VN           Job Name CDE
     C                     Z-ADD9         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST##JOB:ZQ  P7A0NA    P  90  Job Name
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           P7A0NA    CAT  'P':ZQ    P7A0NA    P      Job Name
      * 11/04/09 PKD E00519 Warehouse Access by User
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR OGRVGN
      * 07/01/16 RMC E4119 TMS
     C                     MOVEL'N'       YL0011           Live with TPM
      * EXC Rtv Status        XF - PFS Interface  * 
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0188  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0189  6        PFS Interface C
     C           YL0011    PARM *BLANK    WQ0190  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * EXC Rtv Status-AS     XF - PFS Interface  * 
     C                     CALL 'PBX2XFR'              90  EXC Rtv Status-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0191  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0192  6        PFS Interface C
     C           YL0012    PARM *BLANK    WQ0193  1        PFS AccuSort Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 12/14/22 DN DO4595-Verify EDI Interchange Active for EDI 601.
      * RTV Record Status     RT - EDI Interchange  * 
     C                     EXSR OHRVGN
      * Set 'EDI Interchange Active U' Flag.
      * CASE: LCL.Record Status is Active
     C           YL0049    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       YL0023           EDI Interchange
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0023           EDI Interchange
     C                     END                             *FI
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01026012820184402821028290283302842
02851028570286302869028710287502880
02887028980290102914029180292202925
02930029330293603074030770308503089
03098031070311303119031250312703131
03136031430315403157031700317403178
0318103186031890319303199
** W0END
01155014110184602827028310284002849
02855028600286602869028720287802885
02896028990291202916029200292202927
02930029330294303075030830308703096
03105031110311703123031250312803134
03141031520315503168031720317603178
0318303186031890319703203
** W0NAM
#2ST1     **SPT     #CVQCD    #2RMNB    V2AIC3    V2AODT    V2EIDT
#2T4NB    #CMDDI    #CT4TM    #2PKST    #2Q2CD    #CG1NX    #CG2NX
#CLINA    #2DBCD    #CS2TX    #2BZNA    #CR6CD    #CXIST    #CZUCD
#2RMST    #CD4ST    V2KZDT    #1SEL     #1RMNB    V1AIC3    V1AODT
V1EIDT    #1T4NB    #RMDDI    #RT4TM    #1PKST    #1Q2CD    #RG1NX
#RG2NX    #RLINA    #RV9CD    #RS2TX    #1BZNA    #RR6CD    #RXIST
#RZUCD    #1RMST    #RD4ST    #RYANB    #RYBNB
** @CN
00001 Y2U0003
00002 USR0752
00003 Y2U0005
00004 NOUNLCK
00005 ORDUSE
00006 FAXLDCNFRM
00007 Y2U9999
00008 PNW2PFR$
00009 Deleted
00010 Dltd CAR
00011 Dltd SSD
00012 Dltd TRLR
00013 Dltd Cust
00014 Del accepted
00015 PLTFLRSYS
00016 PDIZPCLP
00017 Auto Print Prelim. Pick
00018 PDSNPFR
