     H/TITLE TST Payment Post       XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:15:09
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPKC6CPL1IF  E           K        DISK
      * RTV : Tattoo Header Driver      Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKC4REL0UF  E           K        DISK
      * UPD : Payment Processing Parms  Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@C4REO7
      * Payment Processing Parms  Retrieval index
      * Renamed input format fields
     I              C4HONB                          WAHONB
     I              C4CKDT                          WACKDT
     I              C4M1NB                          WAM1NB
     I              C4KHST                          WAKHST
     I              C4KJST                          WAKJST
     I              C4PINB                          WAPINB
     I              C4KKST                          WAKKST
     I              C4AAVN                          WAAAVN
     I              C4AADT                          WAAADT
     I              C4AMTM                          WAAMTM
     I              C4AJST                          WAAJST
     I              C4AHVN                          WAAHVN
     I              C4AGVN                          WAAGVN
     I              C4ABVN                          WAABVN
     I              C4ABDT                          WAABDT
     I              C4ABTM                          WAABTM
      *
     I@C4REO6
      * Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WBHONB
     I              C4CKDT                          WBCKDT
     I              C4M1NB                          WBM1NB
     I              C4KHST                          WBKHST
     I              C4KJST                          WBKJST
     I              C4PINB                          WBPINB
     I              C4KKST                          WBKKST
     I              C4AAVN                          WBAAVN
     I              C4AADT                          WBAADT
     I              C4AMTM                          WBAMTM
     I              C4AJST                          WBAJST
     I              C4AHVN                          WBAHVN
     I              C4AGVN                          WBAGVN
     I              C4ABVN                          WBABVN
     I              C4ABDT                          WBABDT
     I              C4ABTM                          WBABTM
      *
     I@C6CPPX
      * Tattoo Header Driver      Retrieval index
      * Renamed input format fields
     I              C6N5NB                          WCN5NB
     I              C6IOTX                          WCIOTX
     I              C6LPNB                          WCLPNB
     I              C6BYDT                          WCBYDT
     I              C6HMNB                          WCHMNB
     I              C6BNNB                          WCBNNB
     I              C6BONB                          WCBONB
     I              C6CVNB                          WCCVNB
     I              C6B0DT                          WCB0DT
     I              C6AAVN                          WCAAVN
     I              C6AADT                          WCAADT
     I              C6AMTM                          WCAMTM
     I              C6AJST                          WCAJST
     I              C6AHVN                          WCAHVN
     I              C6AGVN                          WCAGVN
     I              C6ABVN                          WCABVN
     I              C6ABDT                          WCABDT
     I              C6ABTM                          WCABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKC41    E DSPKC4REL0
      * UPD : Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WBHONB
     I              C4CKDT                          WBCKDT
     I              C4M1NB                          WBM1NB
     I              C4KHST                          WBKHST
     I              C4KJST                          WBKJST
     I              C4PINB                          WBPINB
     I              C4KKST                          WBKKST
     I              C4AAVN                          WBAAVN
     I              C4AADT                          WBAADT
     I              C4AMTM                          WBAMTM
     I              C4AJST                          WBAJST
     I              C4AHVN                          WBAHVN
     I              C4AGVN                          WBAGVN
     I              C4ABVN                          WBABVN
     I              C4ABDT                          WBABDT
     I              C4ABTM                          WBABTM
      *
     IYARDCS      DS                             72
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                             21
      * KEY : Tattoo Header             Co/Prd/Loc/KlDte/Tto/Unp
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : MAP TH Kill Date
     I                                    P  15  180PAB0DT
      *
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Tattoo Header             Co/kD/SRT/Pt/Tto *all*
      * I : RST BOH Company Number
     I                                    P   1   20PBHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PBB0DT
      *
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Tattoo Header             Co/kD/SRT/Pt/Tto *all*
      * I : RST BOH Company Number
     I                                    P   1   20PCHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PCB0DT
      *
     IYBRDCS      DS                             72
      * Outward parameters
     IPDRC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PDHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PDBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PDBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PDCVNB
      *
     IYCRDCS      DS                             72
     IYDRDCS      DS                             72
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Payment Processing Parms
      * I :  CC Company Number
     I                                    P   1   20P1HONB
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P2EVTX    PARM           WP0002 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * TST Payment Post       XF
      * MODIFICATIONS
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * Rtv Payment Processing RT - Payment Processing Parms  * 
     C                     EXSR SARVGN
      * CASE: WRK.PP Payment Error is No Errors
     C           WUKJST    IFEQ 'N'                        *IF
      * Step 6 Producer Posting
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 6
     C           WUM1NB    IFLE 00006                      *IF
      * Step 6  Payment posting and producer Post/Create Producer Voucher
     C                     EXSR UASUBR                     Step 6  Payment
     C                     END                             *FI
      * Step 7 Reports
      * CASE: WRK.Pmt Current Payment Step is 00007 Carcass Summary
     C           WUM1NB    IFEQ 00007                      *IF
      * Carcass summary, carcass detail, & additional processing
     C                     EXSR UBSUBR                     Carcass summary
     C                     END                             *FI
      * Step End of Job **** Normal EoJ
      * CASE: WRK.Pmt Current Payment Step is 99999 Normal EOJ
     C           WUM1NB    IFEQ 99999                      *IF
      * Step End of Job update payment date and step
     C                     EXSR UDSUBR                     Step End of Job
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WUM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    WUKHST           PP Commission P
     C                     MOVEL*BLANK    WUKJST           PP Payment Erro
     C                     Z-ADD*ZERO     WUPINB           PP Unused Nbr 1
     C                     MOVEL*BLANK    WUKKST           PP Repayment St
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACKDT    WUCKDT           Pmt Current Pay
     C                     Z-ADDWAM1NB    WUM1NB           Pmt Current Pay
     C                     MOVELWAKHST    WUKHST           PP Commission P
     C                     MOVELWAKJST    WUKJST           PP Payment Erro
     C                     Z-ADDWAPINB    WUPINB           PP Unused Nbr 1
     C                     MOVELWAKKST    WUKKST           PP Repayment St
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0002 10        RS User Changed
     C                     Z-ADD*ZERO     WN0003  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0004  60       RS Time Changed
     C                     MOVEL*BLANK    WN0005  1        RS Record Statu
     C                     MOVEL*BLANK    WN0006 10        RS Job
     C                     MOVEL*BLANK    WN0007 10        RS Program
     C                     MOVEL*BLANK    WN0008 10        RS User Added
     C                     Z-ADD*ZERO     WN0009  70       RS Date Added
     C                     Z-ADD*ZERO     WN0010  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0002           RS User Changed
     C                     Z-ADD##JDT     WN0003           RS Date Changed
     C                     Z-ADD##JTM     WN0004           RS Time Changed
     C                     MOVEL##JOB     WN0006           RS Job
     C                     MOVEL##PGM     WN0007           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSB    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YARDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0012 10        RS User Changed
     C                     Z-ADD*ZERO     WN0013  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0014  60       RS Time Changed
     C                     MOVEL*BLANK    WN0015  1        RS Record Statu
     C                     MOVEL*BLANK    WN0016 10        RS Job
     C                     MOVEL*BLANK    WN0017 10        RS Program
     C                     MOVEL*BLANK    WN0018 10        RS User Added
     C                     Z-ADD*ZERO     WN0019  70       RS Date Added
     C                     Z-ADD*ZERO     WN0020  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0012           RS User Changed
     C                     Z-ADD##JDT     WN0013           RS Date Changed
     C                     Z-ADD##JTM     WN0014           RS Time Changed
     C                     MOVEL##JOB     WN0016           RS Job
     C                     MOVEL##PGM     WN0017           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSC    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSC    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YBRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Prt Crc Sum       RT - Tattoo Header Driver  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@C6CPPX                    *
     C                     READ @C6CPPX                  90*
      * Data record not found
     C   90                MOVEL'PRK0448' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Print Carc Sum
      * CASE: DB1.Tattoo Header Action is Carc Sum
     C           WCIOTX    IFEQ @CN,001                    *IF
      * Prt Crc Sum on Form   PF - Tattoo Header  * 
     C                     CLEARPDRC
     C                     Z-ADDWCHMNB    PDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    PDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    PDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    PDCVNB           TH Tattoo Numbe
      *
     C                     CALL 'PKW9PFR'              90  Prt Crc Sum on
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Tattoo Hea
     C                     PARM 'N'       WQ0021  1        Print Carcass A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKW9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Live as Carcass
      * Rtv Payment Type      RT - Tattoo Header  * 
     C                     EXSR SERVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.TH Payment Type is Live
      *   |- c2    : WRK.TH Hog Class Type is Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUJ9ST    IFEQ 'L'                        *IF
     C           WULLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Prt Crc Sum on Form   PF - Tattoo Header  * 
     C                     CLEARPDRC
     C                     Z-ADDWCHMNB    PDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    PDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    PDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    PDCVNB           TH Tattoo Numbe
      *
     C                     CALL 'PKW9PFR'              90  Prt Crc Sum on
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Tattoo Hea
     C                     PARM 'Y'       WQ0022  1        Print Carcass A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKW9PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Print Crc Dtl
      * CASE: DB1.Tattoo Header Action is Prt Crc Dtl
     C           WCIOTX    IFEQ @CN,002                    *IF
      * Prt Carcass Detail    PF - Tattoo Header Driver  * 
     C                     CALL 'PKTCPFR'              90  ZZt Carcass Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCN5NB    WQ0023  50       Tattoo Sequence
     C                     PARM 'N'       WQ0024  1        Print Carcass A
     C                     PARM P2EVTX    WQ0025 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Carcass Detail    PF - Tattoo Header Driver  * 
     C                     CALL 'PKTCPFR'              90  ZZt Carcass Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCN5NB    WQ0026  50       Tattoo Sequence
     C                     PARM 'Y'       WQ0027  1        Print Carcass A
     C                     PARM P2EVTX    WQ0028 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     READ @C6CPPX                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Payment Type      RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      * Establish starting position
     C           KRSSE     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDJ9ST    WUJ9ST           TH Payment Type
     C                     MOVELWDLLST    WULLST           TH Hog Class Ty
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0021  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0022 10        RS User Changed
     C                     Z-ADD*ZERO     WN0023  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0024  60       RS Time Changed
     C                     MOVEL*BLANK    WN0025  1        RS Record Statu
     C                     MOVEL*BLANK    WN0026 10        RS Job
     C                     MOVEL*BLANK    WN0027 10        RS Program
     C                     MOVEL*BLANK    WN0028 10        RS User Added
     C                     Z-ADD*ZERO     WN0029  70       RS Date Added
     C                     Z-ADD*ZERO     WN0030  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0022           RS User Changed
     C                     Z-ADD##JDT     WN0023           RS Date Changed
     C                     Z-ADD##JTM     WN0024           RS Time Changed
     C                     MOVEL##JOB     WN0026           RS Job
     C                     MOVEL##PGM     WN0027           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSF    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSF    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YCRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSG     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WUM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    WUKHST           PP Commission P
     C                     MOVEL*BLANK    WUKJST           PP Payment Erro
     C                     Z-ADD*ZERO     WUPINB           PP Unused Nbr 1
     C                     MOVEL*BLANK    WUKKST           PP Repayment St
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACKDT    WUCKDT           Pmt Current Pay
     C                     Z-ADDWAM1NB    WUM1NB           Pmt Current Pay
     C                     MOVELWAKHST    WUKHST           PP Commission P
     C                     MOVELWAKJST    WUKJST           PP Payment Erro
     C                     Z-ADDWAPINB    WUPINB           PP Unused Nbr 1
     C                     MOVELWAKKST    WUKKST           PP Repayment St
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Payment Date/Step  CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0031  50       PP Unused Nbr 1
     C                     MOVEL*BLANK    WN0032  1        PP Repayment St
     C                     MOVEL*BLANK    WN0033 10        RS User Changed
     C                     Z-ADD*ZERO     WN0034  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0035  60       RS Time Changed
     C                     MOVEL*BLANK    WN0036  1        RS Record Statu
     C                     MOVEL*BLANK    WN0037 10        RS Job
     C                     MOVEL*BLANK    WN0038 10        RS Program
     C                     MOVEL*BLANK    WN0039 10        RS User Added
     C                     Z-ADD*ZERO     WN0040  70       RS Date Added
     C                     Z-ADD*ZERO     WN0041  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0033           RS User Changed
     C                     Z-ADD##JDT     WN0034           RS Date Changed
     C                     Z-ADD##JTM     WN0035           RS Time Changed
     C                     MOVEL##JOB     WN0037           RS Job
     C                     MOVEL##PGM     WN0038           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSH    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSH    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YDRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUB1DT    WBCKDT           Pmt Current Pay
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Step 6  Payment posting and producer Post/Create Producer Vouche
      *================================================================
      * CASE: WRK.Pmt Current Payment Step is Greater then or Equal 5
     C           WUM1NB    IFGE 00005                      *IF
     C                     Z-ADD00006     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SBCHRC
      * Prt Pay Chk Post Rep  PF - Tattoo Header  * 
     C                     CALL 'PKT1PFR'              90  Prt Pay Chk Pos
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0001  30       BOH Company Num
     C                     PARM WUCKDT    WQ0002  70       TH Kill Date
     C                     PARM 'P'       WQ0003  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0004 40        Oms System Valu
     C                     PARM 'U'       WQ0005  1        @Status Unpaid/
     C           WUKIST    PARM WUKIST    WQ0006  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKT1PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * This report will print a report by producer, and create checks
      * Prt Payment Edit/Post PF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDP1HONB    PAHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKS2PFR'              90  Prt Payment Edi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM 'P'       WQ0007  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0008 40        Oms System Valu
     C                     PARM 'U'       WQ0009  1        @Status Unpaid/
     C           WUKIST    PARM WUKIST    WQ0010  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKS2PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Pur-Jrn Prm/Final PF - Tattoo Header  * 
     C                     CLEARPBRC
     C                     Z-ADDP1HONB    PBHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PBB0DT           TH Kill Date
      *
     C                     CALL 'PKTTPFR'              90  Prt Pur-Jrn Prm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Tattoo Hea
     C                     PARM 'P'       WQ0011  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0012 40        Oms System Valu
     C                     PARM 'U'       WQ0013  1        @Status Unpaid/
     C           WUEKST    PARM WUEKST    WQ0014  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTTPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Pur-Jrn Resale    PF - Tattoo Header  * 
     C                     CLEARPCRC
     C                     Z-ADDP1HONB    PCHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PCB0DT           TH Kill Date
      *
     C                     CALL 'PKTZPFR'              90  Prt Pur-Jrn Rsl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Tattoo Hea
     C                     PARM 'P'       WQ0015  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0016 40        Oms System Valu
     C                     PARM 'U'       WQ0017  1        @Status Unpaid/
     C           WUEKST    PARM WUEKST    WQ0018  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD00007     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SCCHRC
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Carcass summary, carcass detail, & additional processing
      *================================================================
     C                     EXSR UCSUBR
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Upd Tto/Prd Lean Dist XF - Crc Sum Lean Dist Range  * 
     C                     CALL 'PKTDXFR'              90  Upd Tto/Prd Lea
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0019  30       BOH Company Num
     C                     PARM WUCKDT    WQ0020  70       TH Voucher Paym
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv/Prt Crc Sum       RT - Tattoo Header Driver  * 
     C                     EXSR SDRVGN
      * Prt Carcass Detail    PF - Tattoo Header Driver  * 
     C                     CALL 'PKTCPFR'              90  ZZt Carcass Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUN5NB    WQ0029  50       Tattoo Sequence
     C                     PARM 'N'       WQ0030  1        Print Carcass A
     C                     PARM P2EVTX    WQ0031 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTCPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD99999     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SFCHRC
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Step End of Job update payment date and step
      *================================================================
      * Chg Payment Date/Step  IF
      * This function will move either current kill
      * or next kill date to payment date, and set next number to zero.
      * This routine should only be used at the tail end of
      * the batch processing.
      * Rtv Payment Processing RT - Payment Processing Parms  * 
     C                     EXSR SGRVGN
      * CASE: PAR.Pmt Current Payment Step is 99999 Normal EOJ
     C           WUM1NB    IFEQ 99999                      *IF
      * Based on Payment date Get Next Current Kill date
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0032  30       CC Company Numb
     C                     PARM WUCKDT    WQ0033  70       Kill Date Usr
     C           WUB1DT    PARM *ZERO     WQ0034  70       Next Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         WUM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    WUKLST           Pmt Payment Err
     C                     MOVEL'N'       WUKHST           PP Commission P
      * Chg Payment Date/Step  CH - Payment Processing Parms  * 
     C                     EXSR SHCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * *ERROR PAYMENT STEP NOT AT END OF JOB
      * Send message 'Payment Processing Error'
     C                     MOVEL'PRK0436' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'PRK0436' W0RTN            *Return code
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Pmt Current Payment Date
     C                     Z-ADD*ZERO     WUCKDT  70
      * Define work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     WUM1NB  50
      * Define work field PP Commission Paym Error
     C                     MOVEL*BLANK    WUKHST  1
      * Define work field PP Payment Error
     C                     MOVEL*BLANK    WUKJST  1
      * Define work field PP Unused Nbr 1
     C                     Z-ADD*ZERO     WUPINB  50
      * Define work field PP Repayment Status
     C                     MOVEL*BLANK    WUKKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WAM1NB           Pmt Current Pay
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field @Payment Error
     C                     MOVEL*BLANK    WUKIST  1
      * Define work field @Payment Sts
     C                     MOVEL*BLANK    WUEKST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCN5NB           Tattoo Sequence
     C                     Z-ADD*ZERO     WCLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WCBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field TH Payment Type
     C                     MOVEL*BLANK    WUJ9ST  1
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Tattoo Sequence Number
     C                     Z-ADD*ZERO     WUN5NB  50
      * Define work field Current Kill Date
     C                     Z-ADD*ZERO     WUB1DT  70
      * Define work field Pmt Payment Error
     C                     MOVEL*BLANK    WUKLST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Carc Sum
00002 Prt CrcDtl
