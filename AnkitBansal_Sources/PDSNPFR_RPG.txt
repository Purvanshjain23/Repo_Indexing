     H/TITLE PRT Audit Report       PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSGOYA
     H* Date          : 03/20/25  Time  : 10:18:49
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FPDK9REL5IF  E           K        DISK
      * RSQ : AR Credit Check Audit     PNam,P#,SSD,CrHld,A/R,Co
      *
     FCABBRELCIF  E           K        DISK
      * RSQ : Customer Master           RSQ Parent # Active
      *
     FARBDCPLSIF  E           K        DISK
      * RSQ : AR Header New             Cust/Inv, sel inv,cm
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FPDLHCPLHIF  E           K        DISK
      * RSQ : Load Order Change Log     Load/Order/Type
      *
     FOPBFCPLWIF  E           K        DISK
      * RTV : Order Header TRG          Orders not Cancelled
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size new            Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPDSNPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Audit Report       PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L7         7  1
     E                    #L3         3  1
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
     I              ADQDSC                          WCQDSC
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WGRMNB
     I              FLRUNB                          WGRUNB
     I              FLRVNB                          WGRVNB
     I              FLDQTX                          WGDQTX
     I              FLRWNB                          WGRWNB
     I              FLRXNB                          WGRXNB
     I              FLSQNB                          WGSQNB
     I              FLT0NB                          WGT0NB
     I              FLT1NB                          WGT1NB
     I              FLR1NB                          WGR1NB
     I              FLAIC3                          WGAIC3
     I              FLC4NB                          WGC4NB
     I              FLVCST                          WGVCST
     I              FLKEDT                          WGKEDT
     I              FLSXNB                          WGSXNB
     I              FLKFDT                          WGKFDT
     I              FLACTM                          WGACTM
     I              FLK5TX                          WGK5TX
     I              FLW5CD                          WGW5CD
     I              FLEJDT                          WGEJDT
     I              FLAGTM                          WGAGTM
     I              FLKJDT                          WGKJDT
     I              FLATTM                          WGATTM
     I              FLHDDT                          WGHDDT
     I              FLAUTM                          WGAUTM
     I              FLKKDT                          WGKKDT
     I              FLAVTM                          WGAVTM
     I              FLZ4NB                          WGZ4NB
     I              FLY7ST                          WGY7ST
     I              FLY2ST                          WGY2ST
     I              FLWHTX                          WGWHTX
     I              FLWITX                          WGWITX
     I              FLWJTX                          WGWJTX
     I              FLWKTX                          WGWKTX
     I              FLWLTX                          WGWLTX
     I              FLN7DT                          WGN7DT
     I              FLN8DT                          WGN8DT
     I              FLN9DT                          WGN9DT
     I              FLB3TM                          WGB3TM
     I              FLB4TM                          WGB4TM
     I              FLB5TM                          WGB5TM
     I              FLIASX                          WGIASX
     I              FLIBSX                          WGIBSX
     I              FLICSX                          WGICSX
     I              FLWVTX                          WGWVTX
     I              FLWWTX                          WGWWTX
     I              FLWXTX                          WGWXTX
     I              FLUVST                          WGUVST
     I              FLUWST                          WGUWST
     I              FLUXST                          WGUXST
     I              FLAATM                          WGAATM
     I              FLAYNA                          WGAYNA
     I              FLA0NA                          WGA0NA
     I              FLAXDT                          WGAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PBRMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     IYBRDCS      DS                            793
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYCRDCS      DS                            793
      * Outward parameters
     IPCRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PCDXNB
      * I :  Load ID
     I                                    P  11  140PCRMNB
      * I :  Stop_Drop
     I                                    P  15  170PCRVNB
      * I :  Load Change Type
     I                                       18  23 PCRVST
      * I :  Department Control Code
     I                                       24  26 PCUJST
      * I :  Change Log Prior Value
     I                                       27  38 PCMNTX
      * I :  Change Log New Value
     I                                       39  50 PCMOTX
      * I :  User Id
     I                                       51  60 PCAYNA
      * I :  Job Name
     I                                       61  70 PCA0NA
      * I :  Carrier Code
     I                                       71  73 PCBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PCXMCD
      * I :  Company Number
     I                                    P  77  780PCAIC3
      * I :  Order Number
     I                                    P  79  820PCC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: AR Credit Check Audit
      * N :  Parent Credit Limit
     I                                    P   1   62P1S2NB
     IP2PARM      DS
      * N :  Ship Date Over Limit
     I                                    P   1   40P2J3DT
     IP3PARM      DS
      * N :  Accumilated Order Total
     I                                    P   1   62P3YXVA
     IP4PARM      DS
      * N :  A/R Balance Due
     I                                    P   1   62P4ABVA
     IP5PARM      DS
      * N :  USR Display field
     I                                        1   1 P5GGST
     IP6PARM      DS
      * FLD: Order Header TRG
      * N :  Header Status
     I                                        1   1 P6GWST
      * N :  Header Status Last
     I                                        2   2 P6GXST
      * N :  Credit Hold
     I                                        3   3 P6XIST
      * N :  Production Hold
     I                                        4   4 P6XJST
     IP7PARM      DS
      * N :  Production Date
     I                                    P   1   40P7ELDT
     IP8PARM      DS
      * I :  Status - Y or N
     I                                        1   1 P8B8ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0001
      * Application Code
     I                                       11  16 ZA0002
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0003
      * Application Code
     I                                       11  16 ZA0004
      * Message data for 'No Orders Assinged - INF'
      * Load ID
     I                                    P   1   40ZA0005
      * *SFLSEL
     I                                        5   5 ZA0006
      * Message data for 'Blck Ord on Ld-no UPD-INF'
      * *SFLSEL
     I                                        1   1 ZA0007
      * Load ID
     I                                    P   2   50ZA0008
      * Message data for 'Load Cant be Locked - INF'
      * *SFLSEL
     I                                        1   1 ZA0009
      * Load ID
     I                                    P   2   50ZA0010
      * Message data for 'Carrier must be ent.- INF'
      * Carrier Code
     I                                        1   3 ZA0011
      * Load ID
     I                                    P   4   70ZA0012
      * Message data for 'Truck size needed - INF'
      * Truck Size
     I                                        1   7 ZA0013
      * Load ID
     I                                    P   8  110ZA0014
      * Message data for 'Shipping Mthd req - INF'
      * Shipping Method
     I                                        1   2 ZA0015
      * Message data for 'Load has ords w/o stp-INF'
      * Load ID
     I                                    P   1   40ZA0016
      * Message data for 'Load is not accepted- INF'
      * Load ID
     I                                    P   1   40ZA0017
      * Message data for 'Load has Ords on Hold-INF'
      * Load ID
     I                                    P   1   40ZA0018
      * *SFLSEL
     I                                        5   5 ZA0019
      * Message data for 'Load has Cncld Ords - INF'
      * Load ID
     I                                    P   1   40ZA0020
      * *SFLSEL
     I                                        5   5 ZA0021
      * Message data for 'Load has Ords in Use-INF'
      * *SFLSEL
     I                                        1   1 ZA0022
      * Load ID
     I                                    P   2   50ZA0023
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0024
      * Load ID
     I                                    P   2   50ZA0025
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0026
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0027
      * USR CDE Parm 1
     I                                        4   6 ZA0028
      * USR CDE Parm 2
     I                                        7   9 ZA0029
      * USR CDE Parm 3
     I                                       10  12 ZA0030
      * USR CDE Parm 4
     I                                       13  15 ZA0031
      * USR CDE Parm 5
     I                                       16  18 ZA0032
      * USR CDE Parm 6
     I                                       19  21 ZA0033
      * USR CDE Parm 7
     I                                       22  24 ZA0034
      * USR CDE Parm 8
     I                                       25  27 ZA0035
      * USR CDE Parm 9
     I                                       28  30 ZA0036
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P8B8ST    PARM           WP0001  1        Status - Y or N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Audit Report       PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$EENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Audit Report       PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@K9REY2                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
     C                     MOVEL'Y'       P5GGST           USR Display fie
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Customer Name
     C                     MOVEL'Y'       W0AL01  1        Parent Number
     C                     MOVEL'Y'       W0AL02  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL03  1        Credit Hold
     C                     MOVEL'Y'       W0AL04  1        AR Customer Num
     C                     MOVEL'Y'       W0AL05  1        Company Number
     C                     MOVEL'Y'       W0AL06  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDK9AIC3    $BAIC3           Company Number
     C                     Z-ADDK9CHC7    $BCHC7           Parent Number
     C                     MOVELK9AYTX    $BAYTX           Customer Name
     C                     Z-ADD*ZERO     $BABVA           A/R Balance Due
     C                     Z-ADDK9S2NB    $BS2NB           Parent Credit L
      * Load related totals format
     C                     Z-ADDK9AIC3    $DAIC3           Company Number
     C                     Z-ADDK9CHC7    $DCHC7           Parent Number
      * USER: Process before print of Parent Number format
     C                     MOVELK9AYTX    $BAYTX           Customer Name
      * RMC 5/5/6 get a/r bal due from open invoices.. total both compani
      *   Read customer by parent to get their a/r custs
      * RTV Parent Exp f/hdr  RT - Customer  * 
     C                     EXSR SFRVGN
      * should I be using total exposure or A/R balance to into CUR.A/R B
     C                     Z-ADD*ZERO     P3YXVA           Accumilated Ord
     C                     Z-ADD$BABVA    P4ABVA           A/R Balance Due
     C                     Z-ADDK9S2NB    P1S2NB           Parent Credit L
     C                     Z-ADD*ZERO     P2J3DT           Ship Date Over
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP06  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDK9AODT    $CAODT           Scheduled Ship
     C                     Z-ADDK9ANC7    $CANC7           AR Customer Num
     C                     Z-ADDK9CHC7    $CCHC7           Parent Number
     C                     MOVELK9AYTX    $CAYTX           Customer Name
     C                     MOVELK9AQTX    $CAQTX           AR Customer Nam
     C                     Z-ADDK9BKC7    $CBKC7           Ship To Custome
     C                     MOVELK9BRTX    $CBRTX           Ship To Name
     C                     MOVELK9K6ST    $CK6ST           Credit Check AR
     C                     MOVELK9UZST    $CUZST           Credit Check Pa
     C                     Z-ADDK9AIC3    $CAIC3           Company Number
     C                     Z-ADDK9VHVA    $CVHVA           AR Credit Limit
     C                     Z-ADDK9S2NB    $CS2NB           Parent Credit L
     C                     MOVELK9JPCD    $CJPCD           Event Code
     C                     Z-ADDK9C4NB    $CC4NB           Order Number
     C                     MOVEL*BLANK    $CBCNA           Customer Purcha
     C                     MOVELK9JNCD    $CJNCD           Order Type_Sale
     C                     Z-ADDK9YVVA    $CYVVA           Order Total
     C                     MOVELK9GWST    $CGWST           Header Status
     C                     MOVELK9GXST    $CGXST           Header Status L
     C                     MOVELK9OBST    $COBST           Billing Activit
     C                     Z-ADD*ZERO     $CYXVA           Accumilated Ord
     C                     Z-ADD*ZERO     $CYWVA           Total Company E
     C                     Z-ADD*ZERO     $CJ3DT           Ship Date Over
     C                     MOVELK9QNST    $CQNST           Order Entry Hol
     C                     MOVEL*BLANK    $CORDC           Order Changed Y
     C                     MOVELK9XIST    $CXIST           Credit Hold
     C                     MOVEL*BLANK    $CCRHD           New Credit Hold
     C                     MOVEL*BLANK    $CFLAG           Load Locked ?
     C                     MOVELK9XJST    $CXJST           Production Hold
     C                     Z-ADDK9RMNB    $CRMNB           Load ID
     C                     MOVELK9PKST    $CPKST           Load Status
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * If Order Credit Hold is changing, process updating order
      * CASE: CUR.Order Changed Y/N is *YES
     C           $CORDC    IFEQ '*YES'                     *IF
     C                     MOVEL$CCRHD    P6XIST           Credit Hold
     C                     MOVEL$CXJST    P6XJST           Production Hold
      * Set Header Status
      * CASE: CUR.Header Status is Hold
     C           $CGWST    IFEQ 'H'                        *IF
      * Set status for currently held orders
      * CASE: CUR.Production Hold is Yes
     C           $CXJST    IFEQ 'Y'                        *IF
     C                     MOVEL$CGWST    P6GWST           Header Status
     C                     MOVEL$CGXST    P6GXST           Header Status L
     C                     ELSE
      * CASE: CUR.New Credit Hold is Yes
     C           $CCRHD    IFEQ 'Y'                        *IF
     C                     MOVEL$CGWST    P6GWST           Header Status
     C                     MOVEL$CGXST    P6GXST           Header Status L
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL$CGWST    P6GXST           Header Status L
     C                     MOVEL'A'       P6GWST           Header Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * order not currently held
      * Set status for currently available orders
      * CASE: CUR.Production Hold is Yes
     C           $CXJST    IFEQ 'Y'                        *IF
      * *** correct a problem with hold/status
     C                     MOVEL$CGWST    P6GXST           Header Status L
     C                     MOVEL'H'       P6GWST           Header Status
     C                     ELSE
      * CASE: CUR.New Credit Hold is Yes
     C           $CCRHD    IFEQ 'Y'                        *IF
     C                     MOVEL$CGWST    P6GXST           Header Status L
     C                     MOVEL'H'       P6GWST           Header Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL$CGXST    P6GXST           Header Status L
     C                     MOVEL$CGWST    P6GWST           Header Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CHG Sts/Lst,Holds      CH - PD Order Header  * 
     C                     EXSR SKCHRC
      * *--------------------------------------------------------------*
      * * 08/24/00 PKD C11184 Lock the Load if possible.
     C                     MOVEL'N'       YL0006           STATUS
      * * 09/20/2011 LJB P001251  Don't lock if errors pending in Ord Det
      * * 10/01/2009 LJB E00495   Don't lock if shipping after today
      * * 07/21/09 RMC FP1054 pass NO for the lock option override. dont
      *  if shipping later than tomorrow
      * 05/23/16 RMC E4119 remove live with tpm check
      * S026919 - Process to lock load without any validations
      * CASE: LCL.Environment Code is Seaboard Energy
     C           YL0005    IFEQ 'HPB'                      *IF
     C                     MOVEL'N'       YL0007           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0123  1        Load Status
     C                     Z-ADD*ZERO     WN0124  70       Total Load Orde
     C                     MOVEL*BLANK    WN0125  3        Carrier Code
     C                     MOVEL*BLANK    WN0126  7        Truck Size
     C                     MOVEL*BLANK    WN0127  2        Shipping Method
     C                     MOVEL*BLANK    WN0128  1        Load Acceptance
     C                     MOVEL*BLANK    WN0129  1        Block Order Fla
      *
      * EDT Lock Load Edit/INF IF
      * ** Chk for ord detail errors still pending  9.20.2011 P001251 LJB
      * ** Chg lock option override sts to *job date chk   8.23.09 E00495
      * ** Add lock option override sts for sched ship date chk  7.24.09
      * ** Add Override Total Load Miles - WRK context     E00207 8/13/08
      * RTV Load for Load Plan RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRMNB    WL0013           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    WUAODT           Scheduled Ship
     C                     MOVELWL0015    WN0123    P      Load Status
     C                     Z-ADDWL0016    WURNNB           Reefer Temperat
     C                     Z-ADDWL0017    WN0124           Total Load Orde
     C                     Z-ADDWL0018    WUFLAM           Flat Amount
     C                     MOVELWL0019    WUXQST    P      Allocate Pounds
     C                     MOVELWL0020    WN0125    P      Carrier Code
     C                     MOVELWL0021    WN0126    P      Truck Size
     C                     Z-ADDWL0022    WUR1NB           Rated Freight
     C                     MOVELWL0023    WUVDST    P      Load Type
     C                     Z-ADDWL0024    WUT4NB           Schedule Sequen
     C                     Z-ADDWL0025    WUTLMI           Total Load Mile
     C                     MOVELWL0026    WN0127    P      Shipping Method
     C                     MOVELWL0027    WUVPCD    P      Ship From Wareh
     C                     MOVELWL0028    WUDBCD    P      Ship To State C
     C                     MOVELWL0029    WUXCCD    P      Carrier Broker
     C                     MOVELWL0030    WN0128    P      Load Acceptance
     C                     Z-ADDWL0031    WUK2DT           Override Total
     C                     MOVELWL0032    WUWRTX    P      Shipping Temp C
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRMNB    WL0033           Load ID
     C                     MOVELWN0129    WL0035    P      Block Order Fla
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0034    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0035    WN0129    P      Block Order Fla
      *
     C                     Z-ADD*ZERO     WN0130  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0131  70       Minimum pounds
     C                     MOVEL*BLANK    WN0132  1        USR Orders on L
     C                     MOVEL*BLANK    WN0133  1        Order in Use
     C                     MOVEL*BLANK    WN0134  1        Header Status
     C                     MOVEL*BLANK    WN0135  1        Access Denied (
      *
      * EDT Lock Load Edits-INFIF
      * assume will have error
     C                     MOVEL'Y'       YL0007           Error Status
      *
     C                     MOVEL*BLANK    WN0136 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0136           User Profile Na
      *
     C                     MOVEL*BLANK    WN0137 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0136    WL0001    P      User Profile Na
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0003    WUG0TX    P      Default Printer
     C                     MOVELWL0004    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0005    YL0009           Company Number
     C                     MOVELWL0006    WN0137    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0137    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0136    WL0007    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0008    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WUAIC3           Company Number
     C                     MOVELWL0010    YL0010    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0137    WL0007    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0008    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WUAIC3           Company Number
     C                     MOVELWL0010    YL0010    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0010    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0009    IFGT 0                          *IF
     C                     Z-ADDYL0009    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0010    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0037           Shipping Compan
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0135           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0038           Company Number
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0135    IFEQ 'Y'                        *IF
      * Send message 'Usr Cant Lock/Unlk Ld-INF'
     C                     MOVEL'USR2543' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRMNB    WL0040           Load ID
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    WN0132    P      Status - Y or N
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD$CRMNB    ZA0005           Load ID
     C                     MOVELYL0008    ZA0006           *SFLSEL
      * Send message 'No Orders Assinged - INF'
     C                     MOVEL'USR2544' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0129    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVELYL0008    ZA0007           *SFLSEL
     C                     Z-ADD$CRMNB    ZA0008           Load ID
      * Send message 'Blck Ord on Ld-no UPD-INF'
     C                     MOVEL'USR2545' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           WN0123    IFEQ 'I'                        *IF
     C           WN0123    OREQ 'L'
     C           WN0123    OREQ 'S'
      * Setup message data for message
     C                     MOVELYL0008    ZA0009           *SFLSEL
     C                     Z-ADD$CRMNB    ZA0010           Load ID
      * Send message 'Load Cant be Locked - INF'
     C                     MOVEL'USR2546' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.STATUS is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0125    IFEQ WUGSTX                     *IF
     C           YL0006    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELWN0125    ZA0011           Carrier Code
     C                     Z-ADD$CRMNB    ZA0012           Load ID
      * Send message 'Carrier must be ent.- INF'
     C                     MOVEL'USR2547' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           WN0126    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0126    ZA0013           Truck Size
     C                     Z-ADD$CRMNB    ZA0014           Load ID
      * Send message 'Truck size needed - INF'
     C                     MOVEL'USR2548' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           WN0127    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0127    ZA0015           Shipping Method
      * Send message 'Shipping Mthd req - INF'
     C                     MOVEL'USR2549' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0132    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD$CRMNB    ZA0016           Load ID
      * Send message 'Load has ords w/o stp-INF'
     C                     MOVEL'USR2550' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           WN0128    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD$CRMNB    ZA0017           Load ID
      * Send message 'Load is not accepted- INF'
     C                     MOVEL'USR2551' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRMNB    WL0044           Load ID
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    WN0133    P      Order in Use
     C                     MOVELWL0043    WN0134    P      Header Status
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0134    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD$CRMNB    ZA0018           Load ID
     C                     MOVELYL0008    ZA0019           *SFLSEL
      * Send message 'Load has Ords on Hold-INF'
     C                     MOVEL'USR2552' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0134    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD$CRMNB    ZA0020           Load ID
     C                     MOVELYL0008    ZA0021           *SFLSEL
      * Send message 'Load has Cncld Ords - INF'
     C                     MOVEL'USR2553' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0133    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELYL0008    ZA0022           *SFLSEL
     C                     Z-ADD$CRMNB    ZA0023           Load ID
      * Send message 'Load has Ords in Use-INF'
     C                     MOVEL'USR2554' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRMNB    WL0045           Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    YL0012    P      Order Requires
      * ** Check for errors in Export Order Automation Upload   P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0012    IFEQ 'Y'                        *IF
      * ** Cannot lock load if errors in Order Detail         P001251
      * Setup message data for message
     C                     MOVELYL0008    ZA0024           *SFLSEL
     C                     Z-ADD$CRMNB    ZA0025           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0126    WL0047    P      Truck Size
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0048    WN0130           Maximum pounds
     C                     Z-ADDWL0049    WN0131           Minimum pounds
      * Do not want to lock the load if the Load Weight is not
      * within range.  -Purva 5/5/99 C0007042
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           WN0124    IFLT WN0131                     *IF
      * Setup message data for message
     C                     Z-ADD$CRMNB    ZA0026           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0007           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           WN0124    IFGT WN0130                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0007           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Sched ship date if not called from a LOCK option  FP1054 7/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Lock option override sts is No
      *   |- c2    : PAR.Scheduled Ship Date GT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'N'       IFEQ 'N'                        *IF
     C           WUAODT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0007           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       YL0007           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
     C                     END                             *FI
      * CASE: LCL.Error Status is no
     C           YL0007    IFEQ 'N'                        *IF
      *
     C                     Z-ADD*ZERO     WN0138  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0139 112       Flat Amount
     C                     Z-ADD*ZERO     WN0140  50       Total Stops
     C                     Z-ADD*ZERO     WN0141  70       Total Load Mile
     C                     MOVEL*BLANK    WN0142  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0143  2        Ship To State C
     C                     MOVEL*BLANK    WN0144  3        Carrier Broker
     C                     MOVEL*BLANK    WN0145  1        Export Status
     C                     MOVEL*BLANK    WN0146  3        Shipping Line
     C                     MOVEL*BLANK    WN0147 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0148  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0149  60       Deadline Depart
     C                     MOVEL*BLANK    WN0150  1        MG Created Load
     C                     MOVEL*BLANK    WN0151  2        Load U_M
     C                     MOVEL*BLANK    WN0152  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0153 20        Destination Cit
     C                     MOVEL*BLANK    WN0154  2        State Code
     C                     MOVEL*BLANK    WN0155  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0156  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0157  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0158  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0159  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0160  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0161  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0162  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0163  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0164  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0165 155       Company Number
     C                     Z-ADD*ZERO     WN0166 155       Date 1
     C                     Z-ADD*ZERO     WN0167 155       Order Number 1
     C                     Z-ADD*ZERO     WN0168  40       Requested Deliv
     C                     MOVEL*BLANK    WN0169  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
     C                     EXSR STRVGN
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0142    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR SURVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0150    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
     C                     EXSR SZRVGN
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0148           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
     C                     EXSR TARVGN
     C           WN0168    MULT 100       WN0149           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0315  51       Hours Required
     C                     Z-ADD*ZERO     WN0316  50       Miles to next s
     C                     Z-ADD*ZERO     WN0317  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0318  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0319  50       @Days 5
     C                     Z-ADD*ZERO     WN0320  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0321  20       USR Period
     C                     Z-ADD*ZERO     WN0322  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0323  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR TCRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0013    IFEQ 'CT'                       *IF
     C           YL0013    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRMNB    WL0050           Load ID
     C                     Z-ADD*ZERO     WL0051           Stop_Drop
     C                     Z-ADD*ZERO     WL0052           Order Number
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WN0316           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0316    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD$CRMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0005  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0006  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CRMNB    WL0050           Load ID
     C                     Z-ADD*ZERO     WL0051           Stop_Drop
     C                     Z-ADD*ZERO     WL0052           Order Number
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WN0316           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0316    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0148           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0149           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0315           Hours Required
     C                     Z-ADD*ZERO     YL0014           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR TERVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CRMNB    WQ0007  70       Load ID
     C           YL0015    PARM YL0015    WQ0008  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0014    ADD  YL0015    WN0315           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0315    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0315    DIV  24        WN0319           @Days 5
     C           WN0319    MULT 24        WU               USR Hours 5.0
     C           WN0315    SUB  WU        WN0317           USR Hours 5.0
     C           WN0317    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0319    IFGT 0                          *IF
     C                     MULT -1        WN0319           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0148    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0319    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0148
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0148
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0149                     *IF
     C                     SUB  WN0149    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0319           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0148    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0319    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0148
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0148
     C                     END
     C           240000    SUB  WUPINB    WN0149           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0149           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
     C                     EXSR TGRVGN
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0140    IFEQ 1                          *IF
     C           WN0139    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
     C                     EXSR TIRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0153    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0153           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UDSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
     C                     EXSR TKCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0138    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR TLRVGN
     C                     Z-ADD$CAIC3    WN0165           Company Number
     C                     Z-ADD$CRMNB    WN0167           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0138    WN0166           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0155    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0169    PARM *BLANK    WQ0011  7        Return Code Usr
     C                     PARM 'OMS'     WQ0012  6        Application Cod
     C                     PARM @CN,003   WQ0013 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0014  1        USR Detail or S
     C                     PARM @CN,004   WQ0015 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0016 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0017  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0018  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0019  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0020 10        PRT Night Queue
     C           WN0165    PARM WN0165    WQ0021 155       Company Number
     C           WN0166    PARM WN0166    WQ0022 155       Date 1
     C           WN0167    PARM WN0167    WQ0023 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0024 155       System Value Nu
     C           WN0155    PARM WN0155    WQ0025  3        USR Warehouse C
     C           WN0156    PARM WN0156    WQ0026  3        USR CDE Parm 1
     C           WN0157    PARM WN0157    WQ0027  3        USR CDE Parm 2
     C           WN0158    PARM WN0158    WQ0028  3        USR CDE Parm 3
     C           WN0159    PARM WN0159    WQ0029  3        USR CDE Parm 4
     C           WN0160    PARM WN0160    WQ0030  3        USR CDE Parm 5
     C           WN0161    PARM WN0161    WQ0031  3        USR CDE Parm 6
     C           WN0162    PARM WN0162    WQ0032  3        USR CDE Parm 7
     C           WN0163    PARM WN0163    WQ0033  3        USR CDE Parm 8
     C           WN0164    PARM WN0164    WQ0034  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0035  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0036  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0461  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
     C                     EXSR TNRVGN
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR TRRVGN
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0016    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0461    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0037  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  Zzz AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CRMNB    WQ0038  70       Load ID
     C                     PARM $CAIC3    WQ0039  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0040  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0017    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CRMNB    WQ0041  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CRMNB    WQ0042  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0138    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0155    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0155    WQ0043  3        Warehouse Code
     C                     PARM *BLANK    WQ0044 10        Default Printer
     C           YL0018    PARM *BLANK    WQ0045  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0018    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0155    ZA0027           USR Warehouse C
     C                     MOVELWN0156    ZA0028           USR CDE Parm 1
     C                     MOVELWN0157    ZA0029           USR CDE Parm 2
     C                     MOVELWN0158    ZA0030           USR CDE Parm 3
     C                     MOVELWN0159    ZA0031           USR CDE Parm 4
     C                     MOVELWN0160    ZA0032           USR CDE Parm 5
     C                     MOVELWN0161    ZA0033           USR CDE Parm 6
     C                     MOVELWN0162    ZA0034           USR CDE Parm 7
     C                     MOVELWN0163    ZA0035           USR CDE Parm 8
     C                     MOVELWN0164    ZA0036           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UESUBR                     ***** Change Lo
      * RTV Load Header       RT - Load Header  * 
     C                     EXSR TSRVGN
     C                     MOVEL*BLANK    YL0021           Load Change Typ
     C                     MOVEL'LOCK'    YL0021           Load Change Typ
     C                     MOVEL'TRF'     YL0022           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD$CRMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop_Drop
     C                     MOVELYL0021    PCRVST    P      Load Change Typ
     C                     MOVELYL0022    PCUJST    P      Department Cont
     C                     MOVELYL0019    PCMNTX    P      Change Log Prio
     C                     MOVEL'L'       PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVELYL0020    PCBZNA    P      Carrier Code
     C                     Z-ADD$CAIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *--------------------------------------------------------------*
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN K9AYTX    WZA001           Customer Name
     C                     MOVELK9AYTX    WZA001
     C           *LIKE     DEFN K9CHC7    WZA002           Parent Number
     C                     Z-ADDK9CHC7    WZA002
     C           *LIKE     DEFN K9AODT    WZA003           Scheduled Ship
     C                     Z-ADDK9AODT    WZA003
     C           *LIKE     DEFN K9XIST    WZA004           Credit Hold
     C                     MOVELK9XIST    WZA004
     C           *LIKE     DEFN K9ANC7    WZA005           AR Customer Num
     C                     Z-ADDK9ANC7    WZA005
     C           *LIKE     DEFN K9AIC3    WZA006           Company Number
     C                     Z-ADDK9AIC3    WZA006
     C           *LIKE     DEFN K9C4NB    WZA007           Order Number
     C                     Z-ADDK9C4NB    WZA007
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @K9REY2                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Customer Name
     C                     MOVEL*BLANK    W0AL01  1        Parent Number
     C                     MOVEL*BLANK    W0AL02  1        Scheduled Ship
     C                     MOVEL*BLANK    W0AL03  1        Credit Hold
     C                     MOVEL*BLANK    W0AL04  1        AR Customer Num
     C                     MOVEL*BLANK    W0AL05  1        Company Number
     C                     MOVEL*BLANK    W0AL06  1        Order Number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Customer Name
     C                     MOVEL'Y'       W0AL01  1        Parent Number
     C                     MOVEL'Y'       W0AL02  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL03  1        Credit Hold
     C                     MOVEL'Y'       W0AL04  1        AR Customer Num
     C                     MOVEL'Y'       W0AL05  1        Company Number
     C                     MOVEL'Y'       W0AL06  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           K9AYTX    IFNE WZA001                     Customer Name
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           K9CHC7    IFNE WZA002                     Parent Number
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           K9AODT    IFNE WZA003                     Scheduled Ship
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           K9XIST    IFNE WZA004                     Credit Hold
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           K9ANC7    IFNE WZA005                     AR Customer Num
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           K9AIC3    IFNE WZA006                     Company Number
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C           K9C4NB    IFNE WZA007                     Order Number
     C           W0AL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL06
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP06
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$DKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Audit Report       PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Customer Name of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Parent Number of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Convert fields to external form
      * Convert Parent Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BCHC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BCHC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBCHC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBCHC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$BKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Scheduled Ship Date of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Credit Hold of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print AR Customer Number of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Company Number of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print Order Number of PRT Audit Report       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP06
     C                     END                             FI
      * Print Detail line. of PRT Audit Report       PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RTV System Value Alpha RT - System Values  * 
     C                     EXSR SHRVGN
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0004:ZQ YL0005    P  90  Environment Cod
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ADD  $CYVVA    P3YXVA           Accumilated Ord
     C                     Z-ADDP3YXVA    $CYXVA           Accumilated Ord
     C           P4ABVA    ADD  P3YXVA    $CYWVA           Total Company E
      * Set up ship date over limit when exceed parent credit limit
      * CASE: PAR.Ship Date Over Limit EQ WRK.ZERO
     C           P2J3DT    IFEQ WUW0NB                     *IF
      * CASE: CUR.Total Company Exposure GT PAR.Parent Credit Limit
     C           $CYWVA    IFGT P1S2NB                     *IF
     C                     Z-ADD$CAODT    P2J3DT           Ship Date Over
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDP2J3DT    $CJ3DT           Ship Date Over
      * * See if order has been Credit Released               E003028
      * VAL Ld/Ord/Type exists RT - Load Order Change Log  * 
     C                     EXSR SIRVGN
      * S026919 - For Seaboard Energy, credit release all orders
      * CASE: LCL.Environment Code is Seaboard Energy
     C           YL0005    IFEQ 'HPB'                      *IF
      * Credit hold update
      * CASE: CUR.Credit Hold is Yes
     C           $CXIST    IFEQ 'Y'                        *IF
     C                     MOVEL'*YES'    $CORDC           Order Changed Y
     C                     MOVEL'N'       $CCRHD           New Credit Hold
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CORDC           Order Changed Y
     C                     MOVEL'*NO'     $CORDC           Order Changed Y
     C                     MOVEL$CXIST    $CCRHD           New Credit Hold
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * New Credit Hold, Order Changed flags
      * CASE: CUR.Credit Hold is No
     C           $CXIST    IFEQ 'N'                        *IF
      * Current Credit Hold = N
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CUR.Scheduled Ship Date LE PAR.Production Date
      *   |- c2    : CUR.Load Status is Locked thru Invoiced
      *   '-
     C           $CAODT    IFLE P7ELDT                     *IF
     C           $CPKST    OREQ 'I'                        *OR
     C           $CPKST    OREQ 'L'
     C           $CPKST    OREQ 'S'
     C                     MOVEL*BLANK    $CORDC           Order Changed Y
     C                     MOVEL'*NO'     $CORDC           Order Changed Y
     C                     MOVEL$CXIST    $CCRHD           New Credit Hold
     C                     ELSE
      * CASE: CUR.Total Company Exposure LE PAR.Parent Credit Limit
     C           $CYWVA    IFLE P1S2NB                     *IF
     C                     MOVEL*BLANK    $CORDC           Order Changed Y
     C                     MOVEL'*NO'     $CORDC           Order Changed Y
     C                     MOVEL$CXIST    $CCRHD           New Credit Hold
     C                     ELSE
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,002                    *IF
      * * Skip if this order has already be Credit Released   E003028
      * * This is not an error
     C                     MOVEL*BLANK    $CORDC           Order Changed Y
     C                     MOVEL'*NO'     $CORDC           Order Changed Y
     C                     MOVEL$CXIST    $CCRHD           New Credit Hold
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    $CORDC           Order Changed Y
     C                     MOVEL'Y'       $CCRHD           New Credit Hold
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Current Credit Hold = Y
      * CASE: CUR.Total Company Exposure LE PAR.Parent Credit Limit
     C           $CYWVA    IFLE P1S2NB                     *IF
     C                     MOVEL'*YES'    $CORDC           Order Changed Y
     C                     MOVEL'N'       $CCRHD           New Credit Hold
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CORDC           Order Changed Y
     C                     MOVEL'*NO'     $CORDC           Order Changed Y
     C                     MOVEL$CXIST    $CCRHD           New Credit Hold
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Load Locked ? set up
      * CASE: CUR.Load Status is Locked thru Invoiced
     C           $CPKST    IFEQ 'I'                        *IF
     C           $CPKST    OREQ 'L'
     C           $CPKST    OREQ 'S'
     C                     MOVEL'*YES'    $CFLAG           Load Locked ?
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CFLAG           Load Locked ?
     C                     MOVEL'*NO'     $CFLAG           Load Locked ?
     C                     END                             *FI
      * RTV Purchase Order     RT - Order Header TRG  * 
     C                     EXSR SJRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $CAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCAODT
      * Convert AR Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCANC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship Date Over Limit to display format
      * Convert date
     C           1000000   ADD  $CJ3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCJ3DT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Audit Report       PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Customer Name of PRT Audit Report       PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Parent Number of PRT Audit Report       PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Scheduled Ship Date of PRT Audit Report       PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Credit Hold of PRT Audit Report       PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * AR Customer Number of PRT Audit Report       PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Audit Report       PF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Audit Report       PF
     C           W0AP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Audit Report       PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD5         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0001    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0002           Allow Multi_Com
     C                     MOVELDRMPNA    WL0003           Default Printer
     C                     MOVELDRBCCD    WL0004           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0005           Company Number
     C                     MOVELDRBUVN    WL0006           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0007    DTAJVN           User Profile Na
     C                     MOVELWL0008    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0009           Company Number
     C                     MOVELDTAJCD    WL0010           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSC01           Application Cod
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Application Cod
      * Setup key
     C                     MOVELWL0011    WQSC01           Application Cod
      * Establish starting position
     C           KRSSC     SETLL@DNRESF                    *
     C           KRSSC     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WL0012           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C           KRSSC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSD01           Application Cod
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSD01           Application Cod
      * Establish starting position
     C           KRSSD     SETLL@DNRESF                    *
     C           KRSSD     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0012           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WL0012           Description
     C           KRSSD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Next/Eq Prod Date  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSE01           Company Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
      * Setup key
     C                     Z-ADDYL0001    WQSE01           Company Number
     C                     Z-ADD##JDT     AFBCDT           Post to G_L Dat
      * Establish starting position
     C           KPSSE     SETLL@AFREBE                    *
     C           KRSSE     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P7ELDT           Production Date
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Production Day Status is yes
     C           AFWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDAFBCDT    P7ELDT           Production Date
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Parent Exp f/hdr  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Initialize Parameters
     C                     Z-ADD*ZERO     $BABVA           Total Company E
      * Declare restrictor key work fields
     C           *LIKE     DEFN BBBTC7    WQSF01           Parent Customer
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Parent Customer
      * Setup key
     C                     Z-ADDK9CHC7    WQSF01           Parent Customer
      * Establish starting position
     C           KRSSF     SETLL@BBREXK                    *
     C           KRSSF     READE@BBREXK                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Here is where we check if confirmed customer
      * CASE: PAR.Parent Customer EQ DB1.Parent Customer
     C           K9CHC7    IFEQ BBBTC7                     *IF
      * A/R Customers only
      * CASE: DB1.Ship To Customer EQ DB1.A/R Customer Number
     C           BBBKC7    IFEQ BBANC7                     *IF
      * RTV Cust Open Inv Ttl RT - A/R Header  * 
     C                     EXSR SGRVGN
     C                     ADD  WUBGVA    $BABVA           Total Company E
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BBREXK                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Cust Open Inv Ttl RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUBGVA           Remaining Balan
      * Declare restrictor key work fields
     C           *LIKE     DEFN BDANC7    WQSG01           AR Customer Num
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           AR Customer Num
      * Setup key
     C                     Z-ADDBBANC7    WQSG01           AR Customer Num
      * Establish starting position
     C           KRSSG     SETLL@BDCPYC                    *
     C           KRSSG     READE@BDCPYC                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  BDBGVA    WUBGVA           Remaining Balan
     C           KRSSG     READE@BDCPYC                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVE *BLANK    DPDOCD           System Value Co
     C                     MOVEL'DTALIB'  DPDOCD           System Value Co
      * Establish starting position
     C           KRSSH     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           System Value Al
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    YL0004           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * VAL Ld/Ord/Type exists RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN LHRMNB    WQSI01           Load ID
     C           *LIKE     DEFN LHC4NB    WQSI02           Order Number
     C           *LIKE     DEFN LHRVST    WQSI03           Load Change Typ
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Load ID
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Load Change Typ
      * Setup key
     C                     Z-ADD$CRMNB    WQSI01           Load ID
     C                     Z-ADD$CC4NB    WQSI02           Order Number
     C                     MOVEL'CRDRLS'  WQSI03           Load Change Typ
      * Establish starting position
     C           KRSSI     SETLL@LHCPHB                    *
     C           KRSSI     READE@LHCPHB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSI     READE@LHCPHB                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Purchase Order     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD$CAIC3    BEAIC3           Company Number
     C                     Z-ADD$CC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BFCPZ9              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBCNA    $CBCNA           Customer Purcha
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG Sts/Lst,Holds      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0004  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0005  70       Ship To Custome
     C                     MOVEL*BLANK    WN0006 30        Ship To Name
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 30        Ship To Address
     C                     MOVEL*BLANK    WN0009 30        Ship To Address
     C                     MOVEL*BLANK    WN0010 20        Ship To City
     C                     MOVEL*BLANK    WN0011  2        Ship To State C
     C                     MOVEL*BLANK    WN0012 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0013  70       Bill to Custome
     C                     MOVEL*BLANK    WN0014 30        Bill to Name
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 30        Bill to Address
     C                     MOVEL*BLANK    WN0017 30        Bill to Address
     C                     MOVEL*BLANK    WN0018 20        Bill to City
     C                     MOVEL*BLANK    WN0019  2        Bill to State C
     C                     MOVEL*BLANK    WN0020 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0021 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0022  70       Order Date
     C                     Z-ADD*ZERO     WN0023  70       Requested Ship
     C                     Z-ADD*ZERO     WN0024  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0025  70       Cancel Date
     C                     MOVEL*BLANK    WN0026  2        Terms Code
     C                     MOVEL*BLANK    WN0027 40        Special Instruc
     C                     MOVEL*BLANK    WN0028 40        Special Instruc
     C                     MOVEL*BLANK    WN0029  3        Carrier Code
     C                     MOVEL*BLANK    WN0030  1        Comment Print A
     C                     MOVEL*BLANK    WN0031  1        Comment Print I
     C                     MOVEL*BLANK    WN0032  1        Comment Print P
     C                     MOVEL*BLANK    WN0033  1        Comment Print S
     C                     MOVEL*BLANK    WN0034  3        Reason Code
     C                     MOVEL*BLANK    WN0035  1        Order in Use
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0043  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0044  40       Requested Deliv
     C                     MOVEL*BLANK    WN0045  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0046 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0047  70       Load ID
     C                     Z-ADD*ZERO     WN0048  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0049 112       Rated Freight
     C                     MOVEL*BLANK    WN0050  1        LTL Flag
     C                     MOVEL*BLANK    WN0051  1        Price Audit
     C                     MOVEL*BLANK    WN0052  1        Price Status
     C                     MOVEL*BLANK    WN0053  2        Shipping Method
     C                     MOVEL*BLANK    WN0054  1        Export Status
     C                     MOVEL*BLANK    WN0055  1        Palletize
     C                     MOVEL*BLANK    WN0056  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0057  1        Slip Sheet
     C                     MOVEL*BLANK    WN0058  1        Age Code
     C                     Z-ADD*ZERO     WN0059  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0060  1        Load Type
     C                     Z-ADD*ZERO     WN0061  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0062  1        Load Plan Order
     C                     MOVEL*BLANK    WN0063  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0064  70       Resell Referenc
     C                     MOVEL*BLANK    WN0065 30        Special Comment
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0068  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0069  2        Manager Level C
     C                     MOVEL*BLANK    WN0070  3        VP Level Code
     C                     Z-ADD*ZERO     WN0071  70       Attach to Order
     C                     MOVEL*BLANK    WN0072  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0073  70       Invoice Number
     C                     MOVEL*BLANK    WN0074  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0075  70       Invoice Date
     C                     MOVEL*BLANK    WN0076  2        Event Code
     C                     MOVEL*BLANK    WN0077  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0078  1        Modified Flag
     C                     Z-ADD*ZERO     WN0079 112       A_R order Value
     C                     MOVEL*BLANK    WN0080  1        Billing Activit
     C                     MOVEL*BLANK    WN0081  1        Block Order Fla
     C                     MOVEL*BLANK    WN0082  1        Order Certifica
     C                     Z-ADD*ZERO     WN0083 112       Invoice Order V
     C                     MOVEL*BLANK    WN0084  1        Process Sts for
     C                     MOVEL*BLANK    WN0085  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0086  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0087  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0088  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0089  1        Email Cust On O
     C                     MOVEL*BLANK    WN0090  1        Order Emailed
     C                     MOVEL*BLANK    WN0091  1        Export Docs Go
     C                     MOVEL*BLANK    WN0092  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0093  1        Broker Order St
     C                     MOVEL*BLANK    WN0094  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0095  2        Order Requires
     C                     MOVEL*BLANK    WN0096  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0097  2        Export USDA App
     C                     MOVEL*BLANK    WN0098  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0099  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0100  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0101  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0102  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0103  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0104  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0105  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0106  60       Time of Origina
     C                     Z-ADD*ZERO     WN0107  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0108  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0109  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0110 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0111 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0112 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0113 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0114 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0115  70       Claim Number
     C                     MOVEL*BLANK    WN0116  1        EDI Status 1
     C                     MOVEL*BLANK    WN0117  1        EDI Status 2
     C                     MOVEL*BLANK    WN0118  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0119  60       Job Time
     C                     MOVEL*BLANK    WN0120 10        User Id
     C                     MOVEL*BLANK    WN0121 10        Job Name
     C                     Z-ADD*ZERO     WN0122  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD$CAIC3    WAAIC3           Company Number
     C                     Z-ADD$CC4NB    WAC4NB           Order Number
      *
     C           KLCHSK    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C           KLCHSK    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELP6GWST    WAGWST    P      Header Status
     C                     MOVELP6GXST    WAGXST    P      Header Status L
     C                     MOVELP6XIST    WAXIST    P      Credit Hold
     C                     MOVELP6XJST    WAXJST    P      Production Hold
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
     C                     MOVELWAJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWAANC7    PAANC7           AR Customer Num
     C                     Z-ADDWABKC7    PABKC7           Ship To Custome
     C                     MOVELWABRTX    PABRTX    P      Ship To Name
     C                     MOVELWAHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWAHONA    PAHONA    P      Ship To Address
     C                     MOVELWAHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWAHNNA    PAHNNA    P      Ship To City
     C                     MOVELWADBCD    PADBCD    P      Ship To State C
     C                     MOVELWACKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWAB0C7    PAB0C7           Bill to Custome
     C                     MOVELWAAETX    PAAETX    P      Bill to Name
     C                     MOVELWAB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWAB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWAB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWAB2NA    PAB2NA    P      Bill to City
     C                     MOVELWABHCD    PABHCD    P      Bill to State C
     C                     MOVELWAC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWABCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWAA0DT    PAA0DT           Order Date
     C                     Z-ADDWAA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWAGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWAACDT    PAACDT           Cancel Date
     C                     MOVELWAAQCD    PAAQCD    P      Terms Code
     C                     MOVELWAB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWABYNA    PABYNA    P      Special Instruc
     C                     MOVELWABZNA    PABZNA    P      Carrier Code
     C                     MOVELWAGTST    PAGTST    P      Comment Print A
     C                     MOVELWAGVST    PAGVST    P      Comment Print I
     C                     MOVELWAGUST    PAGUST    P      Comment Print P
     C                     MOVELWAQFST    PAQFST    P      Comment Print S
     C                     MOVELWACQCD    PACQCD    P      Reason Code
     C                     MOVELWAGJST    PAGJST    P      Order in Use
     C                     MOVELWAGWST    PAGWST    P      Header Status
     C                     MOVELWAGXST    PAGXST    P      Header Status L
     C                     MOVELWAGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWAAODT    PAAODT           Scheduled Ship
     C                     MOVELWAAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWACXDT    PACXDT           Date of Origina
     C                     Z-ADDWAJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWAA1WG    PAA1WG           Order Weight To
     C                     MOVELWAXIST    PAXIST    P      Credit Hold
     C                     MOVELWAXJST    PAXJST    P      Production Hold
     C                     MOVELWAXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWAEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWAAFTM    PAAFTM           Requested Deliv
     C                     MOVELWAE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWAE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWARMNB    PARMNB           Load ID
     C                     Z-ADDWATBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWAR1NB    PAR1NB           Rated Freight
     C                     MOVELWAPJST    PAPJST    P      LTL Flag
     C                     MOVELWAU0ST    PAU0ST    P      Price Audit
     C                     MOVELWAU1ST    PAU1ST    P      Price Status
     C                     MOVELWAQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWAU2ST    PAU2ST    P      Export Status
     C                     MOVELWAVEST    PAVEST    P      Palletize
     C                     MOVELWAVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWAVGST    PAVGST    P      Slip Sheet
     C                     MOVELWARPCD    PARPCD    P      Age Code
     C                     Z-ADDWARNNB    PARNNB           Reefer Temperat
     C                     MOVELWAVDST    PAVDST    P      Load Type
     C                     Z-ADDWAATIN    PAATIN           Attach to Invoi
     C                     MOVELWAU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWAU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWARSRN    PARSRN           Resell Referenc
     C                     MOVELWAMHNA    PAMHNA    P      Special Comment
     C                     MOVELWAMINA    PAMINA    P      Special Comment
     C                     MOVELWAWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWAR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWABFCD    PABFCD    P      Manager Level C
     C                     MOVELWAQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWAT3NB    PAT3NB           Attach to Order
     C                     MOVELWASICD    PASICD    P      Reason for Pric
     C                     Z-ADDWACONB    PACONB           Invoice Number
     C                     MOVELWACEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWAAWDT    PAAWDT           Invoice Date
     C                     MOVELWAJPCD    PAJPCD    P      Event Code
     C                     MOVELWAXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWAZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWAVRVA    PAVRVA           A_R order Value
     C                     MOVELWAOBST    PAOBST    P      Billing Activit
     C                     MOVELWABCST    PABCST    P      Block Order Fla
     C                     MOVELWABDST    PABDST    P      Order Certifica
     C                     Z-ADDWAB7VL    PAB7VL           Invoice Order V
     C                     MOVELWAGASX    PAGASX    P      Process Sts for
     C                     MOVELWAGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWAGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWAGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWAFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWAFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWAFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWAFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWAFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWAFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWAFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWAFUSX    PAFUSX    P      Order Requires
     C                     MOVELWAFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWAFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWAFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWAFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWANODT    PANODT           OH Appt Confirm
     C                     Z-ADDWANPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWANQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWANRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWANSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWABPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWABQTM    PABQTM           Time of Origina
     C                     Z-ADDWABRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWABSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWABTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWAH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWAH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWAH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWAH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWAH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWAC0C7    PAC0C7           Claim Number
     C                     MOVELWAUVST    PAUVST    P      EDI Status 1
     C                     MOVELWAUWST    PAUWST    P      EDI Status 2
     C                     MOVELWAUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWAAATM    PAAATM           Job Time
     C                     MOVELWAAYNA    PAAYNA    P      User Id
     C                     MOVELWAA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWAAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0013    FJRMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0014           Scheduled Ship
     C                     MOVEL*BLANK    WL0015           Load Status
     C                     Z-ADD*ZERO     WL0016           Reefer Temperat
     C                     Z-ADD*ZERO     WL0017           Total Load Orde
     C                     Z-ADD*ZERO     WL0018           Flat Amount
     C                     MOVEL*BLANK    WL0019           Allocate Pounds
     C                     MOVEL*BLANK    WL0020           Carrier Code
     C                     MOVEL*BLANK    WL0021           Truck Size
     C                     Z-ADD*ZERO     WL0022           Rated Freight
     C                     MOVEL*BLANK    WL0023           Load Type
     C                     Z-ADD*ZERO     WL0024           Schedule Sequen
     C                     Z-ADD*ZERO     WL0025           Total Load Mile
     C                     MOVEL*BLANK    WL0026           Shipping Method
     C                     MOVEL*BLANK    WL0027           Ship From Wareh
     C                     MOVEL*BLANK    WL0028           Ship To State C
     C                     MOVEL*BLANK    WL0029           Carrier Broker
     C                     MOVEL*BLANK    WL0030           Load Acceptance
     C                     Z-ADD*ZERO     WL0031           Override Total
     C                     MOVEL*BLANK    WL0032           Shipping Temp C
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WL0014           Scheduled Ship
     C                     MOVELFJPKST    WL0015           Load Status
     C                     Z-ADDFJRNNB    WL0016           Reefer Temperat
     C                     Z-ADDFJRPNB    WL0017           Total Load Orde
     C                     Z-ADDFJFLAM    WL0018           Flat Amount
     C                     MOVELFJXQST    WL0019           Allocate Pounds
     C                     MOVELFJBZNA    WL0020           Carrier Code
     C                     MOVELFJRONB    WL0021           Truck Size
     C                     Z-ADDFJR1NB    WL0022           Rated Freight
     C                     MOVELFJVDST    WL0023           Load Type
     C                     Z-ADDFJT4NB    WL0024           Schedule Sequen
     C                     Z-ADDFJTLMI    WL0025           Total Load Mile
     C                     MOVELFJQ2CD    WL0026           Shipping Method
     C                     MOVELFJVPCD    WL0027           Ship From Wareh
     C                     MOVELFJDBCD    WL0028           Ship To State C
     C                     MOVELFJXCCD    WL0029           Carrier Broker
     C                     MOVELFJRMST    WL0030           Load Acceptance
     C                     Z-ADDFJK2DT    WL0031           Override Total
     C                     MOVELFJWRTX    WL0032           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0034           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0035           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSM02           Load ID
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM02           Load ID
      * Setup key
     C                     Z-ADDWL0033    WQSM02           Load ID
      * Establish starting position
     C           KRSSM     SETLL@BFCPD9                    *
     C           KRSSM     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0034           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WBBCST    IFEQ 'B'                        *IF
     C                     MOVELWBBCST    WL0035           Block Order Fla
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSM     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN ADBWC3    WQSN01           Shipping Compan
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0037    WQSN01           Shipping Compan
      * Establish starting position
     C           KRSSN     SETLL@ADREWA                    *
     C           KRSSN     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0036           Warehouse Code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           ADVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           ADAOCD    IFNE *BLANK                     *IF
     C                     MOVELADAOCD    WL0036           Warehouse Code
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0038    ABAIC3           Company Number
      * Establish starting position
     C           KRSSO     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0039           Name
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0039           Name
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0041           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSP02           Load ID
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP02           Load ID
      * Setup key
     C                     Z-ADDWL0040    WQSP02           Load ID
      * Establish starting position
     C           KRSSP     SETLL@FLCPEB                    *
     C           KRSSP     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           FLRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WL0041           Status - Y or N
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0042           Order in Use
     C                     MOVEL*BLANK    WL0043           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADDWL0044    WQSQ02           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@BFCPD9                    *
     C           KRSSQ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WBGWST    IFEQ 'H'                        *IF
     C                     MOVELWBGWST    WL0043           Header Status
     C                     GOTO SQEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WBGWST    IFEQ 'X'                        *IF
     C                     MOVELWBGWST    WL0043           Header Status
     C                     GOTO SQEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WBGJST    IFEQ 'Y'                        *IF
     C                     MOVELWBGJST    WL0042           Order in Use
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSR02           Load ID
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR02           Load ID
      * Setup key
     C                     Z-ADDWL0045    WQSR02           Load ID
      * Establish starting position
     C           KRSSR     SETLL@BFCPD9                    *
     C           KRSSR     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0046           Order Requires
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBFUSX    WL0046           Order Requires
     C           KRSSR     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVELWL0047    FKRONB           Truck Size
      * Establish starting position
     C           KRSSS     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0048           Maximum pounds
     C                     Z-ADD*ZERO     WL0049           Minimum pounds
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WL0048           Maximum pounds
     C                     Z-ADDFKTANB    WL0049           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSST     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WN0138           Scheduled Ship
     C                     MOVELFJPJST    WUG0TX           LTL Flag
     C                     MOVELFJPKST    WUG0TX           Load Status
     C                     Z-ADDFJRNNB    WUNFNN           Reefer Temperat
     C                     MOVELFJDMTX    WUG0TX           Seal 1
     C                     MOVELFJDNTX    WUG0TX           Seal 2
     C                     MOVELFJDOTX    WUG0TX           Seal 3
     C                     Z-ADDFJRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDFJFLAM    WN0139           Flat Amount
     C                     MOVELFJXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDFJRRNB    WN0140           Total Stops
     C                     MOVELFJDXTX    WUG0TX           Trailer Id
     C                     MOVELFJDYTX    WUG0TX           Transloader Car
     C                     Z-ADDFJSBNB    WUNFNN           BOL Time
     C                     MOVELFJBZNA    WUG0TX           Carrier Code
     C                     MOVELFJRONB    WUG0TX           Truck Size
     C                     Z-ADDFJSQNB    WUNFNN           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    WUNFNN           Rated Freight
     C                     MOVELFJVCST    WUG0TX           Ship Status
     C                     MOVELFJVDST    WUG0TX           Load Type
     C                     Z-ADDFJSDNB    WUNFNN           Number Pallets
     C                     Z-ADDFJPAOU    WUNFNN           Number Pallets
     C                     Z-ADDFJDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDFJSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDFJHADT    WUNFNN           Actual Arrival
     C                     Z-ADDFJAART    WUNFNN           Actual Arrival
     C                     Z-ADDFJDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDFJDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WUNFNN           Actual Departur
     C                     Z-ADDFJS6NB    WUNFNN           Departure Time
     C                     Z-ADDFJT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDFJPRTM    WUNFNN           Product Tempera
     C                     Z-ADDFJNPSV    WUNFNN           Number Spacers
     C                     MOVELFJJ8TX    WUG0TX           Car_Veh_Initial
     C                     Z-ADDFJTLMI    WN0141           Total Load Mile
     C                     MOVELFJJ9TX    WUG0TX           Recorder ID
     C                     MOVELFJQ2CD    WUG0TX           Shipping Method
     C                     MOVELFJVPCD    WN0142           Ship From Wareh
     C                     MOVELFJDBCD    WN0143           Ship To State C
     C                     Z-ADDFJGRWE    WUNFNN           Gross Weight
     C                     MOVELFJXCCD    WN0144           Carrier Broker
     C                     MOVELFJU2ST    WN0145           Export Status
     C                     Z-ADDFJF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELFJONTM    WUG0TX           On Time_Y_N
     C                     Z-ADDFJJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDFJTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDFJSPTM    WUNFNN           Spotted Time
     C                     Z-ADDFJJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDFJLFTM    WUNFNN           Load Finished T
     C                     Z-ADDFJJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDFJBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDFJBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDFJKIDT    WUNFNN           Truck Departure
     C                     Z-ADDFJASTM    WUNFNN           Truck Departure
     C                     Z-ADDFJKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDFJAJCM    WUNFNN           Adjusted Depart
     C                     MOVELFJXACD    WUG0TX           Shipping Line
     C                     MOVELFJOANA    WUG0TX           Port Delv Termi
     C                     MOVELFJK4TX    WUG0TX           Vessel Name
     C                     Z-ADDFJVOAG    WUNFNN           Voyage
     C                     Z-ADDFJKBDT    WUNFNN           Sail Date
     C                     MOVELFJNBBO    WUG0TX           Booking Number
     C                     MOVELFJW4CD    WUG0TX           Discharge Port
     C                     Z-ADDFJEFDT    WUNFNN           Arrival Date
     C                     MOVELFJCNTN    WUG0TX           Container Numbe
     C                     Z-ADDFJKCDT    WUNFNN           Date In
     C                     Z-ADDFJTMIN    WUNFNN           Time In
     C                     Z-ADDFJKDDT    WUNFNN           Date Out
     C                     Z-ADDFJVMNB    WUNFNN           Time Out
     C                     Z-ADDFJOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDFJKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDFJATTM    WUNFNN           Scheduled Deliv
     C                     MOVELFJOTRS    WUG0TX           LH Unused Sts
     C                     Z-ADDFJKKDT    WUNFNN           On Yard Date
     C                     Z-ADDFJAVTM    WUNFNN           On Yard Time
     C                     Z-ADDFJKZDT    WN0148           Deadline Depart
     C                     Z-ADDFJAXTM    WN0149           Deadline Depart
     C                     MOVELFJRYSX    WN0150           MG Created Load
     C                     GOTO STEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0170  70       Total Load Mile
     C                     MOVEL*BLANK    WN0171  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0172  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0173  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSU     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR SVRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           FJAJCD    IFEQ WN0171                     *IF
     C                     MOVEL*BLANK    WN0172           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFJAJCD    WN0172           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           FJRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDFJTLMI    WN0170           Total Load Mile
     C                     Z-ADDFJK2DT    WN0173           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADDFJRMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C           WN0170    PARM WN0170    WQ0003  70       Total Load Mile
     C           WN0173    PARM WN0173    WQ0004  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR SYCHRC
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSV02           Load ID
      * Define keylist
     C           KPSSV     KLIST
     C                     KFLD           WQSV02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSV02           Load ID
     C                     Z-ADD1         FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSSV     SETLL@FLCPEB                    *
     C           KRSSV     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SWRVGN
     C                     GOTO SVEXIT                     *QUIT
     C           KRSSV     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSW01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSW02           Order Number
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSW01           Company Number
     C                     Z-ADDFLC4NB    WQSW02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSW     SETLL@BGWKAE                    *
     C           KRSSW     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0171           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SXRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WN0171           Warehouse Code
     C                     GOTO SWEXIT                     *QUIT
     C           KRSSW     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0174  30       Company Number
     C                     Z-ADD*ZERO     WN0175  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0176  1        LTL Flag
     C                     MOVEL*BLANK    WN0177  1        Load Status
     C                     Z-ADD*ZERO     WN0178  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0179 15        Seal 1
     C                     MOVEL*BLANK    WN0180 15        Seal 2
     C                     MOVEL*BLANK    WN0181 15        Seal 3
     C                     MOVEL*BLANK    WN0182 15        Seal 4
     C                     MOVEL*BLANK    WN0183 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0184  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0185 112       Flat Amount
     C                     MOVEL*BLANK    WN0186  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0187  50       Total Stops
     C                     MOVEL*BLANK    WN0188 20        Trailer Id
     C                     MOVEL*BLANK    WN0189  3        Transloader Car
     C                     Z-ADD*ZERO     WN0190  40       BOL Time
     C                     MOVEL*BLANK    WN0191  3        Carrier Code
     C                     MOVEL*BLANK    WN0192  7        Truck Size
     C                     Z-ADD*ZERO     WN0193  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0194 112       Rated Freight
     C                     MOVEL*BLANK    WN0195  1        Ship Status
     C                     MOVEL*BLANK    WN0196  1        Load Type
     C                     Z-ADD*ZERO     WN0197  50       Number Pallets
     C                     Z-ADD*ZERO     WN0198  50       Number Pallets
     C                     Z-ADD*ZERO     WN0199 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0200  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0201  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0202  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0203 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0204 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0205  70       Actual Departur
     C                     Z-ADD*ZERO     WN0206  40       Departure Time
     C                     Z-ADD*ZERO     WN0207  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0208  52       Product Tempera
     C                     Z-ADD*ZERO     WN0209  50       Number Spacers
     C                     MOVEL*BLANK    WN0210 12        Car_Veh_Initial
     C                     MOVEL*BLANK    WN0211 12        Recorder ID
     C                     MOVEL*BLANK    WN0212  2        Shipping Method
     C                     MOVEL*BLANK    WN0213  2        Ship To State C
     C                     Z-ADD*ZERO     WN0214  70       Gross Weight
     C                     MOVEL*BLANK    WN0215  3        Carrier Broker
     C                     MOVEL*BLANK    WN0216  1        Export Status
     C                     Z-ADD*ZERO     WN0217  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0218  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0219  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0220  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0221  70       Spotted Date
     C                     Z-ADD*ZERO     WN0222  60       Spotted Time
     C                     Z-ADD*ZERO     WN0223  70       Load Finished D
     C                     Z-ADD*ZERO     WN0224  60       Load Finished T
     C                     Z-ADD*ZERO     WN0225  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0226  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0227  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0228  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0229  70       Truck Departure
     C                     Z-ADD*ZERO     WN0230  60       Truck Departure
     C                     Z-ADD*ZERO     WN0231  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0232  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0233  3        Shipping Line
     C                     MOVEL*BLANK    WN0234 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0235 30        Vessel Name
     C                     Z-ADD*ZERO     WN0236  50       Voyage
     C                     Z-ADD*ZERO     WN0237  70       Sail Date
     C                     MOVEL*BLANK    WN0238 12        Booking Number
     C                     MOVEL*BLANK    WN0239 20        Discharge Port
     C                     Z-ADD*ZERO     WN0240  70       Arrival Date
     C                     MOVEL*BLANK    WN0241 12        Container Numbe
     C                     Z-ADD*ZERO     WN0242  70       Date In
     C                     Z-ADD*ZERO     WN0243  60       Time In
     C                     Z-ADD*ZERO     WN0244  70       Date Out
     C                     Z-ADD*ZERO     WN0245  60       Time Out
     C                     Z-ADD*ZERO     WN0246 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0247  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0248  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0249  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0250  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0251  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0252  70       Requested Deliv
     C                     MOVEL*BLANK    WN0253  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0254  70       On Yard Date
     C                     Z-ADD*ZERO     WN0255  60       On Yard Time
     C                     Z-ADD*ZERO     WN0256  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0257  60       Deadline Depart
     C                     MOVEL*BLANK    WN0258  1        Load Held Over
     C                     MOVEL*BLANK    WN0259  1        Load Held Over
     C                     MOVEL*BLANK    WN0260 15        Load Held Over
     C                     MOVEL*BLANK    WN0261 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0262 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0263  70       Express Mail Da
     C                     MOVEL*BLANK    WN0264  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0265  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0266  70       Product Complet
     C                     Z-ADD*ZERO     WN0267  60       Product Complet
     C                     Z-ADD*ZERO     WN0268  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0269  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0270  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0271  1        Load Confirmed
     C                     MOVEL*BLANK    WN0272 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0273  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0274  60       Load Door 1
     C                     Z-ADD*ZERO     WN0275  60       Load Door 2
     C                     MOVEL*BLANK    WN0276  1        Partial Load
     C                     MOVEL*BLANK    WN0277  1        Load Confirmati
     C                     MOVEL*BLANK    WN0278  1        Export Load USD
     C                     MOVEL*BLANK    WN0279  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0280 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0281 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0282 15        Late Billing Em
     C                     MOVEL*BLANK    WN0283 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0284 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0285  1        Multi Company L
     C                     MOVEL*BLANK    WN0286  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0287  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0288  1        LH Power Only L
     C                     MOVEL*BLANK    WN0289  1        MG Created Load
     C                     MOVEL*BLANK    WN0290  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0291  2        Load U_M
     C                     MOVEL*BLANK    WN0292  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0293  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0294  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0295  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0296  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0297  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0298  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0299  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0300  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0301  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0302  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0303  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0304  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0305  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0306  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0307  60       LH Unused Time
     C                     MOVEL*BLANK    WN0308  1        EDI Status 1
     C                     MOVEL*BLANK    WN0309  1        EDI Status 2
     C                     MOVEL*BLANK    WN0310  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0311  60       Job Time
     C                     MOVEL*BLANK    WN0312 10        User Id
     C                     MOVEL*BLANK    WN0313 10        Job Name
     C                     Z-ADD*ZERO     WN0314  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDFJRMNB    WDRMNB           Load ID
      *
     C           KLCHSY    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHSY    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0170    WDTLMI           Total Load Mile
     C                     MOVELWN0171    WDVPCD    P      Ship From Wareh
     C                     MOVELWN0172    WDAJCD    P      Warehouse Code
     C                     Z-ADDWN0173    WDK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSZ02           Load ID
      * Define keylist
     C           KPSSZ     KLIST
     C                     KFLD           WQSZ02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ02           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    WQSZ02           Load ID
     C                     Z-ADD*ZERO     FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSSZ     SETLL@FLCPEB                    *
     C           KRSSZ     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDFLN7DT    WUN7DT           LD Carrier Appt
     C                     Z-ADDFLB3TM    WN0149           LD Carrier Appt
     C                     GOTO SZEXIT                     *QUIT
     C           KRSSZ     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTA02           Load ID
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA02           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    WQTA02           Load ID
     C                     Z-ADD*ZERO     FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSTA     SETLL@FLCPEB                    *
     C           KRSTA     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR TBRVGN
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WEAIC3           Company Number
     C                     Z-ADDFLC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WN0148           Requested Deliv
     C                     Z-ADD*ZERO     WN0168           Requested Deliv
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBRTX    WUBRTX           Ship To Name
     C                     MOVELWEHNNA    WUHNNA           Ship To City
     C                     Z-ADDWEEIDT    WN0148           Requested Deliv
     C                     Z-ADDWEAFTM    WN0168           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJQ2CD    YL0013           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTD02           Load ID
      * Define keylist
     C           KPSTD     KLIST
     C                     KFLD           WQTD02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
     C                     KFLD           FLC4NB           Order Number
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD02           Load ID
      * Setup key
     C                     Z-ADDWL0050    WQTD02           Load ID
     C                     Z-ADDWL0051    FLRVNB           Stop_Drop
     C                     Z-ADDWL0052    FLC4NB           Order Number
      * Establish starting position
     C           KPSTD     SETLL@FLCPEB                    *
     C           KRSTD     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRWNB    WL0053           Miles to next s
     C                     GOTO TDEXIT                     *QUIT
     C           KRSTD     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSTE     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWN0316    LGMILE           Miles to First
      * Establish starting position
     C           KPSTE     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    YL0014           Hours Required
     C                     GOTO TEEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WUG0TX           Load Status
     C                     Z-ADDFJTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDFJK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQTG02           Load ID
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG02           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    WQTG02           Load ID
      * Establish starting position
     C           KRSTG     SETLL@FLCPE8                    *
     C           KRSTG     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR THRVGN
     C                     GOTO TGEXIT                     *QUIT
     C           KRSTG     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WEAIC3           Company Number
     C                     Z-ADDWFC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    WUBKC7           Ship To Custome
     C                     MOVELWEBRTX    WUBRTX           Ship To Name
     C                     MOVELWEHMNA    WUHMNA           Ship To Address
     C                     MOVELWEHONA    WUHONA           Ship To Address
     C                     MOVELWEHPNA    WUHPNA           Ship To Address
     C                     MOVELWEHNNA    WUHNNA           Ship To City
     C                     MOVELWEDBCD    WN0143           Ship To State C
     C                     MOVELWECKTX    WUCKTX           Ship To Zip_Pos
     C                     MOVELWEBCNA    WUG0TX           Customer Purcha
     C                     MOVELWEB6NA    WUG0TX           Special Instruc
     C                     MOVELWEBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWEEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWEAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQTI02           Load ID
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI02           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    WQTI02           Load ID
      * Establish starting position
     C           KRSTI     SETLL@BFCPD9                    *
     C           KRSTI     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBHNNA    WN0153           Ship To City
     C                     MOVELWBDBCD    WN0154           Ship To State C
     C                     GOTO TIEXIT                     *QUIT
     C           KRSTI     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           LEBZNA           Carrier Code
     C                     KFLD           LEAJCD           Warehouse Code
     C                     KFLD           LEXECD           Destination Cit
     C                     KFLD           LEBGCD           State Code
      * Setup key
     C                     MOVELWN0144    LEBZNA           Carrier Code
     C                     MOVELWN0142    LEAJCD           Warehouse Code
     C                     MOVELWN0153    LEXECD           Destination Cit
     C                     MOVELWN0154    LEBGCD           State Code
      * Establish starting position
     C           KRSTJ     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           LEAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDLENMVA    WN0139           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0324  30       Company Number
     C                     MOVEL*BLANK    WN0325  1        LTL Flag
     C                     Z-ADD*ZERO     WN0326  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0327 15        Seal 1
     C                     MOVEL*BLANK    WN0328 15        Seal 2
     C                     MOVEL*BLANK    WN0329 15        Seal 3
     C                     MOVEL*BLANK    WN0330 15        Seal 4
     C                     MOVEL*BLANK    WN0331 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0332  70       Total Load Orde
     C                     MOVEL*BLANK    WN0333  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0334  50       Total Stops
     C                     MOVEL*BLANK    WN0335 20        Trailer Id
     C                     MOVEL*BLANK    WN0336  3        Transloader Car
     C                     Z-ADD*ZERO     WN0337  40       BOL Time
     C                     MOVEL*BLANK    WN0338  3        Carrier Code
     C                     MOVEL*BLANK    WN0339  7        Truck Size
     C                     Z-ADD*ZERO     WN0340  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0341 112       Rated Freight
     C                     MOVEL*BLANK    WN0342  1        Ship Status
     C                     MOVEL*BLANK    WN0343  1        Load Type
     C                     Z-ADD*ZERO     WN0344  50       Number Pallets
     C                     Z-ADD*ZERO     WN0345  50       Number Pallets
     C                     Z-ADD*ZERO     WN0346 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0347  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0348  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0349  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0350 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0351 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0352  70       Actual Departur
     C                     Z-ADD*ZERO     WN0353  40       Departure Time
     C                     Z-ADD*ZERO     WN0354  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0355  52       Product Tempera
     C                     Z-ADD*ZERO     WN0356  50       Number Spacers
     C                     MOVEL*BLANK    WN0357 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0358  70       Total Load Mile
     C                     MOVEL*BLANK    WN0359 12        Recorder ID
     C                     MOVEL*BLANK    WN0360  2        Shipping Method
     C                     Z-ADD*ZERO     WN0361  70       Gross Weight
     C                     MOVEL*BLANK    WN0362  3        Carrier Broker
     C                     MOVEL*BLANK    WN0363  1        Export Status
     C                     Z-ADD*ZERO     WN0364  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0365  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0366  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0367  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0368  70       Spotted Date
     C                     Z-ADD*ZERO     WN0369  60       Spotted Time
     C                     Z-ADD*ZERO     WN0370  70       Load Finished D
     C                     Z-ADD*ZERO     WN0371  60       Load Finished T
     C                     Z-ADD*ZERO     WN0372  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0373  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0374  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0375  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0376  70       Truck Departure
     C                     Z-ADD*ZERO     WN0377  60       Truck Departure
     C                     Z-ADD*ZERO     WN0378  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0379  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0380  3        Shipping Line
     C                     MOVEL*BLANK    WN0381 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0382 30        Vessel Name
     C                     Z-ADD*ZERO     WN0383  50       Voyage
     C                     Z-ADD*ZERO     WN0384  70       Sail Date
     C                     MOVEL*BLANK    WN0385 12        Booking Number
     C                     MOVEL*BLANK    WN0386 20        Discharge Port
     C                     Z-ADD*ZERO     WN0387  70       Arrival Date
     C                     MOVEL*BLANK    WN0388 12        Container Numbe
     C                     Z-ADD*ZERO     WN0389  70       Date In
     C                     Z-ADD*ZERO     WN0390  60       Time In
     C                     Z-ADD*ZERO     WN0391  70       Date Out
     C                     Z-ADD*ZERO     WN0392  60       Time Out
     C                     Z-ADD*ZERO     WN0393 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0394  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0395  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0396  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0397  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0398  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0399  70       Requested Deliv
     C                     MOVEL*BLANK    WN0400  1        Load Acceptance
     C                     MOVEL*BLANK    WN0401  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0402  70       On Yard Date
     C                     Z-ADD*ZERO     WN0403  60       On Yard Time
     C                     MOVEL*BLANK    WN0404  1        Load Held Over
     C                     MOVEL*BLANK    WN0405  1        Load Held Over
     C                     MOVEL*BLANK    WN0406 15        Load Held Over
     C                     MOVEL*BLANK    WN0407 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0408 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0409  70       Express Mail Da
     C                     MOVEL*BLANK    WN0410  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0411  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0412  70       Product Complet
     C                     Z-ADD*ZERO     WN0413  60       Product Complet
     C                     Z-ADD*ZERO     WN0414  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0415  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0416  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0417  1        Load Confirmed
     C                     MOVEL*BLANK    WN0418 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0419  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0420  60       Load Door 1
     C                     Z-ADD*ZERO     WN0421  70       Override Total
     C                     Z-ADD*ZERO     WN0422  60       Load Door 2
     C                     MOVEL*BLANK    WN0423  1        Partial Load
     C                     MOVEL*BLANK    WN0424  1        Load Confirmati
     C                     MOVEL*BLANK    WN0425  1        Export Load USD
     C                     MOVEL*BLANK    WN0426  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0427 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0428 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0429 15        Late Billing Em
     C                     MOVEL*BLANK    WN0430 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0431 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0432  1        Multi Company L
     C                     MOVEL*BLANK    WN0433  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0434  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0435  1        LH Power Only L
     C                     MOVEL*BLANK    WN0436  1        MG Created Load
     C                     MOVEL*BLANK    WN0437  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0438  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0439  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0440  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0441  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0442  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0443  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0444  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0445  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0446  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0447  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0448  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0449  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0450  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0451  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0452  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0453  60       LH Unused Time
     C                     MOVEL*BLANK    WN0454  1        EDI Status 1
     C                     MOVEL*BLANK    WN0455  1        EDI Status 2
     C                     MOVEL*BLANK    WN0456  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0457  60       Job Time
     C                     MOVEL*BLANK    WN0458 10        User Id
     C                     MOVEL*BLANK    WN0459 10        Job Name
     C                     Z-ADD*ZERO     WN0460  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD$CRMNB    WDRMNB           Load ID
      *
     C           KLCHTK    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHTK    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0138    WDAODT           Scheduled Ship
     C                     MOVEL'L'       WDPKST    P      Load Status
     C                     Z-ADDWN0139    WDFLAM           Flat Amount
     C                     MOVELWN0142    WDVPCD    P      Ship From Wareh
     C                     MOVELWN0143    WDDBCD    P      Ship To State C
     C                     Z-ADDWN0148    WDKZDT           Deadline Depart
     C                     Z-ADDWN0149    WDAXTM           Deadline Depart
     C                     MOVELWN0151    WDR0SX    P      Load U_M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0155           USR Warehouse C
     C                     MOVEL*BLANK    WN0156           USR CDE Parm 1
     C                     MOVEL*BLANK    WN0157           USR CDE Parm 2
     C                     MOVEL*BLANK    WN0158           USR CDE Parm 3
     C                     MOVEL*BLANK    WN0159           USR CDE Parm 4
     C                     MOVEL*BLANK    WN0160           USR CDE Parm 5
     C                     MOVEL*BLANK    WN0161           USR CDE Parm 6
     C                     MOVEL*BLANK    WN0162           USR CDE Parm 7
     C                     MOVEL*BLANK    WN0163           USR CDE Parm 8
     C                     MOVEL*BLANK    WN0164           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTL02           Load ID
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL02           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    WQTL02           Load ID
      * Establish starting position
     C           KRSTL     SETLL@FLCPKF                    *
     C           KRSTL     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR TMRVGN
     C           KRSTL     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTM02           Order Number
      * Define keylist
     C           KPSTM     KLIST
     C                     KFLD           WQTM01           Company Number
     C                     KFLD           WQTM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           Company Number
     C                     KFLD           WQTM02           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WQTM01           Company Number
     C                     Z-ADDWGC4NB    WQTM02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSTM     SETLL@BGWKAE                    *
     C           KRSTM     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           OMAJCD    IFEQ WN0155                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           OMAJCD    IFEQ WN0156                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           OMAJCD    IFEQ WN0157                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           OMAJCD    IFEQ WN0158                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           OMAJCD    IFEQ WN0159                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           OMAJCD    IFEQ WN0160                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           OMAJCD    IFEQ WN0161                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           OMAJCD    IFEQ WN0162                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           OMAJCD    IFEQ WN0163                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           OMAJCD    IFEQ WN0164                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WN0155    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0155           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WN0156    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0156           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WN0157    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0157           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WN0158    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0158           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WN0159    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0159           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WN0160    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0160           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WN0161    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0161           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WN0162    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0162           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WN0163    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0163           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WN0164    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WN0164           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTM     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQTN01           Load ID
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    WQTN01           Load ID
      * Establish starting position
     C           KRSTN     SETLL@FLCPBW                    *
     C           KRSTN     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR TORVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WN0461           Trans Contol AS
     C                     GOTO TNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTN     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WEAIC3           Company Number
     C                     Z-ADDWHC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTO     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR TPRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO TOEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQTP01           Company Number
     C           *LIKE     DEFN WIC4NB    WQTP02           Order Number
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTP01           Company Number
     C                     Z-ADDWEC4NB    WQTP02           Order Number
      * Establish starting position
     C           KRSTP     SETLL@BGWKL1                    *
     C           KRSTP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WIGMST    IFEQ 'L'                        *IF
     C           WIGMST    OREQ 'A'
     C           WIGMST    OREQ 'C'
     C           WIGMST    OREQ 'R'
     C           WIGMST    OREQ 'E'
     C           WIGMST    OREQ 'H'
     C           WIGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR TQRVGN
     C                     GOTO TPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWIAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSTQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWCXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADD$CAIC3    BUY1NX           PFS Company Num
     C                     MOVEL'LDORDD'  BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSTR     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0016           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0017           PFS Carlisle Ac
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    YL0016           PFS AccuSort Ac
     C                     MOVELBUWUSX    YL0017           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Load Header       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTS     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    YL0019           Load Status
     C                     Z-ADDFJRNNB    WURNNB           Reefer Temperat
     C                     Z-ADDFJRPNB    WURPNB           Total Load Orde
     C                     Z-ADDFJRRNB    WURRNB           Total Stops
     C                     MOVELFJBZNA    YL0020           Carrier Code
     C                     MOVELFJRONB    WURONB           Truck Size
     C                     Z-ADDFJAQDT    WUAQDT           Actual Departur
     C                     Z-ADDFJS6NB    WUS6NB           Departure Time
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * 11/10/16 LJB E007827 Recompile over new logical-SSD before CrHld
      * 05/23/16 RMC E4119 remove live with tpm check
      * * 03/14/2014 LJB E003028
      * **  Rtv change log record, if previously released, don't check cr
      * **  Change Access Path to read all Cr Hold=N first, then apply an
      * **  left over dollars to the orders that are on Credit Hold
      * * 09/20/2011 LJB P001251  Don't lock if errors pending in Ord Det
      * ** Recompile - Don't lock if shipping after today     E00495 10/0
      * RMC Get A/R Bal Due from open in,dm,cb instead of Summary file.cm
      * DLY029R 01/23/07 JRB Get default co num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 09/20/2011 LJB P001251  Export Order Automation Upload
      * ** Cannot lock load if there are errors still pending in the
      * ** Order Detail record
      * *****
      * ** Auto lock if shipping today & no errors            E00495
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CRMNB    WQ0009  70       Load ID
     C           WN0151    PARM *BLANK    WQ0010  2        Load U_M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1S2NB           Parent Credit L
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2J3DT           Ship Date Over
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3YXVA           Accumilated Ord
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4ABVA           A/R Balance Due
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5GGST           USR Display fie
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6GWST           Header Status
     C                     MOVEL*BLANK    P6GXST           Header Status L
     C                     MOVEL*BLANK    P6XIST           Credit Hold
     C                     MOVEL*BLANK    P6XJST           Production Hold
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7ELDT           Production Date
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    K9AYTX           Customer Name
     C                     MOVEL*LOVAL    K9CHC7           Parent Number
     C                     MOVEL*LOVAL    K9AODT           Scheduled Ship
     C                     MOVEL*LOVAL    K9XIST           Credit Hold
     C                     MOVEL*LOVAL    K9ANC7           AR Customer Num
     C                     MOVEL*LOVAL    K9AIC3           Company Number
     C                     MOVEL*LOVAL    K9C4NB           Order Number
      * Define work field Remaining Balance Due
     C                     Z-ADD*ZERO     WUBGVA 112
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Flat Amount
     C                     Z-ADD*ZERO     WUFLAM 112
      * Define work field Allocate Pounds_Miles
     C                     MOVEL*BLANK    WUXQST  1
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Ship From Warehouse
     C                     MOVEL*BLANK    WUVPCD  3
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Shipping Temp C_F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WFRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WFRWNB           Miles to next s
     C                     Z-ADD*ZERO     WFRXNB           Freight Charge
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WFT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WFT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFKFDT           Appointment Con
     C                     Z-ADD*ZERO     WFACTM           Appointment Con
     C                     Z-ADD*ZERO     WFEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WFAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFZ4NB           MPC Number
     C                     Z-ADD*ZERO     WFN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WFN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WFN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WFB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WFB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WFB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WICFC7           Order Group Cod
     C                     Z-ADD*ZERO     WIMAVA           Billing Detail
     C                     Z-ADD*ZERO     WIKDVA           Billing Detail
     C                     Z-ADD*ZERO     WIL8VA           Billing Detail
     C                     Z-ADD*ZERO     WIL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WIAYVA           Extended Amount
     C                     Z-ADD*ZERO     WIEXDT           Market Pricing
     C                     Z-ADD*ZERO     WIBZPR           Price Overage O
     C                     Z-ADD*ZERO     WIL6NB           Contract Number
     C                     Z-ADD*ZERO     WIGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WID0WG           Weight Ordered
     C                     Z-ADD*ZERO     WICCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WIAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WICBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WIATWG           Weight Shipped
     C                     Z-ADD*ZERO     WIAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WIAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WIAKPR           Unit Price
     C                     Z-ADD*ZERO     WIALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WIAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WIAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WIA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WIA5DT           Requested Ship
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WICXDT           Date of Origina
     C                     Z-ADD*ZERO     WIDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WIB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WIA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WINTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WINUDT           Consumed Item C
     C                     Z-ADD*ZERO     WINVDT           Deadline Depart
     C                     Z-ADD*ZERO     WINWDT           OD Price Type R
     C                     Z-ADD*ZERO     WINXDT           OD Firm Date
     C                     Z-ADD*ZERO     WIBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WIBVTM           Price Code
     C                     Z-ADD*ZERO     WIBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WIBXTM           Substitution Li
     C                     Z-ADD*ZERO     WIBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WIH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WIH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WIH7NX           OD Item Target
     C                     Z-ADD*ZERO     WIH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WIH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WIDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WIDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WIDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WIDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WIDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WIGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WIGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WIGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WIPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WIRINY           Item Age Days
     C                     Z-ADD*ZERO     WITIDT           Production Ovr
     C                     Z-ADD*ZERO     WITJDT           Production Ovr
     C                     Z-ADD*ZERO     WITKDT           OD Market Begin
     C                     Z-ADD*ZERO     WITLDT           OD Market Endin
     C                     Z-ADD*ZERO     WITMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Stops
     C                     Z-ADD*ZERO     WURRNB  50
      * Define work field Truck Size
     C                     MOVEL*BLANK    WURONB  7
      * Define work field Actual Departure Date
     C                     Z-ADD*ZERO     WUAQDT  70
      * Define work field Departure Time
     C                     Z-ADD*ZERO     WUS6NB  40
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003 10
     C                     MOVEL*BLANK    WL0004  3
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006 10
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0007 10
     C                     MOVEL*BLANK    WL0008  6
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  3
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0011  6
     C                     MOVEL*BLANK    WL0012 30
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  1
     C                     Z-ADD*ZERO     WL0016  52
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018 112
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  7
     C                     Z-ADD*ZERO     WL0022 112
     C                     MOVEL*BLANK    WL0023  1
     C                     Z-ADD*ZERO     WL0024  50
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026  2
     C                     MOVEL*BLANK    WL0027  3
     C                     MOVEL*BLANK    WL0028  2
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  1
     C                     Z-ADD*ZERO     WL0031  70
     C                     MOVEL*BLANK    WL0032 25
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0036  3
     C                     Z-ADD*ZERO     WL0037  30
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0038  30
     C                     MOVEL*BLANK    WL0039 30
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  1
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043  1
     C                     Z-ADD*ZERO     WL0044  70
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  2
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0047  7
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
      * Define local variables for subroutine TDRVGN.
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  50
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  50
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Allow Multi_Company
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0004 10
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field @Library List Code
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field Environment Code
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field STATUS
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field *SFLSEL
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0012  2
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0005  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0014  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0017  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0006 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0021  6
      * Define local work field Department Control Code
     C                     MOVEL*BLANK    YL0022  3
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0001    P      User Profile Na
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0003    P      Allow Multi_Com
     C                     MOVELWL0003    YN0004    P      Default Printer
     C                     MOVELWL0004    YN0002    P      Salesperson Cod
     C                     Z-ADDWL0005    YL0002           Company Number
     C                     MOVELWL0006    WN0002    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0001           User Profile Na
     C                     MOVEL'A/R'     ZA0002           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0007    P      User Profile Na
     C                     MOVEL'A/R'     WL0008    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0001           Company Number
     C                     MOVELWL0010    YL0003    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0007    P      User Profile Na
     C                     MOVEL'A/R'     WL0008    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0001           Company Number
     C                     MOVELWL0010    YL0003    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0003    YN0001           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0003           User Profile Na
     C                     MOVEL'A/R'     ZA0004           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0002    IFNE 0                          *IF
     C                     Z-ADDYL0002    YL0001           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0003    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *BLANK    WQ0001  3        Warehouse Code
     C                     PARM YL0002    WQ0002  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'A/R'     WL0011    P      Application Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    WUAUNA    P      Description
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'A/R'     WL0011    P      Application Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    WUAUNA    P      Description
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       P5GGST           USR Display fie
      * RTV Next/Eq Prod Date  RT - Calendar  * 
     C                     EXSR SERVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 Y2U0003
00003 PDIZPCLP
00004 Auto Print Prelim. Pick
00005 PDSNPFR
