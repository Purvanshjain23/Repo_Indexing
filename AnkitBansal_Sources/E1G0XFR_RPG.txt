     H/TITLE Rtv Acct Bal - HPS E1 XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 10/28/20  Time  : 09:22:00
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FE10902CB  IF   E           K DISK
      * RSQ : Account Balances   F0902  Co/FY/Obj/Subs
      *
     FE10006L0  IF   E           K DISK
      * RTV : Business Unit Mstr F0006  Retrieval index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3
     D  WP0002         S              4  0
     D  WP0003         S              2  0
     D  WP0004         S              5
     D  WP0005         S              6
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              5
     D  ZQ             S              5  0
     D  YL0002         S              2  0
     D  WQSA01         S                   LIKE(WACO)
     D  WQSA02         S                   LIKE(WAFY)
     D  WQSA03         S                   LIKE(WAOBJ)
     D  YL0003         S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * B :  OMS Company Number Alpha
     D  P1LVTX                 1      3
     D P2PARM          DS
      * B :  @Year 4.0
     D  P2EJNB                 1      4  0
     D P3PARM          DS
      * I :  Period Number - G/L
     D  P3PN                   1      2  0
     D P4PARM          DS
      * I :  Expense Code
     D  P4C0CD                 1      5
     D P5PARM          DS
      * I :  Object Account
     D  P5OBJ                  1      6
     II0902CB
      * Account Balances   F0902  Co/FY/Obj/Subs
      * Renamed input format fields
     I              GBAID                       WAAID
     I              GBCTRY                      WACTRY
     I              GBFY                        WAFY
     I              GBFQ                        WAFQ
     I              GBLT                        WALT
     I              GBSBL                       WASBL
     I              GBCO                        WACO
     I              GBAPYC                      WAAPYC
     I              GBAN01                      WAAN01
     I              GBAN02                      WAAN02
     I              GBAN03                      WAAN03
     I              GBAN04                      WAAN04
     I              GBAN05                      WAAN05
     I              GBAN06                      WAAN06
     I              GBAN07                      WAAN07
     I              GBAN08                      WAAN08
     I              GBAN09                      WAAN09
     I              GBAN10                      WAAN10
     I              GBAN11                      WAAN11
     I              GBAN12                      WAAN12
     I              GBAN13                      WAAN13
     I              GBAN14                      WAAN14
     I              GBAPYN                      WAAPYN
     I              GBAWTD                      WAAWTD
     I              GBBORG                      WABORG
     I              GBPOU                       WAPOU
     I              GBPCZ                       WAPCZ
     I              GBTKER                      WATKER
     I              GBBREQ                      WABREQ
     I              GBBAPR                      WABAPR
     I              GBMCU                       WAMCU
     I              GBOBJ                       WAOBJ
     I              GBSUB                       WASUB
     I              GBUSER                      WAUSER
     I              GBPID                       WAPID
     I              GBUPMJ                      WAUPMJ
     I              GBJOBN                      WAJOBN
     I              GBSBLT                      WASBLT
     I              GBUPMT                      WAUPMT
     I              GBCRCD                      WACRCD
     I              GBCRCX                      WACRCX
     I              GBPRGF                      WAPRGF
     I              GBAD01                      WAAD01
     I              GBAD02                      WAAD02
     I              GBAD03                      WAAD03
     I              GBAD04                      WAAD04
     I              GBAD05                      WAAD05
     I              GBAD06                      WAAD06
     I              GBAD07                      WAAD07
     I              GBAD08                      WAAD08
     I              GBAD09                      WAAD09
     I              GBAD10                      WAAD10
     I              GBAD11                      WAAD11
     I              GBAS12                      WAAS12
     I              GBAS13                      WAAS13
     I              GBAD14                      WAAD14
      *
     II0006L0
      * Business Unit Mstr F0006  Retrieval index
      * Renamed input format fields
     I              MCMCU                       WBMCU
     I              MCSTYL                      WBSTYL
     I              MCDC                        WBDC
     I              MCLDM                       WBLDM
     I              MCCO                        WBCO
     I              MCAN8                       WBAN8
     I              MCAN8O                      WBAN8O
     I              MCCNTY                      WBCNTY
     I              MCADDS                      WBADDS
     I              MCFMOD                      WBFMOD
     I              MCDL01                      WBDL01
     I              MCDL02                      WBDL02
     I              MCDL03                      WBDL03
     I              MCDL04                      WBDL04
     I              MCRP01                      WBRP01
     I              MCRP02                      WBRP02
     I              MCRP03                      WBRP03
     I              MCRP04                      WBRP04
     I              MCRP05                      WBRP05
     I              MCRP06                      WBRP06
     I              MCRP07                      WBRP07
     I              MCRP08                      WBRP08
     I              MCRP09                      WBRP09
     I              MCRP10                      WBRP10
     I              MCRP11                      WBRP11
     I              MCRP12                      WBRP12
     I              MCRP13                      WBRP13
     I              MCRP14                      WBRP14
     I              MCRP15                      WBRP15
     I              MCRP16                      WBRP16
     I              MCRP17                      WBRP17
     I              MCRP18                      WBRP18
     I              MCRP19                      WBRP19
     I              MCRP20                      WBRP20
     I              MCRP21                      WBRP21
     I              MCRP22                      WBRP22
     I              MCRP23                      WBRP23
     I              MCRP24                      WBRP24
     I              MCRP25                      WBRP25
     I              MCRP26                      WBRP26
     I              MCRP27                      WBRP27
     I              MCRP28                      WBRP28
     I              MCRP29                      WBRP29
     I              MCRP30                      WBRP30
     I              MCTA                        WBTA
     I              MCTXJS                      WBTXJS
     I              MCTXA1                      WBTXA1
     I              MCEXR1                      WBEXR1
     I              MCTC01                      WBTC01
     I              MCTC02                      WBTC02
     I              MCTC03                      WBTC03
     I              MCTC04                      WBTC04
     I              MCTC05                      WBTC05
     I              MCTC06                      WBTC06
     I              MCTC07                      WBTC07
     I              MCTC08                      WBTC08
     I              MCBDCD                      WBBDCD
     I              MCTC10                      WBTC10
     I              MCND01                      WBND01
     I              MCND02                      WBND02
     I              MCND03                      WBND03
     I              MCND04                      WBND04
     I              MCND05                      WBND05
     I              MCND06                      WBND06
     I              MCND07                      WBND07
     I              MCND08                      WBND08
     I              MCND09                      WBND09
     I              MCND10                      WBND10
     I              MCCC01                      WBCC01
     I              MCCC02                      WBCC02
     I              MCCC03                      WBCC03
     I              MCCC04                      WBCC04
     I              MCCC05                      WBCC05
     I              MCCC06                      WBCC06
     I              MCG1ST                      WBG1ST
     I              MCG2ST                      WBG2ST
     I              MCG3ST                      WBG3ST
     I              MCG4ST                      WBG4ST
     I              MCPECC                      WBPECC
     I              MCCALS                      WBCALS
     I              MCCISS                      WBCISS
     I              MCGLBA                      WBGLBA
     I              MCALCL                      WBALCL
     I              MCLMTH                      WBLMTH
     I              MCLF                        WBLF
     I              MCOBJ1                      WBOBJ1
     I              MCOBJ2                      WBOBJ2
     I              MCOBJ3                      WBOBJ3
     I              MCSUB1                      WBSUB1
     I              MCTOU                       WBTOU
     I              MCSBLI                      WBSBLI
     I              MCANPA                      WBANPA
     I              MCCT                        WBCT
     I              MCCERT                      WBCERT
     I              MCMCUS                      WBMCUS
     I              MCBTYP                      WBBTYP
     I              MCPC                        WBPC
     I              MCPCA                       WBPCA
     I              MCPCC                       WBPCC
     I              MCINTA                      WBINTA
     I              MCINTL                      WBINTL
     I              MCD1J                       WBD1J
     I              MCD2J                       WBD2J
     I              MCD3J                       WBD3J
     I              MCD4J                       WBD4J
     I              MCD5J                       WBD5J
     I              MCD6J                       WBD6J
     I              MCFPDJ                      WBFPDJ
     I              MCCAC                       WBCAC
     I              MCPAC                       WBPAC
     I              MCEEO                       WBEEO
     I              MCERC                       WBERC
     I              MCUSER                      WBUSER
     I              MCPID                       WBPID
     I              MCUPMJ                      WBUPMJ
     I              MCJOBN                      WBJOBN
     I              MCUPMT                      WBUPMT
     I              MCBPTP                      WBBPTP
     I              MCAPSB                      WBAPSB
     I              MCTSBU                      WBTSBU
     I              MCRP31                      WBRP31
     I              MCRP32                      WBRP32
     I              MCRP33                      WBRP33
     I              MCRP34                      WBRP34
     I              MCRP35                      WBRP35
     I              MCRP36                      WBRP36
     I              MCRP37                      WBRP37
     I              MCRP38                      WBRP38
     I              MCRP39                      WBRP39
     I              MCRP40                      WBRP40
     I              MCRP41                      WBRP41
     I              MCRP42                      WBRP42
     I              MCRP43                      WBRP43
     I              MCRP44                      WBRP44
     I              MCRP45                      WBRP45
     I              MCRP46                      WBRP46
     I              MCRP47                      WBRP47
     I              MCRP48                      WBRP48
     I              MCRP49                      WBRP49
     I              MCRP50                      WBRP50
     I              MCGCA1                      WBGCA1
     I              MCGCA2                      WBGCA2
     I              MCGCA3                      WBGCA3
     I              MCGCA4                      WBGCA4
     I              MCGCA5                      WBGCA5
     I              MCMCU1                      WBMCU1
     I              MCDOCO                      WBDOCO
     I              MCPCTN                      WBPCTN
     I              MCCLNU                      WBCLNU
     I              MCBUCA                      WBBUCA
     I              MCADJE                      WBADJE
     I              MCUAFL                      WBUAFL
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1LVTX        PARM      P1LVTX        WP0001                         OMS Company Num
     C     P2EJNB        PARM      P2EJNB        WP0002                         @Year 4.0
     C     P3PN          PARM                    WP0003                         Period Number -
     C     P4C0CD        PARM                    WP0004                         Expense Code
     C     P5OBJ         PARM                    WP0005                         Object Account
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Rtv Acct Bal - HPS E1 XF
      * Convert incoming 3 character Company Number alpha to 5 alpha
     C                   Z-ADD     *ZEROS        ZQ
     C     '00'          CAT(P)    P1LVTX:ZQ     YL0001                         Company
      * Convert 4 digit year to 2 digit fiscal year
     C                   Z-ADD     P2EJNB        YL0002                         Fiscal Year
      * Rtv Acct Bal - HPS E1 RT - Account Balances   F0902  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Acct Bal - HPS E1 RT - Account Balances   F0902  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Company
     C                   KFLD                    WQSA02                         Fiscal Year
     C                   KFLD                    WQSA03                         Object Account
      * Setup key
     C                   MOVEL     YL0001        WQSA01                         Company
     C                   Z-ADD     YL0002        WQSA02                         Fiscal Year
     C                   MOVEL     P5OBJ         WQSA03                         Object Account
      * Establish starting position
     C     KRSSA         SETLL     I0902CB                                      *
     C     KRSSA         READE     I0902CB                                90    *
      * Data record not found
     C   90              MOVEL     'E1I0115'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Ledger Types is AA
     C                   DOW       NOT *IN90
     C                   IF        WALT = 'AA'
     C                   MOVEL     'N'           YL0003                         Process Flag
      * Chk Exist for AA NUR G/F - Business Unit Mstr F0006  * 
     C                   EXSR      SBRVGN
     C                   END                                                    *FI
     C     KRSSA         READE     I0902CB                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Chk Exist for AA NUR G/F - Business Unit Mstr F0006  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBMCU                          Business Unit/C
      * Setup key
     C                   MOVEL     WAMCU         WBMCU                          Business Unit/C
      * Establish starting position
     C     KRSSB         CHAIN     I0006L0                            90        *
      * Data record not found
     C   90              MOVEL     'E1I0090'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Catg Code - Biz Unit 12 is AC
     C                   IF        NOT *IN90
      * If Group is Nursery or G/F
      * CASE: Group is NUR or G/F
      *  - c1 OR c2
      *   |- c1    : DB1.Group is Nursery
      *   |- c2    : DB1.Group is G/F
      *   '-
     C                   IF        WBRP12 = 'AC'
     C                   IF        WBRP03 = 'NUR' OR
     C                             WBRP03 = 'G/F'
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WACTRY                         Century
     C                   Z-ADD     *ZERO         WAFY                           Fiscal Year
     C                   Z-ADD     *ZERO         WAAPYC                         Amount - Beg Ba
     C                   Z-ADD     *ZERO         WAAN01                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN02                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN03                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN04                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN05                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN06                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN07                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN08                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN09                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN10                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN11                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN12                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN13                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAN14                         Amount - Net Po
     C                   Z-ADD     *ZERO         WAAPYN                         Amount - Prior
     C                   Z-ADD     *ZERO         WAAWTD                         Amount - Week t
     C                   Z-ADD     *ZERO         WABORG                         Amount - Orig/B
     C                   Z-ADD     *ZERO         WAPOU                          Amount - Memo/B
     C                   Z-ADD     *ZERO         WAPCZ                          Percent Complet
     C                   Z-ADD     *ZERO         WATKER                         Amount - Memo C
     C                   Z-ADD     *ZERO         WABREQ                         Budget - Reques
     C                   Z-ADD     *ZERO         WABAPR                         Budget - Approv
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WAAD01                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD02                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD03                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD04                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD05                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD06                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD07                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD08                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD09                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD10                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD11                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAS12                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAS13                         Amount - Net De
     C                   Z-ADD     *ZERO         WAAD14                         Amount - Net De
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAN8                          Address Number
     C                   Z-ADD     *ZERO         WBAN8O                         Address Number
     C                   Z-ADD     *ZERO         WBTXJS                         Tax Entity
     C                   Z-ADD     *ZERO         WBLF                           Labor Distrib M
     C                   Z-ADD     *ZERO         WBTOU                          Units - Total
     C                   Z-ADD     *ZERO         WBANPA                         Supervisor
     C                   Z-ADD     *ZERO         WBPC                           Percent Complet
     C                   Z-ADD     *ZERO         WBPCA                          Percent Complet
     C                   Z-ADD     *ZERO         WBPCC                          Amount - Cost t
     C                   Z-ADD     *ZERO         WBD1J                          Date - Planned
     C                   Z-ADD     *ZERO         WBD2J                          Date - Actual S
     C                   Z-ADD     *ZERO         WBD3J                          Date - Planned
     C                   Z-ADD     *ZERO         WBD4J                          Date - Actual C
     C                   Z-ADD     *ZERO         WBD5J                          Date - Other 5
     C                   Z-ADD     *ZERO         WBD6J                          Date - Other 6
     C                   Z-ADD     *ZERO         WBFPDJ                         Date - Final Pa
     C                   Z-ADD     *ZERO         WBCAC                          Amount-Cost at
     C                   Z-ADD     *ZERO         WBPAC                          Amount-Profit a
     C                   Z-ADD     *ZERO         WBUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WBUPMT                         Time - Last Upd
     C                   Z-ADD     *ZERO         WBGCA1                         Address Number
     C                   Z-ADD     *ZERO         WBGCA2                         Address Number
     C                   Z-ADD     *ZERO         WBGCA3                         Address Number
     C                   Z-ADD     *ZERO         WBGCA4                         Address Number
     C                   Z-ADD     *ZERO         WBGCA5                         Address Number
     C                   Z-ADD     *ZERO         WBDOCO                         Document Number
     C                   Z-ADD     *ZERO         WBPCTN                         Parent Contract
     C                   Z-ADD     *ZERO         WBCLNU                         Contract Level
     C                   MOVEL     'N'           W0PMT
      * Define local work field Company
     C                   EVAL      YL0001 = ' '
      * Define local work field Fiscal Year
     C                   Z-ADD     *ZERO         YL0002
      * Define local work field Process Flag
     C                   EVAL      YL0003 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
