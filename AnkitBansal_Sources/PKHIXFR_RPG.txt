     H/TITLE Chg Prd Hst/Dtl       XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:34:01
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKC8CPL5IF  E           K        DISK
      * RSQ : Hog Population Dist       Producer
      *
     FPKA1CPLWIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Prd/Kill Date
      *
     FPKDHREL3IF  E           K        DISK
      * RSQ : Tattoo Header History     Producer
      *
     FPKC8CPL0IF  E           K        DISK                      A
      * UPD : Hog Population Dist       Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WAABCD
     I              ACAGTX                          WAAGTX
     I              ACALNB                          WAALNB
     I              ACAATH                          WAAATH
     I              ACAMNB                          WAAMNB
     I              ACIWST                          WAIWST
     I              ACAPST                          WAAPST
     I              ACGCNB                          WAGCNB
     I              ACGJNB                          WAGJNB
     I              ACC2TX                          WAC2TX
     I              ACAACD                          WAAACD
     I              ACACCD                          WAACCD
     I              ACADCD                          WAADCD
     I              ACAAVN                          WAAAVN
     I              ACAADT                          WAAADT
     I              ACAMTM                          WAAMTM
     I              ACAJST                          WAAJST
     I              ACAHVN                          WAAHVN
     I              ACAGVN                          WAAGVN
     I              ACABVN                          WAABVN
     I              ACABDT                          WAABDT
     I              ACABTM                          WAABTM
      *
     I@C8CPWP
      * Hog Population Dist       Producer
      * Renamed input format fields
     I              C8QPNB                          WBQPNB
     I              C8CLDT                          WBCLDT
     I              C8ENCD                          WBENCD
     I              C8EMCD                          WBEMCD
     I              C8HSCD                          WBHSCD
     I              C8KUST                          WBKUST
     I              C8KVST                          WBKVST
     I              C8QQNB                          WBQQNB
     I              C8QRNB                          WBQRNB
     I              C8KXST                          WBKXST
     I              C8EPNB                          WBEPNB
     I              C8TMST                          WBTMST
     I              C8QTNB                          WBQTNB
     I              C8AAVN                          WBAAVN
     I              C8AADT                          WBAADT
     I              C8AMTM                          WBAMTM
     I              C8AJST                          WBAJST
     I              C8AHVN                          WBAHVN
     I              C8AGVN                          WBAGVN
     I              C8ABVN                          WBABVN
     I              C8ABDT                          WBABDT
     I              C8ABTM                          WBABTM
      *
     I@C8CPQP
      * Hog Population Dist       Update index
      * Renamed input format fields
     I              C8QPNB                          WCQPNB
     I              C8CLDT                          WCCLDT
     I              C8ENCD                          WCENCD
     I              C8EMCD                          WCEMCD
     I              C8HSCD                          WCHSCD
     I              C8KUST                          WCKUST
     I              C8KVST                          WCKVST
     I              C8QQNB                          WCQQNB
     I              C8QRNB                          WCQRNB
     I              C8KXST                          WCKXST
     I              C8EPNB                          WCEPNB
     I              C8TMST                          WCTMST
     I              C8QTNB                          WCQTNB
     I              C8AAVN                          WCAAVN
     I              C8AADT                          WCAADT
     I              C8AMTM                          WCAMTM
     I              C8AJST                          WCAJST
     I              C8AHVN                          WCAHVN
     I              C8AGVN                          WCAGVN
     I              C8ABVN                          WCABVN
     I              C8ABDT                          WCABDT
     I              C8ABTM                          WCABTM
      *
     I@A1CPQ1
      * Tattoo Header             Co/Prd/Kill Date
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@DHREWR
      * Tattoo Header History     Producer
      * Renamed input format fields
     I              DHW2NB                          WFW2NB
     I              DHW3NB                          WFW3NB
     I              DHW4NB                          WFW4NB
     I              DHW5NB                          WFW5NB
     I              DHCXDT                          WFCXDT
     I              DHCYDT                          WFCYDT
     I              DHFFCD                          WFFFCD
     I              DHMPST                          WFMPST
     I              DHINPR                          WFINPR
     I              DHW6NB                          WFW6NB
     I              DHW7NB                          WFW7NB
     I              DHW8NB                          WFW8NB
     I              DHMQST                          WFMQST
     I              DHMRST                          WFMRST
     I              DHMSST                          WFMSST
     I              DHW9NB                          WFW9NB
     I              DHFGCD                          WFFGCD
     I              DHMTST                          WFMTST
     I              DHACCD                          WFACCD
     I              DHABCD                          WFABCD
     I              DHAECD                          WFAECD
     I              DHAGCD                          WFAGCD
     I              DHBDCD                          WFBDCD
     I              DHBECD                          WFBECD
     I              DHCSCD                          WFCSCD
     I              DHAAVN                          WFAAVN
     I              DHAADT                          WFAADT
     I              DHAMTM                          WFAMTM
     I              DHAJST                          WFAJST
     I              DHAHVN                          WFAHVN
     I              DHAGVN                          WFAGVN
     I              DHABVN                          WFABVN
     I              DHABDT                          WFABDT
     I              DHABTM                          WFABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKC81    E DSPKC8CPL0
      * UPD : Hog Population Dist       Update index
      * Renamed input format fields
     I              C8QPNB                          WCQPNB
     I              C8CLDT                          WCCLDT
     I              C8ENCD                          WCENCD
     I              C8EMCD                          WCEMCD
     I              C8HSCD                          WCHSCD
     I              C8KUST                          WCKUST
     I              C8KVST                          WCKVST
     I              C8QQNB                          WCQQNB
     I              C8QRNB                          WCQRNB
     I              C8KXST                          WCKXST
     I              C8EPNB                          WCEPNB
     I              C8TMST                          WCTMST
     I              C8QTNB                          WCQTNB
     I              C8AAVN                          WCAAVN
     I              C8AADT                          WCAADT
     I              C8AMTM                          WCAMTM
     I              C8AJST                          WCAJST
     I              C8AHVN                          WCAHVN
     I              C8AGVN                          WCAGVN
     I              C8ABVN                          WCABVN
     I              C8ABDT                          WCABDT
     I              C8ABTM                          WCABTM
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Producer
      * I : MAP PD Producer Code
     I                                        1   6 P1ABCD
      * I : MAP SR Source Code
     I                                        7   9 P1AACD
     IP2PARM      DS
      * I :  @Source Code
     I                                        1   3 P2A9CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1ABCD    PARM           WP0001  6        PD Producer Cod
     C           P1AACD    PARM           WP0002  3        SR Source Code
     C           P2A9CD    PARM           WP0003  3        @Source Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Chg Prd Hst/Dtl       XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Chg Prd Hst/Dtl       Rt - Producer  * 
     C                     EXSR SARVGN
      * Chg Prd Hst/Dtl       Rt - Tattoo Header  * 
     C                     EXSR SGRVGN
      * Chg Prd Hst/Dtl       Rt - Tattoo Header History  * 
     C                     EXSR SIRVGN
      * Chg Prd Hst/Dtl       Rt - Hog Population Dist  * 
     C                     EXSR SJRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Chg Prd Hst/Dtl       Rt - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WAABCD           PD Producer Cod
      * Establish starting position
     C           KRSSA     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Prd Hst/Dtl       Rt - Hog Population Dist  * 
     C                     EXSR SBRVGN
      * Chg Prd Hst/Dtl       Rt - Tattoo Header  * 
     C                     EXSR SDRVGN
      * Chg Prd Hst/Dtl       Rt - Tattoo Header History  * 
     C                     EXSR SFRVGN
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Chg Prd Hst/Dtl       Rt - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBQPNB    WQSB01           HPD Company Num
     C           *LIKE     DEFN WBEMCD    WQSB02           HPD Producer Co
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           HPD Company Num
     C                     KFLD           WQSB02           HPD Producer Co
      * Setup key
     C                     Z-ADD360       WQSB01           HPD Company Num
     C                     MOVELP1ABCD    WQSB02           HPD Producer Co
      * Establish starting position
     C           KRSSB     SETLL@C8CPWP                    *
     C           KRSSB     READE@C8CPWP                  90*
      * Data record not found
     C   90                MOVEL'PRK0474' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBHSCD' defaulted for 'HPD Pdcr Location Code'.
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
     C                     EXSR SCCRRC
     C           KRSSB     READE@C8CPWP                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C8CPQP
     C                     Z-ADDWBQPNB    WCQPNB           HPD Company Num
     C                     Z-ADDWBCLDT    WCCLDT           HPD Kill Date
     C                     MOVELP2A9CD    WCENCD           HPD Source Code
     C                     MOVELWBEMCD    WCEMCD           HPD Producer Co
     C                     MOVELWBHSCD    WCHSCD           HPD Pdcr Locati
     C                     MOVELWBKUST    WCKUST           HPD Source Type
     C                     MOVELWBKVST    WCKVST           HPD Payment Typ
     C                     Z-ADDWBQQNB    WCQQNB           HPD Carcass Wei
     C                     Z-ADDWBQRNB    WCQRNB           HPD Distributio
     C                     MOVELWBKXST    WCKXST           HPD Type of Rec
     C                     Z-ADDWBEPNB    WCEPNB           HPD Farm Site
     C                     MOVELWBTMST    WCTMST           HPD Kill Shift
     C                     Z-ADDWBQTNB    WCQTNB           HPD No of Carca
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST           RS Record Statu
     C                     MOVELWBAHVN    WCAHVN           RS Job
     C                     MOVELWBAGVN    WCAGVN           RS Program
     C                     MOVELWBABVN    WCABVN           RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSC    KLIST
     C                     KFLD           WCQPNB           HPD Company Num
     C                     KFLD           WCCLDT           HPD Kill Date
     C                     KFLD           WCENCD           HPD Source Code
     C                     KFLD           WCEMCD           HPD Producer Co
     C                     KFLD           WCHSCD           HPD Pdcr Locati
     C                     KFLD           WCKUST           HPD Source Type
     C                     KFLD           WCKVST           HPD Payment Typ
     C                     KFLD           WCQQNB           HPD Carcass Wei
     C                     KFLD           WCQRNB           HPD Distributio
     C                     KFLD           WCKXST           HPD Type of Rec
     C                     KFLD           WCEPNB           HPD Farm Site
     C                     KFLD           WCTMST           HPD Kill Shift
      * Check for duplicate primary key
     C           KLCRSC    SETLL@C8CPQP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0475' W0RTN   7
      * Send message 'Hog Population Dist    EX'
     C                     MOVEL'PRK0475' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@C8CPQP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Chg Prd Hst/Dtl       Rt - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@A1CPQ1                    *
     C                     READ @A1CPQ1                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo Hdr        CH - Tattoo Header  * 
     C                     EXSR SECHRC
     C                     READ @A1CPQ1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr        CH - Tattoo Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  3        TH State
     C                     MOVEL*BLANK    WN0002  3        TH Unused Code
     C                     MOVEL*BLANK    WN0003  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0004  1        TH Commission S
     C                     MOVEL*BLANK    WN0005  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0006  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0007  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0008  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0009  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0010  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0011  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0012  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0013  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0014  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0015  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0016  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0017  3        TH PHA Average
     C                     MOVEL*BLANK    WN0018  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0019  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0020  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0021  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0022  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0023  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0024  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0025  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0026  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0027  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0028  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0029  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0030  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0031 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0032 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0033 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0034 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0035  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0036  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0037  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0038  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0039  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0040  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0041  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0042  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0043  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0044  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0045  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0046  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0047  70       TH Unused Date
     C                     MOVEL*BLANK    WN0048  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0049  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0050  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0051  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0052  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0053  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0054  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0055  1        TH Unused Sts 8
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSE    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWDAWDT    WEAWDT           TH Purchase Dat
     C                     MOVELWDBICD    WEBICD    P      TH Group Refere
     C                     MOVELWDCPST    WECPST    P      TH Live Purchas
     C                     Z-ADDWDACPR    WEACPR           TH Live Purchas
     C                     Z-ADDWDB9PR    WEB9PR           TH Live Gross A
     C                     Z-ADDWDCAPR    WECAPR           TH LIve Net Amt
     C                     MOVELWDC4ST    WEC4ST    P      TH Resale UOM
     C                     Z-ADDWDAIPR    WEAIPR           TH Recalc Live
     C                     Z-ADDWDA6DT    WEA6DT           TH Pricing Date
     C                     MOVELWDC2ST    WEC2ST    P      TH Resale Sprea
     C                     Z-ADDWDCXNB    WECXNB           TH Dead On Arri
     C                     Z-ADDWDCWNB    WECWNB           TH Head Receive
     C                     Z-ADDWDFCNB    WEFCNB           TH Yard Deads
     C                     Z-ADDWDH9NB    WEH9NB           TH Held Over
     C                     Z-ADDWDFDNB    WEFDNB           TH Head Condemn
     C                     Z-ADDWDFENB    WEFENB           TH Head Killed
     C                     Z-ADDWDHENB    WEHENB           TH Head Adds
     C                     Z-ADDWDHFNB    WEHFNB           TH Head Accepte
     C                     Z-ADDWDCYNB    WECYNB           TH Live Wgt
     C                     Z-ADDWDLRNB    WELRNB           TH Adj Live Wgt
     C                     Z-ADDWDE0NB    WEE0NB           TH Hot Wgt
     C                     Z-ADDWDA5PC    WEA5PC           TH Tot Loin Eye
     C                     Z-ADDWDFBNB    WEFBNB           TH Tot Backfat
     C                     Z-ADDWDA4PC    WEA4PC           TH Tot Light Re
     C                     Z-ADDWDF7NB    WEF7NB           TH Avg Live Wgt
     C                     Z-ADDWDHDNB    WEHDNB           TH Avg Hot Wgt
     C                     Z-ADDWDF5NB    WEF5NB           TH Avg Light Re
     C                     Z-ADDWDF4NB    WEF4NB           TH Avg Lean Per
     C                     Z-ADDWDF3NB    WEF3NB           TH Avg Loin Eye
     C                     Z-ADDWDF2NB    WEF2NB           TH Avg Backfat
     C                     Z-ADDWDAVPC    WEAVPC           TH Std Yield Pe
     C                     Z-ADDWDAWPC    WEAWPC           TH Actual Yield
     C                     Z-ADDWDCWPC    WECWPC           TH Adj Actual Y
     C                     Z-ADDWDA8PC    WEA8PC           TH Yield Differ
     C                     Z-ADDWDA7PC    WEA7PC           TH Recalc Live
     C                     Z-ADDWDB8PR    WEB8PR           TH CM Market Pr
     C                     Z-ADDWDAMPR    WEAMPR           TH CM Base Mkt
     C                     Z-ADDWDANPR    WEANPR           TH CM Base Mkt
     C                     Z-ADDWDAYVA    WEAYVA           TH CM Sort Disc
     C                     Z-ADDWDAWVA    WEAWVA           TH CM Yield Gai
     C                     Z-ADDWDAOPR    WEAOPR           TH CM Base Carc
     C                     Z-ADDWDAXVA    WEAXVA           TH CM LN AddOn/
     C                     Z-ADDWDAPPR    WEAPPR           TH CM Carcass G
     C                     Z-ADDWDASPR    WEASPR           TH Deduction Am
     C                     Z-ADDWDA4VA    WEA4VA           TH Total Net WO
     C                     Z-ADDWDATPR    WEATPR           TH Carcass Net
     C                     Z-ADDWDA5VA    WEA5VA           TH Additions Am
     C                     Z-ADDWDCBPR    WECBPR           TH Payment Gros
     C                     Z-ADDWDCCPR    WECCPR           Th Payment Net
     C                     Z-ADDWDLPNB    WELPNB           TH AP Voucher/D
     C                     Z-ADDWDCDPR    WECDPR           TH Freight Amou
     C                     Z-ADDWDA7VA    WEA7VA           TH Accrual Amou
     C                     Z-ADDWDA2PR    WEA2PR           TH Fixed Cost A
     C                     MOVELWDJWST    WEJWST    P      TH Calc Net Sts
     C                     MOVELWDCWST    WECWST    P      TH Payment Sts
     C                     MOVELWDD7ST    WED7ST    P      TH Header Error
     C                     MOVELWDD8ST    WED8ST    P      TH Detail Error
     C                     MOVELWDDWST    WEDWST    P      TH Kill Balanci
     C                     MOVELWDD6ST    WED6ST    P      TH Bal to Kill
     C                     Z-ADDWDGHNB    WEGHNB           TH Commission A
     C                     Z-ADDWDBYDT    WEBYDT           TH Voucher Paym
     C                     MOVELWDE0ST    WEE0ST    P      TH User Error O
     C                     MOVELWDE1ST    WEE1ST    P      TH Held Over Re
     C                     MOVELWDE2ST    WEE2ST    P      TH Sex
     C                     Z-ADDWDBSDT    WEBSDT           TH Held/Ovr Com
     C                     Z-ADDWDBTDT    WEBTDT           TH Commission P
     C                     Z-ADDWDBUDT    WEBUDT           TH Actual Check
     C                     Z-ADDWDHGNB    WEHGNB           TH Shipped Weig
     C                     Z-ADDWDHHNB    WEHHNB           TH Avg Hot Wgt
     C                     Z-ADDWDHINB    WEHINB           TH FFLI
     C                     Z-ADDWDA3PR    WEA3PR           TH Kill Product
     C                     Z-ADDWDA4PR    WEA4PR           TH Cut Product
     C                     Z-ADDWDA6PR    WEA6PR           TH Render Produ
     C                     Z-ADDWDJ9NB    WEJ9NB           TH Head Exclude
     C                     Z-ADDWDD6PR    WED6PR           TH CM Bse Mkt L
     C                     Z-ADDWDD7PR    WED7PR           TH CM Bse Mkt C
     C                     Z-ADDWDD8PR    WED8PR           TH CM Srt Dsc L
     C                     Z-ADDWDD9PR    WED9PR           TH CM Srt Dsc C
     C                     Z-ADDWDEAPR    WEEAPR           TH CM Yld G/L L
     C                     Z-ADDWDEBPR    WEEBPR           TH CM Yld G/L C
     C                     Z-ADDWDECPR    WEECPR           TH CM Crc Val L
     C                     Z-ADDWDEDPR    WEEDPR           TH CM Crc Val C
     C                     Z-ADDWDEEPR    WEEEPR           TH CM Lean Prem
     C                     Z-ADDWDEFPR    WEEFPR           TH CM Lean Prem
     C                     Z-ADDWDEGPR    WEEGPR           TH CM Gross Liv
     C                     Z-ADDWDEHPR    WEEHPR           TH CM Gross Car
     C                     MOVELWDKAST    WEKAST    P      TH Source Type
     C                     MOVELWDJ7ST    WEJ7ST    P      TH Scale Ticket
     C                     MOVELWDJ9ST    WEJ9ST    P      TH Payment Type
     C                     Z-ADDWDOXNB    WEOXNB           TH HPS Movement
     C                     MOVELP2A9CD    WELKST    P      TH Source Code
     C                     MOVELWDLLST    WELLST    P      TH Hog Class Ty
     C                     MOVELWDJ8ST    WEJ8ST    P      TH Posted to HP
     C                     MOVELWDLIST    WELIST    P      TH Schedule Kil
     C                     MOVELWDLJST    WELJST    P      TH Shift Held O
     C                     Z-ADDWDT2HD    WET2HD           TH Shift Held O
     C                     MOVELWDBDCD    WEBDCD    P      DF Defect Code
     C                     MOVELWDCSCD    WECSCD    P      THP Process Cod
     C                     MOVELWDABCD    WEABCD    P      PD Producer Cod
     C                     MOVELWDAECD    WEAECD    P      PL Location Cod
     C                     MOVELWDACCD    WEACCD    P      HB Buyer Code
     C                     MOVELWDAGCD    WEAGCD    P      GN Genetic Code
     C                     MOVELWDBECD    WEBECD    P      HC Class Code
     C                     MOVELWDAAVN    WEAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WEAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WEAMTM           RS Time Changed
     C                     MOVELWDAJST    WEAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WEAHVN    P      RS Job
     C                     MOVELWDAGVN    WEAGVN    P      RS Program
     C                     MOVELWDABVN    WEABVN    P      RS User Added
     C                     Z-ADDWDABDT    WEABDT           RS Date Added
     C                     Z-ADDWDABTM    WEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           WECWST    IFEQ 'ML'                       *IF
     C           WECWST    OREQ 'PL'
     C           WECWST    OREQ 'NL'
     C           WECWST    OREQ 'SL'
     C           WECWST    OREQ 'IL'
     C                     MOVEL'L'       WEJ9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WEJ9ST           TH Payment Type
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Chg Prd Hst/Dtl       Rt - Tattoo Header History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFW2NB    WQSF01           THH company num
     C           *LIKE     DEFN WFABCD    WQSF02           PD Producer Cod
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           THH company num
     C                     KFLD           WQSF02           PD Producer Cod
      * Setup key
     C                     Z-ADD*ZERO     WQSF01           THH company num
     C                     MOVELWAABCD    WQSF02           PD Producer Cod
      * Establish starting position
     C           KRSSF     SETLL@DHREWR                    *
     C           KRSSF     READE@DHREWR                  90*
      * Data record not found
     C   90                MOVEL'PRK0610' W0RTN   7
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Chg Prd Hst/Dtl       Rt - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@A1CPQ1                    *
     C                     READ @A1CPQ1                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo Hdr        CH - Tattoo Header  * 
     C                     EXSR SHCHRC
     C                     READ @A1CPQ1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr        CH - Tattoo Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0056  3        TH State
     C                     MOVEL*BLANK    WN0057  3        TH Unused Code
     C                     MOVEL*BLANK    WN0058  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0059  1        TH Commission S
     C                     MOVEL*BLANK    WN0060  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0061  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0062  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0063  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0064  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0065  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0066  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0067  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0068  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0069  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0070  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0071  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0072  3        TH PHA Average
     C                     MOVEL*BLANK    WN0073  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0074  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0075  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0076  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0077  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0078  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0079  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0080  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0081  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0082  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0083  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0084  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0085  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0086 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0087 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0088 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0089 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0090  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0091  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0092  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0093  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0094  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0095  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0096  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0097  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0098  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0099  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0100  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0101  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0102  70       TH Unused Date
     C                     MOVEL*BLANK    WN0103  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0104  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0105  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0106  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0107  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0108  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0109  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0110  1        TH Unused Sts 8
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSH    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWDAWDT    WEAWDT           TH Purchase Dat
     C                     MOVELWDBICD    WEBICD    P      TH Group Refere
     C                     MOVELWDCPST    WECPST    P      TH Live Purchas
     C                     Z-ADDWDACPR    WEACPR           TH Live Purchas
     C                     Z-ADDWDB9PR    WEB9PR           TH Live Gross A
     C                     Z-ADDWDCAPR    WECAPR           TH LIve Net Amt
     C                     MOVELWDC4ST    WEC4ST    P      TH Resale UOM
     C                     Z-ADDWDAIPR    WEAIPR           TH Recalc Live
     C                     Z-ADDWDA6DT    WEA6DT           TH Pricing Date
     C                     MOVELWDC2ST    WEC2ST    P      TH Resale Sprea
     C                     Z-ADDWDCXNB    WECXNB           TH Dead On Arri
     C                     Z-ADDWDCWNB    WECWNB           TH Head Receive
     C                     Z-ADDWDFCNB    WEFCNB           TH Yard Deads
     C                     Z-ADDWDH9NB    WEH9NB           TH Held Over
     C                     Z-ADDWDFDNB    WEFDNB           TH Head Condemn
     C                     Z-ADDWDFENB    WEFENB           TH Head Killed
     C                     Z-ADDWDHENB    WEHENB           TH Head Adds
     C                     Z-ADDWDHFNB    WEHFNB           TH Head Accepte
     C                     Z-ADDWDCYNB    WECYNB           TH Live Wgt
     C                     Z-ADDWDLRNB    WELRNB           TH Adj Live Wgt
     C                     Z-ADDWDE0NB    WEE0NB           TH Hot Wgt
     C                     Z-ADDWDA5PC    WEA5PC           TH Tot Loin Eye
     C                     Z-ADDWDFBNB    WEFBNB           TH Tot Backfat
     C                     Z-ADDWDA4PC    WEA4PC           TH Tot Light Re
     C                     Z-ADDWDF7NB    WEF7NB           TH Avg Live Wgt
     C                     Z-ADDWDHDNB    WEHDNB           TH Avg Hot Wgt
     C                     Z-ADDWDF5NB    WEF5NB           TH Avg Light Re
     C                     Z-ADDWDF4NB    WEF4NB           TH Avg Lean Per
     C                     Z-ADDWDF3NB    WEF3NB           TH Avg Loin Eye
     C                     Z-ADDWDF2NB    WEF2NB           TH Avg Backfat
     C                     Z-ADDWDAVPC    WEAVPC           TH Std Yield Pe
     C                     Z-ADDWDAWPC    WEAWPC           TH Actual Yield
     C                     Z-ADDWDCWPC    WECWPC           TH Adj Actual Y
     C                     Z-ADDWDA8PC    WEA8PC           TH Yield Differ
     C                     Z-ADDWDA7PC    WEA7PC           TH Recalc Live
     C                     Z-ADDWDB8PR    WEB8PR           TH CM Market Pr
     C                     Z-ADDWDAMPR    WEAMPR           TH CM Base Mkt
     C                     Z-ADDWDANPR    WEANPR           TH CM Base Mkt
     C                     Z-ADDWDAYVA    WEAYVA           TH CM Sort Disc
     C                     Z-ADDWDAWVA    WEAWVA           TH CM Yield Gai
     C                     Z-ADDWDAOPR    WEAOPR           TH CM Base Carc
     C                     Z-ADDWDAXVA    WEAXVA           TH CM LN AddOn/
     C                     Z-ADDWDAPPR    WEAPPR           TH CM Carcass G
     C                     Z-ADDWDASPR    WEASPR           TH Deduction Am
     C                     Z-ADDWDA4VA    WEA4VA           TH Total Net WO
     C                     Z-ADDWDATPR    WEATPR           TH Carcass Net
     C                     Z-ADDWDA5VA    WEA5VA           TH Additions Am
     C                     Z-ADDWDCBPR    WECBPR           TH Payment Gros
     C                     Z-ADDWDCCPR    WECCPR           Th Payment Net
     C                     Z-ADDWDLPNB    WELPNB           TH AP Voucher/D
     C                     Z-ADDWDCDPR    WECDPR           TH Freight Amou
     C                     Z-ADDWDA7VA    WEA7VA           TH Accrual Amou
     C                     Z-ADDWDA2PR    WEA2PR           TH Fixed Cost A
     C                     MOVELWDJWST    WEJWST    P      TH Calc Net Sts
     C                     MOVELWDCWST    WECWST    P      TH Payment Sts
     C                     MOVELWDD7ST    WED7ST    P      TH Header Error
     C                     MOVELWDD8ST    WED8ST    P      TH Detail Error
     C                     MOVELWDDWST    WEDWST    P      TH Kill Balanci
     C                     MOVELWDD6ST    WED6ST    P      TH Bal to Kill
     C                     Z-ADDWDGHNB    WEGHNB           TH Commission A
     C                     Z-ADDWDBYDT    WEBYDT           TH Voucher Paym
     C                     MOVELWDE0ST    WEE0ST    P      TH User Error O
     C                     MOVELWDE1ST    WEE1ST    P      TH Held Over Re
     C                     MOVELWDE2ST    WEE2ST    P      TH Sex
     C                     Z-ADDWDBSDT    WEBSDT           TH Held/Ovr Com
     C                     Z-ADDWDBTDT    WEBTDT           TH Commission P
     C                     Z-ADDWDBUDT    WEBUDT           TH Actual Check
     C                     Z-ADDWDHGNB    WEHGNB           TH Shipped Weig
     C                     Z-ADDWDHHNB    WEHHNB           TH Avg Hot Wgt
     C                     Z-ADDWDHINB    WEHINB           TH FFLI
     C                     Z-ADDWDA3PR    WEA3PR           TH Kill Product
     C                     Z-ADDWDA4PR    WEA4PR           TH Cut Product
     C                     Z-ADDWDA6PR    WEA6PR           TH Render Produ
     C                     Z-ADDWDJ9NB    WEJ9NB           TH Head Exclude
     C                     Z-ADDWDD6PR    WED6PR           TH CM Bse Mkt L
     C                     Z-ADDWDD7PR    WED7PR           TH CM Bse Mkt C
     C                     Z-ADDWDD8PR    WED8PR           TH CM Srt Dsc L
     C                     Z-ADDWDD9PR    WED9PR           TH CM Srt Dsc C
     C                     Z-ADDWDEAPR    WEEAPR           TH CM Yld G/L L
     C                     Z-ADDWDEBPR    WEEBPR           TH CM Yld G/L C
     C                     Z-ADDWDECPR    WEECPR           TH CM Crc Val L
     C                     Z-ADDWDEDPR    WEEDPR           TH CM Crc Val C
     C                     Z-ADDWDEEPR    WEEEPR           TH CM Lean Prem
     C                     Z-ADDWDEFPR    WEEFPR           TH CM Lean Prem
     C                     Z-ADDWDEGPR    WEEGPR           TH CM Gross Liv
     C                     Z-ADDWDEHPR    WEEHPR           TH CM Gross Car
     C                     MOVELWDKAST    WEKAST    P      TH Source Type
     C                     MOVELWDJ7ST    WEJ7ST    P      TH Scale Ticket
     C                     MOVELWDJ9ST    WEJ9ST    P      TH Payment Type
     C                     Z-ADDWDOXNB    WEOXNB           TH HPS Movement
     C                     MOVELP2A9CD    WELKST    P      TH Source Code
     C                     MOVELWDLLST    WELLST    P      TH Hog Class Ty
     C                     MOVELWDJ8ST    WEJ8ST    P      TH Posted to HP
     C                     MOVELWDLIST    WELIST    P      TH Schedule Kil
     C                     MOVELWDLJST    WELJST    P      TH Shift Held O
     C                     Z-ADDWDT2HD    WET2HD           TH Shift Held O
     C                     MOVELWDBDCD    WEBDCD    P      DF Defect Code
     C                     MOVELWDCSCD    WECSCD    P      THP Process Cod
     C                     MOVELWDABCD    WEABCD    P      PD Producer Cod
     C                     MOVELWDAECD    WEAECD    P      PL Location Cod
     C                     MOVELWDACCD    WEACCD    P      HB Buyer Code
     C                     MOVELWDAGCD    WEAGCD    P      GN Genetic Code
     C                     MOVELWDBECD    WEBECD    P      HC Class Code
     C                     MOVELWDAAVN    WEAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WEAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WEAMTM           RS Time Changed
     C                     MOVELWDAJST    WEAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WEAHVN    P      RS Job
     C                     MOVELWDAGVN    WEAGVN    P      RS Program
     C                     MOVELWDABVN    WEABVN    P      RS User Added
     C                     Z-ADDWDABDT    WEABDT           RS Date Added
     C                     Z-ADDWDABTM    WEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           WECWST    IFEQ 'ML'                       *IF
     C           WECWST    OREQ 'PL'
     C           WECWST    OREQ 'NL'
     C           WECWST    OREQ 'SL'
     C           WECWST    OREQ 'IL'
     C                     MOVEL'L'       WEJ9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WEJ9ST           TH Payment Type
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Chg Prd Hst/Dtl       Rt - Tattoo Header History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFW2NB    WQSI01           THH company num
     C           *LIKE     DEFN WFABCD    WQSI02           PD Producer Cod
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           THH company num
     C                     KFLD           WQSI02           PD Producer Cod
      * Setup key
     C                     Z-ADD360       WQSI01           THH company num
     C                     MOVELP1ABCD    WQSI02           PD Producer Cod
      * Establish starting position
     C           KRSSI     SETLL@DHREWR                    *
     C           KRSSI     READE@DHREWR                  90*
      * Data record not found
     C   90                MOVEL'PRK0610' W0RTN   7
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Chg Prd Hst/Dtl       Rt - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBQPNB    WQSJ01           HPD Company Num
     C           *LIKE     DEFN WBEMCD    WQSJ02           HPD Producer Co
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           HPD Company Num
     C                     KFLD           WQSJ02           HPD Producer Co
      * Setup key
     C                     Z-ADD360       WQSJ01           HPD Company Num
     C                     MOVELP1ABCD    WQSJ02           HPD Producer Co
      * Establish starting position
     C           KRSSJ     SETLL@C8CPWP                    *
     C           KRSSJ     READE@C8CPWP                  90*
      * Data record not found
     C   90                MOVEL'PRK0474' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBHSCD' defaulted for 'HPD Pdcr Location Code'.
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
     C                     EXSR SKCRRC
     C           KRSSJ     READE@C8CPWP                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Hog Ppltn Dist    CR - Hog Population Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C8CPQP
     C                     Z-ADDWBQPNB    WCQPNB           HPD Company Num
     C                     Z-ADDWBCLDT    WCCLDT           HPD Kill Date
     C                     MOVELP1AACD    WCENCD           HPD Source Code
     C                     MOVELWBEMCD    WCEMCD           HPD Producer Co
     C                     MOVELWBHSCD    WCHSCD           HPD Pdcr Locati
     C                     MOVELWBKUST    WCKUST           HPD Source Type
     C                     MOVELWBKVST    WCKVST           HPD Payment Typ
     C                     Z-ADDWBQQNB    WCQQNB           HPD Carcass Wei
     C                     Z-ADDWBQRNB    WCQRNB           HPD Distributio
     C                     MOVELWBKXST    WCKXST           HPD Type of Rec
     C                     Z-ADDWBEPNB    WCEPNB           HPD Farm Site
     C                     MOVELWBTMST    WCTMST           HPD Kill Shift
     C                     Z-ADDWBQTNB    WCQTNB           HPD No of Carca
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST           RS Record Statu
     C                     MOVELWBAHVN    WCAHVN           RS Job
     C                     MOVELWBAGVN    WCAGVN           RS Program
     C                     MOVELWBABVN    WCABVN           RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           WCQPNB           HPD Company Num
     C                     KFLD           WCCLDT           HPD Kill Date
     C                     KFLD           WCENCD           HPD Source Code
     C                     KFLD           WCEMCD           HPD Producer Co
     C                     KFLD           WCHSCD           HPD Pdcr Locati
     C                     KFLD           WCKUST           HPD Source Type
     C                     KFLD           WCKVST           HPD Payment Typ
     C                     KFLD           WCQQNB           HPD Carcass Wei
     C                     KFLD           WCQRNB           HPD Distributio
     C                     KFLD           WCKXST           HPD Type of Rec
     C                     KFLD           WCEPNB           HPD Farm Site
     C                     KFLD           WCTMST           HPD Kill Shift
      * Check for duplicate primary key
     C           KLCRSK    SETLL@C8CPQP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0475' W0RTN   7
      * Send message 'Hog Population Dist    EX'
     C                     MOVEL'PRK0475' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@C8CPQP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAALNB           PD Production C
     C                     Z-ADD*ZERO     WAAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WAAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WAGCNB           PD VND Address
     C                     Z-ADD*ZERO     WAGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBQPNB           HPD Company Num
     C                     Z-ADD*ZERO     WBCLDT           HPD Kill Date
     C                     Z-ADD*ZERO     WBQQNB           HPD Carcass Wei
     C                     Z-ADD*ZERO     WBQRNB           HPD Distributio
     C                     Z-ADD*ZERO     WBEPNB           HPD Farm Site
     C                     Z-ADD*ZERO     WBQTNB           HPD No of Carca
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFW2NB           THH company num
     C                     Z-ADD*ZERO     WFW3NB           THH Buy Order N
     C                     Z-ADD*ZERO     WFW4NB           THH Load Number
     C                     Z-ADD*ZERO     WFW5NB           THH Tattoo Numb
     C                     Z-ADD*ZERO     WFCXDT           THH Kill Date
     C                     Z-ADD*ZERO     WFCYDT           THH Purchase Da
     C                     Z-ADD*ZERO     WFINPR           THH Live Purcha
     C                     Z-ADD*ZERO     WFW6NB           THH Dead on Arr
     C                     Z-ADD*ZERO     WFW7NB           THH Head Receiv
     C                     Z-ADD*ZERO     WFW8NB           THH Live Wgt
     C                     Z-ADD*ZERO     WFW9NB           THH Movement Re
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
